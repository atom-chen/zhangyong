/*! code 2020-01-16 */

!function(t){var e=(i.COMPLETE="complete",i);function i(t){this.type=t}t.BaseEvent=e}(tl3d=tl3d||{}),function(t){var e=(i.prototype.addEventListener=function(t,e,i){this._eventsMap||(this._eventsMap=new Object);var n=this._eventsMap[t];n=n||(this._eventsMap[t]=[]);for(var o={listener:e,thisObject:i},a=0;a<n.length;a++){var r=n[a];if(r.listener==e&&r.thisObject==i)return}n.push(o)},i.prototype.hasEventListener=function(t){return this._eventsMap&&null!=this._eventsMap[t]},i.prototype.removeEventListener=function(t,e,i){if(null!=this._eventsMap)for(var n=this._eventsMap[t],o=0;n&&o<n.length;o++){var a=n[o];if(a.listener==e&&a.thisObject==i)return void n.splice(o,1)}},i.prototype.removeEventListenerByName=function(t){if(null!=this._eventsMap){var e=this._eventsMap[t];e&&(e.length=0)}},i.prototype.removeEventListenerByTarget=function(t){if(null!=this._eventsMap)for(var e in this._eventsMap){var i=this._eventsMap[e];if(i)for(var n=0;i&&n<i.length;n++)if(i[n].thisObject==t)return void i.splice(n,1)}},i.prototype.removeEventListenerByNameAndTarget=function(t,e){if(null!=this._eventsMap){var i=this._eventsMap[t];if(i)for(var n=0;i&&n<i.length;n++)if(i[n].thisObject==e)return void i.splice(n,1)}},i.prototype.dispatchEvent=function(t){var e=this._eventsMap;if(!e)return!0;var i=e[t.type];if(!i)return!0;var n=i.length;if(0==n)return!0;t.target=this;for(var o=[].concat.apply([],i),a=0;a<n;a++){var r=o[a];r&&r.listener.call(r.thisObject,t)}},i);function i(){this._eventsMap=null}t.EventDispatcher=e}(tl3d=tl3d||{}),function(t){var e=(i.prototype.destory=function(){},i);function i(){}t.GC=e}(tl3d=tl3d||{});var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.GC,__extends(n,e),Object.defineProperty(n.prototype,"useNum",{get:function(){return this._useNum},set:function(t){this._useNum=t,0==this._useNum&&(this.idleTime=0)},enumerable:!0,configurable:!0}),n.prototype.clearUseNum=function(){this._useNum--,this._useNum<=0&&(this.idleTime=n.GCTime)},n.GCTime=4,n);function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._useNum=0,t.idleTime=0,t}t.ResCount=i}(tl3d=tl3d||{}),function(n){var t=(e.prototype.gc=function(){var t=[];for(var e in this._dic){t.push(e);var i=this._dic[e];i.useNum<=0&&(i.idleTime++,i.idleTime>=n.ResCount.GCTime&&(i.destory(),delete this._dic[e]))}},e);function e(){var t=this;this._dic=new Object;var e=getRandomNumAssgin(1,3e4,35e3)[0];Laya.timer.loop(e,this,function(){t.gc()})}n.ResGC=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var a,t=(a=o.EventDispatcher,__extends(e,a),e.prototype.toStringout=function(){return"Object3D("+String(this._x)+","+String(this._y)+","+String(this._z)+")"},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{set:function(t){this._scaleX=this._scaleY=this._scaleZ=t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},set:function(t){this._scaleX=t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},set:function(t){this._scaleY=t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleZ",{get:function(){return this._scaleZ},set:function(t){this._scaleZ=t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationX",{get:function(){return this._rotationX},set:function(t){this._rotationX=t,this.updateMatrix(),this.updateRotationMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationY",{get:function(){return this._rotationY},set:function(t){this._rotationY=t,this.updateMatrix(),this.updateRotationMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationZ",{get:function(){return this._rotationZ},set:function(t){this._rotationZ=t,this.updateMatrix(),this.updateRotationMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"px",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"py",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pz",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.updateMatrix=function(){this.posMatrix.identity(),this.posMatrix.appendScale(this._scaleX,this._scaleY,this._scaleZ),this.posMatrix.appendRotation(this._rotationX,o.Vector3D.X_AXIS),this.posMatrix.appendRotation(this._rotationY,o.Vector3D.Y_AXIS),this.posMatrix.appendRotation(this._rotationZ,o.Vector3D.Z_AXIS),this.posMatrix.appendTranslation(this._x,this._y,this._z)},e.prototype.updateRotationMatrix=function(){},e);function e(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var n=a.call(this)||this;return n._x=t,n._y=e,n._z=i,n._scaleX=1,n._scaleY=1,n._scaleZ=1,n._rotationX=0,n._rotationY=0,n._rotationZ=0,n.posMatrix=new o.Matrix3D,n}o.Object3D=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=e.Object3D,__extends(n,i),Object.defineProperty(n.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=t},enumerable:!0,configurable:!0}),n.prototype.lookAt=function(t){this.lookAtTarget=t},Object.defineProperty(n.prototype,"astarRect",{set:function(t){this._astarRect=new e.Rectangle,this._astarRect.x=t.x,this._astarRect.y=t.y,this._astarRect.width=t.width,this._astarRect.height=t.height,this._midPos=new e.Vector3D,this._midPos.x=this._astarRect.x+this._astarRect.width/2,this._midPos.z=this._astarRect.y+this._astarRect.height/2,this._scaleVec=new e.Vector3D,this._scaleVec.x=(this._astarRect.width-100)/this._astarRect.width,this._scaleVec.z=(this._astarRect.height-100)/this._astarRect.height},enumerable:!0,configurable:!0}),n.prototype.update=function(){if(this.lookAtTarget){if(this._astarRect&&this._astarRect.width<600){var t=new e.Vector3D;t.x=(this.lookAtTarget.px-this._midPos.x)*this._scaleVec.x+this._midPos.x,t.z=(this.lookAtTarget.pz-this._midPos.z)*this._scaleVec.z+this._midPos.z,t.y=this.lookAtTarget.py,e.Scene_data.focus3D.x=t.x,e.Scene_data.focus3D.y=t.y+28,e.Scene_data.focus3D.z=t.z}else e.Scene_data.focus3D.x=this.lookAtTarget.px,e.Scene_data.focus3D.y=this.lookAtTarget.py+28,e.Scene_data.focus3D.z=this.lookAtTarget.pz;this.lastFoucs3D.x!=e.Scene_data.focus3D.x||this.lastFoucs3D.y!=e.Scene_data.focus3D.y||this.lastFoucs3D.z!=e.Scene_data.focus3D.z?(this.lastFoucs3D.x=e.Scene_data.focus3D.x,this.lastFoucs3D.y=e.Scene_data.focus3D.y,this.lastFoucs3D.z=e.Scene_data.focus3D.z,this.needChange=!0):this.needChange=!1}},Object.defineProperty(n.prototype,"postion",{get:function(){return new e.Vector3D(this.x,this.y,this.z)},enumerable:!0,configurable:!0}),n);function n(){var t=i.call(this)||this;return t._distance=500,t.offset=new e.Vector3D,t.lastFoucs3D=new e.Vector3D,t.needChange=!0,t.cameraMatrix=new e.Matrix3D,t}e.Camera3D=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.ResCount,__extends(n,e),n.prototype.destory=function(){this.vertices.length=0,this.vertices=null,this.uvs.length=0,this.uvs=null,this.indexs.length=0,this.indexs=null,this.lightuvs.length=0,this.lightuvs=null,this.normals.length=0,this.normals=null,this.tangents.length=0,this.tangents=null,this.bitangents.length=0,this.bitangents=null,this.vertexBuffer&&(t.Scene_data.context3D.deleteBuffer(this.vertexBuffer),this.vertexBuffer=null),this.uvBuffer&&(t.Scene_data.context3D.deleteBuffer(this.uvBuffer),this.uvBuffer=null),this.indexBuffer&&(t.Scene_data.context3D.deleteBuffer(this.indexBuffer),this.indexBuffer=null),this.lightUvBuffer&&(t.Scene_data.context3D.deleteBuffer(this.lightUvBuffer),this.lightUvBuffer=null),this.normalsBuffer&&(t.Scene_data.context3D.deleteBuffer(this.normalsBuffer),this.normalsBuffer=null),this.tangentBuffer&&(t.Scene_data.context3D.deleteBuffer(this.tangentBuffer),this.tangentBuffer=null),this.bitangentBuffer&&(t.Scene_data.context3D.deleteBuffer(this.bitangentBuffer),this.bitangentBuffer=null),this.hasdispose=!0},n);function n(){var t=e.call(this)||this;return t.vertices=new Array,t.uvs=new Array,t.indexs=new Array,t.lightuvs=new Array,t.normals=new Array,t.tangents=new Array,t.bitangents=new Array,t.treNum=0,t.compressBuffer=!1,t.hasdispose=!1,t}t.ObjData=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=r.ObjData,__extends(i,e),i.prototype.getBindPosMatrix=function(){for(var t=new Array,e=new Array,i=0;i<this.bindPosAry.length;i++){var n=this.bindPosAry[i],o=new r.Quaternion(n[0],n[1],n[2]);o.setMd5W();var a=o.toMatrix3D();a.appendTranslation(n[3],n[4],n[5]),e.push(a.clone()),a.invert(),t.push(a)}this.bindPosMatrixAry=t,this.bindPosInvertMatrixAry=e},i.prototype.destory=function(){e.prototype.destory.call(this),this.materialParam&&(this.materialParam.destory(),this.materialParam=null,this.materialParamData=null),this.boneIDAry.length=0,this.boneWeightAry.length=0,this.boneNewIDAry.length=0,this.boneIDAry=null,this.boneWeightAry=null,this.boneNewIDAry=null,this.boneWeightBuffer&&(r.Scene_data.context3D.deleteBuffer(this.boneWeightBuffer),this.boneWeightBuffer=null),this.boneIdBuffer&&(r.Scene_data.context3D.deleteBuffer(this.boneIdBuffer),this.boneIdBuffer=null),this.material&&this.material.clearUseNum(),this.particleAry.length=0,this.particleAry=null},i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.boneIDAry=new Array,t.boneWeightAry=new Array,t.boneNewIDAry=new Array,t.particleAry=new Array,t}r.MeshData=t;function n(t,e){this.url=t,this.socketName=e}r.BindParticle=n}(tl3d=tl3d||{}),function(t){var e=(i.prototype.add=function(t,e){this[t]=e,this._keys.push(t),this._values.push(e)},i.prototype.has=function(t){return!!this[t]},i.prototype.remove=function(t){var e=this._keys.indexOf(t,0);this._keys.splice(e,1),this._values.splice(e,1),delete this[t]},i.prototype.keys=function(){return this._keys},i.prototype.values=function(){return this._values},i.prototype.containsKey=function(t){return void 0!==this[t]},i.prototype.toLookup=function(){return this},i);function i(t){this._keys=new Array,this._values=new Array;for(var e=0;t&&e<t.length;e++)this[t[e].key]=t[e].value,this._keys.push(t[e].key),this._values.push(t[e].value)}t.Dictionary=e;n.prototype.add=function(t){this._item.push(t)},n.prototype.has=function(t){for(var e=0;e<this._item.length;e++)if(this._item[e]==t)return!0;return!1};function n(){this._item=new Array}}(tl3d=tl3d||{}),function(t){var e=(i.Orange7a2f21="[7a2f21]",i.Orange9a683f="[9a683f]",i.Orange853d07="[853d07]",i.Brown6a4936="[6a4936]",i.Brown623424="[623424]",i.Brownac8965="[ac8965]",i.Reddb4051="[db4051]",i.Redd92200="[d92200]",i.Redff0000="[ff0000]",i.Brownd8d49c="[d8d49c]",i.color843b11="[843b11]",i.colorb96d49="[b96d49]",i.colorcd2000="[cd2000]",i.colorfef3d7="[fef3d7]",i.color9a683f="[9a683f]",i.Brown7a2f21="[7a2f21]",i.Brown40120a="[40120a]",i.Brown491207="[491207]",i.Brown541616="[541616]",i.Brown5a2610="[5a2610]",i.Browndf9a68="[df9a68]",i.Browndb39264="[b39264]",i.Brownd662c0d="[662c0d]",i.colorefe4c4="[efe4c4]",i.color802626="[802626]",i.color9f7b4d="[9f7b4d]",i.color4b0808="[4b0808]",i.color5f5c59="[5f5c59]",i.color903713="[903713]",i.colorfdf6da="[fdf6da]",i.color73301c="[73301c]",i.colorffeeb5="[ffeeb5]",i.Green98ec2c="   ",i.Green56da35="[56da35]",i.Green20a200="[20a200]",i.Greenadff00="[adff00]",i.Green2ca937="[2ca937]",i.Green464b11="[464b11]",i.Green54db36="[54db36]",i.Yellowf7d253="[f7d253]",i.Yellowffecc6="[ffecc6]",i.Yellowffd500="[ffd500]",i.Yellowffe9b4="[ffe9b4]",i.Yellowedce7e="[edce7e]",i.color4c1c07="[4c1c07]",i.Whiteffffff="[ffffff]",i.Whitefffce6="[fffce6]",i.Whitefff7db="[fff7db]",i.White9A683F="[9A683F]",i.Black000000="[000000]",i.Whitefff4d6="[fff4d6]",i.Whiteffeed0="[ffeed0]",i.Whiteffeec9="[ffeec9]",i.Whiteffe9b4="[ffe9b4]",i.Whitefff0b4="[fff0b4]",i.Coffeeff9200="[ff9200]",i.Coffeefee87b="[fee87b]",i.color2daa35="[2daa35]",i.color4392ff="[4392ff]",i.colorb759ff="[b759ff]",i.colorff7200="[ff7200]",i.colorce0a00="[ce0a00]",i.coloraa874a="[aa874a]",i.colorffecc6="[ffecc6]",i.colorfde87e="[fde87e]",i.colord6e7ff="[d6e7ff]",i.colord27262e="[27262e]",i.colorffe9b4="[ffe9b4]",i.color9c9b9b="[9c9b9b]",i.colorfff2d3="[fff2d3]",i.color451800="[451800]",i);function i(){}t.ColorType=e}(tl3d=tl3d||{}),function(o){var t=(e.prototype.getIndexByPos=function(t,e){return 4*(e*this.width+t)},e.prototype.setRgb=function(t,e,i){t=Math.round(t),e=Math.round(e);var n=this.getIndexByPos(t,e);this.imgData.data[n+0]=255*i.x,this.imgData.data[n+1]=255*i.y,this.imgData.data[n+2]=255*i.z,this.imgData.data[n+3]=255},e.prototype.getRgb=function(t,e){t=Math.round(t),e=Math.round(e);var i=new o.Vector3D,n=this.getIndexByPos(t,e);return i.x=this.imgData.data[n+0]/255,i.y=this.imgData.data[n+1]/255,i.z=this.imgData.data[n+2]/255,i.w=1,i},e);function e(t,e){this.width=t,this.height=e;var i=o.UIManager.getInstance().getContext2D(this.width,this.height,!1);this.imgData=i.getImageData(0,0,this.width,this.height);for(var n=0;n<this.imgData.data.length;n+=4)this.imgData.data[n+0]=255,this.imgData.data[n+1]=255,this.imgData.data[n+2]=255,this.imgData.data[n+3]=255}o.BitMapData=t}(tl3d=tl3d||{}),function(l){var t=(e.prototype.init=function(t){var e=t.getContext("webgl",{stencil:!0,alpha:!0,depth:!0,antialias:!1})||t.getContext("experimental-webgl",{stencil:!0,alpha:!0,depth:!0,antialias:!1});this.renderContext=e,this._contextSetTest=new n},e.prototype.resetSize=function(t,e){this.renderContext.viewport(0,0,t,e)},e.prototype.uploadBuff3D=function(t){var e=this.renderContext.getParameter(this.renderContext.ARRAY_BUFFER_BINDING),i=this.renderContext.createBuffer();return this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,i),this.renderContext.bufferData(this.renderContext.ARRAY_BUFFER,new Float32Array(t),this.renderContext.STATIC_DRAW),e&&this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,e),i},e.prototype.uploadBuff3DArrayBuffer=function(t){var e=this.renderContext.getParameter(this.renderContext.ARRAY_BUFFER_BINDING),i=this.renderContext.createBuffer();return this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,i),this.renderContext.bufferData(this.renderContext.ARRAY_BUFFER,t,this.renderContext.STATIC_DRAW),e&&this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,e),i},e.prototype.uploadBuff3DByBuffer=function(t,e){var i=this.renderContext.getParameter(this.renderContext.ARRAY_BUFFER_BINDING);this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,t),this.renderContext.bufferData(this.renderContext.ARRAY_BUFFER,new Float32Array(e),this.renderContext.STATIC_DRAW),i&&this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,i)},e.prototype.uploadIndexBuff3D=function(t){var e=this.renderContext.getParameter(this.renderContext.ELEMENT_ARRAY_BUFFER_BINDING),i=this.renderContext.createBuffer();for(this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,i);t.length%4!=0;)t.push(0);return this.renderContext.bufferData(this.renderContext.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),this.renderContext.STATIC_DRAW),e&&this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,e),i},e.prototype.uploadIndexBuff3DByBuffer=function(t,e){var i=this.renderContext.getParameter(this.renderContext.ELEMENT_ARRAY_BUFFER_BINDING);this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,t),this.renderContext.bufferData(this.renderContext.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),this.renderContext.STATIC_DRAW),i&&this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,i)},e.prototype.clearContext=function(){this.renderContext.depthMask(!0),this.renderContext.clear(this.renderContext.COLOR_BUFFER_BIT|this.renderContext.DEPTH_BUFFER_BIT|this.renderContext.STENCIL_BUFFER_BIT)},e.prototype.update=function(){this._contextSetTest.clear(),this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,null),this.renderContext.clearColor(63/255,63/255,63/255,1),this.renderContext.clearDepth(1),this.renderContext.clearStencil(0),this.renderContext.enable(this.renderContext.DEPTH_TEST),this.renderContext.depthMask(!0),this.renderContext.enable(this.renderContext.BLEND),this.renderContext.frontFace(this.renderContext.CW),this.renderContext.clear(this.renderContext.COLOR_BUFFER_BIT|this.renderContext.DEPTH_BUFFER_BIT|this.renderContext.STENCIL_BUFFER_BIT),this.setBlendParticleFactors(0),this.renderContext.disable(this.renderContext.CULL_FACE),this.setTextureNum=0,this.setProgramNum=0},e.prototype.updateFBO=function(t){this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,t.frameBuffer),this.renderContext.clearColor(63/255,63/255,63/255,1),this.renderContext.clearDepth(1),this.renderContext.clearStencil(0),this.renderContext.enable(this.renderContext.DEPTH_TEST),this.renderContext.depthMask(!0),this.renderContext.enable(this.renderContext.BLEND),this.renderContext.frontFace(this.renderContext.CW),this.renderContext.clear(this.renderContext.COLOR_BUFFER_BIT|this.renderContext.DEPTH_BUFFER_BIT|this.renderContext.STENCIL_BUFFER_BIT),this.setBlendParticleFactors(0),this.renderContext.disable(this.renderContext.CULL_FACE)},e.prototype.setDepthTest=function(t){t?this.renderContext.enable(this.renderContext.DEPTH_TEST):this.renderContext.disable(this.renderContext.DEPTH_TEST)},e.prototype.setWriteDepth=function(t){this._contextSetTest.testZbuffer(t)||this.renderContext.depthMask(t)},e.prototype.setBlendParticleFactors=function(t){if(!this._contextSetTest.testBlend(t))switch(t){case 0:this.renderContext.blendFunc(this.renderContext.ONE,this.renderContext.ONE_MINUS_SRC_ALPHA);break;case 1:this.renderContext.blendFunc(this.renderContext.ONE,this.renderContext.ONE);break;case 2:this.renderContext.blendFunc(this.renderContext.DST_COLOR,this.renderContext.ZERO);break;case 3:this.renderContext.blendFunc(this.renderContext.ONE,this.renderContext.ONE_MINUS_SRC_COLOR);break;case 4:this.renderContext.blendFunc(this.renderContext.SRC_ALPHA,this.renderContext.ONE);break;case-1:this.renderContext.blendFunc(this.renderContext.SRC_ALPHA,this.renderContext.ONE_MINUS_SRC_ALPHA)}},e.prototype.setProgram=function(t){this._contextSetTest.testProgram(t)||(this.renderContext.useProgram(t),this.setProgramNum++)},e.prototype.getLocation=function(t,e){return this.renderContext.getUniformLocation(t,e)},e.prototype.setVcMatrix3fv=function(t,e,i){this.renderContext.uniformMatrix3fv(t.getWebGLUniformLocation(e),!1,i)},e.prototype.setVcMatrix4fv=function(t,e,i){this.renderContext.uniformMatrix4fv(t.getWebGLUniformLocation(e),!1,i)},e.prototype.setVpMatrix=function(t,e){this._contextSetTest.testVp()||this.renderContext.uniformMatrix4fv(t.getWebGLUniformLocation("vpMatrix3D"),!1,e)},e.prototype.setVc4fv=function(t,e,i){this.renderContext.uniform4fv(t.getWebGLUniformLocation(e),i)},e.prototype.setVc1fv=function(t,e,i){this.renderContext.uniform1fv(t.getWebGLUniformLocation(e),i)},e.prototype.setVc3fv=function(t,e,i){this.renderContext.uniform3fv(t.getWebGLUniformLocation(e),i)},e.prototype.setVc2fv=function(t,e,i){this.renderContext.uniform2fv(t.getWebGLUniformLocation(e),i)},e.prototype.setVcFloat=function(t,e,i){this.renderContext.uniform1fv(t.getWebGLUniformLocation(e),i)},e.prototype.setuniform3f=function(t,e,i,n,o){this.renderContext.uniform3f(t.getWebGLUniformLocation(e),i,n,o)},e.prototype.setVcMatrix4fvLocation=function(t,e){this.renderContext.uniformMatrix4fv(t,!1,e)},e.prototype.setVc2f=function(t,e,i,n){this.renderContext.uniform2f(t.getWebGLUniformLocation(e),i,n)},e.prototype.setVcMatrix2fvLocation=function(t,e){this.renderContext.uniformMatrix2fv(t,!1,e)},e.prototype.setVc4fvLocation=function(t,e){this.renderContext.uniform4fv(t,e)},e.prototype.setVa=function(t,e,i){this._contextSetTest.testVa(i),this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,i),this.renderContext.enableVertexAttribArray(t),this.renderContext.vertexAttribPointer(t,e,this.renderContext.FLOAT,!1,0,0)},e.prototype.pushVa=function(t){return!!this._contextSetTest.testVa(t)||(this.renderContext.bindBuffer(this.renderContext.ARRAY_BUFFER,t),!1)},e.prototype.setVaOffset=function(t,e,i,n){this._contextSetTest.enableVaAry[t]||(this.renderContext.enableVertexAttribArray(t),this._contextSetTest.enableVaAry[t]=!0),this.renderContext.vertexAttribPointer(t,e,this.renderContext.FLOAT,!1,i,n)},e.prototype.clearVa=function(t){this._contextSetTest.enableVaAry[t]=!1,this.renderContext.disableVertexAttribArray(t)},e.prototype.drawCall=function(t,e){this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,t),this.renderContext.drawElements(this.renderContext.TRIANGLES,e,this.renderContext.UNSIGNED_SHORT,0)},e.prototype.drawLine=function(t,e){this.renderContext.bindBuffer(this.renderContext.ELEMENT_ARRAY_BUFFER,t),this.renderContext.drawElements(this.renderContext.LINES,e,this.renderContext.UNSIGNED_SHORT,0)},e.prototype.setRenderTexture=function(t,e,i,n,o){void 0===o&&(o=!0),o&&this._contextSetTest.testTexture(e,i)||(0==n?this.renderContext.activeTexture(this.renderContext.TEXTURE0):1==n?this.renderContext.activeTexture(this.renderContext.TEXTURE1):2==n?this.renderContext.activeTexture(this.renderContext.TEXTURE2):3==n?this.renderContext.activeTexture(this.renderContext.TEXTURE3):4==n?this.renderContext.activeTexture(this.renderContext.TEXTURE4):5==n?this.renderContext.activeTexture(this.renderContext.TEXTURE5):6==n&&this.renderContext.activeTexture(this.renderContext.TEXTURE6),this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,i),this.renderContext.uniform1i(t.getWebGLUniformLocation(e),n),this.setTextureNum++)},e.prototype.setRenderTextureCube=function(t,e,i,n){0==n?this.renderContext.activeTexture(this.renderContext.TEXTURE0):1==n?this.renderContext.activeTexture(this.renderContext.TEXTURE1):2==n?this.renderContext.activeTexture(this.renderContext.TEXTURE2):3==n?this.renderContext.activeTexture(this.renderContext.TEXTURE3):4==n?this.renderContext.activeTexture(this.renderContext.TEXTURE4):5==n?this.renderContext.activeTexture(this.renderContext.TEXTURE5):6==n&&this.renderContext.activeTexture(this.renderContext.TEXTURE6),this.renderContext.bindTexture(this.renderContext.TEXTURE_CUBE_MAP,i),this.renderContext.uniform1i(this.renderContext.getUniformLocation(t,e),n)},e.prototype.updateTexture=function(t,e,i,n){this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,t),this.renderContext.texSubImage2D(this.renderContext.TEXTURE_2D,0,e,i,this.renderContext.RGBA,this.renderContext.UNSIGNED_BYTE,n)},e.prototype.getTexture=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var o=new l.Rectangle(0,0,Math.pow(2,Math.ceil(Math.log(t.width)/Math.log(2))),Math.pow(2,Math.ceil(Math.log(t.height)/Math.log(2))));if(o.width!=t.width||o.height!=t.height){var a=l.UIManager.getInstance().getContext2D(o.width,o.height,!1);return a.drawImage(t,0,0,t.width,t.height,0,0,o.width,o.height),this.getTexture(a.canvas,0,0)}var r,s,u=this.renderContext.getParameter(this.renderContext.TEXTURE_BINDING_2D),h=this.renderContext.createTexture();return this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,h),this.renderContext.texImage2D(this.renderContext.TEXTURE_2D,0,this.renderContext.RGBA,this.renderContext.RGBA,this.renderContext.UNSIGNED_BYTE,t),r=0==i?this.renderContext.LINEAR:this.renderContext.NEAREST,0==i?0==n?s=this.renderContext.LINEAR:1==n?s=this.renderContext.LINEAR_MIPMAP_LINEAR:2==n&&(s=this.renderContext.LINEAR_MIPMAP_NEAREST):0==n?s=this.renderContext.NEAREST:1==n?s=this.renderContext.NEAREST_MIPMAP_LINEAR:2==n&&(s=this.renderContext.NEAREST_MIPMAP_NEAREST),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MAG_FILTER,r),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MIN_FILTER,s),0==e?(this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_S,this.renderContext.REPEAT),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_T,this.renderContext.REPEAT)):(this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_S,this.renderContext.CLAMP_TO_EDGE),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_T,this.renderContext.CLAMP_TO_EDGE)),0!=n&&this.renderContext.generateMipmap(this.renderContext.TEXTURE_2D),u&&this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,u),h},e.prototype.creatTexture=function(t,e,i){void 0===i&&(i=0);var n=this.renderContext.getParameter(this.renderContext.TEXTURE_BINDING_2D),o=this.renderContext.createTexture();return this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,o),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MAG_FILTER,this.renderContext.LINEAR),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MIN_FILTER,this.renderContext.LINEAR),0==i?(this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_S,this.renderContext.REPEAT),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_T,this.renderContext.REPEAT)):(this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_S,this.renderContext.CLAMP_TO_EDGE),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_WRAP_T,this.renderContext.CLAMP_TO_EDGE)),this.renderContext.texImage2D(this.renderContext.TEXTURE_2D,0,this.renderContext.RGB,t,e,0,this.renderContext.RGB,this.renderContext.UNSIGNED_BYTE,null),n&&this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,n),o},e.prototype.createFramebuffer=function(){var t=this.renderContext.createFramebuffer();return this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,t),t},e.prototype.deleteBuffer=function(t){this.renderContext.deleteBuffer(t)},e.prototype.deleteTexture=function(t){this.renderContext.deleteTexture(t)},e.prototype.deleteShader=function(t){this.renderContext.deleteShader(t.vShader),this.renderContext.deleteShader(t.fShader),this.renderContext.deleteProgram(t.program)},e.prototype.cullFaceBack=function(t){this._contextSetTest.testCull(t)||(t?(this.renderContext.enable(this.renderContext.CULL_FACE),this.renderContext.cullFace(this.renderContext.FRONT)):this.renderContext.disable(this.renderContext.CULL_FACE))},e.prototype.getFBO=function(){var t=s.fw,e=s.fh,i=this.renderContext.createFramebuffer();this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,i);var n=this.renderContext.createRenderbuffer();this.renderContext.bindRenderbuffer(this.renderContext.RENDERBUFFER,n),this.renderContext.renderbufferStorage(this.renderContext.RENDERBUFFER,this.renderContext.DEPTH_COMPONENT16,t,e),this.renderContext.framebufferRenderbuffer(this.renderContext.FRAMEBUFFER,this.renderContext.DEPTH_ATTACHMENT,this.renderContext.RENDERBUFFER,n);var o=this.renderContext.getParameter(this.renderContext.TEXTURE_BINDING_2D),a=this.renderContext.createTexture();this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,a),this.renderContext.texImage2D(this.renderContext.TEXTURE_2D,0,this.renderContext.RGBA,t,e,0,this.renderContext.RGBA,this.renderContext.UNSIGNED_BYTE,null),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MAG_FILTER,this.renderContext.LINEAR),this.renderContext.texParameteri(this.renderContext.TEXTURE_2D,this.renderContext.TEXTURE_MIN_FILTER,this.renderContext.LINEAR),this.renderContext.framebufferTexture2D(this.renderContext.FRAMEBUFFER,this.renderContext.COLOR_ATTACHMENT0,this.renderContext.TEXTURE_2D,a,0),this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,null),this.renderContext.bindRenderbuffer(this.renderContext.RENDERBUFFER,null),this.renderContext.bindFramebuffer(this.renderContext.FRAMEBUFFER,null);var r=new s;return r.frameBuffer=i,r.depthBuffer=n,r.texture=a,o&&this.renderContext.bindTexture(this.renderContext.TEXTURE_2D,o),r},e.prototype.clearTest=function(){this._contextSetTest.clear()},e);function e(){this.setTextureNum=0,this.setProgramNum=0}l.Context3D=t;var s=(i.fw=512,i.fh=512,i);function i(){}l.FBO=s;var n=(o.prototype.testTexture=function(t,e){return this._textureDic[t]==e||(this._textureDic[t]=e,!1)},o.prototype.testProgram=function(t){return this._program==t||(this._program=t,this._textureDic=new Object,this._vpMatrix=!1)},o.prototype.testVa=function(t){return this._vabuffer==t||(this._vabuffer=t,!1)},o.prototype.clear=function(){this._blendType=-1e3,this._cullType=!1,this._vpMatrix=!1,this._program=null,this._vabuffer=null},o.prototype.testBlend=function(t){return this._blendType==t||(this._blendType=t,!1)},o.prototype.testCull=function(t){return this._cullType==t||(this._cullType=t,!1)},o.prototype.testZbuffer=function(t){return this._zbufferType==t||(this._zbufferType=t,!1)},o.prototype.testVp=function(){return!!this._vpMatrix||!(this._vpMatrix=!0)},o);function o(){this.enableVaAry=new Array,this.vaAry=new Array,this._blendType=-1e3,this._cullType=!1,this._zbufferType=!0,this._vpMatrix=!1}l.ContextSetTest=n}(tl3d=tl3d||{}),function(t){var e=(Object.defineProperty(i,"viewMatrx3D",{get:function(){return i._viewMatrx3D},set:function(t){i._viewMatrx3D=t},enumerable:!0,configurable:!0}),i.sceneViewHW=500,i.fileRoot="",i.verticalScene=!1,i.effectsLev=2,i.camFar=1e3,i.frameTime=1e3/60,i.MAX_NUMBER=1e7,i.scaleLight=[2],i.useByte=!0,i.fogColor=[0,0,0],i.fogData=[825,.003],i.gameAngle=0,i.sceneNumId=0,i.supportBlob=!1,i);function i(){}t.Scene_data=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Object3D,__extends(n,e),n.prototype.update=function(){},Object.defineProperty(n.prototype,"onStage",{get:function(){return this._onStage},enumerable:!0,configurable:!0}),n.prototype.addStage=function(){this._onStage=!0},n.prototype.removeStage=function(){this._onStage=!1},n.prototype.resize=function(){},n.prototype.destory=function(){this.objData&&this.objData.useNum--},n);function n(){var t=e.call(this)||this;return t.sceneVisible=!0,t._hasDestory=!1,t._onStage=!1,t}t.Display3D=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var e,t=(e=s.Display3D,__extends(i,e),Object.defineProperty(i.prototype,"aabbVect",{get:function(){if(!this._aabbVect){var t=this.aabb,e=t.x,i=t.y,n=t.z,o=t.width,a=t.height,r=t.depth;this._aabbVect=new Array,this._aabbVect.push(new s.Vector3D(e,i,n)),this._aabbVect.push(new s.Vector3D(e+o,i,n)),this._aabbVect.push(new s.Vector3D(e,i+a,n)),this._aabbVect.push(new s.Vector3D(e,i,n+r)),this._aabbVect.push(new s.Vector3D(e+o,i+a,n)),this._aabbVect.push(new s.Vector3D(e+o,i,n+r)),this._aabbVect.push(new s.Vector3D(e,i+a,n+r)),this._aabbVect.push(new s.Vector3D(e+o,i+a,n+r))}return this._aabbVect},enumerable:!0,configurable:!0}),i.prototype.setObjUrl=function(t){var e=this;this.objurl=t,s.ObjDataManager.getInstance().getObjData(s.Scene_data.fileRoot+t,function(t){e.objData=t,e.material&&(e.objData.tangentBuffer||s.ObjDataManager.getInstance().creatTBNBuffer(e.objData))})},i.prototype.setPicUrl=function(t){var e=this;this.picUrl=t,s.TextureManager.getInstance().getTexture(s.Scene_data.fileRoot+t,function(t){e.baseTexture=t})},i.prototype.setLightMapUrl=function(t){var e=this;if(t&&""!=t){var i=s.Scene_data.fileRoot+t;s.TextureManager.getInstance().getTexture(i,function(t){e.lightMapTextureRes=t})}},Object.defineProperty(i.prototype,"lightMapTexture",{get:function(){return this.lightMapTextureRes?this.lightMapTextureRes.texture:null},enumerable:!0,configurable:!0}),i.prototype.setMaterialUrl=function(t,e){var i=this;void 0===e&&(e=null),t=(t=t.replace("_byte.txt",".txt")).replace(".txt","_byte.txt"),this.materialUrl=s.Scene_data.fileRoot+t,s.MaterialManager.getInstance().getMaterialByte(this.materialUrl,function(t){i.material=t,i.material.useNormal&&i.objData&&!i.objData.tangentBuffer&&s.ObjDataManager.getInstance().creatTBNBuffer(i.objData),(i.material.usePbr||i.material.directLight)&&(i._rotationData=new Float32Array(9),i.updateRotationMatrix()),e&&(i.materialParam=new s.MaterialBaseParam,i.materialParam.setData(i.material,e))},null,!0,s.MaterialShader.MATERIAL_SHADER,s.MaterialShader)},Object.defineProperty(i.prototype,"lightProbe",{get:function(){return this._lightProbe},set:function(t){if(this._lightProbe=t,this._lightProbe&&!this.resultSHVec){this.resultSHVec=new Array;for(var e=[.4444730390920146,-.3834955622240026,-.33124467509627725,.09365654209093091,-.05673310882817577,.2120523322966496,.02945768486978205,-.04965996229802928,-.1136529129285836],i=0;i<9;i++)this.resultSHVec.push(new s.Vector3D(e[i],e[i],e[i]))}},enumerable:!0,configurable:!0}),i.prototype.update=function(){this.dynamic&&!this.sceneVisible||this.updateMaterial()},i.prototype.updateMaterial=function(){this.material&&this.objData&&(s.Scene_data.context3D.setBlendParticleFactors(this.material.blendMode),s.Scene_data.context3D.cullFaceBack(this.material.backCull),this.updateBind(),s.Scene_data.context3D.setProgram(this.material.program),s.Scene_data.context3D.setWriteDepth(this.material.writeZbuffer),s.Scene_data.context3D.setVcMatrix4fv(this.material.shader,"posMatrix3D",this.posMatrix.m),this.setCam(),this.setMaterialVc(this.material,this.materialParam),this.setMaterialTexture(this.material,this.materialParam),this.setDirectLight(this.material),this.setMaterialVa(),s.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},i.prototype.setMaterialVa=function(){this.objData.compressBuffer?this.setMaterialVaCompress():this.setMaterialVaIndependent()},i.prototype.setMaterialVaIndependent=function(){s.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),s.Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),this.material.directLight||this.material.noLight||s.Scene_data.context3D.setVa(2,2,this.objData.lightUvBuffer),(this.material.usePbr||this.material.directLight)&&(s.Scene_data.context3D.setVa(3,3,this.objData.normalsBuffer),s.Scene_data.context3D.setVcMatrix3fv(this.material.shader,"rotationMatrix3D",this._rotationData)),this.material.useNormal&&(s.Scene_data.context3D.setVa(4,3,this.objData.tangentBuffer),s.Scene_data.context3D.setVa(5,3,this.objData.bitangentBuffer))},i.prototype.setMaterialVaCompress=function(){s.Scene_data.context3D.pushVa(this.objData.vertexBuffer)||(s.Scene_data.context3D.setVaOffset(0,3,this.objData.stride,0),s.Scene_data.context3D.setVaOffset(1,2,this.objData.stride,this.objData.uvsOffsets),this.material.directLight||this.material.noLight||s.Scene_data.context3D.setVaOffset(2,2,this.objData.stride,this.objData.lightuvsOffsets),(this.material.usePbr||this.material.directLight)&&(s.Scene_data.context3D.setVaOffset(3,3,this.objData.stride,this.objData.normalsOffsets),s.Scene_data.context3D.setVcMatrix3fv(this.material.shader,"rotationMatrix3D",this._rotationData)),this.material.useNormal&&(s.Scene_data.context3D.setVaOffset(4,3,this.objData.stride,this.objData.tangentsOffsets),s.Scene_data.context3D.setVaOffset(5,3,this.objData.stride,this.objData.bitangentsOffsets)))},i.prototype.setDirectLight=function(t){t.directLight&&(s.Scene_data.context3D.setVc3fv(t.shader,"ambientColor",s.Scene_data.light.ambientColor),s.Scene_data.context3D.setVc3fv(t.shader,"sunDirect",s.Scene_data.light.sunDirect),s.Scene_data.context3D.setVc3fv(t.shader,"sunColor",s.Scene_data.light.sunColor))},i.prototype.setCam=function(){s.Scene_data.context3D.setVpMatrix(this.material.shader,s.Scene_data.vpMatrix.m)},i.prototype.setBind=function(t,e){this.bindTarget=t,this.bindSocket=e,this.bindMatrix=new s.Matrix3D},i.prototype.setGroup=function(t,e,i){this._isInGroup=!0,this._groupPos=t,this._groupRotation=e,this._groupScale=i,this.groupMatrix=new s.Matrix3D,this.groupRotationMatrix=new s.Matrix3D,this.groupMatrix.isIdentity=!1,this.groupMatrix.identity(),this.groupMatrix.appendScale(i.x,i.y,i.z),this.groupMatrix.appendRotation(e.x,s.Vector3D.X_AXIS),this.groupMatrix.appendRotation(e.y,s.Vector3D.Y_AXIS),this.groupMatrix.appendRotation(e.z,s.Vector3D.Z_AXIS),this.groupMatrix.appendTranslation(t.x,t.y,t.z),this.groupRotationMatrix.isIdentity=!1,this.groupRotationMatrix.identity(),this.groupRotationMatrix.prependRotation(e.z,s.Vector3D.Z_AXIS),this.groupRotationMatrix.prependRotation(e.y,s.Vector3D.Y_AXIS),this.groupRotationMatrix.prependRotation(e.x,s.Vector3D.X_AXIS)},i.prototype.updateBind=function(){this.bindTarget&&(this.posMatrix.identity(),this.posMatrix.appendScale(this._scaleX,this._scaleY,this._scaleZ),this._isInGroup&&this.posMatrix.append(this.groupMatrix),this.bindTarget.getSocket(this.bindSocket,this.bindMatrix),this.posMatrix.append(this.bindMatrix),this.bindMatrix.copyTo(this._rotationMatrix),this._rotationMatrix.identityPostion(),this._isInGroup&&this._rotationMatrix.prepend(this.groupRotationMatrix),this.sceneVisible=this.bindTarget.visible)},i.prototype.setBaseMaterialVc=function(t){var e=0;t.hasTime&&(e=(s.TimeUtil.getTimer(this._scene?this._scene.startTime:s.TimeUtil.START_TIME)-this.time)%1e5*.001),(t.hasTime||t.usePbr||t.useKill)&&s.Scene_data.context3D.setVc4fv(t.shader,"fc0",[1,0,t.killNum,e]),t.scaleLightMap&&s.Scene_data.context3D.setVcFloat(t.shader,"scalelight",s.Scene_data.scaleLight),!t.usePbr&&1!=t.fogMode||this.setCamPos(t),0!=t.fogMode&&(s.Scene_data.context3D.setVc2fv(t.shader,"fogdata",s.Scene_data.fogData),s.Scene_data.context3D.setVc3fv(t.shader,"fogcolor",s.Scene_data.fogColor))},i.prototype.setCamPos=function(t){t.updateCam(s.Scene_data.cam3D.x/100,s.Scene_data.cam3D.y/100,s.Scene_data.cam3D.z/100)},i.prototype.setMaterialVc=function(t,e){if(void 0===e&&(e=null),!(t.fcNum<=0)){var i=0;t.hasTime&&(i=(s.TimeUtil.getTimer(this._scene?this._scene.startTime:s.TimeUtil.START_TIME)-this.time)%1e5*.001),t.update(i),this.setCamPos(t),e&&e.update(),s.Scene_data.context3D.setVc4fv(t.shader,"fc",t.fcData)}},i.prototype.setMaterialTexture=function(t,e){void 0===e&&(e=null);for(var i=t.texList,n=0;n<i.length;n++)if(i[n].type==s.TexItem.LIGHTMAP)s.Scene_data.context3D.setRenderTexture(t.shader,i[n].name,this.lightMapTexture,i[n].id);else if(i[n].type==s.TexItem.LTUMAP&&s.Scene_data.pubLut)s.Scene_data.context3D.setRenderTexture(t.shader,i[n].name,s.Scene_data.pubLut,i[n].id);else if(i[n].type==s.TexItem.CUBEMAP){if(!t.useDynamicIBL){var o=Math.floor(5*t.roughness);if(s.Scene_data.skyCubeMap){var a=s.Scene_data.skyCubeMap[o];s.Scene_data.context3D.setRenderTextureCube(t.program,i[n].name,a,i[n].id)}}}else i[n].texture&&s.Scene_data.context3D.setRenderTexture(t.shader,i[n].name,i[n].texture,i[n].id);if(e)for(n=0;n<e.dynamicTexList.length;n++)e.dynamicTexList[n].target&&s.Scene_data.context3D.setRenderTexture(t.shader,e.dynamicTexList[n].target.name,e.dynamicTexList[n].texture,e.dynamicTexList[n].target.id)},i.prototype.checkMaterialTexture=function(t){for(var e=t.texList,i=0;i<e.length;i++)if(e[i].type==s.TexItem.LIGHTMAP){if(!this.lightMapTexture)return!1}else if(e[i].type==s.TexItem.LTUMAP){if(!s.Scene_data.pubLut)return!1}else if(e[i].type==s.TexItem.CUBEMAP){if(!t.useDynamicIBL&&!s.Scene_data.skyCubeMap)return!1}else if(!e[i].texture)return!1;return!0},i.prototype.updateRotationMatrix=function(){try{this._rotationMatrix.identity(),this._rotationMatrix.appendRotation(this._rotationX,s.Vector3D.X_AXIS),this._rotationMatrix.appendRotation(this._rotationY,s.Vector3D.Y_AXIS),this._rotationMatrix.appendRotation(this._rotationZ,s.Vector3D.Z_AXIS),this._rotationData&&this._rotationMatrix.getRotaion(this._rotationData)}catch(t){}},i.prototype.setPos=function(t){this.x=t.x,this.y=t.y+10,this.z=t.z},i.prototype.destory=function(){e.prototype.destory.call(this),this.name=null,this.objurl=null,this.picUrl=null,this.materialUrl=null,this.material&&this.material.useNum--,this.materialParam&&(this.materialParam.destory(),this.materialParam=null),this.lightMapTextureRes&&this.lightMapTextureRes.clearUseNum(),this._rotationMatrix=null,this._rotationData=null,this.bindMatrix=null,this.bindTarget=null,this.bindSocket=null,this._groupPos=null,this._groupRotation=null,this._groupScale=null,this.groupMatrix=null,this.groupRotationMatrix=null},i);function i(){var t=e.call(this)||this;return t.time=0,t.dynamic=!1,t._rotationMatrix=new s.Matrix3D,t}s.Display3DSprite=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=i.Display3D,__extends(n,e),n.prototype.setObjUrl=function(t){var e=this;this.objurl=t,i.ObjDataManager.getInstance().getObjData(i.Scene_data.fileRoot+t,function(t){e.objData=t})},n.prototype.setCubeUrl=function(t){var e=this;i.TextureManager.getInstance().loadCubeTexture(t,function(t){e.cubeTextList=t})},n.prototype.update=function(){i.Scene_data.context3D.setProgram(this.program),i.Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",i.Scene_data.viewMatrx3D.m),i.Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",i.Scene_data.cam3D.cameraMatrix.m),i.Scene_data.context3D.setVcMatrix4fv(this.shader,"posMatrix3D",this.posMatrix.m),this.cubeTextList&&i.Scene_data.context3D.setRenderTextureCube(this.program,"s_texture",this.cubeTextList[0],0),i.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),i.Scene_data.context3D.setVa(1,3,this.objData.normalsBuffer),i.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)},n);function n(){var t=e.call(this)||this;return t.shader=i.ProgrmaManager.getInstance().getProgram(i.SkyShader.Sky_Shader),t.program=t.shader.program,t}i.Display3DSky=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(p){var n,t=(n=p.Display3DSprite,__extends(e,n),Object.defineProperty(e.prototype,"isSinging",{get:function(){return this._isSinging},set:function(t){this._isSinging=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curentAction",{get:function(){return this._curentAction},set:function(t){this._curentAction=t},enumerable:!0,configurable:!0}),e.prototype.fixAstartData=function(t){},e.prototype.setRoleUrl=function(e,i){var n=this;e!==this._curMeshUrl&&(this._curMeshUrl=e,this._curMeshLoadCom=!1,this.clearMesh(),p.MeshDataManager.getInstance().getMeshData(e,function(t){n._hasDestory?t.useNum--:e===n._curMeshUrl?n._curMeshLoadCom?t.useNum--:(n._curMeshLoadCom=!0,n._skinMesh=t,n.fileScale=t.fileScale,n.onStage&&n.addSkinMeshParticle(),n._animDic=t.animDic,n.onMeshLoaded(),i&&i()):t.useNum--}))},e.prototype.onMeshLoaded=function(){this.dispatchEvent(new p.BaseEvent(p.BaseEvent.COMPLETE))},e.prototype.clearMesh=function(){this.removeSkinMeshParticle(),this._skinMesh&&this._skinMesh.useNum--,this._skinMesh=null,this._animDic=new Object},e.prototype.addSkinMeshParticle=function(){if(this._skinMesh){var t=new Array;this._partDic.mesh=t;var e=this._skinMesh.meshAry;if(e)for(var i=0;i<e.length;i++)for(var n=e[i].particleAry,o=0;o<n.length;o++){var a,r=n[o];(a=p.ParticleManager.getInstance().getParticleByte(p.Scene_data.fileRoot+r.url)).sourceData||console.log("particle.sourceData error",a,r),a.dynamic=!0,a.bindSocket=r.socketName,t.push(a),(a.bindTarget=this)._scene.addParticle(a)}}},e.prototype.removeSkinMeshParticle=function(){var t=this._partDic.mesh;if(t){for(var e=0;e<t.length;e++)this._scene.removeParticle(t[e]),t[e].destory();this._partDic.mesh=null}},e.prototype.roleResCom=function(t,e){},e.prototype.setMeshUrl=function(t,i){var n=this;void 0===i&&(i=1),this._meshUrl=p.Scene_data.fileRoot+t,p.MeshDataManager.getInstance().getMeshData(this._meshUrl,function(t){for(var e in n._skinMesh=t,1!=i&&(n._skinMesh.type=1),n._animDic)n.processAnimByMesh(n._animDic[e]);t.loadMaterial(function(t){n.loadMaterialCom(t)}),n.fileScale=t.fileScale},i)},Object.defineProperty(e.prototype,"scale",{get:function(){return this._nextScale},set:function(t){this._nextScale=t,this._scaleX=t*this._fileScale,this._scaleY=t*this._fileScale,this._scaleZ=t*this._fileScale,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fileScale",{set:function(t){this._fileScale=t,this._scaleX=this._nextScale*t,this._scaleY=this._nextScale*t,this._scaleZ=this._nextScale*t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{set:function(t){t?this._shadow||(this._shadow=p.ShadowManager.getInstance().addShadow()):this._shadow&&p.ShadowManager.getInstance().removeShadow(this._shadow)},enumerable:!0,configurable:!0}),e.prototype.setShadowSize=function(t){this._shadow&&(this._shadow.size=t)},e.prototype.addStage=function(){n.prototype.addStage.call(this),this.addSkinMeshParticle(),this._shadow&&(this._shadow.visible=!0)},e.prototype.removeStage=function(){for(var t in n.prototype.removeStage.call(this),this._shadow&&p.ShadowManager.getInstance().removeShadow(this._shadow),this._partDic)for(var e=this._partDic[t],i=0;i<e.length;i++)e[i]instanceof p.CombineParticle?this._scene.removeParticle(e[i]):e[i]instanceof p.Display3DSprite&&this._scene.removeSpriteDisplay(e[i])},e.prototype.loadMaterialCom=function(t){t.lightProbe&&(this.lightProbe=!0)},e.prototype.setCollision=function(t,e){},e.prototype.applyVisible=function(){},e.prototype.removePart=function(t){var e=this._partDic[t];if(e){for(var i=0;i<e.length;i++)e[i]instanceof p.CombineParticle?(this._scene.removeParticle(e[i]),e[i].destory()):e[i]instanceof p.Display3DSprite&&(this._scene.removeSpriteDisplay(e[i]),e[i].destory());this._partDic[t]=null,this._partUrl[t]=null,delete this._partDic[t],delete this._partUrl[t]}},e.prototype.addPart=function(t,e,i){var n=this;if(this._partUrl[t]!=i){this._partUrl[t]&&this.removePart(t),this._partDic[t]||(this._partDic[t]=new Array),this._partUrl[t]=i;var o=this._partDic[t];this._scene.groupDataMgr.getGroupData(p.Scene_data.fileRoot+i,function(t){n.loadPartRes(e,t,o)})}},e.prototype.loadPartRes=function(t,e,i){if(!this._hasDestory){for(var n=0;n<e.dataAry.length;n++){var o,a,r,s=e.dataAry[n];if(s.isGroup&&(o=new p.Vector3D(s.x,s.y,s.z),a=new p.Vector3D(s.rotationX,s.rotationY,s.rotationZ),r=new p.Vector3D(s.scaleX,s.scaleY,s.scaleZ)),s.types==p.BaseRes.SCENE_PARTICLE_TYPE){var u=p.ParticleManager.getInstance().getParticleByte(p.Scene_data.fileRoot+s.particleUrl);i.push(u),u.bindTarget=this,u.bindSocket=t,u.dynamic=!0,this._scene.addParticle(u),s.isGroup&&u.setGroup(o,a,r)}else if(s.types==p.BaseRes.PREFAB_TYPE){var h=new p.Display3DSprite;h.setObjUrl(s.objUrl),h.setMaterialUrl(s.materialUrl,s.materialInfoArr),h.dynamic=!0,i.push(h),h.setBind(this,t),this._scene.addSpriteDisplay(h),s.isGroup&&h.setGroup(o,a,r)}}this.applyVisible()}},e.prototype.getSocket=function(t,e){try{if(e.identity(),!this._skinMesh)return void e.append(this.posMatrix);if(!this._skinMesh.boneSocketDic[t])return void((t="none")?e.appendTranslation(this._x,this._y,this._z):e.append(this.posMatrix));var i,n=this._skinMesh.boneSocketDic[t],o=n.index;i=this.getFrameMatrix(o),e.appendScale(1/this._scaleX,1/this._scaleY,1/this._scaleZ),e.appendRotation(n.rotationX,p.Vector3D.X_AXIS),e.appendRotation(n.rotationY,p.Vector3D.Y_AXIS),e.appendRotation(n.rotationZ,p.Vector3D.Z_AXIS),e.appendTranslation(n.x,n.y,n.z),i&&(e.append(this._skinMesh.meshAry[this._skinMesh.meshAry.length-1].bindPosInvertMatrixAry[o]),e.append(i)),e.append(this.posMatrix)}catch(t){console.error("出错啦",t)}},e.prototype.getSunType=function(){return 0},e.prototype.getFrameMatrix=function(t){if(this._animDic[this.curentAction]){var e=this._animDic[this.curentAction];return this._curentFrame>=e.matrixAry.length?e.matrixAry[0][t]:e.matrixAry[this._curentFrame][t]}return this._animDic[this._defaultAction]?(e=this._animDic[this._defaultAction]).matrixAry[this._curentFrame][t]:null},e.prototype.addAction=function(t,e,i){void 0===i&&(i=!1),this._preLoadActionDic[t]=e,t==this._defaultAction||t==this.curentAction?this.setAnimUrl(t,e):i&&this.setAnimUrl(t,e)},e.prototype.setAnimUrl=function(e,t){var i=this;this._waitLoadActionDic[e]=!0,p.AnimManager.getInstance().getAnimData(t,function(t){i._animDic[e]=t,i.processAnimByMesh(t),i._waitLoadActionDic[e]=!1})},e.prototype.randomPlayAction=function(){var t=Object.keys(this._animDic),e=t[random(t.length)];this.play(e,2)},e.prototype.play=function(t,e,i,n){if(void 0===e&&(e=0),void 0===i&&(i=!0),this._completecb=n,this.curentAction!=t)return this.curentAction=t,this._completeState=e,this._actionTime=0,this.updateFrame(0),!!this._animDic.hasOwnProperty(t)||(!this._waitLoadActionDic[t]&&this._preLoadActionDic[t]&&this.setAnimUrl(t,this._preLoadActionDic[t]),!1)},e.prototype.processAnimByMesh=function(t){if(this._skinMesh&&!t.hasProcess){for(var e=0;e<t.matrixAry.length;e++)for(var i=t.matrixAry[e],n=0;n<i.length;n++)i[n].prepend(this._skinMesh.meshAry[0].bindPosMatrixAry[n]);t.hasProcess=!0}},e.prototype.update=function(){if(this._skinMesh){if(this.lightProbe&&(this.resultSHVec=p.LightProbeManager.getInstance().getData(new p.Vector3D(this.x,this.y+10,this.z))),this.updateBind(),this.meshVisible)for(var t=0;this._skinMesh&&this._skinMesh.meshAry&&t<this._skinMesh.meshAry.length;t++)this.updateMaterialMesh(this._skinMesh.meshAry[t]);this.showCapsule&&this.updateShowCapsule()}},e.prototype.updateFrame=function(t){var e;if(this._actionTime+=t,this.curentAction&&this._animDic[this.curentAction])e=this.curentAction;else{if(!this._animDic[this._defaultAction])return;e=this._defaultAction}var i=this._animDic[e];this._curentFrame=float2int(this._actionTime/(2*p.Scene_data.frameTime)),this._curentFrame>=i.matrixAry.length&&(this._completecb&&this._completecb(),0==this._completeState?(this._actionTime=0,this._curentFrame=0):1==this._completeState?this._curentFrame=i.matrixAry.length-1:2==this._completeState?(this._curentFrame=0,this._completeState=0,this.changeAction(this.curentAction)):this._completeState)},e.prototype.changeAction=function(t){this.curentAction=this._defaultAction},e.prototype.destory=function(){for(var t in n.prototype.destory.call(this),this._skinMesh&&this._skinMesh.useNum--,this._partDic)for(var e=this._partDic[t],i=0;e&&i<e.length;i++)e[i]instanceof p.CombineParticle?e[i].destory():e[i]instanceof p.Display3DSprite&&e[i].destory();this._partDic=null,this._hasDestory=!0},e.prototype.updateShowCapsule=function(){this.capsuleLineSprite?(this.capsuleLineSprite.x=this.x,this.capsuleLineSprite.y=this.y+this._capsule.radius,this.capsuleLineSprite.z=this.z,this.capsuleLineSprite.update()):(this.capsuleLineSprite=new p.LineDisplaySprite,this.capsuleLineSprite.clear(),this.capsuleLineSprite.baseColor=new p.Vector3D(1,0,0,1),this.drawCylinder(this._capsule.radius,this._capsule.height),this.drawBall(this._capsule.radius),this.capsuleLineSprite.upToGpu())},e.prototype.drawBall=function(t){var e,i,n,o,a,r,s,u=t;for(a=0;a<=12;a++)for(n=null,o=6;o<12;o++)e=new p.Vector3D(u,0,0),(i=new p.Matrix3D).appendRotation(30*o,p.Vector3D.Z_AXIS),e=i.transformVector(e),(r=new p.Matrix3D).appendRotation(30*a,p.Vector3D.Y_AXIS),e=r.transformVector(e),n&&this.capsuleLineSprite.makeLineMode(n,e),n=e.clone();for(a=1;a<=4;a++)for((r=new p.Matrix3D).appendRotation(-20*a,p.Vector3D.Z_AXIS),s=r.transformVector(new p.Vector3D(u,0,0)),n=null,o=0;o<12;o++)e=s.clone(),(i=new p.Matrix3D).appendRotation(30*o,p.Vector3D.Y_AXIS),e=i.transformVector(e),n&&this.capsuleLineSprite.makeLineMode(n,e),11==o&&this.capsuleLineSprite.makeLineMode(s,e),n=e.clone()},e.prototype.drawCylinder=function(t,e){var i,n,o,a=t,r=e;for(o=0;o<12;o++){var s=new p.Vector3D(a,0,0),u=new p.Vector3D(a,+r,0),h=new p.Matrix3D;h.appendRotation(30*o,p.Vector3D.Y_AXIS);var l=h.transformVector(s),c=h.transformVector(u);this.capsuleLineSprite.makeLineMode(l,c),this.capsuleLineSprite.makeLineMode(c,new p.Vector3D(0,+r,0)),11==o&&(this.capsuleLineSprite.makeLineMode(l,s),this.capsuleLineSprite.makeLineMode(c,u)),(i||n)&&(this.capsuleLineSprite.makeLineMode(l,i),this.capsuleLineSprite.makeLineMode(c,n)),i=l.clone(),n=c.clone()}},e.prototype.setVcMatrix=function(t){p.Scene_data.context3D.setVpMatrix(t.material.shader,p.Scene_data.vpMatrix.m),p.Scene_data.context3D.setVcMatrix4fv(t.material.shader,"posMatrix3D",this.posMatrix.m)},e.prototype.setVa=function(t){t.compressBuffer?this.setVaCompress(t):this.setVaIndependent(t)},e.prototype.setVaIndependent=function(t){p.Scene_data.context3D.setVa(0,3,t.vertexBuffer),p.Scene_data.context3D.setVa(1,2,t.uvBuffer),p.Scene_data.context3D.setVa(2,4,t.boneIdBuffer),p.Scene_data.context3D.setVa(3,4,t.boneWeightBuffer),t.material.usePbr?(p.Scene_data.context3D.setVa(4,4,t.normalsBuffer),p.Scene_data.context3D.setVcMatrix4fv(t.material.shader,"rotationMatrix3D",this._rotationMatrix.m),t.material.useNormal&&(p.Scene_data.context3D.setVa(5,4,t.tangentBuffer),p.Scene_data.context3D.setVa(6,4,t.bitangentBuffer))):(t.material.lightProbe||t.material.directLight)&&(p.Scene_data.context3D.setVa(4,4,t.normalsBuffer),p.Scene_data.context3D.setVcMatrix4fv(t.material.shader,"rotationMatrix3D",this._rotationMatrix.m))},e.prototype.setVaCompress=function(t){p.Scene_data.context3D.pushVa(t.vertexBuffer)||(p.Scene_data.context3D.setVaOffset(0,3,t.stride,0),p.Scene_data.context3D.setVaOffset(1,2,t.stride,t.uvsOffsets),p.Scene_data.context3D.setVaOffset(2,4,t.stride,t.boneIDOffsets),p.Scene_data.context3D.setVaOffset(3,4,t.stride,t.boneWeightOffsets),t.material.usePbr?(p.Scene_data.context3D.setVaOffset(4,3,t.stride,t.normalsOffsets),p.Scene_data.context3D.setVcMatrix4fv(t.material.shader,"rotationMatrix3D",this._rotationMatrix.m),t.material.useNormal&&(p.Scene_data.context3D.setVaOffset(5,3,t.stride,t.tangentsOffsets),p.Scene_data.context3D.setVaOffset(6,3,t.stride,t.bitangentsOffsets))):(t.material.lightProbe||t.material.directLight)&&(p.Scene_data.context3D.setVaOffset(4,3,t.stride,t.normalsOffsets),p.Scene_data.context3D.setVcMatrix4fv(t.material.shader,"rotationMatrix3D",this._rotationMatrix.m)))},e.prototype.clearVa=function(){p.Scene_data.context3D.clearVa(2),p.Scene_data.context3D.clearVa(3),p.Scene_data.context3D.clearVa(4),p.Scene_data.context3D.clearVa(5),p.Scene_data.context3D.clearVa(6)},e.prototype.updateMaterialMesh=function(t){t.material&&(p.Scene_data.context3D.setProgram(t.material.program),p.Scene_data.context3D.cullFaceBack(!1),p.Scene_data.context3D.setBlendParticleFactors(t.material.blendMode),this.setVcMatrix(t),this.setMaterialVc(t.material,t.materialParam),this.setMaterialTexture(t.material,t.materialParam),this.setVa(t),this.setDirectLight(t.material),this.setMeshVc(t),p.Scene_data.context3D.drawCall(t.indexBuffer,t.treNum))},e.prototype.setLightProbeVc=function(t){if(t.lightProbe)for(var e=0;e<this.resultSHVec.length;e++)p.Scene_data.context3D.setVc3fv(t.shader,"sh["+e+"]",[this.resultSHVec[e].x,this.resultSHVec[e].y,this.resultSHVec[e].z])},e.prototype.setMeshVc=function(t){var e;if(this._animDic[this.curentAction])e=this._animDic[this.curentAction];else{if(!this._animDic[this._defaultAction])return;e=this._animDic[this._defaultAction]}var i=e.getBoneQPAryByMesh(t)[t.uid][this._curentFrame];i&&(p.Scene_data.context3D.setVc4fv(t.material.shader,"boneQ",i.quat),p.Scene_data.context3D.setVc3fv(t.material.shader,"boneD",i.pos))},e.prototype.setPos=function(t){n.prototype.setPos.call(this,t),this._shadow&&(this._shadow.x=t.x,this._shadow.y=t.y+8,this._shadow.z=t.z)},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.updateMatrix(),this._shadow&&(this._shadow.x=t),this.changePos()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.updateMatrix(),this._shadow&&(this._shadow.y=t),this.changePos()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this.updateMatrix(),this._shadow&&(this._shadow.z=t),this.changePos()},enumerable:!0,configurable:!0}),e.prototype.changePos=function(){},e);function e(){var t=n.call(this)||this;return t._completeState=0,t._defaultAction="stand",t._curentFrame=0,t._actionTime=0,t._fileScale=1,t._hasDestory=!1,t._isSinging=!1,t.meshVisible=!0,t._nextScale=1,t.locationDic=new Object,t._animDic=new Object,t._partDic=new Object,t._partUrl=new Object,t._preLoadActionDic=new Object,t._waitLoadActionDic=new Object,t.showCapsule=!1,t._enablePhysics=!1,t}p.Display3dMovie=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=i.Display3dMovie,__extends(n,e),Object.defineProperty(n.prototype,"fileScale",{set:function(t){this._fileScale=t;for(var e=0;e<this.batchPos.length;e++)this.batchPos[e].fileScale=t},enumerable:!0,configurable:!0}),n.prototype.addSun=function(t){this.batchPos.push(t),t.fileScale=this._fileScale},n.prototype.setVcMatrix=function(t){i.Scene_data.context3D.setVcMatrix4fv(t.material.shader,"viewMatrix3D",i.Scene_data.viewMatrx3D.m),i.Scene_data.context3D.setVcMatrix4fv(t.material.shader,"camMatrix3D",i.Scene_data.cam3D.cameraMatrix.m),i.Scene_data.context3D.setVcMatrix4fv(t.material.shader,"rotationMatrix3D",this._rotationMatrix.m);for(var e=0;e<this.batchPos.length;e++)i.Scene_data.context3D.setVcMatrix4fv(t.material.shader,"posMatrixAry["+e+"]",this.batchPos[e].posMatrix.m)},n.prototype.setLightProbeVc=function(t){},n.prototype.setVa=function(t){i.Scene_data.context3D.setVa(0,3,t.vertexBuffer),i.Scene_data.context3D.setVa(1,3,t.uvBuffer),i.Scene_data.context3D.setVa(2,4,t.boneIdBuffer),i.Scene_data.context3D.setVa(3,4,t.boneWeightBuffer),t.material.usePbr?(i.Scene_data.context3D.setVa(4,4,t.normalsBuffer),t.material.useNormal&&(i.Scene_data.context3D.setVa(5,4,t.tangentBuffer),i.Scene_data.context3D.setVa(6,4,t.bitangentBuffer))):(t.material.lightProbe||t.material.directLight)&&i.Scene_data.context3D.setVa(4,4,t.normalsBuffer)},n.prototype.addStage=function(){if(e.prototype.addStage.call(this),this.batchPos.length)for(var t=0;t<this.batchPos.length;t++)this.batchPos[t].add()},n.prototype.removeStage=function(){if(e.prototype.removeStage.call(this),this.batchPos.length)for(var t=0;t<this.batchPos.length;t++)this.batchPos[t].remove()},n);function n(){var t=e.call(this)||this;return t.batchNum=0,t.batchPos=new Array,t}i.Display3dBatchMovie=t;var o,a=(o=i.Object3D,__extends(r,o),Object.defineProperty(r.prototype,"shadow",{set:function(t){t&&(this._shadow||(this._shadow=i.ShadowManager.getInstance().addShadow(),this._shadow.x=this._x,this._shadow.y=this._y,this._shadow.z=this._z))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fileScale",{set:function(t){this._fileScale=t,this._scaleX*=t,this._scaleY*=t,this._scaleZ*=t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scale",{set:function(t){this._scaleX=t*this._fileScale,this._scaleY=t*this._fileScale,this._scaleZ=t*this._fileScale,this.posData[3]=20*t,this.updateMatrix()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.posData[0]=t,this.updateMatrix(),this._shadow&&(this.retinueShadowFix?this._shadow.x=t+this.retinueShadowFix.x:this._shadow.x=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.posData[1]=t,this.updateMatrix(),this._shadow&&(this.retinueShadowFix?this._shadow.y=t+this.retinueShadowFix.y+2:this._shadow.y=t+2)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this.posData[2]=t,this.updateMatrix(),this._shadow&&(this.retinueShadowFix?this._shadow.z=t+this.retinueShadowFix.z:this._shadow.z=t)},enumerable:!0,configurable:!0}),r.prototype.add=function(){this._shadow&&(this._shadow.visible=!0)},r.prototype.remove=function(){this._shadow&&(this._shadow.visible=!1)},r);function r(){var t=null!==o&&o.apply(this,arguments)||this;return t.posData=[0,0,0,10],t.hasReach=!1,t._fileScale=1,t}i.Movie3D=a}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=e.Display3D,__extends(n,i),n.prototype.addShadow=function(t){this.shadowList.push(t),(t.display=this).applyObjData()},n.prototype.removeShadow=function(t){var e=this.shadowList.indexOf(t);-1!=e&&(this.shadowList.splice(e,1),this.applyObjData()),this.shadowList.length},n.prototype.stateChage=function(){for(var t=0;t<this.shadowList.length&&!this.shadowList[t].visible;t++);t==this.shadowList.length?this.needUpdate=!1:this.needUpdate=!0},n.prototype.hasIdle=function(){return this.shadowList.length<30},n.prototype.applyObjData=function(){this.objData.vertices.length=0,this.objData.uvs.length=0;for(var t=this.objData.indexs.length=0;t<this.shadowList.length;t++)this.objData.vertices.push(-5,0,5,5,0,5,5,0,-5,-5,0,-5),this.objData.uvs.push(0,0,t,0,1,t,1,1,t,1,0,t),this.objData.indexs.push(4*t,1+4*t,2+4*t,4*t,2+4*t,3+4*t);this.objData.treNum=6*this.shadowList.length,this.objData.vertexBuffer?(e.Scene_data.context3D.uploadBuff3DByBuffer(this.objData.vertexBuffer,this.objData.vertices),e.Scene_data.context3D.uploadBuff3DByBuffer(this.objData.uvBuffer,this.objData.uvs),e.Scene_data.context3D.uploadIndexBuff3DByBuffer(this.objData.indexBuffer,this.objData.indexs)):(this.objData.vertexBuffer=e.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=e.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=e.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs))},n.prototype.update=function(){if(this.needUpdate=!0,this.needUpdate&&0!=this.shadowList.length&&this.objData.treNum){e.Scene_data.context3D.setBlendParticleFactors(0),e.Scene_data.context3D.setProgram(this.program),e.Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",e.Scene_data.viewMatrx3D.m),e.Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",e.Scene_data.cam3D.cameraMatrix.m),this.locationFloat32.length!=4*this.shadowList.length&&(this.locationFloat32=new Float32Array(4*this.shadowList.length));for(var t=0;t<this.shadowList.length;t++)this.shadowList[t].visible?(this.locationFloat32[4*t+0]=this.shadowList[t].data[0],this.locationFloat32[4*t+1]=this.shadowList[t].data[1],this.locationFloat32[4*t+2]=this.shadowList[t].data[2],this.locationFloat32[4*t+3]=this.shadowList[t].data[3]):(this.locationFloat32[4*t+0]=0,this.locationFloat32[4*t+1]=1e4,this.locationFloat32[4*t+2]=0,this.locationFloat32[4*t+3]=0);e.Scene_data.context3D.setVc4fvLocation(this.posProLocation,this.locationFloat32),e.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),e.Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),e.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",n.texture,0),e.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)}},n);function n(){var t=i.call(this)||this;return t.needUpdate=!1,t.locationFloat32=new Float32Array(0),t.shadowList=new Array,t.objData=new e.ObjData,t.shader=e.ProgrmaManager.getInstance().getProgram(e.Display3DShadowShader.Display3DShadowShader),t.program=t.shader.program,t.posProLocation=e.Scene_data.context3D.getLocation(t.program,"pos"),t}e.Display3dShadow=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=i.Display3D,__extends(n,e),n.prototype.initData=function(){this.objData=new i.ObjData,this.objData.vertices.push(-1,1,.99,1,1,.99,1,-1,.99,-1,-1,.99),this.objData.uvs.push(0,0,1,0,1,1,0,1),this.objData.indexs.push(0,1,2,0,2,3),this.objData.treNum=6,this.objData.vertexBuffer=i.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=i.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=i.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)},n.prototype.resize=function(){this.appleyPos()},n.prototype.setImgInfo=function(t,e,i){this.setImgUrl(t),this._width=e,this._height=i},n.prototype.setImgUrl=function(t){},n.prototype.appleyPos=function(){var t=this._width/i.Scene_data.stageWidth,e=this._height/i.Scene_data.stageHeight;t<e?(this._scaleData[0]=1,this._scaleData[1]=this._height/i.Scene_data.stageHeight/t):(this._scaleData[0]=this._width/i.Scene_data.stageWidth/e,this._scaleData[1]=1)},n.prototype.update=function(){this.appleyPos(),i.Scene_data.context3D.setBlendParticleFactors(0),i.Scene_data.context3D.setProgram(this.program),i.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),i.Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),i.Scene_data.context3D.setVc2fv(this.shader,"scale",this._scaleData),i.Scene_data.context3D.setVcFloat(this.shader,"alpha",[1]),i.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0),i.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)},n);function n(){var t=e.call(this)||this;return t._scaleData=[1,1],t.shader=i.ProgrmaManager.getInstance().getProgram(i.UIImageShader.UI_IMG_SHADER),t.program=t.shader,t.initData(),t}i.Display3dBg=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=u.Display3D,__extends(i,e),i.prototype.update=function(){this.watchCaramMatrix.identity(),this.watchCaramMatrix.prependRotation(-u.Scene_data.cam3D.rotationY,u.Vector3D.Y_AXIS),this.watchCaramMatrix.prependRotation(-u.Scene_data.cam3D.rotationX,u.Vector3D.X_AXIS),u.Scene_data.context3D.setProgram(this.program),u.Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",u.Scene_data.viewMatrx3D.m),u.Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",u.Scene_data.cam3D.cameraMatrix.m),u.Scene_data.context3D.setVcMatrix4fv(this.shader,"watchCamMatrix3D",this.watchCaramMatrix.m);for(var t=0;t<this.batchPos.length;t++)u.Scene_data.context3D.setVc4fv(this.shader,"posdata["+t+"]",this.batchPos[t].posData);u.Scene_data.context3D.setVc2fv(this.shader,"outuv",this._uvData),u.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.movieTexture,0),u.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),u.Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),u.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)},i.prototype.updateFrame=function(t){this._time+=t;var e=float2int(this._time/(2*u.Scene_data.frameTime)/this.frameRate);e>=this._allFrame&&(0==this._state?e=this._time=0:1==this._state?e=this._allFrame-1:2==this._state?(this.play("stand"),e=0,this._state=0):this._state),this._uvData[0]=e*this._uWidth},i.prototype.play=function(t,e){void 0===e&&(e=0),this._state=e,this._time=0,"walk"==t?this._uvData[1]=this._vWidth:-1!=t.indexOf("attack")?this._uvData[1]=2*this._vWidth:this._uvData[1]=0},i.prototype.addSun=function(t){this.batchPos.push(t)},i.prototype.setUrl=function(t){},i.prototype.initData=function(t,e,i,n,o,a){void 0===a&&(a=!1),this.objData.vertices.length=0,this.objData.uvs.length=0,this.objData.indexs.length=0,this._uWidth=i,this._vWidth=n,this._allFrame=o;for(var r=0;r<t;r++){this.objData.vertices.push(-.5*e,1,0,.5*e,1,0,.5*e,0,0,-.5*e,0,0);var s=0;a&&(s=float2int(o*Math.random())*i),this.objData.uvs.push(0+s,0,r,i+s,0,r,i+s,+n,r,0+s,+n,r),this.objData.indexs.push(4*r,1+4*r,2+4*r,4*r,2+4*r,3+4*r)}this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer?(u.Scene_data.context3D.uploadBuff3DByBuffer(this.objData.vertexBuffer,this.objData.vertices),u.Scene_data.context3D.uploadBuff3DByBuffer(this.objData.uvBuffer,this.objData.uvs),u.Scene_data.context3D.uploadIndexBuff3DByBuffer(this.objData.indexBuffer,this.objData.indexs)):(this.objData.vertexBuffer=u.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=u.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=u.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs))},i.prototype.addStage=function(){if(e.prototype.addStage.call(this),this.batchPos.length)for(var t=0;t<this.batchPos.length;t++)this.batchPos[t].add()},i.prototype.removeStage=function(){if(e.prototype.removeStage.call(this),this.batchPos.length)for(var t=0;t<this.batchPos.length;t++)this.batchPos[t].remove()},i);function i(){var t=e.call(this)||this;return t.batchPos=new Array,t._time=0,t._allFrame=12,t._uvData=[0,0],t._uWidth=0,t._vWidth=0,t._state=0,t.frameRate=3,t.objData=new u.ObjData,t.watchCaramMatrix=new u.Matrix3D,t.shader=u.ProgrmaManager.getInstance().getProgram(u.Movie2DShader.MOVIE2D_SHADER),t.program=t.shader.program,t}u.Display2dMovie=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=n.Display3DSprite,__extends(i,e),i.prototype.loadRes=function(t){var e=this;this.modelRes||(this.modelRes=new n.ModelRes),this.modelRes.load(n.Scene_data.fileRoot+getModelUrl(t),function(){e.loadResComFinish()})},i.prototype.loadResComFinish=function(){this.setObjUrl(this.modelRes.objUrl),this.setMaterialUrl(this.modelRes.materialUrl)},i.prototype.loadGroup=function(t){var e=this,i=new n.GroupRes;i.load(n.Scene_data.fileRoot+"model/"+t+".txt",function(){e.loadPartRes(i)})},i.prototype.loadPartRes=function(t){for(var e=0;e<t.dataAry.length;e++){var i=t.dataAry[e];i.types==n.BaseRes.SCENE_PARTICLE_TYPE||i.types==n.BaseRes.PREFAB_TYPE&&(this.setObjUrl(i.objUrl),this.setMaterialUrl(i.materialUrl,i.materialInfoArr))}},i.prototype.resize=function(){this.uiViewMatrix.identity(),this.uiViewMatrix.perspectiveFieldOfViewLH(1,1,500,5e3),this.uiViewMatrix.appendScale(1e3/n.Scene_data.stageWidth,1e3/n.Scene_data.stageHeight,1)},i.prototype.setCam=function(){n.Scene_data.context3D.setVcMatrix4fv(this.material.shader,"viewMatrix3D",this.uiViewMatrix.m),n.Scene_data.context3D.setVcMatrix4fv(this.material.shader,"camMatrix3D",this.uiMatrix.m)},i.prototype.update=function(){n.Scene_data.context3D.setWriteDepth(!0),n.Scene_data.context3D.setDepthTest(!0),e.prototype.update.call(this),n.Scene_data.context3D.setWriteDepth(!1),n.Scene_data.context3D.setDepthTest(!1)},i);function i(){var t=e.call(this)||this;return t.uiMatrix=new n.Matrix3D,t.uiMatrix.prependTranslation(0,0,600),t.uiMatrix.prependRotation(-15,n.Vector3D.X_AXIS),t.uiMatrix.prependRotation(0,n.Vector3D.Y_AXIS),t.uiViewMatrix=new n.Matrix3D,t}n.Display3DUISprite=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=n.Display3D,__extends(i,e),i.prototype.setInfo=function(t,e,i){this._imgAtlas||(this._imgAtlas=new n.UIAtlas),this._imgAtlas.setInfo(t,e,i)},i.prototype.getSprite=function(t){var e=new a;return e.uvData=this._imgAtlas.getRec(t),e},i.prototype.addSprite=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i++)this.batchPos.push(t[i]);this.applyData()},i.prototype.applyData=function(){this.objData.vertices.length=0,this.objData.uvs.length=0;for(var t=this.objData.indexs.length=0;t<this.batchPos.length;t++){var e=this.batchPos[t].uvData,i=e.pixelHeight/e.pixelWitdh;this.objData.vertices.push(-.5*e.width,i*e.width,0,.5*e.width,i*e.width,0,.5*e.width,0,0,-.5*e.width,0,0),this.objData.uvs.push(e.x,e.y,t,e.x+e.width,e.y,t,e.x+e.width,e.y+e.height,t,e.x,e.y+e.height,t),this.objData.indexs.push(4*t,1+4*t,2+4*t,4*t,2+4*t,3+4*t)}this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer?(n.Scene_data.context3D.uploadBuff3DByBuffer(this.objData.vertexBuffer,this.objData.vertices),n.Scene_data.context3D.uploadBuff3DByBuffer(this.objData.uvBuffer,this.objData.uvs),n.Scene_data.context3D.uploadIndexBuff3DByBuffer(this.objData.indexBuffer,this.objData.indexs)):(this.objData.vertexBuffer=n.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=n.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=n.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs))},i.prototype.update=function(){if(0!=this.batchPos.length){this.watchCaramMatrix.identity(),this.watchCaramMatrix.prependRotation(-n.Scene_data.cam3D.rotationY,n.Vector3D.Y_AXIS),this.watchCaramMatrix.prependRotation(-n.Scene_data.cam3D.rotationX,n.Vector3D.X_AXIS),n.Scene_data.context3D.setProgram(this.program),n.Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",n.Scene_data.viewMatrx3D.m),n.Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",n.Scene_data.cam3D.cameraMatrix.m),n.Scene_data.context3D.setVcMatrix4fv(this.shader,"watchCamMatrix3D",this.watchCaramMatrix.m);for(var t=0;t<this.batchPos.length;t++)n.Scene_data.context3D.setVc4fv(this.shader,"posdata["+t+"]",this.batchPos[t].posData);n.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this._imgAtlas.texture,0),n.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),n.Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),n.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)}},i);function i(){var t=e.call(this)||this;return t.batchPos=new Array,t.objData=new n.ObjData,t.watchCaramMatrix=new n.Matrix3D,t.shader=n.ProgrmaManager.getInstance().getProgram(n.Sprite2DShader.SPRITE2D_SHADER),t.program=t.shader.program,t}n.Display2DSprite=t;var o,a=(o=n.Object3D,__extends(r,o),r.prototype.setPos=function(t,e,i){this.x=t,this.y=e,this.z=i},Object.defineProperty(r.prototype,"scale",{get:function(){return this._scaleX},set:function(t){this._scaleX=t,this.posData[3]=100*t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"x",{set:function(t){this._x=t,this.posData[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{set:function(t){this._y=t,this.posData[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"z",{set:function(t){this._z=t,this.posData[2]=t},enumerable:!0,configurable:!0}),r);function r(){var t=null!==o&&o.apply(this,arguments)||this;return t.posData=[0,0,0,100],t}}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(y){var t=(m.prototype.mekeUseTexture=function(t){var e=new y.Rectangle(0,0,Math.pow(2,Math.ceil(Math.log(t.width)/Math.log(2))),Math.pow(2,Math.ceil(Math.log(t.height)/Math.log(2))));if(e.width==t.width&&e.height==t.height)return t;for(var i=new y.BitMapData(e.width,e.height),n=0;n<i.width;n++)for(var o=0;o<i.height;o++){var a=t.getRgb(n/i.width*t.width,o/i.height*t.height);i.setRgb(n,o,a)}return i},m.prototype.calibration=function(){this.idBitmap=this.mekeUseTexture(this.idBitmap),this.infoBitmap=this.mekeUseTexture(this.infoBitmap)},m.meshAllgroundData=function(t){for(var e=t.readInt(),i=t.readInt(),n=new Array,o=0;o<e;o++)for(var a=0;a<i;a++){var r=t.readInt(),s=t.readInt(),u=t.readInt(),h=t.readInt(),l=new m;l.idBitmap=new y.BitMapData(u,h),l.infoBitmap=new y.BitMapData(u,h),l.tx=r,l.ty=s,n.push(l);for(var c=0;c<u;c++)for(var p=0;p<h;p++){var d;switch(t.readByte()){case 0:d=new y.Vector3D(0,1,2);break;case 1:d=new y.Vector3D(0,1,3);break;case 2:d=new y.Vector3D(0,2,3);break;case 3:d=new y.Vector3D(1,2,3);break;default:throw new Error("信息索引没有编入")}l.idBitmap.setRgb(c,p,new y.Vector3D(d.x/255,d.y/255,d.z/255,1));var _=new y.Vector3D;_.x=t.readByte()+128,_.y=t.readByte()+128,_.z=255-_.x-_.y,l.infoBitmap.setRgb(c,p,new y.Vector3D(_.x/255,_.y/255,_.z/255,1))}l.calibration()}for(var f=t.readUTF(),g=0;g<n.length;g++)n[g].sixurl=f;return n},m);function m(){}y.GroundDataMesh=t;var e,i=(e=y.Display3DSprite,__extends(n,e),n.prototype.update=function(){this.groundShader&&this.baseSixteenRes&&this.idMapPicDataTexture?this.upDataToDraw():e.prototype.update.call(this)},n.prototype.upDataToDraw=function(){this.groundShader&&this.baseSixteenRes&&(y.Scene_data.context3D.cullFaceBack(!1),y.Scene_data.context3D.setProgram(this.groundShader.program),y.Scene_data.context3D.setVcMatrix4fv(this.groundShader,"viewMatrix3D",y.Scene_data.viewMatrx3D.m),y.Scene_data.context3D.setVcMatrix4fv(this.groundShader,"camMatrix3D",y.Scene_data.cam3D.cameraMatrix.m),y.Scene_data.context3D.setVcMatrix4fv(this.groundShader,"posMatrix3D",this.posMatrix.m),y.Scene_data.context3D.setVc4fv(this.groundShader,"colorData",[1,0,1,1]),y.Scene_data.context3D.pushVa(this.objData.vertexBuffer)||(y.Scene_data.context3D.setVaOffset(0,3,this.objData.stride,0),y.Scene_data.context3D.setVaOffset(1,2,this.objData.stride,this.objData.uvsOffsets)),y.Scene_data.context3D.setRenderTexture(this.groundShader,"idmaptexture",this.idMapPicDataTexture,0),y.Scene_data.context3D.setRenderTexture(this.groundShader,"infotexture",this.infoMapPicDataTexture,1),y.Scene_data.context3D.setRenderTexture(this.groundShader,"sixtexture",this.baseSixteenRes.texture,2),y.Scene_data.context3D.setRenderTexture(this.groundShader,"lightexture",this.lightMapTexture,3),y.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},n.prototype.setGrounDataMesh=function(t){var e=this;this.idMapPicDataTexture=y.Scene_data.context3D.getTexture(t.idBitmap.imgData,0,1),this.infoMapPicDataTexture=y.Scene_data.context3D.getTexture(t.infoBitmap.imgData,0,1);var i=t.sixurl;y.TextureManager.getInstance().getTexture(y.Scene_data.fileRoot+i,function(t){e.baseSixteenRes=t})},n);function n(){var t=e.call(this)||this;return y.ProgrmaManager.getInstance().registe(y.TerrainDisplay3DShader.TerrainDisplay3DShader,new y.TerrainDisplay3DShader),t.groundShader=y.ProgrmaManager.getInstance().getProgram(y.TerrainDisplay3DShader.TerrainDisplay3DShader),t}y.TerrainDisplay3DSprite=i}(tl3d=tl3d||{}),function(i){var t=(n.init=function(t){i.Scene_data.vpMatrix=new i.Matrix3D,i.Scene_data.canvas3D=t,i.Scene_data.context3D=new i.Context3D,i.Scene_data.context3D.init(t),i.UIManager.getInstance().init(),i.Scene_data.cam3D=new i.Camera3D,i.Scene_data.focus3D=new i.Object3D,i.Scene_data.focus3D.x=0,i.Scene_data.focus3D.y=0,i.Scene_data.focus3D.z=0,i.Scene_data.focus3D.rotationY=135,i.Scene_data.focus3D.rotationX=-45,i.Scene_data.light=new i.LightVo,n.testBlob(),n.resetSize(),n.initShadow(),i.TimeUtil.init(),i.PathManager.init()},n.resReady=function(){n.initPbr()},n.testBlob=function(){},n.initPbr=function(){i.Scene_data.pubLut||i.TextureManager.getInstance().getTexture(i.Scene_data.fileRoot+"base/brdf_ltu.jpg",function(t){i.Scene_data.pubLut=t.texture},1)},n.initShadow=function(){i.TextureManager.getInstance().getTexture(i.Scene_data.fileRoot+"base/shadow.png",function(t){i.Display3dShadow.texture=t.texture})},n.resetSize=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),n.needInputTxt||(document.body.clientWidth>document.body.clientHeight?(i.Scene_data.stageWidth=document.body.clientWidth,i.Scene_data.stageHeight=document.body.clientHeight,i.Scene_data.verticalScene=!1):(i.Scene_data.stageWidth=document.body.clientHeight,i.Scene_data.stageHeight=document.body.clientWidth,i.Scene_data.verticalScene=!0),this.needVertical||(i.Scene_data.stageWidth=document.body.clientWidth,i.Scene_data.stageHeight=document.body.clientHeight,i.Scene_data.verticalScene=!1),i.Scene_data.canvas3D.width=i.Scene_data.stageWidth,i.Scene_data.canvas3D.height=i.Scene_data.stageHeight,i.Scene_data.context3D.resetSize(i.Scene_data.stageWidth,i.Scene_data.stageHeight),i.UIManager.getInstance().resize(),this.resetViewMatrx3D(),i.Scene_data.canvas3D.style.position="absolute",i.Scene_data.canvas3D.style.left="0px",i.Scene_data.canvas3D.style.top="0px",i.Scene_data.verticalScene?i.Scene_data.canvas3D.style.transform="matrix(0,1,-1,0,"+i.Scene_data.stageHeight+",0)":i.Scene_data.canvas3D.style.transform="matrix(1,0,0,1,0,0)",i.Scene_data.canvas3D.style.transformOrigin="0px 0px 0px",i.Scene_data.canvas3D.style.top="0px")},n.resetViewMatrx3D=function(){i.Scene_data.viewMatrx3D?i.Scene_data.viewMatrx3D.identity():i.Scene_data.viewMatrx3D=new i.Matrix3D;var t=i.Scene_data.stageWidth,e=i.Scene_data.stageHeight;i.Scene_data.sceneViewHW=Math.max(t,e),i.Scene_data.viewMatrx3D.perspectiveFieldOfViewLH(this.sceneCamScale,1,50,i.Scene_data.camFar),i.Scene_data.viewMatrx3D.appendScale(i.Scene_data.sceneViewHW/t*2*1,t/e*(i.Scene_data.sceneViewHW/t*2),1)},n.update=function(){i.TimeUtil.update(),i.FpsMc.update()},n.unload=function(){},n.needVertical=!0,n.needInputTxt=!1,n.sceneCamScale=1.76,n);function n(){}i.Engine=t}(tl3d=tl3d||{}),function(l){var t=(e.getCamView=function(t,e){t.update();var i=new l.Matrix3D;i.appendRotation(-e.rotationX,l.Vector3D.X_AXIS),i.appendRotation(-e.rotationY,l.Vector3D.Y_AXIS),i.appendTranslation(e.x,e.y,e.z);var n=i.transformVector(new l.Vector3D(0,0,-t.distance));return t.x=n.x,t.y=n.y,t.z=n.z,t.rotationX=e.rotationX,t.rotationY=e.rotationY,t.cameraMatrix.identity(),t.cameraMatrix.prependTranslation(0,0,t.distance),t.cameraMatrix.prependRotation(t.rotationX,l.Vector3D.X_AXIS),t.cameraMatrix.prependRotation(t.rotationY,l.Vector3D.Y_AXIS),t.cameraMatrix.prependTranslation(-e.x,-e.y,-e.z),this.camOffSetShock(t),this.updateVp(),t.cameraMatrix.m},e.camOffSetShock=function(t){this.SetShock&&t.cameraMatrix.prependTranslation(t.offset.x,t.offset.y,t.offset.z)},e.updateVp=function(){l.Scene_data.vpMatrix.identity(),l.Scene_data.vpMatrix.prepend(l.Scene_data.viewMatrx3D),l.Scene_data.vpMatrix.prepend(l.Scene_data.cam3D.cameraMatrix)},e.MathCam=function(t){var e=new l.Matrix3D;e.prependRotation(t.rotationX,l.Vector3D.X_AXIS),e.prependRotation(t.rotationY,l.Vector3D.Y_AXIS),e.prependTranslation(-t.x,-t.y,-t.z),t.cameraMatrix.identity(),t.cameraMatrix.append(e)},e.GetViewHitBoxData=function(t){l.Scene_data.cam3D.cameraMatrix.clone().invert();var e=l.Scene_data.viewMatrx3D.m[0],i=l.Scene_data.viewMatrx3D.m[5];this.viewBoxVecItem?this.lastViewScale.x==e&&this.lastViewScale.y==i||(this.viewBoxVecItem[0]=new l.Vector3D(-t/e,-t/i,t),this.viewBoxVecItem[1]=new l.Vector3D(-t/e,t/i,t),this.viewBoxVecItem[2]=new l.Vector3D(t/e,-t/i,t),this.viewBoxVecItem[3]=new l.Vector3D(t/e,t/i,t),this.viewBoxVecItem[4]=new l.Vector3D(0,0,0)):(this.lastViewScale=new l.Vector2D(e,i),this.viewBoxVecItem=new Array,this.viewBoxVecItem.push(new l.Vector3D(-t/e,-t/i,t)),this.viewBoxVecItem.push(new l.Vector3D(-t/e,t/i,t)),this.viewBoxVecItem.push(new l.Vector3D(t/e,-t/i,t)),this.viewBoxVecItem.push(new l.Vector3D(t/e,t/i,t)),this.viewBoxVecItem.push(new l.Vector3D(0,0,0)))},e.GetViewHitBoxDataCopy=function(t){this.viewBoxVecItem||(this.viewBoxVecItem=new Array,this.viewBoxVecItem.push(new l.Vector3D),this.viewBoxVecItem.push(new l.Vector3D),this.viewBoxVecItem.push(new l.Vector3D),this.viewBoxVecItem.push(new l.Vector3D));var e=t/(l.Scene_data.sceneViewHW/2),i=l.Scene_data.sceneViewHW/2*e,n=l.Scene_data.stageWidth,o=l.Scene_data.stageHeight,a=new l.Matrix3D;a.prependRotation(-l.Scene_data.cam3D.rotationY,l.Vector3D.Y_AXIS),a.prependRotation(-l.Scene_data.cam3D.rotationX,l.Vector3D.X_AXIS);var r=l.Scene_data.viewMatrx3D.transformVector(new l.Vector3D(500,0,500)),s=r.x/r.w,u=n/2/s*e*.8,h=o/2/s*e*.8;this.viewBoxVecItem[0]=this.gettempPos(new l.Vector3D(-u,-h,i),a),this.viewBoxVecItem[1]=this.gettempPos(new l.Vector3D(+u,-h,i),a),this.viewBoxVecItem[2]=this.gettempPos(new l.Vector3D(+u,+h,i),a),this.viewBoxVecItem[3]=this.gettempPos(new l.Vector3D(-u,+h,i),a)},e.gettempPos=function(t,e){var i=e.transformVector(t);return i=i.add(new l.Vector3D(l.Scene_data.cam3D.x,l.Scene_data.cam3D.y,l.Scene_data.cam3D.z))},e.mathmidpoint=function(t,e,i){var n,o,a;n=t.x+(e.x-t.x)*i,o=t.y+(e.y-t.y)*i,a=t.z+(e.z-t.z)*i,t.x=n,t.y=o,t.z=a},e.drawbezier=function(t,e){var i=new Array;if(0==t.length)return{x:0,y:0,z:0};for(var n=0;n<t.length;n++)i.push({x:t[n].x,y:t[n].y,z:t[n].z});for(;1<i.length;){for(var o=0;o<i.length-1;o++)this.mathmidpoint(i[o],i[o+1],e);i.pop()}return i[0]},e.math_distance=function(t,e,i,n){return Math.sqrt((n-e)*(n-e)+(i-t)*(i-t))},e.math_angle=function(t,e,i,n){var o=t-i,a=e-n;return 180*Math.atan(a/o)/Math.PI},e.easeIn=function(t,e,i,n){return i*(t/=n)*t+e},e.easeOut=function(t,e,i,n){return-i*(t/=n)*(t-2)+e},e.easeInOut=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},e.mathDisplay2Dto3DWorldPos=function(t,e,i){void 0===i&&(i=300);var n=l.Scene_data.cam3D.cameraMatrix.clone(),o=l.Scene_data.viewMatrx3D.clone();n.invert(),o.invert();var a=new l.Vector3D;return a.x=e.x-t.x,a.y=e.y-t.y,a.x=2*a.x/t.width-1,a.y=1-2*a.y/t.height,a.w=i,a.x=a.x*a.w,a.y=a.y*a.w,(a=o.transformVector(a)).z=i,a=n.transformVector(a)},e.SetShock=!0,e);function e(){}l.MathClass=t}(tl3d=tl3d||{}),function(d){var t=(e.mathDisplay2Dto3DWorldPos=function(t,e){void 0===e&&(e=300);var i=e/(d.Scene_data.sceneViewHW/2),n=d.Scene_data.sceneViewHW/2*i,o=d.Scene_data.stageWidth,a=d.Scene_data.stageHeight,r=new d.Matrix3D;r.prependRotation(-d.Scene_data.cam3D.rotationY,d.Vector3D.Y_AXIS),r.prependRotation(-d.Scene_data.cam3D.rotationX,d.Vector3D.X_AXIS);var s=d.Scene_data.viewMatrx3D.transformVector(new d.Vector3D(500,0,500)),u=s.x/s.w,h=o/2/u*i,l=a/2/u*i,c=t.x/o*h*2,p=t.y/a*l*2;return this.gettempPos(new d.Vector3D(c-h,l-p,n),r)},e.getGroundPanelPos=function(t){var e=d.MathClass.mathDisplay2Dto3DWorldPos(new d.Rectangle(0,0,d.Scene_data.stageWidth,d.Scene_data.stageHeight),new d.Vector2D(t.x,t.y),300),i=new Array;i.push(new d.Vector3D(0,0,0)),i.push(new d.Vector3D(-100,0,100)),i.push(new d.Vector3D(100,0,100));var n=new d.Vector3D(d.Scene_data.cam3D.x,d.Scene_data.cam3D.y,d.Scene_data.cam3D.z);return this.getLinePlaneInterectPointByTri(n,e,i)},e.gettempPos=function(t,e){var i=e.transformVector(t);return i=i.add(new d.Vector3D(d.Scene_data.cam3D.x,d.Scene_data.cam3D.y,d.Scene_data.cam3D.z))},e.math3DWorldtoDisplay2DPos=function(t){var e=d.Scene_data.cam3D.cameraMatrix.clone();e.append(d.Scene_data.viewMatrx3D.clone());var i=d.Scene_data.stageWidth,n=d.Scene_data.stageHeight,o=e.transformVector(t),a=new d.Vector2D;return a.x=(o.x/o.w+1)*(i/2),a.y=(-o.y/o.w+1)*(n/2),a},e.argbToHex=function(t,e,i,n){return t<<24|e<<16|i<<8|n},e.hexToArgb=function(t){var e=new d.Vector3D;return e.w=t>>24&255,e.x=t>>16&255,e.y=t>>8&255,e.z=255&t,e},e.getLinePlaneInterectPointByTri=function(t,e,i){if(i.length<3)return null;var n=new d.Vector3D(0,2e3,0);return this.getLineAndPlaneIntersectPoint(t,e,i[0],n)},e.getLineAndPlaneIntersectPoint=function(t,e,i,n){var o=new d.Vector3D(t.x-e.x,t.y-e.y,t.z-e.z);o.normalize();var a=o.x*n.x+o.y*n.y+o.z*n.z,r=((i.x-t.x)*n.x+(i.y-t.y)*n.y+(i.z-t.z)*n.z)/a,s=new d.Vector3D;return s.setTo(t.x+o.x*r,t.y+o.y*r,t.z+o.z*r),s},e.lookAt=function(t,e){var i=new d.Matrix3D;return i.buildLookAtLH(t,e,d.Vector3D.Y_AXIS),i},e);function e(){}d.MathUtil=t}(tl3d=tl3d||{}),function(s){var t=(n.prototype.clone=function(t){return void 0===t&&(t=null),(t=t||new n).m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t.m[6]=this.m[6],t.m[7]=this.m[7],t.m[8]=this.m[8],t.m[9]=this.m[9],t.m[10]=this.m[10],t.m[11]=this.m[11],t.m[12]=this.m[12],t.m[13]=this.m[13],t.m[14]=this.m[14],t.m[15]=this.m[15],t},Object.defineProperty(n.prototype,"position",{get:function(){return new s.Vector3D(this.m[12],this.m[13],this.m[14],this.m[15])},enumerable:!0,configurable:!0}),n.prototype.copyTo=function(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t.m[6]=this.m[6],t.m[7]=this.m[7],t.m[8]=this.m[8],t.m[9]=this.m[9],t.m[10]=this.m[10],t.m[11]=this.m[11],t.m[12]=this.m[12],t.m[13]=this.m[13],t.m[14]=this.m[14],t.m[15]=this.m[15]},n.prototype.identity=function(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=0,this.m[4]=0,this.m[5]=1,this.m[6]=0,this.m[7]=0,this.m[8]=0,this.m[9]=0,this.m[10]=1,this.m[11]=0,this.m[12]=0,this.m[13]=0,this.m[14]=0,this.m[15]=1},n.prototype.invert=function(){var t=this.m,e=t[0],i=t[1],n=t[2],o=t[3],a=t[4],r=t[5],s=t[6],u=t[7],h=t[8],l=t[9],c=t[10],p=t[11],d=t[12],_=t[13],f=t[14],g=t[15],y=e*r-i*a,m=e*s-n*a,v=e*u-o*a,b=i*s-n*r,I=i*u-o*r,T=n*u-o*s,w=h*_-l*d,E=h*f-c*d,C=h*g-p*d,S=l*f-c*_,L=l*g-p*_,x=c*g-p*f,A=y*x-m*L+v*S+b*C-I*E+T*w;if(!A)return null;A=1/A,this.m[0]=(r*x-s*L+u*S)*A,this.m[1]=(n*L-i*x-o*S)*A,this.m[2]=(_*T-f*I+g*b)*A,this.m[3]=(c*I-l*T-p*b)*A,this.m[4]=(s*C-a*x-u*E)*A,this.m[5]=(e*x-n*C+o*E)*A,this.m[6]=(f*v-d*T-g*m)*A,this.m[7]=(h*T-c*v+p*m)*A,this.m[8]=(a*L-r*C+u*w)*A,this.m[9]=(i*C-e*L-o*w)*A,this.m[10]=(d*I-_*v+g*y)*A,this.m[11]=(l*v-h*I-p*y)*A,this.m[12]=(r*E-a*S-s*w)*A,this.m[13]=(e*S-i*E+n*w)*A,this.m[14]=(_*m-d*b-f*y)*A,this.m[15]=(h*b-l*m+c*y)*A},n.prototype.invertToMatrix=function(t){var e=this.m,i=e[0],n=e[1],o=e[2],a=e[3],r=e[4],s=e[5],u=e[6],h=e[7],l=e[8],c=e[9],p=e[10],d=e[11],_=e[12],f=e[13],g=e[14],y=e[15],m=i*s-n*r,v=i*u-o*r,b=i*h-a*r,I=n*u-o*s,T=n*h-a*s,w=o*h-a*u,E=l*f-c*_,C=l*g-p*_,S=l*y-d*_,L=c*g-p*f,x=c*y-d*f,A=p*y-d*g,M=m*A-v*x+b*L+I*S-T*C+w*E;if(!M)return null;M=1/M,t.m[0]=(s*A-u*x+h*L)*M,t.m[1]=(o*x-n*A-a*L)*M,t.m[2]=(f*w-g*T+y*I)*M,t.m[3]=(p*T-c*w-d*I)*M,t.m[4]=(u*S-r*A-h*C)*M,t.m[5]=(i*A-o*S+a*C)*M,t.m[6]=(g*b-_*w-y*v)*M,t.m[7]=(l*w-p*b+d*v)*M,t.m[8]=(r*x-s*S+h*E)*M,t.m[9]=(n*S-i*x-a*E)*M,t.m[10]=(_*T-f*b+y*m)*M,t.m[11]=(c*b-l*T-d*m)*M,t.m[12]=(s*C-r*L-u*E)*M,t.m[13]=(i*L-n*C+o*E)*M,t.m[14]=(f*v-_*I-g*m)*M,t.m[15]=(l*I-c*v+p*m)*M},n.prototype.appendTranslation=function(t,e,i){n.tempM.identity(),n.tempM.prependTranslation(t,e,i),this.append(n.tempM)},n.prototype.prependTranslation=function(t,e,i){var n=this.m;n[12]=n[0]*t+n[4]*e+n[8]*i+n[12],n[13]=n[1]*t+n[5]*e+n[9]*i+n[13],n[14]=n[2]*t+n[6]*e+n[10]*i+n[14],n[15]=n[3]*t+n[7]*e+n[11]*i+n[15]},n.prototype.transformVector=function(t){var e=new s.Vector3D;return e.x=this.m[0]*t.x+this.m[4]*t.y+this.m[8]*t.z+this.m[12]*t.w,e.y=this.m[1]*t.x+this.m[5]*t.y+this.m[9]*t.z+this.m[13]*t.w,e.z=this.m[2]*t.x+this.m[6]*t.y+this.m[10]*t.z+this.m[14]*t.w,e.w=this.m[3]*t.x+this.m[7]*t.y+this.m[11]*t.z+this.m[15]*t.w,e},n.prototype.append=function(t){n.tempM.m[0]=t.m[0],n.tempM.m[1]=t.m[1],n.tempM.m[2]=t.m[2],n.tempM.m[3]=t.m[3],n.tempM.m[4]=t.m[4],n.tempM.m[5]=t.m[5],n.tempM.m[6]=t.m[6],n.tempM.m[7]=t.m[7],n.tempM.m[8]=t.m[8],n.tempM.m[9]=t.m[9],n.tempM.m[10]=t.m[10],n.tempM.m[11]=t.m[11],n.tempM.m[12]=t.m[12],n.tempM.m[13]=t.m[13],n.tempM.m[14]=t.m[14],n.tempM.m[15]=t.m[15],n.tempM.prepend(this),this.m[0]=n.tempM.m[0],this.m[1]=n.tempM.m[1],this.m[2]=n.tempM.m[2],this.m[3]=n.tempM.m[3],this.m[4]=n.tempM.m[4],this.m[5]=n.tempM.m[5],this.m[6]=n.tempM.m[6],this.m[7]=n.tempM.m[7],this.m[8]=n.tempM.m[8],this.m[9]=n.tempM.m[9],this.m[10]=n.tempM.m[10],this.m[11]=n.tempM.m[11],this.m[12]=n.tempM.m[12],this.m[13]=n.tempM.m[13],this.m[14]=n.tempM.m[14],this.m[15]=n.tempM.m[15]},n.prototype.prepend=function(t){var e=t.m,i=this.m,n=this.m,o=n[0],a=n[1],r=n[2],s=n[3],u=n[4],h=n[5],l=n[6],c=n[7],p=n[8],d=n[9],_=n[10],f=n[11],g=n[12],y=n[13],m=n[14],v=n[15],b=e[0],I=e[1],T=e[2],w=e[3];i[0]=b*o+I*u+T*p+w*g,i[1]=b*a+I*h+T*d+w*y,i[2]=b*r+I*l+T*_+w*m,i[3]=b*s+I*c+T*f+w*v,b=e[4],I=e[5],T=e[6],w=e[7],i[4]=b*o+I*u+T*p+w*g,i[5]=b*a+I*h+T*d+w*y,i[6]=b*r+I*l+T*_+w*m,i[7]=b*s+I*c+T*f+w*v,b=e[8],I=e[9],T=e[10],w=e[11],i[8]=b*o+I*u+T*p+w*g,i[9]=b*a+I*h+T*d+w*y,i[10]=b*r+I*l+T*_+w*m,i[11]=b*s+I*c+T*f+w*v,b=e[12],I=e[13],T=e[14],w=e[15],i[12]=b*o+I*u+T*p+w*g,i[13]=b*a+I*h+T*d+w*y,i[14]=b*r+I*l+T*_+w*m,i[15]=b*s+I*c+T*f+w*v},n.prototype.appendRotation=function(t,e){n.tempM.identity(),n.tempM.prependRotation(t,e),this.append(n.tempM)},n.prototype.tomat3=function(){Array.prototype.concat.apply([],arguments);var t=new Float32Array([1,0,0,0,1,0,0,0,1]);return t[0]=this.m[0],t[1]=this.m[1],t[2]=this.m[2],t[3]=this.m[4],t[4]=this.m[5],t[5]=this.m[6],t[6]=this.m[8],t[7]=this.m[9],t[8]=this.m[10],t},n.prototype.getRotaion=function(t){t[0]=this.m[0],t[1]=this.m[1],t[2]=this.m[2],t[3]=this.m[4],t[4]=this.m[5],t[5]=this.m[6],t[6]=this.m[8],t[7]=this.m[9],t[8]=this.m[10]},n.prototype.identityPostion=function(){this.m[12]=0,this.m[13]=0,this.m[14]=0},Object.defineProperty(n.prototype,"x",{get:function(){return this.m[12]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.m[13]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"z",{get:function(){return this.m[14]},enumerable:!0,configurable:!0}),n.prototype.prependRotation=function(t,e){var i,n,o,a,r,s,u,h,l,c,p,d,_,f,g,y,m,v,b,I,T,w,E,C,S=this.m,L=this.m,x=e.x,A=e.y,M=e.z,D=Math.sqrt(x*x+A*A+M*M);return Math.abs(D)<1e-6?null:(x*=D=1/D,A*=D,M*=D,i=Math.sin(t*Math.PI/180),o=1-(n=Math.cos(t*Math.PI/180)),a=L[0],r=L[1],s=L[2],u=L[3],h=L[4],l=L[5],c=L[6],p=L[7],d=L[8],_=L[9],f=L[10],g=L[11],y=x*x*o+n,m=A*x*o+M*i,v=M*x*o-A*i,b=x*A*o-M*i,I=A*A*o+n,T=M*A*o+x*i,w=x*M*o+A*i,E=A*M*o-x*i,C=M*M*o+n,S[0]=a*y+h*m+d*v,S[1]=r*y+l*m+_*v,S[2]=s*y+c*m+f*v,S[3]=u*y+p*m+g*v,S[4]=a*b+h*I+d*T,S[5]=r*b+l*I+_*T,S[6]=s*b+c*I+f*T,S[7]=u*b+p*I+g*T,S[8]=a*w+h*E+d*C,S[9]=r*w+l*E+_*C,S[10]=s*w+c*E+f*C,S[11]=u*w+p*E+g*C,L!==S&&(S[12]=L[12],S[13]=L[13],S[14]=L[14],S[15]=L[15]),S)},n.prototype.prependScale=function(t,e,i){var n=this.m,o=this.m;return o[0]=n[0]*t,o[1]=n[1]*t,o[2]=n[2]*t,o[3]=n[3]*t,o[4]=n[4]*e,o[5]=n[5]*e,o[6]=n[6]*e,o[7]=n[7]*e,o[8]=n[8]*i,o[9]=n[9]*i,o[10]=n[10]*i,o[11]=n[11]*i,o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15],o},n.prototype.appendScale=function(t,e,i){n.tempM.identity(),n.tempM.prependScale(t,e,i),this.append(n.tempM)},n.prototype.perspectiveFieldOfViewLH=function(t,e,i,n){var o=1/Math.tan(t/2),a=o/e,r=this.m;r[0]=a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=n/(n-i),r[11]=1,r[12]=0,r[13]=0,r[14]=i*n/(i-n),r[15]=0},n.prototype.fromVtoV=function(t,e){var i=t.cross(e);i.normalize();var n=Math.acos(t.dot(e)),o=new s.Quaternion;o.fromAxisAngle(i,n),o.toMatrix3D(this)},n.prototype.buildLookAtLH=function(t,e,i){var n=this.m,o=new s.Vector3D;o.x=e.x-t.x,o.y=e.y-t.y,o.z=e.z-t.z,o.normalize();var a=i.cross(o);a.normalize();var r=o.cross(a);n[0]=a.x,n[1]=r.x,n[2]=o.x,n[3]=0,n[4]=a.y,n[5]=r.y,n[6]=o.y,n[7]=0,n[8]=a.z,n[9]=r.z,n[10]=o.z,n[11]=0,n[12]=-a.dot(t),n[13]=-r.dot(t),n[14]=-o.dot(t),n[15]=1},n.mul=function(t,e,i){var n=e[0],o=e[1],a=e[2],r=e[3],s=e[4],u=e[5],h=e[6],l=e[7],c=e[8],p=e[9],d=e[10],_=e[11],f=e[12],g=e[13],y=e[14];e=e[15];var m=i[0],v=i[1],b=i[2],I=i[3];return t[0]=m*n+v*s+b*c+I*f,t[1]=m*o+v*u+b*p+I*g,t[2]=m*a+v*h+b*d+I*y,t[3]=m*r+v*l+b*_+I*e,m=i[4],v=i[5],b=i[6],I=i[7],t[4]=m*n+v*s+b*c+I*f,t[5]=m*o+v*u+b*p+I*g,t[6]=m*a+v*h+b*d+I*y,t[7]=m*r+v*l+b*_+I*e,m=i[8],v=i[9],b=i[10],I=i[11],t[8]=m*n+v*s+b*c+I*f,t[9]=m*o+v*u+b*p+I*g,t[10]=m*a+v*h+b*d+I*y,t[11]=m*r+v*l+b*_+I*e,m=i[12],v=i[13],b=i[14],I=i[15],t[12]=m*n+v*s+b*c+I*f,t[13]=m*o+v*u+b*p+I*g,t[14]=m*a+v*h+b*d+I*y,t[15]=m*r+v*l+b*_+I*e,t},n.prototype.toEulerAngles=function(t){void 0===t&&(t=null);var e=new s.Quaternion;return e.fromMatrix(this),e.toEulerAngles(t)},n.tempM=new n,n);function n(){this.isIdentity=!0;this.m=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}s.Matrix3D=t}(tl3d=tl3d||{}),function(m){var t=(e.prototype.print=function(){alert(String(this.x)+" "+String(this.y)+" "+String(this.z)+" "+String(this.w))},e.prototype.toEulerAngles=function(t){void 0===t&&(t=null),t=t||new m.Vector3D;var e=this.x,i=this.y,n=this.z,o=this.w;return t.x=Math.atan2(2*(o*e+i*n),1-2*(e*e+i*i)),t.y=Math.asin(2*(o*i-n*e)),t.z=Math.atan2(2*(o*n+e*i),1-2*(i*i+n*n)),t},e.prototype.toMatrix3D=function(t){void 0===t&&(t=null);var e=(t=t||new m.Matrix3D).m,i=this.x,n=this.y,o=this.z,a=this.w,r=i+i,s=n+n,u=o+o,h=i*r,l=n*r,c=n*s,p=o*r,d=o*s,_=o*u,f=a*r,g=a*s,y=a*u;return e[0]=1-c-_,e[1]=l+y,e[2]=p-g,e[3]=0,e[4]=l-y,e[5]=1-h-_,e[6]=d+f,e[7]=0,e[8]=p+g,e[9]=d-f,e[10]=1-h-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,t},e.prototype.fromAxisAngle=function(t,e){var i=Math.sin(e/2),n=Math.cos(e/2);this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this.w=n,this.normalize()},e.prototype.normalize=function(t){void 0===t&&(t=1);var e=t/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);this.x*=e,this.y*=e,this.z*=e,this.w*=e},e.prototype.fromMatrix=function(t){var e=[0,0,0,0,0,0,0,0,0];e[0]=t.m[0],e[1]=t.m[1],e[2]=t.m[2],e[3]=t.m[4],e[4]=t.m[5],e[5]=t.m[6],e[6]=t.m[8],e[7]=t.m[9],e[8]=t.m[10];var i,n=e[0]+e[4]+e[8],o=[0,0,0,0];if(0<n)i=Math.sqrt(n+1),o[3]=.5*i,i=.5/i,o[0]=(e[5]-e[7])*i,o[1]=(e[6]-e[2])*i,o[2]=(e[1]-e[3])*i;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var r=(a+1)%3,s=(a+2)%3;i=Math.sqrt(e[3*a+a]-e[3*r+r]-e[3*s+s]+1),o[a]=.5*i,i=.5/i,o[3]=(e[3*r+s]-e[3*s+r])*i,o[r]=(e[3*r+a]+e[3*a+r])*i,o[s]=(e[3*s+a]+e[3*a+s])*i}this.x=o[0],this.y=o[1],this.z=o[2],this.w=o[3]},e.prototype.setMd5W=function(){this.w=1-(this.x*this.x+this.y*this.y+this.z*this.z),this.w<0?this.w=0:this.w=-Math.sqrt(this.w)},e.prototype.slerp=function(t,e,i){var n=t.w,o=t.x,a=t.y,r=t.z,s=e.w,u=e.x,h=e.y,l=e.z,c=n*s+o*u+a*h+r*l;if(c<0&&(c=-c,s=-s,u=-u,h=-h,l=-l),c<.95){var p=Math.acos(c),d=1/Math.sin(p),_=Math.sin(p*(1-i))*d,f=Math.sin(p*i)*d;this.w=n*_+s*f,this.x=o*_+u*f,this.y=a*_+h*f,this.z=r*_+l*f}else{this.w=n+i*(s-n),this.x=o+i*(u-o),this.y=a+i*(h-a),this.z=r+i*(l-r);var g=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);this.w*=g,this.x*=g,this.y*=g,this.z*=g}},e);function e(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),this.x=0,this.y=0,this.z=0,this.w=1,this.x=t,this.y=e,this.z=i,this.w=n}m.Quaternion=t}(tl3d=tl3d||{}),function(t){var e=(i.prototype.normalize=function(){var t=this.length;0!=t&&this.scaleBy(1/t)},Object.defineProperty(i.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),i.prototype.scaleBy=function(t){this.x*=t,this.y*=t,this.z*=t,this.w*=t},i.prototype.divideScalar=function(t){0!=t?(this.x=this.x/t,this.y=this.y/t,this.z=this.z/t):(this.x=0,this.y=0,this.z=0)},i.prototype.distanceToSquared=function(t){return i.distance(this,t)},i.prototype.scaleByW=function(){this.x*=this.w,this.y*=this.w,this.z*=this.w},i.prototype.add=function(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z)},i.prototype.subtract=function(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z)},i.prototype.addByNum=function(t,e,i,n){void 0===n&&(n=0),this.x+=t,this.y+=e,this.z+=i,this.w+=n},i.prototype.setTo=function(t,e,i){this.x=t,this.y=e,this.z=i},i.prototype.setByte=function(t){this.x=t.readFloat(),this.y=t.readFloat(),this.z=t.readFloat()},i.prototype.cross=function(t){return new i(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},i.prototype.clone=function(){return new i(this.x,this.y,this.z)},i.distance=function(t,e){var i=t.x-e.x,n=t.y-e.y,o=t.z-e.z;return Math.sqrt(i*i+n*n+o*o)},i.prototype.toString=function(){return"Vector3D("+String(this.x)+","+String(this.y)+","+String(this.z)+","+String(this.w)+")"},i.X_AXIS=new i(1,0,0),i.Y_AXIS=new i(0,1,0),i.Z_AXIS=new i(0,0,1),i);function i(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),this.x=0,this.y=0,this.z=0,this.w=1,this.x=t,this.y=e,this.z=i,this.w=n}t.Vector3D=e}(tl3d=tl3d||{}),function(t){var e=(i.prototype.normalize=function(){var t=this.length;0!=t&&this.scaleBy(1/t)},Object.defineProperty(i.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),i.prototype.scaleBy=function(t){this.x*=t,this.y*=t},i.prototype.sub=function(t){return new i(t.x-this.x,t.y-this.y)},i.prototype.add=function(t){return new i(t.x+this.x,t.y+this.y)},i.prototype.toString=function(){return"Vector2D("+String(this.x)+","+String(this.y)+")"},i.distance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},i.prototype.subtract=function(t){return new i(this.x-t.x,this.y-t.y)},i);function i(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}t.Vector2D=e}(tl3d=tl3d||{}),function(t){var e=(i.prototype.sets=function(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n},i.prototype.setRec=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},i.prototype.isHitByPoint=function(t,e){return t>=this.x&&e>=this.y&&t<=this.x+this.width&&e<=this.y+this.height},i);function i(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=1),this.x=0,this.y=0,this.width=0,this.height=1,this.x=t,this.y=e,this.width=i,this.height=n}t.Rectangle=e}(tl3d=tl3d||{}),function(t){var e=(i.prototype.setData=function(t,e,i){this.x=t,this.y=e,this.radius=i},i.prototype.setPos=function(t,e){this.x=t,this.y=e},Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!0,configurable:!0}),i.prototype.setRadius=function(t){this.radius=t},i.prototype.testPoint=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)<this.radius},i);function i(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.setData(t,e,i)}t.Circle=e}(tl3d=tl3d||{}),function(s){var t=(e.getGroundPos=function(t,e){if(!this._plantObjectMath){var i=new s.Vector3D(0,-500,500),n=new s.Vector3D(-500,-500,0),o=new s.Vector3D(500,-500,0);this._plantObjectMath=s.Calculation._PanelEquationFromThreePt(i,n,o),this._plantnormal=new s.Vector3D(this._plantObjectMath.a,this._plantObjectMath.b,this._plantObjectMath.c),this._plantnormal.normalize(),this._plane_a=new s.Vector3D(i.x,i.y,i.z)}var a=s.MathUtil.mathDisplay2Dto3DWorldPos(new s.Vector2D(t,e),500),r=new s.Vector3D(s.Scene_data.cam3D.x,s.Scene_data.cam3D.y,s.Scene_data.cam3D.z);return s.Calculation.calPlaneLineIntersectPoint(this._plantnormal,this._plane_a,a,r)},e);function e(){}s.Groundposition=t}(tl3d=tl3d||{}),function(v){var u=function(){this.a=0,this.b=0,this.c=0,this.d=0};v.ObjectMath=u;var t=(e._PanelEquationFromThreePt=function(t,e,i){var n=(e.y-t.y)*(i.z-t.z)-(e.z-t.z)*(i.y-t.y),o=(e.z-t.z)*(i.x-t.x)-(e.x-t.x)*(i.z-t.z),a=(e.x-t.x)*(i.y-t.y)-(e.y-t.y)*(i.x-t.x),r=0-(n*t.x+o*t.y+a*t.z),s=new u;return s.a=n,s.b=o,s.c=a,s.d=r,s},e.calPlaneLineIntersectPoint=function(t,e,i,n){var o=new v.Vector3D,a=t.x,r=t.y,s=t.z,u=e.x,h=e.y,l=e.z,c=i.x-n.x,p=i.y-n.y,d=i.z-n.z,_=n.x,f=n.y,g=n.z,y=c*a+p*r+d*s;if(0==y)return null;var m=((u-_)*a+(h-f)*r+(l-g)*s)/y;return o.x=_+c*m,o.y=f+p*m,o.z=g+d*m,o},e);function e(){}v.Calculation=t}(tl3d=tl3d||{}),function(i){var n=(t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t);function t(){}i.Endian=n;var e=(o.prototype._setArrayBuffer=function(t){this.write_position=t.byteLength,this.data=new DataView(t),this._position=0},o.prototype.setdata=function(t){this._setArrayBuffer(t.buffer)},Object.defineProperty(o.prototype,"buffer",{get:function(){return this.data.buffer},set:function(t){this.data=new DataView(t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dataView",{get:function(){return this.data},set:function(t){this.data=t,this.write_position=t.byteLength},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),o.prototype.getByte=function(t){return this.data.getUint8(t)},o.prototype.setByte=function(t,e){this.data.setUint8(t,e)},Object.defineProperty(o.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,this.write_position=t>this.write_position?t:this.write_position},enumerable:!0,configurable:!0}),o.prototype.reset=function(){this.clear()},Object.defineProperty(o.prototype,"length",{get:function(){return this.write_position},set:function(t){this.validateBuffer(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),o.prototype.clear=function(){this._setArrayBuffer(new ArrayBuffer(this.BUFFER_EXT_SIZE))},o.prototype.readBoolean=function(){return 0!=this.data.getUint8(this.position++)},o.prototype.readByte=function(){return this.data.getInt8(this.position++)},o.prototype.readBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var n=0;n<i;n++)t.data.setUint8(n+e,this.data.getUint8(this.position++))},o.prototype.readDouble=function(){var t=this.data.getFloat64(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=o.SIZE_OF_FLOAT64,t},o.prototype.readFloat=function(){var t=this.data.getFloat32(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=o.SIZE_OF_FLOAT32,t},o.prototype.readInt=function(){var t=this.data.getInt32(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=o.SIZE_OF_INT32,t},o.prototype.getInt=function(){return this.data.getInt32(this.position,this.endian==n.LITTLE_ENDIAN)},o.prototype.readInt32=function(){return this.readInt()},o.prototype.readShort=function(){this.position,this.data.byteLength;var t=this.data.getInt16(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=o.SIZE_OF_INT16,t},o.prototype.readFloatTwoByte=function(t){return this.readShort()/t},o.prototype.readFloatOneByte=function(){return(this.readByte()+128)/256},o.prototype.readUnsignedByte=function(){return this.data.getUint8(this.position++)},o.prototype.readUint8=function(){return this.readUnsignedByte()},o.prototype.readInt8=function(){return this.readByte()},o.prototype.readUnsignedInt=function(){var t=this.data.getUint32(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=o.SIZE_OF_UINT32,t},o.prototype.readUint32=function(){return this.readUnsignedInt()},o.prototype.readUint64=function(){return this.readDouble()},o.prototype.readUnsignedShort=function(){var t=this.data.getUint16(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=o.SIZE_OF_UINT16,t},o.prototype.readUint16=function(){return this.readUnsignedShort()},o.prototype.readUTF=function(){var t=this.data.getUint16(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=o.SIZE_OF_UINT16,0<t?this.readUTFBytes(t):""},o.prototype.readString=function(){return this.readUTF()},o.prototype.readUTFBytes=function(t){var e=new Uint8Array(this.buffer,this.bufferOffset+this.position,t);return this.position+=t,this.decodeUTF8(e)},o.prototype.readStringByLen=function(t){return this.readUTFBytes(t)},o.prototype.writeBoolean=function(t){this.validateBuffer(o.SIZE_OF_BOOLEAN),this.data.setUint8(this.position++,t?1:0)},o.prototype.writeByte=function(t){this.validateBuffer(o.SIZE_OF_INT8),this.data.setInt8(this.position++,t)},o.prototype.writeUint8=function(t){this.writeByte(t)},o.prototype.writeInt8=function(t){this.writeByte(t)},o.prototype.writeBytes=function(t,e,i){var n;if(void 0===e&&(e=0),void 0===i&&(i=0),!(e<0)&&!(i<0)&&0<(n=0==i?t.length-e:Math.min(t.length-e,i))){this.validateBuffer(n);for(var o=new DataView(t.buffer),a=e;a<n+e;a++)this.data.setUint8(this.position++,o.getUint8(a))}},o.prototype.writeDouble=function(t){this.validateBuffer(o.SIZE_OF_FLOAT64),this.data.setFloat64(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=o.SIZE_OF_FLOAT64},o.prototype.writeFloat=function(t){this.validateBuffer(o.SIZE_OF_FLOAT32),this.data.setFloat32(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=o.SIZE_OF_FLOAT32},o.prototype.writeInt=function(t){this.validateBuffer(o.SIZE_OF_INT32),this.data.setInt32(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=o.SIZE_OF_INT32},o.prototype.writeInt32=function(t){this.writeInt(t)},o.prototype.writeUnsignedShort=function(t){this.validateBuffer(o.SIZE_OF_INT16),this.data.setInt16(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=o.SIZE_OF_INT16},o.prototype.writeUint16=function(t){this.writeUnsignedShort(t)},o.prototype.writeUint64=function(t){this.validateBuffer(o.SIZE_OF_FLOAT64),this.data.setFloat64(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=o.SIZE_OF_FLOAT64},o.prototype.writeShort=function(t){this.validateBuffer(o.SIZE_OF_INT16),this.data.setUint16(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=o.SIZE_OF_INT16},o.prototype.writeUnsignedInt=function(t){this.validateBuffer(o.SIZE_OF_UINT32),this.data.setUint32(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=o.SIZE_OF_UINT32},o.prototype.writeUint32=function(t){this.writeUnsignedInt(t)},o.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),i=e.length;this.validateBuffer(o.SIZE_OF_UINT16+i),this.data.setUint16(this.position,i,this.endian===n.LITTLE_ENDIAN),this.position+=o.SIZE_OF_UINT16,this._writeUint8Array(e,!1)},o.prototype.writeString=function(t){var e=new o;e.writeUTFBytes(t),this.writeUint16(e.length+1),this.writeBytes(e,0,e.length),this.writeByte(0)},o.prototype.writeStringByLen=function(t,e){var i=this.position;this.writeUTFBytes(t),this.position=i+e,this.length=this.position+1},o.prototype.readVector3D=function(t){void 0===t&&(t=!1);var e=new i.Vector3D;return e.x=this.readFloat(),e.y=this.readFloat(),e.z=this.readFloat(),t&&(e.w=this.readFloat()),e},o.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},o.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},o.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0),e&&this.validateBuffer(this.position+t.length);for(var i=0;i<t.length;i++)this.data.setUint8(this.position++,t[i])},o.prototype.validate=function(t){return 0<this.data.byteLength&&this._position+t<=this.data.byteLength||(console.error("unvalidate byte len code:1025"),!1)},o.prototype.validateBuffer=function(t,e){if(void 0===e&&(e=!1),this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this.data.byteLength<t||e){var i=new Uint8Array(new ArrayBuffer(t+this.BUFFER_EXT_SIZE)),n=Math.min(this.data.buffer.byteLength,t+this.BUFFER_EXT_SIZE);i.set(new Uint8Array(this.data.buffer,0,n)),this.buffer=i.buffer}},o.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),n=[];i.length>e;){var o=i[e++];if(this.inRange(o,55296,57343))this.encoderError(o);else if(this.inRange(o,0,127))n.push(o);else{var a,r;for(this.inRange(o,128,2047)?(a=1,r=192):this.inRange(o,2048,65535)?(a=2,r=224):this.inRange(o,65536,1114111)&&(a=3,r=240),n.push(this.div(o,Math.pow(64,a))+r);0<a;){var s=this.div(o,Math.pow(64,a-1));n.push(128+s%64),--a}}}return new Uint8Array(n)},o.prototype.decodeUTF8=function(t){for(var e,i=0,n="",o=0,a=0,r=0,s=0;t.length>i;){var u=t[i++];if(u===this.EOF_byte)e=0!==a?this.decoderError(!1):this.EOF_code_point;else if(0===a)e=this.inRange(u,0,127)?u:(this.inRange(u,194,223)?(a=1,s=128,o=u-192):this.inRange(u,224,239)?(a=2,s=2048,o=u-224):this.inRange(u,240,244)?(a=3,s=65536,o=u-240):this.decoderError(!1),o*=Math.pow(64,a),null);else if(this.inRange(u,128,191))if(r+=1,o+=(u-128)*Math.pow(64,a-r),r!==a)e=null;else{var h=o,l=s;s=r=a=o=0,e=this.inRange(h,l,1114111)&&!this.inRange(h,55296,57343)?h:this.decoderError(!1,u)}else s=r=a=o=0,i--,e=this.decoderError(!1,u);null!==e&&e!==this.EOF_code_point&&(e<=65535?0<e&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},o.prototype.encoderError=function(t){console.error("encoderError 1026",t)},o.prototype.decoderError=function(t,e){return t&&console.error("decoderError 1027"),e||65533},o.prototype.inRange=function(t,e,i){return e<=t&&t<=i},o.prototype.div=function(t,e){return Math.floor(t/e)},o.prototype.stringToCodePoints=function(t){for(var e=[],i=0,n=t.length;i<t.length;){var o=t.charCodeAt(i);if(this.inRange(o,55296,57343))if(this.inRange(o,56320,57343))e.push(65533);else if(i===n-1)e.push(65533);else{var a=t.charCodeAt(i+1);if(this.inRange(a,56320,57343)){var r=1023&o,s=1023&a;i+=1,e.push(65536+(r<<10)+s)}else e.push(65533)}else e.push(o);i+=1}return e},o.SIZE_OF_BOOLEAN=1,o.SIZE_OF_INT8=1,o.SIZE_OF_INT16=2,o.SIZE_OF_INT32=4,o.SIZE_OF_UINT8=1,o.SIZE_OF_UINT16=2,o.SIZE_OF_UINT32=4,o.SIZE_OF_FLOAT32=4,o.SIZE_OF_FLOAT64=8,o);function o(t){this.BUFFER_EXT_SIZE=0,this.optcode=0,this.EOF_byte=-1,this.EOF_code_point=-1,this._setArrayBuffer(t||new ArrayBuffer(this.BUFFER_EXT_SIZE)),this.endian=n.BIG_ENDIAN}i.TLByteArray=e}(tl3d=tl3d||{}),function(t){var e=(n.prototype.setAllPoint=function(t,e,i){this.p1=t,this.p2=e,this.p3=i},n.prototype.checkPointIn=function(t){var e=this.getArea(),i=0;return i+=n.getAreaByPoints(t,this.p1,this.p2),i+=n.getAreaByPoints(t,this.p2,this.p3),(i+=n.getAreaByPoints(t,this.p3,this.p1))==e||Math.abs(i-e)<this.precision},n.prototype.getArea=function(){return n.getAreaByPoints(this.p1,this.p2,this.p3)},n.getAreaByPoints=function(t,e,i){var n=t.x-e.x,o=t.y-e.y,a=Math.sqrt(n*n+o*o);n=e.x-i.x,o=e.y-i.y;var r=Math.sqrt(n*n+o*o);n=i.x-t.x,o=i.y-t.y;var s=Math.sqrt(n*n+o*o),u=(a+r+s)/2,h=u*(u-a)*(u-r)*(u-s);return 0<h?Math.sqrt(h):0},n.baseTri=new n,n);function n(t,e,i,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=.1),this.p1=t,this.p2=e,this.p3=i,this.precision=n}t.TestTriangle=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.ResGC,__extends(n,e),n.getInstance=function(){return this._instance||(this._instance=new n),this._instance},n.prototype.getProgram=function(t){return this._dic[t]?this._dic[t]:(alert("please registe Program=>"+t),null)},n.prototype.registe=function(t,e){this._dic[t]||(e.encode(),e.useNum=1,e.name=t,this._dic[t]=e)},n.prototype.getMaterialProgram=function(t,e,i,n,o){void 0===n&&(n=null),void 0===o&&(o=!1);var a=t+"_"+i.url;if(n){for(var r=0;r<n.length;r++)a+="_"+n[r];a+=o?"true_":"false_"}if(this._dic[a])return this._dic[a].useNum++,this._dic[a];o&&(n=[i.usePbr,i.useNormal,i.hasFresnel,i.useDynamicIBL,i.lightProbe,i.directLight,i.noLight,i.fogMode]);var s=new e;return s.paramAry=n,s.fragment=i.shaderStr,s.encode(),s.useNum++,this._dic[a]=s},n.prototype.outShader=function(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i],e.length},n);function n(){return e.call(this)||this}t.ProgrmaManager=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=i.ResCount,__extends(n,e),n.prototype.encode=function(){this.vertex=this.getVertexShaderString();var t=i.Scene_data.context3D.renderContext;try{this.program=t.createProgram()}catch(t){console.error("engin init error")}return this.vShader=t.createShader(t.VERTEX_SHADER),this.fShader=t.createShader(t.FRAGMENT_SHADER),t.shaderSource(this.vShader,this.vertex),t.shaderSource(this.fShader,this.fragment),t.compileShader(this.vShader),t.compileShader(this.fShader),t.attachShader(this.program,this.vShader),t.attachShader(this.program,this.fShader),this.binLocation(t),t.linkProgram(this.program),this.localDic=new Object,!0},n.prototype.getWebGLUniformLocation=function(t){var e=this.localDic[t];return e||(this.localDic[t]=i.Scene_data.context3D.getLocation(this.program,t),this.localDic[t])},n.prototype.binLocation=function(t){},n.prototype.getVertexShaderString=function(){return""},n.prototype.getFragmentShaderString=function(){return""},n.prototype.destory=function(){this.vertex=null,this.fragment=null,this.name=null,this.localDic=null,i.Scene_data.context3D.deleteShader(this)},n);function n(){var t=e.call(this)||this;return t.fragment=t.getFragmentShaderString(),t}i.Shader3D=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"v2CubeTexST")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Position;attribute vec2 v2CubeTexST;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(v2CubeTexST.x, v2CubeTexST.y);   vec4 vt0= vec4(v3Position, 1.0);   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D s_texture;\nuniform vec4 testconst;uniform vec4 testconst2;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\nvec4 test = vec4(0,0,0,1);\ntest.xyz = mix(vec3(1,1,1)*0.5,testconst.xyz,0.5);\ninfoUv.xyz = test.xyz * infoUv.xyz;\ngl_FragColor = infoUv;\n}"},n.buildShader="BuildShader",n);function n(){return e.call(this)||this}t.BuildShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"v2CubeTexST");var e=this.paramAry[0],i=this.paramAry[1],n=(this.paramAry[4],this.paramAry[5]),o=this.paramAry[6];n||o||t.bindAttribLocation(this.program,2,"v2lightuv"),e?(t.bindAttribLocation(this.program,3,"v3Normal"),i&&(t.bindAttribLocation(this.program,4,"v3Tangent"),t.bindAttribLocation(this.program,5,"v3Bitangent"))):n&&t.bindAttribLocation(this.program,3,"v3Normal")},n.prototype.getVertexShaderString=function(){var t=this.paramAry[0],e=this.paramAry[1],i=(this.paramAry[2],this.paramAry[3],this.paramAry[4],this.paramAry[5]),n=this.paramAry[6],o=this.paramAry[7],a="attribute vec3 v3Position;\nattribute vec2 v2CubeTexST;\nvarying vec2 v0;\n";return i?a+="varying vec3 v2;\n":n||(a+="attribute vec2 v2lightuv;\nvarying vec2 v2;\n"),t?(a+="attribute vec3 v3Normal;\nvarying vec3 v1;\n",a+=e?"varying mat3 v4;\n":"varying vec3 v4;\n"):0!=o&&(a+="varying vec3 v1;\n"),e&&(a+="attribute vec3 v3Tangent;\nattribute vec3 v3Bitangent;\n"),i&&(t||(a+="attribute vec3 v3Normal;\n"),a+="uniform vec3 sunDirect;\nuniform vec3 sunColor;\nuniform vec3 ambientColor;\n"),a+="uniform mat4 vpMatrix3D;\nuniform mat4 posMatrix3D;\nuniform mat3 rotationMatrix3D;\n",a+="void main(void){\nv0 = vec2(v2CubeTexST.x, v2CubeTexST.y);\nvec4 vt0= vec4(v3Position, 1.0);\nvt0 = posMatrix3D * vt0;\n",i||n||(a+="v2 = vec2(v2lightuv.x, v2lightuv.y);\n"),!t&&0==o||(a+="v1 = vec3(vt0.x,vt0.y,vt0.z);\n"),a+="vt0 = vpMatrix3D * vt0;\n",t&&(a+=e?"v4 = mat3(rotationMatrix3D * v3Tangent,rotationMatrix3D * v3Bitangent, rotationMatrix3D * v3Normal);\n":"v4 = rotationMatrix3D * v3Normal;\n"),i&&(a+=t?"float suncos = dot(v4.xyz,sunDirect.xyz);\n":"vec3 n = rotationMatrix3D * v3Normal;\nfloat suncos = dot(n.xyz,sunDirect.xyz);\n",a+="suncos = clamp(suncos,0.0,1.0);\nv2 = sunColor * suncos + ambientColor;"),a+="gl_Position = vt0;}"},n.prototype.outstr=function(t){for(var e=t.split(";"),i=0;i<e.length;i++)String(trim(e[i]))},n.prototype.getFragmentShaderString=function(){return"uniform sampler2D s_texture1;\nuniform vec4 testconst;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz = testconst.xyz * infoUv.xyz;\ngl_FragColor = infoUv;\n}"},n.MATERIAL_SHADER="Material_shader",n);function n(){var t=e.call(this)||this;return t.name="Material_shader",t}t.MaterialShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(r,e),r.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"pos"),t.bindAttribLocation(this.program,1,"v2Uv"),t.bindAttribLocation(this.program,2,"boneID"),t.bindAttribLocation(this.program,3,"boneWeight");var e=this.paramAry[0],i=this.paramAry[1],n=this.paramAry[4],o=this.paramAry[5];e?(t.bindAttribLocation(this.program,4,"normal"),i&&(t.bindAttribLocation(this.program,5,"tangent"),t.bindAttribLocation(this.program,6,"bitangent"))):(n||o)&&t.bindAttribLocation(this.program,4,"normal")},r.getMd5M44Str=function(){return"vec4 qdv(vec4 q,vec3 d, vec3 v ){\nvec3 t = 2.0 * cross(q.xyz, v);\nvec3 f = v + q.w * t + cross(q.xyz, t);\nreturn  vec4(f.x+d.x,f.y+d.y,f.z+d.z,1.0);\n }\nvec4 getQDdata(vec3 vdata){\nvec4 tempnum = qdv(boneQ[int(boneID.x)],boneD[int(boneID.x)],vdata) * boneWeight.x;\ntempnum += qdv(boneQ[int(boneID.y)],boneD[int(boneID.y)],vdata) * boneWeight.y;\ntempnum += qdv(boneQ[int(boneID.z)],boneD[int(boneID.z)],vdata)* boneWeight.z;\ntempnum += qdv(boneQ[int(boneID.w)],boneD[int(boneID.w)],vdata) * boneWeight.w;\ntempnum.x = tempnum.x*-1.0;\nreturn  tempnum;\n }\n"},r.getMd5M44NrmStr=function(){return"vec4 qdvNrm(vec4 q, vec3 v ){\nvec3 t = 2.0 * cross(q.xyz, v);\nvec3 f = v + q.w * t + cross(q.xyz, t);\nreturn  vec4(f.x,f.y,f.z,1.0);\n }\nvec4 getQDdataNrm(vec3 vdata){\nvec4 tempnum = qdvNrm(boneQ[int(boneID.x)],vdata) * boneWeight.x;\ntempnum += qdvNrm(boneQ[int(boneID.y)],vdata) * boneWeight.y;\ntempnum += qdvNrm(boneQ[int(boneID.z)],vdata)* boneWeight.z;\ntempnum += qdvNrm(boneQ[int(boneID.w)],vdata) * boneWeight.w;\ntempnum.x = tempnum.x*-1.0;\ntempnum.xyz = normalize(tempnum.xyz);\nreturn  tempnum;\n }\n"},r.prototype.getVertexShaderString=function(){var t=this.paramAry[0],e=this.paramAry[1],i=(this.paramAry[2],this.paramAry[3],this.paramAry[4]),n=this.paramAry[5],o=this.paramAry[6],a="attribute vec4 pos;\nattribute vec2 v2Uv;\nattribute vec4 boneID;\nattribute vec4 boneWeight;\nvarying vec2 v0;\nuniform vec4 boneQ[54];\nuniform vec3 boneD[54];\nuniform mat4 vpMatrix3D;\nuniform mat4 posMatrix3D;\n";return i?a+="uniform vec3 sh[9];\nvarying vec3 v2;\n":n?a+="uniform vec3 sunDirect;\nuniform vec3 sunColor;\nuniform vec3 ambientColor;\nvarying vec3 v2;\n":o||(a+="varying vec2 v2;\n"),t?(a+="attribute vec4 normal;\nuniform mat4 rotationMatrix3D;\nvarying vec3 v1;\n",a+=e?"varying mat3 v4;\n":"varying vec3 v4;\n",e&&(a+="attribute vec4 tangent;\nattribute vec4 bitangent;\n")):(i||n)&&(a+="attribute vec4 normal;\nuniform mat4 rotationMatrix3D;\n"),a+=r.getMd5M44Str()+r.getMd5M44NrmStr()+"void main(void){\nv0 = v2Uv;\nvec4 vt0 = getQDdata(vec3(pos.x,pos.y,pos.z));\nvt0.xyz = vt0.xyz*1.0;\nvt0 = posMatrix3D * vt0;\n",t&&(a+="v1 = vec3(vt0.x,vt0.y,vt0.z);\n"),a+="vt0 = vpMatrix3D * vt0;\ngl_Position = vt0;\n",t?a+=e?"vec4 vt2 = getQDdataNrm(vec3(tangent.x,tangent.y,tangent.z));\nvt2 = rotationMatrix3D * vt2;\nvt2.xyz = normalize(vt2.xyz);\nvec4 vt1 = getQDdataNrm(vec3(bitangent.x,bitangent.y,bitangent.z));\nvt1 = rotationMatrix3D * vt1;\nvt1.xyz = normalize(vt1.xyz);\nvt0 = getQDdataNrm(vec3(normal.x,normal.y,normal.z));\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\nv4 = mat3(vec3(vt2.x,vt2.y,vt2.z),vec3(vt1.x,vt1.y,vt1.z),vec3(vt0.x,vt0.y,vt0.z));\n":"vt0 = getQDdataNrm(vec3(normal.x,normal.y,normal.z));\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\nv4 = vec3(vt0.x,vt0.y,vt0.z);\n":(i||n)&&(a+="vt0 = getQDdataNrm(vec3(normal.x,normal.y,normal.z));\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\n"),i?a+="vec3 lpb = sh[0] * 0.28209479177387814;\nlpb += sh[1] * (vt0.y * -0.4886025119029199);\nlpb += sh[2] * (vt0.z * 0.4886025119029199);\nlpb += sh[3] * (vt0.x * -0.4886025119029199);\nlpb += sh[4] * (vt0.x * vt0.y * 1.0925484305920792);\nlpb += sh[5] * (vt0.z * vt0.y * -1.0925484305920792);\nlpb += sh[6] * ((3.0 * vt0.z * vt0.z - 1.0) * 0.31539156525252005);\nlpb += sh[7] * (vt0.z * vt0.x * -1.0925484305920792);\nlpb += sh[8] * ((vt0.x * vt0.x - vt0.y * vt0.y) * 0.5462742152960396);\nv2 = lpb;\n":n?a+="float suncos = dot(vt0.xyz,sunDirect.xyz);\nsuncos = clamp(suncos,0.0,1.0);\nv2 = sunColor * suncos + ambientColor;":o||(a+="v2 = v2Uv;\n"),a+="}"},r.prototype.getFragmentShaderString=function(){return"uniform sampler2D s_texture1;\nuniform vec4 testconst;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz = testconst.xyz * infoUv.xyz;\ngl_FragColor = infoUv;\n}"},r.MATERIAL_ANIM_SHADER="Material_Anim_shader",r);function r(){var t=e.call(this)||this;return t.name="Material_Anim_shader",t}t.MaterialAnimShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"pos"),t.bindAttribLocation(this.program,1,"v2Uv"),t.bindAttribLocation(this.program,2,"boneID"),t.bindAttribLocation(this.program,3,"boneWeight");var e=this.paramAry[0],i=this.paramAry[1],n=this.paramAry[4],o=this.paramAry[5];e?(t.bindAttribLocation(this.program,4,"normal"),i&&(t.bindAttribLocation(this.program,5,"tangent"),t.bindAttribLocation(this.program,6,"bitangent"))):(n||o)&&t.bindAttribLocation(this.program,4,"normal")},n.prototype.getVertexShaderString=function(){var t=this.paramAry[0],e=this.paramAry[1],i=(this.paramAry[2],this.paramAry[3],this.paramAry[4]),n=this.paramAry[5],o=this.paramAry[6],a="precision mediump float;\nattribute vec4 pos;\nattribute vec3 v2Uv;\nattribute vec4 boneID;\nattribute vec4 boneWeight;\nvarying vec2 v0;\nuniform mat4 bone[19];\nuniform mat4 viewMatrix3D;\nuniform mat4 camMatrix3D;\nuniform mat4 posMatrixAry[6];\n";return i?a+="varying vec3 v2;\n":n?a+="uniform vec3 sunDirect;\nuniform vec3 sunColor;\nuniform vec3 ambientColor;\nvarying vec3 v2;\n":o||(a+="varying vec2 v2;\n"),t?(a+="attribute vec4 normal;\nuniform mat4 rotationMatrix3D;\nvarying vec3 v1;\n",a+=e?"varying mat3 v4;\n":"varying vec3 v4;\n",e&&(a+="attribute vec4 tangent;\nattribute vec4 bitangent;\n")):(i||n)&&(a+="attribute vec4 normal;\nuniform mat4 rotationMatrix3D;\n"),a+="void main(void){\nv0 = vec2(v2Uv.xy);\nvec4 vt0 = bone[int(boneID.x)] * pos * boneWeight.x;\nvt0 += bone[int(boneID.y)] * pos * boneWeight.y;\nvt0 += bone[int(boneID.z)] * pos * boneWeight.z;\nvt0 += bone[int(boneID.w)] * pos * boneWeight.w;\nvt0 = posMatrixAry[int(v2Uv.z)] * vt0;\n",t&&(a+="v1 = vec3(vt0.x,vt0.y,vt0.z);\n"),a+="vt0 = camMatrix3D * vt0;\nvt0 = viewMatrix3D * vt0;\ngl_Position = vt0;\n",t?a+=e?"vec4 vt2 = bone[int(boneID.x)] * tangent * boneWeight.x;\nvt2 += bone[int(boneID.y)] * tangent * boneWeight.y;\nvt2 += bone[int(boneID.z)] * tangent * boneWeight.z;\nvt2 += bone[int(boneID.w)] * tangent * boneWeight.w;\nvt2 = rotationMatrix3D * vt2;\nvt2.xyz = normalize(vt2.xyz);\nvec4 vt1 = bone[int(boneID.x)] * bitangent * boneWeight.x;\nvt1 += bone[int(boneID.y)] * bitangent * boneWeight.y;\nvt1 += bone[int(boneID.z)] * bitangent * boneWeight.z;\nvt1 += bone[int(boneID.w)] * bitangent * boneWeight.w;\nvt1 = rotationMatrix3D * vt1;\nvt1.xyz = normalize(vt1.xyz);\nvt0 = bone[int(boneID.x)] * normal * boneWeight.x;\nvt0 += bone[int(boneID.y)] * normal * boneWeight.y;\nvt0 += bone[int(boneID.z)] * normal * boneWeight.z;\nvt0 += bone[int(boneID.w)] * normal * boneWeight.w;\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\nv4 = mat3(vec3(vt2.x,vt2.y,vt2.z),vec3(vt1.x,vt1.y,vt1.z),vec3(vt0.x,vt0.y,vt0.z));\n":"vt0 = bone[int(boneID.x)] * normal * boneWeight.x;\nvt0 += bone[int(boneID.y)] * normal * boneWeight.y;\nvt0 += bone[int(boneID.z)] * normal * boneWeight.z;\nvt0 += bone[int(boneID.w)] * normal * boneWeight.w;\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\nv4 = vec3(vt0.x,vt0.y,vt0.z);\n":(i||n)&&(a+="vt0 = bone[int(boneID.x)] * normal * boneWeight.x;\nvt0 += bone[int(boneID.y)] * normal * boneWeight.y;\nvt0 += bone[int(boneID.z)] * normal * boneWeight.z;\nvt0 += bone[int(boneID.w)] * normal * boneWeight.w;\nvt0 = rotationMatrix3D * vt0;\nvt0.xyz = normalize(vt0.xyz);\n"),i?a+="vec3 lpb = normalize(vec3(1.0,1.0,-1.0));\nfloat lp = min(0.0,dot(lpb,vec3(vt0.xyz)));\nlp = lp * 2.0 + 0.7;\nv2 = vec3(lp,lp,lp);\n":n?a+="float suncos = dot(vt0.xyz,sunDirect.xyz);\nsuncos = clamp(suncos,0.0,1.0);\nv2 = sunColor * suncos + ambientColor;":o||(a+="v2 = v2Uv;\n"),a+="}"},n.prototype.getFragmentShaderString=function(){return"uniform sampler2D s_texture1;\nuniform vec4 testconst;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz = testconst.xyz * infoUv.xyz;\ngl_FragColor = infoUv;\n}"},n);function n(){var t=e.call(this)||this;return t.name="Material_Batch_Anim_Shader",t}t.MaterialBatchAnimShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"v3Normal")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Position;attribute vec3 v3Normal;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec3 vNormal;void main(void){   vNormal = vec3(v3Normal.x, v3Normal.y,v3Normal.z);   vec4 vt0= vec4(v3Position, 1.0);   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return"precision mediump float;\nuniform samplerCube s_texture;\nvarying vec3 vNormal;\nvoid main(void)\n{\nvec4 infoUv = textureCube(s_texture, vNormal);\ngl_FragColor = infoUv;\n}"},n.Sky_Shader="SkyShader",n);function n(){return e.call(this)||this}t.SkyShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Pos"),t.bindAttribLocation(this.program,1,"v2uv")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Pos;attribute vec3 v2uv;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform vec4 pos[30];varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(v2uv.x, v2uv.y);   vec3 vt1= vec3(v3Pos.xyz * pos[int(v2uv.z)].w + pos[int(v2uv.z)].xyz);   vec4 vt0= vec4(vt1, 1.0);   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}"},n.Display3DShadowShader="Display3DShadowShader",n);function n(){return e.call(this)||this}t.Display3DShadowShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Pos"),t.bindAttribLocation(this.program,1,"v2uv")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Pos;attribute vec3 v2uv;uniform vec4 ui[50];uniform vec4 ui2[50];varying vec2 v_texCoord;void main(void){   vec4 data = ui2[int(v2uv.z)];   v_texCoord = vec2(v2uv.x * data.x + data.z, v2uv.y * data.y + data.w);   data = ui[int(v2uv.z)];   vec3 pos = vec3(0.0,0.0,0.0);   pos.xy = v3Pos.xy * data.zw * 2.0;   pos.x += data.x * 2.0 - 1.0;   pos.y += -data.y * 2.0 + 1.0;   vec4 vt0= vec4(pos, 1.0);   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}"},n.UI_SHADER="UIShader",n);function n(){return e.call(this)||this}t.UIShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Pos"),t.bindAttribLocation(this.program,1,"v2uv")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Pos;attribute vec2 v2uv;uniform vec2 scale;varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(v2uv.x, v2uv.y);   vec4 vt0= vec4(v3Pos.x*scale.x,v3Pos.y*scale.y,v3Pos.z,1.0);   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D s_texture;\nuniform float alpha;varying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.w = alpha;\ninfoUv.xyz *= infoUv.w;\ngl_FragColor = infoUv;\n}"},n.UI_IMG_SHADER="UI_img_Shader",n);function n(){return e.call(this)||this}t.UIImageShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Pos")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Pos;uniform vec4 ui;void main(void){   vec3 pos = vec3(0.0,0.0,0.0);   pos.xy = v3Pos.xy * ui.zw * 2.0;   pos.x += ui.x * 2.0 - 1.0;   pos.y += -ui.y * 2.0 + 1.0;   vec4 vt0= vec4(pos, 1.0);   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nvoid main(void)\n{\ngl_FragColor = vec4(0.5,0.5,0.5,1.0);\n}"},n.UI_MASK_SHADER="UImaskShader",n);function n(){return e.call(this)||this}t.UIMaskShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Pos"),t.bindAttribLocation(this.program,1,"v2uv")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Pos;attribute vec3 v2uv;uniform mat4 viewMatrix3D;\nuniform mat4 camMatrix3D;\nuniform mat4 watchCamMatrix3D;\nuniform vec4 posdata[24];uniform vec2 outuv;varying vec2 v_texCoord;void main(void){   vec4 data = posdata[int(v2uv.z)];   vec4 vt0= vec4(v3Pos * data.w,1.0);   vt0= watchCamMatrix3D * vt0;   vt0.xyz += data.xyz;   v_texCoord = vec2(v2uv.x,v2uv.y) + outuv;   gl_Position = viewMatrix3D * camMatrix3D * vt0;}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\nif(infoUv.w < 0.1){discard;}\ngl_FragColor = infoUv;\n}"},n.MOVIE2D_SHADER="Movie2DShader",n);function n(){return e.call(this)||this}t.Movie2DShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Pos"),t.bindAttribLocation(this.program,1,"v2uv")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Pos;attribute vec3 v2uv;uniform mat4 viewMatrix3D;\nuniform mat4 camMatrix3D;\nuniform mat4 watchCamMatrix3D;\nuniform vec4 posdata[12];varying vec2 v_texCoord;void main(void){   vec4 data = posdata[int(v2uv.z)];   vec4 vt0= vec4(v3Pos * data.w,1.0);   vt0= watchCamMatrix3D * vt0;   vt0.xyz += data.xyz;   v_texCoord = vec2(v2uv.x,v2uv.y);   gl_Position = viewMatrix3D * camMatrix3D * vt0;}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\nif(infoUv.w < 0.1){discard;}\ngl_FragColor = infoUv;\n}"},n.SPRITE2D_SHADER="Sprite2DShader",n);function n(){return e.call(this)||this}t.Sprite2DShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"v2TexCoord")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Position;attribute vec2 v2TexCoord;\nuniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec2 v0;\nvoid main(void){ v0 = v2TexCoord;   vec4 vt0= vec4(v3Position, 1.0);   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return"precision mediump float;uniform sampler2D idmaptexture;uniform sampler2D infotexture;uniform sampler2D sixtexture;uniform sampler2D lightexture;vec4 qdvNrm(float indx ,vec2 uvpos){vec2 sixuvTx=uvpos; float ccavid= floor(indx*255.0);if (ccavid==0.0) {\n} else  if (ccavid==1.0){\nsixuvTx.x=sixuvTx.x+0.5;} else  if (ccavid==2.0){sixuvTx.y=sixuvTx.y+0.5;}else{sixuvTx.x=sixuvTx.x+0.5;sixuvTx.y=sixuvTx.y+0.5;}; sixuvTx.x=sixuvTx.x+0.001;sixuvTx.y=sixuvTx.y+0.001;vec4 sixUvColor = texture2D(sixtexture, sixuvTx.xy);\nreturn  sixUvColor;\n }\nvarying vec2 v0;void main(void){vec4 idUv = texture2D(idmaptexture, v0.xy);\nvec4 infoUv = texture2D(infotexture, v0.xy);\nvec4 sixUv = texture2D(sixtexture, v0.xy);\nvec4 lightUv = texture2D(lightexture, v0*0.995+0.0025);\nvec2 sixuv=fract(v0*10.0);  sixuv=sixuv*0.498; vec4 tempnumA = qdvNrm(idUv.x,sixuv) * infoUv.x;\nvec4 tempnumB = qdvNrm(idUv.y,sixuv) * infoUv.y;\nvec4 tempnumC = qdvNrm(idUv.z,sixuv) * infoUv.z;\nvec4 tempnumD = tempnumA+tempnumB+tempnumC;\n tempnumD.xyz=tempnumD.xyz*lightUv.xyz*2.0; gl_FragColor = tempnumD;}"},n.TerrainDisplay3DShader="TerrainDisplay3DShader",n);function n(){return e.call(this)||this}t.TerrainDisplay3DShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var t,e=(t=r.ResCount,__extends(i,t),i.prototype.destory=function(){for(var t=0;t<this.dataAry.length;t++)this.dataAry[t].destory()},i.prototype.getCombineParticle=function(){var t=new r.CombineParticle;t.maxTime=this.maxTime;for(var e=0;e<this.dataAry.length;e++){var i=this.dataAry[e].creatPartilce();t.addPrticleItem(i)}return(t.sourceData=this).useNum++,t},i.prototype.setDataByte=function(t){t.position=0;var e=t.readInt(),i=t.readInt();this.maxTime=0,this.dataAry=new Array;for(var n=0;n<i;n++){var o=t.readInt(),a=this.getParticleDataType(o);a.version=e,a.setAllByteInfo(t),this.dataAry.push(a),a.timelineData.maxFrameNum>this.maxTime&&(this.maxTime=a.timelineData.maxFrameNum)}this.maxTime*=r.Scene_data.frameTime},i.prototype.getParticleDataType=function(t){var e;switch(t){case 1:e=new r.ParticleFacetData;break;case 18:e=new r.ParticleBallData;break;case 3:e=new r.ParticleLocusData;break;case 14:e=new r.ParticleLocusballData;break;case 9:case 4:case 7:e=new r.ParticleModelData;break;case 8:e=new r.ParticleFollowData;break;case 12:e=new r.ParticleFollowLocusData;break;case 13:e=new r.ParticleBoneData}return e},i);function i(){return null!==t&&t.apply(this,arguments)||this}r.CombineParticleData=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=r.EventDispatcher,__extends(i,e),Object.defineProperty(i.prototype,"displayAry",{get:function(){return this._displayAry},set:function(t){this._displayAry=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxTime",{set:function(t){this._maxTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bindTarget",{set:function(t){this._bindTarget=t,this.invertBindMatrix.isIdentity=!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bindSocket",{set:function(t){this._bindSocket=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"x",{get:function(){return this.bindVecter3d.x},set:function(t){this.bindVecter3d.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.bindVecter3d.y},set:function(t){this.bindVecter3d.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"z",{get:function(){return this.bindVecter3d.z},set:function(t){this.bindVecter3d.z=t},enumerable:!0,configurable:!0}),i.prototype.setPos=function(t,e,i){this.bindVecter3d.setTo(t,e,i);for(var n=0;n<this._displayAry.length;n++)this._displayAry[n].resetPos()},i.prototype.setMulPos=function(t){for(var e=0;e<this._displayAry.length;e++)this._displayAry[e].resetMulPos(t)},Object.defineProperty(i.prototype,"scaleX",{set:function(t){this.bindScale.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scaleY",{set:function(t){this.bindScale.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scaleZ",{set:function(t){this.bindScale.z=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotationX",{set:function(t){this._rotationX=t,this.applyRotation()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotationY",{set:function(t){this._rotationY=t,this.applyRotation()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotationZ",{set:function(t){this._rotationZ=t,this.applyRotation()},enumerable:!0,configurable:!0}),i.prototype.applyRotation=function(){this.bindMatrix.identity(),this.bindMatrix.appendRotation(this._rotationX,r.Vector3D.X_AXIS),this.bindMatrix.appendRotation(this._rotationY,r.Vector3D.Y_AXIS),this.bindMatrix.appendRotation(this._rotationZ,r.Vector3D.Z_AXIS),this.bindMatrix.copyTo(this.invertBindMatrix),this.invertBindMatrix.invert(),this.invertBindMatrix.isIdentity=!1},i.prototype.setGroup=function(t,e,i){this._isInGroup=!0,this._groupPos=t,this._groupRotation=e,this._groupScale=i,this.groupMatrix.isIdentity=!1,this.groupMatrix.identity(),this.groupMatrix.appendScale(i.x,i.y,i.z),this.groupMatrix.appendRotation(e.x,r.Vector3D.X_AXIS),this.groupMatrix.appendRotation(e.y,r.Vector3D.Y_AXIS),this.groupMatrix.appendRotation(e.z,r.Vector3D.Z_AXIS),this.groupMatrix.appendTranslation(t.x,t.y,t.z),this.groupRotationMatrix.isIdentity=!1,this.groupRotationMatrix.identity(),this.groupRotationMatrix.prependRotation(e.z,r.Vector3D.Z_AXIS),this.groupRotationMatrix.prependRotation(e.y,r.Vector3D.Y_AXIS),this.groupRotationMatrix.prependRotation(e.x,r.Vector3D.X_AXIS)},i.prototype.setDataByte=function(t){t.position=0;var e=t.readInt(),i=t.readInt();this._maxTime=0,this._displayAry=new Array;for(var n=0;n<i;n++){var o=t.readInt(),a=this.getDisplay3DById(o);a.setAllByteInfo(t,e),a.setBind(this.bindVecter3d,this.bindMatrix,this.bindScale,this.invertBindMatrix,this.groupMatrix),this._displayAry.push(a),a.timeline.maxFrameNum>this._maxTime&&(this._maxTime=a.timeline.maxFrameNum)}this._maxTime*=r.Scene_data.frameTime},i.prototype.addPrticleItem=function(t){t.visible=!1,t.setBind(this.bindVecter3d,this.bindMatrix,this.bindScale,this.invertBindMatrix,this.groupMatrix),this._displayAry.push(t)},i.prototype.getDisplay3DById=function(t){var e=new Object;return e.particleType=t,this.getDisplay3D(e)},i.prototype.setData=function(t){this._displayAry=new Array;for(var e=this._maxTime=0;e<t.length;e++){var i=t[e].display,n=this.getDisplay3D(i);n.setBind(this.bindVecter3d,this.bindMatrix,this.bindScale,this.invertBindMatrix,this.groupMatrix),this._displayAry.push(n),n.timeline.maxFrameNum>this._maxTime&&(this._maxTime=n.timeline.maxFrameNum)}this._maxTime*=r.Scene_data.frameTime},i.prototype.updateTime=function(t){if(this._time+=t*this.timeScale,this._displayAry){for(var e=0;e<this._displayAry.length;e++)this._displayAry[e].updateTime(this._time);this.updateBind(),this._time>=this._maxTime&&(this.hasEventListener(r.BaseEvent.COMPLETE)&&this.dispatchEvent(new r.BaseEvent(r.BaseEvent.COMPLETE)),null!=this.onComplete&&(this.onComplete(this),this.onComplete=null))}},i.prototype.updateBind=function(){this._bindTarget&&(this._bindTarget.getSocket(this._bindSocket,this.bindMatrix),this.bindVecter3d.setTo(this.bindMatrix.x,this.bindMatrix.y,this.bindMatrix.z),this.bindMatrix.identityPostion(),this.groupRotationMatrix.isIdentity?this.bindMatrix.invertToMatrix(this.invertBindMatrix):(this.bindMatrix.copyTo(this.invertBindMatrix),this.invertBindMatrix.prepend(this.groupRotationMatrix),this.invertBindMatrix.invert()))},i.prototype.reset=function(){if(!this.hasDestory)for(var t=this._time=0;this._displayAry&&t<this._displayAry.length;t++)this._displayAry[t].reset()},i.prototype.update=function(){if(this.sceneVisible&&this._displayAry)for(var t=0;t<this._displayAry.length;t++)this._displayAry[t].update()},i.prototype.updateItem=function(t){this.sceneVisible&&(this.hasDestory||this._displayAry[t].update())},Object.defineProperty(i.prototype,"size",{get:function(){return this._displayAry?this._displayAry.length:0},enumerable:!0,configurable:!0}),i.prototype.getDisplay3D=function(t){var e;switch(t.particleType){case 1:e=new r.Display3DFacetParticle;break;case 18:e=new r.Display3DBallPartilce;break;case 3:e=new r.Display3DLocusPartilce;break;case 14:e=new r.Display3DLocusBallPartilce;break;case 9:e=new r.Display3DModelObjParticle;break;case 4:e=new r.Display3DModelPartilce;break;case 7:e=new r.Display3dModelAnimParticle;break;case 8:e=new r.Display3DFollowPartilce}return e.visible=!1,e},i.prototype.destory=function(){if(!this.hasDestory){this.sourceData&&this.sourceData.useNum--;for(var t=0;t<this._displayAry.length;t++)this._displayAry[t].destory();this._displayAry.length=0,this._displayAry=null,this.bindMatrix=null,this.bindVecter3d=null,this.bindScale=null,this.invertBindMatrix=null,this._bindTarget=null,this._bindSocket=null,this._groupPos=null,this._groupRotation=null,this._groupScale=null,this.groupMatrix=null,this.groupRotationMatrix=null,this.hasDestory=!0}},i);function i(){var t=e.call(this)||this;return t._maxTime=1e6,t._rotationX=0,t._rotationY=0,t._rotationZ=0,t.hasMulItem=!1,t.sceneVisible=!0,t.dynamic=!1,t.hasDestory=!1,t.timeScale=1,t._displayAry=new Array,t._time=0,t.bindMatrix=new r.Matrix3D,t.invertBindMatrix=new r.Matrix3D,t.bindVecter3d=new r.Vector3D,t.bindScale=new r.Vector3D(1,1,1),t.groupMatrix=new r.Matrix3D,t.groupRotationMatrix=new r.Matrix3D,t}r.CombineParticle=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=n.ResGC,__extends(i,t),i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.getParticleByte=function(t){var e,i=t=(t=t.replace("_byte.txt",".txt")).replace(".txt","_byte.txt");return(e=this._dic[i]?this._dic[i].getCombineParticle():new n.CombineParticle).url=i,e},i.prototype.registerUrl=function(t){t=(t=t.replace("_byte.txt",".txt")).replace(".txt","_byte.txt"),this._dic[t]&&this._dic[t].useNum++},i.prototype.releaseUrl=function(t){t=(t=t.replace("_byte.txt",".txt")).replace(".txt","_byte.txt"),this._dic[t]&&this._dic[t].clearUseNum()},i.prototype.addResByte=function(t,e){if(!this._dic[t]){var i=new n.CombineParticleData;i.setDataByte(e),this._dic[t]=i}},i);function i(){return t.call(this)||this}n.ParticleManager=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=n.Object3D,__extends(i,e),i.prototype.onCreated=function(){},i.prototype.setBind=function(t,e,i,n,o){this.bindVecter3d=t,this.bindMatrix=e,this.bindScale=i,this.invertBindMatrix=n,this.groupMatrix=o},i.prototype.getMulBindList=function(){return null},i.prototype.updateMatrix=function(){this.bindMatrix&&(this.modelMatrix.identity(),this.groupMatrix.isIdentity||this.posMatrix.append(this.groupMatrix),this.modelMatrix.append(this.posMatrix),this.modelMatrix.append(this.bindMatrix),this.modelMatrix.appendTranslation(this.bindVecter3d.x,this.bindVecter3d.y,this.bindVecter3d.z))},Object.defineProperty(i.prototype,"cantUseEffectsLev",{get:function(){return!(this.data._renderPriority<=n.Scene_data.effectsLev)},enumerable:!0,configurable:!0}),i.prototype.updateTime=function(t){this.cantUseEffectsLev||(this._time=t-this._beginTime,this._time+=this.data._delayedTime,this.timeline.updateTime(t),this.visible=this.timeline.visible,this.posMatrix.identity(),this.posMatrix.prependScale(.1*this._scaleX*this.bindScale.x*this.data.overAllScale,.1*this._scaleY*this.bindScale.y*this.data.overAllScale,.1*this._scaleZ*this.bindScale.z*this.data.overAllScale),this.timeline.updateMatrix(this.posMatrix,this))},i.prototype.reset=function(){this.timeline.reset(),this.updateTime(0)},i.prototype.clearAllAnim=function(){},i.prototype.update=function(){this.cantUseEffectsLev||this.visible&&this.data.materialParam&&(0==this.data._alphaMode&&(this.data._alphaMode=-1),n.Scene_data.context3D.setBlendParticleFactors(this.data._alphaMode),n.Scene_data.context3D.cullFaceBack(this.data.materialParam.material.backCull),this.data.materialParam&&n.Scene_data.context3D.setProgram(this.data.materialParam.program),this.updateMatrix(),this.setVc(),this.setVa(),this.resetVa())},i.prototype.setVc=function(){},i.prototype.pushVc=function(){n.Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData)},i.prototype.setVa=function(){},i.prototype.resetVa=function(){},i.prototype.setMaterialVc=function(){if(this.data.materialParam){for(var t=this.data.materialParam.dynamicConstList,e=this._time%(n.Scene_data.frameTime*this.data._life),i=0;i<t.length;i++)t[i].update(e);this.data.materialParam.material.fcNum<=0||(e*=this.data.materialParam.material.timeSpeed,this.data.materialParam.material.update(e),n.Scene_data.context3D.setVc4fv(this.data.materialParam.shader,"fc",this.data.materialParam.material.fcData))}},i.prototype.setMaterialTexture=function(){if(this.data.materialParam){for(var t=this.data.materialParam.material.texList,e=0;e<t.length;e++)t[e].isDynamic||n.Scene_data.context3D.setRenderTexture(this.data.materialParam.shader,t[e].name,t[e].texture,t[e].id,!0);var i=this.data.materialParam.dynamicTexList;for(e=0;e<i.length;e++)n.Scene_data.context3D.setRenderTexture(this.data.materialParam.shader,i[e].target.name,i[e].texture,i[e].target.id,!0)}},i.prototype.inverBind=function(){this.invertBindMatrix.isIdentity||this._rotationMatrix.prepend(this.invertBindMatrix)},i.prototype.resetPos=function(){},i.prototype.resetMulPos=function(t){},i.prototype.getVector3DByObject=function(t){return t?new n.Vector3D(t.x,t.y,t.z,t.w):null},i.prototype.clone=function(){return null},i.prototype.setAllByteInfo=function(t,e){void 0===e&&(e=0),this.creatData(),this.data.version=e,this.data.setAllByteInfo(t),this.timeline=new n.TimeLine,this.timeline.setAllDataInfo(this.data.timelineData),this._beginTime=this.timeline.beginTime},i.prototype.creatData=function(){this.data=new n.ParticleData},i.prototype.setTimeLine=function(t){this.timeline=t,this._beginTime=t.beginTime},i.prototype.destory=function(){this.timeline=null,this.bindMatrix=null,this.bindVecter3d=null,this.bindScale=null,this.invertBindMatrix=null,this.groupMatrix=null,this._rotationMatrix=null,this.modelMatrix=null,this.groupPos=null,this.groupScale=null,this.groupRotation=null},i);function i(){var t=e.call(this)||this;return t.isInGroup=!1,t.visible=!0,t._rotationMatrix=new n.Matrix3D,t.modelMatrix=new n.Matrix3D,t}n.Display3DParticle=t}(tl3d=tl3d||{}),function(f){var t=(e.prototype.destory=function(){this.objData&&this.objData.destory(),this.materialParam.destory(),this.timelineData.destory(),this.timelineData=null},e.prototype.uploadGpu=function(){},e.prototype.regShader=function(){},e.prototype.initVcData=function(){},e.prototype.creatPartilce=function(){var t=this.getParticle();t.data=this;var e=new f.TimeLine;return e.setAllDataInfo(this.timelineData),t.setTimeLine(e),t.onCreated(),t},e.prototype.getParticle=function(){return null},e.prototype.setAllByteInfo=function(t){this.timelineData=new f.TimeLineData,this.timelineData.setByteData(t),this._beginTime=this.timelineData.beginTime,15<=this.version&&(this._delayedTime=t.readFloat()),this._width=t.readFloat(),this._height=t.readFloat(),this._widthFixed=t.readBoolean(),this._heightFixed=t.readBoolean(),this._originWidthScale=t.readFloat(),this._originHeightScale=t.readFloat(),this._eyeDistance=t.readFloat(),this._alphaMode=t.readFloat(),this._uSpeed=t.readFloat(),this._vSpeed=t.readFloat(),this._animLine=t.readFloat(),this._animRow=t.readFloat(),this._animInterval=t.readFloat(),this._renderPriority=t.readFloat(),this._distortion=t.readBoolean(),this._isUV=t.readBoolean(),this._isU=t.readBoolean(),this._isV=t.readBoolean(),this._life=t.readFloat(),this._life=1e4<this._life?f.Scene_data.MAX_NUMBER:this._life,this._watchEye=t.readBoolean(),this._ziZhuanAngly=new f.Vector3D,this._ziZhuanAngly.x=t.readFloat(),this._ziZhuanAngly.y=t.readFloat(),this._ziZhuanAngly.z=t.readFloat(),this._ziZhuanAngly.w=t.readFloat(),this.rotationV3d=new f.Vector3D,this.rotationV3d.x=t.readFloat(),this.rotationV3d.y=t.readFloat(),this.rotationV3d.z=t.readFloat(),this.center=new f.Vector3D,this.center.x=t.readFloat(),this.center.y=t.readFloat(),this.center.z=t.readFloat(),this.center.w=t.readFloat(),this.overAllScale=t.readFloat(),!this._ziZhuanAngly||0==this._ziZhuanAngly.x&&0==this._ziZhuanAngly.y&&0==this._ziZhuanAngly.z||(this._isZiZhuan=!0),this.readMaterialPara(t);var e=t.readUTF();e=(e=e.replace("_byte.txt",".txt")).replace(".txt","_byte.txt"),this.materialByteUrl=e},Object.defineProperty(e.prototype,"materialByteUrl",{set:function(t){var e=this;this._materialUrl!=t&&(this._materialUrl=t,f.MaterialManager.getInstance().getMaterialByte(f.Scene_data.fileRoot+t,function(t){e.onMaterialLoad(t)}))},enumerable:!0,configurable:!0}),e.prototype.onMaterialLoad=function(t){this.materialParam=new f.MaterialParam,this.materialParam.setMaterial(t),this.materialParam.setLife(this._life),this.materialParamData&&(this.materialParam.setTextObj(this.materialParamData.texAry),this.materialParam.setConstObj(this.materialParamData.conAry)),f.MaterialManager.getInstance().loadDynamicTexUtil(this.materialParam),this.regShader()},e.prototype.readMaterialPara=function(t){this.materialParamData=new Object,t.readUTF();var e=t.readInt();this.materialParamData.texAry=new Array;for(var i=0;i<e;i++){var n=new Object;n.isParticleColor=t.readBoolean(),n.paramName=t.readUTF(),n.url=t.readUTF(),n.isParticleColor&&(n.curve=new Object,this.readTempCurve(t,n.curve)),this.materialParamData.texAry.push(n)}this.readMaterialParaConAry(t)},e.prototype.readTempCurve=function(t,e){e.values=new Array;var i=!1;if(12<=this.version){var n=t.readInt();if(0<n)var o=t.readFloat();for(var a=0;a<n;a++){for(var r=t.readInt(),s=new Array,u=0;u<r;u++)s.push(t.readByte()/127*o);e.values.push(s)}i=!0}e.type=t.readFloat(),e.maxFrame=t.readFloat(),e.sideType=t.readBoolean(),e.speedType=t.readBoolean(),e.useColorType=t.readBoolean(),e.items=this.readItems(t),i||this.makeCurveData(e)},e.prototype.readItems=function(t){for(var e=new Array,i=t.readInt(),n=0;n<i;n++){var o=new Object;o.frame=t.readInt(),o.vec3=t.readVector3D(!0),o.rotation=t.readVector3D(!0),o.rotationLeft=t.readVector3D(!0),e.push(o)}return e},e.prototype.makeCurveData=function(t){for(var e=t.items,i=new Array,n=new Array,o=new Array,a=new Array,r=0;r<e.length;r++)if(r==e.length-1)i.push(e[r].vec3.x),n.push(e[r].vec3.y),o.push(e[r].vec3.z),a.push(e[r].vec3.w);else{var s=e[r+1].frame-e[r].frame,u=e[r].vec3,h=e[r+1].vec3,l=t.items[r].rotation,c=t.items[r+1].rotationLeft;i=i.concat(this.getBzData(u.x,h.x,l.x,c.x,s)),n=n.concat(this.getBzData(u.y,h.y,l.y,c.y,s)),o=o.concat(this.getBzData(u.z,h.z,l.z,c.z,s)),a=a.concat(this.getBzData(u.w,h.w,l.w,c.w,s))}t.values=new Array,t.values[0]=i,t.values[1]=n,t.values[2]=o,t.values[3]=a},e.prototype.getBzData=function(t,e,i,n,o){var a=new f.Vector2D(0,10*t),r=new f.Vector2D(o,10*e),s=new f.Matrix3D,u=new f.Vector3D;s.identity(),s.appendRotation(-i,f.Vector3D.Z_AXIS),u=s.transformVector(new f.Vector3D(o/2,0,0));var h=new f.Vector2D(o/2,a.y+u.y);s.identity(),s.appendRotation(-n,f.Vector3D.Z_AXIS),u=s.transformVector(new f.Vector3D(-o/2,0,0));for(var l=[a,h,new f.Vector2D(o/2,r.y+u.y),r],c=new Array,p=1;p<3*o;p++)c.push(this.drawbezier(l,p/(3*o)));var d=new Array;for(p=0;p<o;p++)for(var _=0;_<c.length;_++)if(c[_].x>=p){d.push(c[_].y/10);break}return d},e.prototype.drawbezier=function(t,e){var i=new Array;if(0==t.length)return new f.Vector2D;for(var n in t)i.push(new f.Vector2D(t[n].x,t[n].y));for(;1<i.length;){for(var o=0;o<i.length-1;o++)this.mathmidpoint(i[o],i[o+1],e);i.pop()}return i[0]},e.prototype.mathmidpoint=function(t,e,i){var n,o;n=t.x+(e.x-t.x)*i,o=t.y+(e.y-t.y)*i,t.x=n,t.y=o},e.prototype.readMaterialParaConAry=function(t){for(var e=new Array,i=t.readInt(),n=0;n<i;n++){var o=new Object;o.type=t.readFloat(),o.indexID=t.readFloat(),o.paramName=t.readUTF(),o.curve=new Object,this.readTempCurve(t,o.curve),e.push(o)}this.materialParamData.conAry=e},e.prototype.setFloat32Vec=function(t,e){},e.prototype.setFloat32Mat=function(t,e){},e);function e(){this._delayedTime=0,this._width=100,this._height=100,this._originWidthScale=.5,this._originHeightScale=.5,this._eyeDistance=0,this._watchEye=!1,this._isZiZhuan=!1,this.overAllScale=1}f.ParticleData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.ObjData,__extends(n,e),n);function n(){return null!==e&&e.apply(this,arguments)||this}t.ParticleGpuData=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=e.Display3DParticle,__extends(n,i),Object.defineProperty(n.prototype,"facetdata",{get:function(){return this.data},enumerable:!0,configurable:!0}),n.prototype.creatData=function(){this.data=new e.ParticleFacetData},n.prototype.update=function(){this._lifeVisible&&i.prototype.update.call(this)},n.prototype.reset=function(){i.prototype.reset.call(this),this._lifeVisible=!0},n.prototype.setVc=function(){this.updateRotaionMatrix(),this.updateUV(),this.data.vcmatData.set(e.Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(e.Scene_data.cam3D.cameraMatrix.m,16),this.data.vcmatData.set(this.modelMatrix.m,48),this.data.vcmatData.set(this._rotationMatrix.m,32),this.data.vcmatData.set(this._resultUvVec,64),this.setMaterialVc(),!this.facetdata._isCycle&&this._time/e.Scene_data.frameTime>this.data._life-2&&(this._lifeVisible=!1),e.Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData)},n.prototype.setVa=function(){e.Scene_data.context3D.pushVa(this.data.objData.vertexBuffer)||(e.Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),e.Scene_data.context3D.setVaOffset(1,2,this.data.objData.stride,12)),this.setMaterialTexture(),e.Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum)},n.prototype.updateRotaionMatrix=function(){this._rotationMatrix.identity(),this.data._watchEye&&(this.timeline.inverAxisRotation(this._rotationMatrix),this.facetdata._locky||this.facetdata._lockx||this.inverBind(),this.facetdata._locky||this._rotationMatrix.prependRotation(-e.Scene_data.cam3D.rotationY,e.Vector3D.Y_AXIS),this.facetdata._lockx||this._rotationMatrix.prependRotation(-e.Scene_data.cam3D.rotationX,e.Vector3D.X_AXIS)),this.data._isZiZhuan&&this.timeline.applySelfRotation(this._rotationMatrix,this.data._ziZhuanAngly)},n.prototype.updateUV=function(){var t=float2int(this._time/e.Scene_data.frameTime);t=(t=t>this.facetdata._maxAnimTime?this.facetdata._maxAnimTime:t)/this.data._animInterval%(this.data._animLine*this.data._animRow),this._resultUvVec[0]=float2int(t%this.data._animLine)/this.data._animLine+this._time/e.Scene_data.frameTime*this.data._uSpeed,this._resultUvVec[1]=float2int(t/this.data._animLine)/this.data._animRow+this._time/e.Scene_data.frameTime*this.data._vSpeed},n);function n(){var t=i.call(this)||this;return t._lifeVisible=!0,t._resultUvVec=new Array(2),t}e.Display3DFacetParticle=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"v2TexCoord")},n.prototype.getMat4Str=function(t){return"vcmat["+n.shader_mat4[t]+"]"},n.prototype.getVec4Str=function(t){return"vcmat["+n.shader_vec4[t][0]+"]["+n.shader_vec4[t][1]+"]"},n.getVcSize=function(){return 5},n.prototype.getVertexShaderString=function(){return"attribute vec4 v3Position;\nattribute vec2 v2TexCoord;\nuniform mat4 vcmat["+n.getVcSize()+"];\nvarying vec2 v0;\nvoid main(void){\n   v0 = v2TexCoord + vec2("+this.getVec4Str("uvMove")+".xy);\n   gl_Position = "+this.getMat4Str("viewMatrix3D")+"  * "+this.getMat4Str("camMatrix3D")+" * "+this.getMat4Str("posMatrix3D")+" * "+this.getMat4Str("rotationMatrix3D")+" * v3Position;\n}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}"},n.Display3D_Facet_Shader="Display3DFacetShader",n.shader_mat4={viewMatrix3D:0,camMatrix3D:1,rotationMatrix3D:2,posMatrix3D:3},n.shader_vec4={uvMove:[4,0]},n);function n(){return e.call(this)||this}t.Display3DFacetShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(_){var e,t=(e=_.ParticleData,__extends(i,e),i.prototype.setAllByteInfo=function(t){this._maxAnimTime=t.readFloat(),this._isCycle=t.readBoolean(),this._lockx=t.readBoolean(),this._locky=t.readBoolean(),e.prototype.setAllByteInfo.call(this,t),this.initVcData(),this.uploadGpu()},i.prototype.getParticle=function(){return new _.Display3DFacetParticle},i.prototype.uploadGpu=function(){this.objData=new _.ObjData,this.makeRectangleData(this._width,this._height,this._originWidthScale,this._originHeightScale,this._isUV,this._isU,this._isV,this._animLine,this._animRow)},i.prototype.makeRectangleData=function(t,e,i,n,o,a,r,s,u){void 0===i&&(i=.5),void 0===n&&(n=.5),void 0===o&&(o=!1),void 0===a&&(a=!1),void 0===r&&(r=!1),void 0===s&&(s=1),void 0===u&&(u=1);var h=new Array,l=new Array,c=new Array;if(c.push(new _.Vector2D(0,0)),c.push(new _.Vector2D(0,1/u)),c.push(new _.Vector2D(1/s,1/u)),c.push(new _.Vector2D(1/s,0)),a)for(var p=0;p<c.length;p++)c[p].x=-c[p].x;if(r)for(p=0;p<c.length;p++)c[p].y=-c[p].y;for(o&&c.push(c.shift()),p=0;p<c.length;p++)h.push(c[p].x,c[p].y);l.push(-i*t,e-n*e,0),l.push(c[0].x,c[0].y),l.push(t-i*t,e-n*e,0),l.push(c[1].x,c[1].y),l.push(t-i*t,-n*e,0),l.push(c[2].x,c[2].y),l.push(-i*t,-n*e,0),l.push(c[3].x,c[3].y);var d=new Array;d.push(0,1,2,0,2,3),this.objData.stride=20,this.objData.vertexBuffer=_.Scene_data.context3D.uploadBuff3D(l),this.objData.indexBuffer=_.Scene_data.context3D.uploadIndexBuff3D(d),this.objData.treNum=d.length},i.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*_.Display3DFacetShader.getVcSize())},i.prototype.setFloat32Vec=function(t,e){var i=_.Display3DFacetShader.shader_vec4[t],n=16*i[0]+4*i[1];this.vcmatData.set(e,n)},i.prototype.setFloat32Mat=function(t,e){var i=16*_.Display3DFacetShader.shader_mat4[t];this.vcmatData.set(e,i)},i.prototype.regShader=function(){this.materialParam.shader=_.ProgrmaManager.getInstance().getMaterialProgram(_.Display3DFacetShader.Display3D_Facet_Shader,_.Display3DFacetShader,this.materialParam.material),this.materialParam.program=this.materialParam.shader.program},i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._isCycle=!1,t}_.ParticleFacetData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Display3DParticle,__extends(n,e),Object.defineProperty(n.prototype,"balldata",{get:function(){return this.data},enumerable:!0,configurable:!0}),n.prototype.creatData=function(){this.data=new t.ParticleBallData},n.prototype.setVa=function(){this.setVaCompress(),this.setMaterialTexture(),t.Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum)},n.prototype.setVaCompress=function(){t.Scene_data.context3D.pushVa(this.data.objData.vertexBuffer)||(t.Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),t.Scene_data.context3D.setVaOffset(1,3,this.data.objData.stride,12),t.Scene_data.context3D.setVaOffset(2,4,this.data.objData.stride,24),t.Scene_data.context3D.setVaOffset(3,3,this.data.objData.stride,40),this.balldata._needSelfRotation&&t.Scene_data.context3D.setVaOffset(4,2,this.data.objData.stride,52),this.balldata._needRandomColor&&t.Scene_data.context3D.setVaOffset(5,4,this.particleBallData.stride,this.particleBallData.randomOffset))},n.prototype.resetVa=function(){},n.prototype.setVc=function(){this.updateWatchCaramMatrix(),this.balldata.vcmatData.set(t.Scene_data.viewMatrx3D.m,0),this.balldata.vcmatData.set(t.Scene_data.cam3D.cameraMatrix.m,16),this.balldata.vcmatData.set(this.modelMatrix.m,32),this.balldata.vcmatData.set(this._rotationMatrix.m,48),this.balldata._timeVec[0]=this._time/t.Scene_data.frameTime*this.balldata._playSpeed,this.balldata.vcmatData.set(this.balldata._timeVec,80),this.balldata._is3Dlizi&&(this.updateAllRotationMatrix(),this.balldata._wordPosVec[0]=this.bindVecter3d.x,this.balldata._wordPosVec[1]=this.bindVecter3d.y,this.balldata._wordPosVec[2]=this.bindVecter3d.z,this.balldata._caramPosVec[0]=t.Scene_data.cam3D.x,this.balldata._caramPosVec[1]=t.Scene_data.cam3D.y,this.balldata._caramPosVec[2]=t.Scene_data.cam3D.z,this.balldata.vcmatData.set(this.balldata._allRotationMatrix.m,64),this.balldata.vcmatData.set(this.balldata._wordPosVec,96),this.balldata.vcmatData.set(this.balldata._caramPosVec,100)),t.Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.balldata.vcmatData),this.setMaterialVc()},n.prototype.updateWatchCaramMatrix=function(){this._rotationMatrix.identity(),this.balldata.facez?this._rotationMatrix.prependRotation(90,t.Vector3D.X_AXIS):this.balldata._is3Dlizi?(this.timeline.inverAxisRotation(this._rotationMatrix),this.inverBind()):this.balldata._watchEye&&(this.timeline.inverAxisRotation(this._rotationMatrix),this.inverBind(),this._rotationMatrix.prependRotation(-t.Scene_data.cam3D.rotationY,t.Vector3D.Y_AXIS),this._rotationMatrix.prependRotation(-t.Scene_data.cam3D.rotationX,t.Vector3D.X_AXIS))},n.prototype.updateAllRotationMatrix=function(){this.balldata._allRotationMatrix.identity(),this.balldata._allRotationMatrix.prependScale(this.data.overAllScale*this._scaleX*.1*this.bindScale.x,this.data.overAllScale*this._scaleY*.1*this.bindScale.y,this.data.overAllScale*this._scaleZ*.1*this.bindScale.z),this.timeline.inverAxisRotation(this._rotationMatrix),this.isInGroup&&(this.balldata._allRotationMatrix.appendRotation(this.groupRotation.x,t.Vector3D.X_AXIS),this.balldata._allRotationMatrix.appendRotation(this.groupRotation.y,t.Vector3D.Y_AXIS),this.balldata._allRotationMatrix.appendRotation(this.groupRotation.z,t.Vector3D.Z_AXIS)),this.bindMatrix&&this.balldata._allRotationMatrix.append(this.bindMatrix)},Object.defineProperty(n.prototype,"particleBallData",{get:function(){return this.data.objData},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.Display3DBallPartilce=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(v,e),v.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"vPosition"),t.bindAttribLocation(this.program,1,"texcoord"),t.bindAttribLocation(this.program,2,"basePos"),t.bindAttribLocation(this.program,3,"speed"),this.paramAry[3]&&t.bindAttribLocation(this.program,4,"rotation"),this.paramAry[1]&&t.bindAttribLocation(this.program,5,"color")},v.prototype.getMat4Str=function(t){return"vcmat["+v.shader_mat4[t]+"]"},v.prototype.getVec4Str=function(t){return"vcmat["+v.shader_vec4[t][0]+"]["+v.shader_vec4[t][1]+"]"},v.getVcSize=function(){return 7},v.prototype.getVertexShaderString=function(){var t,e,i,n,o,a,r,s,u,h;h="attribute vec4 vPosition;\nattribute vec3 texcoord;\nattribute vec4 basePos;\nattribute vec3 speed;\nuniform mat4 vcmat["+v.getVcSize()+"];\nvarying vec2 v0;\n",t="float ctime = "+this.getVec4Str("time")+".x - basePos.w;\nif ("+this.getVec4Str("time")+".w > 0.0 && ctime >= 0.0) {\n    ctime = fract(ctime / "+this.getVec4Str("time")+".z) * "+this.getVec4Str("time")+".z;\n}\nvec4 pos = vPosition;\n",e="float stime = ctime - "+this.getVec4Str("scale")+".w;\nstime = max(stime,0.0);\nfloat sf = "+this.getVec4Str("scale")+".x * stime;\nif ("+this.getVec4Str("scale")+".y != 0.0 && "+this.getVec4Str("scale")+".z != 0.0) {\n    sf += sin("+this.getVec4Str("scale")+".y * stime) * "+this.getVec4Str("scale")+".z;\n}\nif (sf > "+this.getVec4Str("scaleCtrl")+".z) {\n    sf = "+this.getVec4Str("scaleCtrl")+".z;\n} else if (sf < "+this.getVec4Str("scaleCtrl")+".w) {\n    sf = "+this.getVec4Str("scaleCtrl")+".w;\n}\nvec2 sv2 = vec2("+this.getVec4Str("scaleCtrl")+".x * sf, "+this.getVec4Str("scaleCtrl")+".y * sf);\nsv2 = sv2 + 1.0;\npos.x *= sv2.x;\npos.y *= sv2.y;\n",i="vec3 addPos = speed * ctime;\nvec3 uspeed = vec3(0,0,0);\nif (ctime < 0.0 || ctime >= "+this.getVec4Str("time")+".z) {\n    addPos.y = addPos.y + 100000.0;\n}\n",n="if("+this.getVec4Str("time")+".y != 0.0 && length(speed) != 0.0) {\n    uspeed = vec3(speed.x, speed.y, speed.z);\n    uspeed = normalize(uspeed);\n    uspeed = uspeed * "+this.getVec4Str("time")+".y;\n    uspeed.xyz = uspeed.xyz + "+this.getVec4Str("force")+".xyz;\n} else {\n    uspeed = vec3("+this.getVec4Str("force")+".x, "+this.getVec4Str("force")+".y, "+this.getVec4Str("force")+".z);\n}\naddPos.xyz = addPos.xyz + uspeed.xyz * ctime * ctime;\n",o="uspeed = speed + uspeed * ctime * 2.0;\nuspeed = normalize(uspeed);\nvec4 tempMul = "+this.getMat4Str("rotationMatrix")+" * vec4(uspeed,1.0);\nuspeed.xyz = tempMul.xyz;\nuspeed = normalize(uspeed);\nvec3 cPos = addPos;\ntempMul = "+this.getMat4Str("rotationMatrix")+" * vec4(cPos,1.0);\ncPos.xyz = tempMul.xyz; \ncPos.xyz = "+this.getVec4Str("worldPos")+".xyz + cPos.xyz;\ncPos.xyz = "+this.getVec4Str("camPos")+".xyz - cPos.xyz;\ncPos = normalize(cPos);\ncPos = cross(uspeed, cPos);\ncPos = normalize(cPos);\nuspeed = uspeed * pos.x;\ncPos = cPos * pos.y;\npos.xyz = uspeed.xyz + cPos.xyz;\n",a="pos = "+this.getMat4Str("watheye")+" * pos;\npos.xyz = pos.xyz + basePos.xyz + addPos.xyz;\ngl_Position = "+this.getMat4Str("viewMatrix3D")+" * "+this.getMat4Str("camMatrix3D")+" * "+this.getMat4Str("modelMatrix")+" * pos;\n",r="vec2 uv = vec2(texcoord.x,texcoord.y);\nfloat animframe = floor(ctime / "+this.getVec4Str("animCtrl")+".z);\nanimframe = animframe / "+this.getVec4Str("animCtrl")+".x;\nuv.x += animframe;\nanimframe = floor(animframe);\nuv.y += animframe / "+this.getVec4Str("animCtrl")+".y;\nv0.xy = uv.xy;\n",s="vec2 uv = vec2("+this.getVec4Str("uvCtrl")+".x,"+this.getVec4Str("uvCtrl")+".y);\nuv.xy = uv.xy * ctime + texcoord.xy;\nv0.xy = uv.xy;\n",u="v1 = vec2(ctime/"+this.getVec4Str("time")+".z,1.0);\n";var l=this.paramAry[0],c=this.paramAry[1],p=this.paramAry[2],d=this.paramAry[3],_=this.paramAry[4],f=this.paramAry[5],g=this.paramAry[6],y="",m="";return y+=t,m+=h,_&&(y+=e,m+=""),d&&(y+="float angle = rotation.x + rotation.y * ctime;\nvec4 np = vec4(sin(angle), cos(angle), 0, 0);\nnp.z = np.x * pos.y + np.y * pos.x;\nnp.w = np.y * pos.y - np.x * pos.x;\npos.xy = np.zw;\n",m+="attribute vec2 rotation;\n"),y+=i,f&&(y+=n,m+=""),p&&(y+=o,m+=""),y+=a,1==g?(y+=r,m+=""):2==g?(y+=s,m+=""):y+="v0 = vec2(texcoord.x,texcoord.y);\n",c&&(y+="v2 = color;\n",m+="attribute vec4 color;\nvarying vec4 v2;\n"),l&&(y+=u,m+="varying vec2 v1;\n"),m+"void main(){\n"+y+"}"},v.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}"},v.Display3D_Ball_Shader="Display3DBallShader",v.shader_mat4={viewMatrix3D:0,camMatrix3D:1,modelMatrix:2,watheye:3,rotationMatrix:4},v.shader_vec4={time:[5,0],scale:[5,1],scaleCtrl:[5,2],force:[5,3],worldPos:[6,0],camPos:[6,1],animCtrl:[6,2],uvCtrl:[6,3]},v);function v(){return e.call(this)||this}t.Display3DBallShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(f){var e,t=(e=f.ParticleData,__extends(i,e),i.prototype.getParticle=function(){return new f.Display3DBallPartilce},i.prototype.setAllByteInfo=function(t){this._totalNum=t.readFloat(),this._acceleration=t.readFloat(),this._toscale=t.readFloat(),this._shootSpeed=t.readFloat(),this._isRandom=t.readBoolean(),this._isSendRandom=t.readBoolean(),this._round.x=t.readFloat(),this._round.y=t.readFloat(),this._round.z=t.readFloat(),this._round.w=t.readFloat(),this._is3Dlizi=t.readBoolean(),this._halfCircle=t.readBoolean(),this._shootAngly.x=t.readFloat(),this._shootAngly.y=t.readFloat(),this._shootAngly.z=t.readFloat(),this._shootAngly.w=t.readFloat(),this._shootAngly.normalize(),this._speed=t.readFloat(),this._isLoop=t.readBoolean(),this._isSendAngleRandom=t.readBoolean(),this._waveform.x=t.readFloat(),this._waveform.y=t.readFloat(),this._waveform.z=t.readFloat(),this._waveform.w=t.readFloat(),this._closeSurface=t.readBoolean(),this._isEven=t.readBoolean(),this._paticleMaxScale=t.readFloat(),this._paticleMinScale=t.readFloat(),this._basePositon.x=t.readFloat(),this._basePositon.y=t.readFloat(),this._basePositon.z=t.readFloat(),this._basePositon.w=t.readFloat(),this._baseRandomAngle=t.readFloat(),this._shapeType=t.readFloat(),this._lockX=t.readBoolean(),this._lockY=t.readBoolean(),this._addforce.x=t.readFloat(),this._addforce.y=t.readFloat(),this._addforce.z=t.readFloat(),this._addforce.w=t.readFloat(),this._addforce.scaleByW(),this._lixinForce.x=t.readFloat(),this._lixinForce.y=t.readFloat(),this._lixinForce.z=t.readFloat(),this._lixinForce.w=t.readFloat(),this._islixinAngly=t.readBoolean(),this._particleRandomScale=new f.Vector3D,this._particleRandomScale.x=t.readFloat(),this._particleRandomScale.y=t.readFloat(),this._particleRandomScale.z=t.readFloat(),this._particleRandomScale.w=t.readFloat(),this._playSpeed=t.readFloat(),this.facez=t.readBoolean(),this._beginScale=t.readFloat(),this._widthFixed=t.readBoolean(),this._heightFixed=t.readBoolean(),this.readRandomColor(t),0!=this._acceleration||0!=this._addforce.x||0!=this._addforce.y||0!=this._addforce.z?(this._needAddSpeed=!0,this._addSpeedVec=[this._addforce.x,this._addforce.y,this._addforce.z]):this._needAddSpeed=!1,0!=this._toscale||0!=this._waveform.x||0!=this._waveform.y?(this._needScale=!0,this._scaleVec=[this._toscale,this._waveform.x,this._waveform.y,this._beginScale],this._scaleCtrlVec=[this._widthFixed?0:1,this._heightFixed?0:1,this._paticleMaxScale-1,this._paticleMinScale-1]):this._needScale=!1,e.prototype.setAllByteInfo.call(this,t),this._timeVec=[0,this._acceleration,this._life,this._isLoop?1:-1],this._is3Dlizi&&(this._wordPosVec=[0,0,0],this._caramPosVec=[0,0,0],this._allRotationMatrix=new f.Matrix3D),this.initVcData()},i.prototype.readRandomColor=function(t){var e=t.readInt(),i=new Object;i.alpha=new Array,i.color=new Array,i.pos=new Array;for(var n=0;n<e;n++)i.alpha.push(t.readFloat()),i.color.push(t.readFloat()),i.pos.push(t.readFloat());this._textureRandomColorInfo=i},Object.defineProperty(i.prototype,"objBallData",{get:function(){return this.objData},enumerable:!0,configurable:!0}),i.prototype.uploadGpu=function(){this.objData=new f.ParticleBallGpuData,this.initBaseData(),this.initBasePos(),this.initSpeed(),this.initSelfRotaion(),this._needRandomColor&&this.initBaseColor(),this.pushToGpu()},i.prototype.initBaseData=function(){for(var t=new Array,e=new Array,i=new Array,n=0;n<this._totalNum;n++)this.makeRectangleData(t,e,this._width,this._height,this._originWidthScale,this._originHeightScale,this._isUV,this._isU,this._isV,this._animLine,this._animRow,n),i.push(0+4*n,1+4*n,2+4*n,0+4*n,2+4*n,3+4*n);this.objBallData.vertices=t,this.objBallData.uvs=e,this.objBallData.indexs=i},i.prototype.makeRectangleData=function(t,e,i,n,o,a,r,s,u,h,l,c){void 0===o&&(o=.5),void 0===a&&(a=.5),void 0===r&&(r=!1),void 0===s&&(s=!1),void 0===u&&(u=!1),void 0===h&&(h=1),void 0===l&&(l=1),void 0===c&&(c=0);var p=Math.random()*(this._particleRandomScale.x-this._particleRandomScale.y)+this._particleRandomScale.y;t.push(-o*i*p,(n-a*n)*p,0),t.push((i-o*i)*p,(n-a*n)*p,0),t.push((i-o*i)*p,-a*n*p,0),t.push(-o*i*p,-a*n*p,0);var d=new Array;if(d.push(new f.Vector2D(0,0)),d.push(new f.Vector2D(0,1/l)),d.push(new f.Vector2D(1/h,1/l)),d.push(new f.Vector2D(1/h,0)),s)for(var _=0;_<d.length;_++)d[_].x=-d[_].x;if(u)for(_=0;_<d.length;_++)d[_].y=-d[_].y;for(r&&d.push(d.shift()),_=0;_<d.length;_++)e.push(d[_].x,d[_].y,c)},i.prototype.initBasePos=function(){for(var t=new Array,e=0;e<this._totalNum;e++){var i,n;if(this._isRandom){var o=new f.Vector3D(this._round.x*this._round.w,this._round.y*this._round.w,this._round.z*this._round.w);this._isEven?(i=this._closeSurface?new f.Vector3D(0,0,o.z):new f.Vector3D(0,0,o.z*Math.random()*2-o.z),(n=new f.Matrix3D).appendRotation(360*Math.random(),f.Vector3D.Y_AXIS),(i=n.transformVector(i)).y=o.y*Math.random()*2-o.y):i=this._closeSurface?(i=new f.Vector3D(0,0,o.z),n=new f.Matrix3D,this._halfCircle?n.appendRotation(180*-Math.random(),f.Vector3D.X_AXIS):n.appendRotation(360*Math.random(),f.Vector3D.X_AXIS),n.appendRotation(360*Math.random(),f.Vector3D.Y_AXIS),n.transformVector(i)):this._halfCircle?new f.Vector3D(o.x*Math.random()*2-o.x,o.y*Math.random(),o.z*Math.random()*2-o.z):new f.Vector3D(o.x*Math.random()*2-o.x,o.y*Math.random()*2-o.y,o.z*Math.random()*2-o.z)}else i=new f.Vector3D;i=i.add(this._basePositon);for(var a=0;a<4;a++)t.push(i.x,i.y,i.z,e*this._shootSpeed)}this.objBallData.basePos=t},i.prototype.initSpeed=function(){for(var t=new Array,e=0;e<this._totalNum;e++){var i=new f.Vector3D,n=new f.Vector3D;if(0!=this._shootAngly.x||0!=this._shootAngly.y||0!=this._shootAngly.z){var o=Math.tan(this._shootAngly.w*Math.PI/180*Math.random()),a=360*Math.PI/180*Math.random();n=new f.Vector3D(Math.sin(a)*o,Math.cos(a)*o,1);var r=new f.Matrix3D;if(r.fromVtoV(new f.Vector3D(0,.0101,.99994),new f.Vector3D(this._shootAngly.x,this._shootAngly.y,this._shootAngly.z)),n=r.transformVector(n),isNaN(n.x))throw new Error("发射锥角，可能有问题，确定是否有取膜");n.normalize(),i=i.add(n)}0==this._lixinForce.x&&0==this._lixinForce.y&&0==this._lixinForce.z||((n=new f.Vector3D(.5<Math.random()?-this._lixinForce.x:this._lixinForce.x,.5<Math.random()?-this._lixinForce.y:this._lixinForce.y,.5<Math.random()?-this._lixinForce.z:this._lixinForce.z)).normalize(),i=i.add(n)),this._islixinAngly&&((n=this._isEven?new f.Vector3D(this.objBallData.basePos[16*e],0,this.objBallData.basePos[16*e+2]):new f.Vector3D(this.objBallData.basePos[16*e],this.objBallData.basePos[16*e+1],this.objBallData.basePos[16*e+2])).normalize(),i=i.add(n)),i.normalize(),this._isSendRandom?i.scaleBy(this._speed*Math.random()):i.scaleBy(this._speed),this._baseRandomAngle,Math.random(),Math.PI;for(var s=0;s<4;s++)t.push(i.x,i.y,i.z)}this.objBallData.beMove=t},i.prototype.initSelfRotaion=function(){var t=0,e=0;if(0!=this._ziZhuanAngly.x||0!=this._ziZhuanAngly.y||0!=this._ziZhuanAngly.z||0!=this._ziZhuanAngly.w)if(this._is3Dlizi)this._needSelfRotation=!1;else{this._needSelfRotation=!0;for(var i=new Array,n=0;n<this._totalNum;)t=this._ziZhuanAngly.x,1==this._ziZhuanAngly.y&&(t*=Math.random()),e=this._ziZhuanAngly.z,1==this._ziZhuanAngly.w?e*=Math.random():-1==this._ziZhuanAngly.w&&(e*=2*Math.random()-1),i.push(t,e),i.push(t,e),i.push(t,e),i.push(t,e),n++;this.objBallData.baseRotation=i}else this._needSelfRotation=!1},i.prototype.initBaseColor=function(){for(var t=f.ColorTransition.getInstance().getImageData(this._textureRandomColorInfo).data,e=new Array,i=0;i<this._totalNum;i++){var n=4*float2int(128*Math.random()),o=new f.Vector3D(t[n],t[1+n],t[2+n],t[3+n]);o.scaleBy(1/255),e.push(o.x,o.y,o.z,o.w),e.push(o.x,o.y,o.z,o.w),e.push(o.x,o.y,o.z,o.w),e.push(o.x,o.y,o.z,o.w)}this.objBallData.randomColor=e},i.prototype.pushToGpu=function(){this.compressVertex()},i.prototype.compressVertex=function(){var t=this.objBallData.vertices.length/3,e=13;this._needSelfRotation&&(e+=2),this._needRandomColor&&(this.objBallData.randomOffset=4*e,e+=4),this.objBallData.stride=4*e;for(var i=new Array,n=0;n<t;n++){for(var o=0;o<3;o++)i.push(this.objBallData.vertices[3*n+o]);for(o=0;o<3;o++)i.push(this.objBallData.uvs[3*n+o]);for(o=0;o<4;o++)i.push(this.objBallData.basePos[4*n+o]);for(o=0;o<3;o++)i.push(this.objBallData.beMove[3*n+o]);if(this._needSelfRotation)for(o=0;o<2;o++)i.push(this.objBallData.baseRotation[2*n+o]);if(this._needRandomColor)for(o=0;o<4;o++)i.push(this.objBallData.randomColor[4*n+o])}this.objBallData.vertexBuffer=f.Scene_data.context3D.uploadBuff3D(i),this.objBallData.indexBuffer=f.Scene_data.context3D.uploadIndexBuff3D(this.objBallData.indexs),this.objBallData.treNum=this.objBallData.indexs.length},i.prototype.setFloat32Vec=function(t,e){var i=f.Display3DBallShader.shader_vec4[t],n=16*i[0]+4*i[1];this.vcmatData.set(e,n)},i.prototype.setFloat32Mat=function(t,e){var i=16*f.Display3DBallShader.shader_mat4[t];this.vcmatData.set(e,i)},i.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*f.Display3DBallShader.getVcSize()),this.setFloat32Vec("time",this._timeVec),this._needAddSpeed&&this.setFloat32Vec("force",this._addSpeedVec),this._needScale&&(this.setFloat32Vec("scale",this._scaleVec),this.setFloat32Vec("scaleCtrl",this._scaleCtrlVec)),1==this._uvType?this.setFloat32Vec("animCtrl",this._animCtrlVec):2==this._uvType&&this.setFloat32Vec("uvCtrl",this._uvCtrlVec)},i.prototype.regShader=function(){if(this.materialParam){var t=this.getShaderParam();this.materialParam.shader=f.ProgrmaManager.getInstance().getMaterialProgram(f.Display3DBallShader.Display3D_Ball_Shader,f.Display3DBallShader,this.materialParam.material,t),this.materialParam.program=this.materialParam.shader.program}},i.prototype.getShaderParam=function(){1!=this._animRow||1!=this._animLine?(this._uvType=1,this._animCtrlVec=[this._animLine,this._animRow,this._animInterval]):0!=this._uSpeed||0!=this._vSpeed?(this._uvType=2,this._uvCtrlVec=[this._uSpeed,this._vSpeed]):this._uvType=0;var t=this.materialParam.material.hasParticleColor;return this._needRandomColor=this.materialParam.material.hasVertexColor,this.uploadGpu(),[t?1:0,this._needRandomColor?1:0,this._is3Dlizi?1:0,this._needSelfRotation?1:0,this._needScale?1:0,this._needAddSpeed?1:0,this._uvType]},i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._totalNum=1,t._acceleration=.2,t._toscale=0,t._shootAngly=new f.Vector3D(1,0,0),t._shootSpeed=0,t._isRandom=!1,t._isSendRandom=!1,t._isSendAngleRandom=!1,t._paticleMaxScale=1,t._paticleMinScale=1,t._addforce=new f.Vector3D(0,0,0),t._lixinForce=new f.Vector3D(0,0,0),t._waveform=new f.Vector3D(0,0,0,0),t._round=new f.Vector3D,t._is3Dlizi=!1,t._speed=1,t._isLoop=!1,t._basePositon=new f.Vector3D(0,0,0),t._baseRandomAngle=0,t._shapeType=0,t._playSpeed=1,t._beginScale=0,t}f.ParticleBallData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.ParticleGpuData,__extends(n,e),n.prototype.destory=function(){e.prototype.destory.call(this),this.basePos&&(this.basePos.length=0,this.basePos=null,this.basePosBuffer&&(t.Scene_data.context3D.deleteBuffer(this.basePosBuffer),this.basePosBuffer=null)),this.beMove&&(this.beMove.length=0,this.beMove=null,this.beMoveBuffer&&(t.Scene_data.context3D.deleteBuffer(this.beMoveBuffer),this.beMoveBuffer=null)),this.randomColor&&(this.randomColor.length=0,this.randomColor=null,this.randomColorBuffer&&(t.Scene_data.context3D.deleteBuffer(this.randomColorBuffer),this.randomColorBuffer=null)),this.baseRotation&&(this.baseRotation.length=0,this.baseRotation=null,this.baseRotationBuffer&&(t.Scene_data.context3D.deleteBuffer(this.baseRotationBuffer),this.baseRotationBuffer=null))},n);function n(){return null!==e&&e.apply(this,arguments)||this}t.ParticleBallGpuData=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=e.Shader3D,__extends(n,t),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"u2Texture")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Position;attribute vec2 u2Texture;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec2 v_texCoord;void main(void){   v_texCoord = vec2(u2Texture.x, u2Texture.y);   vec4 vt0= vec4(v3Position, 1.0);   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return"precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ngl_FragColor =infoUv;\n}"},n.BaseDiplay3dShader="BaseDiplay3dShader",n);function n(){return t.call(this)||this}e.BaseDiplay3dShader=i;var o,a=(o=e.Display3D,__extends(r,o),r.prototype.initData=function(){e.ProgrmaManager.getInstance().registe(i.BaseDiplay3dShader,new i),this.shader=e.ProgrmaManager.getInstance().getProgram(i.BaseDiplay3dShader),this.program=this.shader.program,this.objData=new e.ObjData,this.objData.vertices=new Array,this.objData.vertices.push(0,0,0),this.objData.vertices.push(100,0,0),this.objData.vertices.push(100,0,100),this.objData.uvs=new Array,this.objData.uvs.push(0,0),this.objData.uvs.push(1,0),this.objData.uvs.push(0,1),this.objData.indexs=new Array,this.objData.indexs.push(0,1,2),this.loadTexture(),this.upToGpu()},r.prototype.loadTexture=function(){var t=e.UIManager.getInstance().getContext2D(128,128,!1);t.fillStyle="rgb(255,255,255)",t.fillRect(0,0,128,128),this._uvTextureRes=e.TextureManager.getInstance().getCanvasTexture(t)},r.prototype.upToGpu=function(){this.objData.indexs.length&&(this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer=e.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=e.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=e.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs))},r.prototype.update=function(){this.objData&&this.objData.indexBuffer&&this._uvTextureRes&&(e.Scene_data.context3D.setProgram(this.program),e.Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",e.Scene_data.viewMatrx3D.m),e.Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",e.Scene_data.cam3D.cameraMatrix.m),e.Scene_data.context3D.setVcMatrix4fv(this.shader,"posMatrix3D",this.posMatrix.m),e.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),e.Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),e.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this._uvTextureRes.texture,0),e.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},r);function r(){var t=o.call(this)||this;return t.initData(),t.updateMatrix,t}e.BaseDiplay3dSprite=a}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=n.Display3DParticle,__extends(i,t),Object.defineProperty(i.prototype,"locusdata",{get:function(){return this.data},enumerable:!0,configurable:!0}),i.prototype.creatData=function(){this.data=new n.ParticleLocusData},i.prototype.setVa=function(){n.Scene_data.context3D.pushVa(this.data.objData.vertexBuffer)||(n.Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),n.Scene_data.context3D.setVaOffset(1,2,this.data.objData.stride,28),this.data._watchEye&&n.Scene_data.context3D.setVaOffset(2,4,this.data.objData.stride,12)),this.setMaterialTexture(),n.Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum)},i.prototype.setVc=function(){this.updateUV(),this.data.vcmatData.set(n.Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(n.Scene_data.cam3D.cameraMatrix.m,16),this.data.vcmatData.set(this.modelMatrix.m,32),this.data.vcmatData.set(this.locusdata._resultUvVec,48),this.data._watchEye&&(this.locusdata._caramPosVec[0]=n.Scene_data.cam3D.x,this.locusdata._caramPosVec[1]=n.Scene_data.cam3D.y,this.locusdata._caramPosVec[2]=n.Scene_data.cam3D.z,this.data.vcmatData.set(this.locusdata._caramPosVec,52)),this.locusdata._changUv&&this.data.setFloat32Vec("isUv",this.locusdata._uvVec),n.Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData),this.setMaterialVc()},i.prototype.updateUV=function(){var t=this._time/n.Scene_data.frameTime,e=this.data._life/100,i=this.locusdata._speed*t/this.locusdata._density/10;this.locusdata._isEnd&&(i=Math.min(1,i)),this.locusdata._isLoop&&(this.locusdata._life?i%=1+e:i%=1),this.locusdata._resultUvVec[0]=i},i);function i(){return t.call(this)||this}n.Display3DLocusPartilce=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(c){var t,e=(t=c.Shader3D,__extends(i,t),i.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"v2TexCoord"),this.paramAry[0]&&t.bindAttribLocation(this.program,2,"v3Normal")},i.prototype.getMat4Str=function(t){return"vcmat["+i.shader_mat4[t]+"]"},i.prototype.getVec4Str=function(t){return"vcmat["+i.shader_vec4[t][0]+"]["+i.shader_vec4[t][1]+"]"},i.getVcSize=function(){return 4},i.prototype.getVertexShaderString=function(){var t="attribute vec4 v3Position;\nattribute vec2 v2TexCoord;\nuniform mat4 vcmat["+c.Display3DFacetShader.getVcSize()+"];\nvarying vec2 v0;\nvarying vec4 v2;\n",e="   vec2 tempv0 = v2TexCoord;\n   tempv0.x -= "+this.getVec4Str("uvMove")+".x;\n",i="   tempv0.xy *= "+this.getVec4Str("isUv")+".xy;\n   if("+this.getVec4Str("isUv")+".z >= 0.0){\n   vec2 tempv1 = tempv0;\n   tempv0.y = tempv1.x;\n   tempv0.x = tempv1.y;}\n   v0 = tempv0;\n",n="   float alpha = tempv0.x/"+this.getVec4Str("uvMove")+".y;\n   alpha = 1.0 - clamp(abs(alpha),0.0,1.0);\n   float kill = -tempv0.x;\n   kill *= tempv0.x - "+this.getVec4Str("uvMove")+".z;\n   v2 = vec4(kill,0.0,0.0,alpha);\n",o="   gl_Position = "+this.getMat4Str("viewMatrix3D")+"  * "+this.getMat4Str("camMatrix3D")+" * "+this.getMat4Str("posMatrix3D")+" * v3Position;\n",a="   vec4 tempPos = "+this.getMat4Str("posMatrix3D")+" * v3Position;\n   vec3 mulPos = vec3(tempPos.x,tempPos.y,tempPos.z);\n   vec3 normals = vec3(v3Normal.x,v3Normal.y,v3Normal.z);\n   mulPos = normalize(vec3("+this.getVec4Str("camPos")+".xyz) - mulPos);\n   mulPos = cross(mulPos, normals);\n   mulPos = normalize(mulPos);\n   mulPos *= v3Normal.w;\n   tempPos.xyz = mulPos.xyz + v3Position.xyz;\n   gl_Position = "+this.getMat4Str("viewMatrix3D")+"  * "+this.getMat4Str("camMatrix3D")+" * "+this.getMat4Str("posMatrix3D")+" * tempPos;\n",r=this.paramAry[0],s=this.paramAry[1],u=this.paramAry[2],h=t;r&&(h+="attribute vec4 v3Normal;\n"),s&&(h+=""),u&&(h+="varying vec2 v1;\n");var l=e+n;return u&&(l+="   v1 = v2TexCoord;\n"),l+=s?i:"   v0 = tempv0;\n",h+"void main(void){\n"+(l+=r?a:o)+"}"},i.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}"},i.Display3D_Locus_Shader="Display3DLocusShader",i.shader_mat4={viewMatrix3D:0,camMatrix3D:1,posMatrix3D:2},i.shader_vec4={uvMove:[3,0],camPos:[3,1],isUv:[3,2]},i);function i(){return t.call(this)||this}c.Display3DLocusShader=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var s,t=(s=r.ParticleData,__extends(e,s),e.prototype.getParticle=function(){return new r.Display3DLocusPartilce},e.prototype.setAllByteInfo=function(t){this._isLoop=t.readBoolean(),this._speed=t.readFloat(),this._density=t.readFloat(),this._isEnd=t.readBoolean(),this.objData=new r.ObjData;var e=t.getInt(),i=new ArrayBuffer(9*e*4),n=new DataView(i);r.BaseRes.readBytes2ArrayBuffer(t,n,3,0,9,4),r.BaseRes.readBytes2ArrayBuffer(t,n,4,3,9,4),r.BaseRes.readBytes2ArrayBuffer(t,n,2,7,9,4);for(var o=t.readInt(),a=0;a<o;a++)this.objData.indexs.push(t.readInt());this.objData.stride=36,s.prototype.setAllByteInfo.call(this,t),this.initUV(),this._watchEye&&(this._caramPosVec=[0,0,0]),this._uvVec=[this._isU?-1:1,this._isV?-1:1,this._isUV?1:-1],this.initVcData(),this.objData.vertexBuffer=r.Scene_data.context3D.uploadBuff3DArrayBuffer(i),this.objData.indexBuffer=r.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.treNum=this.objData.indexs.length},e.prototype.initUV=function(){this._resultUvVec=new Array(3);var t,e=this._life/100,i=0*this._speed/this._density/10;this._isEnd&&(i=Math.min(1,i)),t=this._isLoop?this._life?(i%=1+e,new r.Vector3D(i,e,-e)):(i%=1,new r.Vector3D(i+1,99,-2)):this._life?new r.Vector3D(i,e,-1):new r.Vector3D(i,99,-1),this._resultUvVec[0]=t.x,this._resultUvVec[1]=t.y,this._resultUvVec[2]=t.z},e.prototype.uploadGpu=function(){this.objData.vertexBuffer=r.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=r.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this._watchEye&&(this.objData.normalsBuffer=r.Scene_data.context3D.uploadBuff3D(this.objData.normals)),this.objData.indexBuffer=r.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.treNum=this.objData.indexs.length},e.prototype.regShader=function(){if(this.materialParam){var t,e=this._watchEye?1:0,i=0,n=this.materialParam.material.hasParticleColor;this._isU||this._isV||this._isUV?(i=1,this._changUv=!0):this._changUv=!1,t=[e,i,n?1:0],this.materialParam.shader=r.ProgrmaManager.getInstance().getMaterialProgram(r.Display3DLocusShader.Display3D_Locus_Shader,r.Display3DLocusShader,this.materialParam.material,t),this.materialParam.program=this.materialParam.shader.program}},e.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*r.Display3DLocusShader.getVcSize())},e.prototype.setFloat32Vec=function(t,e){var i=r.Display3DLocusShader.shader_vec4[t],n=16*i[0]+4*i[1];this.vcmatData.set(e,n)},e.prototype.setFloat32Mat=function(t,e){var i=16*r.Display3DLocusShader.shader_mat4[t];this.vcmatData.set(e,i)},e);function e(){var t=null!==s&&s.apply(this,arguments)||this;return t._speed=1,t._isLoop=!1,t}r.ParticleLocusData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Display3DBallPartilce,__extends(n,e),n.prototype.creatData=function(){this.data=new t.ParticleLocusballData},n);function n(){return e.call(this)||this}t.Display3DLocusBallPartilce=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=r.ParticleBallData,__extends(i,e),i.prototype.getParticle=function(){return new r.Display3DLocusBallPartilce},i.prototype.initBasePos=function(){for(var t=new Array,e=0;e<this._totalNum;e++){var i,n=3*e;if(this._isRandom){var o=new r.Vector3D(this._round.x*this._round.w,this._round.y*this._round.w,this._round.z*this._round.w);i=new r.Vector3D(this._posAry[n]+Math.random()*o.x,this._posAry[1+n]+Math.random()*o.y,this._posAry[2+n]+Math.random()*o.z)}else i=new r.Vector3D(this._posAry[n],this._posAry[1+n],this._posAry[2+n]);i=i.add(this._basePositon);for(var a=0;a<4;a++)t.push(i.x,i.y,i.z,e*this._shootSpeed)}this.objBallData.basePos=t},i.prototype.initSpeed=function(){for(var t=new Array,e=0;e<this._totalNum;e++){var i=new r.Vector3D;if(0==this._tangentSpeed)i.addByNum(this._angleAry[3*e],this._angleAry[3*e+1],this._angleAry[3*e+2]);else if(2==this._tangentSpeed)i.setTo(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);else{var n=new r.Vector3D(this._tangentAry[3*e],this._tangentAry[3*e+1],this._tangentAry[3*e+2]);n.scaleBy(this._tangentSpeed),i=i.add(n)}i.normalize(),this._isSendRandom?i.scaleBy(this._speed*Math.random()):i.scaleBy(this._speed);for(var o=0;o<4;o++)t.push(i.x,i.y,i.z)}this.objBallData.beMove=t},i.prototype.setAllByteInfo=function(t){this._tangentSpeed=t.readFloat(),this._posAry=JSON.parse(t.readUTF()),this._angleAry=JSON.parse(t.readUTF()),this._tangentAry=JSON.parse(t.readUTF()),e.prototype.setAllByteInfo.call(this,t),this.uploadGpu()},i);function i(){return null!==e&&e.apply(this,arguments)||this}r.ParticleLocusballData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=e.Display3DParticle,__extends(n,i),Object.defineProperty(n.prototype,"modeldata",{get:function(){return this.data},enumerable:!0,configurable:!0}),n.prototype.creatData=function(){this.data=new e.ParticleModelData},n.prototype.setVc=function(){this.updateWatchCaramMatrix(),this.updateUV(),this.data.vcmatData.set(e.Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(e.Scene_data.cam3D.cameraMatrix.m,16),this.data.vcmatData.set(this.modelMatrix.m,48),this.data.vcmatData.set(this._rotationMatrix.m,32),this.data.vcmatData.set(this._resultUvVec,64),e.Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData),this.setMaterialVc()},n.prototype.setVa=function(){e.Scene_data.context3D.setWriteDepth(1==this.data._depthMode),e.Scene_data.context3D.pushVa(this.data.objData.vertexBuffer)||(e.Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),e.Scene_data.context3D.setVaOffset(1,2,this.data.objData.stride,12)),this.setMaterialTexture(),e.Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum),e.Scene_data.context3D.setWriteDepth(!1)},n.prototype.updateWatchCaramMatrix=function(){this._rotationMatrix.identity(),this.data._watchEye&&(this.timeline.inverAxisRotation(this._rotationMatrix),this._rotationMatrix.prependRotation(-e.Scene_data.cam3D.rotationY,e.Vector3D.Y_AXIS),this._rotationMatrix.prependRotation(-e.Scene_data.cam3D.rotationX,e.Vector3D.X_AXIS)),this.data._isZiZhuan&&this.timeline.applySelfRotation(this._rotationMatrix,this.data._ziZhuanAngly)},n.prototype.updateUV=function(){var t=Math.floor(this._time/e.Scene_data.frameTime/this.data._animInterval);this.data._animLine,this.data._animRow,this._resultUvVec[0]=Math.floor(t%this.data._animLine)/this.data._animLine,this._resultUvVec[1]=Math.floor(t/this.data._animLine)/this.data._animRow,this._resultUvVec[0]+=this._time/e.Scene_data.frameTime*this.data._uSpeed,this._resultUvVec[1]+=this._time/e.Scene_data.frameTime*this.data._vSpeed,this._resultUvVec[0]=this._resultUvVec[0]%1,this._resultUvVec[1]=this._resultUvVec[1]%1},n);function n(){var t=i.call(this)||this;return t._resultUvVec=new Array(2),t}e.Display3DModelPartilce=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Display3DModelPartilce,__extends(n,e),n.prototype.update=function(){this._depthMode&&t.Scene_data.context3D.setDepthTest(!0),e.prototype.update.call(this),this._depthMode&&t.Scene_data.context3D.setDepthTest(!1)},n);function n(){return e.call(this)||this}t.Display3DModelObjParticle=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=e.Display3DModelPartilce,__extends(n,t),n.prototype.updateUV=function(){var t=this._time/e.Scene_data.frameTime;t=(t=t>this.modeldata._maxAnimTime?this.modeldata._maxAnimTime:t)/this.data._animInterval%(this.data._animLine*this.data._animRow),this._resultUvVec[0]=float2int(t%this.data._animLine)/this.data._animLine+this._time/e.Scene_data.frameTime*this.data._uSpeed,this._resultUvVec[1]=float2int(t/this.data._animLine)/this.data._animRow+this._time/e.Scene_data.frameTime*this.data._vSpeed},n);function n(){return t.call(this)||this}e.Display3dModelAnimParticle=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var s,t=(s=r.ParticleData,__extends(e,s),e.prototype.getParticle=function(){return new r.Display3DModelPartilce},e.prototype.setAllByteInfo=function(t){this.objData=new r.ObjData,this._maxAnimTime=t.readFloat();var e=t.getInt(),i=new ArrayBuffer(5*e*4),n=new DataView(i);r.BaseRes.readBytes2ArrayBuffer(t,n,3,0,5,4),r.BaseRes.readBytes2ArrayBuffer(t,n,2,3,5,4);for(var o=t.readInt(),a=0;a<o;a++)this.objData.indexs.push(t.readInt());this.objData.stride=20,36<=this.version&&(this._depthMode=t.readInt()),s.prototype.setAllByteInfo.call(this,t),this.initVcData(),this.objData.vertexBuffer=r.Scene_data.context3D.uploadBuff3DArrayBuffer(i),this.objData.indexBuffer=r.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.treNum=this.objData.indexs.length},e.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*r.Display3DFacetShader.getVcSize())},e.prototype.uploadGpu=function(){this.objData.vertexBuffer=r.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=r.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=r.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.treNum=this.objData.indexs.length},e.prototype.regShader=function(){this.materialParam.shader=r.ProgrmaManager.getInstance().getMaterialProgram(r.Display3DFacetShader.Display3D_Facet_Shader,r.Display3DFacetShader,this.materialParam.material),this.materialParam.program=this.materialParam.shader.program},e.prototype.setFloat32Vec=function(t,e){var i=r.Display3DFacetShader.shader_vec4[t],n=16*i[0]+4*i[1];this.vcmatData.set(e,n)},e.prototype.setFloat32Mat=function(t,e){var i=16*r.Display3DFacetShader.shader_mat4[t];this.vcmatData.set(e,i)},e);function e(){return null!==s&&s.apply(this,arguments)||this}r.ParticleModelData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=n.Display3DBallPartilce,__extends(i,e),Object.defineProperty(i.prototype,"followdata",{get:function(){return this.data},enumerable:!0,configurable:!0}),i.prototype.creatData=function(){this.data=new n.ParticleFollowData},i.prototype.onCreated=function(){this.initBingMatrixAry()},i.prototype.setVc=function(){e.prototype.setVc.call(this),this.updateBind(),n.Scene_data.context3D.setVc3fv(this.data.materialParam.shader,"bindpos",this._bindMatrixAry)},i.prototype.initBingMatrixAry=function(){this._bindMatrixAry=new Float32Array(120),this._bindFlagAry=new Array;for(var t=0;t<this.followdata._totalNum;t++)this._bindFlagAry.push(0)},i.prototype.updateBind=function(){for(var t=this._time/n.Scene_data.frameTime,e=this.flag;e<this.followdata._totalNum;e++)if((t-e*this.followdata._shootSpeed)/this.followdata._life>=this._bindFlagAry[e]){var i=3*e;this._bindMatrixAry[i]=this.bindVecter3d.x,this._bindMatrixAry[1+i]=this.bindVecter3d.y,this._bindMatrixAry[2+i]=this.bindVecter3d.z,this._bindFlagAry[e]++}},i.prototype.updateMatrix=function(){this.bindMatrix&&(this.modelMatrix.identity(),this.groupMatrix.isIdentity||this.posMatrix.append(this.groupMatrix),this.modelMatrix.append(this.posMatrix))},i.prototype.updateAllRotationMatrix=function(){this.followdata._allRotationMatrix.identity(),this.followdata._allRotationMatrix.prependScale(this.followdata.overAllScale*this._scaleX*.1*this.bindScale.x,this.followdata.overAllScale*this._scaleY*.1*this.bindScale.y,this.followdata.overAllScale*this._scaleZ*.1*this.bindScale.z),this.isInGroup&&(this.followdata._allRotationMatrix.appendRotation(this.groupRotation.x,n.Vector3D.X_AXIS),this.followdata._allRotationMatrix.appendRotation(this.groupRotation.y,n.Vector3D.Y_AXIS),this.followdata._allRotationMatrix.appendRotation(this.groupRotation.z,n.Vector3D.Z_AXIS))},i.prototype.reset=function(){e.prototype.reset.call(this);for(var t=0;t<this.followdata._totalNum;t++)this._bindMatrixAry[3*t]=0,this._bindMatrixAry[3*t+1]=0,this._bindMatrixAry[3*t+2]=0,this._bindFlagAry[t]=0},i.prototype.updateWatchCaramMatrix=function(){this._rotationMatrix.identity(),this.followdata.facez?this._rotationMatrix.prependRotation(90,n.Vector3D.X_AXIS):this.followdata._watchEye&&(this._rotationMatrix.prependRotation(-n.Scene_data.cam3D.rotationY,n.Vector3D.Y_AXIS),this._rotationMatrix.prependRotation(-n.Scene_data.cam3D.rotationX,n.Vector3D.X_AXIS))},i);function i(){var t=e.call(this)||this;return t.flag=0,t}n.Display3DFollowPartilce=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(v){var t,e=(t=v.Shader3D,__extends(i,t),i.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"vPosition"),t.bindAttribLocation(this.program,1,"texcoord"),t.bindAttribLocation(this.program,2,"basePos"),t.bindAttribLocation(this.program,3,"speed"),this.paramAry[3]&&t.bindAttribLocation(this.program,4,"rotation"),this.paramAry[1]&&t.bindAttribLocation(this.program,5,"color")},i.prototype.getMat4Str=function(t){return"vcmat["+v.Display3DBallShader.shader_mat4[t]+"]"},i.prototype.getVec4Str=function(t){return"vcmat["+v.Display3DBallShader.shader_vec4[t][0]+"]["+v.Display3DBallShader.shader_vec4[t][1]+"]"},i.getVcSize=function(){return 7},i.prototype.getVertexShaderString=function(){var t,e,i,n,o,a,r,s,u,h;h="attribute vec4 vPosition;\nattribute vec3 texcoord;\nattribute vec4 basePos;\nattribute vec3 speed;\nuniform mat4 vcmat["+v.Display3DBallShader.getVcSize()+"];\nuniform vec3 bindpos[30];\nvarying vec2 v0;\n",t="float ctime = "+this.getVec4Str("time")+".x - basePos.w;\nif ("+this.getVec4Str("time")+".w > 0.0 && ctime >= 0.0) {\n    ctime = fract(ctime / "+this.getVec4Str("time")+".z) * "+this.getVec4Str("time")+".z;\n}\nvec4 pos = vPosition;\n",e="float stime = ctime - "+this.getVec4Str("scale")+".w;\nstime = max(stime,0.0);\nfloat sf = "+this.getVec4Str("scale")+".x * stime;\nif ("+this.getVec4Str("scale")+".y != 0.0 && "+this.getVec4Str("scale")+".z != 0.0) {\n    sf += sin("+this.getVec4Str("scale")+".y * stime) * "+this.getVec4Str("scale")+".z;\n}\nif (sf > "+this.getVec4Str("scaleCtrl")+".z) {\n    sf = "+this.getVec4Str("scaleCtrl")+".z;\n} else if (sf < "+this.getVec4Str("scaleCtrl")+".w) {\n    sf = "+this.getVec4Str("scaleCtrl")+".w;\n}\nvec2 sv2 = vec2("+this.getVec4Str("scaleCtrl")+".x * sf, "+this.getVec4Str("scaleCtrl")+".y * sf);\nsv2 = sv2 + 1.0;\npos.x *= sv2.x;\npos.y *= sv2.y;\n",i="vec3 addPos = speed * ctime;\nvec3 uspeed = vec3(0,0,0);\nif (ctime < 0.0 || ctime >= "+this.getVec4Str("time")+".z) {\n    addPos.y = addPos.y + 100000.0;\n}\n",n="if("+this.getVec4Str("time")+".y != 0.0 && length(speed) != 0.0) {\n    uspeed = vec3(speed.x, speed.y, speed.z);\n    uspeed = normalize(uspeed);\n    uspeed = uspeed * "+this.getVec4Str("time")+".y;\n    uspeed.xyz = uspeed.xyz + "+this.getVec4Str("force")+".xyz;\n} else {\n    uspeed = vec3("+this.getVec4Str("force")+".x, "+this.getVec4Str("force")+".y, "+this.getVec4Str("force")+".z);\n}\naddPos.xyz = addPos.xyz + uspeed.xyz * ctime * ctime;\n",o="uspeed = speed + uspeed * ctime * 2.0;\nuspeed = normalize(uspeed);\nvec4 tempMul = "+this.getMat4Str("rotationMatrix")+" * vec4(uspeed,1.0);\nuspeed.xyz = tempMul.xyz;\nuspeed = normalize(uspeed);\nvec3 cPos = addPos;\ntempMul = "+this.getMat4Str("rotationMatrix")+" * vec4(cPos,1.0);\ncPos.xyz = tempMul.xyz; \ncPos.xyz = "+this.getVec4Str("worldPos")+".xyz + cPos.xyz;\ncPos.xyz = "+this.getVec4Str("camPos")+".xyz - cPos.xyz;\ncPos = normalize(cPos);\ncPos = cross(uspeed, cPos);\ncPos = normalize(cPos);\nuspeed = uspeed * pos.x;\ncPos = cPos * pos.y;\npos.xyz = uspeed.xyz + cPos.xyz;\n",a="pos = "+this.getMat4Str("watheye")+" * pos;\npos.xyz = pos.xyz + basePos.xyz + addPos.xyz;\npos = "+this.getMat4Str("modelMatrix")+" * pos;\npos.xyz = pos.xyz + bindpos[int(texcoord.z)].xyz;\ngl_Position = "+this.getMat4Str("viewMatrix3D")+" * "+this.getMat4Str("camMatrix3D")+" * pos;\n",r="vec2 uv = vec2(texcoord.x,texcoord.y);\nfloat animframe = floor(ctime / "+this.getVec4Str("animCtrl")+".z);\nanimframe = animframe / "+this.getVec4Str("animCtrl")+".x;\nuv.x += animframe;\nanimframe = floor(animframe);\nuv.y += animframe / "+this.getVec4Str("animCtrl")+".y;\nv0.xy = uv.xy;\n",s="vec2 uv = vec2("+this.getVec4Str("uvCtrl")+".x,"+this.getVec4Str("uvCtrl")+".y);\nuv.xy = uv.xy * ctime + texcoord.xy;\nv0.xy = uv.xy;\n",u="v1 = vec2(ctime/"+this.getVec4Str("time")+".z,1.0);\n";var l=this.paramAry[0],c=this.paramAry[1],p=this.paramAry[2],d=this.paramAry[3],_=this.paramAry[4],f=this.paramAry[5],g=this.paramAry[6],y="",m="";return y+=t,m+=h,_&&(y+=e,m+=""),d&&(y+="float angle = rotation.x + rotation.y * ctime;\nvec4 np = vec4(sin(angle), cos(angle), 0, 0);\nnp.z = np.x * pos.y + np.y * pos.x;\nnp.w = np.y * pos.y - np.x * pos.x;\npos.xy = np.zw;\n",m+="attribute vec2 rotation;\n"),y+=i,f&&(y+=n,m+=""),p&&(y+=o,m+=""),y+=a,1==g?(y+=r,m+=""):2==g?(y+=s,m+=""):y+="v0 = vec2(texcoord.x,texcoord.y);\n",c&&(y+="v2 = color;\n",m+="attribute vec4 color;\nvarying vec4 v2;\n"),l&&(y+=u,m+="varying vec2 v1;\n"),m+"void main(){\n"+y+"}"},i.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}"},i.Display3D_Follow_Shader="Display3DFollowShader",i.shader_mat4={viewMatrix3D:0,camMatrix3D:1,modelMatrix:2,watheye:3,rotationMatrix:4},i.shader_vec4={time:[5,0],scale:[5,1],scaleCtrl:[5,2],force:[5,3],worldPos:[6,0],camPos:[6,1],animCtrl:[6,2],uvCtrl:[6,3]},i);function i(){return t.call(this)||this}v.Display3DFollowShader=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=e.ParticleBallData,__extends(n,i),n.prototype.getParticle=function(){return new e.Display3DFollowPartilce},n.prototype.setAllByteInfo=function(t){i.prototype.setAllByteInfo.call(this,t),this.uploadGpu()},n.prototype.regShader=function(){if(this.materialParam){var t=this.getShaderParam();this.materialParam.shader=e.ProgrmaManager.getInstance().getMaterialProgram(e.Display3DFollowShader.Display3D_Follow_Shader,e.Display3DFollowShader,this.materialParam.material,t),this.materialParam.program=this.materialParam.shader.program}},n);function n(){return null!==i&&i.apply(this,arguments)||this}e.ParticleFollowData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=r.Display3DParticle,__extends(s,e),Object.defineProperty(s.prototype,"followlocusdata",{get:function(){return this.data},enumerable:!0,configurable:!0}),s.prototype.creatData=function(){this.data=new r.ParticleFollowLocusData},s.prototype.onCreated=function(){this.initBindMatrixAry()},s.prototype.initBindMatrixAry=function(){this._bindPosAry=new Array,this._gpuVc=new Float32Array(6*this.followlocusdata._fenduanshu);for(var t=0;t<=this.followlocusdata._fenduanshu;t++)this._bindPosAry.push([0,0,5*t]),this._bindPosAry.push([0,0,1])},s.prototype.setVa=function(){r.Scene_data.context3D.pushVa(this.data.objData.vertexBuffer)||(r.Scene_data.context3D.setVaOffset(0,3,this.data.objData.stride,0),r.Scene_data.context3D.setVaOffset(1,2,this.data.objData.stride,12)),this.setMaterialTexture(),r.Scene_data.context3D.drawCall(this.data.objData.indexBuffer,this.data.objData.treNum)},s.prototype.setVc=function(){this.updateMatrix(),this.updateBind(),this.data.vcmatData.set(r.Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(r.Scene_data.cam3D.cameraMatrix.m,16),this._caramPosVec[0]=r.Scene_data.cam3D.x,this._caramPosVec[1]=r.Scene_data.cam3D.y,this._caramPosVec[2]=r.Scene_data.cam3D.z,this.data.vcmatData.set(this._caramPosVec,32),r.Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData),this.setBindPosVc(),this.setMaterialVc()},s.prototype.setBindPosVc=function(){for(var t=0;t<this._bindPosAry.length;t++)r.Scene_data.context3D.setVc3fv(this.data.materialParam.shader,"bindpos["+t+"]",this._bindPosAry[t])},s.prototype.reset=function(){this.resetPos(),e.prototype.reset.call(this)},s.prototype.updateMatrix=function(){this.modelMatrix.identity(),this.modelMatrix.prepend(this.posMatrix)},s.prototype.resetPos=function(){for(var t=0;t<this._bindPosAry.length;t+=2)this._bindPosAry[t][0]=this.bindVecter3d.x,this._bindPosAry[t][1]=this.bindVecter3d.y,this._bindPosAry[t][2]=this.bindVecter3d.z;this.flag=r.TimeUtil.getTimer()},s.prototype.updateBind=function(){var t=r.TimeUtil.getTimer();if(t-this.flag>=s.waitCdTime){var e=this._bindPosAry.pop(),i=this._bindPosAry.pop();i[0]=this.bindVecter3d.x,i[1]=this.bindVecter3d.y,i[2]=this.bindVecter3d.z;var n=this._bindPosAry[0],o=this._bindPosAry[1],a=new r.Vector3D(i[0]-n[0],i[1]-n[1],i[2]-n[2]);a.normalize(),o[0]=a.x,e[0]=a.x,o[1]=a.y,e[1]=a.y,o[2]=a.z,e[2]=a.z,this._bindPosAry.unshift(e),this._bindPosAry.unshift(i),this.flag=t}},s.waitCdTime=35,s);function s(){var t=e.call(this)||this;return t.flag=0,t._caramPosVec=[0,0,0],t}r.Display3DFollowLocusPartilce=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"v2TexCoord")},n.prototype.getMat4Str=function(t){return"vcmat["+n.shader_mat4[t]+"]"},n.prototype.getVec4Str=function(t){return"vcmat["+n.shader_vec4[t][0]+"]["+n.shader_vec4[t][1]+"]"},n.getVcSize=function(){return 3},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Position;\nattribute vec2 v2TexCoord;\nuniform mat4 vcmat["+t.Display3DFacetShader.getVcSize()+"];\nuniform vec3 bindpos[30];\nvarying vec2 v0;\nvoid main(){\n   vec3 cpos = bindpos[int(v3Position.x)];\n   vec3 mulPos = normalize(vec3("+this.getVec4Str("camPos")+".xyz) - cpos);\n   vec3 normals = bindpos[int(v3Position.y)];\n   mulPos = cross(mulPos, normals);\n   mulPos = normalize(mulPos);\n   mulPos *= v3Position.z;\n   cpos += mulPos;\n   gl_Position = "+this.getMat4Str("viewMatrix3D")+"  * "+this.getMat4Str("camMatrix3D")+" * vec4(cpos,1.0);\nv0 = v2TexCoord;\n}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D tex;\nvarying vec2 v0;\nvoid main(void)\n{\nvec4 infoUv = texture2D(tex, v0.xy);\ngl_FragColor = infoUv;\n}"},n.Display3D_FollowLocus_Shader="Display3DFollowLocusShader",n.shader_mat4={viewMatrix3D:0,camMatrix3D:1},n.shader_vec4={camPos:[2,0]},n);function n(){return e.call(this)||this}t.Display3DFollowLocusShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=o.ParticleData,__extends(i,e),i.prototype.getParticle=function(){return new o.Display3DFollowLocusPartilce},i.prototype.setAllByteInfo=function(t){this._fenduanshu=t.readFloat(),e.prototype.setAllByteInfo.call(this,t),this.uploadGpu(),this.initVcData()},i.prototype.uploadGpu=function(){this.objData=new o.ObjData,this.objData.vertices=new Array,this.objData.uvs=new Array,this.objData.indexs=new Array;for(var t=0;t<=this._fenduanshu;t++){var e=new o.Vector2D(t/this._fenduanshu,0),i=new o.Vector2D(t/this._fenduanshu,1);e.scaleBy(.9),i.scaleBy(.9),this._isU&&(e.x=-e.x,i.x=-i.x),this._isV&&(e.y=-e.y,i.y=-i.y);var n=2*t;this.objData.vertices.push(n,1+n,-this._originWidthScale*this._width/100),this._isUV?this.objData.vertices.push(e.y,e.x):this.objData.vertices.push(e.x,e.y),this.objData.vertices.push(n,1+n,(1-this._originWidthScale)*this._width/100),this._isUV?this.objData.vertices.push(i.y,i.x):this.objData.vertices.push(i.x,i.y)}for(t=0;t<this._fenduanshu;t++)this.objData.indexs.push(0+2*t,1+2*t,2+2*t,1+2*t,3+2*t,2+2*t);this.pushToGpu()},i.prototype.pushToGpu=function(){this.objData.vertexBuffer=o.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.indexBuffer=o.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs),this.objData.stride=20,this.objData.treNum=this.objData.indexs.length},i.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*o.Display3DFollowLocusShader.getVcSize())},i.prototype.regShader=function(){this.materialParam&&(new o.Display3DFollowLocusShader,this.materialParam.shader=o.ProgrmaManager.getInstance().getMaterialProgram(o.Display3DFollowLocusShader.Display3D_FollowLocus_Shader,o.Display3DFollowLocusShader,this.materialParam.material),this.materialParam.program=this.materialParam.shader.program)},i);function i(){return null!==e&&e.apply(this,arguments)||this}o.ParticleFollowLocusData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=n.Shader3D,__extends(i,t),i.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"pos"),t.bindAttribLocation(this.program,1,"v2uv"),t.bindAttribLocation(this.program,2,"boneWeight"),t.bindAttribLocation(this.program,3,"boneID")},i.prototype.getMat4Str=function(t){return"vcmat["+i.shader_mat4[t]+"]"},i.getVcSize=function(){return 3},i.prototype.getVertexShaderString=function(){return"attribute vec3 pos;attribute vec2 v2uv;attribute vec4 boneWeight;attribute vec4 boneID;uniform vec4 boneQ[54];\nuniform vec3 boneD[54];\nuniform mat4 vcmat["+i.getVcSize()+"];\nvarying vec2 v0;\n"+n.MaterialAnimShader.getMd5M44Str()+"void main(void){v0 = v2uv;\nvec4 vt0 = getQDdata(vec3(pos.x,pos.y,pos.z));\n gl_Position = "+this.getMat4Str("viewMatrix3D")+" * "+this.getMat4Str("camMatrix3D")+" *"+this.getMat4Str("posMatrix3D")+"* vt0;}"},i.prototype.getFragmentShaderString=function(){return"precision mediump float;\nvarying vec2 v0;\nvoid main(void)\n{\ngl_FragColor = vec4(1.0,0.0,1.0,1.0);\n}"},i.Display3DBoneShader="Display3DBoneShader",i.shader_mat4={viewMatrix3D:0,camMatrix3D:1,posMatrix3D:2},i);function i(){return t.call(this)||this}n.Display3DBoneShader=e;var o,a=(o=n.Display3DParticle,__extends(r,o),Object.defineProperty(r.prototype,"modeldata",{get:function(){return this.data},enumerable:!0,configurable:!0}),r.prototype.creatData=function(){this.data=new n.ParticleBoneData},r.prototype.update=function(){n.Scene_data.context3D.setWriteDepth(!1),o.prototype.update.call(this)},r.prototype.setVc=function(){var t=float2int(this._time/n.Scene_data.frameTime/2);this.data.vcmatData.set(n.Scene_data.viewMatrx3D.m,0),this.data.vcmatData.set(n.Scene_data.cam3D.cameraMatrix.m,16),this.data.vcmatData.set(this.modelMatrix.m,32),n.Scene_data.context3D.setVcMatrix4fv(this.data.materialParam.shader,"vcmat",this.data.vcmatData);var e=this.modeldata.animData.boneQPAry[0],i=e[t%e.length];n.Scene_data.context3D.setVc4fv(this.data.materialParam.shader,"boneQ",i.quat),n.Scene_data.context3D.setVc3fv(this.data.materialParam.shader,"boneD",i.pos),this.setMaterialVc()},r.prototype.setVa=function(){n.Scene_data.context3D.pushVa(this.modeldata.meshData.vertexBuffer)||(n.Scene_data.context3D.setVaOffset(0,3,this.modeldata.meshData.stride,0),n.Scene_data.context3D.setVaOffset(1,2,this.modeldata.meshData.stride,12),n.Scene_data.context3D.setVaOffset(3,4,this.modeldata.meshData.stride,20),n.Scene_data.context3D.setVaOffset(2,4,this.modeldata.meshData.stride,36)),this.setMaterialTexture(),n.Scene_data.context3D.drawCall(this.modeldata.meshData.indexBuffer,this.modeldata.meshData.treNum)},r.prototype.resetVa=function(){o.prototype.resetVa.call(this)},r);function r(){var t=o.call(this)||this;return t.skipNum=0,t}n.Display3DBonePartilce=a}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var o,t=(o=h.ParticleData,__extends(e,o),e.prototype.getParticle=function(){return new h.Display3DBonePartilce},e.prototype.destory=function(){o.prototype.destory.call(this),this.meshData.destory(),this.animData=null},e.prototype.setAllByteInfo=function(t){this.meshData=new h.MeshData,this.animData=new h.AnimData,this.objScale=t.readFloat();var e=t.getInt();e*=52;var i=new ArrayBuffer(e),n=new DataView(i);h.BaseRes.readBytes2ArrayBuffer(t,n,3,0,13),h.BaseRes.readBytes2ArrayBuffer(t,n,2,3,13),h.BaseRes.readIntForTwoByte(t,this.meshData.indexs),h.BaseRes.readBytes2ArrayBuffer(t,n,4,5,13,2),h.BaseRes.readBytes2ArrayBuffer(t,n,4,9,13,3),this.meshData.stride=52,this.readFrameQua(t),o.prototype.setAllByteInfo.call(this,t),this.initVcData(),this.meshData.vertexBuffer=h.Scene_data.context3D.uploadBuff3DArrayBuffer(i),this.meshData.indexBuffer=h.Scene_data.context3D.uploadIndexBuff3D(this.meshData.indexs),this.meshData.treNum=this.meshData.indexs.length},e.prototype.initVcData=function(){this.vcmatData=new Float32Array(16*h.Display3DBoneShader.getVcSize())},e.prototype.setFloat32Mat=function(t,e){var i=16*h.Display3DBoneShader.shader_mat4[t];this.vcmatData.set(e,i)},e.prototype.readFrameQua=function(t){for(var e=t.readFloat(),i=32767,n=t.readInt(),o=new Array,a=0;a<n;a++){var r=t.readInt(),s=new h.DualQuatFloat32Array;s.quat=new Float32Array(4*r),s.pos=new Float32Array(3*r);for(var u=0;u<r;u++)s.quat[4*u+0]=t.readShort()/i,s.quat[4*u+1]=t.readShort()/i,s.quat[4*u+2]=t.readShort()/i,s.quat[4*u+3]=t.readShort()/i,s.pos[3*u+0]=t.readShort()/i*e,s.pos[3*u+1]=t.readShort()/i*e,s.pos[3*u+2]=t.readShort()/i*e;o.push(s)}this.animData.boneQPAry=new Array,this.animData.boneQPAry.push(o)},e.prototype.uploadGpu=function(){this.uploadMesh(this.meshData)},e.prototype.uploadMesh=function(t){t.vertexBuffer=h.Scene_data.context3D.uploadBuff3D(t.vertices),t.uvBuffer=h.Scene_data.context3D.uploadBuff3D(t.uvs),t.boneIdBuffer=h.Scene_data.context3D.uploadBuff3D(t.boneIDAry),t.boneWeightBuffer=h.Scene_data.context3D.uploadBuff3D(t.boneWeightAry),t.indexBuffer=h.Scene_data.context3D.uploadIndexBuff3D(t.indexs),t.treNum=t.indexs.length},e.prototype.regShader=function(){this.materialParam.shader=h.ProgrmaManager.getInstance().getMaterialProgram(h.Display3DBoneShader.Display3DBoneShader,h.Display3DBoneShader,this.materialParam.material),this.materialParam.program=this.materialParam.shader.program},e);function e(){var t=null!==o&&o.apply(this,arguments)||this;return t.objScale=1,t}h.ParticleBoneData=t}(tl3d=tl3d||{}),(tl3d||(tl3d={})).KeyFrame=function(){},function(u){var t=(e.prototype.destory=function(){this.dataAry=null},e.prototype.setByteData=function(t){for(var e=t.readFloat(),i=0;i<e;i++){var n=t.readFloat(),o=this.addKeyFrame(n);o.frameNum=n,o.baseValue=new Array;for(var a=0;a<10;a++)o.baseValue.push(t.readFloat());var r=t.readFloat();if(o.animData=new Array,0<r)for(var s=0;s<r;s++)o.animData.push(this.getByteDataTemp(t))}this.maxFrameNum=this.dataAry[this.dataAry.length-1].frameNum,this.beginTime=this.dataAry[0].frameNum*u.Scene_data.frameTime},e.prototype.addKeyFrame=function(t){var e=new Object;return e.frameNum=t,this.dataAry.push(e),e},e.prototype.getByteDataTemp=function(t){var e=new Object,i=t.readInt(),n=t.readInt();e.data=new Array,e.dataByte=new Array;for(var o=0;o<n;o++){var a=new Object;if(a.type=t.readInt(),1==a.type){var r=t.readFloat();e.dataByte.push(r)}if(2==a.type){var s=new u.Vector3D;s.x=t.readFloat(),s.y=t.readFloat(),s.z=t.readFloat(),e.dataByte.push(s)}}return e.type=i,e},e);function e(){this.dataAry=new Array}u.TimeLineData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var e,t=(e=h.EventDispatcher,__extends(i,e),i.prototype.updateMatrix=function(t,e){this._axisMove&&t.prependTranslation(this._axisMove.axis.x*this._axisMove.num,this._axisMove.axis.y*this._axisMove.num,this._axisMove.axis.z*this._axisMove.num),this._axisRotaion&&t.prependRotation(this._axisRotaion.num,this._axisRotaion.axis),t.prependTranslation(e.data.center.x,e.data.center.y,e.data.center.z),this._scaleChange?t.prependScale(e.data._widthFixed?1:this._scaleChange.num,e.data._heightFixed?1:this._scaleChange.num,e.data._widthFixed?1:this._scaleChange.num):this._scaleNosie?t.prependScale(e.data._widthFixed?1:1+this._scaleNosie.num,e.data._heightFixed?1:1+this._scaleNosie.num,e.data._widthFixed?1:1+this._scaleNosie.num):this._scaleAnim&&t.prependScale(e.data._widthFixed?1:this._scaleAnim.num,e.data._heightFixed?1:this._scaleAnim.num,e.data._widthFixed?1:this._scaleAnim.num),t.prependRotation(e.data.rotationV3d.z,h.Vector3D.Z_AXIS),t.prependRotation(e.data.rotationV3d.y,h.Vector3D.Y_AXIS),t.prependRotation(e.data.rotationV3d.x,h.Vector3D.X_AXIS)},i.prototype.inverAxisRotation=function(t){this._axisRotaion&&t.prependRotation(-this._axisRotaion.num,this._axisRotaion.axis)},i.prototype.applySelfRotation=function(t,e){this._selfRotaion&&t.prependRotation(this._selfRotaion.num,e)},i.prototype.addKeyFrame=function(t){var e=new h.KeyFrame;return e.frameNum=t,this._keyFrameAry.push(e),e},i.prototype.updateTime=function(t){this._currentKeyFrame&&(this._time=t,this.getTarget(),this._axisRotaion&&this._axisRotaion.update(this._time),this._selfRotaion&&this._selfRotaion.update(this._time),this._axisMove&&this._axisMove.update(this._time),this._scaleChange?this._scaleChange.update(this._time):this._scaleNosie?this._scaleNosie.update(this._time):this._scaleAnim&&this._scaleAnim.update(this._time))},i.prototype.getTarget=function(){for(var t=-1,e=0;e<this._keyFrameAry.length&&this._keyFrameAry[e].frameNum*h.Scene_data.frameTime<this._time;e++)t=e;t!=this.targetFlag&&(this._currentKeyFrame=this._keyFrameAry[t],(this.targetFlag=t)>=this._keyFrameAry.length-1||!this._currentKeyFrame?(this.visible=!1,this._currentKeyFrame=null):(this.visible=!0,this.enterKeyFrame(this._currentKeyFrame.animData,this._currentKeyFrame.frameNum*h.Scene_data.frameTime,this._currentKeyFrame.baseValue)))},i.prototype.enterKeyFrame=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=null),null!=i){for(var n=0;n<10;n++)if(i[n])switch(n){case 1:this._selfRotaion||(this._selfRotaion=new h.SelfRotation),this._selfRotaion.num=this._selfRotaion.baseNum=i[n];break;case 2:this._axisRotaion||(this._axisRotaion=new h.AxisRotaion),this._axisRotaion.num=this._axisRotaion.baseNum=i[n];break;case 6:this._scaleChange||(this._scaleChange=new h.ScaleChange),this._scaleChange.num=this._scaleChange.baseNum=i[n];break;case 7:this._scaleAnim||(this._scaleAnim=new h.ScaleAnim),this._scaleAnim.num=this._scaleAnim.baseNum=i[n];break;case 8:this._scaleNosie||(this._scaleNosie=new h.ScaleNoise),this._scaleNosie.num=this._scaleNosie.baseNum=i[n];break;case 9:this._axisMove||(this._axisMove=new h.AxisMove),this._axisMove.num=this._axisMove.baseNum=i[n]}this._selfRotaion&&(this._selfRotaion.isDeath=!0),this._axisRotaion&&(this._axisRotaion.isDeath=!0),this._scaleChange&&(this._scaleChange.isDeath=!0),this._scaleAnim&&(this._scaleAnim.isDeath=!0),this._scaleNosie&&(this._scaleNosie.isDeath=!0),this._axisMove&&(this._axisMove.isDeath=!0),t&&this.setBaseTimeByte(t,e,i)}},i.prototype.reset=function(){this._time=0,this._currentKeyFrame=this._keyFrameAry[0],this.visible=!1,this.targetFlag=-1},i.prototype.setAllByteInfo=function(t,e){this.isByteData=!0;for(var i=t.readFloat(),n=0;n<i;n++){var o=t.readFloat(),a=this.addKeyFrame(o);a.frameNum=o,a.baseValue=new Array;for(var r=0;r<10;r++)a.baseValue.push(t.readFloat());var s=t.readFloat();if(a.animData=new Array,0<s)for(var u=0;u<s;u++)a.animData.push(this.getByteDataTemp(t))}this.maxFrameNum=this._keyFrameAry[this._keyFrameAry.length-1].frameNum,this.beginTime=this._keyFrameAry[0].frameNum*h.Scene_data.frameTime,this._currentKeyFrame=this._keyFrameAry[0]},i.prototype.setAllDataInfo=function(t){this.isByteData=!0;for(var e=t.dataAry.length,i=0;i<e;i++){var n=this.addKeyFrame(t.dataAry[i].frameNum);n.baseValue=t.dataAry[i].baseValue,n.animData=t.dataAry[i].animData}this.maxFrameNum=t.maxFrameNum,this.beginTime=t.beginTime,this._currentKeyFrame=this._keyFrameAry[0]},i.prototype.setBaseTimeByte=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=null);for(var n=0;n<t.length;n++)1==t[n].type?(this._selfRotaion?this._selfRotaion.reset():this._selfRotaion=new h.SelfRotation,this._selfRotaion.dataByte(t[n].data,t[n].dataByte),this._selfRotaion.baseTime=e):2==t[n].type?(this._axisRotaion?this._axisRotaion.reset():this._axisRotaion=new h.AxisRotaion,this._axisRotaion.dataByte(t[n].data,t[n].dataByte),this._axisRotaion.baseTime=e):6==t[n].type?(this._scaleChange?this._scaleChange.reset():this._scaleChange=new h.ScaleChange,this._scaleChange.dataByte(t[n].data,t[n].dataByte),this._scaleChange.baseTime=e):7==t[n].type?(this._scaleAnim?this._scaleAnim.reset():this._scaleAnim=new h.ScaleAnim,this._scaleAnim.dataByte(t[n].data,t[n].dataByte),this._scaleAnim.baseTime=e):8==t[n].type?(this._scaleNosie?this._scaleNosie.reset():this._scaleNosie=new h.ScaleNoise,this._scaleNosie.dataByte(t[n].data,t[n].dataByte),this._scaleNosie.baseTime=e):9==t[n].type&&(this._axisMove?this._axisMove.reset():this._axisMove=new h.AxisMove,this._axisMove.dataByte(t[n].data,t[n].dataByte),this._axisMove.baseTime=e)},i.prototype.getByteDataTemp=function(t){var e=new Object,i=t.readInt(),n=t.readInt();e.data=new Array,e.dataByte=new Array;for(var o=0;o<n;o++){var a=new Object;if(a.type=t.readInt(),1==a.type){var r=t.readFloat();e.dataByte.push(r)}if(2==a.type){var s=new h.Vector3D;s.x=t.readFloat(),s.y=t.readFloat(),s.z=t.readFloat(),e.dataByte.push(s)}}return e.type=i,e},i.prototype.getMaxFrame=function(){return this._keyFrameAry[this._keyFrameAry.length-1].frameNum},i.prototype.dispose=function(){},i);function i(){var t=e.call(this)||this;return t._time=0,t.targetFlag=-1,t.beginTime=0,t.isByteData=!1,t.targetFlag=-1,t.visible=!1,t.maxFrameNum=0,t._time=0,t._keyFrameAry=new Array,t}h.TimeLine=t}(tl3d=tl3d||{}),function(t){var e=(i.prototype.BaseAnim=function(){},i.prototype.update=function(t){this._isDeath||(this.time=t-this.baseTime,this._isActiva?(this.time=this.time-this.beginTime,this.time>this.lastTime&&(this.time=this.lastTime-this.beginTime,this._isDeath=!0),this.coreCalculate()):this.time>=this.beginTime&&(this.time>=this.lastTime?(this.time=this.lastTime-this.beginTime,this.coreCalculate(),this._isDeath=!0):(this.time=this.time-this.beginTime,this.coreCalculate()),this._isActiva=!0))},i.prototype.coreCalculate=function(){this.num=this.speed*this.time+this.aSpeed*this.time*this.time+this.baseNum},i.prototype.reset=function(){this._isActiva=!1,this._isDeath=!1,this.time=0,this.num=0},i.prototype.depthReset=function(){this._isActiva=!1,this._isDeath=!1,this.time=0,this.baseNum=0,this.num=0},Object.defineProperty(i.prototype,"data",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isDeath",{get:function(){return this._isDeath},set:function(t){this._isDeath=t},enumerable:!0,configurable:!0}),i.prototype.getAllNum=function(t){t=Math.min(t,this.lastTime),t-=this.beginTime;var e=this.speed*t+this.aSpeed*t*t;this.baseNum+=e},i);function i(){this.baseNum=0,this.num=0,this.time=0,this.speed=0,this.aSpeed=0,this.beginTime=0,this.lastTime=0,this.baseTime=0}t.BaseAnim=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=i.BaseAnim,__extends(n,t),Object.defineProperty(n.prototype,"data",{set:function(t){this.beginTime=Number(t[0].value),-1==Number(t[1].value)?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=Number(t[1].value);var e=t[2].value.split("|");this.axis=new i.Vector3D(Number(e[0]),Number(e[1]),Number(e[2])),this.axis.normalize(),this.speed=.1*Number(t[3].value),this.aSpeed=.001*Number(t[4].value)},enumerable:!0,configurable:!0}),n.prototype.dataByte=function(t,e){this.beginTime=e[0],-1==e[1]?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=e[1],this.axis=e[2],this.axis.normalize(),this.speed=.1*e[3],this.aSpeed=.001*e[4]},n);function n(){return null!==t&&t.apply(this,arguments)||this}i.AxisMove=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=i.BaseAnim,__extends(n,t),Object.defineProperty(n.prototype,"data",{set:function(t){this.beginTime=Number(t[0].value),-1==Number(t[1].value)?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=Number(t[1].value);var e=String(t[2].value).split("|");this.axis=new i.Vector3D(Number(e[0]),Number(e[1]),Number(e[2])),e=String(t[3].value).split("|"),this.axisPos=new i.Vector3D(100*Number(e[0]),100*Number(e[1]),100*Number(e[2])),this.speed=.1*Number(t[4].value),this.aSpeed=.1*Number(t[5].value)},enumerable:!0,configurable:!0}),n.prototype.dataByte=function(t,e){this.beginTime=Number(e[0]),-1==Number(e[1])?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=Number(e[1]),this.axis=e[2],this.axisPos=e[3],this.speed=.1*e[4],this.aSpeed=.1*e[5]},n);function n(){return null!==t&&t.apply(this,arguments)||this}i.AxisRotaion=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(c){var e,t=(e=c.BaseAnim,__extends(i,e),i.prototype.update=function(t){this._isDeath||(this.time=t-this.baseTime,this._isActiva?(this.coreCalculate(),this.time>this.lastTime&&(this._isDeath=!0)):this.time>=this.beginTime&&(this._isActiva=!0))},i.prototype.coreCalculate=function(){var t=float2int(this.time/c.Scene_data.frameTime);t>=this.numAry.length?this.num=this.numAry[this.numAry.length-1]:this.num=this.numAry[t]},i.prototype.reset=function(){e.prototype.reset.call(this),this.num=1},i.prototype.depthReset=function(){e.prototype.depthReset.call(this),this.num=1},Object.defineProperty(i.prototype,"data",{set:function(t){this.numAry=new Array,this.beginTime=Number(t[0].value),-1==Number(t[1].value)?this.lastTime=c.Scene_data.MAX_NUMBER:this.lastTime=Number(t[1].value),this.beginScale=Number(t[2].value),this.scaleNum=Number(t[3].value),this.scaleAry=new Array;for(var e,i=0,n=4;n<4+2*this.scaleNum;n+=2){var o=new Object;o.value=Number(t[n].value),o.time=Number(t[n+1].value),i+=o.time,o.beginTime=this.beginTime+i,this.scaleAry.push(o)}var a=0,r=1;this.scaleAry.length?(e=(this.scaleAry[this.scaleAry.length-1].beginTime+this.scaleAry[this.scaleAry.length-1].time)/c.Scene_data.frameTime,r=this.scaleAry[0].beginTime,this._currentTarget=this.scaleAry[0]):e=0;var s=0;for(n=0;n<e;n++){var u=c.Scene_data.frameTime*n;u>=this._currentTarget.beginTime&&(this.beginScale=this._currentTarget.value,a=this._currentTarget.beginTime,s==this.scaleAry.length-1?this._currentTarget=this.scaleAry[this.scaleAry.length-1]:(s++,this._currentTarget=this.scaleAry[s]),r=this._currentTarget.time);var h=(u-a)/r*(this._currentTarget.value-this.beginScale)+this.beginScale;this.numAry.push(h)}this._currentTarget=this.scaleAry[0]},enumerable:!0,configurable:!0}),i.prototype.dataByte=function(t,e){this.numAry=new Array,this.beginTime=e[0],-1==e[1]?this.lastTime=c.Scene_data.MAX_NUMBER:this.lastTime=e[1],this.beginScale=e[2],this.scaleNum=e[3],this.scaleAry=new Array;for(var i,n=0,o=4;o<4+2*this.scaleNum;o+=2){var a=new Object;a.value=e[o],a.time=e[o+1],n+=a.time,a.beginTime=this.beginTime+n,this.scaleAry.push(a)}var r=0,s=1;this.scaleAry.length?(i=(this.scaleAry[this.scaleAry.length-1].beginTime+this.scaleAry[this.scaleAry.length-1].time)/c.Scene_data.frameTime,s=this.scaleAry[0].beginTime,this._currentTarget=this.scaleAry[0]):i=0;var u=0;for(o=0;o<i;o++){var h=c.Scene_data.frameTime*o;h>=this._currentTarget.beginTime&&(this.beginScale=this._currentTarget.value,r=this._currentTarget.beginTime,u==this.scaleAry.length-1?this._currentTarget=this.scaleAry[this.scaleAry.length-1]:(u++,this._currentTarget=this.scaleAry[u]),s=this._currentTarget.time);var l=(h-r)/s*(this._currentTarget.value-this.beginScale)+this.beginScale;this.numAry.push(l)}this._currentTarget=this.scaleAry[0]},i.prototype.getAllNum=function(t){t=Math.min(t,this.lastTime+this.beginTime);var e=this.scaleAry[this.scaleAry.length-1];if(t>=e.beginTime+e.time)this.baseNum=e.value;else{for(var i,n=0;n<this.scaleAry.length;n++)t>this.scaleAry[n].this.beginTime&&(this._currentTarget=this.scaleAry[n],this.beginTime=this._currentTarget.this.beginTime,this.beginScale=this._currentTarget.value,i=n);i++,this._currentTarget=this.scaleAry[i],this.baseNum=(this._currentTarget.value-this.beginScale)/this._currentTarget.this.time*(t-this.beginTime)+this.beginScale}},i);function i(){var t=e.call(this)||this;return t.num=1,t}c.ScaleAnim=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=i.BaseAnim,__extends(n,e),n.prototype.coreCalculate=function(){this.num=1+this.speed*this.time+this.baseNum,this.num<this.minNum?this.num=this.minNum:this.num>this.maxNum&&(this.num=this.maxNum)},Object.defineProperty(n.prototype,"data",{set:function(t){this.beginTime=Number(t[0].value),-1==Number(t[1].value)?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=Number(t[1].value),this.speed=.001*Number(t[2].value),this.minNum=.01*Number(t[3].value),this.maxNum=.01*Number(t[4].value)},enumerable:!0,configurable:!0}),n.prototype.dataByte=function(t,e){this.beginTime=e[0],-1==e[1]?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=e[1],this.speed=.001*e[2],this.minNum=.01*e[3],this.maxNum=.01*e[4]},n.prototype.getAllNum=function(t){t=Math.min(t,this.lastTime),t-=this.beginTime;var e=this.speed*t;this.baseNum+=e,this.baseNum<this.minNum?this.baseNum=this.minNum:e>this.maxNum&&(this.baseNum=this.maxNum)},n.prototype.reset=function(){this._isActiva=!1,this._isDeath=!1,this.time=0,this.num=1},n.prototype.depthReset=function(){this._isActiva=!1,this._isDeath=!1,this.time=0,this.baseNum=0,this.num=1},n);function n(){var t=e.call(this)||this;return t.num=1,t}i.ScaleChange=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=i.BaseAnim,__extends(n,t),n.prototype.coreCalculate=function(){this.num=this.amplitude+this.amplitude*Math.sin(this.speed*this.time)},Object.defineProperty(n.prototype,"data",{set:function(t){this.beginTime=Number(t[0].value),-1==Number(t[1].value)?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=Number(t[1].value),this.amplitude=Number(t[2].value),this.speed=.01*Number(t[3].value)},enumerable:!0,configurable:!0}),n.prototype.dataByte=function(t,e){this.beginTime=e[0],-1==e[1]?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=e[1],this.amplitude=e[2],this.speed=.01*e[3]},n.prototype.getAllNum=function(t){this.baseNum=this.amplitude+this.amplitude*Math.sin(this.speed*t)},n);function n(){return null!==t&&t.apply(this,arguments)||this}i.ScaleNoise=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=i.BaseAnim,__extends(n,t),Object.defineProperty(n.prototype,"data",{set:function(t){this.beginTime=Number(t[0].value),-1==Number(t[1].value)?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=Number(t[1].value),this.speed=.1*Number(t[2].value),this.aSpeed=.1*Number(t[3].value)},enumerable:!0,configurable:!0}),n.prototype.dataByte=function(t,e){this.beginTime=e[0],-1==e[1]?this.lastTime=i.Scene_data.MAX_NUMBER:this.lastTime=e[1],this.speed=.1*e[2],this.aSpeed=.1*e[3]},n);function n(){return null!==t&&t.apply(this,arguments)||this}i.SelfRotation=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.BaseEvent,__extends(n,e),n.Down="down",n.Up="Up",n.Move="Move",n.PinchStart="PinchStart",n.Pinch="Pinch",n);function n(){return null!==e&&e.apply(this,arguments)||this}t.InteractiveEvent=i}(tl3d=tl3d||{}),function(t){var e=(i.LEFT="left",i.CENTER="center",i.RIGHT="right",i.TOP="top",i.MIDDLE="middle",i.BOTTOM="bottom",i);function i(){}t.TextAlign=e}(tl3d=tl3d||{}),function(c){var t=(Object.defineProperty(e.prototype,"texture",{get:function(){return this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),e.prototype.setInfo=function(t,i,n,e){var o=this;void 0===e&&(e=null),this._useImgUrl=e,c.LoadManager.getInstance().load(c.Scene_data.fileRoot+t,c.LoadManager.XML_TYPE,function(t){var e=JSON.parse(t);o.configData=e.uiArr,o.layoutData=e.panelArr,o.loadImgUrl(i,n)})},e.prototype.loadConfig=function(t,i){var n=this;c.LoadManager.getInstance().load(c.Scene_data.fileRoot+t,c.LoadManager.XML_TYPE,function(t){var e=JSON.parse(t);n.configData=e.uiArr,i()})},e.prototype.loadImgUrl=function(t,e){var i=this;c.TextureManager.getInstance().getTexture(c.Scene_data.fileRoot+t,function(t){i.textureRes=t,i._useImgUrl?i.loadUseImg(e):e()},1,null,0)},e.prototype.loadUseImg=function(t){this.useImg=makeImage(),this.useImg.onload=function(){t()},this.useImg.src=c.Scene_data.fileRoot+this._useImgUrl},e.prototype.getRec=function(t){for(var e=new c.UIRectangle,i=0;i<this.configData.length;i++)if(this.configData[i].name==t){e.x=this.configData[i].x,e.y=this.configData[i].y,e.width=this.configData[i].width,e.height=this.configData[i].height,e.pixelWitdh=this.configData[i].ow,e.pixelHeight=this.configData[i].oh,e.pixelX=this.configData[i].ox,e.pixelY=this.configData[i].oy,e.type=this.configData[i].type,e.cellX=this.configData[i].cellX,e.cellY=this.configData[i].cellY;break}return e},e.prototype.getLayoutData=function(t){if(!this.layoutData)return null;for(var e in this.layoutData)for(var i=this.layoutData[e].item,n=0;n<i.length;n++)if(i[n].name==t)return i[n]},e.prototype.getGridRec=function(t){for(var e=new c.UIGridRentangle,i=0;i<this.configData.length;i++)if(this.configData[i].name==t){e.x=this.configData[i].x,e.y=this.configData[i].y,e.width=this.configData[i].width,e.height=this.configData[i].height,e.pixelWitdh=this.configData[i].ow,e.pixelHeight=this.configData[i].oh,e.pixelX=this.configData[i].ox,e.pixelY=this.configData[i].oy,e.ogw=this.configData[i].uow,e.ogh=this.configData[i].uoh;break}return e},Object.defineProperty(e.prototype,"hasData",{get:function(){return this.configData},enumerable:!0,configurable:!0}),e.prototype.getObject=function(t,e,i,n,o,a,r,s,u){void 0===s&&(s=0),void 0===u&&(u=0);var h=new Object;return h.x=e/a,h.y=i/r,h.width=n/a,h.height=o/r,h.ow=n,h.oh=o,h.ox=e,h.oy=i,h.name=t,h.cellX=s,h.cellY=u,h},e.prototype.updateCtx=function(t,e,i){c.TextureManager.getInstance().updateTexture(this.texture,e,i,t)},e.prototype.upDataPicToTexture=function(t,i){var n=this;c.LoadManager.getInstance().load(c.Scene_data.fileRoot+t,c.LoadManager.IMG_TYPE,function(t){var e=n.getRec(i);n.ctx=c.UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1),n.ctx.drawImage(t,0,0,e.pixelWitdh,e.pixelHeight),c.TextureManager.getInstance().updateTexture(n.texture,e.pixelX,e.pixelY,n.ctx)})},e.prototype.clearCtxTextureBySkilname=function(t){var e=this.getRec(t);this.ctx=c.UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1),this.ctx.clearRect(0,0,e.pixelWitdh,e.pixelHeight),c.TextureManager.getInstance().updateTexture(this.texture,e.pixelX,e.pixelY,this.ctx)},e.prototype.copyPicToTexture=function(t,e){var i=this.getRec(t),n=this.getRec(e);this.ctx=c.UIManager.getInstance().getContext2D(n.pixelWitdh,n.pixelHeight,!1),this.ctx.drawImage(this.useImg,i.pixelX,i.pixelY,i.pixelWitdh,i.pixelWitdh,0,0,n.pixelWitdh,n.pixelWitdh),c.TextureManager.getInstance().updateTexture(this.texture,n.pixelX,n.pixelY,this.ctx)},e.prototype.updateLable=function(t,e,i,n,o,a,r,s){void 0===o&&(o=c.TextAlign.MIDDLE),void 0===a&&(a=c.TextAlign.CENTER),void 0===r&&(r=!1),void 0===s&&(s=0);var u=this.getRec(t);this.ctx=this.getTextCtx(u,i,n,r,o,a);var h=this.getTextxpos(a,this.ctx),l=this.getTextypos(o,this.ctx);0<s?this.wrapText(this.ctx,e,h,l,s,i+3):this.ctx.fillText(e,h,l),c.TextureManager.getInstance().updateTexture(this.texture,u.pixelX,u.pixelY,this.ctx)},e.prototype.updateArtNum=function(t,e,i){var n=String(i),o=this.getRec(t),a=this.getRec(e);this.ctx=c.UIManager.getInstance().getContext2D(o.pixelWitdh,o.pixelHeight,!1);for(var r=a.pixelWitdh/10,s=0;s<n.length;s++){var u=Number(n.charAt(s));this.ctx.drawImage(this.useImg,a.pixelX+u*r,a.pixelY,r,a.pixelHeight,s*r,0,r,a.pixelHeight)}c.TextureManager.getInstance().updateTexture(this.texture,o.pixelX,o.pixelY,this.ctx)},e.prototype.writeSingleLabel=function(t,e,i,n,o){void 0===i&&(i=12),void 0===n&&(n=c.TextAlign.CENTER),void 0===o&&(o="#ffffff"),c.LabelTextFont.writeSingleLabel(this,t,e,i,n,o)},e.prototype.writeSingleLabelToCxt=function(t,e,i,n,o){void 0===i&&(i=12),void 0===n&&(n=0),void 0===o&&(o=0),t.textBaseline=c.TextAlign.TOP,t.textAlign=c.TextAlign.LEFT,t.font="bolder  "+i+"px "+c.UIData.font,c.TextRegExp.wrapText(t,e,"#ffffff",n,o,9999,20)},e.prototype.updateLableCtx=function(t,e,i,n,o,a,r,s,u,h){void 0===a&&(a=c.TextAlign.CENTER),void 0===r&&(r=c.TextAlign.MIDDLE),void 0===s&&(s="#000000"),void 0===u&&(u="bolder"),void 0===h&&(h=0),t.textAlign=a,t.textBaseline=r,t.fillStyle=s,t.font=u+" "+o+"px "+c.UIData.font;var l=this.getTextxpos(a,t);0<h?this.wrapText(t,e,i,n,h,o+3):t.fillText(e,i+l,n)},e.prototype.getTextCtx=function(t,e,i,n,o,a){var r=c.UIManager.getInstance().getContext2D(t.pixelWitdh,t.pixelHeight,!1);return r.textBaseline=o,r.textAlign=a,r.fillStyle=i,r.font=(n?"bolder ":"")+" "+e+"px "+c.UIData.font,r},e.prototype.getTextxpos=function(t,e){var i=0;return t==c.TextAlign.LEFT?i=0:t==c.TextAlign.RIGHT?i=e.canvas.width:t==c.TextAlign.CENTER&&(i=e.canvas.width/2),i},e.prototype.getTextypos=function(t,e){var i=0;return t==c.TextAlign.BOTTOM?i=e.canvas.height:t==c.TextAlign.TOP?i=0:t==c.TextAlign.MIDDLE&&(i=e.canvas.height/2),i},e.prototype.wrapText=function(t,e,i,n,o,a){for(var r=e,s="",u=0;u<r.length;u++)if("\n"==r[u])t.fillText(s,i,n),s="",n+=a;else{var h=s+r[u]+" ";o<t.measureText(h).width?(t.fillText(s,i,n),s=r[u]+"",n+=a):s=h}t.fillText(s,i,n)},e.prototype.dispose=function(){this._hasDispose||(this.textureRes.clearUseNum(),this.configData=null,this.layoutData=null,this.useImg=null,this._hasDispose=!0)},e);function e(){this._hasDispose=!1}c.UIAtlas=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Rectangle,__extends(n,e),n);function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.pixelWitdh=1,t.pixelHeight=1,t.pixelX=0,t.pixelY=0,t.cellX=0,t.cellY=0,t.type=0,t}t.UIRectangle=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.UIRectangle,__extends(n,e),n);function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.ogw=0,t.ogh=0,t}t.UIGridRentangle=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=i.EventDispatcher,__extends(n,e),Object.defineProperty(n.prototype,"rendering",{get:function(){return this._rendering},set:function(t){this._rendering=t},enumerable:!0,configurable:!0}),n.prototype.addStage=function(){this.renderData=[0,0,0,0],this.renderData2=[1,1,0,0],this.applyAbsolutePoint(),this.uiRender.addRenderUI(this)},n.prototype.removeStage=function(){this.uiRender.removeRenderUI(this)},n.prototype.pushVaData=function(t,e,i){return t.vertices.push(0,0,0,1,0,0,1,-1,0,0,-1,0),t.uvs.push(this.isU?1:0,this.isV?1:0,e,this.isU?0:1,this.isV?1:0,e,this.isU?0:1,this.isV?0:1,e,this.isU?1:0,this.isV?0:1,e),t.indexs.push(i,1+i,2+i,i,2+i,3+i),i+4},n.prototype.setVc=function(t,e){i.Scene_data.context3D.setVc4fv(t,"ui["+e+"]",this.renderData),i.Scene_data.context3D.setVc4fv(t,"ui2["+e+"]",this.renderData2)},n.prototype.update=function(){},n.prototype.applyRenderSize=function(){if(this.parent){if(this.renderX=this.absoluteX/i.Scene_data.stageWidth,this.renderY=this.absoluteY/i.Scene_data.stageHeight,this.renderWidth=this.absoluteWidth/i.Scene_data.stageWidth,this.renderHeight=this.absoluteHeight/i.Scene_data.stageHeight,0<=this._uvScale)this.renderData[0]=this.renderX,this.renderData[1]=this.renderY,this.renderData[2]=this.renderWidth*this.scale*this._uvScale,this.renderData[3]=this.renderHeight*this.scale,this.renderData2[0]=this.tr.width*this._uvScale,this.renderData2[1]=this.tr.height,this.renderData2[2]=this.tr.x,this.renderData2[3]=this.tr.y;else{var t=Math.abs(this._uvScale);this.renderData[0]=this.renderX+this.renderWidth*(1-t),this.renderData[1]=this.renderY,this.renderData[2]=this.renderWidth*this.scale*t,this.renderData[3]=this.renderHeight*this.scale,this.renderData2[0]=this.tr.width*t,this.renderData2[1]=this.tr.height,this.renderData2[2]=this.tr.x+this.tr.width*(1-t),this.renderData2[3]=this.tr.y}this.uiRender.makeRenderDataVc(this.vcId)}},Object.defineProperty(n.prototype,"uvScale",{get:function(){return this._uvScale},set:function(t){this._uvScale=t,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),n.prototype.setScale=function(t){this.scale=t,this.applyAbsolutePoint()},n.prototype.applyAbsolutePoint=function(){this.parent&&(-1==this._xType?this.absoluteX=this._x*i.UIData.Scale*this.scale+this.parent.x:0==this._xType?this.absoluteX=this._left*i.UIData.Scale:1==this._xType?this.absoluteX=i.Scene_data.stageWidth-this._right*i.UIData.Scale-this.width*i.UIData.Scale:2==this._xType&&(this.absoluteX=this._center*i.UIData.Scale+i.Scene_data.stageWidth/2-this.width*i.UIData.Scale/2),-1==this._yType?this.absoluteY=this._y*i.UIData.Scale*this.scale+this.parent.y:0==this._yType?this.absoluteY=this._top*i.UIData.Scale:1==this._yType?this.absoluteY=i.Scene_data.stageHeight-this._bottom*i.UIData.Scale-this.height*i.UIData.Scale:2==this._yType&&(this.absoluteY=this._middle*i.UIData.Scale+i.Scene_data.stageHeight/2-this.height*i.UIData.Scale/2),this.absoluteWidth=this.width*i.UIData.Scale,this.absoluteHeight=this.height*i.UIData.Scale,this.applyRenderSize())},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(t){t!=this._x&&(this._x=t,this.applyAbsolutePoint())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(t){t!=this._y&&(this._y=t,this.applyAbsolutePoint())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(t){t!=this._width&&(this._width=t,this.applyAbsolutePoint())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(t){t!=this._height&&(this._height=t,this.applyAbsolutePoint())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{set:function(t){this._left=t,this._xType=0,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{set:function(t){this._right=t,this._xType=1,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"center",{set:function(t){this._center=t,this._xType=2,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{set:function(t){this._top=t,this._yType=0,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{set:function(t){this._bottom=t,this._yType=1,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"middle",{set:function(t){this._middle=t,this._yType=2,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),n.prototype.testPoint=function(t,e){return t>this.absoluteX&&t<this.absoluteX+this.absoluteWidth&&e>this.absoluteY&&e<this.absoluteY+this.absoluteHeight},n.prototype.setPos=function(t,e){this.x=t,this.y=e},n.prototype.interactiveEvent=function(t){if(!this.enable)return!1;t.type;var e=this._eventsMap;if(!e)return!1;var i=e[t.type];if(!i)return!1;if(!this.testPoint(t.x,t.y))return!1;var n=i.length;if(0==n)return!1;t.target=this;for(var o=n-1;0<=o;o--){var a=i[o];a.listener.call(a.thisObject,t)}return!0},n.prototype.preShow=function(){this.preParent&&this.preParent.addChild(this)},n.prototype.preHide=function(){this.preParent&&this.preParent.removeChild(this)},n);function n(){var t=e.call(this)||this;return t._x=0,t._y=0,t._width=0,t._height=0,t.z=0,t.absoluteX=0,t.absoluteY=0,t.absoluteWidth=0,t.absoluteHeight=0,t.enable=!0,t._left=0,t._right=0,t._center=0,t._xType=-1,t._top=0,t._bottom=0,t._middle=0,t._yType=-1,t.renderX=0,t.renderY=0,t.renderWidth=0,t.renderHeight=0,t.scale=1,t.isVirtual=!1,t.vcId=0,t._uvScale=1,t._rendering=!1,t.isU=!1,t.isV=!1,t.tr=new i.Rectangle,t.mouseEnable=!0,t}i.UICompenent=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t=(Object.defineProperty(e.prototype,"layer",{get:function(){return this._layer},set:function(t){this._layer=t;for(var e=0;e<this.renderList.length;e++)this.renderList[e].sortnum=this._layer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interfaceUI",{get:function(){return this._interfaceUI},set:function(t){this._interfaceUI=t,this.layer=t?0:100},enumerable:!0,configurable:!0}),e.prototype.load=function(t,e){void 0===e&&(e=!0),this._isLoading||(this._completeFun=t,this._needShowLoading=e,this._hasLoad?t():(this._isLoading=!0,this.makeBaseWinUi()))},Object.defineProperty(e.prototype,"hasLoad",{get:function(){return this._hasLoad},enumerable:!0,configurable:!0}),e.prototype.makeBaseWinUi=function(){this.applyLoad()},e.prototype.applyLoad=function(){},e.prototype.applyLoadComplete=function(){this._isLoading=!1,this._completeFun(),this._hasLoad=!0},Object.defineProperty(e.prototype,"hasStage",{get:function(){return this._hasStage},set:function(t){(this._hasStage=t)?this.onAdd():this.onRemove()},enumerable:!0,configurable:!0}),e.prototype.setUiListVisibleByItem=function(t,e){try{for(var i=0;i<t.length;i++)e?t[i].parent||this.addChild(t[i]):t[i].parent&&this.removeChild(t[i])}catch(t){}},e.prototype.onAdd=function(){},e.prototype.onRemove=function(){},e.prototype.addChild=function(t){if(!t)throw new Error("ui cuo");if(!t.parent)return this._list.push(t),t.parent=this,t.addStage(),t},e.prototype.addVirtualContainer=function(t){this.virtualContainerList||(this.virtualContainerList=new Array),(t.parent=this).virtualContainerList.push(t)},e.prototype.removeVirtualContainer=function(t){},e.prototype.addUIList=function(t,e){for(var i=new Array,n=0;n<t.length;n++){var o=e.getComponent(t[n]);this.addChild(o),i.push(o)}return i},e.prototype.getUIList=function(t,e){for(var i=new Array,n=0;n<t.length;n++){var o=e.getComponent(t[n]);i.push(o)}return i},e.prototype.addEvntBut=function(t,e){var i=this.addChild(e.getComponent(t));return i.addEventListener(n.InteractiveEvent.Down,this.butClik,this),i},e.prototype.addEvntButUp=function(t,e){var i=this.addChild(e.getComponent(t));return i.addEventListener(n.InteractiveEvent.Up,this.butClik,this),i},e.prototype.removeEvntBut=function(t){t.removeEventListener(n.InteractiveEvent.Down,this.butClik,this),this.removeChild(t)},e.prototype.butClik=function(t){},e.prototype.renderSetVisibel=function(t,e){for(var i=0;i<t.length;i++)e?t[i].rendering||this.addRender(t[i]):t[i].rendering&&this.removeRender(t[i])},e.prototype.removeChild=function(t){var e=this._list.indexOf(t);-1!=e&&(this._list.splice(e,1),t.parent=null,t.removeStage())},e.prototype.removeAll=function(){for(;this._list.length;)this.removeChild(this._list[0]);for(;this._maskList.length;)this.removeMaks(this._maskList[0])},e.prototype.addMask=function(t){this._maskList||(this._maskList=new Array),t.parent=this,t.applyAbsolutePoint(),this._maskList.push(t)},e.prototype.removeMaks=function(t){if(this._maskList){var e=this._maskList.indexOf(t);-1!=e&&this._maskList.splice(e,1)}},e.prototype.addRender=function(t){-1==this.renderList.indexOf(t)&&(t.container=this,t.sortnum=this._layer,this.renderList.push(t),this.hasStage&&n.UIManager.getInstance().addUI(t))},e.prototype.addRenderAt=function(t,e){-1==this.renderList.indexOf(t)&&(t.container=this,t.sortnum=this._layer,this.renderList.splice(e,0,t),this.hasStage&&n.UIManager.getInstance().addUI(t))},e.prototype.removeRender=function(t){var e=this.renderList.indexOf(t);-1!=e&&(this.renderList.splice(e,1),this.hasStage&&n.UIManager.getInstance().removeUI(t))},e.prototype.resize=function(){0==this._xType?this._x=this._left*n.UIData.Scale:1==this._xType?this._x=n.Scene_data.stageWidth-this._right*n.UIData.Scale-this.width*n.UIData.Scale:2==this._xType&&(this._x=this._center*n.UIData.Scale+n.Scene_data.stageWidth/2-this.width*n.UIData.Scale/2),0==this._yType?this._y=this._top*n.UIData.Scale:1==this._yType?this._y=n.Scene_data.stageHeight-this._bottom*n.UIData.Scale-this.height*n.UIData.Scale:2==this._yType&&(this._y=this._middle*n.UIData.Scale+n.Scene_data.stageHeight/2-this.height*n.UIData.Scale/2),this.applyChild(),this.resizeVirtualList()},e.prototype.resizeVirtualList=function(){if(this.virtualContainerList)for(var t=0;t<this.virtualContainerList.length;t++)this.virtualContainerList[t].resize()},Object.defineProperty(e.prototype,"left",{get:function(){return this._left},set:function(t){this._left=t,this._xType=0,this._x=this._left*n.UIData.Scale,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this._right},set:function(t){this._right=t,this._xType=1,this._x=n.Scene_data.stageWidth-this._right*n.UIData.Scale-this.width*n.UIData.Scale,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{set:function(t){this._center=t,this._xType=2,this._x=this._center*n.UIData.Scale+n.Scene_data.stageWidth/2-this.width*n.UIData.Scale/2,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._top},set:function(t){this._top=t,this._yType=0,this._y=this._top*n.UIData.Scale,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._bottom},set:function(t){this._bottom=t,this._yType=1,this._y=n.Scene_data.stageHeight-this._bottom*n.UIData.Scale-this.height*n.UIData.Scale,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"middle",{set:function(t){this._middle=t,this._yType=2,this._y=this._middle*n.UIData.Scale+n.Scene_data.stageHeight/2-this.height*n.UIData.Scale/2,this.applyChild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){if(0!=this._width)return this._width;for(var t=0,e=0;e<this._list.length;e++)t=Math.max(this._list[e].width);return t},set:function(t){this._width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){if(0!=this._height)return this._height;for(var t=0,e=0;e<this._list.length;e++)t=Math.max(this._list[e].height);return t},set:function(t){this._height=t},enumerable:!0,configurable:!0}),e.prototype.applyChild=function(){for(var t=0;t<this._list.length;t++)this._list[t].applyAbsolutePoint();if(this._maskList)for(t=0;t<this._maskList.length;t++)this._maskList[t].applyAbsolutePoint()},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){},e.prototype.setSizeForPanelUiCopy=function(t,e,i){var n=i.getComponent(e);t.x=n.x,t.y=n.y,t.width=n.width,t.height=n.height},e);function e(){this._x=0,this._y=0,this._width=0,this._height=0,this._left=0,this._right=0,this._center=0,this._xType=0,this._top=0,this._bottom=0,this._middle=0,this._yType=0,this._list=new Array,this.renderList=new Array,this._hasStage=!1,this._hasLoad=!1,this._isLoading=!1,this._needShowLoading=!0,this._interfaceUI=!1,this._layer=100}n.UIConatiner=t;var i,o=(__extends(a,i=t),a.prototype.update=function(t){},a.prototype.clearOneTemp=function(){},a);function a(){return i.call(this)||this}n.Dis2DUIContianerBase=o}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.UIConatiner,__extends(n,e),n);function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.visible=!0,t}t.UIVirtualContainer=i}(tl3d=tl3d||{}),function(d){var t=(e.init=function(t,e,i){return void 0===i&&(i=null),this._itemLoad=t,this._bFun=e,this.loadFun=i,this.loadBaseConfigCom(),t.length},e.loadBaseConfigCom=function(){for(var t=0;t<this._itemLoad.length;t++)this.loadUIdata(this._itemLoad[t].xmlurl,this._itemLoad[t].picurl,this._itemLoad[t].name,Boolean(this._itemLoad[t].isTexture))},e.loadOkNum=function(t){this.loadFun&&this.loadFun(t)},e.loadUIdata=function(t,i,n,o){var a=this;if(void 0===n&&(n="default"),void 0===o&&(o=!1),!o){var r=new Image;(this._imgDic[n]=r).onload=function(t){a.loadOkd()}}d.LoadManager.getInstance().load(d.Scene_data.fileRoot+t,d.LoadManager.XML_TYPE,function(t){var e=Array(JSON.parse(t))[0];a._dic[n]=e,o?d.TextureManager.getInstance().getTexture(d.Scene_data.fileRoot+i,function(t){a._imgDic[n]=t,a.loadOkd()},1,null,0):r.src=d.Scene_data.fileRoot+i})},e.loadOkd=function(){this._skipnum++,this.loadOkNum(this._skipnum),this._skipnum>=this._itemLoad.length&&this._bFun()},e._skipnum=0,e._dic=new d.Dictionary([]),e._imgDic=new d.Dictionary([]),e);function e(){}d.MainUiLoad=t;var r=(i.setDesignWH=function(t,e){this.designWidth=t,this.designHeight=e,this.resize()},i.resize=function(){this.Scale=Math.min(d.Scene_data.stageWidth/this.designWidth,d.Scene_data.stageHeight/this.designHeight)},i.init=function(t,e,i){return void 0===i&&(i=null),this._itemLoad=t,this._bFun=e,this.loadFun=i,this.loadBaseConfigCom(),t.length},Object.defineProperty(i,"mainUIAtlas",{get:function(){return null},enumerable:!0,configurable:!0}),i.loadBaseConfigCom=function(){for(var t=0;t<this._itemLoad.length;t++)this.loadUIdata(this._itemLoad[t].xmlurl,this._itemLoad[t].picurl,this._itemLoad[t].name,Boolean(this._itemLoad[t].isTexture))},i.loadOkNum=function(t){this.loadFun&&this.loadFun(t)},i.loadUIdata=function(t,i,n,o){var a=this;if(void 0===n&&(n="default"),void 0===o&&(o=!1),!o){var r=new Image;(this._imgDic[n]=r).onload=function(t){a.loadOkd()}}d.LoadManager.getInstance().load(d.Scene_data.fileRoot+t,d.LoadManager.XML_TYPE,function(t){var e=Array(JSON.parse(t))[0];a._dic[n]=e,o?d.TextureManager.getInstance().getTexture(d.Scene_data.fileRoot+i,function(t){a._imgDic[n]=t,a.loadOkd()},1,null,0):r.src=d.Scene_data.fileRoot+i})},i.loadOkd=function(){this._skipnum++,this.loadOkNum(this._skipnum),this._skipnum>=this._itemLoad.length&&(i.textImg=this._imgDic[i.flytext],this._bFun())},i.getImgByKey=function(t){return this._imgDic.containsKey(t)?this._imgDic[t]:null},i.getUiByName=function(t,e){if(this._dic.containsKey(t))for(var i=this._dic[t].uiArr,n=0;n<i.length;n++)if(i[n].name==e)return i[n];return null},i.getUiArrByKey=function(t){return this._dic.containsKey(t)?this._dic[t].uiArr:null},i.designWidth=960,i.designHeight=540,i.font="Helvetica",i._skipnum=0,i.publicUi="publicUi",i.flytext="flytext",i.publicsUi="publicsUi",i.faceItem=["/大笑","/脸2","/脸3","/脸4","/脸5","/脸6","/脸7","/脸8","/脸9","/脸a","/脸b","/脸c","/脸d","/脸e","/脸f","/脸g","/脸h","/脸i"],i._dic=new d.Dictionary([]),i._imgDic=new d.Dictionary([]),i);function i(){}d.UIData=r;var n=(s.drawUseImg=function(t,e,i){var n=t.uiRender.uiAtlas.getRec(t.skinName),o=d.UIManager.getInstance().getContext2D(n.pixelWitdh,n.pixelHeight,!1),a=e.getRec(i);o.drawImage(e.useImg,a.pixelX,a.pixelY,a.pixelWitdh,a.pixelHeight,0,0,n.pixelWitdh,n.pixelHeight),t.uiRender.uiAtlas.updateCtx(o,n.pixelX,n.pixelY)},s.clearUI=function(t){var e=t.uiRender.uiAtlas.getRec(t.skinName),i=d.UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);t.uiRender.uiAtlas.updateCtx(i,e.pixelX,e.pixelY)},s.drawAttVal=function(t,e,i,n,o){void 0===n&&(n=d.TextAlign.LEFT),void 0===o&&(o=!1);var a="";void 0!==e?(a=d.ColorType.Orange7a2f21+getKeyProById(e)+":  "+d.ColorType.Orange9a683f+Snum(Math.floor(i/100)),o&&(a=d.ColorType.Orange7a2f21+getKeyProById(e)+":  "+d.ColorType.Orange9a683f+"+"+Snum(Math.floor(i/100))),d.LabelTextFont.writeSingleLabel(t.uiRender.uiAtlas,t.skinName,a,14,n)):s.clearUI(t)},s.drawAttValAdd=function(t,e,i){var n;void 0!==e?(n=d.ColorType.Orange7a2f21+getKeyProById(e)+":    "+d.ColorType.Green2ca937+"+"+Snum(Math.floor(i/100)),d.LabelTextFont.writeSingleLabel(t.uiRender.uiAtlas,t.skinName,n,14,d.TextAlign.LEFT)):s.clearUI(t)},s.drawResHasNumAndAllNum=function(t,e,i){return void 0===i&&(i=""),!1},s.cxtDrawImg=function(t,e,i,n){var o=r.getUiByName(n,e);o&&(0!=i.width&&0!=i.height||(i.width=o.ow,i.height=o.oh),0==o.type?t.drawImage(r.getImgByKey(n),o.ox,o.oy,o.ow,o.oh,i.x,i.y,i.width,i.height):1==o.type?(t.drawImage(r.getImgByKey(n),o.ox,o.oy,o.uow,o.uoh,i.x,i.y,o.uow,o.uoh),t.drawImage(r.getImgByKey(n),o.ox+o.uow,o.oy,o.ow-2*o.uow,o.uoh,i.x+o.uow,i.y,i.width-2*o.uow,o.uoh),t.drawImage(r.getImgByKey(n),o.ox+o.ow-o.uow,o.oy,o.uow,o.uoh,i.x+i.width-o.uow,i.y,o.uow,o.uoh),t.drawImage(r.getImgByKey(n),o.ox,o.oy+o.uoh,o.uow,o.oh-2*o.uoh,i.x,i.y+o.uoh,o.uow,i.height-2*o.uoh),t.drawImage(r.getImgByKey(n),o.ox+o.uow,o.oy+o.uoh,o.ow-2*o.uow,o.oh-2*o.uoh,i.x+o.uow,i.y+o.uoh,i.width-2*o.uow,i.height-2*o.uoh),t.drawImage(r.getImgByKey(n),o.ox+o.ow-o.uow,o.oy+o.uoh,o.uow,o.uoh,i.x+i.width-o.uow,i.y+o.uoh,o.uow,i.height-2*o.uoh),t.drawImage(r.getImgByKey(n),o.ox,o.oy+o.oh-o.uoh,o.uow,o.uoh,i.x,i.y+i.height-o.uoh,o.uow,o.uoh),t.drawImage(r.getImgByKey(n),o.ox+o.uow,o.oy+o.oh-o.uoh,o.ow-2*o.uow,o.uoh,i.x+o.uow,i.y+i.height-o.uoh,i.width-2*o.uow,o.uoh),t.drawImage(r.getImgByKey(n),o.ox+o.ow-o.uow,o.oy+o.oh-o.uoh,o.uow,o.uoh,i.x+i.width-o.uow,i.y+i.height-o.uoh,o.uow,o.uoh)):alert("UiDraw没有绘制成功  "+o.type))},s.uiAtlasDrawImg=function(t,e,i,n){var o=t.getRec(e);t.ctx=d.UIManager.getInstance().getContext2D(o.pixelWitdh,o.pixelHeight,!1);var a=r.getUiByName(i,n);a?(0==a.type?t.ctx.drawImage(r.getImgByKey(i),a.ox,a.oy,a.ow,a.oh,0,0,o.pixelWitdh,o.pixelHeight):1==a.type&&(t.ctx.drawImage(r.getImgByKey(i),a.ox,a.oy,a.uow,a.uoh,0,0,a.uow,a.uoh),t.ctx.drawImage(r.getImgByKey(i),a.ox+a.uow,a.oy,a.ow-2*a.uow,a.uoh,a.uow,0,o.pixelWitdh-2*a.uow,a.uoh),t.ctx.drawImage(r.getImgByKey(i),a.ox+a.ow-a.uow,a.oy,a.uow,a.uoh,o.pixelWitdh-a.uow,0,a.uow,a.uoh),t.ctx.drawImage(r.getImgByKey(i),a.ox,a.oy+a.uoh,a.uow,a.oh-2*a.uoh,0,a.uoh,a.uow,o.pixelHeight-2*a.uoh),t.ctx.drawImage(r.getImgByKey(i),a.ox+a.uow,a.oy+a.uoh,a.ow-2*a.uow,a.oh-2*a.uoh,a.uow,a.uoh,o.pixelWitdh-2*a.uow,o.pixelHeight-2*a.uoh),t.ctx.drawImage(r.getImgByKey(i),a.ox+a.ow-a.uow,a.oy+a.uoh,a.uow,a.uoh,o.pixelWitdh-a.uow,a.uoh,a.uow,o.pixelHeight-2*a.uoh),t.ctx.drawImage(r.getImgByKey(i),a.ox,a.oy+a.oh-a.uoh,a.uow,a.uoh,0,o.pixelHeight-a.uoh,a.uow,a.uoh),t.ctx.drawImage(r.getImgByKey(i),a.ox+a.uow,a.oy+a.oh-a.uoh,a.ow-2*a.uow,a.uoh,a.uow,o.pixelHeight-a.uoh,o.pixelWitdh-2*a.uow,a.uoh),t.ctx.drawImage(r.getImgByKey(i),a.ox+a.ow-a.uow,a.oy+a.oh-a.uoh,a.uow,a.uoh,o.pixelWitdh-a.uow,o.pixelHeight-a.uoh,a.uow,a.uoh)),d.TextureManager.getInstance().updateTexture(t.texture,o.pixelX,o.pixelY,t.ctx)):alert("uiAtlasDrawImg错误")},s.SharedDrawImg=function(t,e,i,n,o,a,r){void 0===o&&(o=0),void 0===a&&(a=0),void 0===r&&(r=!0);var s=t.getRec(i);t.ctx=d.UIManager.getInstance().getContext2D(s.pixelWitdh,s.pixelHeight,!1);var u=e.getRec(n),h=r?0:o,l=r?0:a,c=r?s.pixelWitdh:u.pixelWitdh,p=r?s.pixelHeight:u.pixelHeight;t.ctx.drawImage(e.useImg,u.pixelX,u.pixelY,u.pixelWitdh,u.pixelHeight,h,l,c,p),d.TextureManager.getInstance().updateTexture(t.texture,s.pixelX,s.pixelY,t.ctx)},s.drawToUiAtlasToCtx=function(t,e,i,n){var o=e.getRec(i);1<(n=n||new d.Rectangle(0,0,0,0)).width&&1<n.height?t.drawImage(e.useImg,o.pixelX,o.pixelY,o.pixelWitdh,o.pixelHeight,n.x,n.y,n.width,n.height):t.drawImage(e.useImg,o.pixelX,o.pixelY,o.pixelWitdh,o.pixelHeight,n.x,n.y,o.pixelWitdh,o.pixelHeight)},s.RepeatLoadImg=function(t,e,i){void 0===i&&(i=null);var n=new Image;n.onload=function(){d.LoadManager.getInstance().load(e,d.LoadManager.IMG_TYPE,function(t){i&&i(n,t)})},n.src=t},s);function s(){}d.UiDraw=n;var o=(a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.costtype=function(t){switch(t){case 1:return d.PuiData.A_YUANBAO;case 2:return d.PuiData.A_BANGYUAN;case 3:return d.PuiData.A_YINBI;case 101:return d.PuiData.A_ZHENQI;case 102:return d.PuiData.A_SHOULING;case 103:return d.PuiData.A_JINGHUA;case 6:return d.PuiData.A_BANGGONG;case 7:return d.PuiData.A_HONOR;case 8:case 9:return d.PuiData.A_DOUHUN;case 10:return d.PuiData.A_CARD_G;case 11:return d.PuiData.A_CARD_C;case 12:return d.PuiData.A_CARD_B;case 104:return d.PuiData.A_EXP}},a);function a(){}d.UIuitl=o}(tl3d=tl3d||{}),function(a){var t=(Object.defineProperty(e.prototype,"rendering",{get:function(){return this._rendering},set:function(t){if(this._rendering=t,this._uiList)for(var e=0;e<this._uiList.length;e++)this._uiList[e].rendering=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),e.prototype.initData=function(){this._uiList=new Array,this.objData=new a.ObjData,this.shader=a.ProgrmaManager.getInstance().getProgram(a.UIShader.UI_SHADER),this.program=this.shader.program,this.uiProLocation=a.Scene_data.context3D.getLocation(this.program,"ui"),this.ui2ProLocation=a.Scene_data.context3D.getLocation(this.program,"ui2")},e.prototype.resize=function(){},e.prototype.setImgUrl=function(t){var e=this;a.TextureManager.getInstance().getTexture(a.Scene_data.fileRoot+t,function(t){e.textureRes=t})},e.prototype.setInfo=function(t,e,i){this.uiAtlas=new a.UIAtlas,this.uiAtlas.setInfo(t,e,function(){i()})},e.prototype.setAtlas=function(t){this.uiAtlas=t},e.prototype.creatComponent=function(t,e,i,n){var o=new a.UICompenent;return o.tr.sets(t,e,i,n),o.uiRender=this,o},e.prototype.getComponent=function(t){var e=this.uiAtlas.getLayoutData(t);if(e){var i=e.type;if(0==i){var n=this.creatBaseComponent(e.dataItem[0]);return n.width=e.rect.width,n.height=e.rect.height,n.x=e.rect.x,n.y=e.rect.y,n.baseRec=e.rect,n.name=t,n}if(1==i){var o=this.creatGrid9Component(e.dataItem[0],e.rect.width,e.rect.height);return o.x=e.rect.x,o.y=e.rect.y,o.baseRec=e.rect,o.name=t,o}if(2!=i&&4==i){var a=this.createFrame(e.dataItem[0]);return a.width=e.rect.width,a.height=e.rect.height,a.x=e.rect.x,a.y=e.rect.y,a.baseRec=e.rect,a.name=t,a}}return null},e.prototype.createFrame=function(t){var e=new a.FrameCompenent;e.skinName=t;var i=this.uiAtlas.getRec(t);return e.setFrameData(i),e.stopStatic,e.uiRender=this,e},e.prototype.creatBaseComponent=function(t){var e=new a.UICompenent;e.skinName=t;var i=this.uiAtlas.getRec(t);return e.tr.setRec(i),e.width=i.pixelWitdh,e.height=i.pixelHeight,e.uiRender=this,e},e.prototype.creatGrid9Component=function(t,e,i){var n=new a.Grid9Compenent;n.skinName=t;var o=this.uiAtlas.getGridRec(t);return n.tr.setRec(o),n.ogw=o.ogw,n.ogh=o.ogh,n.gw=n.ogw/o.pixelWitdh,n.gh=n.ogh/o.pixelHeight,n.width=e,n.height=i,n.uiRender=this,n},e.prototype.addRenderUI=function(t){50<=this._uiList.length?alert("UIRenderComponent超限制51"):(this._uiList.push(t),t.rendering=this.rendering,this.applyObjData())},e.prototype.removeRenderUI=function(t){var e=this._uiList.indexOf(t);-1!=e&&this._uiList.splice(e,1),t.rendering=!1,this.applyObjData()},e.prototype.applyObjData=function(){this.objData.vertices.length=0,this.objData.uvs.length=0;for(var t=this.objData.indexs.length=0,e=0;e<this._uiList.length;e++){var i=this._uiList[e];i.isVirtual||(t=i.pushVaData(this.objData,e,t))}this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer?(a.Scene_data.context3D.uploadBuff3DByBuffer(this.objData.vertexBuffer,this.objData.vertices),a.Scene_data.context3D.uploadBuff3DByBuffer(this.objData.uvBuffer,this.objData.uvs),a.Scene_data.context3D.uploadIndexBuff3DByBuffer(this.objData.indexBuffer,this.objData.indexs)):(this.objData.vertexBuffer=a.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=a.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=a.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)),this.mask&&(this.mask.scale=this.scale,this.mask.applyAbsolutePoint()),this.makeRenderDataVc(-1)},e.prototype.makeRenderDataVc=function(t){if((!this.renderData||this.renderData&&this.renderData.length!=4*this._uiList.length)&&(this.renderData=new Float32Array(4*this._uiList.length),this.renderData2=new Float32Array(4*this._uiList.length)),-1==t)for(var e=0;this._uiList&&e<this._uiList.length;e++)this._uiList[e].vcId=e,this.renderData[4*e+0]=this._uiList[e].renderData[0],this.renderData[4*e+1]=this._uiList[e].renderData[1],this.renderData[4*e+2]=this._uiList[e].renderData[2],this.renderData[4*e+3]=this._uiList[e].renderData[3],this.renderData2[4*e+0]=this._uiList[e].renderData2[0],this.renderData2[4*e+1]=this._uiList[e].renderData2[1],this.renderData2[4*e+2]=this._uiList[e].renderData2[2],this.renderData2[4*e+3]=this._uiList[e].renderData2[3];else t<this._uiList.length&&(this.renderData[4*t+0]=this._uiList[t].renderData[0],this.renderData[4*t+1]=this._uiList[t].renderData[1],this.renderData[4*t+2]=this._uiList[t].renderData[2],this.renderData[4*t+3]=this._uiList[t].renderData[3],this.renderData2[4*t+0]=this._uiList[t].renderData2[0],this.renderData2[4*t+1]=this._uiList[t].renderData2[1],this.renderData2[4*t+2]=this._uiList[t].renderData2[2],this.renderData2[4*t+3]=this._uiList[t].renderData2[3])},e.prototype.update=function(){if(this.visible&&0!=this._uiList.length||this.modelRenderList&&this.modelRenderList.length){if(this.mask){var t=a.Scene_data.context3D.renderContext;t.enable(t.STENCIL_TEST),t.stencilMask(255),t.stencilFunc(t.NEVER,this.mask.level,255),t.stencilOp(t.REPLACE,t.REPLACE,t.REPLACE),this.mask.update(),t.stencilFunc(t.LESS,this.mask.level-1,255),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}if(a.Scene_data.context3D.setBlendParticleFactors(this.blenderMode),a.Scene_data.context3D.setProgram(this.program),this.setVc(),a.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),a.Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),this.setTextureToGpu(),a.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum),this.mask&&a.Scene_data.context3D.renderContext.disable(a.Scene_data.context3D.renderContext.STENCIL_TEST),this.modelRenderList)for(var e=0;e<this.modelRenderList.length;e++)this.modelRenderList[e].update()}},e.prototype.setTextureToGpu=function(){this.uiAtlas?a.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.uiAtlas.texture,0):a.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0)},e.prototype.setVc=function(){for(var t=0;t<this._uiList.length;t++)this._uiList[t].update(),this._uiList[t].vcId;a.Scene_data.context3D.setVc4fvLocation(this.uiProLocation,this.renderData),a.Scene_data.context3D.setVc4fvLocation(this.ui2ProLocation,this.renderData2)},e.prototype.addModel=function(t){this.modelRenderList||(this.modelRenderList=new Array),-1==this.modelRenderList.indexOf(t)&&this.modelRenderList.push(t)},e.prototype.removeModel=function(t){var e=this.modelRenderList.indexOf(t);-1!=e&&this.modelRenderList.splice(e,1)},e.prototype.insetUi=function(t){for(var e=0;e<this._uiList.length;e++)if(this._uiList[e].testPoint(t.x,t.y))return this._uiList[e];return null},e.prototype.interactiveEvent=function(t){if(this.mask&&!this.mask.testPoint(t.x,t.y))return!1;for(var e=!1,i=0;i<this._uiList.length;i++)if(this._uiList[i].interactiveEvent(t)&&a.UIManager.cando)return e=!0,!(a.UIManager.cando=!1);return e},e.prototype.dispose=function(){this.objData.destory(),this.objData=null,this.uiAtlas&&(this.uiAtlas.dispose(),this.uiAtlas=null),this.mask&&(this.mask.dispose(),this.mask=null),this.renderData=null,this.renderData2=null},e);function e(){this._rendering=!1,this.scale=1,this.sortnum=0,this.blenderMode=0,this.renderData=new Float32Array(0),this.renderData2=new Float32Array(0),this.num=0,this.visible=!0,this.initData()}a.UIRenderComponent=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=i.UIRenderComponent,__extends(n,e),n.prototype.initData=function(){this.objData=new i.ObjData,this.shader=i.ProgrmaManager.getInstance().getProgram(i.UIImageShader.UI_IMG_SHADER),this.program=this.shader.program,this.objData.vertices.push(-1,1,0,1,1,0,1,-1,0,-1,-1,0),this.objData.uvs.push(0,0,1,0,1,1,0,1),this.objData.indexs.push(0,1,2,0,2,3),this.objData.treNum=6,this.objData.vertexBuffer=i.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=i.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=i.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)},n.prototype.resize=function(){this.appleyPos()},n.prototype.setImgInfo=function(t,e,i){this.setImgUrl(t),this._width=e,this._height=i},n.prototype.appleyPos=function(){var t=this._width/i.Scene_data.stageWidth,e=this._height/i.Scene_data.stageHeight;t<e?(this._scaleData[0]=1,this._scaleData[1]=this._height/i.Scene_data.stageHeight/t):(this._scaleData[0]=this._width/i.Scene_data.stageWidth/e,this._scaleData[1]=1)},n.prototype.setFbo=function(){this._isFBO=!0},n.prototype.update=function(){var t=!1;this._isFBO?(i.Scene_data.fbo&&(t=!0),i.Scene_data.context3D.clearContext(),i.Scene_data.context3D.setDepthTest(!1)):this.texture&&(t=!0),this.objData&&t&&(i.Scene_data.context3D.setBlendParticleFactors(0),i.Scene_data.context3D.setProgram(this.program),i.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),i.Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),i.Scene_data.context3D.setVc2fv(this.shader,"scale",this._scaleData),this._isFBO?(i.Scene_data.context3D.setVc2fv(this.shader,"scale",[1,-1]),i.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",i.Scene_data.fbo.texture,0)):i.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0),i.Scene_data.context3D.setVcFloat(this.shader,"alpha",[this.alpha]),i.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},n.prototype.interactiveEvent=function(t){return!0},n);function n(){var t=e.call(this)||this;return t._scaleData=[1,1],t._isFBO=!1,t.alpha=1,t}i.UIBackImg=t;var o,a=(o=i.UIRenderComponent,__extends(r,o),r.prototype.makeRenderDataVc=function(t){o.prototype.makeRenderDataVc.call(this,t);for(var e=0;e<this.renderData2.length/4;e++)this.renderData2[4*e+0]=1,this.renderData2[4*e+1]=1,this.renderData2[4*e+2]=0,this.renderData2[4*e+3]=0},r.prototype.update=function(){this.texture&&o.prototype.update.call(this)},r.prototype.setTextureToGpu=function(){i.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0)},r.prototype.dispose=function(){o.prototype.dispose.call(this),this.textureRes&&this.textureRes.clearUseNum()},r);function r(){return o.call(this)||this}i.UIRenderOnlyPicComponent=a}(tl3d=tl3d||{}),function(t){var e=(i.prototype.initData=function(){this.objData=new t.ObjData,this.shader=t.ProgrmaManager.getInstance().getProgram(t.UIMaskShader.UI_MASK_SHADER),this.program=this.shader.program,this.applyObjData()},i.prototype.applyAbsolutePoint=function(){this.parent&&(this.absoluteX=this._x*this.scale*t.UIData.Scale+this.parent.x,this.absoluteY=this._y*this.scale*t.UIData.Scale+this.parent.y,this.absoluteWidth=this._width*t.UIData.Scale*this.scale,this.absoluteHeight=this._height*t.UIData.Scale*this.scale,this.applyRenderSize())},i.prototype.testPoint=function(t,e){return t>this.absoluteX&&t<this.absoluteX+this.absoluteWidth&&e>this.absoluteY&&e<this.absoluteY+this.absoluteHeight},i.prototype.applyRenderSize=function(){this.parent&&(this.renderData[0]=this.absoluteX/t.Scene_data.stageWidth,this.renderData[1]=this.absoluteY/t.Scene_data.stageHeight,this.renderData[2]=this.absoluteWidth/t.Scene_data.stageWidth,this.renderData[3]=this.absoluteHeight/t.Scene_data.stageHeight)},i.prototype.applyObjData=function(){this.objData.vertices.length=0,this.objData.uvs.length=0,this.objData.indexs.length=0,this.objData.vertices.push(0,0,0,1,0,0,1,-1,0,0,-1,0),this.objData.indexs.push(0,1,2,0,2,3),this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer=t.Scene_data.context3D.uploadBuff3D(this.objData.vertices),this.objData.indexBuffer=t.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs)},i.prototype.update=function(){t.Scene_data.context3D.setBlendParticleFactors(0),t.Scene_data.context3D.setProgram(this.program),t.Scene_data.context3D.setVc4fv(this.shader,"ui",this.renderData),t.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),t.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)},Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this.applyAbsolutePoint()},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this._hasDisposed||(this.objData.destory(),this.objData=null,this.program=null,this.shader=null,this.renderData=null,this.parent=null,this._hasDisposed=!0)},i);function i(){this._x=0,this._y=0,this._width=0,this._height=0,this.absoluteX=0,this.absoluteY=0,this.absoluteWidth=0,this.absoluteHeight=0,this.scale=1,this.level=2,this._hasDisposed=!1,this.initData(),this.renderData=[0,0,0,0]}t.UIMask=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.UICompenent,__extends(n,e),n.prototype.pushVaData=function(t,e,i){for(var n=[0,0,0,this.ogw,0,0,this.width-this.ogw,0,0,this.width,0,0,0,-this.ogh,0,this.ogw,-this.ogh,0,this.width-this.ogw,-this.ogh,0,this.width,-this.ogh,0,0,this.ogh-this.height,0,this.ogw,this.ogh-this.height,0,this.width-this.ogw,this.ogh-this.height,0,this.width,this.ogh-this.height,0,0,-this.height,0,this.ogw,-this.height,0,this.width-this.ogw,-this.height,0,this.width,-this.height,0],o=0;o<n.length;o+=3)t.vertices.push(n[o]/this.width,n[o+1]/this.height,n[o+2]);t.uvs.push(0,0,e,this.gw,0,e,1-this.gw,0,e,1,0,e,0,this.gh,e,this.gw,this.gh,e,1-this.gw,this.gh,e,1,this.gh,e,0,1-this.gh,e,this.gw,1-this.gh,e,1-this.gw,1-this.gh,e,1,1-this.gh,e,0,1,e,this.gw,1,e,1-this.gw,1,e,1,1,e);var a=[0,1,5,0,5,4,1,2,6,1,6,5,2,3,7,2,7,6,4,5,9,4,9,8,5,6,10,5,10,9,6,7,11,6,11,10,8,9,13,8,13,12,9,10,14,9,14,13,10,11,15,10,15,14];for(o=0;o<a.length;o++)t.indexs.push(i+a[o]);return i+16},n);function n(){return e.call(this)||this}t.Grid9Compenent=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=r.UICompenent,__extends(i,e),i.prototype.setFrameData=function(t){this._frameData=t,this.totalcurrent=this._frameData.cellX*this._frameData.cellY},i.prototype.applyRenderSize=function(){if(this.parent){this.renderX=this.absoluteX/r.Scene_data.stageWidth,this.renderY=this.absoluteY/r.Scene_data.stageHeight,this.renderWidth=this.absoluteWidth/r.Scene_data.stageWidth,this.renderHeight=this.absoluteHeight/r.Scene_data.stageHeight,this.renderData[0]=this.renderX,this.renderData[1]=this.renderY,this.renderData[2]=this.renderWidth*this._uvScale,this.renderData[3]=this.renderHeight;var t=this._frameData.cellX,e=this._frameData.cellY,i=this._frameData.width/t,n=this._frameData.height/e,o=new r.Rectangle(0,0,i,n),a=this.current%(t*e);o.x=a%t*i,o.y=float2int(a/t)*n,this.renderData2[0]=o.width*this._uvScale,this.renderData2[1]=o.height,this.renderData2[2]=o.x+this._frameData.x,this.renderData2[3]=o.y+this._frameData.y,this.uiRender.makeRenderDataVc(this.vcId)}},i.prototype.getSkinCtxRect=function(){var t=this._frameData,e=new r.Rectangle;return e.width=t.pixelWitdh/t.cellX,e.height=t.pixelHeight/t.cellY,e.x=this.current%t.cellX*e.width,e.y=Math.floor(this.current/t.cellX)*e.height,e},i.prototype.drawToCtx=function(t,e){var i=this._frameData,n=this.getSkinCtxRect();t.updateCtx(e,i.pixelX+n.x,i.pixelY+n.y)},i.prototype.update=function(){if(this._frameData&&2!=this.stopStatic){this.applyRenderSize(),this.speedNum++,this.speedNum>this.speed&&(this.current++,this.speedNum=0);var t=this._frameData.cellX,e=this._frameData.cellY;this.current>t*e-1&&(1==this.stopStatic?(this.stopStatic=2,this.endFlag=!0):this.current=0)}},i.prototype.goToAndPlay=function(t){this.stopStatic=1,this.current=t},i.prototype.goToAndStop=function(t){this.stopEnd(),this.current=t,this.applyRenderSize()},i.prototype.Invisible=function(){0!=this.renderData[2]&&0!=this.renderData[3]&&(this.stopEnd(),this.renderData[0]=0,this.renderData[1]=0,this.renderData[2]=0,this.renderData[3]=0,this.uiRender.makeRenderDataVc(this.vcId))},i.prototype.play=function(){this.stopStatic=0},i.prototype.stopEnd=function(){this.stopStatic=2;var t=this._frameData.cellX,e=this._frameData.cellY;this.current=t*e-1,this.applyRenderSize()},i);function i(){var t=e.call(this)||this;return t.isTrue=!1,t.current=0,t.totalcurrent=0,t.speed=6,t.endFlag=!1,t.stopStatic=0,t.speedNum=0,t}r.FrameCompenent=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t=(e.prototype.needUpData=function(t){return!(this.oldPos.x==t.x&&this.oldPos.y==t.y&&!o.Scene_data.cam3D.needChange||(this.oldPos.x=t.x,this.oldPos.y=t.y,0))},Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.makeData(),this.time=0,this.update()},enumerable:!0,configurable:!0}),e.prototype.makeData=function(){},e.prototype.update=function(){},e.prototype.Vector3DToVector2D=function(t){var e=o.Scene_data.cam3D.cameraMatrix.clone();e.append(o.Scene_data.viewMatrx3D.clone());var i=e.transformVector(t),n=new o.Vector2D;return n.x=(i.x/i.w+1)*(o.Scene_data.stageWidth/2)/o.UIData.Scale-this.ui.width/2,n.y=(-i.y/i.w+1)*(o.Scene_data.stageHeight/2)/o.UIData.Scale-this.ui.height/2,n},e.prototype.isEqualLastKey=function(t){return!1},e);function e(){this.dtime=-1,this.time=0,this.oldPos=new o.Vector2D}o.Disp2DBaseText=t;var a,i=(a=o.Dis2DUIContianerBase,__extends(n,a),n.prototype.creatBaseRender=function(){this._baseRender=new o.UIRenderComponent},n.prototype.initData=function(t,e,i){this.voNum=Math.floor(i),this.voRect=e,this.textureRect=new o.Rectangle(0,0,Math.pow(2,Math.ceil(Math.log(e.width)/Math.log(2))),Math.pow(2,Math.ceil(Math.log(e.height*this.voNum)/Math.log(2)))),this._baseRender.uiAtlas=new o.UIAtlas;var n=this._baseRender.uiAtlas;n.configData=new Array,n.ctx=o.UIManager.getInstance().getContext2D(this.textureRect.width,this.textureRect.height,!1),n.textureRes=o.TextureManager.getInstance().getCanvasTexture(n.ctx),this.makeBaseUi(t)},n.prototype.makeBaseUi=function(t){var e=this._baseRender.uiAtlas;this._uiItem=new Array,this._lostItem=new Array;for(var i=0;i<this.voNum;i++){var n=new t;this._uiItem.push(n),n.parent=this._baseRender,n.voRect=this.voRect,n.textureStr="id"+i,e.configData.push(e.getObject(n.textureStr,0,i*this.voRect.height,this.voRect.width,this.voRect.height,this.textureRect.width,this.textureRect.height)),n.ui=this._baseRender.creatBaseComponent(n.textureStr),n.ui.width*=1,n.ui.height*=1}},n.prototype.showTemp=function(t){var e;this.clearLostItem();for(var i=0;i<this._uiItem.length;i++)if(null==this._uiItem[i].data&&this._uiItem[i].isEqualLastKey(t)){e=this._uiItem[i];break}if(!e)for(var n=0;n<this._uiItem.length;n++)if(null==this._uiItem[n].data){e=this._uiItem[n];break}return e?(e.data=t,this.addChild(e.ui)):this._lostItem.push(t),e},n.prototype.clearLostItem=function(){for(var t=this._lostItem.length-1;0<t;t--)this._lostItem[t].clear&&this._lostItem.splice(t,1)},n.prototype.playLost=function(){this._lostItem.length&&this.showTemp(this._lostItem.pop())},n.prototype.clearOneTemp=function(){for(var t=0;t<this._uiItem.length;t++)if(!this._uiItem[t].data)return;this._lostItem.length=0,this.clearTemp(this._uiItem[0].data)},n.prototype.clearTemp=function(t){for(var e=0;e<this._uiItem.length;e++)if(this._uiItem[e].data==t){this._uiItem[e].data=null,this.removeChild(this._uiItem[e].ui);break}this.playLost()},n.prototype.clearAll=function(){for(var t=0;t<this._uiItem.length;t++)this._uiItem[t].data&&this.clearTemp(this._uiItem[t].data)},n.prototype.update=function(t){for(var e=0;e<this._uiItem.length;e++)this._uiItem[e].data&&this._uiItem[e].update()},n.prototype.getUiItemLen=function(){for(var t=0,e=0;e<this._uiItem.length;e++)this._uiItem[e].data&&t++;return t},n);function n(t,e,i){var n=a.call(this)||this;return n.width=o.UIData.designWidth,n.height=o.UIData.designHeight,n.creatBaseRender(),n.addRender(n._baseRender),n.initData(t,e,i),n}o.Dis2DUIContianerPanel=i;var r,s=(__extends(u,r=i),u.prototype.makeBaseUi=function(t){var e=this._baseRender.uiAtlas;this._uiItem=new Array,this._lostItem=new Array;for(var i=0;i<this.voNum;i++){var n=new t;this._uiItem.push(n),n.parent=this._baseRender,n.voRect=this.voRect,n.textureStr="id"+i,e.configData.push(e.getObject(n.textureStr,0,i*this.voRect.height,this.voRect.width,this.voRect.height,this.textureRect.width,this.textureRect.height)),n.ui=this._baseRender.createFrame(n.textureStr),n.ui.width*=1,n.ui.height*=1}},u);function u(t,e,i){return r.call(this,t,e,i)||this}o.Dis2DUIFram=s}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=i.Shader3D,__extends(n,t),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Pos"),t.bindAttribLocation(this.program,1,"v2uv")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Pos;attribute vec3 v2uv;uniform vec4 ui[40];uniform vec4 ui2[40];uniform float alpha[40];varying vec2 v_texCoord;varying float v_alpha;void main(void){   vec4 data = ui2[int(v2uv.z)];   v_texCoord = vec2(v2uv.x * data.x + data.z, v2uv.y * data.y + data.w);   v_alpha = alpha[int(v2uv.z)];   data = ui[int(v2uv.z)];   vec3 pos = vec3(0.0,0.0,0.0);   pos.xy = v3Pos.xy * data.zw * 2.0;   pos.x += data.x * 2.0 - 1.0;   pos.y += -data.y * 2.0 + 1.0;   vec4 vt0= vec4(pos, 1.0);   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvarying float v_alpha;void main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ninfoUv.xyz *= infoUv.w;\ninfoUv *=v_alpha;\ngl_FragColor = infoUv;\n}"},n.AlphaUiShader="AlphaUiShader",n);function n(){return t.call(this)||this}i.AlphaUIShader=e;var o,a=(o=i.UIRenderComponent,__extends(r,o),r.prototype.update=function(){if(this.visible&&0!=this._uiList.length){i.Scene_data.context3D.setBlendParticleFactors(0),i.Scene_data.context3D.setProgram(this.program);for(var t=0;t<this._uiList.length;t++)this._uiList[t].update(),this._uiList[t].setVc(this.shader,t);i.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),i.Scene_data.context3D.setVa(1,3,this.objData.uvBuffer),this.uiAtlas?i.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.uiAtlas.texture,0):i.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this.texture,0),i.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum)}},r.prototype.initData=function(){this._uiList=new Array,this.objData=new i.ObjData,i.ProgrmaManager.getInstance().registe(e.AlphaUiShader,new e),this.shader=i.ProgrmaManager.getInstance().getProgram(e.AlphaUiShader),this.program=this.shader.program,this.uiProLocation=i.Scene_data.context3D.getLocation(this.program,"ui"),this.ui2ProLocation=i.Scene_data.context3D.getLocation(this.program,"ui2"),this.alphaLocation=i.Scene_data.context3D.getLocation(this.program,"alpha")},r.prototype.creatBaseComponent=function(t){var e=new _;e.skinName=t;var i=this.uiAtlas.getRec(t);return e.tr.setRec(i),e.width=i.pixelWitdh,e.height=i.pixelHeight,e.uiRender=this,e},r.prototype.creatGrid9Component=function(t,e,i){var n=new c;n.skinName=t;var o=this.uiAtlas.getGridRec(t);return n.tr.setRec(o),n.ogw=o.ogw,n.ogh=o.ogh,n.gw=n.ogw/o.pixelWitdh,n.gh=n.ogh/o.pixelHeight,n.width=e,n.height=i,n.uiRender=this,n},r.prototype.createFrame=function(t){var e=new u;e.skinName=t;var i=this.uiAtlas.getRec(t);return e.setFrameData(i),e.uiRender=this,e},r);function r(){return o.call(this)||this}i.AlphaUIRenderComponent=a;var s,u=(s=i.FrameCompenent,__extends(h,s),h.prototype.setVc=function(t,e){i.Scene_data.context3D.setVc4fv(t,"ui["+e+"]",this.renderData),i.Scene_data.context3D.setVc4fv(t,"ui2["+e+"]",this.renderData2),i.Scene_data.context3D.setVc1fv(t,"alpha["+e+"]",[this.alpha])},h);function h(){var t=s.call(this)||this;return t.alpha=1,t}i.AlphaFrameCompenent=u;var l,c=(l=i.Grid9Compenent,__extends(p,l),p.prototype.setVc=function(t,e){i.Scene_data.context3D.setVc4fv(t,"ui["+e+"]",this.renderData),i.Scene_data.context3D.setVc4fv(t,"ui2["+e+"]",this.renderData2),i.Scene_data.context3D.setVc1fv(t,"alpha["+e+"]",[this.alpha])},p);function p(){var t=l.call(this)||this;return t.alpha=1,t}i.AlphaGrid9UICompenent=c;var d,_=(d=i.UICompenent,__extends(f,d),f.prototype.setVc=function(t,e){i.Scene_data.context3D.setVc4fv(t,"ui["+e+"]",this.renderData),i.Scene_data.context3D.setVc4fv(t,"ui2["+e+"]",this.renderData2),i.Scene_data.context3D.setVc1fv(t,"alpha["+e+"]",[this.alpha])},f);function f(){var t=d.call(this)||this;return t.alpha=1,t}i.AlphaUICompenent=_;var g,y=(g=i.Dis2DUIContianerPanel,__extends(m,g),m.prototype.creatBaseRender=function(){this._baseRender=new a},m);function m(t,e,i){return g.call(this,t,e,i)||this}i.AlphaUiContianer=y}(tl3d=tl3d||{}),function(a){var i=(Object.defineProperty(t.prototype,"ui",{get:function(){return this._ui},set:function(t){this._ui=t,this._baseRect=new a.Rectangle(this._ui.x,this._ui.y,this._ui.width,this._ui.height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale=t,this._ui.width=this._baseRect.width*this._scale,this._ui.height=this._baseRect.height*this._scale,this._ui.x=this._baseRect.x+(this._baseRect.width-this._ui.width)/2,this._ui.y=this._baseRect.y+(this._baseRect.height-this._ui.height)/2},enumerable:!0,configurable:!0}),t.prototype.destory=function(){this._ui=null,this._scale=null,this._baseRect=null},t.getPosByPanel=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),this.baseUIConatiner||(this.baseUIConatiner=new a.UIConatiner),this.baseUIConatiner.width=a.UIData.designWidth,this.baseUIConatiner.height=a.UIData.designHeight,this.baseUIConatiner.middle=0,this.baseUIConatiner.center=0,e)for(var n in e)this.baseUIConatiner[n]=e[n];this.baseUIConatiner.resize();var o=new a.Vector2D;return o.x=t.x+this.baseUIConatiner.x/a.UIData.Scale,o.y=t.y+this.baseUIConatiner.y/a.UIData.Scale,i&&(o.x=o.x-i.x/a.UIData.Scale,o.y=o.y-i.y/a.UIData.Scale),o},t);function t(){this._scale=1}a.UiTweenVo=i;var e=(n.getInstance=function(){return this._instance||(this._instance=new n),this._instance},n.prototype.changeButSize=function(t){var e=this;this._uiTweenVo||(this._uiTweenVo=new i,this._uiTweenVo.ui=t,this._uiTweenVo.scale=1,TweenMoveTo(this._uiTweenVo,.07,{scale:1.2,onComplete:function(){e.changeButScale()}}))},n.prototype.changeButScale=function(){var t=this;this._uiTweenVo.scale=1.2,TweenMoveTo(this._uiTweenVo,.05,{scale:1,onComplete:function(){t.changeButEnd()}})},n.prototype.changeButEnd=function(){this._uiTweenVo.destory(),this._uiTweenVo=null},n);function n(){}a.UiTweenScale=e;var o=(r.getInstance=function(){var i=this;return this._instance||(this._instance=new r,r.popClikNameFun=function(t,e){void 0===e&&(e=0),i.uiClikName(t,e)}),this._instance},r.uiClikName=function(t,e){},r.prototype.getContext2D=function(t,e,i){return void 0===i&&(i=!0),this._canvas.width=t,this._canvas.height=e,this._ctx.clearRect(0,0,t,e),(i=!0)&&(this._ctx.textBaseline=a.TextAlign.TOP,this._ctx.textAlign=a.TextAlign.LEFT),this._ctx},r.prototype.getGrayImageDatabyImg=function(t){var e=r.getInstance().getContext2D(t.width,t.height,!1);e.drawImage(t,0,0);for(var i,n=e.getImageData(0,0,t.width,t.height),o=0;o<n.data.length;o+=4)i=Math.floor(.3*n.data[o+0])+Math.floor(.59*n.data[o+1])+Math.floor(.11*n.data[o+2]),n.data[o+0]=i,n.data[o+1]=i,n.data[o+2]=i;return n},r.prototype.makeCtxToGray=function(t,e){for(var i,n=t.getImageData(e.x,e.y,e.width,e.height),o=0;o<n.data.length;o+=4)i=.5*(i=Math.floor(.3*n.data[o+0])+Math.floor(.59*n.data[o+1])+Math.floor(.11*n.data[o+2]))+.5,n.data[o+0]=i,n.data[o+1]=i,n.data[o+2]=i;t.putImageData(n,e.x,e.y)},r.prototype.showCanvas=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._canvas.style.left=t,this._canvas.style.top=e,document.getElementById("root").appendChild(this._canvas)},r.prototype.init=function(){a.ProgrmaManager.getInstance().registe(a.UIShader.UI_SHADER,new a.UIShader),a.ProgrmaManager.getInstance().registe(a.UIImageShader.UI_IMG_SHADER,new a.UIImageShader),a.ProgrmaManager.getInstance().registe(a.UIMaskShader.UI_MASK_SHADER,new a.UIMaskShader),a.ProgrmaManager.getInstance().registe(a.Movie2DShader.MOVIE2D_SHADER,new a.Movie2DShader),a.ProgrmaManager.getInstance().registe(a.Sprite2DShader.SPRITE2D_SHADER,new a.Sprite2DShader),this._uiList=new Array,this._containerList=new Array,a.UIData.setDesignWH(960,540)},r.prototype.addUI=function(t){for(var e=0,i=this._uiList.length-1;0<=i;i--)if(this._uiList[i].sortnum<=t.sortnum){e=i+1;break}this._uiList.splice(e,0,t),t.rendering=!0},r.prototype.removeUI=function(t){var e=this._uiList.indexOf(t);t.rendering=!1,-1!=e&&this._uiList.splice(e,1)},r.prototype.addUIContainer=function(t){if(!t.hasStage){this._containerList.push(t),t.resize();for(var e=0;e<t.renderList.length;e++)this.addUI(t.renderList[e]);t.hasStage=!0}},r.prototype.removeAll=function(){for(;this._containerList.length;)this.removeUIContainer(this._containerList[this._containerList.length-1])},r.prototype.removeUIContainer=function(t){if(t.hasStage){var e=this._containerList.indexOf(t);t.hasStage=!1,-1!=e&&this._containerList.splice(e,1);for(var i=0;i<t.renderList.length;i++)this.removeUI(t.renderList[i])}},r.prototype.hasWindowUI=function(){return!1},r.prototype.removeNoInterfaceUI=function(){for(var t=this._containerList.length-1;0<=t;t--)this._containerList[t].interfaceUI||this.removeUIContainer(this._containerList[t])},r.prototype.resize=function(){if(this._uiList){a.UIData.resize();for(var t=0;t<this._uiList.length;t++)this._uiList[t].resize();for(t=0;t<this._containerList.length;t++)this._containerList[t].resize()}},r.prototype.upBgGroundZero=function(){for(var t=0;t<this._uiList.length;t++)-1!=this._uiList[t].container.layer&&-1!=this._uiList[t].sortnum||this._uiList[t].update()},r.prototype.update=function(){for(var t=0;t<this._uiList.length;t++)0<=this._uiList[t].container.layer&&-1!=this._uiList[t].sortnum&&this._uiList[t].update()},r.prototype.regEvent=function(t){},r.prototype.onTouch=function(t){this.interactiveEvent(t)},r.prototype.onMouse=function(t){this.interactiveEvent(t)},r.prototype.interactiveEvent=function(t){var e,i=new a.Vector2D;if(t instanceof MouseEvent)t.type==a.MouseType.MouseDown?e=new a.InteractiveEvent(a.InteractiveEvent.Down):t.type==a.MouseType.MouseUp?e=new a.InteractiveEvent(a.InteractiveEvent.Up):t.type==a.MouseType.MouseMove?e=new a.InteractiveEvent(a.InteractiveEvent.Move):(t.type,a.MouseType.MouseClick),i.x=t.pageX,i.y=t.pageY;else if(t.type==a.MouseType.TouchStart?(e=new a.InteractiveEvent(a.InteractiveEvent.Down),1<t.touches.length?(i.x=t.touches[t.touches.length-1].pageX,i.y=t.touches[t.touches.length-1].pageY):(i.x=t.pageX,i.y=t.pageY)):t.type==a.MouseType.TouchEnd?(e=new a.InteractiveEvent(a.InteractiveEvent.Up),i.x=t.changedTouches[0].pageX,i.y=t.changedTouches[0].pageY):t.type==a.MouseType.TouchMove&&(1<t.touches.length?((e=new a.InteractiveEvent(a.InteractiveEvent.Pinch)).data=a.MathClass.math_distance(t.touches[0].clientX,t.touches[0].clientY,t.touches[1].clientX,t.touches[1].clientY)/this.lastSwipeDis,e.roation=180*(Math.atan2(t.touches[1].clientY-t.touches[0].clientY,t.touches[1].clientX-t.touches[0].clientX)-this.lastSwipeRot)/Math.PI):e=new a.InteractiveEvent(a.InteractiveEvent.Move),i.x=t.pageX,i.y=t.pageY),t.touches.length)for(var n=0;n<t.touches.length;n++)i.x=t.touches[n].clientX,i.y=t.touches[n].clientY;this.mouseEvetData(e,i)},r.prototype.disMoveNnum=function(t,e){return a.Vector2D.distance(t,this.lastMousePos)<e},r.prototype.mouseEvetData=function(t,e){r.cando=!0,a.Scene_data.verticalScene?(t.x=e.y,t.y=a.Scene_data.stageHeight-e.x):(t.x=e.x,t.y=e.y);var i=!1;if(!i)for(var n=this._uiList.length-1;0<=n;n--)if(this._uiList[n]&&0==this._uiList[n].container.interfaceUI&&this._uiList[n]&&this._uiList[n].interactiveEvent(t)){i=!0;break}if(!i)for(n=this._uiList.length-1;0<=n;n--)if(this._uiList[n]&&1==this._uiList[n].container.interfaceUI&&this._uiList[n]&&this._uiList[n].interactiveEvent(t)){i=!0;break}if(t.type==a.InteractiveEvent.Down){if(this.lastMousePos=new a.Vector2D(t.x,t.y),a.TimeUtil.getTimer()-this.lastTime<200)return!0;this.lastTime=a.TimeUtil.getTimer()}var o=a.Scene_data.uiStage.interactiveEvent(t);return!!i||(a.Scene_data.uiBlankStage.interactiveEvent(t),o)},r.prototype.setUseMouseEventCon=function(t){this._eventItem.length=0,t&&this._eventItem.push(t)},r.prototype.getObjectsUnderPoint=function(t){for(var e=this._uiList.length-1;0<=e;e--)if(this._uiList[e]&&this._uiList[e]&&this._uiList[e].insetUi(t))return this._uiList[e].insetUi(t);return null},r.prototype.getcurrentList=function(){for(var t=new Array,e=this._uiList.length-1;0<e;e--)if(this._eventItem.length)for(var i=0;i<this._eventItem.length;i++)this._eventItem[i]!=this._uiList[e].container||(t.push(this._uiList[e]),i=this._eventItem.length);else t.push(this._uiList[e]);return t},r.cando=!0,r);function r(){this._eventItem=new Array,this.lastTime=0,a.Scene_data.uiStage=new a.UIStage,a.Scene_data.uiBlankStage=new a.UIStage,this._canvas=document.createElement("canvas"),this._canvas.style.zIndex="3",this._canvas.width=200,this._canvas.height=200,this._canvas.style.left=200,this._canvas.style.top=300,this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline=a.TextAlign.TOP}a.UIManager=o}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.EventDispatcher,__extends(n,e),n.prototype.interactiveEvent=function(t){var e=t.type,i=this._eventsMap;if(!i)return!1;var n=i[e];if(!n)return!1;var o=n.length;if(0==o)return!1;for(var a=o-1;0<=a;a--){var r=n[a];r.listener.call(r.thisObject,t)}return!0},n);function n(){return null!==e&&e.apply(this,arguments)||this}t.UIStage=i}(tl3d=tl3d||{}),function(t){var e=(i.A_HIGHT_F="A_hight_f",i.TAB_HIGHT="Tab_hight",i.A_HIGHT_C="A_hight_c",i.A_DELETEBTN="A_deletebtn",i.A_ZHENQI="A_zhenqi",i.A_SHOULING="A_SHOULING",i.A_JINGHUA="A_JINGHUA",i.A_JIANTOU="A_jiantou",i.A_WUPINKUANG="A_wupinkuang",i.A_BLACK_C="A_black_c",i.A_BLACK_F="A_black_f",i.A_BLACK_START="A_black_start",i.A_HIGHT_START="A_hight_start",i.A_BLACK_BASE="A_black_base ",i.A_RED_POINT="A_red_point",i.A_YINBI="A_yinbi",i.A_YUANBAO="A_yuanbao",i.A_BANGGONG="A_banggong",i.A_DOUHUN="A_DOUHUN",i.A_EXP="A_EXP",i.A_HONOR="A_HONOR",i.A_BANGYUAN="A_bangyuan",i.A_RIGHT_XING="A_RIGHT_XING",i.A_SSTART="A_SSTART",i.A_LEFT_XING="A_LEFT_XING",i.A_GOODS_PURPLE="A_GOODS_PURPLE",i.A_GOODS_BLUE="A_GOODS_BLUE",i.A_GOODS_RED="A_GOODS_RED",i.A_GOODS_GREEN="A_GOODS_GREEN",i.A_GOODS_WHITE="A_GOODS_WHITE",i.A_GOODS_ORANGE="A_GOODS_ORANGE",i.A_START_BG="A_START_BG",i.A_START="A_START",i.A_CHAIN="A_CHAIN",i.A_OK="A_OK",i.A_QIANWANG="A_QIANWANG",i.T_LEFT="T_LEFT",i.T_MID="T_MID",i.T_RIGHT="T_RIGHT",i.E_LEFT="E_LEFT",i.E_MID="E_MID",i.E_RIGHT="E_RIGHT",i.F_LEFT="F_LEFT",i.F_MID="F_MID",i.F_RIGHT="F_RIGHT",i.A_F_22="A_F_22",i.A_BLACK_BASE_66="A_BLACK_BASE_66 ",i.A_HIGHR_C_66="A_HIGHR_C_66",i.A_V="A_V",i.A_GIVING_BG="A_GIVING_BG",i.B_SUB="B_SUB",i.A_FACTION_ICON="A_FACTION_ICON",i.SELECT_1="SELECT_1",i.SELECT_0="SELECT_0",i.A_JIE="A_JIE",i.A_XING="A_XING",i.T_tips_txt_bg="T_tips_txt_bg",i.ITEMBG="ITEMBG",i.A_quest_top="A_quest_top",i.A_quest_mid="A_quest_mid",i.A_quest_bottom="A_quest_bottom",i.A_quest_ion0="A_quest_ion0",i.A_quest_ion1="A_quest_ion1",i.A_quest_ion2="A_quest_ion2",i.A_quest_ion3="A_quest_ion3",i.A_quest_finish="A_quest_finish",i.S_sys_tip0="S_sys_tip0",i.S_sys_tip1="S_sys_tip1",i.A_zhanli_label="A_zhanli_label",i.A_gou="A_gou",i.A_cha="A_cha",i.TYPE3="TYPE3",i.TYPE5="TYPE5",i.TYPE9="TYPE9",i.TYPE7="TYPE7",i.B_ZHUFUZHI="B_ZHUFUZHI",i.B_DABAOJI="B_DABAOJI",i.B_XIAOBAOJI="B_XIAOBAOJI",i.B_JINGYAN="B_JINGYAN",i.NewPicBg="NewPicBg",i.Select="Select",i.CostBg="CostBg",i.BG2="BG2",i.PropBg40="PropBg40",i.PropBg60="PropBg60",i.PropBg100="PropBg100",i.REWARD_BG1="REWARD_BG1",i.SKILL_BG68="SKILL_BG68",i.SKILL_BG58="SKILL_BG58",i.BG6="BG6",i.Slist_nselect="Slist_nselect",i.Slist_select="Slist_select",i.TXTBG="TXTBG",i.ARROW_TOP="ARROW_TOP",i.ARROW_RIGHT="ARROW_RIGHT",i.MASK="MASK",i.BTNADD="BTNADD",i.BOSSBG76="BOSSBG76",i.BOSSBG64="BOSSBG64",i.CIRCL74="CIRCL74",i.LISTITEMBG="LISTITEMBG",i.ADDITEM="ADDITEM",i.HASSEL="HASSEL",i.SKILL_LEV_BG="SKILL_LEV_BG",i.TITLEBG="TITLEBG",i.TITLEHIGHT="TITLEHIGHT",i.NEWLISTITEMBG="NEWLISTITEMBG",i.CHATBG="CHATBG",i.ITEMBIGBG="ITEMBIGBG",i.I1bg_2="I1bg_2",i.I1bg_1="I1bg_1",i.ARROWUP="ARROWUP",i.ARROWDOWN="ARROWDOWN",i.A_EQULEVBG="A_EQULEVBG",i.DISABLE="DISABLE",i.EQUBG="EQUBG",i.RESLISTBG="RESLISTBG",i.A_CARD_C="A_CARD_C",i.A_CARD_G="A_CARD_G",i.A_CARD_B="A_CARD_B",i.RESBG="RESBG",i.STATEUP_LISTBG="STATEUP_LISTBG",i.A_LEAGUELISTBG="A_LEAGUELISTBG",i.TEAMLISTBG="TEAMLISTBG",i.A_JJ0="A_JJ0",i.A_JJ1="A_JJ1",i.A_JJ2="A_JJ2",i.A_JJ3="A_JJ3",i.A_JJ4="A_JJ4",i.A_JJ5="A_JJ5",i.A_JJ6="A_JJ6",i.A_JJ7="A_JJ7",i.A_JJ8="A_JJ8",i.A_JJ9="A_JJ9",i.A_JJ10="A_JJ10",i);function i(){}t.PuiData=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=t.ResCount,__extends(n,i),n.prototype.destory=function(){t.Scene_data.context3D.deleteTexture(this.texture)},n);function n(t){var e=i.call(this)||this;return e.url=t,e}t.TextureRes=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var e,t=(e=l.ResGC,__extends(i,e),i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.hasTexture=function(t){return!!this._dic[t]},i.prototype.getTexture=function(t,e,i,n,o,a){var r=this;void 0===i&&(i=0),void 0===n&&(n=null),void 0===o&&(o=0),void 0===a&&(a=0);var s=this._dic[t];if(s)return n?e(s,n):e(s),void s.useNum++;var u=new c(e,n,t,i,o,a),h=this._loadDic[t];h?h.push(u):((h=new Array).push(u),this._loadDic[t]=h,this._resDic[t]?(this.loadTextureCom(this._resDic[t],u),delete this._resDic[t]):l.LoadManager.getInstance().load(t,l.LoadManager.IMG_TYPE,function(t,e){r.loadTextureCom(t,e)},u))},i.prototype.loadTextureCom=function(t,e){var i=l.Scene_data.context3D.getTexture(t,e.wrap,e.filter,e.mipmap),n=new l.TextureRes(e.url);n.texture=i,n.width=t.width,n.height=t.height;for(var o=this._loadDic[e.url],a=0;a<o.length;a++)o[a].info?o[a].fun(n,o[a].info):o[a].fun(n),n.useNum++;delete this._loadDic[e.url],this._dic[e.url]=n},i.prototype.addRes=function(t,e){this._dic[t]||this._resDic[t]||(this._resDic[t]=e)},i.prototype.removeRes=function(t){this._resDic[t]&&delete this._resDic[t]},i.prototype.getCanvasTexture=function(t){var e=new l.TextureRes(""),i=l.Scene_data.context3D.getTexture(t.canvas,0,0);return e.texture=i,e},i.prototype.updateTexture=function(t,e,i,n){l.Scene_data.context3D.updateTexture(t,e,i,n.canvas)},i.prototype.loadCubeTexture=function(t,e){(new n).loadCube(t,function(t){e(t)})},i.prototype.initDefaultLightMapTexture=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=32,t.height=32,e.fillStyle="rgb(51,51,51)",e.fillRect(0,0,32,32),this.defaultLightMap=l.Scene_data.context3D.getTexture(t)},i);function i(){var t=e.call(this)||this;return t._loadDic=new Object,t._resDic=new Object,t.initDefaultLightMapTexture(),t}l.TextureManager=t;var c=function(t,e,i,n,o,a){this.fun=t,this.info=e,this.url=i,this.wrap=n,this.filter=o,this.mipmap=a};l.TextureLoad=c;var n=(o.prototype.loadCube=function(t,e){var i=this;this.fun=e;for(var n=0;n<6;n++){var o=t+"0"+(n+1)+".jpg";l.LoadManager.getInstance().load(o,l.LoadManager.IMG_TYPE,function(t,e){i.loadCom(t,e)},{id:n})}},o.prototype.loadCom=function(t,e){var i=t.width/4,n=document.createElement("canvas"),o=n.getContext("2d");n.width=i,n.height=i;var a=l.Scene_data.context3D.renderContext,r=a.createTexture();a.bindTexture(a.TEXTURE_CUBE_MAP,r),o.drawImage(t,2*i,i,i,i,0,0,i,i),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),o.drawImage(t,0,i,i,i,0,0,i,i),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),o.drawImage(t,i,0,i,i,0,0,i,i),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),o.drawImage(t,i,2*i,i,i,0,0,i,i),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),o.drawImage(t,i,i,i,i,0,0,i,i),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),o.drawImage(t,3*i,i,i,i,0,0,i,i),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),this.ary[e.id]=r,this.flagNum++,6==this.flagNum&&this.fun(this.ary)},o);function o(){this.ary=new Array(6),this.flagNum=0}l.CubemapLoad=n}(tl3d=tl3d||{}),function(e){var t=(Object.defineProperty(i.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t,this.name="fc"+t,this.offset=4*t},enumerable:!0,configurable:!0}),i.prototype.creat=function(t){this.vecNum=t,this.vecNum[0+this.offset]=this.value.x,this.vecNum[1+this.offset]=this.value.y,this.vecNum[2+this.offset]=this.value.z,this.vecNum[3+this.offset]=this.value.w},i.prototype.setData=function(t){this.id=t.id,this.value=new e.Vector3D(t.value.x,t.value.y,t.value.z,t.value.w),this.paramName0=t.paramName0,this.param0Type=t.param0Type,this.param0Index=t.param0Index,this.paramName1=t.paramName1,this.param1Type=t.param1Type,this.param1Index=t.param1Index,this.paramName2=t.paramName2,this.param2Type=t.param2Type,this.param2Index=t.param2Index,this.paramName3=t.paramName3,this.param3Type=t.param3Type,this.param3Index=t.param3Index},i.prototype.setDynamicOffset=function(t){this.paramName0==t.paramName?t.targetOffset=this.param0Index+this.offset:this.paramName1==t.paramName?t.targetOffset=this.param1Index+this.offset:this.paramName2==t.paramName?t.targetOffset=this.param2Index+this.offset:this.paramName3==t.paramName&&(t.targetOffset=this.param3Index+this.offset)},i.prototype.setDynamicDirect=function(t,e){this.vecNum.set(t,e)},i.prototype.setDynamic=function(t){try{this.vecNum.set(t.currentValue,t.targetOffset)}catch(t){}},i);function i(){this.value=new e.Vector3D,this.offset=0}e.ConstItem=t}(tl3d=tl3d||{}),function(t){var e=(i.prototype.destory=function(){this.textureRes&&this.textureRes.clearUseNum()},Object.defineProperty(i.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t,this.name="fs"+t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"texture",{get:function(){return this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),i.LIGHTMAP=1,i.LTUMAP=2,i.CUBEMAP=3,i.HEIGHTMAP=4,i.REFRACTIONMAP=5,i);function i(){}t.TexItem=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=a.ResCount,__extends(i,e),i.prototype.update=function(t){this.updateTime(t),this.updateScene()},i.prototype.updateTime=function(t){this.hasTime&&(this.fcData[1]=t)},i.prototype.updateCam=function(t,e,i){if(this.usePbr||1==this.fogMode){var n=4*this.fcIDAry[0];this.fcData[0+n]=t,this.fcData[1+n]=e,this.fcData[2+n]=i}},i.prototype.updateScene=function(){if(this.sceneNumId!=a.Scene_data.sceneNumId){if(this.sceneNumId=a.Scene_data.sceneNumId,0!=this.fogMode){var t=4*this.fcIDAry[1];this.fcData[0+t]=a.Scene_data.fogColor[0],this.fcData[1+t]=a.Scene_data.fogColor[1],this.fcData[2+t]=a.Scene_data.fogColor[2]}this.scaleLightMap&&(t=4*this.fcIDAry[2],this.fcData[0+t]=a.Scene_data.scaleLight[0])}},i.prototype.initFcData=function(){if(this.fcData=new Float32Array(4*this.fcNum),!(this.fcNum<=0)){if(this.sceneNumId=a.Scene_data.sceneNumId,(this.hasTime||this.useKill||0!=this.fogMode)&&(this.useKill&&(this.fcData[0]=this.killNum),0!=this.fogMode&&(this.fcData[2]=a.Scene_data.fogData[0],this.fcData[3]=a.Scene_data.fogData[1])),this.usePbr||1==this.fogMode){var t=4*this.fcIDAry[0];this.fcData[0+t]=a.Scene_data.cam3D.x/100,this.fcData[1+t]=a.Scene_data.cam3D.y/100,this.fcData[2+t]=a.Scene_data.cam3D.z/100}0!=this.fogMode&&(t=4*this.fcIDAry[1],this.fcData[0+t]=a.Scene_data.fogColor[0],this.fcData[1+t]=a.Scene_data.fogColor[1],this.fcData[2+t]=a.Scene_data.fogColor[2]),this.scaleLightMap&&(t=4*this.fcIDAry[2],this.fcData[0+t]=a.Scene_data.scaleLight[0])}},i.prototype.setCompileData=function(t){if(t){if(this.shaderStr=t.shaderStr,this.hasTime=t.hasTime,this.timeSpeed=t.timeSpeed,this.blendMode=t.blendMode,this.backCull=t.backCull,this.killNum=t.killNum,this.hasVertexColor=t.hasVertexColor,this.usePbr=t.usePbr,this.useNormal=t.useNormal,this.roughness=t.roughness,this.writeZbuffer=t.writeZbuffer,this.hasFresnel=t.hasFresnel,this.useDynamicIBL=t.useDynamicIBL,this.normalScale=t.normalScale,this.lightProbe=t.lightProbe,this.useKill=t.useKill,this.directLight=t.directLight,this.noLight=t.noLight,this.scaleLightMap=t.scaleLightMap,this.fogMode=t.fogMode,this.hasParticleColor=!1,this.initFcData(),t.texList){var e=t.texList;this.texList=new Array;for(var i=0;i<e.length;i++){var n=new a.TexItem;n.id=e[i].id,n.url=e[i].url,n.isDynamic=e[i].isDynamic,n.paramName=e[i].paramName,n.isMain=e[i].isMain,n.isParticleColor=e[i].isParticleColor,n.type=e[i].type,n.wrap=e[i].wrap,n.filter=e[i].filter,n.mipmap=e[i].mipmap,this.texList.push(n),n.isParticleColor&&(this.hasParticleColor=!0)}}if(t.constList)for(e=t.constList,this.constList=new Array,i=0;i<e.length;i++){var o=new a.ConstItem;o.setData(e[i]),o.creat(this.fcData),this.constList.push(o)}}},i.prototype.setByteData=function(t){var e=t,i=e.readInt();if(this.shaderStr=e.readUTF(),this.hasTime=e.readBoolean(),this.timeSpeed=e.readFloat(),this.blendMode=e.readFloat(),this.backCull=e.readBoolean(),this.killNum=e.readFloat(),this.hasVertexColor=e.readBoolean(),this.usePbr=e.readBoolean(),this.useNormal=e.readBoolean(),this.roughness=e.readFloat(),this.writeZbuffer=e.readBoolean(),this.hasFresnel=e.readBoolean(),this.useDynamicIBL=e.readBoolean(),this.normalScale=e.readFloat(),this.lightProbe=e.readBoolean(),this.useKill=e.readBoolean(),this.directLight=e.readBoolean(),this.noLight=e.readBoolean(),this.scaleLightMap=e.readBoolean(),2<i&&(this.fogMode=e.readInt()),22<=i){this.fcNum=e.readByte();var n=e.readByte();this.fcIDAry=new Array;for(var o=0;o<n;o++)this.fcIDAry.push(e.readByte())}this.hasParticleColor=!1,this.initFcData(),this.readTexList(e),this.readConstLis(e)},i.prototype.readConstLis=function(t){var e=t.readInt();this.constList=new Array;for(var i=0;i<e;i++){var n=new a.ConstItem;n.id=t.readFloat(),n.value=new a.Vector3D(t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()),n.paramName0=t.readUTF(),n.param0Type=t.readFloat(),n.param0Index=t.readFloat(),n.paramName1=t.readUTF(),n.param1Type=t.readFloat(),n.param1Index=t.readFloat(),n.paramName2=t.readUTF(),n.param2Type=t.readFloat(),n.param2Index=t.readFloat(),n.paramName3=t.readUTF(),n.param3Type=t.readFloat(),n.param3Index=t.readFloat(),n.creat(this.fcData),this.constList.push(n)}},i.prototype.readTexList=function(t){var e=t.readInt();this.texList=new Array;for(var i=0;i<e;i++){var n=new a.TexItem;n.id=t.readFloat(),n.url=t.readUTF(),n.isDynamic=t.readBoolean(),n.paramName=t.readUTF(),n.isMain=t.readBoolean(),n.isParticleColor=t.readBoolean(),n.type=t.readFloat(),n.wrap=t.readFloat(),n.filter=t.readFloat(),n.mipmap=t.readFloat(),n.isParticleColor&&(this.hasParticleColor=!0),this.texList.push(n)}},i.prototype.destory=function(){for(var t=0;t<this.texList.length;t++)this.texList[t].destory();this.texList=null,this.constList=null,this.shader&&this.shader.clearUseNum()},i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.texList=new Array,t.constList=new Array,t.killNum=0,t.writeZbuffer=!0,t.fogMode=0,t.fcNum=0,t}a.Material=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=u.ResGC,__extends(i,e),i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.getMaterialByte=function(t,e,i,n,o,a){var r=this;if(void 0===i&&(i=null),void 0===n&&(n=!1),void 0===o&&(o=null),void 0===a&&(a=null),this._dic[t])return i?e(this._dic[t],i):e(this._dic[t]),void this._dic[t].useNum++;var s=new h(e,i,t,n,o,a);this._loadDic[t]?this._loadDic[t].push(s):(this._loadDic[t]=new Array,this._loadDic[t].push(s),this._resDic[t]?(this.meshByteMaterialByt(this._resDic[t],s),this._regDic[t]&&(this._dic[t].useNum+=this._regDic[t],delete this._regDic[t]),delete this._resDic[t]):u.LoadManager.getInstance().load(t,u.LoadManager.BYTE_TYPE,function(t,e){r.loadMaterialByteCom(t,e)},s))},i.prototype.meshByteMaterialByt=function(t,e){var i=new u.Material;i.setByteData(t),i.url=e.url,this.loadMaterial(i),e.autoReg&&(i.shader=u.ProgrmaManager.getInstance().getMaterialProgram(e.regName,e.shader3D,i,null,!0),i.program=i.shader.program);for(var n=this._loadDic[e.url],o=0;o<n.length;o++)n[o].info?n[o].fun(i,n[o].info):n[o].fun(i),i.useNum++;delete this._loadDic[e.url],this._dic[e.url]=i},i.prototype.loadMaterialByteCom=function(t,e){var i=new u.TLByteArray(t);this.meshByteMaterialByt(i,e)},i.prototype.addResByte=function(t,e){this._dic[t]||this._resDic[t]||(this._resDic[t]=e)},i.prototype.registerUrl=function(t){t=(t=t.replace("_byte.txt",".txt")).replace(".txt","_byte.txt"),this._dic[t]?this._dic[t].useNum++:this._regDic[t]?this._regDic[t]++:this._regDic[t]},i.prototype.releaseUrl=function(t){t=(t=t.replace("_byte.txt",".txt")).replace(".txt","_byte.txt"),this._dic[t]&&this._dic[t].clearUseNum()},i.prototype.loadMaterial=function(t){for(var e=t.texList,i=0;i<e.length;i++)e[i].isParticleColor||e[i].isDynamic||0!=e[i].type||u.TextureManager.getInstance().getTexture(u.Scene_data.fileRoot+e[i].url,function(t,e){e.textureRes=t},e[i].wrap,e[i],e[i].filter,e[i].mipmap)},i.prototype.loadDynamicTexUtil=function(t){for(var e=t.dynamicTexList,i=0;i<e.length;i++)e[i].isParticleColor?e[i].creatTextureByCurve():u.TextureManager.getInstance().getTexture(u.Scene_data.fileRoot+e[i].url,function(t,e){e.textureRes=t},0,e[i],0,1)},i);function i(){var t=e.call(this)||this;return t._loadDic=new Object,t._resDic=new Object,t._regDic=new Object,t}u.MaterialManager=t;var h=function(t,e,i,n,o,a){this.fun=t,this.info=e,this.url=i,this.autoReg=n,this.regName=o,this.shader3D=a}}(tl3d=tl3d||{}),function(t){var e=(i.prototype.update=function(t){void 0===t&&(t=0),this.target&&this.target.setDynamic(this)},Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t},enumerable:!0,configurable:!0}),i.prototype.setTargetInfo=function(t,e,i){this.target=t,this.paramName=e,this.type=i,this.target&&this.target.setDynamicOffset(this),this.currentValue=new Array(i)},i.prototype.setCurrentVal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i++)this.currentValue[i]=t[i]},i);function i(){}t.DynamicBaseConstItem=e}(tl3d=tl3d||{}),function(t){var e=(i.prototype.destory=function(){this.textureRes&&this.textureRes.useNum--,this.target=null},Object.defineProperty(i.prototype,"texture",{get:function(){return this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),i);function i(){}t.DynamicBaseTexItem=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(p){var t,e=(t=p.GC,__extends(i,t),i.prototype.destory=function(){for(var t=0;t<this.dynamicTexList.length;t++)this.dynamicTexList[t].destory();this.dynamicTexList=null,this.dynamicConstList=null},i.prototype.update=function(){if(this.material&&this.dynamicConstList)for(var t=0;t<this.dynamicConstList.length;t++)this.dynamicConstList[t].update()},i.prototype.setData=function(t,e){this.material=t,this.dynamicConstList=new Array,this.dynamicTexList=new Array;for(var i=t.constList,n=t.texList,o=0;o<e.length;o++){var a=e[o];if(0==a.type){var r=new p.DynamicBaseTexItem;r.paramName=a.name;for(var s=0;s<n.length;s++)if(r.paramName==n[s].paramName){r.target=n[s];break}var u=0;r.target&&(u=r.target.mipmap),u=0,p.TextureManager.getInstance().getTexture(p.Scene_data.fileRoot+a.url,function(t){r.textureRes=t},0,null,0,u),this.dynamicTexList.push(r)}else{var h=a.name,l=null;for(s=0;s<i.length;s++)if(h==i[s].paramName0||h==i[s].paramName1||h==i[s].paramName2||h==i[s].paramName3){l=i[s];break}var c=new p.DynamicBaseConstItem;c.setTargetInfo(l,h,a.type),1==a.type?c.setCurrentVal(a.x):2==a.type?c.setCurrentVal(a.x,a.y):c.setCurrentVal(a.x,a.y,a.z),this.dynamicConstList.push(c)}}},i);function i(){return null!==t&&t.apply(this,arguments)||this}p.MaterialBaseParam=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=o.MaterialBaseParam,__extends(i,t),i.prototype.destory=function(){this.material.useNum--,this.shader.useNum--,t.prototype.destory.call(this)},i.prototype.setMaterial=function(t){this.material=t,this.materialUrl=t.url,this.dynamicTexList=new Array,this.dynamicConstList=new Array,this.setTexList(),this.setConstList()},i.prototype.setLife=function(t){for(var e=0;e<this.dynamicTexList.length;e++)this.dynamicTexList[e].isParticleColor&&(this.dynamicTexList[e].life=t)},i.prototype.setTexList=function(){for(var t=this.material.texList,e=0;e<t.length;e++){var i;t[e].isParticleColor?((i=new o.DynamicTexItem).target=t[e],i.paramName=t[e].paramName,i.initCurve(4),this.dynamicTexList.push(i),i.isParticleColor=!0):t[e].isDynamic&&((i=new o.DynamicTexItem).target=t[e],i.paramName=t[e].paramName,this.dynamicTexList.push(i))}},i.prototype.setConstList=function(){for(var t=this.material.constList,e=0;e<t.length;e++){var i,n=t[e];0!=n.param0Type&&((i=new o.DynamicConstItem).setTargetInfo(n,n.paramName0,n.param0Type),this.dynamicConstList.push(i)),0!=n.param1Type&&((i=new o.DynamicConstItem).setTargetInfo(n,n.paramName1,n.param1Type),this.dynamicConstList.push(i)),0!=n.param2Type&&((i=new o.DynamicConstItem).setTargetInfo(n,n.paramName2,n.param2Type),this.dynamicConstList.push(i)),0!=n.param3Type&&((i=new o.DynamicConstItem).setTargetInfo(n,n.paramName3,n.param3Type),this.dynamicConstList.push(i))}},i.prototype.setTextObj=function(t){for(var e=0;e<t.length;e++)for(var i=t[e],n=0;n<this.dynamicTexList.length;n++)if(this.dynamicTexList[n].paramName==i.paramName){this.dynamicTexList[n].isParticleColor?this.dynamicTexList[n].curve.setData(i.curve):this.dynamicTexList[n].url=i.url;break}},i.prototype.setConstObj=function(t){for(var e=0;e<t.length;e++)for(var i=t[e],n=0;n<this.dynamicConstList.length;n++)if(this.dynamicConstList[n].paramName==i.paramName){this.dynamicConstList[n].curve.setData(i.curve);break}},i);function i(){return t.call(this)||this}o.MaterialParam=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=e.DynamicBaseConstItem,__extends(n,t),n.prototype.update=function(t){void 0===t&&(t=0),this.currentValue=this.curve.getValue(t),this.target.setDynamic(this)},Object.defineProperty(n.prototype,"type",{set:function(t){this._type=t,this.curve=new e.Curve,this.curve.type=t},enumerable:!0,configurable:!0}),n);function n(){return null!==t&&t.apply(this,arguments)||this}e.DynamicConstItem=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var t,e=(t=r.DynamicBaseTexItem,__extends(i,t),i.prototype.destory=function(){t.prototype.destory.call(this),this._textureDynamic&&r.Scene_data.context3D.deleteTexture(this._textureDynamic),this.target=null},i.prototype.initCurve=function(t){this.curve=new r.Curve,this.curve.type=t},Object.defineProperty(i.prototype,"texture",{get:function(){return this._textureDynamic?this._textureDynamic:this.textureRes?this.textureRes.texture:null},enumerable:!0,configurable:!0}),i.prototype.creatTextureByCurve=function(){var t=0,e=this.curve.valueVec.length-1,i=new Array;for(t=0;t<this.life;t++)if(t<this.curve.begintFrame)i.push(255*this.curve.valueVec[0][0],255*this.curve.valueVec[0][1],255*this.curve.valueVec[0][2],255*this.curve.valueVec[0][3]);else if(t>this.curve.maxFrame)0==this.curve.maxFrame&&this.curve.begintFrame<0?i.push(255,255,255,255):i.push(255*this.curve.valueVec[e][0],255*this.curve.valueVec[e][1],255*this.curve.valueVec[e][2],255*this.curve.valueVec[e][3]);else if(this.curve.begintFrame<0)i.push(255,255,255,255);else{var n=t-this.curve.begintFrame;i.push(255*this.curve.valueVec[n][0],255*this.curve.valueVec[n][1],255*this.curve.valueVec[n][2],255*this.curve.valueVec[n][3])}var o,a=r.UIManager.getInstance().getContext2D(64,2,!1);for(t=0;t<64;t++)o=4*Math.floor(t/64*this.life),a.fillStyle="rgba("+Math.floor(i[0+o])+","+Math.floor(i[1+o])+","+Math.floor(i[2+o])+","+Math.floor(i[3+o])/255+")",a.fillRect(t,0,1,2);this._textureDynamic=r.TextureManager.getInstance().getCanvasTexture(a).texture},Object.defineProperty(i.prototype,"life",{get:function(){return this._life},set:function(t){this._life=t},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}r.DynamicTexItem=e}(tl3d=tl3d||{}),function(u){var t=(e.prototype.testViewFrustum=function(t,e){if(this.sun&&1==this.sun.length)this.sun[0].testViewFrustum(t,e);else if(this.testViewFrustumResult(t)&&(this.target&&(this.target.isPerspective&&this.testRay(e)||(this.target.sceneVisible=!0)),this.sun))for(var i=0;i<this.sun.length;i++)this.sun[i].testViewFrustum(t,e)},e.prototype.testViewFrustumResult=function(t){for(var e=new u.Vector3D(this.x,this.y,this.z),i=new u.Vector3D(this.width,this.height,this.depth),n=!0,o=0;o<t.length;o++){var a=e,r=e.add(i),s=new u.Vector3D;if(0<t[o].x?s.x=r.x:s.x=a.x,0<t[o].y?s.y=r.y:s.y=a.y,0<t[o].z?s.z=r.z:s.z=a.z,t[o].dot(s)+t[o].w<0){n=!1;break}}return n},e.prototype.testRay=function(t){var e,i,n,o,a,r,s=t.o.x,u=t.o.y,h=t.o.z,l=t.d.x,c=t.d.y,p=t.d.z,d=this.x,_=this.y,f=this.z,g=this.x+this.width,y=this.y+this.height,m=this.z+this.depth,v=1/l;o=0<=v?(e=(d-s)*v,(g-s)*v):(e=(g-s)*v,(d-s)*v);var b=1/c;a=0<=b?(i=(_-u)*b,(y-u)*b):(i=(y-u)*b,(_-u)*b);var I,T,w=1/p;return r=0<=w?(n=(f-h)*w,(m-h)*w):(n=(m-h)*w,(f-h)*w),(I=i<e?e:i)<n&&(I=n),r<(T=o<a?o:a)&&(T=r),I<T&&1e-4<T&&((1e-4<I?I:T)<t.baseT||void 0)},e);function e(t,e,i,n,o,a){this.x=t,this.y=e,this.z=i,this.width=n,this.height=o,this.depth=a}u.QuadTreeNode=t;var i=(n.prototype.setPos=function(t,e,i){this.o.x=t,this.o.y=e,this.o.z=i},n.prototype.setTarget=function(t,e,i){this.d.x=t-this.o.x,this.d.y=e-this.o.y,this.d.z=i-this.o.z,this.d.normalize()},n);function n(){this.o=new u.Vector3D,this.d=new u.Vector3D,this.baseT=500}u.Ray=i}(tl3d=tl3d||{}),function(p){var t=(e.prototype.init=function(t,e){this._circle=new p.Circle(1e4,1e4),this._sceneDic=e,this._rootNode=this.getNode(t),this._ray=new p.Ray},e.prototype.getNode=function(t){var e=new p.QuadTreeNode(t.x,t.y,t.z,t.width,t.height,t.depth);if(t.data){e.sun||(e.sun=new Array);for(var i=0;i<t.data.length;i++){var n,o=new p.QuadTreeNode(t.data[i].x,t.data[i].y,t.data[i].z,t.data[i].width,t.data[i].height,t.data[i].depth);1==t.data[i].type?n="build"+t.data[i].id:11==t.data[i].type?n="particle"+t.data[i].id:14==t.data[i].type&&(n="ground"+t.data[i].id),o.target=this._sceneDic[n],o.target.aabb=o,e.sun.push(o)}}if(t.sun)for(e.sun||(e.sun=new Array),i=0;i<t.sun.length;i++)e.sun.push(this.getNode(t.sun[i]));return e},e.prototype.setCircle=function(t,e,i){var n=t-this._circle.x,o=e-this._circle.y;Math.sqrt(n*n+o*o)<10?this.needUpdata=!1:(this._circle.setData(t,e,i),this.needUpdata=!0)},e.prototype.update=function(){p.MathClass.GetViewHitBoxDataCopy(p.Scene_data.cam3D.distance);var t=new p.Vector3D(p.Scene_data.cam3D.x,p.Scene_data.cam3D.y,p.Scene_data.cam3D.z),e=p.MathClass.viewBoxVecItem;this.panleAry.length=0,this.panleAry.push(this.getPanelByVec(t,e[0],e[1])),this.panleAry.push(this.getPanelByVec(t,e[1],e[2])),this.panleAry.push(this.getPanelByVec(t,e[2],e[3])),this.panleAry.push(this.getPanelByVec(t,e[3],e[0])),this._ray.setPos(p.Scene_data.cam3D.x,p.Scene_data.cam3D.y,p.Scene_data.cam3D.z),this._ray.setTarget(p.Scene_data.focus3D.x,p.Scene_data.focus3D.y,p.Scene_data.focus3D.z),this._ray.baseT=p.Scene_data.cam3D.distance,this._rootNode.testViewFrustum(this.panleAry,this._ray)},e.prototype.getPanelByVec=function(t,e,i){var n=e.subtract(t),o=i.subtract(t);return(n=n.cross(o)).normalize(),n.w=-n.dot(t),n},e.prototype.updateDraw=function(){this.capsuleLineSprite?(this.capsuleLineSprite.x=p.Scene_data.focus3D.x,this.capsuleLineSprite.y=p.Scene_data.focus3D.y+50,this.capsuleLineSprite.z=p.Scene_data.focus3D.z,this.capsuleLineSprite.update()):(this.capsuleLineSprite=new p.LineDisplaySprite,this.capsuleLineSprite.clear(),this.capsuleLineSprite.baseColor=new p.Vector3D(1,0,0,1),this.drawCylinder(this._circle.radius,10),this.capsuleLineSprite.upToGpu())},e.prototype.drawCylinder=function(t,e){var i,n,o,a=t,r=e;for(o=0;o<12;o++){var s=new p.Vector3D(a,0,0),u=new p.Vector3D(a,+r,0),h=new p.Matrix3D;h.appendRotation(30*o,p.Vector3D.Y_AXIS);var l=h.transformVector(s),c=h.transformVector(u);this.capsuleLineSprite.makeLineMode(l,c),this.capsuleLineSprite.makeLineMode(c,new p.Vector3D(0,+r,0)),11==o&&(this.capsuleLineSprite.makeLineMode(l,s),this.capsuleLineSprite.makeLineMode(c,u)),(i||n)&&(this.capsuleLineSprite.makeLineMode(l,i),this.capsuleLineSprite.makeLineMode(c,n)),i=l.clone(),n=c.clone()}},e);function e(){this.needUpdata=!1,this.panleAry=new Array}p.SceneQuadTree=t}(tl3d=tl3d||{}),function(c){var t=(Object.defineProperty(e.prototype,"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayRoleList",{get:function(){return this._displayRoleList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displaySpriteList",{get:function(){return this._displaySpriteList},enumerable:!0,configurable:!0}),e.prototype.testUrl=function(t){return this._currentUrl==t},e.prototype.loadScene=function(t,e,i,n){var o=this;if(this._currentUrl==t)return this._ready=!0,e(),void n();this.clearStaticScene(),this._ready=!1,c.SceneResManager.getInstance().loadSceneRes(t,e,i,function(t){o.loadSceneConfigCom(t),n()}),this._currentUrl=t},e.prototype.addSceneImgBg=function(t){var e=new c.Display3dBg;e.setImgInfo(t.url,t.width,t.height),this.addDisplay(e)},e.prototype.getDisplayByID=function(t,e){return 0==t?this._sceneDic["build"+e]:1==t?this._sceneDic["particle"+e]:void 0},e.prototype.fixAstart=function(t){for(var e=0;e<this._displayRoleList.length;e++)this._displayRoleList[e].fixAstartData(t)},e.prototype.loadSceneConfigCom2=function(t){this._sceneDic=new Object;var e=t.groundItem,i=t.buildItem;c.Scene_data.fogColor=[t.fogColor.x/255,t.fogColor.y/255,t.fogColor.z/255];var n=+t.fogDistance,o=t.fogAttenuation;c.Scene_data.gameAngle=isNaN(t.gameAngle)?0:t.gameAngle,c.Scene_data.focus3D.rotationY=c.Scene_data.gameAngle,c.Scene_data.fogData=[n*o,1/((1-o)*n)],c.Scene_data.sceneNumId++;for(var a=0;e&&a<e.length;a++){var r=this.getGroundSprite(e[a],t.terrain);this.addDisplay(r)}for(var s=0;s<i.length;s++){var u=i[s];if(u.type==c.BaseRes.PREFAB_TYPE){var h=this.getBuildSprite(u);this.addDisplay(h)}else if(u.type==c.BaseRes.SCENE_PARTICLE_TYPE){var l=this.getParticleSprite(u);this.addParticle(l)}}c.Scene_data.light.setData(t.SunNrm,t.SunLigth,t.AmbientLight),c.LightProbeManager.getInstance().setLightProbeData(t.lightProbeItem),this._ready=!0,t.quadTreeData?(this._sceneQuadTree=new c.SceneQuadTree,this._sceneQuadTree.init(t.quadTreeData,this._sceneDic)):this._sceneQuadTree=null},e.prototype.getGroundSprite=function(t,e){var i=new c.TerrainDisplay3DSprite;return i.setObjUrl(t.objsurl),i.setMaterialUrl(t.materialurl,t.materialInfoArr),i.materialInfoArr=t.materialInfoArr,i.setLightMapUrl(t.lighturl),i.scaleX=t.scaleX,i.scaleY=t.scaleY,i.scaleZ=t.scaleZ,i.x=t.x,i.y=t.y,i.z=t.z,i.rotationX=t.rotationX,i.rotationY=t.rotationY,i.rotationZ=t.rotationZ,i.objData.lightuvsOffsets=i.objData.uvsOffsets,e&&i.setGrounDataMesh(e[t.id]),this._sceneDic["ground"+t.id]=i},e.prototype.makeCollisioin=function(t){},Object.defineProperty(e.prototype,"ready",{get:function(){return this._ready},set:function(t){this._ready=t},enumerable:!0,configurable:!0}),e.prototype.getBuildSprite=function(t){var e=new c.Display3DSprite;return e.setObjUrl(t.objsurl),e.setMaterialUrl(t.materialurl,t.materialInfoArr),e.materialInfoArr=t.materialInfoArr,e.setLightMapUrl(t.lighturl),e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.scaleZ=t.scaleZ,e.x=t.x,e.y=t.y,e.z=t.z,e.rotationX=t.rotationX,e.rotationY=t.rotationY,e.rotationZ=t.rotationZ,e.isPerspective=t.isPerspective,e.type=0,e.id=t.id,this._sceneDic["build"+t.id]=e},e.prototype.getParticleSprite=function(t){var e;return(e=c.ParticleManager.getInstance().getParticleByte(c.Scene_data.fileRoot+t.url)).scaleX=t.scaleX,e.scaleY=t.scaleY,e.scaleZ=t.scaleZ,e.x=t.x,e.y=t.y,e.z=t.z,e.rotationX=t.rotationX,e.rotationY=t.rotationY,e.rotationZ=t.rotationZ,e.type=0,this._sceneDic["particle"+t.id]=e},e.prototype.initScene=function(){},e.prototype.addDisplay=function(t){-1==this._displayList.indexOf(t)&&(this._displayList.push(t),t.addStage())},e.prototype.removeDisplay=function(t){var e=this._displayList.indexOf(t);-1!=e&&this._displayList.splice(e,1),t.removeStage()},e.prototype.addSpriteDisplay=function(t){if(-1==this._displaySpriteList.indexOf(t)){t.addStage();for(var e=0;e<this._displaySpriteList.length;e++)if(this._displaySpriteList[e].materialUrl==t.materialUrl)return void this._displaySpriteList.splice(e,0,t);this._displaySpriteList.push(t)}},e.prototype.removeSpriteDisplay=function(t){var e=this._displaySpriteList.indexOf(t);-1!=e&&this._displaySpriteList.splice(e,1),t.removeStage()},e.prototype.addMovieDisplayTop=function(t){this._displayRoleList.unshift(t),t.addStage()},e.prototype.setParticleVisible=function(){for(var t=this._particleList,e=0;t&&e<t.length;e++)if(!t[e].dynamic&&t[e].bindVecter3d){var i=c.Vector3D.distance(new c.Vector3D(c.Scene_data.focus3D.x,c.Scene_data.focus3D.y,c.Scene_data.focus3D.z),new c.Vector3D(t[e].x,t[e].y,t[e].z));t[e].sceneVisible=i<1e3}},e.prototype.upFrame=function(){c.Scene_data.context3D._contextSetTest.clear(),isNaN(this._time)&&(this._time=c.TimeUtil.getTimer(this.startTime)),this.updateMovieFrame(),this._ready&&(this.updateParticleTime(),this.skillMgr.update(),this.render&&(c.Scene_data.context3D.setWriteDepth(!0),c.Scene_data.context3D.setDepthTest(!0),this.updateStaticDiplay(),this.updateSpriteDisplay(),this.updateMovieDisplay(),this.shadowMgr.update(),c.Scene_data.context3D.setWriteDepth(!1),this.updateParticles(),this.bloodMgr&&this.bloodMgr.update(),c.Scene_data.context3D.setBlendParticleFactors(0),c.Scene_data.context3D.setWriteDepth(!0),c.Scene_data.context3D.setWriteDepth(!1)),c.Scene_data.context3D.setDepthTest(!1),c.UIManager.getInstance().update(),this.cameraMatrix=c.Scene_data.cam3D.cameraMatrix.clone(),this.viewMatrx3D=c.Scene_data.viewMatrx3D.clone())},e.prototype.updateFBO=function(){c.Scene_data.fbo||(c.Scene_data.fbo=c.Scene_data.context3D.getFBO()),0!=this._displayList.length&&(c.Scene_data.context3D.updateFBO(c.Scene_data.fbo),c.Scene_data.viewMatrx3D.identity(),c.Scene_data.context3D.renderContext.viewport(0,0,c.FBO.fw,c.FBO.fh),c.Scene_data.viewMatrx3D.perspectiveFieldOfViewLH(2,1,50,c.Scene_data.camFar),c.Scene_data.viewMatrx3D.appendScale(2,c.Scene_data.stageWidth/c.Scene_data.stageHeight*2,1),c.MathClass.updateVp(),this.updateStaticDiplay(),c.Engine.resetSize(),c.Scene_data.context3D.renderContext.bindFramebuffer(c.Scene_data.context3D.renderContext.FRAMEBUFFER,null))},e.prototype.addDisplay2DList=function(t){this._display2DList.push(t)},e.prototype.mathCamFar=function(){for(var t=new c.Vector3D,e=0,i=0;i<this._displayList.length;i++){var n=this._displayList[i];if(n.sceneVisible&&n.aabb){n.posMatrix.clone().append(c.Scene_data.cam3D.cameraMatrix);for(var o=n.aabbVect,a=0;a<o.length;a++)(t=c.Scene_data.cam3D.cameraMatrix.transformVector(o[a])).z>e&&(e=t.z)}}c.Scene_data.camFar=Math.max(500,e+100),c.Engine.resetViewMatrx3D()},e.prototype.updateStaticDiplay=function(){for(var t=0;t<this._displayList.length;t++)this._displayList[t].update()},e.prototype.updateStaticBind=function(){},e.prototype.updateSpriteDisplay=function(){for(var t=0;t<this._displaySpriteList.length;t++)this._displaySpriteList[t].update()},e.prototype.updateMovieDisplay=function(){for(var t=0;t<this._displayRoleList.length;t++)this._displayRoleList[t].update()},e.prototype.updateMovieFrame=function(){var t=c.TimeUtil.getTimer(this.startTime),e=t-this._time;this._time=t;for(var i=0;i<this._displayRoleList.length;i++)this._displayRoleList[i].updateFrame(e)},e.prototype.changeBloodManager=function(t){this.bloodMgr=t},e.prototype.addMovieDisplay=function(t){(t._scene=this)._displayRoleList.push(t),t.addStage()},e.prototype.loadSceneConfigCom=function(t){c.Scene_data.focus3D.rotationY,this.loadSceneConfigCom2(t),c.Scene_data.focus3D.rotationY=c.Scene_data.focus3D.rotationY},e.prototype.clearStaticScene=function(){for(var t in this._sceneDic){var e=this._sceneDic[t];e instanceof c.CombineParticle&&this.removeParticle(e),e instanceof c.Display3DSprite&&(e.removeStage(),e.destory())}this._ready=!1,this._sceneDic=null,this._sceneQuadTree=null,this._displayList.length=0,this.removeAllMovieDisplay(),this._displayRoleList.length=0,this.clearAllParticle(),this._currentUrl=""},e.prototype.playLyf=function(t,o,a,r){var s=this;void 0===a&&(a=20),void 0===r&&(r=1),this.groupDataMgr.getGroupData(c.Scene_data.fileRoot+t,function(t){for(var e=0;e<t.dataAry.length;e++){var i=t.dataAry[e];if(i.types==c.BaseRes.SCENE_PARTICLE_TYPE){var n=c.ParticleManager.getInstance().getParticleByte(c.Scene_data.fileRoot+i.particleUrl);n.x=o.x,n.y=o.y,n.z=o.z,n.rotationX=a,n.scaleX=r,n.scaleY=r,n.scaleZ=r,s.addParticle(n),n.addEventListener(c.BaseEvent.COMPLETE,s.onPlayCom,s)}else console.log("播放的不是单纯特效")}})},e.prototype.charPlaySkill=function(t,e,i,n){if(void 0===i&&(i="skill_01"),void 0===n&&(n=null),t._scene.ready){var o=this.skillMgr.getSkill(getSkillUrl(e),i);if(o.keyAry)return o&&(o.reset(),o.isDeath=!1),o.configFixEffect(t,n),this.skillMgr.playSkill(o),o}},e.prototype.removeCharSkill=function(t){t.removeSkillForce()},e.prototype.removeAllMovieDisplay=function(){for(;0<this._displayRoleList.length;){var t=this._displayRoleList.splice(0,1);t[0].removeStage(),t[0].destory()}},e.prototype.removeMovieDisplay=function(t){if(t){var e=this._displayRoleList.indexOf(t);-1!=e&&this._displayRoleList.splice(e,1),t.removeStage()}},e.prototype.onPlayCom=function(t){this.removeParticle(t.target)},e.prototype.updateParticles=function(){this.updateRenderDic(),this.clearPaticleVa()},e.prototype.clearPaticleVa=function(){c.Scene_data.context3D.clearVa(2),c.Scene_data.context3D.clearVa(3),c.Scene_data.context3D.clearVa(4),c.Scene_data.context3D.clearVa(5)},e.prototype.setParticleHide=function(){for(var t=0;t<this._particleList.length;t++)this._particleList[t].dynamic},Object.defineProperty(e.prototype,"particleList",{get:function(){return this._particleList},enumerable:!0,configurable:!0}),e.prototype.updateParticleTime=function(){var t=c.TimeUtil.getTimer(this.startTime);0==this._particletime&&(this._particletime=t);var e=t-this._particletime;this._particletime=t;for(var i=0;i<this._particleList.length;i++)this._particleList[i].sceneVisible&&this._particleList[i].updateTime(e)},e.prototype.addRenderDic=function(t){var e=t.url;this.renderDic[e]||(this.renderDic[e]=new Array),this.renderDic[e].push(t)},e.prototype.removeRenderDic=function(t){var e=t.url,i=this.renderDic[e].indexOf(t);-1!=i&&(this.renderDic[e].splice(i,1),0==this.renderDic[e].length&&delete this.renderDic[e])},e.prototype.updateRenderDic=function(){for(var t in this.renderDic){var e=this.renderDic[t];if(1==e.length)e[0].update();else for(var i=e[0].size,n=0;n<i;n++)for(var o=0;o<e.length;o++)e[o].updateItem(n)}},e.prototype.addParticle=function(t){-1==this._particleList.lastIndexOf(t)&&(this._particleList.push(t),this.addRenderDic(t))},e.prototype.removeParticle=function(t){var e=this._particleList.indexOf(t);-1!=e&&(this._particleList.splice(e,1),this.removeRenderDic(t),t.reset())},e.prototype.clearAllParticle=function(){for(this._particletime=0;this._particleList&&0<this._particleList.length;){var t=this._particleList.pop();this.removeRenderDic(t),t.reset()}},e);function e(){this._ready=!1,this.render=!0,this._particletime=0,this.renderDic=new Object,this._displayList=new Array,this._displaySpriteList=new Array,this._displayRoleList=new Array,this._display2DList=new Array,this.startTime=c.TimeUtil.START_TIME,this._time=c.TimeUtil.getTimer(this.startTime),this._sceneDic=new Object,this.initScene(),this._particleList=new Array,this.shadowMgr=new c.ShadowManager,this.skillMgr=new c.SkillManager(this),this.groupDataMgr=new c.GroupDataManager(this)}c.SceneManager=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var i,t=(i=h.ResGC,__extends(e,i),e.prototype.update=function(){for(var t=h.TimeUtil.getTimer(this.scene?this.scene.startTime:h.TimeUtil.START_TIME),e=t-this._time,i=0;i<this._skillAry.length;i++)this._skillAry[i].update(e);this._time=t},e.prototype.preLoadSkill=function(i,t){var n=this;void 0===t&&(t=null),this._callBack=t,this._dic[i]||this._preLoadDic[i]?this._callBack&&(this._callBack.call(null),this._callBack=null):(this.loadSkillRes(h.Scene_data.fileRoot+i,function(t){var e=new h.SkillData(n);e.data=t.data,e.useNum++,n._dic[i]=e,n.addSrc(i,e),n._callBack&&(n._callBack.call(null),n._callBack=null)}),this._preLoadDic[i]=!0)},e.prototype.loadSkillRes=function(t,e){var i=new h.SkillRes;i.load(t,function(){e(i)})},e.prototype.getSkill=function(e,t,i){var n,o=this;void 0===i&&(i=null);var a,r=e+t,s=this._skillDic[r];if(s)for(var u=0;u<s.length;u++)if((n=s[u]).isDeath&&0==n.useNum)return n.reset(),n.isDeath=!1,n;return(n=new h.Skill(this)).name=t,n.isDeath=!1,this._skillDic[r]||(this._skillDic[r]=new Array),this._skillDic[r].push(n),this._dic[e]?(n.setData(this._dic[e].data[n.name],this._dic[e]),n.key=r,this._dic[e].useNum++):this._loadDic[e]?((a=new Object).name=t,a.skill=n,a.callback=i,this._loadDic[e].push(a)):(this._loadDic[e]=new Array,(a=new Object).name=t,a.skill=n,a.callback=i,this._loadDic[e].push(a),this.loadSkillRes(h.Scene_data.fileRoot+e,function(t){o.loadSkillCom(e,t)})),n},e.prototype.loadSkillCom=function(t,e){var i=new h.SkillData(this);i.data=e.data;for(var n=0;n<this._loadDic[t].length;n++)(o=this._loadDic[t][n]).skill.hasDestory||(o.skill.setData(i.data[o.name],i),o.skill.key=t+o.name,i.useNum++);for(this._dic[t]=i,this.addSrc(t,i),n=0;n<this._loadDic[t].length;n++){var o;(o=this._loadDic[t][n]).callback&&o.callback()}this._loadDic[t].length=0,this._loadDic[t]=null},e.prototype.addSrc=function(t,e){for(var i in e.data){var n=new h.Skill(this);n.name=i,n.isDeath=!0,n.src=!0,n.setData(e.data[i],e),e.addSrcSkill(n);var o=t+i;this._skillDic[o]||(this._skillDic[o]=new Array),this._skillDic[o].push(n)}},e.prototype.playSkill=function(t){this._skillAry.push(t),t.play()},e.prototype.removeSkill=function(t){var e=this._skillAry.indexOf(t);-1!=e&&this._skillAry.splice(e,1)},e.prototype.gcSkill=function(t){for(var e in this._skillDic){var i=this._skillDic[e],n=i.indexOf(t);-1!=n&&i.splice(n,1)}},e.prototype.gc=function(){var t=[];for(var e in this._dic){var i=this._dic[e];t.push(e),i.useNum<=0&&(i.idleTime++,i.idleTime>=h.ResCount.GCTime&&i.testDestory()&&(i.destory(),delete this._dic[e]))}for(var e in this._skillDic){for(var n=this._skillDic[e],o=n.length-1;0<=o;o--)n[o].isDeath&&n[o].useNum<=0&&(n[o].idleTime++,n[o].idleTime>=h.ResCount.GCTime&&(n[o].src||(n[o].destory(),n.splice(o,1))));0==n.length&&delete this._skillDic[e]}},Object.defineProperty(e.prototype,"shock",{get:function(){return this._shock||(this._shock=new n),this._shock},enumerable:!0,configurable:!0}),e);function e(t){var e=i.call(this)||this;return e._time=0,e.scene=t,e._skillDic=new Object,e._loadDic=new Object,e._skillAry=new Array,e._preLoadDic=new Object,e}h.SkillManager=t;var n=(o.prototype.update=function(t){if(this.ctime+=t,this.ctime>this.time)return h.TimeUtil.removeFrameTick(this.upFun),void h.Scene_data.cam3D.offset.setTo(0,0,0);var e=(Math.random()-.5)*this.amp,i=(Math.random()-.5)*this.amp,n=(Math.random()-.5)*this.amp;h.Scene_data.cam3D.offset.setTo(e,i,n)},o.prototype.shock=function(t,e){this.time=t,this.ctime=0,this.amp=e,h.TimeUtil.addFrameTick(this.upFun)},o.prototype.clearShock=function(){h.TimeUtil.removeFrameTick(this.upFun)},o);function o(){var e=this;this.upFun=function(t){e.update(t)}}h.ShockUtil=n}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var i,t=(i=s.ResCount,__extends(e,i),e.prototype.setData=function(t,e){this.hasDestory||(this.skillVo=new s.SkillVo,this.skillVo.setData(t),this.setKeyAry(),this.trajectoryAry=new Array,this._skillData=e)},e.prototype.getBloodTime=function(){return this.skillVo?this.skillVo.bloodTime:s.SkillVo.defaultBloodTime},e.prototype.play=function(){this.skillVo?this.active&&this.active instanceof s.Display3dMovie&&this.active.play(this.skillVo.action,this.actionEnd?1:2,!1):this.skillComplete()},e.prototype.setKeyAry=function(){var e=this;if(this.keyAry=new Array,this.skillVo.types==s.SkillType.FixEffect)for(var t=0;t<this.skillVo.keyAry.length;t++){var i=new s.SkillFixEffect(this);i.setInfo(this.skillVo.keyAry[t]),i.removeCallFun=function(t){e.removeKey(t)},i.active=this.active,this.keyAry.push(i)}else if(this.skillVo.types==s.SkillType.TrajectoryDynamicTarget||this.skillVo.types==s.SkillType.TrajectoryDynamicPoint)for(t=0;t<this.skillVo.keyAry.length;t++){var n;(n=1==this.skillVo.keyAry[t].multype?new s.SkillMulTrajectory(this.skillMgr):new s.SkillTrajectory(this.skillMgr)).setInfo(this.skillVo.keyAry[t]),this.keyAry.push(n)}},e.prototype.removeKey=function(t){this.completeNum++,this.completeNum==this.keyAry.length&&this.skillComplete()},e.prototype.removeSkillForce=function(){if(this.keyAry)for(var t=0;t<this.keyAry.length;t++)this.keyAry[t].reset();this.skillComplete(),this.reset()},e.prototype.skillComplete=function(){this.skillMgr.removeSkill(this),this.isDeath=!0,this.completeFun&&this.completeFun(),this.idleTime=0},e.prototype.reset=function(){this.time=0,this.completeNum=0,this.active=null,this.completeFun=null,this.targetFlag=0,this.targetShockFlag=0,this.soundPlay=!1,this.needSound=!0,this.needShock=!0},e.prototype.update=function(t){this.time+=t,this.time>e.MaxTime&&this.skillComplete(),this.getKeyTarget(),this.getShockTarget(),this.updateTrajector(t)},e.prototype.updateTrajector=function(t){for(var e=0;e<this.trajectoryAry.length;e++)this.trajectoryAry[e].update(t)},e.prototype.getKeyTarget=function(){if(this.keyAry){for(var t=this.targetFlag;t<this.keyAry.length&&this.keyAry[t].time<this.time;t++){if(this.keyAry[t].addToRender(),this.skillVo.types==s.SkillType.TrajectoryDynamicTarget||this.skillVo.types==s.SkillType.TrajectoryDynamicPoint){var e=this.keyAry[t];this.trajectoryAry.push(e)}t++,this.targetFlag=t}this.getSound()}},e.prototype.getShockTarget=function(){if(this.skillVo.shockAry&&this.needShock)for(var t=this.targetShockFlag;t<this.skillVo.shockAry.length&&this.skillVo.shockAry[t].time<this.time;t++)this.skillMgr.shock.shock(this.skillVo.shockAry[t].lasttime,this.skillVo.shockAry[t].amp),this.targetShockFlag=t+1},e.prototype.getSound=function(){this.skillVo.sound&&!this.soundPlay&&this.needSound&&this.skillVo.sound.frame<this.time&&(AudioMgr.playSound("skill/sound/"+this.skillVo.sound.url),this.soundPlay=!0)},e.prototype.configFixEffect=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),this.active=t,this.completeFun=e,this.keyAry)for(var n=0;n<this.keyAry.length;n++)if(this.skillVo.types==s.SkillType.FixEffect){var o=this.keyAry[n];o.active=t,i&&i.length?n>i.length-1?o.outPos=i[i.length-1]:o.outPos=i[n]:o.outPos=null}},e.prototype.configTrajectory=function(t,e,i,n,o){var a=this;if(void 0===i&&(i=null),void 0===n&&(n=0),void 0===o&&(o=null),this.active=t,this.completeFun=i,this.completeNum=0,this.keyAry)for(var r=0;r<this.keyAry.length;r++)this.skillVo.types!=s.SkillType.TrajectoryDynamicTarget&&this.skillVo.types!=s.SkillType.TrajectoryDynamicPoint||this.keyAry[r].setPlayData(t,e,function(t){a.removeTrajectory(t)},n,0==r?o:null)},e.prototype.configMulTrajectory=function(t,e,i,n){var o=this;if(void 0===n&&(n=null),this.active=e,this.completeFun=n,this.completeNum=0,this.keyAry)for(var a=0;a<this.keyAry.length;a++)this.skillVo.types==s.SkillType.TrajectoryDynamicTarget&&this.keyAry[a].setMulPlayData(t,i,function(t){o.removeTrajectory(t)},2)},e.prototype.removeTrajectory=function(t){var e=this.trajectoryAry.indexOf(t);-1!=e&&this.trajectoryAry.splice(e,1),this.completeNum++,this.completeNum==this.keyAry.length&&this.skillComplete()},e.prototype.destory=function(){if(this.skillVo=null,this.name=null,this.keyAry){for(var t=0;t<this.keyAry.length;t++)this.keyAry[t].destory();this.keyAry.length=0,this.keyAry=null}if(this.active=null,this.completeFun=null,this.trajectoryAry){for(t=0;t<this.trajectoryAry.length;t++)this.trajectoryAry[t].destory();this.trajectoryAry.length=0,this.trajectoryAry=null}this._skillData&&this._skillData.useNum--,this._skillData=null,this.hasDestory=!0},e.MaxTime=5e3,e);function e(t){var e=i.call(this)||this;return e.isDeath=!0,e.src=!1,e.time=0,e.targetFlag=0,e.targetShockFlag=0,e.needSound=!1,e.needShock=!1,e.hasDestory=!1,e.actionEnd=!1,e.skillMgr=t,e}s.Skill=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=i.ResCount,__extends(e,n),e.prototype.addSrcSkill=function(t){this.srcList.push(t)},e.prototype.destory=function(){for(var t=0;t<this.srcList.length;t++){var e=this.srcList[t];e.destory(),this.skillMgr.gcSkill(e)}},e.prototype.testDestory=function(){for(var t=0;t<this.srcList.length;t++){var e=this.srcList[t];if(!(e.isDeath&&e.idleTime>=i.ResCount.GCTime))return!1}return!0},e);function e(t){var e=n.call(this)||this;return e.srcList=new Array,e.skillMgr=t,e}i.SkillData=t}(tl3d=tl3d||{}),function(o){var t=(e.prototype.setData=function(t){this.keyAry=new Array,this.action=t.action,this.skillname=t.skillname,this.bloodTime=t.blood,this.types=t.type,this.types==i.FixEffect?this.keyAry=this.getFixEffect(t.data):this.types!=i.TrajectoryDynamicTarget&&this.types!=i.TrajectoryDynamicPoint||(this.keyAry=this.getTrajectoryDynamicTarget(t.data)),t.sound&&(this.sound=new o.SkillKeyVo,this.sound.frame=t.sound.time*o.Scene_data.frameTime,this.sound.url=t.sound.name),t.shock&&(this.shockAry=this.getShockAry(t.shock))},e.prototype.getShockAry=function(t){for(var e=new Array,i=0;i<t.length;i++){var n=new o.SkillShockVo;n.setData(t[i]),e.push(n)}return e},e.prototype.getFixEffect=function(t){for(var e=new Array,i=0;i<t.length;i++){var n=new o.SkillFixEffectKeyVo;n.setData(t[i]),e.push(n)}return e},e.prototype.getTrajectoryDynamicTarget=function(t){for(var e=new Array,i=0;i<t.length;i++){var n=new o.SkillTrajectoryTargetKeyVo;n.setData(t[i]),e.push(n)}return e},e.defaultBloodTime=250,e);function e(){}o.SkillVo=t;var i=(n.TrajectoryDynamicTarget=1,n.FixEffect=4,n.TrajectoryDynamicPoint=3,n);function n(){}o.SkillType=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t=(i.prototype.setData=function(t){this.frame=t.frame,this.url=t.url},i);function i(){this.frame=0}e.SkillKeyVo=t;var n=(o.prototype.setData=function(t){this.time=t.time*e.Scene_data.frameTime,this.lasttime=t.lasttime*e.Scene_data.frameTime,this.amp=t.amp},o);function o(){}e.SkillShockVo=n;var a,r=(__extends(s,a=t),s.prototype.setData=function(t){a.prototype.setData.call(this,t),this.hasSocket=t.hasSocket,this.hasSocket?this.socket=t.socket:(this.pos=new e.Vector3D(t.pos.x,t.pos.y,t.pos.z),this.rotation=new e.Vector3D(t.rotation.x,t.rotation.y,t.rotation.z))},s);function s(){return null!==a&&a.apply(this,arguments)||this}e.SkillFixEffectKeyVo=r;var u,h=(__extends(l,u=t),l.prototype.setData=function(t){u.prototype.setData.call(this,t),this.beginType=t.beginType,0==this.beginType?this.beginPos=new e.Vector3D(t.beginPos.x,t.beginPos.y,t.beginPos.z):1==this.beginType&&(this.beginSocket=t.beginSocket),this.speed=t.speed,t.hitSocket&&(this.hitSocket=t.hitSocket),t.endParticle&&(this.endParticleUrl=t.endParticle),this.multype=t.multype},l);function l(){return null!==u&&u.apply(this,arguments)||this}e.SkillTrajectoryTargetKeyVo=h}(tl3d=tl3d||{}),function(e){var t=(i.prototype.addToRender=function(){this.particle&&(this.particle.reset(),this.particle.sceneVisible=!0,this.skillMgr.scene.addParticle(this.particle))},i.prototype.setInfo=function(t){this.time=t.frame*e.Scene_data.frameTime,this.particle=e.ParticleManager.getInstance().getParticleByte(e.Scene_data.fileRoot+t.url)},i.prototype.reset=function(){this.skillMgr.scene.removeParticle(this.particle)},i.prototype.destory=function(){this.particle&&(this.particle.destory(),this.particle=null),this.removeCallFun=null},i);function i(t){this.time=0,this.skillMgr=t}e.SkillKey=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=e.SkillKey,__extends(n,i),Object.defineProperty(n.prototype,"active",{get:function(){return this._active},set:function(t){this._active=t},enumerable:!0,configurable:!0}),n.prototype.addToRender=function(){i.prototype.addToRender.call(this),this.particle.addEventListener(e.BaseEvent.COMPLETE,this.onPlayCom,this)},n.prototype.onPlayCom=function(t){void 0===t&&(t=null),this.particle.removeEventListener(e.BaseEvent.COMPLETE,this.onPlayCom,this),this.skillMgr.scene.removeParticle(this.particle),this.removeCallFun(this)},n);function n(t){return i.call(this,t)||this}e.SkillEffect=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t=(e.prototype.getSocket=function(t,e){this.bindMatrix.clone(e)},e.prototype.getSunType=function(){return 1},e);function e(){}o.SkillBugBind=t;var i,n=(i=o.SkillEffect,__extends(a,i),a.prototype.setInfo=function(t){i.prototype.setInfo.call(this,t);var e=t;this.pos=e.pos,this.rotation=e.rotation,this.hasSocket=e.hasSocket,this.socket=e.socket},a.prototype.onPlayCom=function(t){void 0===t&&(t=null),this.particle.removeEventListener(o.BaseEvent.COMPLETE,this.onPlayCom,this),this.skill.skillMgr.scene.removeParticle(this.particle),this.removeCallFun(this)},a.prototype.addToRender=function(){if(this.particle)if(this.particle.reset(),this.particle.sceneVisible=!0,this.skill.skillMgr.scene.addParticle(this.particle),this.particle.addEventListener(o.BaseEvent.COMPLETE,this.onPlayCom,this),this.hasSocket){var t=this.active;this.particle.bindTarget=t,this.particle.bindSocket=this.socket}else{var e=new o.Matrix3D;e.appendRotation(this.active.rotationY,o.Vector3D.Y_AXIS);var i=e.transformVector(this.pos);i.x+=null==this.outPos?this.active.x:this.outPos.x,i.y+=null==this.outPos?this.active.y:this.outPos.y,i.z+=null==this.outPos?this.active.z:this.outPos.z;var n=new o.SkillBugBind;n.bindMatrix=new o.Matrix3D,n.bindMatrix.appendRotation(this.rotation.x,o.Vector3D.X_AXIS),n.bindMatrix.appendRotation(this.rotation.y,o.Vector3D.Y_AXIS),n.bindMatrix.appendRotation(this.rotation.z,o.Vector3D.Z_AXIS),n.bindMatrix.appendRotation(this.active.rotationY,o.Vector3D.Y_AXIS),n.bindMatrix.appendTranslation(i.x,i.y,i.z),this.particle.bindTarget=n}},a);function a(t){var e=i.call(this,t.skillMgr)||this;return e.skill=t,e}o.SkillFixEffect=n}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var n,t=(n=r.SkillKey,__extends(e,n),e.prototype.update=function(t){this.path.update(t)},e.prototype.reset=function(){n.prototype.reset.call(this),this.endParticle&&(this.skillMgr.scene.addParticle(this.endParticle),this.endParticle.reset(),this.endParticle.setPos(this._currentTargetPos.x,this._currentTargetPos.y,this._currentTargetPos.z)),this.removeCallFun&&this.removeCallFun(this)},e.prototype.endPlayFun=function(t){void 0===t&&(t=null),this.skillMgr.scene.removeParticle(this.endParticle),this.endParticle.removeEventListener(r.BaseEvent.COMPLETE,this.endPlayFun,this)},e.prototype.setCurrentPos=function(){if(this.data.hitSocket){var t=this.target;return t&&(t.getSocket(this.data.hitSocket,this._socketMaxrix),this._currentTargetPos.setTo(this._socketMaxrix.position.x,this._socketMaxrix.position.y,this._socketMaxrix.position.z)),!0}return(this._currentTargetPos.x!=this.target.x||this._currentTargetPos.y!=this.target.y||this._currentTargetPos.z!=this.target.z)&&(this._currentTargetPos.setTo(this.target.x,this.target.y,this.target.z),!0)},e.prototype.addToRender=function(){var t;if(n.prototype.addToRender.call(this),0==this.data.beginType){var e=new r.Matrix3D;e.appendRotation(this.active.rotationY,r.Vector3D.Y_AXIS),t=e.transformVector(this.data.beginPos),this._currentPos.setTo(this.active.x+t.x,this.active.y+t.y,this.active.z+t.z)}else if(1==this.data.beginType){var i=new r.Matrix3D;this.active.getSocket(this.data.beginSocket,i),t=i.position,this._currentPos.setTo(t.x,t.y,t.z)}this.particle.setPos(this._currentPos.x,this._currentPos.y,this._currentPos.z),this.path.add()},e.prototype.getSocket=function(t,e){e.identity(),e.append(this.rotationMatrix),e.appendTranslation(this._currentPos.x,this._currentPos.y,this._currentPos.z)},e.prototype.getSunType=function(){return 0},e.prototype.setInfo=function(t){n.prototype.setInfo.call(this,t),(this.particle.bindTarget=this).data=t,this.data.endParticleUrl&&(this.endParticle=r.ParticleManager.getInstance().getParticleByte(r.Scene_data.fileRoot+this.data.endParticleUrl),this.endParticle.addEventListener(r.BaseEvent.COMPLETE,this.endPlayFun,this))},e.prototype.setPlayData=function(t,e,i,n,o){var a=this;void 0===n&&(n=0),void 0===o&&(o=null),this.active=t,this.target=e,this.removeCallFun=i,this._currentPos.setTo(0,0,0),this.rotationMatrix.identity(),this._socketMaxrix.identity(),this._currentTargetPos.setTo(0,0,0),this.path||(this.path=r.PathManager.getNewPath(2),this.path.setData(this,function(){a.reset()},this._currentPos,this.rotationMatrix,this._currentTargetPos,o),this.path.speed=this.data.speed),this.path.reset()},e.prototype.destory=function(){n.prototype.destory.call(this),this.active=null,this.target=null,this.data=null,this._currentPos=null,this.rotationMatrix=null,this._socketMaxrix=null,this._currentTargetPos=null,this.path=null},e);function e(t){var e=n.call(this,t)||this;return e._currentPos=new r.Vector3D,e.rotationMatrix=new r.Matrix3D,e._socketMaxrix=new r.Matrix3D,e._currentTargetPos=new r.Vector3D,e}r.SkillTrajectory=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var t,e=(t=a.SkillTrajectory,__extends(i,t),i.prototype.update=function(t){this.pathMul.update(t)},i.prototype.getSunType=function(){return 1},i.prototype.addToRender=function(){if(this.particle){if(this.particle.reset(),this.skillMgr.scene.addParticle(this.particle),this.currentPosList)for(t=0;t<this.activeList.length;t++)this.currentPosList[t].setTo(this.activeList[t].x,this.activeList[t].y+10,this.activeList[t].z+5),this.currentPosList[t].w=0;else{this.currentPosList=new Array;for(var t=0;t<this.activeList.length;t++)this.currentPosList.push(new a.Vector3D(this.activeList[t].x,this.activeList[t].y+10,this.activeList[t].z+5));this.pathMul.setInitCurrentPos(this.currentPosList)}this.pathMul.add(),this.particle.setMulPos(this.pathMul.resultAry)}},i.prototype.setMulPlayData=function(t,e,i,n){var o=this;void 0===n&&(n=0),this.activeList=t,this.active=this.activeList[0],this.target=e,this.removeCallFun=i,this._currentPos.setTo(0,0,0),this.rotationMatrix.identity(),this._socketMaxrix.identity(),this._currentTargetPos.setTo(0,0,0),this.pathMul||(this.pathMul=a.PathManager.getNewPath(n),this.pathMul.setData(this,function(){o.reset()},this._currentPos,this.rotationMatrix,this._currentTargetPos),this.pathMul.speed=this.data.speed),this.pathMul.reset()},i.prototype.getMulSocket=function(t){t&&this.pathMul.applyData(t)},i);function i(){return null!==t&&t.apply(this,arguments)||this}a.SkillMulTrajectory=e}(tl3d=tl3d||{}),function(a){var t=(e.prototype.update=function(t){if(this.time=t,this.hasReached)return this.endTime+=t,void(200<this.endTime&&this.applyArrive());if(this.skillTrajectory.setCurrentPos()&&(this._currentDirect.x=this.currentTargetPos.x-this.currentPos.x,this._currentDirect.y=this.currentTargetPos.y-this.currentPos.y,this._currentDirect.z=this.currentTargetPos.z-this.currentPos.z,this._currentDirect.normalize(),this._currentDirect.scaleBy(this.speed),this.setRotationMatrix(this.currentTargetPos.subtract(this.currentPos)),0==this._currentDirect.length))this.arrive();else{var e=this._currentDirect.length*this.time;if(!this.hasReached){var i=a.Vector3D.distance(this.currentPos,this.currentTargetPos);this.currentPos.x+=this._currentDirect.x*this.time,this.currentPos.y+=this._currentDirect.y*this.time,this.currentPos.z+=this._currentDirect.z*this.time}i<e&&this.arrive()}},e.prototype.setRotationMatrix=function(t){t.normalize();var e=new a.Vector3D(0,0,1),i=e.cross(t);i.normalize();var n=Math.acos(t.dot(e)),o=new a.Quaternion;o.fromAxisAngle(i,n),o.toMatrix3D(this.rotationMatrix)},e.prototype.arrive=function(){this.hasReached=!0},e.prototype.applyArrive=function(){this.endFun(),this.bloodFun&&this.bloodFun()},e.prototype.reset=function(){this.hasReached=!1,this._currentDirect.setTo(0,0,0),this.endTime=0},e.prototype.add=function(){},e.prototype.setData=function(t,e,i,n,o,a){this.skillTrajectory=t,this.currentPos=i,this.rotationMatrix=n,this.currentTargetPos=o,this.endFun=e,this.bloodFun=a},e);function e(){this._currentDirect=new a.Vector3D}a.SkillPath=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=a.SkillPath,__extends(i,e),i.prototype.add=function(){this.skillTrajectory.setCurrentPos();var t=new a.Vector3D;t.x=this.currentTargetPos.x-this.currentPos.x,t.y=this.currentTargetPos.y-this.currentPos.y,t.z=this.currentTargetPos.z-this.currentPos.z,this.basePos.setTo(this.currentPos.x,this.currentPos.y,this.currentPos.z),this.alltime=t.length/this.speed},i.prototype.update=function(t){if(this.time=t,this.lastTime+=t,this.hasReached)return this.endTime+=t,void(200<this.endTime&&this.applyArrive());this.skillTrajectory.setCurrentPos();var e=this.lastTime/this.alltime;1<e&&(e=1);var i=this.getOffset(e);if(this._currentDirect.x=this.currentTargetPos.x-this.basePos.x,this._currentDirect.y=this.currentTargetPos.y-this.basePos.y,this._currentDirect.z=this.currentTargetPos.z-this.basePos.z,this._currentDirect.normalize(),this._currentDirect.scaleBy(this.speed),this.setRotationMatrix(this.currentTargetPos.subtract(this.basePos)),0!=this._currentDirect.length){var n=this._currentDirect.length*this.time;if(!this.hasReached){var o=a.Vector3D.distance(this.basePos,this.currentTargetPos);this.basePos.x+=this._currentDirect.x*this.time,this.basePos.y+=this._currentDirect.y*this.time,this.basePos.z+=this._currentDirect.z*this.time,this.setApplyPos(i)}o<n&&this.arrive()}else this.arrive()},i.prototype.setApplyPos=function(t){this.currentPos.x=this.basePos.x+t.x,this.currentPos.y=this.basePos.y+t.y,this.currentPos.z=this.basePos.z+t.z},i.prototype.getOffset=function(t){return t=100*Math.sin(t*Math.PI),this._currentDirect.cross(new a.Vector3D(0,1,0)).scaleBy(t),new a.Vector3D},i.prototype.reset=function(){e.prototype.reset.call(this),this.lastTime=0},i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.basePos=new a.Vector3D,t}a.SkillSinPath=t;var n,o=(__extends(r,n=t),r.prototype.getOffset=function(t){return t=300*(t-t*t),this._currentDirect.cross(new a.Vector3D(0,-1,0)).scaleBy(t),new a.Vector3D},r);function r(){return null!==n&&n.apply(this,arguments)||this}a.SkillCosPath=o}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var a,t=(a=r.SkillPath,__extends(e,a),e.prototype.setInitCurrentPos=function(t){this.currentPosAry=t,this.allTimeList=new Array;for(var e=0;e<t.length;e++)this.allTimeList.push(0)},e.prototype.add=function(){this.skillTrajectory.setCurrentPos(),this.directAry=new Array;for(var t=0,e=0;e<this.currentPosAry.length;e++){var i=new r.Vector3D;i.x=this.currentTargetPos.x-this.currentPosAry[e].x,i.y=this.currentTargetPos.y-this.currentPosAry[e].y,i.z=this.currentTargetPos.z-this.currentPosAry[e].z;var n=i.length;t<n&&(t=n,this.maxV3d=this.currentPosAry[e]),this.allTimeList[e]=n/this.speed,i.normalize(),i.scaleBy(this.speed),this.directAry.push(i)}this.alltime=t/this.speed,this.setAllData()},e.prototype.setAllData=function(){var t=float2int(this.alltime/33)+8;this.resultAry=new Array;for(var e=0;e<this.currentPosAry.length;e++){var i=new Array;this.resultAry.push(i);for(var n=this.directAry[e],o=0;o<6;o++)i.push([this.currentPosAry[e].x,this.currentPosAry[e].y,this.currentPosAry[e].z]);for(var a=0;a<t;a++){this.lastTime=33*a;var r,s,u=this.lastTime/this.allTimeList[e],h=u;if(r=1<=u?(h=0,[this.currentTargetPos.x,this.currentTargetPos.y,this.currentTargetPos.z]):(h-=h*h,h*=250,[n.x*this.lastTime+this.currentPosAry[e].x,n.y*this.lastTime+h+this.currentPosAry[e].y,n.z*this.lastTime+this.currentPosAry[e].z]),0==a)s=[0,1,0];else{var l=i[2*a-2];s=[r[0]-l[0],r[1]-l[1],r[2]-l[2]];var c=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);s[0]/=c,s[1]/=c,s[2]/=c}i.push(r,s)}}},e.prototype.update=function(t){if(this.time=t,this.lastTime+=t,this.hasReached)return this.endTime+=t,void(200<this.endTime&&this.applyArrive());this.skillTrajectory.setCurrentPos();for(var e=0;e<this.currentPosAry.length;e++){var i=this.lastTime/this.allTimeList[e];i-=i*i,i*=250;var n=this.currentPosAry[e];if(this._currentDirect.x=this.currentTargetPos.x-n.x,this._currentDirect.y=this.currentTargetPos.y-n.y,this._currentDirect.z=this.currentTargetPos.z-n.z,this._currentDirect.normalize(),this._currentDirect.scaleBy(this.speed),this.maxV3d==n&&(this.setRotationMatrix(this.currentTargetPos.subtract(n)),0==this._currentDirect.length))return void this.arrive();var o=this._currentDirect.length*this.time;if(!this.hasReached){var a=r.Vector3D.distance(n,this.currentTargetPos);n.x+=this._currentDirect.x*this.time,n.y+=this._currentDirect.y*this.time,n.z+=this._currentDirect.z*this.time,n.w=i}this.maxV3d==n&&a<o&&this.arrive()}this.currentPos.setTo(this.currentPosAry[0].x,this.currentPosAry[0].y+this.currentPosAry[0].w,this.currentPosAry[0].z)},e.prototype.setData=function(t,e,i,n,o){a.prototype.setData.call(this,t,e,i,n,o,null),this.skillMul=t},e.prototype.applyData=function(t){for(var e=0;e<t.length;e++)t[e].setTo(this.currentPosAry[e].x,this.currentPosAry[e].y+this.currentPosAry[e].w,this.currentPosAry[e].z)},e.prototype.reset=function(){a.prototype.reset.call(this),this.lastTime=0},e);function e(){var t=null!==a&&a.apply(this,arguments)||this;return t.lastTime=0,t}r.SkillMulPath=t}(tl3d=tl3d||{}),function(t){var e=(i.reg=function(t,e){this.dic[t]=e},i.getNewPath=function(t){return new this.dic[t]},i.init=function(){this.dic[0]=t.SkillPath,this.dic[1]=t.SkillSinPath,this.dic[2]=t.SkillCosPath},i.dic=new Object,i);function i(){}t.PathManager=e}(tl3d=tl3d||{}),function(s){var e=(t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.getVersion=function(t){return this._versions&&this._versions[t]||t},t.prototype.load=function(t,e,i,n,o){void 0===n&&(n=null),void 0===o&&(o=null),""!=s.Scene_data.fileRoot&&(t=t.replace(s.Scene_data.fileRoot,""),t=s.Scene_data.fileRoot+this.getVersion(t));for(var a=new u(t,e,i,n,o),r=0;r<this._loadThreadList.length;r++)if(this._loadThreadList[r].idle)return void this._loadThreadList[r].load(a);this._waitLoadList.push(a)},t.prototype.loadWaitList=function(){if(!(this._waitLoadList.length<=0))for(var t=0;t<this._loadThreadList.length;t++)if(this._loadThreadList[t].idle)return void this._loadThreadList[t].load(this._waitLoadList.shift())},t.BYTE_TYPE="BYTE_TYPE",t.IMG_TYPE="IMG_TYPE",t.XML_TYPE="XML_TYPE",t);function t(){this._loadThreadList=new Array,this._waitLoadList=new Array;for(var t=0;t<10;t++)this._loadThreadList.push(new i)}s.LoadManager=e;var i=(n.prototype.load=function(t){this._loadInfo=t,this.idle=!1,this._url=t.url,this._loadInfo.type==e.BYTE_TYPE?(this._xhr.open("GET",t.vurl,!0),this._xhr.responseType="arraybuffer",this._xhr.send()):this._loadInfo.type==e.XML_TYPE?(this._xhr.open("GET",t.vurl,!0),this._xhr.responseType="text",this._xhr.send()):this._loadInfo.type==e.IMG_TYPE&&(this._img.url==t.vurl?this.loadImg():(this._img.url=t.vurl,this._img.src=t.vurl))},n.prototype.loadError=function(){this.idle=!0,this._loadInfo=null,e.getInstance().loadWaitList()},n.prototype.loadByteXML=function(){this._loadInfo.info?this._loadInfo.fun(this._xhr.response,this._loadInfo.info):this._loadInfo.fun(this._xhr.response),this.idle=!0,this._loadInfo=null,e.getInstance().loadWaitList()},n.prototype.loadByteImg=function(){this._img.src="data:image/png;base64,"+s.Base64.encode(this._xhr.response)},n.prototype.loadImg=function(){this._loadInfo.info?this._loadInfo.fun(this._img,this._loadInfo.info):this._loadInfo.fun(this._img),this.idle=!0,this._loadInfo=null,e.getInstance().loadWaitList()},n);function n(){var e=this;this._xhr=new XMLHttpRequest,this._xhr.onreadystatechange=function(){e._xhr&&4===e._xhr.readyState&&(0===e._xhr.status||200===e._xhr.status?e.loadByteXML():e.loadError())},this._xhr.onprogress=function(t){e._loadInfo.progressFun&&e._loadInfo.progressFun(t.loaded/t.total)},this._xhr.onerror=function(){e.loadError()},this._img=new Image,this._img.onload=function(){e.loadImg()},this._img.onerror=function(){e.loadError()},this.idle=!0}s.LoaderThread=i;var u=(Object.defineProperty(o.prototype,"vurl",{get:function(){return this.url},enumerable:!0,configurable:!0}),o);function o(t,e,i,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this.url=t,this.type=e,this.fun=i,this.info=n,this.progressFun=o}s.LoadInfo=u}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(p){var e,t=(e=p.ResGC,__extends(i,e),i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.getObjData=function(e,t){var i=this;if(this._dic[e])return t(this._dic[e]),void this._dic[e].useNum++;this._loadList[e]||(this._loadList[e]=new Array,p.LoadManager.getInstance().load(e,p.LoadManager.BYTE_TYPE,function(t){i.loadObjCom(t,e)})),this._loadList[e].push(t)},i.prototype.registerUrl=function(t){this._dic[t]&&this._dic[t].useNum++},i.prototype.releaseUrl=function(t){this._dic[t]&&this._dic[t].clearUseNum()},i.prototype.readFloatNrm=function(t,e){var i=t.readInt();if(0<i)for(var n=0;n<i;n++)e.push(t.readFloat())},i.prototype.readcollisionItem=function(t,e){var i=t.readInt();if(0<i){e.collision=new p.CollisionItemVo,e.collision.collisionItem=new Array;for(var n=0;n<i;n++){var o=JSON.parse(t.readUTF()),a=new p.CollisionVo;a.scaleX=o.scale_x,a.scaleY=o.scale_y,a.scaleZ=o.scale_z,a.x=o.x,a.y=o.y,a.z=o.z,a.rotationX=o.rotationX,a.rotationY=o.rotationY,a.rotationZ=o.rotationZ,a.scaleX=this.getFloadNum(a.scaleX),a.scaleY=this.getFloadNum(a.scaleY),a.scaleZ=this.getFloadNum(a.scaleZ),a.rotationX=this.getFloadNum(a.rotationX),a.rotationY=this.getFloadNum(a.rotationY),a.rotationZ=this.getFloadNum(a.rotationZ),a.type=o.type,a.data=o.data,e.collision.collisionItem.push(a)}}},i.prototype.getFloadNum=function(t){return Math.floor(1e3*t)/1e3},i.prototype.loadObjCom=function(t,e){if(!this._dic[e]){var i=new p.ObjData,n=new p.TLByteArray(t),o=n.readInt();n.readUTF(),20<=o?(this.readObj2OneBuffer(n,i),37<=o&&n.position<n.length&&this.readcollisionItem(n,i)):(p.BaseRes.readFloatTwoByte(n,i.vertices),p.BaseRes.readFloatTwoByte(n,i.uvs),p.BaseRes.readFloatOneByte(n,i.lightuvs),p.BaseRes.readFloatTwoByte(n,i.normals),p.BaseRes.readIntForTwoByte(n,i.indexs),p.BaseRes.readFloatTwoByte(n,i.tangents),p.BaseRes.readFloatTwoByte(n,i.bitangents),i.vertexBuffer=p.Scene_data.context3D.uploadBuff3D(i.vertices),i.uvBuffer=p.Scene_data.context3D.uploadBuff3D(i.uvs),i.lightUvBuffer=p.Scene_data.context3D.uploadBuff3D(i.lightuvs),i.normalsBuffer=p.Scene_data.context3D.uploadBuff3D(i.normals)),i.treNum=i.indexs.length,i.indexBuffer=p.Scene_data.context3D.uploadIndexBuff3D(i.indexs),this._dic[e]=i;var a=this._loadList[e];if(a){for(var r=0;r<a.length;r++)a[r](i);delete this._loadList[e]}return i}},i.prototype.readObj2OneBuffer=function(t,e){for(var i,n=new Array,o=(n=new Array,0),a=0;a<6;a++){var r=t.readBoolean();if(n.push(r),r)switch(a){case 1:case 2:o+=2;break;default:o+=3}}i=t.readFloat(),i*=4*o;var s=new ArrayBuffer(i),u=new DataView(s),h=n[2]?7:5,l=3+h,c=3+l;p.BaseRes.readBytes2ArrayBuffer(t,u,3,0,o),p.BaseRes.readBytes2ArrayBuffer(t,u,2,3,o),p.BaseRes.readBytes2ArrayBuffer(t,u,2,5,o,1),p.BaseRes.readBytes2ArrayBuffer(t,u,3,h,o),p.BaseRes.readBytes2ArrayBuffer(t,u,3,l,o),p.BaseRes.readBytes2ArrayBuffer(t,u,3,c,o),p.BaseRes.readIntForTwoByte(t,e.indexs),e.vertexBuffer=p.Scene_data.context3D.uploadBuff3DArrayBuffer(s),e.compressBuffer=!0,e.uvsOffsets=12,e.lightuvsOffsets=20,e.normalsOffsets=4*h,e.tangentsOffsets=4*l,e.bitangentsOffsets=4*c,e.stride=4*o},i.prototype.creatTBNBuffer=function(t){t.tangentBuffer=p.Scene_data.context3D.uploadBuff3D(t.tangents),t.bitangentBuffer=p.Scene_data.context3D.uploadBuff3D(t.bitangents)},i);function i(){var t=e.call(this)||this;return t._loadList=new Object,t}p.ObjDataManager=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(y){var e,t=(e=y.ResGC,__extends(i,e),i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.getMeshData=function(t,e,i){var n=this;if(void 0===i&&(i=1),this._dic[t]&&this._dic[t].ready)return e(this._dic[t]),void this._dic[t].useNum++;this._loadDic[t]?this._loadDic[t].push(e):(this._loadDic[t]=new Array,this._loadDic[t].push(e),this.loadRoleRes(y.Scene_data.fileRoot+t,function(t){n.roleResCom(t,e)},i))},i.prototype.loadRoleRes=function(t,e,i){var n=new y.RoleRes;n.meshBatchNum=i,n.load(t,function(){e(n)})},i.prototype.roleResCom=function(t,e){var i=t.roleUrl,n=this._dic[i];n.loadMaterial(),n.setAction(t.actionAry,i),n.url=i,t.ambientLightColor&&(n.lightData=[[t.ambientLightColor.x,t.ambientLightColor.y,t.ambientLightColor.z],[t.nrmDircet.x,t.nrmDircet.y,t.nrmDircet.z],[t.sunLigthColor.x,t.sunLigthColor.y,t.sunLigthColor.z]]);for(var o=0;o<this._loadDic[i].length;o++)this._loadDic[i][o](n),n.useNum++;delete this._loadDic[i],n.ready=!0},i.prototype.readData=function(t,e,i,n){var o=new y.SkinMesh;o.fileScale=t.readFloat(),o.tittleHeight=19<=n?t.readFloat():50,o.hitBox=new y.Vector2D(20,20),23<=n&&(o.hitBox.x=t.readFloat(),o.hitBox.y=t.readFloat()),o.makeHitBoxItem();for(var a=t.readInt(),r=new Object,s=0;s<a;s++){var u=new y.MeshData;35<=n&&(u.bindPosAry=this.readBindPosByte(t),u.getBindPosMatrix()),21<=n?this.readMesh2OneBuffer(t,u):(y.BaseRes.readFloatTwoByte(t,u.vertices),y.BaseRes.readFloatTwoByte(t,u.tangents),y.BaseRes.readFloatTwoByte(t,u.bitangents),y.BaseRes.readFloatTwoByte(t,u.normals),y.BaseRes.readFloatTwoByte(t,u.uvs),y.BaseRes.readIntForOneByte(t,u.boneIDAry),y.BaseRes.readFloatOneByte(t,u.boneWeightAry),y.BaseRes.readIntForTwoByte(t,u.indexs),y.BaseRes.readIntForTwoByte(t,u.boneNewIDAry),this.uploadMesh(u)),u.treNum=u.indexs.length,u.materialUrl=t.readUTF(),u.materialParamData=y.BaseRes.readMaterialParamData(t);for(var h=t.readInt(),l=0;l<h;l++){var c=new y.BindParticle(t.readUTF(),t.readUTF());u.particleAry.push(c),r[c.url]=!0}o.addMesh(u)}for(var p in r)y.ParticleManager.getInstance().registerUrl(p);if(o.allParticleDic=r,n<35)for(var d=this.readBindPosByte(t),_=0;_<o.meshAry.length;_++)o.meshAry[_].bindPosAry=d,o.meshAry[_].getBindPosMatrix();var f=t.readInt();for(o.boneSocketDic=new Object,l=0;l<f;l++){var g=new y.BoneSocketData;g.name=t.readUTF(),g.boneName=t.readUTF(),g.index=t.readInt(),g.x=t.readFloat(),g.y=t.readFloat(),g.z=t.readFloat(),g.rotationX=t.readFloat(),g.rotationY=t.readFloat(),g.rotationZ=t.readFloat(),o.boneSocketDic[g.name]=g}return this._dic[i]=o},i.prototype.readBindPosByte=function(t){for(var e=t.readInt(),i=new Array,n=0;n<e;n++){var o=new Array(t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat());i.push(o)}return i},i.prototype.readMesh2OneBuffer=function(t,e){for(var i=t.readInt(),n=new Array,o=0,a=0;a<5;a++){var r=t.readBoolean();n.push(r),r&&(o+=1==a?2:3)}i*=4*(o+=8);var s,u=4+(s=n[2]?n[4]?14:8:5),h=new ArrayBuffer(i),l=new DataView(h);y.BaseRes.readBytes2ArrayBuffer(t,l,3,0,o),y.BaseRes.readBytes2ArrayBuffer(t,l,2,3,o),y.BaseRes.readBytes2ArrayBuffer(t,l,3,5,o),y.BaseRes.readBytes2ArrayBuffer(t,l,3,8,o),y.BaseRes.readBytes2ArrayBuffer(t,l,3,11,o),y.BaseRes.readBytes2ArrayBuffer(t,l,4,s,o,2),y.BaseRes.readBytes2ArrayBuffer(t,l,4,u,o,1),y.BaseRes.readIntForTwoByte(t,e.indexs),y.BaseRes.readIntForTwoByte(t,e.boneNewIDAry),e.compressBuffer=!0,e.uvsOffsets=12,e.normalsOffsets=20,e.tangentsOffsets=32,e.bitangentsOffsets=44,e.boneIDOffsets=4*s,e.boneWeightOffsets=4*u,e.stride=4*o,e.vertexBuffer=y.Scene_data.context3D.uploadBuff3DArrayBuffer(h),e.indexBuffer=y.Scene_data.context3D.uploadIndexBuff3D(e.indexs)},i.prototype.cloneMeshData=function(t,e){var i=t.vertices,n=t.normals,o=t.uvs,a=t.boneIDAry,r=t.boneWeightAry,s=t.indexs;t.vertices=new Array,t.normals=new Array,t.uvs=new Array,t.boneIDAry=new Array,t.boneWeightAry=new Array,t.indexs=new Array;for(var u=i.length/3,h=0;h<e;h++){t.vertices=t.vertices.concat(i),t.normals=t.normals.concat(n),t.boneIDAry=t.boneIDAry.concat(a),t.boneWeightAry=t.boneWeightAry.concat(r);for(var l=0;l<o.length;l+=2)t.uvs.push(o[l],o[l+1],h);for(l=0;l<s.length;l++)t.indexs.push(s[l]+h*u)}t.treNum=t.indexs.length},i.prototype.uploadMesh=function(t){t.vertexBuffer=y.Scene_data.context3D.uploadBuff3D(t.vertices),t.uvBuffer=y.Scene_data.context3D.uploadBuff3D(t.uvs),t.boneIdBuffer=y.Scene_data.context3D.uploadBuff3D(t.boneIDAry),t.boneWeightBuffer=y.Scene_data.context3D.uploadBuff3D(t.boneWeightAry),t.indexBuffer=y.Scene_data.context3D.uploadIndexBuff3D(t.indexs)},i.prototype.uploadPbrMesh=function(t,e){t.normalsBuffer=y.Scene_data.context3D.uploadBuff3D(t.normals),e&&(t.tangentBuffer=y.Scene_data.context3D.uploadBuff3D(t.tangents),t.bitangentBuffer=y.Scene_data.context3D.uploadBuff3D(t.bitangents))},i.prototype.preLoad=function(t){this.getMeshData(t,function(t){t.loadMaterial()})},i);function i(){var t=e.call(this)||this;return t._loadDic=new Object,t}y.MeshDataManager=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.getAnimData=function(i,t){var n=this;this._dic[i]?t(this._dic[i]):h.LoadManager.getInstance().load(i,h.LoadManager.BYTE_TYPE,function(t,e){e(n.readData(new h.TLByteArray(t),i))},t)},e.prototype.getAnimDataImmediate=function(t){return this._dic[t]},e.prototype.clearAnim=function(t){delete this._dic[t]},e.prototype.readData=function(t,e){var i=new Array,n=new Array,o=new h.AnimData;o.inLoop=t.readInt();for(var a=t.readInt(),r=0;r<a;r++)o.inter.push(t.readInt());for(a=t.readInt(),r=0;r<a;r++)o.bounds.push(t.readVector3D());for(o.nameHeight=t.readInt(),a=t.readInt(),r=0;r<a;r++){var s=new u;s.father=t.readInt(),s.changtype=t.readInt(),s.startIndex=t.readInt(),s.tx=t.readFloat(),s.ty=t.readFloat(),s.tz=t.readFloat(),s.qx=t.readFloat(),s.qy=t.readFloat(),s.qz=t.readFloat(),i.push(s)}for(this.readFrameData(t,n),a=t.readInt(),r=0;r<a;r++)o.posAry.push(t.readVector3D());return o.matrixAry=this.processFrame(n,i),this._dic[e]=o},e.prototype.readFrameData=function(t,e){for(var i=this.readFrameTypeData(t),n=t.readBoolean(),o=t.readFloat(),a=t.readInt(),r=0;r<a;r++){var s=t.readInt(),u=new Array;e.push(u);for(var h=0;h<s;h++)i[h]?u.push(t.readFloatTwoByte(o)):n?u.push(t.readFloat()):u.push(t.readShort()/32767)}},e.prototype.readFrameTypeData=function(t){for(var e=new Array,i=t.readInt(),n=0;n<i;n++)e.push(t.readBoolean());return e},e.prototype.processFrame=function(t,e){for(var i=new Array,n=0;n<t.length;n++)i.push(this.frameToBone(t[n],e));return this.setFrameToMatrix(i)},e.prototype.frameToBone=function(t,e){for(var i=new Array,n=0;n<e.length;n++){var o=new r;o.father=e[n].father;var a=0;1&e[n].changtype?(o.tx=t[e[n].startIndex+a],++a):o.tx=e[n].tx,2&e[n].changtype?(o.ty=t[e[n].startIndex+a],++a):o.ty=e[n].ty,4&e[n].changtype?(o.tz=t[e[n].startIndex+a],++a):o.tz=e[n].tz,8&e[n].changtype?(o.qx=t[e[n].startIndex+a],++a):o.qx=e[n].qx,16&e[n].changtype?(o.qy=t[e[n].startIndex+a],++a):o.qy=e[n].qy,32&e[n].changtype?(o.qz=t[e[n].startIndex+a],++a):o.qz=e[n].qz,i.push(o)}return i},e.prototype.setFrameToMatrix=function(t){for(var e=new Array,i=0;i<t.length;i++){var n=t[i],o=new h.Quaternion,a=new h.Matrix3D,r=new Array;e.push(r);for(var s=0;s<n.length;s++){var u=n[s];(o=new h.Quaternion(u.qx,u.qy,u.qz)).w=this.getW(o.x,o.y,o.z),-1==u.father?((a=o.toMatrix3D()).appendTranslation(u.tx,u.ty,u.tz),a.appendRotation(-90,h.Vector3D.X_AXIS)):(n[u.father],(a=o.toMatrix3D()).appendTranslation(u.tx,u.ty,u.tz),a.append(r[u.father])),r.push(a)}for(s=0;s<r.length;s++)r[s].appendScale(-1,1,1)}return e},e.prototype.getW=function(t,e,i){var n=1-(t*t+e*e+i*i);return n=n<0?0:-Math.sqrt(n)},e);function e(){this._dic=new Object}h.AnimManager=t;var i,r=function(){},u=(__extends(n,i=r),n.prototype.clone=function(){var t=new n;return t.tx=this.tx,t.ty=this.ty,t.tz=this.tz,t.tw=this.tw,t.qx=this.qx,t.qy=this.qy,t.qz=this.qz,t.qw=this.qw,t.changtype=this.changtype,t.name=this.name,t.father=this.father,t.startIndex=this.startIndex,t.matrix=this.matrix,t},n);function n(){return null!==i&&i.apply(this,arguments)||this}}(tl3d=tl3d||{}),function(_){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setLightProbeData=function(t){this._dataAry=t},e.prototype.clear=function(){this._dataAry=null},e.prototype.getData=function(t){if(!this._dataAry)return this._defaultVec;for(var e=0;e<this._dataAry.length;e++){var i=this._dataAry[e];if(this.testPoint(i,t)){var n=i.postion,o=t.subtract(n);return this.getResultData(i.posItem,float2int(o.x/i.betweenNum),float2int(o.z/i.betweenNum),float2int(o.y/i.betweenNum),i.betweenNum,o)}}return this._defaultVec},e.prototype.testPoint=function(t,e){var i=(t.cubeVec.x-1)*t.betweenNum,n=(t.cubeVec.y-1)*t.betweenNum,o=(t.cubeVec.z-1)*t.betweenNum,a=e.x-t.postion.x,r=e.y-t.postion.y,s=e.z-t.postion.z;return 0<=a&&a<i&&0<=r&&r<n&&0<=s&&s<o},e.prototype.getResultData=function(t,e,i,n,o,a){var r=new Array;r.push(new f(t[e][i][n],a)),r.push(new f(t[e+1][i][n],a)),r.push(new f(t[e][i+1][n],a)),r.push(new f(t[e+1][i+1][n],a)),r.push(new f(t[e][i][n+1],a)),r.push(new f(t[e+1][i][n+1],a)),r.push(new f(t[e][i+1][n+1],a)),r.push(new f(t[e+1][i+1][n+1],a));for(var s=0,u=0;u<r.length;u++)s+=r[u].dis;for(u=0;u<r.length;u++)r[u].setBais(s);var h=0;for(u=0;u<r.length;u++)h+=r[u].bais;for(u=0;u<r.length;u++)r[u].bais=r[u].bais/h;var l=new Array;for(u=0;u<9;u++){for(var c=new _.Vector3D,p=0;p<r.length;p++){var d=new _.Vector3D(r[p].vecNum[u].x,r[p].vecNum[u].y,r[p].vecNum[u].z);d.scaleBy(r[p].bais),c=c.add(d)}l.push(c)}return l},e);function e(){this._defaultVec=new Array;for(var t=[.4444730390920146,-.3834955622240026,-.33124467509627725,.09365654209093091,-.05673310882817577,.2120523322966496,.02945768486978205,-.04965996229802928,-.1136529129285836],e=0;e<9;e++)this._defaultVec.push(new _.Vector3D(t[e],t[e],t[e]))}_.LightProbeManager=t;var f=(i.prototype.setBais=function(t){this.bais=this.dis/t*(this.dis/t),this.bais=1/this.bais},i);function i(t,e){this.pos=new _.Vector3D(t.x,t.y,t.z),this.vecNum=t.resultSHVec,this.dis=_.Vector3D.distance(this.pos,e)}}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();function float2int(t){return 0|t}function radian2angle(t){return t/Math.PI*180}function angle2radian(t){return t/180*Math.PI}function makeImage(){var t=new Image;return t.setAttribute("crossOrigin","anonymous"),t}!function(a){var i,t=(i=a.ResGC,__extends(e,i),e.prototype.getGroupData=function(i,t){var n=this;if(this._dic[i]){var e=this._dic[i];return e.useNum++,void t(e)}if(this._loadDic[i])this._loadDic[i].push(t);else{this._loadDic[i]=new Array,this._loadDic[i].push(t);var o=new a.GroupRes;o.load(i,function(){for(var t=n._loadDic[i],e=0;e<t.length;e++)(0,t[e])(o);n._dic[i]=o,delete n._loadDic[i],o.initReg()})}},e.prototype.perLoadData=function(t,e){var i=this;if(this._dic[t])e&&e();else if(this._loadDic[t])this._loadDic[t].push(e);else{this._loadDic[t]=new Array,this._loadDic[t].push(e);var n=new a.GroupRes;n.scene=this.scene,n.load(t,function(){i._dic[t]=n,delete i._loadDic[t],n.initReg(),e&&e()})}},e);function e(t){var e=i.call(this)||this;return e._loadDic=new Object,e.scene=t,e}a.GroupDataManager=t}(tl3d=tl3d||{}),function(t){var e=(i.A=65,i.B=66,i.C=67,i.D=68,i.E=69,i.F=70,i.G=71,i.H=72,i.I=73,i.J=74,i.K=75,i.L=76,i.M=77,i.N=78,i.O=79,i.P=80,i.Q=81,i.R=82,i.S=83,i.T=84,i.U=85,i.V=86,i.W=87,i.X=88,i.Y=89,i.Z=90,i.Left=37,i.Up=38,i.Right=39,i.Down=40,i.Delete=46,i.F1=112,i.F2=113,i);function i(){}t.KeyboardType=e}(tl3d=tl3d||{}),function(n){var t=(e.MouseDown="mousedown",e.MouseUp="mouseup",e.MouseMove="mousemove",e.MouseClick="mouseclick",e.KeyDown="keydown",e.KeyUp="keyup",e.MouseWheel="mousewheel",e.TouchStart="touchstart",e.TouchMove="touchmove",e.TouchEnd="touchend",e.TouchClick="touchstart",e);function e(){}n.MouseType=t;var i=(Object.defineProperty(o,"instance",{get:function(){return this._instance||(this._instance=new o),this._instance},enumerable:!0,configurable:!0}),o.getInstance=function(){return this._instance||(this._instance=new o),this._instance},o.prototype.init=function(){document.addEventListener(t.MouseDown,this.onMouseDown),document.addEventListener(t.MouseUp,this.onMouseUp),document.addEventListener(t.MouseMove,this.onMouseMove),document.addEventListener(t.KeyDown,this.onKeyDown),document.addEventListener(t.KeyUp,this.onKeyUp)},o.prototype.clearAllEvet=function(){document.removeEventListener(t.MouseDown,this.onMouseDown),document.removeEventListener(t.MouseUp,this.onMouseUp),document.removeEventListener(t.MouseMove,this.onMouseMove),document.removeEventListener(t.KeyDown,this.onKeyDown),document.removeEventListener(t.KeyUp,this.onKeyUp)},o.prototype.clearMouseEvent=function(){document.removeEventListener(t.MouseDown,this.onMouseDown),document.removeEventListener(t.MouseUp,this.onMouseUp),document.removeEventListener(t.MouseMove,this.onMouseMove),this._isUpData=!1},o.prototype.onMouseMove=function(t){var e=o.instance,i=new n.Object3D;i.x=t.pageX,i.y=t.pageY,e._isMouseDown&&(n.Scene_data.cam3D.rotationY=e._lastFousce.rotationY-(i.x-e._lostMousePos.x)/10,n.Scene_data.cam3D.rotationX=e._lastFousce.rotationX-(i.y-e._lostMousePos.y)/10)},o.prototype.onMouseDown=function(t){var e=o.instance;e._isMouseDown=!0,e._lostMousePos.x=t.pageX,e._lostMousePos.y=t.pageY,e._lastFousce.rotationX=n.Scene_data.cam3D.rotationX,e._lastFousce.rotationY=n.Scene_data.cam3D.rotationY},o.prototype.onMouseUp=function(t){o.instance._isMouseDown=!1},o.prototype.upData=function(){if(this._isUpData){var t=this._keyDic;t[65]&&this.tureLeft(),t[83]&&this.tureDown(),t[68]&&this.tureRight(),t[87]&&this.tureUp(),t[81]&&(n.Scene_data.cam3D.y-=this.speedNum),t[69]&&(n.Scene_data.cam3D.y+=this.speedNum),n.MathClass.MathCam(n.Scene_data.cam3D)}},o.prototype.tureLeft=function(){var t=new n.Vector3D(-this.speedNum,0,0,1);new n.Matrix3D,this.mathFocus3D(t)},o.prototype.tureRight=function(){var t=new n.Vector3D(this.speedNum,0,0,1);this.mathFocus3D(t)},o.prototype.tureUp=function(){var t=new n.Vector3D(0,0,this.speedNum,1);this.mathFocus3D(t)},o.prototype.tureDown=function(){var t=new n.Vector3D(0,0,-this.speedNum,1);this.mathFocus3D(t)},o.prototype.mathFocus3D=function(t){var e=new n.Matrix3D;e.prependRotation(-n.Scene_data.cam3D.rotationY,n.Vector3D.Y_AXIS),e.prependRotation(-n.Scene_data.cam3D.rotationX,n.Vector3D.X_AXIS),t=e.transformVector(t),n.Scene_data.cam3D.x+=t.x,n.Scene_data.cam3D.y+=t.y,n.Scene_data.cam3D.z+=t.z},o.prototype.onKeyDown=function(t){o.instance._keyDic[t.keyCode]=!0,t.keyCode},o.prototype.onKeyUp=function(t){o.instance._keyDic[t.keyCode]=!1},o);function o(){var t=this;this._isUpData=!0,this.speedNum=10,this._keyDic=new Object,this._lostMousePos=new n.Object3D,this._lastFousce=new n.Object3D,this._isMouseDown=!1,setInterval(function(){t.upData()},1e3/60)}n.KeyControl=i}(tl3d=tl3d||{}),function(t){var e=(o.getTimer=function(t){return void 0===t&&(t=o.START_TIME),Date.now()-t},o.getTimerSecond=function(){return o.getTimer()/1e3},o.saveNowTime=function(){this.lastTime=this.getTimer()},o.getUseTime=function(){return this.getTimer()-this.lastTime},o.getZeroTime=function(t){var e=new Date(1e3*t);return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.getTime()/1e3},o.getLocalTime=function(t){var e=new Date(1e3*t);return e.toLocaleDateString().replace(/\//g,"-")+" "+e.toTimeString().substr(0,5)},o.getLocalTime0=function(t){return new Date(1e3*t).toLocaleDateString().replace(/\//g,"-")},o.getLocalTime1=function(t){var e=new Date(1e3*t);return e.toLocaleDateString().replace(/\//g,"-")+" "+e.toTimeString().substr(0,8)},o.getLocalTime2=function(t){return new Date(1e3*t).toTimeString().substr(0,8)},o.getLocalTime6=function(t){return new Date(1e3*t).toTimeString().substr(0,5)},o.getLocalTime3=function(t){return new Date(1e3*t).toTimeString().substr(3,5)},o.getLocalTime4=function(t){return float2int(t/60)+"分"+t%60+"秒"},o.getLocalTime5=function(t){var e=new Date(1e3*t).toTimeString().substr(0,8).split(":");return e[0]+"时"+e[1]+"分"+e[2]+"秒"},o.getDiffTime1=function(t){var e=float2int(t/this.dayTime),i=float2int((t-=e*this.dayTime)/this.HourTime),n=float2int((t-=i*this.HourTime)/this.MinuteTime);return e+"天"+i+"时"+n+"分"+(t-=n*this.MinuteTime)+"秒"},o.getDiffTime2=function(t){var e=float2int(t/this.HourTime),i=float2int((t-=e*this.HourTime)/this.MinuteTime);return t-=i*this.MinuteTime,this.zeroStr(e)+":"+this.zeroStr(i)+":"+this.zeroStr(t)},o.zeroStr=function(t){return 9<t?String(t):"0"+t},o.getDelayTimeStr=function(t){var e=Math.floor(t/3600);return 24<e?Math.floor(e/24)+"天前":1<=e?e+"小时前":"刚刚"},o.compareTime=function(t,e){return!1},o.init=function(){o.START_TIME=Date.now()},o.removeAllTickOut=function(){o.outTimeFunAry=[]},o.addTimeTick=function(t,e,i){void 0===i&&(i=0);var n=new a;n.alltime=t,n.fun=e,n.time=t-i,o.timefunAry.push(n)},o.removeTimeTick=function(t){for(var e=0;e<o.timefunAry.length;e++)if(o.timefunAry[e]&&o.timefunAry[e].fun==t){o.timefunAry[e]=null;break}},o.addTimeOut=function(t,e){if(!this.hasTimeOut(e)){var i=new n;i.alltime=t,i.fun=e,i.time=0,o.outTimeFunAry.push(i)}},o.removeTimeOut=function(t){for(var e=0;e<o.outTimeFunAry.length;e++)if(o.outTimeFunAry[e]&&o.outTimeFunAry[e].fun==t){o.outTimeFunAry[e]=null;break}},o.hasTimeOut=function(t){for(var e=0;e<o.outTimeFunAry.length;e++)if(o.outTimeFunAry[e]&&o.outTimeFunAry[e].fun==t)return!0;return!1},o.addFrameTick=function(t){-1==o.funAry.indexOf(t)&&o.funAry.push(t)},o.hasFrameTick=function(t){return-1!=o.funAry.indexOf(t)},o.removeFrameTick=function(t){var e=o.funAry.indexOf(t);-1!=e&&(o.funAry[e]=null)},o.update=function(){for(var t=o.getTimer()-o.time,e=0;e<o.funAry.length;e++)o.funAry[e]&&o.funAry[e](t);for(e=0;e<o.timefunAry.length;e++)o.timefunAry[e]&&o.timefunAry[e].update(t);for(e=o.outTimeFunAry.length-1;0<=e;e--)o.outTimeFunAry[e]&&o.outTimeFunAry[e].update(t)&&(o.outTimeFunAry[e]=null);for(e=o.funAry.length-1;0<=e;e--)o.funAry[e]||o.funAry.splice(e,1);for(e=o.timefunAry.length-1;0<=e;e--)o.timefunAry[e]||o.timefunAry.splice(e,1);for(e=o.outTimeFunAry.length-1;0<=e;e--)o.outTimeFunAry[e]||o.outTimeFunAry.splice(e,1);o.time=o.getTimer()},o.START_TIME=0,o.funAry=new Array,o.timefunAry=new Array,o.outTimeFunAry=new Array,o.time=0,o.lastTime=0,o.dayTime=86400,o.HourTime=3600,o.MinuteTime=60,o);function o(){}t.TimeUtil=e;var a=(i.prototype.update=function(t){this.time+=t,this.time>=this.alltime&&(this.fun(),this.time=0)},i);function i(){this.alltime=0,this.time=0}var n=(r.prototype.update=function(t){return this.time+=t,this.time>=this.alltime&&(this.fun(),!0)},r);function r(){this.alltime=0,this.time=0}}(tl3d=tl3d||{});var keyChi=["零","一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五"];function getChiNum(t){return keyChi[t]}function hexToArgb(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=null),(i=i||new tl3d.Vector3D).w=e?t>>24&255:0,i.x=t>>16&255,i.y=t>>8&255,i.z=255&t,i}function hexToArgbNum(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=null),(i=hexToArgb(t,e,i)).scaleBy(1/255),i}function getBaseUrl(){return tl3d.Scene_data.supportBlob?"":"_base"}function strokeFilter(t,i,e,n){for(var o=hexToArgb(n),a=t.getImageData(0,0,i,e),r=a.data,s=new Array,u=1;u<i-1;u++)for(var h=0;h<e-1;h++){var l=c(u,h);0==r[l+3]&&p(u,h)&&s.push(l)}for(u=0;u<s.length;u++)r[s[u]]=o.x,r[s[u]+1]=o.y,r[s[u]+2]=o.z,r[s[u]+3]=o.w;function c(t,e){return 4*(e*i+t)}function p(t,e){var i;return i=c(t-1,e),0<r[i+3]||(i=c(t+1,e),0<r[i+3]||(i=c(t,e+1),0<r[i+3]||(i=c(t,e-1),0<r[i+3]?1:void 0)))}t.putImageData(a,0,0)}function trim(t){return trimRight(trimLeft(t))}function trimLeft(t){if(null==t)return"";var e=new String(" \t\n\r"),i=new String(t);if(-1!=e.indexOf(i.charAt(0))){for(var n=0,o=i.length;n<o&&-1!=e.indexOf(i.charAt(n));)n++;i=i.substring(n,o)}return i}function trimRight(t){if(null==t)return"";var e=new String(" \t\n\r"),i=new String(t);if(-1!=e.indexOf(i.charAt(i.length-1))){for(var n=i.length-1;0<=n&&-1!=e.indexOf(i.charAt(n));)n--;i=i.substring(0,n+1)}return i}function TweenMoveTo(t,e,i){}function getScencdStr(t){var e=Math.floor(t/60%60),i=Math.floor(t%60);return String(e<10?"0":"")+String(e)+":"+String(i<10?"0":"")+String(i)}function random(t){return Math.floor(Math.random()*t)}function randomByItem(t){return t[random(t.length)]}function getRandomNumAssgin(t,e,i){for(var n=new Array,o=new Array,a=e;a<i;a++)o.push(a);for(var r=0;r<t;r++)if(r<i){var s=random(o.length),u=o.splice(s,1);n.push(u[0])}return n}function makeArray(t,e){for(var i=0;i<t.length;i++)e.push(t[i])}function unZip(t){var e=new Uint8Array(t);return new Zlib.Inflate(e).decompress().buffer}function getZipByte(t){var e=t.readInt(),i=t.buffer.slice(t.position,t.position+e);t.position+=e;var n=unZip(i);return new tl3d.TLByteArray(n)}function getUrlParam(t){if(window.wx)return null;var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?decodeURI(i[2]):null}function copy2clipboard(t){var e=document.createElement("textarea");e.style.fontSize="12pt",e.style.position="absolute",e.style["z-index"]=-1,e.style.background="transparent",e.style.border="transparent",e.style.color="white",e.setAttribute("readonly",""),document.body.appendChild(e),e.value=t,e.select(),e.setSelectionRange(0,e.value.length);try{document.execCommand("copy")}catch(t){alert("不支持复制")}setTimeout(function(){document.body.removeChild(e)},1e3)}function getBit(t,e){return Boolean(t>>(31&e)&1)}!function(o){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.getImageData=function(t){for(var e=t.pos.length,i=new o.Vector3D,n=0;n<e;n++)hexToArgb(t.color[n],!1,i),this._gnt.addColorStop(t.pos[n]/255,"rgba("+i.x+","+i.y+","+i.z+","+t.alpha[n]+")");return this._cxt.fillStyle=this._gnt,this._cxt.fillRect(0,0,128,2),this._cxt.getImageData(0,0,128,2)},e.prototype.getImageDataByVec=function(t,e){for(var i,n,o=this._cxt.createImageData(64,1),a=0;a<64;a++)i=4*a,n=4*float2int(a/64*e),o.data[i]=t[n],o.data[1+i]=t[1+n],o.data[2+i]=t[2+n],o.data[3+i]=t[3+n];return o},e.prototype.setData=function(){},e);function e(){this._canvas=document.createElement("canvas"),this._cxt=this._canvas.getContext("2d"),this._gnt=this._cxt.createLinearGradient(0,0,128,0),this._canvas.style.zIndex="1"}o.ColorTransition=t}(tl3d=tl3d||{}),function(_){var t=(f.getInstance=function(){return this._instance||(this._instance=new f),this._instance},f.prototype.makeFontRect=function(){this.getXmlData(_.UIData.flytext)},f.prototype.getXmlData=function(t){for(var e=_.UIData.getUiArrByKey(t),i=0;i<e.length;i++){var n=String(e[i].name);if(-1!=n.search("A_")){var o=Number(n.substring(5,n.length));(u=new _.UIRectangle).pixelX=Number(e[i].ox),u.pixelY=Number(e[i].oy),u.pixelWitdh=Number(e[i].ow),u.pixelHeight=Number(e[i].oh),u.cellX=Number(e[i].cellX),u.cellY=Number(e[i].cellY);for(var a=new _.Rectangle(0,0,u.pixelWitdh/u.cellX,u.pixelHeight),r=new Array,s=0;s<u.cellX;s++)r.push(new _.Rectangle(u.pixelX+s*a.width,u.pixelY,a.width,a.height));this.fontData["NUM"+o]=r}if(-1!=n.search("B_")){var u;for(o=Number(n.substring(5,n.length)),(u=new _.UIRectangle).pixelX=Number(e[i].ox),u.pixelY=Number(e[i].oy),u.pixelWitdh=Number(e[i].ow),u.pixelHeight=Number(e[i].oh),u.cellX=Number(e[i].cellX),u.cellY=Number(e[i].cellY),a=new _.Rectangle(0,0,u.pixelWitdh/u.cellX,u.pixelHeight),r=new Array,s=0;s<u.cellX;s++)r.push(new _.Rectangle(u.pixelX+s*a.width,u.pixelY,a.width,a.height));this.fontData_Unit["BNUM"+o]=r}}},f.prototype.writeFontToCtxLeft=function(t,e,i,n,o,a){void 0===i&&(i=f.num1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0);for(var r,s=this.fontData[i],u=0,h=0;h<e.length;h++){r=this.getCharId(e[h]);var l=this.getRect(r,i,s);if(!l)return;t.drawImage(_.UIData.textImg,l.x,l.y,l.width,l.height,u+n,o,l.width,l.height),u+=l.width-a}return u},f.prototype.writeFontToCtxRight=function(t,e,i,n,o,a){void 0===i&&(i=f.White),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0);for(var r,s=this.fontData[i],u=0,h=this.getAirFontWidth(t,e,i,a),l=0;l<e.length;l++){r=this.getCharId(e[l]);var c=this.getRect(r,i,s);t.drawImage(_.UIData.textImg,c.x,c.y,c.width,c.height,u+n-h,o,c.width,c.height),u+=c.width-a}return h},f.prototype.writeFontToCtxCenten=function(t,e,i,n,o,a){void 0===i&&(i=f.White),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0);for(var r,s=this.fontData[i],u=0,h=this.getAirFontWidth(t,e,i,a)/2,l=0;l<e.length;l++){r=this.getCharId(e[l]);var c=this.getRect(r,i,s);t.drawImage(_.UIData.textImg,c.x,c.y,c.width,c.height,u+n-h,o,c.width,c.height),u+=c.width-a}return h},f.prototype.writeFontToSkinName=function(t,e,i,n,o,a,r){void 0===n&&(n=f.ORANGE_TXT),void 0===o&&(o=_.TextAlign.LEFT),void 0===a&&(a=0),void 0===r&&(r=0);var s,u=t.getRec(e);return t.ctx=_.UIManager.getInstance().getContext2D(u.pixelWitdh,u.pixelHeight,!1),o==_.TextAlign.LEFT?s=this.writeFontToCtxLeft(t.ctx,i,n,0,r,a):o==_.TextAlign.RIGHT?s=this.writeFontToCtxRight(t.ctx,i,n,u.pixelWitdh,r,a):o==_.TextAlign.CENTER&&(s=this.writeFontToCtxCenten(t.ctx,i,n,u.pixelWitdh/2,r,a)),_.TextureManager.getInstance().updateTexture(t.texture,u.pixelX,u.pixelY,t.ctx),s},f.prototype.writeFontToSkinNameCenter=function(t,e,i,n,o){void 0===n&&(n=f.ORANGE_TXT),void 0===o&&(o=0);var a=t.getRec(e);t.ctx=_.UIManager.getInstance().getContext2D(a.pixelWitdh,a.pixelHeight,!1);for(var r,s=a.pixelWitdh/2,u=a.pixelHeight/2,h=this.fontData[n],l=0,c=this.getAirFontWidth(t.ctx,i,n,o)/2,p=0;p<i.length;p++){r=this.getCharId(i[p]);var d=this.getRect(r,n,h);t.ctx.drawImage(_.UIData.textImg,d.x,d.y,d.width,d.height,l+s-c,u-d.height/2,d.width,d.height),l+=d.width-o}_.TextureManager.getInstance().updateTexture(t.texture,a.pixelX,a.pixelY,t.ctx)},f.prototype.getAirFontWidth=function(t,e,i,n){if(void 0===i&&(i=f.White),void 0===n&&(n=0),null==e)return 0;for(var o,a=this.fontData[i],r=0,s=0;s<e.length;s++){o=this.getCharId(e[s]);var u=this.getRect(o,i,a);u||console.error("---$str---",e),r+=u.width-n}return r},f.prototype.getRect=function(t,e,i){return 15<t?this.fontData_Unit["B"+e][t-16]:i[t]},f.prototype.upArtFont=function(t,e,i,n,o,a){void 0===n&&(n=12),void 0===o&&(o=f.White),void 0===a&&(a=_.TextAlign.LEFT);var r=n/12,s=this.fontData[o],u=t.getRec(e);t.ctx=_.UIManager.getInstance().getContext2D(u.pixelWitdh,u.pixelHeight,!1);var h=this.getTotalWandDraw(u,i,s,r,t.ctx,!1),l=this.getXpos(a,h,new _.Rectangle(0,0,u.pixelWitdh,u.pixelHeight));this.getTotalWandDraw(u,i,s,r,t.ctx,!0,l),_.TextureManager.getInstance().updateTexture(t.texture,u.pixelX,u.pixelY,t.ctx)},f.prototype.upArtBase=function(t,e,i,n,o){void 0===n&&(n=f.White),void 0===o&&(o=_.TextAlign.LEFT);var a=this.fontData[n],r=t.getRec(e);t.ctx=_.UIManager.getInstance().getContext2D(r.pixelWitdh,r.pixelHeight,!1);var s=this.getTotalWandDraw(r,i,a,1,t.ctx,!1),u=this.getXpos(o,s,new _.Rectangle(0,0,r.pixelWitdh,r.pixelHeight));this.getTotalWandDraw(r,i,a,1,t.ctx,!0,u),_.TextureManager.getInstance().updateTexture(t.texture,r.pixelX,r.pixelY,t.ctx)},f.prototype.getXpos=function(t,e,i){var n=0;return t==_.TextAlign.LEFT?n=0:t==_.TextAlign.RIGHT?n=e-i.width:t==_.TextAlign.CENTER&&(n=(i.width-e)/2),n},f.prototype.getTotalWandDraw=function(t,e,i,n,o,a,r,s){void 0===r&&(r=0),void 0===s&&(s=0);for(var u=0,h=0;h<e.length;h++){var l=i[this.getCharId(e[h])];a&&o.drawImage(_.UIData.textImg,l.x,l.y,l.width,l.height,t.x+u+r,t.y,l.width*n,l.height*n),u+=(l.width-s)*n}return u},f.prototype.getCharId=function(t){return"+"==t||"x"==t||"X"==t?10:"-"==t?11:"/"==t?12:":"==t?13:"."==t?14:"%"==t?15:"万"==t?16:"亿"==t?17:"["==t?18:"]"==t?19:(NaN==Number(t)&&alert("MeshVo,GetCharId error:"+t),Number(t))},f.Red="Red",f.Green="Green",f.Blue="Blue",f.White="White",f.Yellow="Yellow",f.BOSSBIGTXT="NUM99",f.CN1="NUM100",f.num101="NUM101",f.num102="NUM102",f.BigYellow="NUM12",f.num99="NUM99",f.GARY_TXT="NUM1",f.ORANGE_TXT="NUM19",f.num1="NUM1",f.num2="NUM2",f.num3="NUM3",f.num4="NUM4",f.num5="NUM5",f.num6="NUM6",f.num7="NUM7",f.num10="NUM10",f.num8="NUM8",f.num9="NUM9",f.num11="NUM11",f.num12="NUM12",f.num13="NUM13",f.num14="NUM14",f.num15="NUM15",f.num16="NUM16",f.num17="NUM17",f.num18="NUM18",f.num19="NUM19",f.num20="NUM20",f.num21="NUM21",f.num22="NUM22",f.num23="NUM23",f.num24="NUM24",f.num25="NUM24",f.num26="NUM26",f.num27="NUM27",f.num28="NUM28",f.num30="NUM30",f.num51="NUM51",f.num52="NUM52",f.num53="NUM53",f.num54="NUM54",f.num55="NUM55",f.num56="NUM56",f.num57="NUM57",f.num58="NUM58",f.num59="NUM59",f.num60="NUM60",f.num61="NUM61",f.numVip="NUM62",f.num63="NUM63",f.num64="NUM64",f.num65="NUM65",f.num66="NUM66",f.num76="NUM76",f.num77="NUM77",f.num81="NUM81",f);function f(){this.fontData=new _.Dictionary([]),this.fontData_Unit=new _.Dictionary([]),this.makeFontRect()}_.ArtFont=t}(tl3d=tl3d||{}),function(t){var e=(i.chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i.encode=function(t){var e,i=new Uint8Array(t),n=i.length,o="";for(e=0;e<n;e+=3)o+=this.chars[i[e]>>2],o+=this.chars[(3&i[e])<<4|i[e+1]>>4],o+=this.chars[(15&i[e+1])<<2|i[e+2]>>6],o+=this.chars[63&i[e+2]];return n%3==2?o=o.substring(0,o.length-1)+"=":n%3==1&&(o=o.substring(0,o.length-2)+"=="),o},i.decode=function(t){var e,i,n,o,a,r=.75*t.length,s=t.length,u=0;"="===t[t.length-1]&&(r--,"="===t[t.length-2]&&r--);var h=new ArrayBuffer(r),l=new Uint8Array(h);for(e=0;e<s;e+=4)i=this.chars.indexOf(t[e]),n=this.chars.indexOf(t[e+1]),o=this.chars.indexOf(t[e+2]),a=this.chars.indexOf(t[e+3]),l[u++]=i<<2|n>>4,l[u++]=(15&n)<<4|o>>2,l[u++]=(3&o)<<6|63&a;return h},i);function i(){}t.Base64=e}(tl3d=tl3d||{}),function(b){var a=function(){};b.TextRegVo=a;var g=(T.pushStr=function(t){this.item=new Array;for(var e,i=/\[\]|\[[A-Za-z0-9]{6}\]/g;null!=(e=i.exec(t));){var n=new a;n.begin=e.index,n.end=i.lastIndex,n.color=e.toString(),n.color=n.color.replace("[",""),n.color=n.color.replace("]",""),n.color.length<5?n.color=T.defaultColor:n.color="#"+n.color,this.item.push(n)}},T.pushStrCopy=function(t){this.item=new Array;for(var e,i=/\[\]|\[[A-Za-z0-9]{6}\]/g,n=t;null!=(e=i.exec(t));){var o=new a;o.begin=e.index,o.end=i.lastIndex,o.color=e.toString(),n=n.replace(o.color,"#"),o.color=o.color.replace("[",""),o.color=o.color.replace("]",""),o.color.length<5?o.color=T.defaultColor:(t.replace("["+o.color+"]","#"),o.color="#"+o.color),this.item.push(o)}return n},T.isColor=function(t,e){for(var i=0;i<this.item.length;i++)if(t>=this.item[i].begin&&t<this.item[i].end)return e&&(e.fillStyle=this.item[i].color),!0;return!1},T.getTextMetrics=function(t,e){e=e||"",this.pushStr(e);for(var i=e,n="",o=0;o<i.length;o++)this.isColor(o,t)||(n+=i[o]);return t.measureText(n)},T.getTextOnlyTxt=function(t,e){e=e||"",this.pushStr(e);for(var i=e,n="",o=0;o<i.length;o++)this.isColor(o,t)||(n+=i[o]);return n},T.getNextWords=function(t,e){if("/"==t[e]&&t.length>e+2)for(var i=t[e+0]+t[e+1]+t[e+2],n=0;n<b.UIData.faceItem.length;n++)if(b.UIData.faceItem[n]==i)return n+1;return-1},T.wrapText=function(t,e,i,n,o,a,r,s,u,h,l){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=500),void 0===r&&(r=10),void 0===s&&(s=12),void 0===u&&(u=""),void 0===h&&(h=2),void 0===l&&(l=1),T.defaultColor=i,a*=.98,""!=u&&(-1!=u.indexOf("[")&&(u="#"+u.substr(1,6)),t.strokeStyle=u,t.lineWidth=h),this.pushStr(e);for(var c=e,p="",d=0,_=1,f=0;c&&f<c.length;f++)if(!this.isColor(f,t)){var g=t.measureText(p.replace("\n","")),y=this.getNextWords(c,f);if(-1==y)g.width>a||"\n"==c[f]?(d+=r,p="",_++,"\n"!=c[f]&&(""!=u&&t.strokeText(c[f],n,o+d),t.fillText(c[f],n,o+d))):(""!=u&&t.strokeText(c[f],n+g.width*l,o+d),t.fillText(c[f],n+g.width*l,o+d)),"\n"!=c[f]&&(p+=c[f]);else{var m=1.4*s,v=new b.Rectangle(n+ +g.width+0,o+d-m/10,m,m);g.width>a&&(d+=r,p="",_++,v=new b.Rectangle(n+0,o+d-m/10,m,m)),this.drawFaceIcon(t,v,y),f+=2,p+="脸1"}}return _},T.wrapTextVertical=function(t,e,i,n,o,a,r,s,u,h,l){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=500),void 0===r&&(r=10),void 0===s&&(s=12),void 0===u&&(u=""),void 0===h&&(h=4),void 0===l&&(l=1),T.defaultColor=i,""!=u&&(-1!=u.indexOf("[")&&(u="#"+u.substr(1,6)),t.strokeStyle=u,t.lineWidth=h),this.pushStr(e);for(var c=e,p=2,d=1,_=0,f=0;c&&f<c.length;f++)this.isColor(f,t)||-1==this.getNextWords(c,f)&&(a<_||"\n"==c[f]?(p+=r,_=0,"\n"!=c[f]&&(""!=u&&t.strokeText(c[f],n+p,_),t.fillText(c[f],n+p,_)),d++):(_+=s+5,""!=u&&t.strokeText(c[f],n+p,_),t.fillText(c[f],n+p,_)),c[f]);return d},T.drawText=function(t,e,i,n,o,a){void 0===n&&(n=500),void 0===o&&(o=10),void 0===a&&(a=12),T.defaultColor=i;for(var r=this.pushStrCopy(e),s=0,u=0,h="",l=0,c=new Array,p=r.split("#"),d=0;d<p.length;d++){var _=p[d];if(""!=_){t.fillStyle=0<d?this.item[d-1].color:i;for(var f=0;f<_.length;f++)if("\n"==_[f]){var g=new w(h,u,t.measureText(h).width,t.fillStyle,n);c.push(g),l=0,h="",u+=o}else{var y=h+_[f],m=t.measureText(y).width+l;s=Math.min(n,m),n<m?(g=new w(h,u,t.measureText(h).width,t.fillStyle,n),c.push(g),h=_[f]+"",u+=o,l=0):h=y}l+=t.measureText(h).width,g=new w(h,u,t.measureText(h).width,t.fillStyle,n),c.push(g),h=""}}for(var v,b=-1e4,I=0;I<c.length;I++)b!=c[I].posy&&(b=c[I].posy,v=this.getStartPoint(c[I],c),v=Math.max(v,0)),t.fillStyle=c[I].color,t.fillText(c[I].str,v,b),v+=c[I].width;return[s,u+=o]},T.getStartPoint=function(t,e){for(var i=new Array,n=0;n<e.length;n++){var o=e[n];t.posy==o.posy&&i.push(o)}for(var a=0,r=0;r<i.length;r++)a+=i[r].width;return(t.maxwidth-a)/2},T.drawFaceIcon=function(t,e,i){b.UiDraw.cxtDrawImg(t,"F_FACE_"+i,e,b.UIData.publicUi)},T.defaultColor="#000000",T);function T(){}b.TextRegExp=g;var w=function(t,e,i,n,o){this.str=t,this.posy=e,this.width=i,this.color=n,this.maxwidth=o};b.TextCell=w;var t=(e.writeSingleLabel=function(t,e,i,n,o,a,r,s,u,h){void 0===n&&(n=12),void 0===o&&(o=b.TextAlign.CENTER),void 0===a&&(a="#ffffff"),void 0===r&&(r=""),void 0===s&&(s=0),void 0===u&&(u=4),void 0===h&&(h=!0),-1!=a.indexOf("[")&&(a="#"+a.substr(1,6));var l=t.getRec(e),c=b.UIManager.getInstance().getContext2D(l.pixelWitdh,l.pixelHeight,!1);c.fillStyle=a,c.font=(h?"bolder ":"")+" "+n+"px "+b.UIData.font;var p=g.getTextMetrics(c,i),d=0;return o==b.TextAlign.CENTER?d=(l.pixelWitdh-p.width)/2:o==b.TextAlign.RIGHT&&(d=l.pixelWitdh-p.width),g.wrapText(c,i,a,d,s,l.pixelWitdh-n/2,20,n,r,u),t.updateCtx(c,l.pixelX,l.pixelY),p.width},e.writeTextLabel=function(t,e,i,n,o,a,r,s,u,h,l){void 0===n&&(n=12),void 0===o&&(o=b.TextAlign.CENTER),void 0===a&&(a=500),void 0===r&&(r="#ffffff"),void 0===s&&(s=""),void 0===u&&(u=0),void 0===h&&(h=4),void 0===l&&(l=!0),-1!=r.indexOf("[")&&(r="#"+r.substr(1,6));var c=n+4,p=t.getRec(e),d=b.UIManager.getInstance().getContext2D(p.pixelWitdh,p.pixelHeight,!1);d.fillStyle=r,d.textAlign=o,d.font=(l?"bolder ":"")+" "+n+"px "+b.UIData.font;var _=g.getTextMetrics(d,i),f=g.wrapText(d,i,r,0,u,a,c,n,s,h);return t.updateCtx(d,p.pixelX,p.pixelY),[_.width,f*c]},e.writeSingleLabelToCtx=function(t,e,i,n,o,a,r,s,u){void 0===i&&(i=12),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=b.TextAlign.CENTER),void 0===r&&(r="#ffffff"),void 0===s&&(s=""),void 0===u&&(u=!0),-1!=r.indexOf("[")&&(r="#"+r.substr(1,6)),t.fillStyle=r,t.font=(u?"bolder ":"")+" "+i+"px "+b.UIData.font;var h=g.getTextMetrics(t,e);return a==b.TextAlign.CENTER?n+=(t.canvas.width-h.width)/2:a==b.TextAlign.RIGHT&&(n+=t.canvas.width-h.width),g.wrapText(t,e,r,n,o,9999,20,i,s),h.width},e.writeSingleLabelToCtxByVertical=function(t,e,i,n,o,a,r,s){void 0===i&&(i=12),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a="#ffffff"),void 0===r&&(r=""),void 0===s&&(s=!0),-1!=a.indexOf("[")&&(a="#"+a.substr(1,6)),t.fillStyle=a,t.font=(s?"bolder ":"")+" "+i+"px "+b.UIData.font,g.wrapTextVertical(t,e,a,n,o,9999,20,i,r)},e.writeSingleLabelToCtxSetAnchor=function(t,e,i,n,o,a,r,s,u){void 0===i&&(i=12),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=b.TextAlign.CENTER),void 0===r&&(r="#ffffff"),void 0===s&&(s=""),void 0===u&&(u=!0),-1!=r.indexOf("[")&&(r="#"+r.substr(1,6)),t.fillStyle=r,t.font=(u?"bolder ":"")+" "+i+"px "+b.UIData.font;var h=g.getTextMetrics(t,e);return a==b.TextAlign.CENTER?n-=h.width/2:a==b.TextAlign.RIGHT&&(n-=h.width),g.wrapText(t,e,r,n,o,9999,20,i,s),h.width},e.writeText=function(t,e,i,n,o,a,r,s,u,h){void 0===s&&(s=0),void 0===u&&(u=!1),void 0===h&&(h=b.TextAlign.LEFT),-1!=r.indexOf("[")&&(r="#"+r.substr(1,6));var l,c=t.getRec(e),p=b.UIManager.getInstance().getContext2D(c.pixelWitdh,c.pixelHeight,!1);return p.fillStyle=r,p.font=(u?"bolder ":"")+a+"px "+b.UIData.font,p.textAlign=h,this.getTextxpos(h,p),l=this.wrapText(p,o,i,n,s,a+5),t.updateCtx(p,c.pixelX,c.pixelY),l},e.writeTextAutoCenterByAnchor=function(t,e,i,n,o,a,r,s){void 0===r&&(r=!0),void 0===s&&(s=""),-1!=o.indexOf("[")&&(o="#"+o.substr(1,6));var u=t.getRec(e),h=b.UIManager.getInstance().getContext2D(u.pixelWitdh,u.pixelHeight,!1);h.fillStyle=o,h.font=(r?"bolder ":"")+n+"px "+b.UIData.font,h.textAlign=b.TextAlign.LEFT;var l=g.drawText(h,i,o,a,n+5,n);return t.updateCtx(h,u.pixelX,u.pixelY),l},e.writeTextAutoVerticalCenter=function(t,e,i,n,o,a,r,s){void 0===r&&(r=""),void 0===s&&(s=!1),-1!=o.indexOf("[")&&(o="#"+o.substr(1,6));var u=t.getRec(e),h=b.UIManager.getInstance().getContext2D(u.pixelWitdh,u.pixelHeight,!1);h.fillStyle=o,h.font=(s?"bolder ":"")+n+"px "+b.UIData.font;var l=0;this.getTextxpos(b.TextAlign.LEFT,h),0<a&&(this.isNewline(h,i,a)||(l=u.pixelHeight/2-n/2),g.wrapText(h,i,o,0,l,a,n+3,n,r)),t.updateCtx(h,u.pixelX,u.pixelY)},e.writeTextAutoCenter=function(t,e,i,n,o,a,r){void 0===r&&(r=!1),-1!=o.indexOf("[")&&(o="#"+o.substr(1,6));var s=t.getRec(e),u=b.UIManager.getInstance().getContext2D(s.pixelWitdh,s.pixelHeight,!1);u.fillStyle=o,u.font=(r?"bolder ":"")+n+"px "+b.UIData.font;var h=0,l=0;if(this.getTextxpos(b.TextAlign.LEFT,u),0<a){if(!this.isNewline(u,i,a)){var c=u.measureText(i);l=s.pixelHeight/2-n/2,h=s.pixelWitdh/2-c.width/2}g.wrapText(u,i,o,h,l,a,n+3)}t.updateCtx(u,s.pixelX,s.pixelY)},e.isNewline=function(t,e,i){var n=e;return i<t.measureText(n).width},e.getTextxpos=function(t,e){var i=0;return t==b.TextAlign.LEFT?i=0:t==b.TextAlign.RIGHT?i=e.canvas.width:t==b.TextAlign.CENTER&&(i=e.canvas.width/2),i},e.wrapText=function(t,e,i,n,o,a){for(var r=0,s=n,u=e,h="",l=0;l<u.length;l++)if("\n"==u[l])t.fillText(h,i,s),h="",s+=a;else{var c=h+u[l],p=t.measureText(c).width;r=Math.max(r,p),o<p?(t.fillText(h,i,s),h=u[l]+"",s+=a):h=c}return t.fillText(h,i,s),[r,s=s-n+a]},e.clearLabel=function(t,e){var i=t.getRec(e),n=b.UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1);t.updateCtx(n,i.pixelX,i.pixelY)},e);function e(){}b.LabelTextFont=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(p){var d=(t.NORMALDAMAGE=1,t.CRIT=2,t.DODGE=3,t.TREATMENT=4,t.VERTIGO=5,t.FREEZE=6,t.ATTACKADD=7,t.ATTACKREDUCE=8,t.EXPERIENCE=9,t.NORMALDAMAGEUP=11,t.CRITUP=12,t.MYNORMALDAMAGE=13,t.MYNORMALDAMAGEUP=14,t.MISS=15,t.N_NORMALDAMAGE=16,t.N_CRIT=17,t.N_RESISTANCE=18,t.N_RESISTANCES=181,t.N_IMMUNE=19,t.N_ONCEATTACK=20,t.N_PASSIVE=21,t.N_RESURGENCE=22,t.N_UPHP=23,t.N_BEATBACK=24,t.N_DOWNHP=25,t.N_BOMB=26,t.N_DIZZY=27,t.N_INVINCIBLE=28,t.N_TARGET=29,t.N_SARCASM=30,t.N_SILENCE=31,t.N_SHIELD=32,t.N_BLEED=33,t.N_SLEEP=34,t.N_CRIT_RATE_UP=35,t.N_RESIST_RATE_UP=36,t.N_ATTACK_UP=37,t.N_DEFENSE_UP=38,t.N_SPEED_UP=39,t.N_HIT_UP=40,t.N_CRIT_RATE_DOWN=41,t.N_RESIST_RATE_DOWN=42,t.N_ATTACK_DOWN=43,t.N_DEFENSE_DOWN=44,t.N_SPEED_DOWN=45,t.N_HIT_DOWN=46,t.N_SHIHUA=47,t.N_MEIHUO=48,t.N_SHUFU=49,t.N_BINGFENG=50,t.N_ZHONGDU=51,t.N_LEIDIAN=52,t.N_ANGER_DOWN=53,t.N_WANGLING=54,t.N_MABI=55,t.N_FENNU=56,t.N_FANTAN=57,t.N_SHARE=58,t.N_ZHUOSHAO=59,t);function t(){}p.TextJumpType=d;function e(){}p.TextJumpUiVo=e;var i,n=(i=p.Disp2DBaseText,__extends(o,i),o.prototype.makeData=function(){if(this._data){var t=this._data;switch(this.dtime=t.endtime,this.pos=t.pos,t.type){case d.EXPERIENCE:this._width=this.drawTxtBydigitalAndtext(t)}}},o.prototype.drawTxtBydigitalAndtext=function(t){var e,i=this.parent.uiAtlas.getRec(this.textureStr),n=p.UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1),o=t.type;t.type==d.EXPERIENCE&&(e=p.ArtFont.num54);var a=p.ArtFont.getInstance().getAirFontWidth(n,String(this._data.str),e);return a+=50,p.UiDraw.cxtDrawImg(n,"TYPE"+o,new p.Rectangle(i.pixelWitdh-a,i.pixelHeight-25,50,25),p.UIData.publicUi),p.ArtFont.getInstance().writeFontToCtxLeft(n,String(this._data.str),e,i.pixelWitdh-a+50+2,i.pixelHeight-25),p.TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,i.pixelX,i.pixelY,n),a},o.prototype.update=function(){if(this._data){if(this.time=p.TimeUtil.getTimer(),this.time>=this.dtime)return this.ui&&this.ui.parent&&this.ui.parent.removeChild(this.ui),void(this._data=null);this._data;var t=this.changerules(this.time);this.ui.width=256*t[2],this.ui.height=50*t[3],this.ui.y=t[1]-this.ui.height,this.ui.x=t[0]-this.ui.width/2+25,this.ui.alpha=t[4]}},o.prototype.changerules=function(t){var e=new Array,i=this._data;t=(t-i.starttime)/1e3*60;var n=0,o=0,a=0,r=0,s=0;if(i.type==p.TextJumpType.EXPERIENCE){var u=new p.Vector2D;t<0?u.x=-9999:(u.x=300/p.UIData.Scale,u.y=p.Scene_data.stageHeight/p.UIData.Scale-50),o=u.y-=15,o-=.5*t,t<40?(n=u.x,r=a=1.8,s=1):t<60&&(n=u.x,r=a=1.8,s=1-(t-39)/20)}return e.push(n),e.push(o),e.push(a),e.push(r),e.push(s),e.push(u.x),e.push(u.y),this._lastchange=e},o);function o(){return null!==i&&i.apply(this,arguments)||this}p.ExpTextJumpUiDrawAndRefreash=n;var a,r=(a=p.Disp2DBaseText,__extends(s,a),s.prototype.makeData=function(){if(this._data){var t=this._data;switch(this.dtime=t.endtime,this.pos=t.pos,t.type){case d.NORMALDAMAGE:case d.TREATMENT:this._width=p.ArtFont.getInstance().writeFontToSkinName(this.parent.uiAtlas,this.textureStr,String(t.str),"NUM"+(t.type+50),p.TextAlign.RIGHT);break;case d.MYNORMALDAMAGEUP:case d.MYNORMALDAMAGE:this._width=p.ArtFont.getInstance().writeFontToSkinName(this.parent.uiAtlas,this.textureStr,String(t.str),p.ArtFont.num53,p.TextAlign.RIGHT);break;case d.NORMALDAMAGEUP:this._width=p.ArtFont.getInstance().writeFontToSkinName(this.parent.uiAtlas,this.textureStr,String(t.str),"NUM"+(t.type+40),p.TextAlign.RIGHT);break;case d.DODGE:case d.VERTIGO:case d.FREEZE:case d.MISS:this._width=this.drawTxtBytext(t);break;case d.ATTACKADD:case d.ATTACKREDUCE:case d.EXPERIENCE:case d.CRIT:case d.CRITUP:this._width=this.drawTxtBydigitalAndtext(t);break;case d.N_IMMUNE:case d.N_ONCEATTACK:case d.N_RESURGENCE:case d.N_RESISTANCES:this._width=this.drawTxtBytext(t,p.UIData.publicsUi);break;case d.N_NORMALDAMAGE:case d.N_UPHP:var e=t.type==d.N_NORMALDAMAGE?"NUM81":"NUM76";this._width=p.ArtFont.getInstance().writeFontToSkinName(this.parent.uiAtlas,this.textureStr,String(t.str),e,p.TextAlign.RIGHT,0,29);break;case d.N_PASSIVE:this._width=this.drawTxtBydigitalAndtext(t);break;case d.N_CRIT:case d.N_RESISTANCE:this._width=this.drawCritTxt(t)}t.type>=d.N_BEATBACK&&t.type<=d.N_ZHUOSHAO&&(this._width=this.drawTxtBytext(t,p.UIData.publicsUi))}},s.prototype.drawCritTxt=function(t){var e,i=this.parent.uiAtlas.getRec(this.textureStr),n=p.UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1),o=t.type,a=50,r=25;t.type==d.N_CRIT&&(e=p.ArtFont.num77,a=68,r=36),t.type==d.N_RESISTANCE&&(e=p.ArtFont.num81,a=68,r=36);var s=p.ArtFont.getInstance().getAirFontWidth(n,String(this._data.str),e),u=Math.max(s,a),h=i.pixelWitdh-u/2-a/2,l=i.pixelWitdh-u/2-s/2,c=0;return p.UiDraw.cxtDrawImg(n,"TYPE"+o,new p.Rectangle(h,c,a,r),p.UIData.publicsUi),c=i.pixelHeight-35,p.ArtFont.getInstance().writeFontToCtxLeft(n,String(this._data.str),e,l,c),p.TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,i.pixelX,i.pixelY,n),u},s.prototype.drawTxtBytext=function(t,e){void 0===e&&(e=p.UIData.publicUi);var i=this.parent.uiAtlas.getRec(this.textureStr),n=p.UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1),o=84;return t.type==d.N_ONCEATTACK||t.type==d.N_DOWNHP?o=167:t.type==d.N_CRIT_RATE_UP||t.type==d.N_CRIT_RATE_DOWN?o=156:t.type!=d.N_RESIST_RATE_UP&&t.type!=d.N_RESIST_RATE_DOWN&&t.type!=d.N_ATTACK_UP&&t.type!=d.N_ATTACK_DOWN&&t.type!=d.N_SPEED_UP&&t.type!=d.N_SPEED_DOWN&&t.type!=d.N_HIT_UP&&t.type!=d.N_HIT_UP&&t.type!=d.N_DEFENSE_UP&&t.type!=d.N_DEFENSE_DOWN||(o=115),p.UiDraw.cxtDrawImg(n,"TYPE"+t.type,new p.Rectangle(i.pixelWitdh-o,i.pixelHeight-44,o,44),e),p.TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,i.pixelX,i.pixelY,n),o},s.prototype.drawTxtBydigitalAndtext=function(t){var e,i=this.parent.uiAtlas.getRec(this.textureStr),n=p.UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1),o=t.type,a=50,r=25;t.type==d.ATTACKREDUCE?(o=d.ATTACKADD,e=p.ArtFont.num53):t.type==d.ATTACKADD||t.type==d.EXPERIENCE?e=p.ArtFont.num54:t.type==d.CRIT?(e=p.ArtFont.num55,a=78,r=50):t.type==d.CRITUP&&(o-=10,a=78,r=50,e=p.ArtFont.num55),t.type==d.N_PASSIVE&&(e=p.ArtFont.num76,a=84,r=44);var s=p.ArtFont.getInstance().getAirFontWidth(n,String(this._data.str),e);s+=a;var u=i.pixelWitdh-s,h=i.pixelHeight-r;return p.UiDraw.cxtDrawImg(n,"TYPE"+o,new p.Rectangle(u,h,a,r),t.type>=d.N_NORMALDAMAGE?p.UIData.publicsUi:p.UIData.publicUi),p.ArtFont.getInstance().writeFontToCtxLeft(n,String(this._data.str),e,u+a+2,6+h),p.TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,i.pixelX,i.pixelY,n),s},s.prototype.update=function(){if(this._data){if(this.time=p.TimeUtil.getTimer(),this.time>=this.dtime)return this.ui&&this.ui.parent&&this.ui.parent.removeChild(this.ui),void(this._data=null);this._data;var t=this.changerules(this.time);this.ui.width=256*t[2],this.ui.height=64*t[3],this.ui.y=t[1]-this.ui.height,this.ui.x=t[0],this.ui.alpha=t[4]}},s.prototype.changerules=function(t){var e=this._data;t=(t-e.starttime)/1e3*60;var i,n,o,a,r,s=new Array,u=this.Vector3DToVector2D(new p.Vector3D(this.pos.x,this.pos.y,this.pos.z));switch(e.type==p.TextJumpType.EXPERIENCE&&(u.x=300/p.UIData.Scale,u.y=p.Scene_data.stageHeight/p.UIData.Scale-50),e.type){case p.TextJumpType.NORMALDAMAGE:case p.TextJumpType.MYNORMALDAMAGE:i=u.x,t<4?(n=u.y-4*t,1.5<(o=t/4*1.3+.2)&&(o=1.5),a=o,1<(r=t/3*.8+.2)&&(r=1)):t<8?(n=this._lastchange[1]-2,a=o=this._lastchange[2]-1/6,1<(r=t/3*.8+.2)&&(r=1)):t<15?(n=this._lastchange[1]-2,a=o=this._lastchange[2]+1/6,1<(r=t/3*.8+.2)&&(r=1)):t<30?(n=this._lastchange[1]-2,a=o=this._lastchange[2]-.05,1<(r=t/3*.8+.2)&&(r=1)):t<72&&(n=t<50?this._lastchange[1]-2:this._lastchange[1]+2,i=this._lastchange[0]-1.5,a=o=this._lastchange[2],(r=this._lastchange[4]-.01)<0&&(r=0));break;case p.TextJumpType.CRIT:i=u.x,t<4?(n=u.y-4*t,1.5<(o=t/4*1.3+.2)&&(o=1.5),a=o,1<(r=t/3*.8+.2)&&(r=1)):t<8?(n=this._lastchange[1]-2,a=o=this._lastchange[2]-1/6,1<(r=t/3*.8+.2)&&(r=1)):t<15?(n=this._lastchange[1]-2,a=o=this._lastchange[2]+.25,1<(r=t/3*.8+.2)&&(r=1)):t<30?(n=this._lastchange[1]-2,a=o=this._lastchange[2]-.05,1<(r=t/3*.8+.2)&&(r=1)):t<100&&(n=t<50?this._lastchange[1]-2:this._lastchange[1]+2,i=this._lastchange[0]-1.5,a=o=this._lastchange[2],(r=this._lastchange[4]-.01)<0&&(r=0));break;case p.TextJumpType.NORMALDAMAGEUP:case p.TextJumpType.CRITUP:case p.TextJumpType.MYNORMALDAMAGEUP:i=u.x,t<4?(n=u.y-4*t,1.7<(o=t/4*1.5+.2)&&(o=1.7),a=o,.5<(r=t/3*.3+.2)&&(r=.5)):t<8?(n=this._lastchange[1]-2,a=o=this._lastchange[2]-.25,.5<(r=t/3*.3+.2)&&(r=.5)):t<15?(n=this._lastchange[1]-2,a=o=this._lastchange[2]+.25,.5<(r=t/3*.3+.2)&&(r=.5)):t<30&&(n=this._lastchange[1]-2,a=o=this._lastchange[2]-1/15,(r=this._lastchange[4]-1/80)<0&&(r=0));break;case p.TextJumpType.TREATMENT:i=u.x,n=u.y-1.5*t,t<12?(a=o=Math.ceil(t)/12*.8+.2,r=Math.ceil(t)/12*.8+.2):t<60&&(a=o=1,r=1-(t-11)/48);break;case p.TextJumpType.EXPERIENCE:n=u.y-=15,n-=.5*t,t<40?(i=u.x,a=o=1.3,r=1):t<60&&(i=u.x,a=o=1.3,r=1-(t-39)/20);break;case p.TextJumpType.ATTACKADD:case p.TextJumpType.ATTACKREDUCE:i=u.x+=110,n=u.y-1.8*t,t<12?(a=o=Math.ceil(t)/12*1.3+.1,r=Math.ceil(t)/12*.8+.2):t<24?(a=o=1.4-(t-11)/12*.4,r=1):t<60&&(a=o=1,r=1-(t-23)/36);break;case p.TextJumpType.DODGE:case p.TextJumpType.MISS:case p.TextJumpType.VERTIGO:case p.TextJumpType.FREEZE:i=u.x-=50,t<12?(n=u.y-3*t,a=o=1,r=Math.ceil(t)/12):t<36?(n=u.y-33,a=o=1,r=1):t<72&&(n=u.y-33-1.5*(t-36),a=o=1,r=1-(t-35)/36);break;case d.N_NORMALDAMAGE:case d.N_UPHP:case d.N_CRIT:case d.N_RESISTANCE:t<12?(a=o=Math.ceil(t)/12*1.1+.1,r=Math.ceil(t)/12*.8+.2):t<24?(a=o=this._lastchange[2]-.008,r=1):t<60&&(a=o=this._lastchange[2],r=1-(t-23)/36),n=u.y-1.5*t,i=u.x+60-256*o/2}if(e.type==d.N_IMMUNE||e.type==d.N_ONCEATTACK||e.type==d.N_RESURGENCE||e.type==d.N_RESISTANCES||e.type==d.N_PASSIVE||e.type>=d.N_BEATBACK&&e.type<=d.N_ZHUOSHAO){var h=e.type>=d.N_CRIT_RATE_DOWN&&e.type<=d.N_HIT_DOWN;i=u.x-45,t<12?(n=h?u.y+3*t:u.y-3*t,a=o=.8,r=Math.ceil(t)/12):t<36?(n=this._lastchange[1],a=o=.8,r=1):t<72&&(n=h?this._lastchange[1]+.05:this._lastchange[1]-.05,a=o=.8,r=1-(t-35)/36)}return s.push(i),s.push(n),s.push(o),s.push(a),s.push(r),s.push(u.x),s.push(u.y),this._lastchange=s},s);function s(){return null!==a&&a.apply(this,arguments)||this}p.TextJumpUiDrawAndRefreash=r;var u,h=(u=p.Disp2DBaseText,__extends(l,u),l.prototype.makeData=function(){this._data&&(this.charNameMeshVo=this.data,this.lastKey!=this.charNameMeshVo.name&&(this.ui.width=179.2,this.ui.height=22*.7,this.lastKey=this.charNameMeshVo.name,p.LabelTextFont.writeSingleLabel(this.parent.uiAtlas,this.textureStr,this.charNameMeshVo.name,this.charNameMeshVo.size,p.TextAlign.CENTER,this.charNameMeshVo.color,this.charNameMeshVo.scolor)),this.charNameMeshVo.needDraw=!1)},l.prototype.update=function(){if(this.charNameMeshVo){if(this.charNameMeshVo.needDraw&&this.makeData(),this.charNameMeshVo.pos)if(this.charNameMeshVo.visible){if(this.needUpData(this.charNameMeshVo.pos)||this.charNameMeshVo.visibleChange){var t=p.Scene_data.cam3D.cameraMatrix.clone(this.tempMatrix);t.append(p.Scene_data.viewMatrx3D);var e=t.transformVector(this.charNameMeshVo.pos);this.ui.x=(e.x/e.w+1)*(p.Scene_data.stageWidth/2)/p.UIData.Scale-this.ui.width/2,this.ui.y=(-e.y/e.w+1)*(p.Scene_data.stageHeight/2)/p.UIData.Scale-this.ui.height/2,this.oldPos.x=this.charNameMeshVo.pos.x,this.oldPos.y=this.charNameMeshVo.pos.y,this.charNameMeshVo.visibleChange=!1}}else this.ui.x=1e4;this.charNameMeshVo.clear&&(this.ui.parent.removeChild(this.ui),this._data=null)}},l);function l(){var t=null!==u&&u.apply(this,arguments)||this;return t.tempMatrix=new p.Matrix3D,t}p.CharNameUiVo=h;var c,_=(c=p.Disp2DBaseText,__extends(f,c),f.prototype.makeData=function(){var a=this;this._data&&(this._charTitleMeshVo=this.data,p.LoadManager.getInstance().load(p.Scene_data.fileRoot+getUItittleUrl(String(this._charTitleMeshVo.num)),p.LoadManager.IMG_TYPE,function(t){var e=a.parent.uiAtlas.getRec(a.textureStr);a.parent.uiAtlas.ctx=p.UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1);var i=Math.min(e.pixelWitdh/t.width,e.pixelHeight/t.height);i=Math.min(i,1);var n=t.width*i,o=t.height*i;a.parent.uiAtlas.ctx.drawImage(t,(e.pixelWitdh-n)/2,(e.pixelHeight-o)/2,n,o),p.TextureManager.getInstance().updateTexture(a.parent.uiAtlas.texture,e.pixelX,e.pixelY,a.parent.uiAtlas.ctx)}))},f.prototype.update=function(){if(this._charTitleMeshVo){if(this._charTitleMeshVo.needDraw&&(this.makeData(),this._charTitleMeshVo.needDraw=!1),this._charTitleMeshVo.pos)if(this._charTitleMeshVo.visible){if(this.needUpData(this._charTitleMeshVo.pos)){var t=p.Scene_data.cam3D.cameraMatrix.clone(this.tempMatrix);t.append(p.Scene_data.viewMatrx3D);var e=t.transformVector(this._charTitleMeshVo.pos);this.ui.x=(e.x/e.w+1)*(p.Scene_data.stageWidth/2)/p.UIData.Scale-this.ui.width/2,this.ui.y=(-e.y/e.w+1)*(p.Scene_data.stageHeight/2)/p.UIData.Scale-this.ui.height/2,this.oldPos.x=this._charTitleMeshVo.pos.x,this.oldPos.y=this._charTitleMeshVo.pos.y}}else this.ui.x=1e4;this._charTitleMeshVo.clear&&(this.ui.parent.removeChild(this.ui),this._data=null)}},f);function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.tempMatrix=new p.Matrix3D,t}p.CharTitleUiVo=_;var g=(Object.defineProperty(y.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,this.visibleChange=!0},enumerable:!0,configurable:!0}),y);function y(){this._visible=!0,this.visibleChange=!1,this.clear=!1}p.baseMeshVo=g}(tl3d=tl3d||{}),function(i){var t,e=(t=i.baseMeshVo,__extends(n,t),n.prototype.destory=function(){this.pos=null,this._num=null,this.clear=!0},Object.defineProperty(n.prototype,"num",{get:function(){return this._num},set:function(t){this._num=t,this.needDraw=!0},enumerable:!0,configurable:!0}),n);function n(){return null!==t&&t.apply(this,arguments)||this}i.CharTitleMeshVo=e;var o,a=(o=i.baseMeshVo,__extends(r,o),Object.defineProperty(r.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t,this.needDraw=!0},enumerable:!0,configurable:!0}),r.prototype.destory=function(){this.pos=null,this._name=null,this.needDraw=null,this.clear=!0},r);function r(){var t=null!==o&&o.apply(this,arguments)||this;return t.color="#ffffff",t.scolor="",t.size=20,t}i.CharNameMeshVo=a;var s,u=(s=i.baseMeshVo,__extends(h,s),h.prototype.destory=function(){this.pos=null,this.num=null,this.colortype=null,this.offsety=0},h);function h(){var t=null!==s&&s.apply(this,arguments)||this;return t.posx=-5,t.offsety=0,t}i.BloodLineMeshVo=u;var l,c=(l=i.baseMeshVo,__extends(p,l),p.prototype.destory=function(){this.pos=null,this.clear=!0},p);function p(){return null!==l&&l.apply(this,arguments)||this}i.JumpTextMeshVo=c;var d,_=(d=i.Dis2DUIContianerPanel,__extends(f,d),f);function f(t,e,i){return d.call(this,t,e,i)||this}i.JumpTxtContianerPanel=_;var g=(y.prototype.clearOneTemp=function(){for(var t=0;t<this.uiContianerItem.length;t++)this.uiContianerItem[t].clearOneTemp()},y.prototype.getCharNameMeshVo=function(t){void 0===t&&(t="测试名");var e=new a;return e.name=t,e.pos=new i.Vector3D(0,50,0),this._charNameContianerPanel.showTemp(e),e},y.prototype.setJumpNum=function(t){this._jumpTxtContianerPanel.showTemp(t)},y.prototype.update=function(){for(var t=0;t<this.uiContianerItem.length;t++){this.uiContianerItem[t].update(0);for(var e=0;e<this.uiContianerItem[t].renderList.length;e++)this.uiContianerItem[t].renderList[e].update()}},y.prototype.resize=function(){this._jumpTxtContianerPanel.resize();for(var t=0;t<this.uiContianerItem.length;t++)this.uiContianerItem[t].resize();i.Scene_data.cam3D.needChange=!0},y);function y(){this.uiContianerItem=new Array,this._charNameContianerPanel=new i.Dis2DUIContianerPanel(i.CharNameUiVo,new i.Rectangle(0,0,256,22),10),this._jumpTxtContianerPanel=new i.AlphaUiContianer(i.TextJumpUiDrawAndRefreash,new i.Rectangle(0,0,256,64),16),this.uiContianerItem.push(this._charNameContianerPanel),this.uiContianerItem.push(this._jumpTxtContianerPanel),this.resize()}i.BloodManager=g}(tl3d=tl3d||{}),function(i){var t=(e.prototype.getValue=function(t){if(!this.valueVec||-1==this.begintFrame)return this.valueV3d;var e=float2int(t/i.Scene_data.frameTime-this.begintFrame);return e<0?e=0:e>this.maxFrame-this.begintFrame&&(e=this.maxFrame-this.begintFrame),this.valueVec[e]},e.prototype.setData=function(t){this.type=t.type,this.maxFrame=t.maxFrame,t.items.length?this.begintFrame=t.items[0].frame:this.begintFrame=-1;for(var e=t.values[0].length,i=new Array,n=0;n<e;n++){var o=new Array;if(1==this.type)o.push(t.values[0][n]);else if(2==this.type)o.push(t.values[0][n],t.values[1][n]);else if(3==this.type)o.push(t.values[0][n],t.values[1][n],t.values[2][n]);else if(4==this.type){var a=t.values[3][n];o.push(t.values[0][n]*a,t.values[1][n]*a,t.values[2][n]*a,a)}i.push(o)}this.valueVec=i},e);function e(){this.valueV3d=[1,1,1,1]}i.Curve=t}(tl3d=tl3d||{}),function(t){var e=(Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,this.display.stateChage()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"x",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"z",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!0,configurable:!0}),i);function i(){this._visible=!1,this.data=[0,0,0,5]}t.Shadow=e}(tl3d=tl3d||{}),function(i){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.addShadow=function(){var t=this.getIdleShadow(),e=new i.Shadow;return t.addShadow(e),e},e.prototype.removeShadow=function(t){t.display.removeShadow(t)},e.prototype.update=function(){if(this._displayList.length){i.Scene_data.context3D.setWriteDepth(!1);for(var t=0;t<this._displayList.length;t++)this._displayList[t].update();i.Scene_data.context3D.setWriteDepth(!0)}},e.prototype.getIdleShadow=function(){for(var t=0;t<this._displayList.length;t++)if(this._displayList[t].hasIdle())return this._displayList[t];var e=new i.Display3dShadow;return this._displayList.push(e),e},e);function e(){this._displayList=new Array,i.ProgrmaManager.getInstance().registe(i.Display3DShadowShader.Display3DShadowShader,new i.Display3DShadowShader)}i.ShadowManager=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var t,e=(t=a.ResGC,__extends(i,t),i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.loadSceneRes=function(t,e,i,n){var o;return this._dic[t]?o=this._dic[t]:(o=new a.SceneRes,this._dic[t]=o),o.load(t,e,i,n),this.clearSceneUse(o),o},i.prototype.clearSceneUseById=function(t){var e=this._dic[t];e&&e.clearUseNum()},i.prototype.clearSceneUse=function(t){for(var e in this._dic){var i=this._dic[e];0<i.useNum&&i!=t&&(i.useNum=0)}t.useNum=1},i);function i(){return null!==t&&t.apply(this,arguments)||this}a.SceneResManager=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var e,t=(e=l.ResCount,__extends(i,e),i.prototype.read=function(t){void 0===t&&(t=null),this._imgFun=t;var e=this._byte.readInt();e==i.IMG_TYPE?l.Scene_data.supportBlob?this.readImg():this.readImgLow():e==i.OBJS_TYPE?this.readObj(this._byte):e==i.MATERIAL_TYPE?this.readMaterial():e==i.PARTICLE_TYPE?this.readParticle():e==i.ZIP_OBJS_TYPE&&this.readZipObj()},i.prototype.readZipObj=function(){var t=this._byte.readInt(),e=this._byte.buffer.slice(this._byte.position,this._byte.position+t);this._byte.position+=t;var i=unZip(e),n=new l.TLByteArray(i);this.readObj(n)},i.prototype.readImg=function(){var i=this;this.imgNum=this._byte.readInt(),this.imgLoadNum=0;for(var t=new Array,e=new Array,n=0;n<this.imgNum;n++){var o=l.Scene_data.fileRoot+this._byte.readUTF(),a=this._byte.readInt();if(-1==o.search(".jpng")){var r=this._byte.buffer.slice(this._byte.position,this._byte.position+a);this._byte.position+=a;var s=new Blob([r],{type:"application/octet-binary"});t.push(s),e.push(o)}else this.readJpngImg(o)}for(n=0;n<t.length;n++){var u=new Image;u.url=e[n],u.onload=function(t){i.addImg(t.target.url,t.target);var e=t.target;URL.revokeObjectURL(e.src)},u.src=URL.createObjectURL(t[n])}},i.prototype.readJpngImg=function(a){var r=this,t=this._byte.readInt(),e=this._byte.buffer.slice(this._byte.position,this._byte.position+t);this._byte.position+=t;var i=this._byte.readInt(),n=this._byte.buffer.slice(this._byte.position,this._byte.position+i);function o(t){if(!(++h<2)){var e=l.UIManager.getInstance().getContext2D(s.width,s.height);e.drawImage(s,0,0);var i=e.getImageData(0,0,s.width,s.height);e.clearRect(0,0,s.width,s.height),e.drawImage(u,0,0);for(var n=e.getImageData(0,0,s.width,s.height),o=0;o<i.data.length;o+=4)n.data[o],i.data[o+3]=n.data[o];r.addImg(a.replace(".jpng",".png"),i)}}this._byte.position+=i;var s=new Image,u=new Image,h=0;s.onload=o,u.onload=o,s.src="data:image/png;base64,"+l.Base64.encode(e),u.src="data:image/png;base64,"+l.Base64.encode(n)},i.prototype.readImgLow=function(){var e=this;this.imgNum=this._byte.readInt();for(var t=this.imgLoadNum=0,i=0;i<this.imgNum;i++){var n=this._byte.readUTF(),o=l.Scene_data.fileRoot+l.LoadManager.getInstance().getVersion(n);t+=this._byte.readInt();var a=new Image;a.url=o,this.urlCache[o]=l.Scene_data.fileRoot+n,a.onload=function(t){e.loadImg(t.target)},a.src=o}this.allImgBytes=t},i.prototype.loadImg=function(t){var e=this.urlCache[t.url]||t.url;l.TextureManager.getInstance().addRes(e,t),this.countImg()},i.prototype.addImg=function(t,e){l.TextureManager.getInstance().addRes(t,e),this.countImg()},i.prototype.countImg=function(){this.imgLoadNum++,this.imgLoadNum==this.imgNum&&(this._imgComplete=!0,this.allResCom())},i.prototype.readObj=function(t){for(var e=t.readInt(),i=0;i<e;i++){var n=l.Scene_data.fileRoot+t.readUTF(),o=t.readInt(),a=new l.TLByteArray;a.length=o,t.readBytes(a,0,o),l.ObjDataManager.getInstance().loadObjCom(a.buffer,n)}this._imgFun&&this._imgFun()},i.prototype.readMaterial=function(){for(var t=this._byte.readInt(),e=0;e<t;e++){var i=l.Scene_data.fileRoot+this._byte.readUTF(),n=this._byte.readInt(),o=new l.TLByteArray;o.length=n,this._byte.readBytes(o,0,n),l.MaterialManager.getInstance().addResByte(i,o)}},i.prototype.readParticle=function(){for(var t=this._byte.readInt(),e=0;e<t;e++){var i=l.Scene_data.fileRoot+this._byte.readUTF(),n=this._byte.readInt(),o=new l.TLByteArray;o.length=n,this._byte.readBytes(o,0,n),l.ParticleManager.getInstance().addResByte(i,o)}},i.prototype.readMaterialInfo=function(){var t=this._byte.readInt();if(0<t){for(var e=new Array,i=0;i<t;i++){var n=new Object;n.type=this._byte.readInt(),n.name=this._byte.readUTF(),0==n.type&&(n.url=this._byte.readUTF()),1==n.type&&(n.x=this._byte.readFloat()),2==n.type&&(n.x=this._byte.readFloat(),n.y=this._byte.readFloat()),3==n.type&&(n.x=this._byte.readFloat(),n.y=this._byte.readFloat(),n.z=this._byte.readFloat()),e.push(n)}return e}return null},i.readFloatTwoByte=function(t,e){var i=t.readInt();if(0<i)for(var n=t.readFloat(),o=e.length=0;o<i;o++)e.push(t.readFloatTwoByte(n))},i.readFloatOneByte=function(t,e){var i=t.readInt();if(0<i)for(var n=0;n<i;n++)e.push((t.readByte()+128)/256)},i.readIntForTwoByte=function(t,e){for(var i=t.readInt(),n=0;n<i;n++)e.push(t.readShort())},i.readIntForOneByte=function(t,e){for(var i=t.readInt(),n=0;n<i;n++)e.push(t.readByte())},i.readBytes2ArrayBuffer=function(t,e,i,n,o,a){void 0===a&&(a=0);var r=t.readInt();if(!(r<=0)){var s;0==a&&(s=t.readFloat());for(var u=r/i,h=0;h<u;h++)for(var l=o*h+n,c=0;c<i;c++)0==a?e.setFloat32(4*(l+c),t.readFloatTwoByte(s),!0):1==a?e.setFloat32(4*(l+c),t.readFloatOneByte(),!0):2==a?e.setFloat32(4*(l+c),t.readByte(),!0):3==a?e.setFloat32(4*(l+c),(t.readByte()+128)/255,!0):4==a&&e.setFloat32(4*(l+c),t.readFloat(),!0)}},i.readMaterialParamData=function(t){var e=t.readInt();if(0<e){for(var i=new Array,n=0;n<e;n++){var o=new Object;o.name=t.readUTF(),o.type=t.readByte(),0==o.type?o.url=t.readUTF():1==o.type?o.x=t.readFloat():2==o.type?(o.x=t.readFloat(),o.y=t.readFloat()):3==o.type&&(o.x=t.readFloat(),o.y=t.readFloat(),o.z=t.readFloat()),i.push(o)}return i}return null},i.prototype.allResCom=function(){this._imgFun&&this._imgFun()},i.IMG_TYPE=1,i.OBJS_TYPE=2,i.MATERIAL_TYPE=3,i.PARTICLE_TYPE=4,i.SCENE_TYPE=5,i.ZIP_OBJS_TYPE=6,i.PREFAB_TYPE=1,i.SCENE_PARTICLE_TYPE=11,i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.allImgBytes=1e7,t.urlCache={},t}l.BaseRes=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=a.BaseRes,__extends(i,e),i.prototype.load=function(t,e){var i=this;this._fun=e,a.LoadManager.getInstance().load(t,a.LoadManager.BYTE_TYPE,function(t){i.loadComplete(t)})},i.prototype.loadComplete=function(t){this._byte=new a.TLByteArray(t),this._byte.position=0,this.version=this._byte.readInt(),this.readMesh()},i.prototype.readMesh=function(){this.roleUrl=this._byte.readUTF(),16<=this.version&&(this.ambientLightColor=new a.Vector3D,this.sunLigthColor=new a.Vector3D,this.nrmDircet=new a.Vector3D,this.ambientLightColor.x=this._byte.readFloat(),this.ambientLightColor.y=this._byte.readFloat(),this.ambientLightColor.z=this._byte.readFloat(),this.ambientLightIntensity=this._byte.readFloat(),this.ambientLightColor.scaleBy(this.ambientLightIntensity),this.sunLigthColor.x=this._byte.readFloat(),this.sunLigthColor.y=this._byte.readFloat(),this.sunLigthColor.z=this._byte.readFloat(),this.sunLigthIntensity=this._byte.readFloat(),this.sunLigthColor.scaleBy(this.sunLigthIntensity),this.nrmDircet.x=this._byte.readFloat(),this.nrmDircet.y=this._byte.readFloat(),this.nrmDircet.z=this._byte.readFloat()),a.MeshDataManager.getInstance().readData(this._byte,this.meshBatchNum,this.roleUrl,this.version),this.readAction()},i.prototype.readAction=function(){var t,e=this;t=30<=this.version?getZipByte(this._byte):this._byte,this.actionAry=new Array;for(var i=t.readInt(),n=0;n<i;n++){var o=t.readUTF();a.AnimManager.getInstance().readData(t,this.roleUrl+o),this.actionAry.push(o)}this.read(function(){e.readNext()})},i.prototype.readNext=function(){this.read(),this.read(),this._fun()},i);function i(){var t=e.call(this)||this;return t.meshBatchNum=1,t}a.RoleRes=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(y){var e,t=(e=y.BaseRes,__extends(i,e),i.prototype.load=function(t,e){var i=this;this._fun=e,y.LoadManager.getInstance().load(t,y.LoadManager.BYTE_TYPE,function(t){i.loadComplete(t)})},i.prototype.loadComplete=function(t){var e=this;this._byte=new y.TLByteArray(t),this._byte.position=0,this.version=this._byte.readInt(),this.skillUrl=this._byte.readUTF(),this.read(function(){e.readNext()})},i.prototype.readNext=function(){this.read(),this.read(),this.version<27&&this._byte.readUTF(),this.data=this.readData(this._byte),this._fun()},i.prototype.readData=function(t){for(var e=t.readInt(),i=new Object,n=0;n<e;n++){var o=new Object,a=t.readUTF(),r=t.readUTF();if(o.skillname=a,o.action=r,o.type=t.readFloat(),26<=this.version?(o.blood=t.readInt(),0==o.blood&&(o.blood=y.SkillVo.defaultBloodTime)):o.blood=y.SkillVo.defaultBloodTime,32<=this.version){var s=t.readInt();if(0<s){var u=t.readUTF();o.sound={time:s,name:u}}}if(33<=this.version){var h=t.readInt();if(h){for(var l=new Array,c=0;c<h;c++){var p=new Object;p.time=t.readInt(),p.lasttime=t.readInt(),p.amp=t.readFloat(),l.push(p)}o.shock=l}}o.data=new Array;for(var d=t.readInt(),_=0;_<d;_++){var f=new Object;switch(f.url=t.readUTF(),f.frame=t.readFloat(),o.type){case 1:f.beginType=t.readInt(),0==f.beginType?(f.beginPos=new y.Vector3D,f.beginPos.x=t.readFloat(),f.beginPos.y=t.readFloat(),f.beginPos.z=t.readFloat()):1==f.beginType&&(f.beginSocket=t.readUTF()),f.hitSocket=t.readUTF(),f.endParticle=t.readUTF(),f.multype=t.readInt(),f.speed=t.readFloat();break;case 3:f.beginSocket=t.readUTF(),f.beginType=t.readFloat(),f.multype=t.readFloat(),f.speed=t.readFloat();break;case 4:if(27<=this.version){var g=t.readBoolean();(f.hasSocket=g)?f.socket=t.readUTF():(f.pos=this.readV3d(t),f.rotation=this.readV3d(t))}else f.hasSocket=!1,f.pos=this.readV3d(t),f.rotation=this.readV3d(t);break;default:alert("没有类型readData")}o.data.push(f)}i[a]=o}return i},i.prototype.readV3d=function(t){var e=new y.Vector3D;return e.x=t.readFloat(),e.y=t.readFloat(),e.z=t.readFloat(),e.w=t.readFloat(),e},i);function i(){var t=e.call(this)||this;return t.meshBatchNum=1,t}y.SkillRes=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.RoleRes,__extends(n,e),n);function n(){return null!==e&&e.apply(this,arguments)||this}t.RoleResLow=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=n.BaseRes,__extends(i,t),i.prototype.load=function(t,e){var i=this;this._fun=e,n.LoadManager.getInstance().load(t,n.LoadManager.BYTE_TYPE,function(t){i.loadComplete(t)})},i.prototype.loadComplete=function(t){var e=this;this._byte=new n.TLByteArray(t),this._byte.position=0,this.read(function(){e.readNexte()})},i.prototype.readNexte=function(){this.read(),this.read(),this.objUrl=this._byte.readUTF(),this.materialUrl=this._byte.readUTF(),this._byte.readBoolean()&&(this.light=new n.LightVo,this.light.ambientColor[0]=this._byte.readFloat(),this.light.ambientColor[1]=this._byte.readFloat(),this.light.ambientColor[2]=this._byte.readFloat(),this.light.sunColor[0]=this._byte.readFloat(),this.light.sunColor[1]=this._byte.readFloat(),this.light.sunColor[2]=this._byte.readFloat(),this.light.sunDirect[0]=this._byte.readFloat(),this.light.sunDirect[1]=this._byte.readFloat(),this.light.sunDirect[2]=this._byte.readFloat()),this._fun()},i);function i(){return null!==t&&t.apply(this,arguments)||this}n.ModelRes=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=n.BaseRes,__extends(i,e),i.prototype.load=function(t,e){var i=this;this._fun=e,n.LoadManager.getInstance().load(t,n.LoadManager.BYTE_TYPE,function(t){i.loadComplete(t)})},i.prototype.loadComplete=function(t){var e=this;this.dataAry=new Array,this._byte=new n.TLByteArray(t),this._byte.position=0,this.version=this._byte.readInt(),this.read(function(){e.readNext()})},i.prototype.readNext=function(){if(this.read(),this.read(),this.read(),this._byte.readBoolean())for(var t=this._byte.readInt(),e=0;e<t;e++)this.readItem(!0);else this.readItem(!1);this._fun(),this._fun=null,this._byte=null},i.prototype.readItem=function(t){var e=this._byte.readInt(),i=new a;(i.isGroup=t)&&(i.x=this._byte.readFloat(),i.y=this._byte.readFloat(),i.z=this._byte.readFloat(),i.scaleX=this._byte.readFloat(),i.scaleY=this._byte.readFloat(),i.scaleZ=this._byte.readFloat(),i.rotationX=this._byte.readFloat(),i.rotationY=this._byte.readFloat(),i.rotationZ=this._byte.readFloat()),e==n.BaseRes.PREFAB_TYPE?(i.objUrl=this._byte.readUTF(),i.materialUrl=this._byte.readUTF(),4<=this.version&&(i.materialInfoArr=this.readMaterialInfo()),i.types=n.BaseRes.PREFAB_TYPE):e==n.BaseRes.SCENE_PARTICLE_TYPE&&(i.particleUrl=this._byte.readUTF(),i.types=n.BaseRes.SCENE_PARTICLE_TYPE),this.dataAry.push(i)},i.prototype.initReg=function(){this._objDic=new Object,this._materialDic=new Object,this._particleDic=new Object;for(var t=0;t<this.dataAry.length;t++){var e=this.dataAry[t];e.objUrl&&(this._objDic[n.Scene_data.fileRoot+e.objUrl]=!0),e.materialUrl&&(this._materialDic[n.Scene_data.fileRoot+e.materialUrl]=!0),e.particleUrl&&(this._particleDic[n.Scene_data.fileRoot+e.particleUrl]=!0)}for(var i in this._objDic)n.ObjDataManager.getInstance().registerUrl(i);for(var i in this._materialDic)n.MaterialManager.getInstance().registerUrl(i);for(var i in this._particleDic)n.ParticleManager.getInstance().registerUrl(i)},i.prototype.destory=function(){for(var t in e.prototype.destory.call(this),this._objDic)n.ObjDataManager.getInstance().releaseUrl(t);for(var t in this._materialDic)n.MaterialManager.getInstance().releaseUrl(t);for(var t in this._particleDic)n.ParticleManager.getInstance().releaseUrl(t);this.dataAry=null,this._objDic=null,this._particleDic=null,this._materialDic=null},i);function i(){return null!==e&&e.apply(this,arguments)||this}n.GroupRes=t;var o,a=(o=n.Object3D,__extends(r,o),r);function r(){return null!==o&&o.apply(this,arguments)||this}n.GroupItem=a}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(_){var t,e=(t=_.BaseRes,__extends(r,t),r.prototype.load=function(t,e,i,n){var o=this;if(this._completeFun=e,this._readDataFun=n,this._progressFun=i,this.sceneData)this.isNeedReload()?(e(),i(1),this.applyByteArray()):(e(),i(1),n(this.sceneData));else{var a=r.sceneConfigData;a&&a[t]?this.loadZipMap(t,a[t].len):(t=_.Scene_data.fileRoot+getMapUrl(t),_.LoadManager.getInstance().load(t,_.LoadManager.BYTE_TYPE,function(t){o.loadComplete(t)},null))}},r.prototype.loadZipMap=function(t,a){for(var s=this,u=new Array,h=new Array,l=0,r=new Array,e=0;e<a;e++)r[e]=0;function i(t){var e=t.response,i=u.indexOf(t);if(h[i]=e,++l==u.length){for(var n=0,o=0;o<h.length;o++)n+=h[o].byteLength;var a=new Uint8Array(n),r=0;for(o=0;o<h.length;o++)a.set(new Uint8Array(h[o]),r),r+=h[o].byteLength;s.loadComplete(a.buffer)}}function n(t,e){var i=u.indexOf(t);r[i]=e;for(var n=0,o=0;o<a;o++)n+=r[o];n/=a,s._progressFun(n)}for(e=0;e<a;e++){var o=new XMLHttpRequest;o.onreadystatechange=function(t){var e=t.target;200==e.status&&4==e.readyState&&i(e)},o.onprogress=function(t){var e=t.target;n(e,t.loaded/t.total)};var c=_.Scene_data.fileRoot+getZipMapUrl(t)+e+".txt";u.push(o),o.open("GET",c,!0),o.responseType="arraybuffer",o.send()}},r.prototype.isNeedReload=function(){for(var t=this.sceneData.buildItem,e=0;e<t.length;e++)if(t[e].type==_.BaseRes.PREFAB_TYPE&&t[e].lighturl){var i=_.Scene_data.fileRoot+t[e].lighturl;return!_.TextureManager.getInstance().hasTexture(i)}return _.ResCount.GCTime-this.idleTime<10},r.prototype.loadComplete=function(t){this._byte=new _.TLByteArray(t),this.applyByteArray()},r.prototype.applyByteArray=function(){var t=this;this._byte.position=0,this.version=this._byte.readInt(),this.read(function(){t.readNext()})},r.prototype.readNext=function(){this.read(),this.read(),this.read(),this.readScene(),this._readDataFun(this.sceneData)},r.prototype.readScene=function(){this._byte.readInt(),this.readAstat(),28<=this.version&&this.readTerrainIdInfoBitmapData(this._byte);var t=this._byte.readInt();this.sceneData=JSON.parse(this._byte.readUTFBytes(t)),this.sceneData.astar=this._astarDataMesh,this.sceneData.terrain=this._terrainDataItem},r.prototype.readTerrainIdInfoBitmapData=function(t){var e=t.readInt();if(e){var i=e,n=t.buffer.slice(t.position,t.position+i);t.position+=i;var o=unZip(n),a=new _.TLByteArray(o);this._terrainDataItem=_.GroundDataMesh.meshAllgroundData(a)}},r.prototype.readAstat=function(){if(this._byte.readBoolean()){var t,e;this._astarDataMesh=new f,this._astarDataMesh.aPos=new _.Vector3D,this._astarDataMesh.astarItem=new Array,this._astarDataMesh.heightItem=new Array,this._astarDataMesh.jumpItem=new Array,this._astarDataMesh.midu=this._byte.readFloat(),this._astarDataMesh.aPos.x=this._byte.readFloat(),this._astarDataMesh.aPos.y=this._byte.readFloat(),this._astarDataMesh.aPos.z=this._byte.readFloat();var i=this._byte.readInt(),n=this._byte.readInt();if(this._astarDataMesh.width=i,this._astarDataMesh.height=n,this.version<25){for(t=0;t<n;t++){var o=new Array;for(e=0;e<i;e++)o.push(this._byte.readFloat());this._astarDataMesh.astarItem.push(o)}for(t=0;t<n;t++){var a=new Array;for(e=0;e<i;e++)a.push(this._byte.readFloat());this._astarDataMesh.heightItem.push(a)}}else{var r=this._byte.readFloat(),s=this.readAstarFromByte(this._byte),u=this.readAstarFromByte(this._byte),h=0,l=0;for(t=0;t<n;t++){o=new Array;var c=new Array;for(e=0;e<i;e++){var p=s[h++];if(o.push(p),1==p){var d=u[l++];c.push(d)}else c.push(0)}this._astarDataMesh.astarItem.push(o),this._astarDataMesh.jumpItem.push(c)}for(this._astarDataMesh.jumpItem,t=0;t<n;t++){for(a=new Array,e=0;e<i;e++)a.push(this._byte.readShort()/r);this._astarDataMesh.heightItem.push(a)}}}},r.prototype.readAstarFromByte=function(t){for(var e=t.readUnsignedInt(),i=Math.ceil(e/32),n=new Array,o=0;o<i;o++)for(var a=t.readUnsignedInt(),r=0;r<32;r++){var s=1&a;n.length<e&&n.push(s),a>>=1}return n},r.prototype.countImg=function(){this._progressFun&&this._progressFun(this.imgLoadNum/this.imgNum),t.prototype.countImg.call(this)},r.prototype.allResCom=function(){t.prototype.allResCom.call(this),this._completeFun&&this._completeFun()},r.prototype.destory=function(){t.prototype.destory.call(this)},r);function r(){return null!==t&&t.apply(this,arguments)||this}_.SceneRes=e;var f=function(){}}(tl3d=tl3d||{}),function(_){var f=function(){};_.DualQuatFloat32Array=f;var t=(e.prototype.processMesh=function(t){this.hasProcess||(this.makeArrBoneQPAry(t),this.hasProcess=!0)},e.prototype.makeArrBoneQPAry=function(t){this.meshBoneQPAryDic=new _.Dictionary([]);for(var e=0;e<t.meshAry.length;e++){for(var i=this.conleMatrixArr(),n=0;n<i.length;n++)for(var o=i[n],a=0;a<o.length;a++)t.meshAry[e].bindPosMatrixAry[a]&&o[a].prepend(t.meshAry[e].bindPosMatrixAry[a]);var r=this.makeFrameDualQuatFloatArray(t,i);this.meshBoneQPAryDic[t.meshAry[e].uid]=r,this.boneQPAry=r}this.matrixAry=i},e.prototype.getBoneQPAryByMesh=function(t){return this.meshBoneQPAryDic[t.uid]},e.prototype.conleMatrixArr=function(){for(var t=new Array,e=0;e<this.matrixAry.length;e++){for(var i=this.matrixAry[e],n=new Array,o=0;o<i.length;o++)n.push(i[o].clone());t.push(n)}return t},e.prototype.makeFrameDualQuatFloatArray=function(t,e){for(var i=new Array,n=new _.Matrix3D,o=0;o<t.meshAry.length;o++){for(var a=new Array,r=t.meshAry[o].boneNewIDAry,s=0;s<e.length;s++){var u=e[s],h=new f;h.quat=new Float32Array(4*r.length),h.pos=new Float32Array(3*r.length);for(var l=0;l<r.length;l++){var c=u[r[l]].clone(n);c.appendScale(-1,1,1);var p=new _.Quaternion;p.fromMatrix(c);var d=c.position;h.quat[4*l+0]=p.x,h.quat[4*l+1]=p.y,h.quat[4*l+2]=p.z,h.quat[4*l+3]=p.w,h.pos[3*l+0]=d.x,h.pos[3*l+1]=d.y,h.pos[3*l+2]=d.z}a.push(h)}i.push(a)}return i},e);function e(){this.inLoop=0,this.inter=new Array,this.bounds=new Array,this.nameHeight=0,this.posAry=new Array,this.hasProcess=!1}_.AnimData=t}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var e,t=(e=l.ResCount,__extends(i,e),i.prototype.makeHitBoxItem=function(){this.hitPosItem=new Array;var t=this.hitBox.x,e=this.hitBox.y,i=new l.Vector3D(-t,0,-t),n=new l.Vector3D(t,0,-t),o=new l.Vector3D(t,0,t),a=new l.Vector3D(-t,0,t);this.hitPosItem.push(i),this.hitPosItem.push(n),this.hitPosItem.push(o),this.hitPosItem.push(a);var r=new l.Vector3D(-t,e,-t),s=new l.Vector3D(t,e,-t),u=new l.Vector3D(t,e,t),h=new l.Vector3D(-t,e,t);this.hitPosItem.push(r),this.hitPosItem.push(s),this.hitPosItem.push(u),this.hitPosItem.push(h)},i.prototype.addMesh=function(t){t.uid=this.meshAry.length,this.meshAry.push(t)},i.prototype.loadParticle=function(){},i.prototype.loadMaterial=function(t){void 0===t&&(t=null);for(var e=0;e<this.meshAry.length;e++)this.loadByteMeshDataMaterial(this.meshAry[e],t)},i.prototype.loadByteMeshDataMaterial=function(e,i){void 0===i&&(i=null);var t=l.Scene_data.fileRoot+e.materialUrl;t=(t=t.replace("_byte.txt",".txt")).replace(".txt","_byte.txt"),l.MaterialManager.getInstance().getMaterialByte(t,function(t){(e.material=t).usePbr?l.MeshDataManager.getInstance().uploadPbrMesh(e,t.useNormal):(t.lightProbe||t.directLight)&&l.MeshDataManager.getInstance().uploadPbrMesh(e,!1),e.materialParamData&&(e.materialParam=new l.MaterialBaseParam,e.materialParam.setData(e.material,e.materialParamData)),i&&i(t)},null,!0,l.MaterialAnimShader.MATERIAL_ANIM_SHADER,l.MaterialAnimShader)},i.prototype.setAction=function(t,e){this.animUrlAry=new Array;for(var i=0;i<t.length;i++){var n=t[i],o=e+t[i],a=l.AnimManager.getInstance().getAnimDataImmediate(o);a.processMesh(this),this.animDic[n]=a,this.animUrlAry.push(o)}},i.prototype.destory=function(){if(!this.hasDestory){if(this.allParticleDic){for(var t in this.allParticleDic)l.ParticleManager.getInstance().releaseUrl(t);this.allParticleDic=null}for(var e=0;e<this.meshAry.length;e++)this.meshAry[e].destory();if(this.meshAry.length=0,this.meshAry=null,this.boneSocketDic=null,this.animUrlAry)for(e=0;e<this.animUrlAry.length;e++)l.AnimManager.getInstance().clearAnim(this.animUrlAry[e]);for(var t in this.animDic)delete this.animDic[t];this.animDic=null,this.hasDestory=!0}},i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.meshAry=new Array,t.fileScale=1,t.tittleHeight=0,t.hitBox=new l.Vector2D(0,0),t.type=0,t.animDic=new Object,t.ready=!1,t.hasDestory=!1,t}l.SkinMesh=t}(tl3d=tl3d||{}),(tl3d||(tl3d={})).BoneSocketData=function(){};__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=t.Object3D,__extends(i,n),i);function i(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),n.call(this)||this}t.CollisionVo=e;function o(){}t.CollisionItemVo=o;var a=(r.Polygon=0,r.BOX=1,r.BALL=2,r.Cylinder=3,r.Cone=4,r);function r(){}t.CollisionType=a}(tl3d=tl3d||{}),(tl3d||(tl3d={})).CapsuleVo=function(t,e){this.radius=t,this.height=e},function(t){var e=(i.prototype.setData=function(t,e,i){this.sunDirect[0]=t.x,this.sunDirect[1]=t.y,this.sunDirect[2]=t.z,this.sunColor[0]=e.x,this.sunColor[1]=e.y,this.sunColor[2]=e.z,this.ambientColor[0]=i.x,this.ambientColor[1]=i.y,this.ambientColor[2]=i.z},i);function i(){this.sunDirect=new Array(0,1,0),this.sunColor=new Array(2,0,0),this.ambientColor=new Array(0,0,0)}t.LightVo=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.Shader3D,__extends(n,e),n.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"v3Color")},n.prototype.getVertexShaderString=function(){return"attribute vec3 v3Position;attribute vec3 v3Color;uniform mat4 viewMatrix3D;uniform mat4 camMatrix3D;uniform mat4 posMatrix3D;varying vec4 colorData;void main(void){   vec4 vt0= vec4(v3Position, 1.0);   colorData =vec4(v3Color,1) ;   vt0 = posMatrix3D * vt0;   vt0 = camMatrix3D * vt0;   vt0 = viewMatrix3D * vt0;   gl_Position = vt0;}"},n.prototype.getFragmentShaderString=function(){return" precision mediump float;\nvarying vec4 colorData;\nvoid main(void)\n{\ngl_FragColor =colorData;\n}"},n.LineShader="LineShader",n);function n(){return e.call(this)||this}t.LineDisplayShader=i}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();function getUItittleUrl(t){return"ui/load/tittle/"+t+".png"}function getSkillUrl(t){return("skill/"+t+getBaseUrl()+".txt").replace(".txt","_byte.txt")}function getModelUrl(t){return"model/"+t+getBaseUrl()+".txt"}function getModelUIUrl(t){return"model/"+t+getBaseUrl()+".txt"}function getMapUrl(t){return"map/"+t+getBaseUrl()+".txt"}function getBaoxiangUrl(){return"changjing/baoxiang/100001.txt"}function getRoleUrl(t){return"role/"+t+getBaseUrl()+".txt"}function getZipMapUrl(t){return"map/"+t+"/"}function Snum(t){return"123"}function getEffectUIUrl(t){return"ui/load/effect/"+t+".png"}function getKeyProById(t){return"cc"}!function(n){var e,i=(e=n.Display3D,__extends(t,e),t.prototype.makeLineMode=function(t,e,i){void 0===i&&(i=null),this.lineVecPos&&this.lineIndex||this.clear(),i&&(this.baseColor=i),this.lineVecPos.push(t.x,t.y,t.z),this.lineVecPos.push(e.x,e.y,e.z),this.lineColor.push(this.baseColor.x,this.baseColor.y,this.baseColor.z),this.lineColor.push(this.baseColor.x,this.baseColor.y,this.baseColor.z),this.lineIndex.push(this.lineIndex.length+0,this.lineIndex.length+1)},t.prototype.clear=function(){this.lineVecPos=new Array,this.lineIndex=new Array,this.lineColor=new Array,this.objData.indexBuffer&&(this.objData.indexBuffer=null)},t.prototype.upToGpu=function(){this.lineIndex.length&&(this.objData.treNum=this.lineIndex.length,this.objData.vertexBuffer=n.Scene_data.context3D.uploadBuff3D(this.lineVecPos),this.objData.normalsBuffer=n.Scene_data.context3D.uploadBuff3D(this.lineColor),this.objData.indexBuffer=n.Scene_data.context3D.uploadIndexBuff3D(this.lineIndex))},t.prototype.update=function(){this.objData&&this.objData.indexBuffer&&(n.Scene_data.context3D.setProgram(this.program),n.Scene_data.context3D.setVcMatrix4fv(this.shader,"viewMatrix3D",n.Scene_data.viewMatrx3D.m),n.Scene_data.context3D.setVcMatrix4fv(this.shader,"camMatrix3D",n.Scene_data.cam3D.cameraMatrix.m),n.Scene_data.context3D.setVcMatrix4fv(this.shader,"posMatrix3D",this.posMatrix.m),n.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),n.Scene_data.context3D.setVa(1,3,this.objData.normalsBuffer),n.Scene_data.context3D.drawLine(this.objData.indexBuffer,this.objData.treNum))},t);function t(){var t=e.call(this)||this;return t.baseColor=new n.Vector3D(1,0,0),t.objData=new n.ObjData,t.shader=n.ProgrmaManager.getInstance().getProgram(n.LineDisplayShader.LineShader),t.program=t.shader.program,t.makeLineMode(new n.Vector3D(0,0,0),new n.Vector3D(100,0,0),new n.Vector3D),t.makeLineMode(new n.Vector3D(0,0,0),new n.Vector3D(100,0,100),new n.Vector3D),t.makeLineMode(new n.Vector3D(100,0,0),new n.Vector3D(100,0,100),new n.Vector3D),t.upToGpu(),t}n.LineDisplaySprite=i;var o,a=(__extends(r,o=i),r.prototype.makeLineMode=function(t,e,i){void 0===i&&(i=null),o.prototype.makeLineMode.call(this,t,e,i),this.getSprite().makeLineMode(t,e,i)},r.prototype.getSprite=function(){var t=Math.floor(this.lineIndex.length/1e4);if(!this.itemSprite[t]){var e=new i;e.clear(),e.baseColor=this.baseColor,this.itemSprite.push(e)}return this.itemSprite[t]},r.prototype.update=function(){for(var t=0;t<this.itemSprite.length;t++)this.itemSprite[t].posMatrix=this.posMatrix,this.itemSprite[t].update()},r.prototype.upToGpu=function(){for(var t=0;t<this.itemSprite.length;t++)this.itemSprite[t].upToGpu()},r.prototype.clear=function(){o.prototype.clear.call(this),this.itemSprite||(this.itemSprite=new Array);for(var t=0;this.itemSprite&&t<this.itemSprite.length;t++)this.itemSprite[t].clear()},r);function r(){var t=o.call(this)||this;return t.itemSprite||(t.itemSprite=new Array),t}n.MulLineSprite=a;var s,u=(__extends(h,s=i),h.prototype.makeGridData=function(){var t,e;this.clear(),t=new n.Vector3D(0,0,100),e=new n.Vector3D(0,0,-100),this.makeLineMode(t,e,new n.Vector3D(0,0,1,1)),t=new n.Vector3D(100,0,0),e=new n.Vector3D(-100,0,0),this.makeLineMode(t,e,new n.Vector3D(1,0,0,1)),this.baseColor=new n.Vector3D(128/255,128/255,128/255,1);for(var i=1;i<=10;i++)t=new n.Vector3D(10*i,0,100),e=new n.Vector3D(10*i,0,-100),this.makeLineMode(t,e),t=new n.Vector3D(10*-i,0,100),e=new n.Vector3D(10*-i,0,-100),this.makeLineMode(t,e),t=new n.Vector3D(100,0,10*i),e=new n.Vector3D(-100,0,10*i),this.makeLineMode(t,e),t=new n.Vector3D(100,0,10*-i),e=new n.Vector3D(-100,0,10*-i),this.makeLineMode(t,e);this.upToGpu()},h);function h(){var t=s.call(this)||this;return t.makeGridData(),t}n.GridLineSprite=u}(tl3d=tl3d||{}),function(o){var n=(t.update=function(){},t.prototype.getStr=function(){return t.fpsNowNum=Math.min(this.drawNum,600),this.fpsStr="Fps:"+String(t.fpsNowNum)+"-"+t.tipStr,this.fpsStr},t.addFps=0,t.fpsNowNum=0,t.tipStr="",t);function t(){this.drawNum=0,this.fpsStr=""}o.FpsMc=n;var e=(i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.init=function(t,e){var i=this;this.canvas2D=t,this.loadCav=e,this.fps=new n,this.canvasUi=this.canvas2D.getContext("2d"),this.loadCtx=this.loadCav.getContext("2d"),o.TimeUtil.addFrameTick(function(){i.upData()})},i.prototype.showLoadInfo=function(t){},i.prototype.removeShowLoad=function(){this.loadCav.parentElement&&this.loadCav.parentElement.removeChild(this.loadCav),i.showFps=!0},i.prototype.upData=function(){if(this.fps.drawNum++,!(this.lastTime>=o.TimeUtil.getTimer()-1e3))if(this.lastTime=o.TimeUtil.getTimer(),i.showFps){this.canvasUi.font="40px Helvetica";var t=this.canvasUi.measureText(this.fps.getStr()).width;this.canvas2D.width=t,this.canvas2D.height=30,this.canvasUi.clearRect(50,0,this.canvas2D.width-50,this.canvas2D.height),this.canvasUi.fillStyle="#000000",this.canvasUi.fillRect(50,0,this.canvas2D.width-50,this.canvas2D.height),this.canvasUi.font="30px Helvetica",this.canvasUi.fillStyle="#ffffff",this.canvasUi.textBaseline=o.TextAlign.TOP,this.canvasUi.textAlign=o.TextAlign.LEFT,this.canvasUi.fillText(this.fps.getStr(),50,0),this.fps.drawNum=0}else this.canvasUi.clearRect(0,0,this.canvas2D.width,this.canvas2D.height)},i.prototype.makeXyzLine=function(){var t=new o.Vector3D(80,0,0),e=new o.Vector3D(0,70,0),i=new o.Vector3D(0,0,80),n=new o.Matrix3D;n.appendRotation(o.Scene_data.cam3D.rotationY,o.Vector3D.Y_AXIS),n.appendRotation(o.Scene_data.cam3D.rotationX,o.Vector3D.X_AXIS),t=n.transformVector(t),e=n.transformVector(e),i=n.transformVector(i),this.drawLine(new o.Vector2D(0,0),new o.Vector2D(t.x,-t.y),"#ff0000"),this.drawLine(new o.Vector2D(0,0),new o.Vector2D(e.x,-e.y),"#00ff00"),this.drawLine(new o.Vector2D(0,0),new o.Vector2D(i.x,-i.y),"#0000ff"),this.canvasUi.font="12px Helvetica",this.canvasUi.fillStyle="#ff0000",this.canvasUi.fillText("x",t.x+this.cPos.x,-t.y+this.cPos.y),this.canvasUi.fillStyle="#00ff00",this.canvasUi.fillText("y",e.x+this.cPos.x,-e.y+this.cPos.y),this.canvasUi.fillStyle="#0000ff",this.canvasUi.fillText("z",i.x+this.cPos.x,-i.y+this.cPos.y)},i.prototype.drawLine=function(t,e,i){void 0===i&&(i="red"),this.canvasUi.beginPath(),this.canvasUi.lineWidth=2,this.canvasUi.strokeStyle=i,this.canvasUi.moveTo(t.x+this.cPos.x,t.y+this.cPos.y),this.canvasUi.lineTo(e.x+this.cPos.x,e.y+this.cPos.y),this.canvasUi.stroke()},i.prototype.resetSize=function(){this.cPos=new o.Vector2D(150,o.Scene_data.stageHeight-100)},i.showFps=!1,i);function i(){this.lastTime=0,this.cPos=new o.Vector2D(150,100)}o.FpsStage=e}(tl3d=tl3d||{}),function(t){var e=(i.prototype.getModuleName=function(){throw new Error("module必须复写命名")},i.prototype.listProcessors=function(){return null},i.prototype.onRegister=function(){},i.prototype.registerProcessors=function(){var t=this.listProcessors();if(null!=t&&0<t.length)for(var e=0;e<t.length;e++)this.registerProcessor(t[e])},i.prototype.registerProcessor=function(t){if(null!=this.processorMap[t.getName()])throw new Error("同一Module不能注册两个相同的Processor");(this.processorMap[t.getName()]=t).registerEvents()},i.registerModule=function(t){if(null!=i.moduleMap[t.getModuleName()])throw new Error("不能注册两个相同的Module："+t.getModuleName());(i.moduleMap[t.getModuleName()]=t).registerProcessors(),t.onRegister()},i.moduleMap=new Object,i);function i(){this.processorMap=new Object}t.Module=e}(tl3d=tl3d||{}),function(e){var t=(i.prototype.getName=function(){throw new Error("process必须复写命名")},i.prototype.receivedModuleEvent=function(t){},i.prototype.listenModuleEvents=function(){return null},i.prototype.registerEvents=function(){var t=this.listenModuleEvents();null!=t&&0<t.length&&e.ModuleEventManager.addEvents(t,this.receivedModuleEvent,this)},i.prototype.getHanderMap=function(){return new Object},i);function i(){}e.Processor=t}(tl3d=tl3d||{}),function(t){var e=(o.addEvents=function(t,e,i){for(var n=0;n<t.length;n++)o._instance.addEventListener(t[n].type,e,i)},o.dispatchEvent=function(t){o._instance.dispatchEvent(t)},o.addEvent=function(t,e,i){o._instance.addEventListener(t,e,i)},o.removeEvent=function(t,e,i){o._instance.removeEventListener(t,e,i)},o.removeEventByName=function(t){o._instance.removeEventListenerByName(t)},o.removeEventByNameAndTarget=function(t,e){o._instance.removeEventListenerByNameAndTarget(t,e)},o.removeEventByTarget=function(t){o._instance.removeEventListenerByTarget(t)},o._instance=new t.EventDispatcher,o);function o(){}t.ModuleEventManager=e}(tl3d=tl3d||{}),function(t){var e=(i.STANAD="stand",i.WALK="walk",i.DEATH="death",i.JUMP="jump",i.SIT="sit",i.INJURED="injured",i.ATTACK_01="attack_01",i.ATTACK_02="attack_02",i.ATTACK_03="attack_03",i.ATTACK_04="attack_04",i.ATTACK_05="attack_05",i.ATTACK_06="attack_06",i.ATTACK_010="attack_010",i.ATTACK_020="attack_020",i.STAND_MOUNT="stand_mount_01",i.WALK_MOUNT="walk_mount_01",i.s_attack_01="s_attack_01",i);function i(){}t.CharAction=e}(tl3d=tl3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=tl3d.Scene_data,n=(e=tl3d.Engine,__extends(o,e),o.initConfig=function(){var i=this;tl3d.Engine.init=function(t){i.init(t)},tl3d.Engine.resetSize=function(t,e){i.resetSize(t,e)}},o.resetSize=function(t,e){i.stageWidth=t,tl3d.Scene_data.stageHeight=e,i.canvas3D.width=i.stageWidth,i.canvas3D.height=i.stageHeight,i.context3D.resetSize(i.stageWidth,i.stageHeight),tl3d.UIManager.getInstance().resize(),tl3d.Engine.resetViewMatrx3D()},o.init=function(t){i.vpMatrix=new tl3d.Matrix3D,i.canvas3D=t,i.context3D=new tl3d.Context3D,i.context3D.init(t),tl3d.UIManager.getInstance().init(),i.cam3D=new tl3d.Camera3D,i.focus3D=new tl3d.Object3D,i.focus3D.rotationY=135,i.focus3D.rotationX=-45,i.light=new tl3d.LightVo,tl3d.TimeUtil.init(),i.supportBlob=!1},o);function o(){return e.call(this)||this}t.OverrideEngine=n}(scene3d=scene3d||{});var scene3d;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.ExpTextJumpUiDrawAndRefreash,__extends(n,e),n.prototype.drawTxtBydigitalAndtext=function(t){var e,i=this.parent.uiAtlas.getRec(this.textureStr),n=tl3d.UIManager.getInstance().getContext2D(i.pixelWitdh,i.pixelHeight,!1),o=t.type;t.type==tl3d.TextJumpType.EXPERIENCE&&(e=tl3d.ArtFont.num54);var a=tl3d.ArtFont.getInstance().getAirFontWidth(n,String(this._data.str),e);return a+=50,tl3d.UiDraw.cxtDrawImg(n,"TYPE"+o,new tl3d.Rectangle(i.pixelWitdh-a,i.pixelHeight-25,50,25),tl3d.UIData.publicUi),tl3d.ArtFont.getInstance().writeFontToCtxLeft(n,String(this._data.str),e,i.pixelWitdh-a+50+2,i.pixelHeight-25),tl3d.TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,i.pixelX,i.pixelY,n),a},n);function n(){return null!==e&&e.apply(this,arguments)||this}t.ExpTextJumpUiDrawAndRefreash256=i}(scene3d=scene3d||{}),function(e){var i,t=(i=tl3d.BloodManager,__extends(n,i),n.prototype.setExpJump256_256Num=function(t){this._jumpText256_256.showTemp(t)},n);function n(){var t=i.call(this)||this;return t._jumpText256_256=new tl3d.AlphaUiContianer(e.ExpTextJumpUiDrawAndRefreash256,new tl3d.Rectangle(0,0,256,256),2),t.uiContianerItem.push(t._jumpText256_256),t}e.OverrideBloodManager=t}(scene3d=scene3d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,n=tl3d.Scene_data,e=(t=scene3d.OverrideEngine,__extends(o,t),o.initConfig=function(){var i=this;tl3d.Engine.init=function(t){i.init(t)},tl3d.Engine.resetSize=function(t,e){i.resetSize(t,e)},tl3d.Engine.resetViewMatrx3D=function(){i.resetViewMatrx3D()}},o.resetSize=function(t,e){isNaN(t)&&(t=document.body.clientWidth),isNaN(e)&&(e=document.body.clientHeight),tl3d.Scene_data.stageWidth=t,n.stageHeight=e,n.context3D.resetSize(n.stageWidth,n.stageHeight),tl3d.UIManager.getInstance().resize(),tl3d.Engine.resetViewMatrx3D(),i.CanvasPostionModel.getInstance().resetSize()},o.init=function(t){scene3d.OverrideEngine.init(t),tl3d.Scene_data.focus3D.x=0,n.focus3D.y=0,n.focus3D.z=0,tl3d.Scene_data.focus3D.rotationY=0,n.focus3D.rotationX=-45,tl3d.Scene_data.cam3D.distance=250},o.resetViewMatrx3D=function(){n.viewMatrx3D?n.viewMatrx3D.identity():n.viewMatrx3D=new tl3d.Matrix3D;var t=tl3d.Scene_data.stageWidth,e=tl3d.Scene_data.stageHeight;tl3d.Scene_data.sceneViewHW=Math.max(t,e),n.viewMatrx3D.appendScale(1/n.sceneViewHW*2,1/n.sceneViewHW*2,.001),n.viewMatrx3D.appendScale(n.sceneViewHW/t*2*1,t/e*(n.sceneViewHW/t*2),1),tl3d.Scene_data.viewMatrx3D.appendScale(2*this.htmlScale,2*this.htmlScale,1)},o.htmlScale=.5,o);function o(){return t.call(this)||this}i.Override2dEngine=e}(scene2d=scene2d||{}),function(e){var i=tl3d.Scene_data,t=(n.getInstance=function(){return this._instance||(this._instance=new n),this._instance},n.prototype.initSceneFocueEvent=function(){i.uiBlankStage.addEventListener(tl3d.InteractiveEvent.Down,this.onMouseDown,this),i.uiBlankStage.addEventListener(tl3d.InteractiveEvent.Up,this.onMouseUp,this),i.uiBlankStage.addEventListener(tl3d.InteractiveEvent.Move,this.onMouseMove,this)},n.prototype.onMouseMove=function(t){this._isMouseDown&&(this.tureMoveV2d.x=this.lastPostionV2d.x+t.x-this._lastMousePos.x,this.tureMoveV2d.y=this.lastPostionV2d.y+t.y-this._lastMousePos.y,this.resetSize())},n.prototype.onMouseDown=function(t){this._lastMousePos.x=t.x,this._lastMousePos.y=t.y,this.lastPostionV2d=new tl3d.Vector2D(this.tureMoveV2d.x,this.tureMoveV2d.y),this._isMouseDown=!0},n.prototype.onMouseUp=function(t){this._isMouseDown=!1},n.prototype.resetSize=function(){var t=.25/e.Override2dEngine.htmlScale;i.focus3D.x=0+i.stageWidth/2*t,i.focus3D.z=0-i.stageHeight/2*t/Math.sin(n.scene2dRotation45*Math.PI/180),i.focus3D.x-=this.tureMoveV2d.x*t,i.focus3D.z+=this.tureMoveV2d.y*t/Math.sin(n.scene2dRotation45*Math.PI/180),e.Ground2dBaseSprite.perentpos=this.tureMoveV2d},n.scene2dRotation45=45,n);function n(){this.lastPostionV2d=new tl3d.Vector2D,this._lastMousePos=new tl3d.Vector2D,this.tureMoveV2d=new tl3d.Vector2D(0,0),this.initSceneFocueEvent()}e.CanvasPostionModel=t}(scene2d=scene2d||{});var scene2d;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=tl3d.Scene_data,n=(e=tl3d.Shader3D,__extends(o,e),o.prototype.binLocation=function(t){t.bindAttribLocation(this.program,0,"v3Position"),t.bindAttribLocation(this.program,1,"u2Texture")},o.prototype.getVertexShaderString=function(){return"attribute vec3 v3Position;attribute vec2 u2Texture;varying vec2 v_texCoord;uniform vec4 movesize;void main(void){   v_texCoord = vec2(u2Texture.x, u2Texture.y);   vec4 vt0= vec4(v3Position, 1.0);   vt0.xy*=movesize.zw;   vt0.xy+=movesize.xy;   gl_Position = vt0;}"},o.prototype.getFragmentShaderString=function(){return"precision mediump float;\nuniform sampler2D s_texture;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\nvec4 infoUv = texture2D(s_texture, v_texCoord.xy);\ngl_FragColor =infoUv;\n}"},o.Ground2dBaseShader="Ground2dBaseShader",o);function o(){return e.call(this)||this}t.Ground2dBaseShader=n;var a,r=(a=tl3d.Display3D,__extends(s,a),s.prototype.initData=function(){tl3d.ProgrmaManager.getInstance().registe(n.Ground2dBaseShader,new n),this.shader=tl3d.ProgrmaManager.getInstance().getProgram(n.Ground2dBaseShader),this.program=this.shader.program,this.objData=new tl3d.ObjData,this.objData.vertices=new Array,this.objData.vertices.push(0,-1,0),this.objData.vertices.push(1,-1,0),this.objData.vertices.push(1,0,0),this.objData.vertices.push(0,0,0),this.objData.uvs=new Array,this.objData.uvs.push(0,1),this.objData.uvs.push(1,1),this.objData.uvs.push(1,0),this.objData.uvs.push(0,0),this.objData.indexs=new Array,this.objData.indexs.push(0,1,2),this.objData.indexs.push(0,2,3),this.loadTexture(),this.upToGpu()},s.prototype.loadTexture=function(){var t=tl3d.UIManager.getInstance().getContext2D(128,128,!1);t.fillStyle="rgb(255,255,255)",t.fillRect(0,0,128,128),this._uvTextureRes=tl3d.TextureManager.getInstance().getCanvasTexture(t)},s.prototype.setPicUrl=function(t){var e=this;tl3d.TextureManager.getInstance().getTexture(t,function(t){e._uvTextureRes=t})},s.prototype.upToGpu=function(){this.objData.indexs.length&&(this.objData.treNum=this.objData.indexs.length,this.objData.vertexBuffer=i.context3D.uploadBuff3D(this.objData.vertices),this.objData.uvBuffer=tl3d.Scene_data.context3D.uploadBuff3D(this.objData.uvs),this.objData.indexBuffer=tl3d.Scene_data.context3D.uploadIndexBuff3D(this.objData.indexs))},s.prototype.update=function(){this.objData&&this.objData.indexBuffer&&this._uvTextureRes&&(tl3d.Scene_data.context3D.setProgram(this.program),tl3d.Scene_data.context3D.setVa(0,3,this.objData.vertexBuffer),tl3d.Scene_data.context3D.setVa(1,2,this.objData.uvBuffer),tl3d.Scene_data.context3D.setVc4fv(this.shader,"movesize",this.getMoveSizeData()),tl3d.Scene_data.context3D.setRenderTexture(this.shader,"s_texture",this._uvTextureRes.texture,0),tl3d.Scene_data.context3D.drawCall(this.objData.indexBuffer,this.objData.treNum))},s.prototype.getMoveSizeData=function(){return[(this.x+s.perentpos.x)/(i.stageWidth/2)-1,1-(this.y+s.perentpos.y)/(i.stageHeight/2),this.width/(i.stageWidth/2),this.height/(i.stageHeight/2)]},s.perentpos=new tl3d.Vector2D,s);function s(){var t=a.call(this)||this;return t.x=0,t.y=0,t.width=100,t.height=100,t.initData(),t}t.Ground2dBaseSprite=r;var u=(h.getInstance=function(){return this._instance||(this._instance=new h),this._instance},h.prototype.update=function(){i.context3D.setWriteDepth(!1),i.context3D.setDepthTest(!1);for(var t=0;t<this._groundItem.length;t++)this._groundItem[t].update()},h.prototype.addGroundPicByeUrl=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new r;return t&&i.setPicUrl(t),e&&(i.x=e.x,i.y=e.y,i.width=e.width,i.height=e.height),this._groundItem.push(i),i},h);function h(){this._groundItem=new Array}t.GroundModel=u}(scene2d=scene2d||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=scene3d.OverrideEngine,__extends(n,e),n.initConfig=function(){tl3d.UIData.resize=function(){n.uiScaleresize()},tl3d.Engine.update=function(){n.update()},tl3d.Engine.init=function(t){scene2d.Override2dEngine.init(t)},tl3d.Engine.resetSize=function(t,e){scene2d.Override2dEngine.resetSize(t,e)},tl3d.Engine.resetViewMatrx3D=function(){scene2d.Override2dEngine.resetViewMatrx3D()}},n.uiScaleresize=function(){tl3d.UIData.Scale=1.5},n);function n(){return e.call(this)||this}t.LayaOverride2dEngine=i}(layapan=layapan||{}),function(t){var e=(i.initData=function(){i.isConfig||(t.LayaOverride2dEngine.initConfig(),tl3d.Engine.init(tl3d.Engine.canvas),tl3d.Engine.resetSize(Laya.stage.width,Laya.stage.height),tl3d.Engine.initPbr(),tl3d.Engine.initShadow(),i.isConfig=!0)},i.isConfig=!1,i);function i(){}t.LayaScene2dInit=e}(layapan=layapan||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,n=tl3d.CombineParticle,l=tl3d.Scene_data,c=tl3d.ParticleManager,p=tl3d.Vector3D,d=tl3d.BaseRes,e=tl3d.MaterialAnimShader,_=tl3d.Display3DSprite,o=tl3d.ShadowManager,a=(i=tl3d.Display3dMovie,__extends(r,i),Object.defineProperty(r.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t,this.changeColor[0]=1,this.changeColor[1]=1,this.changeColor[2]=1,this.changeColor[3]=t},enumerable:!0,configurable:!0}),r.prototype.updateMaterialMesh=function(t){if(1!=this.changeColor[0]||1!=this.changeColor[1]||1!=this.changeColor[2]||1!=this.changeColor[3]){r.alphaShader||(r.alphaShader=this.makeAlphaShader());var e=t.material.shader;t.material.shader=r.alphaShader,l.context3D.setProgram(r.alphaShader.program),l.context3D.cullFaceBack(!1),l.context3D.setBlendParticleFactors(-1),this.setVcMatrix(t),this.setMaterialTextureAlpha(t.material,t.materialParam),this.setVa(t),l.context3D.setVc4fv(t.material.shader,"alphadata",this.changeColor),this.setMeshVc(t),l.context3D.drawCall(t.indexBuffer,t.treNum),t.material.shader=e}else i.prototype.updateMaterialMesh.call(this,t)},r.prototype.setMaterialTextureAlpha=function(t,e){void 0===e&&(e=null);for(var i=t.texList,n=0;n<i.length;n++)if(i[n].isMain){var o=i[n].texture;if(e)for(var a=0;a<e.dynamicTexList.length;a++)e.dynamicTexList[a].target&&e.dynamicTexList[a].target.name==i[n].name&&(o=e.dynamicTexList[a].texture);l.context3D.setRenderTexture(t.shader,"alphatexture",o,0)}},r.prototype.makeAlphaShader=function(){var t=new e;return t.paramAry=[!1,!1,!1,!1,!1,!1,!1,0],t.fragment="precision mediump float;\nuniform sampler2D alphatexture;\nuniform vec4 alphadata;\nvarying vec2 v0;\nvoid main(void){\nvec4 ft0 = texture2D(alphatexture,v0);\ngl_FragColor =ft0*alphadata;\n}",t.encode(),t},Object.defineProperty(r.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t},enumerable:!0,configurable:!0}),r.prototype.setAvatar=function(t){this._avatar!=t&&(this._avatar=t,this.setRoleUrl(this.getSceneCharAvatarUrl(t)))},Object.defineProperty(r.prototype,"shadow",{set:function(t){t?this._shadow||(this._shadow=this._scene.shadowMgr.addShadow(),this._shadow.visible=!0,this._shadow.x=this.px,this._shadow.y=this.py,this._shadow.z=this.pz):this._shadow&&(this._shadow.visible=!1,this._scene.shadowMgr.removeShadow(this._shadow),this._shadow=null)},enumerable:!0,configurable:!0}),r.prototype.update=function(){this.visible&&i.prototype.update.call(this),this._shadow&&(this._shadow._visible=this.visible)},r.prototype.getSceneCharAvatarUrl=function(t){return getRoleUrl(String(t)),getRoleUrl(String(t))},r.prototype.getSceneCharWeaponUrl=function(t,e){return void 0===e&&(e=""),getModelUrl(String(t+e))},r.prototype.isPlaying=function(){return 1!=this._completeState||!this._curentFrame||this._curentFrame<this._animDic[this.curentAction].matrixAry.length-1},r.prototype.loadPartRes=function(t,e,i){if(!this._hasDestory){for(var n=0;n<e.dataAry.length;n++){var o,a,r,s=e.dataAry[n];if(s.isGroup&&(o=new p(s.x,s.y,s.z),a=new p(s.rotationX,s.rotationY,s.rotationZ),r=new p(s.scaleX,s.scaleY,s.scaleZ)),s.types==d.SCENE_PARTICLE_TYPE){var u=c.getInstance().getParticleByte(l.fileRoot+s.particleUrl);i.push(u),u.bindTarget=this,u.bindSocket=t,u.dynamic=!0,this._scene.addParticle(u),s.isGroup&&u.setGroup(o,a,r)}else if(s.types==d.PREFAB_TYPE){var h=new _;h.setObjUrl(s.objUrl),h.setMaterialUrl(s.materialUrl,s.materialInfoArr),h.dynamic=!0,i.push(h),h.setBind(this,t),this._scene.addSpriteDisplay(h),s.isGroup&&h.setGroup(o,a,r)}}this.applyVisible()}},r.prototype.removeStage=function(){for(var t in this._onStage=!1,this._shadow&&o.getInstance().removeShadow(this._shadow),this._partDic){var e=this._partDic[t];if(e)for(var i=0;i<e.length;i++)e[i]instanceof n?this._scene.removeParticle(e[i]):e[i]instanceof _&&this._scene.removeSpriteDisplay(e[i])}},Object.defineProperty(r.prototype,"px",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"py",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pz",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!0,configurable:!0}),r.prototype.addSkinMeshParticle=function(){if(this._skinMesh&&!this._hasDestory){var t=new Array;this._partDic.mesh=t;var e=this._skinMesh.meshAry;if(e)for(var i=0;i<e.length;i++)for(var n=e[i].particleAry,o=0;o<n.length;o++){var a,r=n[o];(a=c.getInstance().getParticleByte(l.fileRoot+r.url)).sourceData||console.log("particle.sourceData error",a,r),a.dynamic=!0,a.bindSocket=r.socketName,t.push(a),a.bindTarget=this,a.scaleX=this.scale,a.scaleY=this.scale,a.scaleZ=this.scale,this._scene.addParticle(a)}}},r.prototype.removeSkinMeshParticle=function(){var t=this._partDic.mesh;if(t){for(var e=0;e<t.length;e++)this._scene.removeParticle(t[e]),t[e].destory();this._partDic.mesh=null}},r);function r(){var t=i.call(this)||this;return t._avatar=-1,t._visible=!0,t.changeColor=[1,1,1,1],t._alpha=1,t.x,t}t.LayaSceneBaseChar=a}(layapan=layapan||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var o,n=tl3d.Display3DSprite,a=tl3d.ProgrmaManager,t=tl3d.Vector3D,r=tl3d.Vector2D,s=tl3d.Scene_data,i=tl3d.MathClass,u=tl3d.TestTriangle,h=tl3d.LineDisplayShader,l=tl3d.LineDisplaySprite,c=tl3d.CharAction,p=(o=e.LayaSceneBaseChar,__extends(d,o),Object.defineProperty(d.prototype,"forceRotationY",{set:function(t){this.pRotationY=t,this.rotationY=t,this.toRotationY=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"pRotationY",{get:function(){return this._pRotationY},set:function(t){this._pRotationY=t,this.isMount?this._mountChar.rotationY=t:this.rotationY=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"pScale",{get:function(){return this._pScale},set:function(t){this._pScale=t,this._mountChar&&(this._mountChar.scale=t),this._wingDisplay&&(this._wingDisplay.scale=t),this.scale=t,this._skinMesh&&(this.tittleHeight=this._skinMesh.tittleHeight*t)},enumerable:!0,configurable:!0}),d.prototype.setMount=function(t){return this.isMount=t&&0!=t.length,this.isMount?(this._mountChar||(this._mountChar=new e.LayaSceneBaseChar,this._mountChar.scale=this._pScale),this._mountChar.setRoleUrl(getRoleUrl(t)),this.setBind(this._mountChar,d.MOUNT_SLOT),this._mountChar._scene=this._scene,this._scene&&this._scene.addMovieDisplay(this._mountChar)):(this.setBind(null,null),this._mountChar&&(this._mountChar=null)),this.isMount},d.prototype.setWing=function(t){t&&t.length?(this._wingDisplay||(this._wingDisplay=new e.LayaSceneBaseChar,this._wingDisplay.scale=this._pScale),this._wingDisplay.setRoleUrl(getRoleUrl(t)),this._wingDisplay.setBind(this,d.WING_SLOT),this._wingDisplay._scene=this._scene,this._scene&&this._scene.addMovieDisplay(this._wingDisplay)):this._wingDisplay&&(this._wingDisplay.setBind(null,null),this._wingDisplay=null)},d.prototype.setWeapon=function(t){this._weaponNum!=t&&((this._weaponNum=t)<=0?this.removePart(d.WEAPON_PART):this.setWeaponByAvatar(this._weaponNum))},d.prototype.setWeaponByAvatar=function(t,e){void 0===e&&(e=""),this.addPart(d.WEAPON_PART,d.WEAPON_DEFAULT_SLOT,this.getSceneCharWeaponUrl(t,e))},d.prototype.getSceneCharAvatarUrl=function(t){var e=String(t);if(0==t)throw new Error("衣服为getSceneCharAvatarUrl");return getRoleUrl(e)},d.prototype.onMeshLoaded=function(){this._skinMesh&&(this.tittleHeight=this._skinMesh.tittleHeight*this._pScale)},d.prototype.play=function(t,e,i,n){return void 0===e&&(e=0),void 0===i&&(i=!0),void 0===n&&(n=null),this.isMount?(this._mountChar.visible=Boolean(t!=c.JUMP),t==c.STANAD?o.prototype.play.call(this,c.STAND_MOUNT):t==c.WALK?o.prototype.play.call(this,c.WALK_MOUNT):this._mountChar.visible?o.prototype.play.call(this,c.STAND_MOUNT):o.prototype.play.call(this,c.JUMP),this._mountChar.play(t,e,i,n)):o.prototype.play.call(this,t,e,i,n)},d.prototype.getCurrentAction=function(){return this.isMount?this._mountChar.curentAction:this.curentAction},d.prototype.rotationToNew=function(t,e){void 0===e&&(e=1);var i=t-this.pRotationY;if(0!=i)if(i<1)this.pRotationY=t;else{var n=((t-this.pRotationY)%360+360)%360;180<n?this.pRotationY-=(360-n)/e:this.pRotationY+=n/e}},d.prototype.stopMove=function(){this.play(c.STANAD)},d.prototype.watch=function(t,e){if(void 0===e&&(e=!1),t){var i=t.x-this.px,n=t.z-this.pz,o=Math.sqrt(i*i+n*n);i/=o,n/=o;var a=Math.asin(i)/Math.PI*180;n<=0&&(a=180-a),isNaN(a)||(this.forceRotationY=a)}},d.prototype.getCurrentPos=function(){return new t(this.px,this.py,this.pz)},d.prototype.msgSpellStop=function(){this.skillVo&&(this.skillVo.removeSkillForce(),this.changeAction(this._defaultAction),this.skillVo=null),this.isSinging=!1},d.prototype.destory=function(){this._hasDestory||(this.skillVo&&(this.skillVo.removeSkillForce(),this.skillVo=null),this._mountChar&&(this._mountChar.destory(),this._mountChar=null),this._wingDisplay&&(this._wingDisplay.destory(),this._wingDisplay=null),this._charNameVo&&(this._charNameVo.destory(),this._charNameVo=null),this._charAngerVo&&(this._charAngerVo.destory(),this._charAngerVo=null),this._hasDestory=!0,o.prototype.destory.call(this))},Object.defineProperty(d.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,this.applyVisible()},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"optimization",{get:function(){return this._optimization},set:function(t){this._optimization=t,this.applyVisible()},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"resultVisible",{get:function(){return this._resultVisible},enumerable:!0,configurable:!0}),d.prototype.applyVisible=function(){var t=this._visible;if(t=!!this._visible&&!this._optimization,this._partDic&&this._partDic[d.MESH])for(var e=0,i=this._partDic[d.MESH];e<i.length;e++)i[e].sceneVisible=t;this._resultVisible=t},Object.defineProperty(d.prototype,"isCamera2D",{set:function(t){this._isCamera2D=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"angerColor",{set:function(t){this._angerColor=t,this._charAngerVo&&(this._charAngerVo.colortype=this._angerColor)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"angerRatio",{get:function(){return this._angerRatio},set:function(t){this._angerRatio=t,this._charAngerVo&&(this._charAngerVo.num=this._angerRatio)},enumerable:!0,configurable:!0}),d.prototype.setcharNameSize=function(t){this._charNameVo&&(this._charNameVo.size=t)},d.prototype.setcharNameColor=function(t,e){void 0===e&&(e=""),this._charNameVo&&(this._charNameVo.color=t),this._charNameVo&&(this._charNameVo.scolor=e)},Object.defineProperty(d.prototype,"charName",{get:function(){return this._charName||""},set:function(t){this._charName!=t&&(this._charName=t,this._charNameVo&&(this._charNameVo.name=this._charName))},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"nameEnable",{set:function(t){this._nameEnable=t,this._charNameVo?this._charNameVo.name=LanMgr.getLan("{0}",-1,random(99)):this._charNameVo=this._scene.bloodMgr.getCharNameMeshVo(LanMgr.getLan("{0}",-1,random(99)))},enumerable:!0,configurable:!0}),d.prototype.updateBind=function(){o.prototype.updateBind.call(this),this.updateWeaponScale(),this.refreshPos()},d.prototype.updateWeaponScale=function(){if(this._partDic&&this._partDic.hasOwnProperty(d.WEAPON_PART)){var t=this._partDic[d.WEAPON_PART];if(t instanceof Array)for(var e=0;e<t.length;e++){var i=t[e];i instanceof n&&(i.scale=this._pScale)}}},d.prototype.refreshPos=function(){var t=this.py+this.tittleHeight;this.isMount&&(t+=20),this._charAngerVo&&(this._charAngerVo.pos.x=this.px,this._charAngerVo.pos.y=t,this._charAngerVo.pos.z=this.pz,this._charAngerVo.visible=this._resultVisible,t+=(this._isCamera2D,5)),this._charNameVo&&(this._charNameVo.pos.x=this.px,this._charNameVo.pos.y=t,this._charNameVo.pos.z=this.pz,this._charNameVo.visible=this._resultVisible)},Object.defineProperty(d.prototype,"px",{get:function(){return this._px},set:function(t){this._px=t,this._mountChar?this._mountChar.x=this._px:this.x=this.px},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"pz",{get:function(){return this._pz},set:function(t){this._pz=t,this._mountChar?this._mountChar.z=this._pz:this.z=this.pz},enumerable:!0,configurable:!0}),d.prototype.update=function(){if(this._skinMesh&&!this._optimization&&(o.prototype.update.call(this),this._showHitBox)){if(!this.lineSprite){a.getInstance().registe(h.LineShader,new h),this.lineSprite=new l,this.lineSprite.clear();for(var t=0;t<this._triIndex.length/3;t++){var e=this._skinMesh.hitPosItem[this._triIndex[3*t+0]],i=this._skinMesh.hitPosItem[this._triIndex[3*t+1]],n=this._skinMesh.hitPosItem[this._triIndex[3*t+2]];this.lineSprite.makeLineMode(e,i),this.lineSprite.makeLineMode(i,n),this.lineSprite.makeLineMode(n,e)}this.lineSprite.upToGpu()}this.lineSprite.posMatrix=this.posMatrix.clone(),this.lineSprite.update()}},d.prototype.math_distance=function(t){return i.math_distance(this.px,this.pz,t.x,t.z)},d.prototype.get2dPos=function(){var t=new r,e=.25/scene2d.Override2dEngine.htmlScale;return this._mountChar?(t.x=this._mountChar.px,t.y=this._mountChar.pz):(t.x=this.px,t.y=this.pz),t.x=t.x/e,t.y=t.y/-1*Math.sin(45*Math.PI/180)/e,t},d.prototype.set2dPos=function(t,e){var i=.25/scene2d.Override2dEngine.htmlScale,n=t*i,o=e*i/Math.sin(45*Math.PI/180)*-1;this._px=n,this._pz=o,this._mountChar?(this._mountChar.x=n,this._mountChar.z=o):(this.x=n,this.z=o)},d.prototype.math3DWorldtoDisplay2DPos=function(t){var e=this._scene.cameraMatrix.clone();e.append(this._scene.viewMatrx3D.clone());var i=s.stageWidth,n=s.stageHeight,o=e.transformVector(t),a=new r;return a.x=(o.x/o.w+1)*(i/2),a.y=(-o.y/o.w+1)*(n/2),a},d.prototype.mouseClik=function(t,e){if(this._scene.cameraMatrix.transformVector(this.getCurrentPos()).z<10)return!1;var i=this.math3DWorldtoDisplay2DPos(e);if(this._skinMesh){this._hitBox2DItem||(this._hitBox2DItem=new Array);for(var n=this._hitBox2DItem.length=0;n<this._skinMesh.hitPosItem.length;n++){var o=this.posMatrix.transformVector(this._skinMesh.hitPosItem[n]);this._hitBox2DItem.push(this.math3DWorldtoDisplay2DPos(o))}for(var a=0;a<this._triIndex.length/3;a++)if(u.baseTri.p1=this._hitBox2DItem[this._triIndex[3*a+0]],u.baseTri.p2=this._hitBox2DItem[this._triIndex[3*a+1]],u.baseTri.p3=this._hitBox2DItem[this._triIndex[3*a+2]],u.baseTri.checkPointIn(i))return!0}else if(r.distance(i,this.math3DWorldtoDisplay2DPos(this.posMatrix.position))<20)return!0;return!1},d.prototype.removeStage=function(){o.prototype.removeStage.call(this),this._charNameVo&&(this._charNameVo.visible=!1),this._mountChar&&this._scene.removeMovieDisplay(this._mountChar),this._wingDisplay&&this._scene.removeMovieDisplay(this._wingDisplay)},d.prototype.addStage=function(){o.prototype.addStage.call(this),this._charNameVo&&(this._charNameVo.visible=!0),this._mountChar&&this._scene.addMovieDisplay(this._mountChar),this._wingDisplay&&this._scene.addMovieDisplay(this._wingDisplay)},d.BLOOD_COLOR_HP=0,d.BLOOD_COLOR_ANGER=1,d.Defaul_Man_Avatar=2002,d.Defaul_WoMan_Avater=2012,d.MESH="mesh",d.WEAPON_PART="weapon",d.WEAPON_DEFAULT_SLOT="w_01",d.MOUNT_SLOT="mount_01",d.WING_SLOT="wing_01",d.SEL_PART="select",d.QUEST_ICON="questicon",d.NONE_SLOT="none",d);function d(){var t=o.call(this)||this;return t.isMount=!1,t._px=0,t._py=0,t._pz=0,t._pRotationY=0,t.toRotationY=0,t._pScale=1,t.tittleHeight=50,t._optimization=!1,t._weaponNum=-1,t._resultVisible=!0,t._angerRatio=0,t._nameEnable=!1,t._showHitBox=!1,t._triIndex=[0,1,2,0,2,3,4,5,6,4,6,7,0,4,5,0,5,1,1,5,6,1,6,2,2,6,7,2,7,3,3,7,4,3,4,0],t.skillitem=new Array,t._angerColor=d.BLOOD_COLOR_ANGER,t}e.LayaSceneChar=p}(layapan=layapan||{});var layapan;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,o=laya.webgl.WebGLContext,n=(e=Laya.Shader,__extends(i,e),i);function i(){return e.call(this,"attribute vec2 position;attribute vec2 texcoord;attribute vec4 color;uniform vec2 size;uniform mat4 mmat;varying vec2 v_texcoord;varying vec4 v_color;void main(){vec4 pos =mmat*vec4(position.x,position.y,0,1.0);gl_Position = vec4((pos.x/size.x-0.5)*2.0, (0.5-pos.y/size.y)*2.0, pos.z, 1.0);v_color = color;v_texcoord = texcoord;}","precision mediump float;varying vec2 v_texcoord;varying vec4 v_color;uniform sampler2D texture;void main(){vec4 t_color = texture2D(texture, v_texcoord);gl_FragColor = vec4(1.0,0.0,1.0,1.0);}","myShader")||this}t.OtherShader=n;var a,r=(a=Laya.Value2D,__extends(s,a),s);function s(){var t=a.call(this,0,0)||this,e=8*Laya.CONST3D2D.BYTES_PE;return t.position=[2,Laya.WebGLContext.FLOAT,!1,e,0],t.texcoord=[2,Laya.WebGLContext.FLOAT,!1,e,2*Laya.CONST3D2D.BYTES_PE],t.color=[4,Laya.WebGLContext.FLOAT,!1,e,4*Laya.CONST3D2D.BYTES_PE],t}t.OtherShaderValue=r;var u,h=(u=Laya.Sprite,__extends(l,u),l.prototype.init=function(t,e,i){var n,o;void 0===e&&(e=null),void 0===i&&(i=null),this.vBuffer=Laya.VertexBuffer2D.create(),this.iBuffer=Laya.IndexBuffer2D.create(),this.ibData=new Uint16Array([]),n=e||[],i?o=i:(o=[]).push(0,1,3),this.iNum=o.length,this.vbData=new Float32Array(n),this.ibData=new Uint16Array(o),this.vBuffer.append(this.vbData),this.iBuffer.append(this.ibData),this.shaderValue=new r,this.shaderValue.textureHost=null,this._renderType|=Laya.RenderSprite.CUSTOM},l.prototype.customRender=function(t,e,i){t.ctx.setIBVB(e,i,this.iBuffer,this.vBuffer,this.iNum,null,n.shader,this.shaderValue,0,0)},l);function l(){var t=u.call(this)||this;return t.iNum=0,n.shader||(n.shader=new n),t.init(null),t}t.OtherLayaRectSprite=h;var c,p=(__extends(d,c=h),d.add=function(t){if(d._list.push(t),!this.inited){this.inited=!0;var n=Laya.Render.context.ctx;n.submitElement=function(t,e){if(0<e)for(;t<e;){t+=n._submits[t].renderSubmit();for(var i=0;i<d._list.length;i++)t==d._list[i]._layaRenderIndex&&d._list[i].testRenderPan3d(t)}}}},d.prototype.initData=function(){this.customRenderEnable=!0,this.scene=new tl3d.SceneManager,this.scene.ready=!0},d.prototype.customRender=function(t,e,i){c.prototype.customRender.call(this,t,e,i),this._layaRenderIndex=t.ctx._submits._length},d.prototype.makeSteemTm=function(){if(this.oldTm){var t=Date.now()-this.oldTm;this.timespeed1=Math.max(this.timespeed1,-.99),this.scene.startTime-=this.timespeed1*t}this.oldTm=Date.now()},d.prototype.testRenderPan3d=function(t){if(t==this._layaRenderIndex){this._layaRenderIndex=-1;var e=Scene_data.context3D.renderContext,i=e.getParameter(o.BLEND_SRC_RGB),n=e.getParameter(o.BLEND_DST_RGB);e.blendFunc(i,n),this.makeSteemTm(),this.upFrame(),Scene_data.context3D.setWriteDepth(!1),Scene_data.context3D.setDepthTest(!1),Laya.BaseShader.activeShader=null,Laya.BaseShader.bindShader=null}},d.prototype.upFrame=function(){},d._list=[],d);function d(){var t=c.call(this)||this;return t._layaRenderIndex=-1,t.timespeed1=0,t.initData(),d.add(t),t}t.LayaInsideSprite=p}(layapan=layapan||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();var BaseLaya3dSprite=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.upFrame=function(){Scene_data.context3D.setWriteDepth(!0),Scene_data.context3D.setDepthTest(!0),tl3d.TimeUtil.update(),Scene_data.focus3D.rotationY=0,Scene_data.focus3D.rotationX=-45,Scene_data.cam3D.distance=250,scene2d.CanvasPostionModel.getInstance().tureMoveV2d=new tl3d.Vector2D(this.x,this.y),scene2d.CanvasPostionModel.getInstance().resetSize(),Scene_data.context3D.renderContext.clear(Scene_data.context3D.renderContext.DEPTH_BUFFER_BIT),tl3d.MathClass.getCamView(Scene_data.cam3D,Scene_data.focus3D),Scene_data.context3D._contextSetTest.clear(),this.scene.upFrame()},e}(layapan.LayaInsideSprite),MaskScene3dLaya=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.applyAbsolutePoint=function(){this.absoluteX=this._x,this.absoluteY=this._y,this.absoluteWidth=this._width,this.absoluteHeight=this._height,this.applyRenderSize()},e.prototype.applyRenderSize=function(){this.renderData[0]=this.absoluteX/Scene_data.stageWidth,this.renderData[1]=this.absoluteY/Scene_data.stageHeight,this.renderData[2]=this.absoluteWidth/tl3d.Scene_data.stageWidth,this.renderData[3]=this.absoluteHeight/Scene_data.stageHeight},e}(tl3d.UIMask)),GroundPosLaya=function(){function t(){}return t.getGroundPos=function(t,e,i,n,o){this.cam3D=i,this.windowRect=n,this.viewMatrx3D=o;if(!this._plantObjectMath){var a=new tl3d.Vector3D(0,-0,500),r=new tl3d.Vector3D(-500,-0,0),s=new tl3d.Vector3D(500,-0,0);this._plantObjectMath=tl3d.Calculation._PanelEquationFromThreePt(a,r,s),this._plantnormal=new tl3d.Vector3D(this._plantObjectMath.a,this._plantObjectMath.b,this._plantObjectMath.c),this._plantnormal.normalize(),this._plane_a=new tl3d.Vector3D(a.x,a.y,a.z)}var u=this.mathDisplay2Dto3DWorldPos(new tl3d.Vector2D(t,e),500),h=new tl3d.Vector3D(this.cam3D.x,this.cam3D.y,this.cam3D.z);return tl3d.Calculation.calPlaneLineIntersectPoint(this._plantnormal,this._plane_a,u,h)},t.mathDisplay2Dto3DWorldPos=function(t,e){var i;void 0===e&&(e=300);var n=e/((i=Scene_data.stageWidth>Scene_data.stageHeight?Math.max(Scene_data.stageWidth,Scene_data.stageHeight):Math.min(Scene_data.stageWidth,Scene_data.stageHeight))/2),o=i/2*n,a=this.windowRect.width,r=this.windowRect.height,s=new tl3d.Matrix3D;s.prependRotation(-this.cam3D.rotationY,tl3d.Vector3D.Y_AXIS),s.prependRotation(-this.cam3D.rotationX,tl3d.Vector3D.X_AXIS);var u=this.viewMatrx3D.transformVector(new tl3d.Vector3D(500,0,500)),h=u.x/u.w,l=a/2/h*n,c=r/2/h*n,p=t.x/a*l*2,d=t.y/r*c*2;return this.gettempPos(new tl3d.Vector3D(p-l,c-d,o),s)},t.gettempPos=function(t,e){var i=e.transformVector(t);return i=i.add(new tl3d.Vector3D(this.cam3D.x,this.cam3D.y,this.cam3D.z))},t}(),Scene3dLaya3dSprite=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._windowRect=new tl3d.Rectangle(0,0,512,512),t.focus3d=new tl3d.Object3D,t.camDistance=700,t.camRotationX=-35,t.camRotationY=0,t.camViewLH=1.76,t.camAotuMove=!0,t}return __extends(i,e),i.prototype.upFrame=function(){Scene_data.context3D.setWriteDepth(!0),Scene_data.context3D.setDepthTest(!0),tl3d.TimeUtil.update(),Scene_data.focus3D.x=0,Scene_data.focus3D.y=0,Scene_data.focus3D.z=0,Scene_data.context3D.renderContext.clear(Scene_data.context3D.renderContext.DEPTH_BUFFER_BIT);var t=Scene_data.viewMatrx3D.clone(),e=Scene_data.cam3D.distance;if(this.makeNewMatrix(),Scene_data.context3D._contextSetTest.clear(),this._uiMask){this._uiMask.x=+this.x,this._uiMask.y=+this.y;var i=Scene_data.context3D.renderContext;i.enable(i.STENCIL_TEST),i.stencilMask(255),i.stencilFunc(i.NEVER,this._uiMask.level,255),i.stencilOp(i.REPLACE,i.REPLACE,i.REPLACE),this._uiMask.update(),i.stencilFunc(i.LESS,this._uiMask.level-1,255),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}this.scene.upFrame(),this._uiMask&&Scene_data.context3D.renderContext.disable(Scene_data.context3D.renderContext.STENCIL_TEST),Scene_data.viewMatrx3D=t,Scene_data.cam3D.distance=e},i.prototype.getGroundPos=function(t,e){return GroundPosLaya.getGroundPos(t-this.x,e-this.y,this.copyCam3d,this._windowRect,this.copyViewMatrx3D)},i.prototype.addMaskUi=function(t,e){this._uiMask||(this._uiMask=new MaskScene3dLaya,i.maskeLevel++,this._uiMask.level=i.maskeLevel),this._windowRect.width=t,this._windowRect.height=e,this._uiMask.width=this._windowRect.width,this._uiMask.height=this._windowRect.height},i.prototype.makeNewMatrix=function(){this._windowRect.x=this.x+this._windowRect.width/2,this._windowRect.y=this.y+this._windowRect.height/2;var t=Scene_data.stageWidth,e=Scene_data.stageHeight,i=Math.min(Scene_data.stageWidth,Scene_data.stageHeight);Scene_data.viewMatrx3D.perspectiveFieldOfViewLH(this.camViewLH,1,10,2e3),Scene_data.viewMatrx3D.appendScale(i/t*2*1,t/e*(i/t*2),1),this.copyViewMatrx3D=Scene_data.viewMatrx3D.clone(),Scene_data.cam3D.distance=this.camDistance,this.focus3d.rotationX=this.camRotationX,this.focus3d.rotationY=this.camRotationY,this.camAotuMove&&(this.camRotationY+=.1),Scene_data.viewMatrx3D.appendTranslation(this._windowRect.x/Scene_data.stageWidth*2-1,1-this._windowRect.y/Scene_data.stageHeight*2,0),tl3d.MathClass.getCamView(Scene_data.cam3D,this.focus3d),this.cloneCam3d(Scene_data.cam3D)},i.prototype.cloneCam3d=function(t){this.copyCam3d=new tl3d.Camera3D,this.copyCam3d.x=t.x,this.copyCam3d.y=t.y,this.copyCam3d.z=t.z,this.copyCam3d.rotationX=t.rotationX,this.copyCam3d.rotationY=t.rotationY,this.copyCam3d.rotationZ=t.rotationZ},i.maskeLevel=2,i}(BaseLaya3dSprite),Game2dChar=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(o){function t(){var t=o.call(this)||this;return t.runspeed=3,t.moveEndAction=tl3d.CharAction.STANAD,t}return __extends(t,o),t.prototype.moveTopos=function(t){this.moveToPosV2d=t;var e=this.pixelPos.sub(this.moveToPosV2d);this.pRotationY=180-180*Math.atan2(e.x,e.y)/Math.PI},t.prototype.set2dPos=function(t,e){o.prototype.set2dPos.call(this,t,e),this.pixelPos=new tl3d.Vector2D(t,e)},t.prototype.stopMove=function(t){this.moveToPosV2d&&(this.moveToPosV2d=null,this.moveEndAction&&this.play(this.moveEndAction),t&&o.prototype.set2dPos.call(this,t.x,t.y))},t.prototype.updateFrame=function(t){if(this.moveToPosV2d)if(10<tl3d.Vector2D.distance(this.pixelPos,this.moveToPosV2d)){var e=this.pixelPos.sub(this.moveToPosV2d);e.normalize(),e.scaleBy(this.runspeed),this.pixelPos.x+=e.x,this.pixelPos.y+=e.y,o.prototype.set2dPos.call(this,this.pixelPos.x,this.pixelPos.y),this.movetocb&&this.movetocb(this.pixelPos)}else o.prototype.set2dPos.call(this,this.moveToPosV2d.x,this.moveToPosV2d.y),this.moveToPosV2d=null,this.moveEndAction&&this.play(this.moveEndAction),this.moveokcb&&this.moveokcb();if(o.prototype.updateFrame.call(this,t),this._partDic)for(var i=this._partDic.mesh,n=0;i&&n<i.length;n++)i[n].scaleX!=this.scale&&(i[n].scaleX=this.scale,i[n].scaleY=this.scale,i[n].scaleZ=this.scale)},t}(layapan.LayaSceneChar)),Game3dChar=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(n){function t(){return n.call(this)||this}return __extends(t,n),t.prototype.moveTopos3d=function(t){this.moveToPosV2d=t;var e=new tl3d.Vector3D(this.px,this.py,this.pz),i=this.moveToPosV2d.subtract(e);i.normalize(),this.pRotationY=180*Math.atan2(i.x,i.z)/Math.PI},t.prototype.updateFrame=function(t){if(this.moveToPosV2d){var e=new tl3d.Vector3D(this.px,this.py,this.pz);if(2<tl3d.Vector3D.distance(e,this.moveToPosV2d)){var i=this.moveToPosV2d.subtract(e);i.normalize(),i.scaleBy(1),this.px=e.x+i.x,this.pz=e.z+i.z,this.play(tl3d.CharAction.WALK)}else this.play(tl3d.CharAction.STANAD)}n.prototype.updateFrame.call(this,t)},t}(layapan.LayaSceneChar)),Base2dSceneLayer=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(e){function t(){var t=e.call(this)||this;return t._startPosX=0,t._startPosY=0,t._cutShowGods=!1,t.x=Launch.offsetX,t.y=Launch.offsetY,t}return __extends(t,e),t.prototype.setPosition=function(t,e){this.x+=t,this.y+=e},t.prototype.setPos=function(t,e){this.x=t,this.y=e},t.prototype.upFrame=function(){Scene_data.context3D.setWriteDepth(!0),Scene_data.context3D.setDepthTest(!0),tl3d.TimeUtil.update(),Scene_data.focus3D.rotationY=0,Scene_data.focus3D.rotationX=-45,Scene_data.cam3D.distance=250,scene2d.CanvasPostionModel.getInstance().tureMoveV2d=new tl3d.Vector2D(this.x,this.y),scene2d.CanvasPostionModel.getInstance().resetSize(),Scene_data.context3D.renderContext.clear(Scene_data.context3D.renderContext.DEPTH_BUFFER_BIT),tl3d.MathClass.getCamView(Scene_data.cam3D,Scene_data.focus3D),Scene_data.context3D._contextSetTest.clear(),this.scene.upFrame()},t.prototype.get3dPos=function(t,e){var i=.25/scene2d.Override2dEngine.htmlScale,n=t*i,o=e*i/Math.sin(45*Math.PI/180)*-1;return new tl3d.Vector3D(n,0,o)},t.prototype.addModelChar=function(t,e,i,n,o,a){return void 0===n&&(n=180),void 0===o&&(o=2.7),void 0===a&&(a=0),this.sceneChar||(this.sceneChar=new GameUIChar,this.scene.addMovieDisplay(this.sceneChar)),this.sceneChar.play(tl3d.CharAction.STANAD),this.sceneChar.setRoleUrl(getRoleUrl(t)),this.sceneChar.forceRotationY=n,this.sceneChar.rotationZ=a,this.sceneChar.set2dPos(e,i),this.sceneChar.scale=o,this.sceneChar},t.prototype.removeModelChar=function(t){t&&(t.removeSelf(),t=null)},t.prototype.setModelBox=function(t,e,i){this.targetPanel=t,this.topBounds=e,this.bottomBounds=i},t.prototype.onShow=function(){this.targetPanel&&(this.targetPanel.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.targetPanel.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove),this.targetPanel.on(Laya.Event.MOUSE_UP,this,this.mouseUp))},t.prototype.onExit=function(){this.sceneChar=null,this.scene.removeAllMovieDisplay(),this.scene.clearAllParticle(),this.targetPanel&&(this.targetPanel.off(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.targetPanel.off(Laya.Event.MOUSE_MOVE,this,this.mouseMove))},t.prototype.clearSceneChar=function(){this.sceneChar&&(this.scene.removeMovieDisplay(this.sceneChar),this.sceneChar.destory(),this.sceneChar=null)},t.prototype.mouseDown=function(t){this._mouseState=!0,this._cutShowGods=!1,t.stageY<=this.bottomBounds.y&&t.stageY>=this.topBounds.y&&(this._startPosX=t.stageX,this._startPosY=t.stageY,this._cutShowGods=!0)},t.prototype.mouseMove=function(t){if(this._mouseState&&!(t.stageY>this.bottomBounds.y||t.stageY<this.topBounds.y)&&this._cutShowGods){var e=t.stageX-this._startPosX;this._startPosX=t.stageX,this.sceneChar&&(this.sceneChar.rotationY-=e)}},t.prototype.mouseUp=function(t){this._mouseState=!1},t.prototype.addEffect=function(o,t,a,r,s,u,h,l,c,p){var d=this;void 0===r&&(r=3),void 0===s&&(s=30),void 0===u&&(u=null),void 0===h&&(h=0),void 0===l&&(l=0),void 0===c&&(c=!1),void 0===p&&(p=1);var e=getEffectUrl(String(t));this.scene.groupDataMgr.scene=this.scene,this.scene.groupDataMgr.getGroupData(Scene_data.fileRoot+e,function(t){for(var e=0;e<t.dataAry.length;e++){var i=t.dataAry[e];if(i.types==tl3d.BaseRes.SCENE_PARTICLE_TYPE){var n=tl3d.ParticleManager.getInstance().getParticleByte(Scene_data.fileRoot+i.particleUrl);n.x=a.x,n.y=a.y,n.z=a.z,n.scaleX=r,n.scaleY=r,n.scaleZ=r,n.rotationZ=l,n.rotationY=h,n.rotationX=s,n.timeScale=p,d.scene.addParticle(n),u&&u.call(o,n),c&&(n.onComplete=function(t){d.scene.removeParticle(t)})}else logdebug("播放的不是单纯特效")}})},t.prototype.removeEffect=function(t){this.scene.removeParticle(t)},t}(layapan.LayaInsideSprite)),Base2dSceneLayerExt=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.addModelChar=function(t,e,i,n,o,a){void 0===n&&(n=180),void 0===o&&(o=2.7),void 0===a&&(a=0);var r=new GameUIChar;return this.scene.addMovieDisplay(r),r.setRoleUrl(getRoleUrl(t)),r.play(tl3d.CharAction.STANAD),r.forceRotationY=n,r.rotationZ=a,r.set2dPos(e,i),r.scale=o,r},e.prototype.onExit=function(){this.scene.clearAllParticle(),this.scene.removeAllMovieDisplay()},e}(Base2dSceneLayer)),Base3dSceneLayer=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(e){function t(){var t=e.call(this)||this;return t._windowRect=new tl3d.Rectangle(0,0,512,512),t.focus3d=new tl3d.Object3D,t.camDistance=700,t.camRotationX=-35,t.camRotationY=0,t.camPositionX=0,t.camPositionY=0,t.camPositionZ=0,t.camViewLH=.85,t.camFar=5e3,t.camAotuMove=!1,t}return __extends(t,e),t.prototype.upFrame=function(){Scene_data.context3D.setWriteDepth(!0),Scene_data.context3D.setDepthTest(!0),tl3d.TimeUtil.update(),Scene_data.focus3D.x=0,Scene_data.focus3D.y=0,Scene_data.focus3D.z=0,Scene_data.context3D.renderContext.clear(Scene_data.context3D.renderContext.DEPTH_BUFFER_BIT);var t=Scene_data.viewMatrx3D.clone(),e=Scene_data.cam3D.distance;this.makeNewMatrix(),Scene_data.context3D._contextSetTest.clear(),this.scene.upFrame(),Scene_data.viewMatrx3D=t,Scene_data.cam3D.distance=e},t.prototype.getGroundPos=function(t,e){return GroundPosLaya.getGroundPos(t-this.x,e-this.y,this.copyCam3d,this._windowRect,this.copyViewMatrx3D)},t.prototype.makeNewMatrix=function(){this._windowRect.x=this.x+this._windowRect.width/2,this._windowRect.y=this.y+this._windowRect.height/2;var t=Scene_data.stageWidth,e=Scene_data.stageHeight,i=Math.max(t,e);Scene_data.viewMatrx3D.perspectiveFieldOfViewLH(this.camViewLH,1,10,this.camFar),Scene_data.viewMatrx3D.appendScale(i/t*2*1,t/e*(i/t*2),1),this.copyViewMatrx3D=Scene_data.viewMatrx3D.clone(),this.camAotuMove&&this.camMoveFun&&this.camMoveFun(),Scene_data.cam3D.distance=this.camDistance,this.focus3d.rotationX=this.camRotationX,this.focus3d.rotationY=this.camRotationY,this.focus3d.x=this.camPositionX,this.focus3d.y=this.camPositionY,this.focus3d.z=this.camPositionZ,Scene_data.viewMatrx3D.appendTranslation(this._windowRect.x/Scene_data.stageWidth*2-1,1-this._windowRect.y/Scene_data.stageHeight*2,0),tl3d.MathClass.getCamView(Scene_data.cam3D,this.focus3d),this.cloneCam3d(Scene_data.cam3D)},t.prototype.setLook=function(t){this.focus3d.rotationX=t.rotationX,this.focus3d.rotationY=t.rotationY,this.focus3d.x=t.x,this.focus3d.y=t.y,this.focus3d.z=t.z},t.prototype.cloneCam3d=function(t){this.copyCam3d=new tl3d.Camera3D,this.copyCam3d.x=t.x,this.copyCam3d.y=t.y,this.copyCam3d.z=t.z,this.copyCam3d.rotationX=t.rotationX,this.copyCam3d.rotationY=t.rotationY,this.copyCam3d.rotationZ=t.rotationZ},t.prototype.onExit=function(){this.scene.clearStaticScene(),tl3d.SceneResManager.getInstance().clearSceneUseById(this.resId)},t}(Base2dSceneLayer)),Base3dSceneLayerExt=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.makeNewMatrix=function(){var t=Scene_data.stageWidth,e=Scene_data.stageHeight,i=Math.max(t,e);Scene_data.viewMatrx3D.perspectiveFieldOfViewLH(this.camViewLH,1,10,this.camFar),Scene_data.viewMatrx3D.appendScale(i/t*2*1,t/e*(i/t*2),1),this.copyViewMatrx3D=Scene_data.viewMatrx3D.clone(),this.camAotuMove&&this.camMoveFun&&this.camMoveFun(),Scene_data.cam3D.distance=this.camDistance,this.focus3d.rotationX=this.camRotationX,this.focus3d.rotationY=this.camRotationY,this.focus3d.x=this.camPositionX,this.focus3d.y=this.camPositionY,this.focus3d.z=this.camPositionZ,tl3d.MathClass.getCamView(Scene_data.cam3D,this.focus3d),this.cloneCam3d(Scene_data.cam3D)},e}(Base3dSceneLayer),BloodLineMeshVo=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),tl3d.BloodLineMeshVo),Scene_data=tl3d.Scene_data,Vector3D=tl3d.Vector3D,FightChar=function(e){function t(){var t=e.call(this)||this;return t.is2d=!1,t._actionRatio=0,t._lifenumExt=-1,t._bloodNumExt=0,t._bloodMidNumExt=0,t._bloodEnableExt=!1,t._buffary=new Array,t._buffEnable=!1,t._roleLevEnable=!1,t}return __extends(t,e),t.prototype.updateMatrix=function(){e.prototype.updateMatrix.call(this),this.is2d&&(this.posMatrix.identity(),this.posMatrix.appendScale(this._scaleX,this._scaleY,this._scaleZ),this.posMatrix.appendRotation(this._rotationY,Vector3D.Y_AXIS),this.posMatrix.appendRotation(30,Vector3D.X_AXIS),this.posMatrix.appendTranslation(this._x,this._y,this._z))},t.prototype.getCharHeight=function(){return this.py+this.tittleHeight+13},t.prototype.setBloodExtOffsetY=function(t){this._bloodExtVo&&(this._bloodExtVo.offsetY=t)},t.prototype.setBloodExtOffsetX=function(t){this._bloodExtVo&&(this._bloodExtVo.offsetX=t)},t.prototype.setBuffOffsetY=function(t){this._buffVo&&(this._buffVo.posy=t)},t.prototype.setLevOffsetY=function(t){this._rolelevVo&&(this._rolelevVo.offsetY=t)},Object.defineProperty(t.prototype,"actionRatio",{get:function(){return this._actionRatio},set:function(t){this._actionRatio=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lifenumExt",{get:function(){return this._lifenumExt},set:function(t){if(this._bloodExtVo&&t!=this._lifenumExt){var e=Number((t/100).toFixed(2));-1!=this._lifenumExt?(Laya.Tween.clearTween(this),this._lifenumExt>t?(this.bloodNumExt=e,Laya.Tween.to(this,{bloodMidNumExt:e},500)):this._lifenumExt<t&&(this.bloodMidNumExt=e,Laya.Tween.to(this,{bloodNumExt:e},500))):(this.bloodNumExt=e,this.bloodMidNumExt=e),this._lifenumExt=t}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bloodNumExt",{get:function(){return this._bloodNumExt},set:function(t){this._bloodNumExt=0==t?.001:t,this._bloodExtVo&&(this._bloodExtVo.num=this._bloodNumExt)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bloodMidNumExt",{get:function(){return this._bloodMidNumExt},set:function(t){this._bloodMidNumExt=0==t?.001:t,this._bloodExtVo&&(this._bloodExtVo.mid=this._bloodMidNumExt)},enumerable:!0,configurable:!0}),t.prototype.setbloodColor=function(t){this._bloodExtVo&&(this._bloodExtVo.isPlayer=t)},t.prototype.setAnger=function(t){this._bloodExtVo&&(this._bloodExtVo.anger=t)},t.prototype.getAnger=function(){return this._bloodExtVo&&this._bloodExtVo.anger},t.prototype.setAngerPlay=function(t){this._angerExtVo||(this._angerExtVo=this._scene.bloodMgr.getAngerExtMeshVo()),this._angerExtVo&&(this._angerExtVo.play=t)},Object.defineProperty(t.prototype,"bloodEnableExt",{get:function(){return this._bloodEnableExt},set:function(t){this._bloodEnableExt=t,this._bloodExtVo||(this._bloodExtVo=this._scene.bloodMgr.getBloodExtMeshVo()),this._bloodExtVo.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffary",{get:function(){return this._buffary},set:function(t){this._buffary=t,this._buffVo&&(this._buffVo.buffarr=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffEnable",{set:function(t){this._buffEnable=t,this._buffVo||(this._buffVo=this._scene.bloodMgr.getBuffMeshVo()),this._buffVo.visible=t},enumerable:!0,configurable:!0}),t.prototype.setroleLev=function(t,e){this._rolelevVo&&(this._rolelevVo.lev=t),this._rolelevVo&&(this._rolelevVo.type=e)},Object.defineProperty(t.prototype,"roleLevEnable",{set:function(t){this._roleLevEnable=t,this._rolelevVo||(this._rolelevVo=this._scene.bloodMgr.getLevMeshVo()),this._rolelevVo.visible=t},enumerable:!0,configurable:!0}),t.prototype.refreshPos=function(){var t=(this.py+this.tittleHeight)*this.scale;t+=12,this.isMount&&(t+=20),this._buffVo&&this._buffVo.visible&&(this._buffVo.pos.x=this.px,this._buffVo.pos.y=t,this._buffVo.pos.z=this.pz),this._rolelevVo&&this._rolelevVo.visible&&(this._rolelevVo.pos.x=this.px+2.8,this._rolelevVo.pos.y=t,this._rolelevVo.pos.z=this.pz),this._bloodExtVo&&this._bloodExtVo.visible&&(this._bloodExtVo.pos.x=this.px+3,this._bloodExtVo.pos.y=t,this._bloodExtVo.pos.z=this.pz,t+=12),this._charNameVo&&this._charNameVo.visible&&(this._charNameVo.pos.x=this.px,this._charNameVo.pos.y=t,this._charNameVo.pos.z=this.pz,this._charNameVo.visible=this.resultVisible),this._angerExtVo&&this._angerExtVo.visible&&(this._angerExtVo.pos.x=this.px,this._angerExtVo.pos.y=t,this._angerExtVo.pos.z=this.pz,this._angerExtVo.visible=this.resultVisible)},t.prototype.removeStage=function(){e.prototype.removeStage.call(this),this._buffVo&&(this._buffVo.visible=!1),this._rolelevVo&&(this._rolelevVo.visible=!1),this._bloodExtVo&&(this._bloodExtVo.visible=!1),this._angerExtVo&&(this._angerExtVo.play=!1),this.delUIConatiner()},t.prototype.addStage=function(){e.prototype.addStage.call(this),this._buffVo&&(this._buffVo.visible=!0),this._rolelevVo&&(this._rolelevVo.visible=!0),this._bloodExtVo&&(this._bloodExtVo.visible=!0)},t.prototype.delUIConatiner=function(){this._buffVo&&(this._scene.bloodMgr.clearBuffMeshVo(this._buffVo),this._buffVo.destory(),this._buffVo=null),this._rolelevVo&&(this._scene.bloodMgr.clearLevMeshVo(this._rolelevVo),this._rolelevVo.destory(),this._rolelevVo=null),this._bloodExtVo&&(this._scene.bloodMgr.clearBloodExtMeshVo(this._bloodExtVo),this._bloodExtVo.destory(),this._bloodExtVo=null),this._angerExtVo&&(this._scene.bloodMgr.clearAngerExtMeshVo(this._angerExtVo),this._angerExtVo.destory(),this._angerExtVo=null)},t.prototype.destory=function(){this.removeChar(),e.prototype.destory.call(this)},t.prototype.removeChar=function(){this.onStage&&this._scene&&this._scene.removeMovieDisplay(this),this.removeStage()},t}(Game2dChar),MainChar=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(e){function t(){var t=e.call(this)||this;return t._roleStartEnable=!1,t}return __extends(t,e),t.prototype.getCharHeight=function(){return(this.py+this.tittleHeight)*this.scale},t.prototype.setNamePos=function(t,e,i){this._charNameVo&&(this._charNameVo.pos.x=t,this._charNameVo.pos.y=e,this._charNameVo.pos.z=i)},t.prototype.setroleStart=function(t,e){this._roleStartVo&&(this._roleStartVo.num=t),this._roleStartVo&&(this._roleStartVo.type=e)},Object.defineProperty(t.prototype,"roleStartEnable",{set:function(t){this._roleStartEnable=t,this._roleStartVo||(this._roleStartVo=this._scene.bloodMgr.getStartMeshVo())},enumerable:!0,configurable:!0}),t.prototype.removeStage=function(){this._roleStartVo&&(this._roleStartVo.visible=!1),e.prototype.removeStage.call(this)},t.prototype.delUIConatiner=function(){e.prototype.delUIConatiner.call(this),this._roleStartVo&&(this._scene.bloodMgr.clearStartMeshVo(this._roleStartVo),this._roleStartVo.destory(),this._roleStartVo=null)},t.prototype.refreshPos=function(){var t=this.getCharHeight();this._charNameVo&&(this._charNameVo.pos.x=this.px,this._charNameVo.pos.y=t,this._charNameVo.pos.z=this.pz,this._charNameVo.visible=this.resultVisible,t+=4),this._roleStartVo&&(this._roleStartVo.pos.x=this.px,this._roleStartVo.pos.y=t,this._roleStartVo.pos.z=this.pz)},t}(FightChar)),TimeUtil=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),tl3d.TimeUtil),Matrix3D=tl3d.Matrix3D,UIData=tl3d.UIData,CharTitleUiVo=tl3d.CharTitleUiVo,Disp2DBaseText=tl3d.Disp2DBaseText,TextureManager=tl3d.TextureManager,UiDraw=tl3d.UiDraw,UIRectangle=tl3d.UIRectangle,Dis2DUIContianerPanel=tl3d.Dis2DUIContianerPanel,Dis2DUIFram=tl3d.Dis2DUIFram,ArtFont=tl3d.ArtFont,Rectangle=tl3d.Rectangle,BloodManagerExt=function(e){function t(){var t=e.call(this)||this;return t._buffDis2DUI=new Dis2DUIContianerPanel(BuffTitleUiVo,new Rectangle(0,0,88,66),15),t.uiContianerItem.splice(t.uiContianerItem.length-3,0,t._buffDis2DUI),t._levDis2DUI=new Dis2DUIContianerPanel(LevelTitleUiVo,new Rectangle(0,0,38,26),15),t.uiContianerItem.splice(t.uiContianerItem.length-3,0,t._levDis2DUI),t._startDis2DUI=new Dis2DUIContianerPanel(StartTitleUiVo,new Rectangle(0,0,107,18),6),t.uiContianerItem.splice(t.uiContianerItem.length-3,0,t._startDis2DUI),t._bloodExtDis2DUI=new Dis2DUIContianerPanel(BloodExtUiVo,new Rectangle(0,0,64,12),15),t.uiContianerItem.splice(t.uiContianerItem.length-3,0,t._bloodExtDis2DUI),t._angerExtDis2DUI=new Dis2DUIFram(AngerExtUiVo,new Rectangle(0,0,330,202),15),t.uiContianerItem.splice(t.uiContianerItem.length-3,0,t._angerExtDis2DUI),t}return __extends(t,e),t.prototype.getBuffMeshVo=function(){var t=new BuffTitleMesh;return t.buffarr=[],t.pos=new tl3d.Vector3D(0,50,0),this._buffDis2DUI.showTemp(t),t},t.prototype.clearBuffMeshVo=function(t){this._buffDis2DUI.clearTemp(t)},t.prototype.getAngerExtMeshVo=function(){var t=new AngerExtMesh;return t.pos=new tl3d.Vector3D(0,50,0),this._angerExtDis2DUI.showTemp(t),t},t.prototype.clearAngerExtMeshVo=function(t){this._angerExtDis2DUI.clearTemp(t)},t.prototype.getBloodExtMeshVo=function(){var t=new BloodExtMesh;return t.num=0,t.pos=new tl3d.Vector3D(0,50,0),this._bloodExtDis2DUI.showTemp(t),t},t.prototype.clearBloodExtMeshVo=function(t){this._bloodExtDis2DUI.clearTemp(t)},t.prototype.getStartMeshVo=function(){var t=new StartTitleMesh;return t.num=0,t.pos=new tl3d.Vector3D(0,50,0),this._startDis2DUI.showTemp(t),t},t.prototype.clearStartMeshVo=function(t){this._startDis2DUI.clearTemp(t)},t.prototype.getLevMeshVo=function(){var t=new LevelTitleMesh;return t.lev=0,t.pos=new tl3d.Vector3D(0,50,0),this._levDis2DUI.showTemp(t),t},t.prototype.clearLevMeshVo=function(t){this._levDis2DUI.clearTemp(t)},t}(tl3d.BloodManager),BuffTitleUiVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.makeData=function(){if(this._data){this._buffTitleMesh=this._data;for(var t=this.parent.uiAtlas.getRec(this.textureStr),e=tl3d.UIManager.getInstance().getContext2D(t.pixelWitdh,t.pixelHeight,!1),i=(this._buffTitleMesh.buffarr.length,0);i<this._buffTitleMesh.buffarr.length;i++)if(i<12){var n=i%3*22+12,o=66-22*(Math.floor(i/3)+1),a=this._buffTitleMesh.buffarr[i];UiDraw.cxtDrawImg(e,a.tb_buff.icon,new Rectangle(n,o,20,20),UIData.publicsUi),tl3d.LabelTextFont.writeSingleLabelToCtx(e,String(0==a.round?1:a.round),10,20+n-8,20+o-12,tl3d.TextAlign.LEFT,"#ffd800","#000000")}TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,t.pixelX,t.pixelY,e)}},e.prototype.update=function(){if(this._buffTitleMesh){if(this._buffTitleMesh.needDraw&&(this.makeData(),this._buffTitleMesh.needDraw=!1),this._buffTitleMesh.pos)if(this._buffTitleMesh.visible){if(this.needUpData(this._buffTitleMesh.pos)){var t=Scene_data.cam3D.cameraMatrix.clone();t.append(Scene_data.viewMatrx3D);var e=t.transformVector(this._buffTitleMesh.pos);this.ui.x=(e.x/e.w+1)*(Scene_data.stageWidth/2)/UIData.Scale-this.ui.width/2,this.ui.y=(-e.y/e.w+1)*(Scene_data.stageHeight/2)/UIData.Scale-this.ui.height/2,this.ui.y-=this.ui.height/2+6+this._buffTitleMesh.posy,this.oldPos.x=this._buffTitleMesh.pos.x,this.oldPos.y=this._buffTitleMesh.pos.y}}else this.ui.x=1e4;this._buffTitleMesh.clear&&(this.ui&&this.ui.parent&&this.ui.parent.removeChild(this.ui),this._data=null)}},e}(CharTitleUiVo),BuffTitleMesh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.posy=0,t}return __extends(t,e),t.prototype.destory=function(){this.pos=null,this._num=null},Object.defineProperty(t.prototype,"buffarr",{get:function(){return this._num},set:function(t){this._num=t,this.needDraw=!0},enumerable:!0,configurable:!0}),t}(tl3d.baseMeshVo),AngerExtUiVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.makeData=function(){if(this._data){this._angerExtMesh=this._data;var t=this.parent.uiAtlas.getRec(this.textureStr),e=tl3d.UIManager.getInstance().getContext2D(t.pixelWitdh,t.pixelHeight,!1);UiDraw.cxtDrawImg(e,"angerFra",new Rectangle(0,0,330,202),UIData.publicsUi),TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,t.pixelX,t.pixelY,e);var i=this.getPubRec(t),n=this.ui;n.setFrameData(i),n.tr.setRec(i),n.width=110,n.height=101,n.play()}},e.prototype.getPubRec=function(t){var e=new UIRectangle;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e.pixelWitdh=t.pixelWitdh,e.pixelHeight=t.pixelHeight,e.pixelX=t.pixelX,e.pixelY=t.pixelY,e.type=2,e.cellX=3,e.cellY=2,e},e.prototype.update=function(){if(this._angerExtMesh){this._angerExtMesh.needDraw&&(this.makeData(),this._angerExtMesh.needDraw=!1);var t=this.ui;if(this._angerExtMesh.pos)if(this._angerExtMesh.visible){if(this.needUpData(this._angerExtMesh.pos)){var e=Scene_data.cam3D.cameraMatrix.clone();e.append(Scene_data.viewMatrx3D);var i=e.transformVector(this._angerExtMesh.pos);t.x=(i.x/i.w+1)*(Scene_data.stageWidth/2)/UIData.Scale-t.width/2,t.y=(-i.y/i.w+1)*(Scene_data.stageHeight/2)/UIData.Scale-t.height/2+this._angerExtMesh.offsetY,t.x+=this._angerExtMesh.offsetX}}else t.stopEnd(),t.x=1e4;this._angerExtMesh.clear&&(t.parent.removeChild(t),this._data=null)}},e}(Disp2DBaseText),AngerExtMesh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._offsetX=0,t._offsetY=0,t._play=!1,t}return __extends(t,e),t.prototype.destory=function(){this.pos=null,this.needDraw=!1,this.offsetY=0},Object.defineProperty(t.prototype,"play",{get:function(){return this._play},set:function(t){this._play=t,this.needDraw=t,this.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){return this._offsetX},set:function(t){this._offsetX=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this._offsetY},set:function(t){this._offsetY=t},enumerable:!0,configurable:!0}),t}(tl3d.baseMeshVo),BloodExtUiVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.makeData=function(){if(this._data){this._bloodExtMesh=this._data;var t=this.parent.uiAtlas.getRec(this.textureStr),e=tl3d.UIManager.getInstance().getContext2D(t.pixelWitdh,t.pixelHeight,!1);UiDraw.cxtDrawImg(e,"boold_bg",new Rectangle(0,0,61,12),UIData.publicsUi),UiDraw.cxtDrawImg(e,"boold_mid",new Rectangle(2,1,59*this._bloodExtMesh.mid,6),UIData.publicsUi),UiDraw.cxtDrawImg(e,this._bloodExtMesh.isPlayer?"boold_up_my":"boold_up_enemy",new Rectangle(2,1,59*this._bloodExtMesh.num,6),UIData.publicsUi);var i=Number((this._bloodExtMesh.anger/tb.TB_skill_set.getSkillSet().spell_anger).toFixed(2));i=Math.min(1,i),i=Math.max(.001,i),UiDraw.cxtDrawImg(e,"anger",new Rectangle(2,8,59*i,3),UIData.publicsUi),TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,t.pixelX,t.pixelY,e)}},e.prototype.update=function(){if(this._bloodExtMesh){if(this._bloodExtMesh.needDraw&&(this.makeData(),this._bloodExtMesh.needDraw=!1),this._bloodExtMesh.pos)if(this._bloodExtMesh.visible){if(this.needUpData(this._bloodExtMesh.pos)){var t=Scene_data.cam3D.cameraMatrix.clone();t.append(Scene_data.viewMatrx3D);var e=t.transformVector(this._bloodExtMesh.pos);this.ui.x=(e.x/e.w+1)*(Scene_data.stageWidth/2)/UIData.Scale-this.ui.width/2,this.ui.y=(-e.y/e.w+1)*(Scene_data.stageHeight/2)/UIData.Scale-this.ui.height/2+this._bloodExtMesh.offsetY,this.ui.x+=this._bloodExtMesh.offsetX}}else this.ui.x=1e4;this._bloodExtMesh.clear&&(this.ui.parent.removeChild(this.ui),this._data=null)}},e}(Disp2DBaseText),BloodExtMesh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._offsetX=0,t._offsetY=0,t._anger=1,t}return __extends(t,e),t.prototype.destory=function(){this.pos=null,this._mid=0,this._num=0,this.needDraw=null,this.offsetY=0},Object.defineProperty(t.prototype,"mid",{get:function(){return this._mid},set:function(t){this._mid=t,this.needDraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"num",{get:function(){return this._num},set:function(t){this._num=t,this.needDraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anger",{get:function(){return this._anger},set:function(t){this._anger=t,this.needDraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){return this._offsetX},set:function(t){this._offsetX=t,this.needDraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this._offsetY},set:function(t){this._offsetY=t,this.needDraw=!0},enumerable:!0,configurable:!0}),t}(tl3d.baseMeshVo),StartTitleUiVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.makeData=function(){if(this._data){this._startTitleMesh=this._data;for(var t=this.parent.uiAtlas.getRec(this.textureStr),e=tl3d.UIManager.getInstance().getContext2D(t.pixelWitdh,t.pixelHeight,!1),i=53-(17*this._startTitleMesh.num>>1),n=0;n<this._startTitleMesh.num;n++)UiDraw.cxtDrawImg(e,0==this._startTitleMesh.type?"star0":"star1",new Rectangle(i+17*n,1,17,16),UIData.publicsUi);TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,t.pixelX,t.pixelY,e)}},e.prototype.update=function(){if(this._startTitleMesh){if(this._startTitleMesh.needDraw&&(this.makeData(),this._startTitleMesh.needDraw=!1),this._startTitleMesh.pos)if(this._startTitleMesh.visible){if(this.needUpData(this._startTitleMesh.pos)){var t=Scene_data.cam3D.cameraMatrix.clone();t.append(Scene_data.viewMatrx3D);var e=t.transformVector(this._startTitleMesh.pos);this.ui.x=(e.x/e.w+1)*(Scene_data.stageWidth/2)/UIData.Scale-this.ui.width/2,this.ui.y=(-e.y/e.w+1)*(Scene_data.stageHeight/2)/UIData.Scale-this.ui.height/2+this._startTitleMesh.offsetY}}else this.ui.x=1e4;this._startTitleMesh.clear&&(this.ui.parent.removeChild(this.ui),this._data=null)}},e}(Disp2DBaseText),StartTitleMesh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._offsetY=0,t}return __extends(t,e),t.prototype.destory=function(){this.pos=null,this._num=0,this.needDraw=null,this.offsetY=0},Object.defineProperty(t.prototype,"num",{get:function(){return this._num},set:function(t){this._num=t,this.needDraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.needDraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this._offsetY},set:function(t){this._offsetY=t,this.needDraw=!0},enumerable:!0,configurable:!0}),t}(tl3d.baseMeshVo),LevelTitleUiVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.makeData=function(){if(this._data){this._levTitleMesh=this._data;var t=this.parent.uiAtlas.getRec(this.textureStr),e=tl3d.UIManager.getInstance().getContext2D(t.pixelWitdh,t.pixelHeight,!1);UiDraw.cxtDrawImg(e,"team"+this._levTitleMesh.type,new Rectangle(20,0,18,18),UIData.publicsUi);var i=String(Math.floor(this._levTitleMesh.lev)),n=13;2==i.length?n=7:2<i.length&&(n=0),tl3d.LabelTextFont.writeSingleLabelToCtx(e,i,12,n,4,tl3d.TextAlign.LEFT,ColorConst.WHITE,"#000000",!1),TextureManager.getInstance().updateTexture(this.parent.uiAtlas.texture,t.pixelX,t.pixelY,e)}},e.prototype.update=function(){if(this._levTitleMesh){if(this._levTitleMesh.needDraw&&(this.makeData(),this._levTitleMesh.needDraw=!1),this._levTitleMesh.pos)if(this._levTitleMesh.visible){if(this.needUpData(this._levTitleMesh.pos)){var t=Scene_data.cam3D.cameraMatrix.clone();t.append(Scene_data.viewMatrx3D);var e=t.transformVector(this._levTitleMesh.pos);this.ui.x=(e.x/e.w+1)*(Scene_data.stageWidth/2)/UIData.Scale-this.ui.width/2,this.ui.y=(-e.y/e.w+1)*(Scene_data.stageHeight/2)/UIData.Scale-this.ui.height/2+this._levTitleMesh.offsetY,this.ui.y+=4,this.ui.x-=40}}else this.ui.x=1e4;this._levTitleMesh.clear&&(this.ui.parent.removeChild(this.ui),this._data=null)}},e}(CharTitleUiVo),LevelTitleMesh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._offsetY=0,t}return __extends(t,e),t.prototype.destory=function(){this.pos=null,this._lev=null,this.needDraw=null,this.offsetY=0},Object.defineProperty(t.prototype,"lev",{get:function(){return this._lev},set:function(t){this._lev=t,this.needDraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.needDraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this._offsetY},set:function(t){this._offsetY=t,this.needDraw=!0},enumerable:!0,configurable:!0}),t}(tl3d.baseMeshVo),GameUIChar=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(e){function t(){var t=e.call(this)||this;return t.movesucc=!1,t}return __extends(t,e),t.prototype.updateMatrix=function(){this.posMatrix.identity(),this.posMatrix.appendScale(this._scaleX,this._scaleY,this._scaleZ),this.posMatrix.appendRotation(this._rotationY,Vector3D.Y_AXIS),this.posMatrix.appendRotation(30,Vector3D.X_AXIS),this.posMatrix.appendRotation(this._rotationZ,Vector3D.Z_AXIS),this.posMatrix.appendTranslation(this._x,this._y,this._z)},t.prototype.removeSelf=function(){this._hasDestory||(clearTimeout(this.hptick),clearTimeout(this.dietick),this.hp=0,this.clearBloodBar(),this._scene.removeMovieDisplay(this),this.destory())},t.prototype.clearBloodBar=function(){},t}(Game2dChar)),LoadeQueue=function(){function t(){this._funcs=new Array}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.addQueueExcute=function(t){this._state||(this._state=!0,Laya.timer.frameLoop(2,this,this.excute)),this._funcs.push(t)},t.prototype.excute=function(){if(0<this._funcs.length){var t=this._funcs.pop();t.run(),t.clear()}else this._state=!1,Laya.timer.clear(this,this.excute),logdebug("excute all")},t.prototype.loadAll=function(t,e,i,n,o,a,r){t.resId=o,this._baseScene=t,this._skillUrl=e,this._roleUrl=i,this._effUrl=n,this._mapid=o,this._process=a,this._sonComplete=r,logyhj("加载技能 %d个，加载角色 %d 个，加载特效 %d个",e.length,i.length,n.length),this._loadState=0,this.Load()},t.prototype.Load=function(){(this._curcount=0)==this._loadState?this._skillUrl&&0<this._skillUrl.length?(this._count=this._skillUrl.length,this.LoadSkill()):(this._loadState=1,this.Load()):1==this._loadState?this._roleUrl&&0<this._roleUrl.length?(this._count=this._roleUrl.length,this.loadRole()):(this._loadState=2,this.Load()):2==this._loadState?this._effUrl&&0<this._effUrl.length?(this._count=this._effUrl.length,this.loadEff()):(this._loadState=3,this.Load()):3==this._loadState&&(this._mapid&&0<this._mapid.length?(this._count=1,this.loadMap()):this.LoadComplete())},t.prototype.LoadComplete=function(){this._loadState=4,this._baseScene=null,this._sonComplete&&(this._sonComplete.call(null),this._sonComplete=null)},t.prototype.LoadSkill=function(){if(this._baseScene&&this._baseScene.scene){var t=this._skillUrl.shift();this._baseScene.scene.skillMgr.preLoadSkill(getSkillUrl(t),this.onSkillLoaded.bind(this))}else this.onSkillLoaded()},t.prototype.onSkillLoaded=function(){this.loadProcess(),this._curcount++,0==this._skillUrl.length?(this._loadState=1,this.Load()):Laya.timer.callLater(this,this.LoadSkill.bind(this))},t.prototype.loadRole=function(){var t=this._roleUrl.pop();if(t){var e=getRoleUrl(t.toString());tl3d.MeshDataManager.getInstance().getMeshData(e,this.onRoleLoaded.bind(this))}else this.onRoleLoaded(null)},t.prototype.onRoleLoaded=function(t){this.loadProcess(),this._curcount++,0==this._roleUrl.length?(this._loadState=2,this.Load()):Laya.timer.callLater(this,this.loadRole.bind(this))},t.prototype.loadEff=function(){var t=this._effUrl.pop();if(t&&this._baseScene&&this._baseScene.scene){var e=Scene_data.fileRoot+getEffectUrl(t.toString());this._baseScene.scene.groupDataMgr.scene=this._baseScene.scene,this._baseScene.scene.groupDataMgr.perLoadData(e,this.onEffLoaded.bind(this))}else this.onEffLoaded()},t.prototype.onEffLoaded=function(){this.loadProcess(),this._curcount++,this._effUrl.length<=0?(this._loadState=3,this.Load()):Laya.timer.callLater(this,this.loadEff.bind(this))},t.prototype.loadMap=function(){var e=this;this._baseScene&&this._baseScene.scene?this._baseScene.scene.loadScene(this._mapid,function(){},function(t){1<=t||e._process&&e._process.call(null,t,e._loadState)},this.LoadComplete.bind(this)):this.LoadComplete()},t.prototype.loadProcess=function(){if(this._process){var t=this._count<=0?1:this._count;this._process.call(null,Math.min(this._curcount/t,1),this._loadState)}},t}(),BaseSceneMgr=function(){function t(){this._particles={},this._count=0}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.getScene=function(){return this._uiScene||(this._uiScene=new Base2dSceneLayer),this._uiScene},t.prototype.showEffect=function(e,t,i,n,o,a,r,s,u){var h=this;void 0===s&&(s=!1),void 0===u&&(u=null),this._uiScene||(this._uiScene=new Base2dSceneLayer),this._count++,-1!=t?e.addChildAt(this._uiScene,t):e.addChild(this._uiScene),this._parent=e,this._uiScene.addEffect(null,i,new tl3d.Vector3D(n,0,o),a,r,function(t){h._particles.hasOwnProperty(i)?h._uiScene.removeEffect(t):(e.parent?h._particles[i]=t:(logdebug("添加的目标已移除"),h._uiScene.removeEffect(t)),t.onComplete=function(t){u&&u(t),s&&h.removeEffect(i)})},0,0),this._uiScene.onShow()},t.prototype.removeEffect=function(t){if(this._uiScene){var e=this._particles[t];e&&(this._count--,this._uiScene.removeEffect(e),delete this._particles[t]),this._count<=0&&this._uiScene.parent&&(this._uiScene.onExit(),this._uiScene.removeSelf())}},t.prototype.clearScene=function(){},t}();__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=Laya.Dialog,__extends(e,n),e.prototype.onStageResize=function(){Laya.stage.on(Laya.Event.RESIZE,this,this.onResize)},e.prototype.onResize=function(t){this.setSize(Laya.stage.width,Laya.stage.height)},e.prototype.setSize=function(t,e){this.size(t,e)},e.prototype.close=function(t,e,i){e=void 0!==e?e:!!this.dialogInfo&&this.dialogInfo.popEffect,n.prototype.close.call(this,t,e)},e.prototype.popup=function(t,e){e=void 0!==e?e:!!this.dialogInfo&&this.dialogInfo.popEffect,n.prototype.popup.call(this,t,e),dispatchEvt(new i.GlobalEvent(i.GlobalEvent.DIALOG_CREATED,this))},e.prototype.show=function(t,e){e=void 0!==e?e:!!this.dialogInfo&&this.dialogInfo.popEffect,n.prototype.show.call(this,t,e),dispatchEvt(new i.GlobalEvent(i.GlobalEvent.DIALOG_CREATED,this))},e.prototype.onOpened=function(){n.prototype.onOpened.call(this),this.dialogInfo&&ResUseMgr.useRes(this.dialogInfo.destroyAtlases),dispatchEvt(new i.GlobalEvent(i.GlobalEvent.DIALOG_OPENED,this))},e.prototype.onClosed=function(t){n.prototype.onClosed.call(this,t),this.dataSource=null,this.scale(1,1),this.dialogInfo&&(ResUseMgr.releaseRes(this.dialogInfo.destroyAtlases),DialogQueueMgr.getInstance().pushNext(this.dialogInfo.uiname)),dispatchEvt(new i.GlobalEvent(i.GlobalEvent.DIALOG_CLOSED,this)),Laya.stage.off(Laya.Event.RESIZE,this,this.onResize)},e);function e(){return n.call(this)||this}i.DialogExt=t}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();var ui,View=laya.ui.View,Dialog=laya.ui.Dialog,DialogExt=common.DialogExt;!function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.bindPhone||(e.bindPhone={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitleView",common.CommonTitleView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("activity/bindPhone/BindPhone")},o=a,i.BindPhoneUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.chongzhi||(e.chongzhi={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/chongzhi/BuySucc")},o=a,i.BuySuccUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.chongzhi||(e.chongzhi={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("game.TabTequan",game.TabTequan),View.regComponent("game.ChongzhiIR",game.ChongzhiIR),n.prototype.createChildren.call(this),this.loadUI("activity/chongzhi/Chongzhi")},o=a,i.ChongzhiUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.chongzhi||(e.chongzhi={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("activity/chongzhi/ChongzhiIR")},o=a,i.ChongzhiIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.chongzhi||(e.chongzhi={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/chongzhi/RechargeGiftSucc")},o=a,i.RechargeGiftSuccUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.chongzhi||(e.chongzhi={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/chongzhi/RechargeSucc")},o=a,i.RechargeSuccUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.chongzhi||(e.chongzhi={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.TeQuanItemIR",game.TeQuanItemIR),n.prototype.createChildren.call(this),this.loadUI("activity/chongzhi/TabTequan")},o=a,i.TabTequanUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.chongzhi||(e.chongzhi={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/chongzhi/teQuanItemIR")},o=a,i.teQuanItemIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.download||(e.download={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("activity/download/WeiDuanXiaZaiView")},o=a,i.WeiDuanXiaZaiViewUI=o}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.luckyturn||(i.luckyturn={}),__extends(r,o=DialogExt),r.prototype.createChildren=function(){View.regComponent("common.CommonTitle2View",common.CommonTitle2View),o.prototype.createChildren.call(this),this.loadUI("activity/huodong/luckyturn/luckyRecord")},a=r,n.luckyRecordUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.luckyturn||(i.luckyturn={}),__extends(r,o=DialogExt),r.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.ItemBox3",common.ItemBox3),View.regComponent("common.ItemBox2",common.ItemBox2),o.prototype.createChildren.call(this),this.loadUI("activity/huodong/luckyturn/luckyturn")},a=r,n.luckyturnUI=a}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.luckyturn||(i.luckyturn={}),o=n.Tip||(n.Tip={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("common.CommonTitle9View",common.CommonTitle9View),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/luckyturn/Tip/TurnReward")},r=s,o.TurnRewardUI=r}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),__extends(r,o=DialogExt),r.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("game.PayActivityTabIR",game.PayActivityTabIR),o.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/payActivity")},a=r,n.payActivityUI=a}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.render||(n.render={}),__extends(s,a=View),s.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/render/DengjilibaoRender")},r=s,o.DengjilibaoRenderUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.render||(n.render={}),__extends(s,a=View),s.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/render/EquipExtIR")},r=s,o.EquipExtIRUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.render||(n.render={}),__extends(s,a=View),s.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/render/LibaoIR")},r=s,o.LibaoIRUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.render||(n.render={}),__extends(s,a=View),s.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/render/QiandaoRender")},r=s,o.QiandaoRenderUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.render||(n.render={}),__extends(s,a=View),s.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/render/RatingfundRender")},r=s,o.RatingfundRenderUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.render||(n.render={}),__extends(s,a=View),s.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/render/toSignIR")},r=s,o.toSignIRUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.render||(n.render={}),__extends(s,a=View),s.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/render/TotalsignRender")},r=s,o.TotalsignRenderUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.render||(n.render={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/render/YueKaItemIR")},r=s,o.YueKaItemIRUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.tab||(n.tab={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("game.LvGiftIR",game.LvGiftIR),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/tab/Dengji")},r=s,o.DengjiUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.tab||(n.tab={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/tab/Duihuan")},r=s,o.DuihuanUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.tab||(n.tab={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("game.FundIR",game.FundIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/tab/Jijin")},r=s,o.JijinUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.tab||(n.tab={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("game.SignInIR",game.SignInIR),View.regComponent("game.TotalsignIR",game.TotalsignIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/tab/Sign")},r=s,o.SignUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.tab||(n.tab={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("game.TosignIR",game.TosignIR),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/tab/toSign")},r=s,o.toSignUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.tab||(n.tab={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("game.XiangouLibaoIR",game.XiangouLibaoIR),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/tab/XianGouLibao")},r=s,o.XianGouLibaoUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.tab||(n.tab={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.ItemBox3",common.ItemBox3),View.regComponent("game.RedPointProp",game.RedPointProp),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/tab/Xuyuan")},r=s,o.XuyuanUI=r}(ui=ui||{}),function(t){var e,i,n,o,a,r;function s(){return a.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),o=n.tab||(n.tab={}),__extends(s,a=DialogExt),s.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("game.YueKaItemIR",game.YueKaItemIR),a.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/tab/Yueka")},r=s,o.YuekaUI=r}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.huodong||(e.huodong={}),n=i.welfare||(i.welfare={}),__extends(r,o=DialogExt),r.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.WelfareIR",game.WelfareIR),o.prototype.createChildren.call(this),this.loadUI("activity/huodong/welfare/welfare")},a=r,n.welfareUI=a}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.limitebuy||(e.limitebuy={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.JiangliIR",game.JiangliIR),n.prototype.createChildren.call(this),this.loadUI("activity/limitebuy/JiangLi")},o=a,i.JiangLiUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.limitebuy||(e.limitebuy={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.LbTabIR",game.LbTabIR),n.prototype.createChildren.call(this),this.loadUI("activity/limitebuy/LimiteBuy")},o=a,i.LimiteBuyUI=o}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.limitebuy||(e.limitebuy={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),o.prototype.createChildren.call(this),this.loadUI("activity/limitebuy/render/ItemSelectBox")},a=r,n.ItemSelectBoxUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.limitebuy||(e.limitebuy={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),o.prototype.createChildren.call(this),this.loadUI("activity/limitebuy/render/JiangliIR")},a=r,n.JiangliIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.limitebuy||(e.limitebuy={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){o.prototype.createChildren.call(this),this.loadUI("activity/limitebuy/render/RankIR")},a=r,n.RankIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.limitebuy||(e.limitebuy={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){o.prototype.createChildren.call(this),this.loadUI("activity/limitebuy/render/ScoreIR")},a=r,n.ScoreIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.limitebuy||(e.limitebuy={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){o.prototype.createChildren.call(this),this.loadUI("activity/limitebuy/render/ZheKouIR")},a=r,n.ZheKouIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.limitebuy||(e.limitebuy={}),n=i.tab||(i.tab={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("game.ItemSelectBox",game.ItemSelectBox),View.regComponent("game.ZheKouIR",game.ZheKouIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),o.prototype.createChildren.call(this),this.loadUI("activity/limitebuy/tab/TabGroup")},a=r,n.TabGroupUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.limitebuy||(e.limitebuy={}),n=i.tab||(i.tab={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("game.LbRankIR",game.LbRankIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.ScoreIR",game.ScoreIR),o.prototype.createChildren.call(this),this.loadUI("activity/limitebuy/tab/TabSummon")},a=r,n.TabSummonUI=a}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.logingift||(e.logingift={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("ui.activity.logingift.logingiftIRUI",t.activity.logingift.logingiftIRUI),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/logingift/logingift")},o=a,i.logingiftUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.logingift||(e.logingift={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("activity/logingift/logingiftIR")},o=a,i.logingiftIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.notice||(e.notice={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/notice/GameNotice")},o=a,i.GameNoticeUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.notice||(e.notice={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("activity/notice/NoticeIR")},o=a,i.NoticeIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.online||(e.online={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/online/itemIR")},o=a,i.itemIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.online||(e.online={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.ItemIR",game.ItemIR),n.prototype.createChildren.call(this),this.loadUI("activity/online/mainPage")},o=a,i.mainPageUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.openserver||(e.openserver={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.TabIR",game.TabIR),View.regComponent("game.TabPage",game.TabPage),n.prototype.createChildren.call(this),this.loadUI("activity/openserver/mainPage")},o=a,i.mainPageUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.openserver||(e.openserver={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.OpenServerGiftIR",game.OpenServerGiftIR),n.prototype.createChildren.call(this),this.loadUI("activity/openserver/openServerGift")},o=a,i.openServerGiftUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.openserver||(e.openserver={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/openserver/openServerGiftIR")},o=a,i.openServerGiftIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.openserver||(e.openserver={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/openserver/tabPage")},o=a,i.tabPageUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.powerrank||(e.powerrank={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("activity/powerrank/itemIR")},o=a,i.itemIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.powerrank||(e.powerrank={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.TabIR1",common.TabIR1),View.regComponent("game.MainTabPage",game.MainTabPage),n.prototype.createChildren.call(this),this.loadUI("activity/powerrank/mainPage")},o=a,i.mainPageUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.powerrank||(e.powerrank={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.PowerAwardIR",game.PowerAwardIR),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("activity/powerrank/mainTabPage")},o=a,i.mainTabPageUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.powerrank||(e.powerrank={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.PrRankIR",game.PrRankIR),n.prototype.createChildren.call(this),this.loadUI("activity/powerrank/powerRank")},o=a,i.powerRankUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.powerrank||(e.powerrank={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("activity/powerrank/rankIR")},o=a,i.rankIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.realName||(e.realName={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/realName/realName")},o=a,i.realNameUI=o}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.sevendays||(e.sevendays={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),o.prototype.createChildren.call(this),this.loadUI("activity/sevendays/render/SevendaysRender")},a=r,n.SevendaysRenderUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.activity||(t.activity={}),i=e.sevendays||(e.sevendays={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),o.prototype.createChildren.call(this),this.loadUI("activity/sevendays/render/tabItemRender")},a=r,n.tabItemRenderUI=a}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.sevendays||(e.sevendays={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("game.tabIR",game.tabIR),View.regComponent("common.TabIR1",common.TabIR1),View.regComponent("game.SevendaysIR",game.SevendaysIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("activity/sevendays/sevendays")},o=a,i.sevendaysUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.share||(e.share={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("activity/share/firstPage")},o=a,i.firstPageUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.share||(e.share={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("activity/share/mainIR")},o=a,i.mainIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.share||(e.share={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.ShareMainIR",game.ShareMainIR),n.prototype.createChildren.call(this),this.loadUI("activity/share/mainPage")},o=a,i.mainPageUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.shouchong||(e.shouchong={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/shouchong/RewardIR")},o=a,i.RewardIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.shouchong||(e.shouchong={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("ui.activity.shouchong.ShouchongTabOneUI",t.activity.shouchong.ShouchongTabOneUI),View.regComponent("ui.activity.shouchong.ShouchongTabTwoUI",t.activity.shouchong.ShouchongTabTwoUI),View.regComponent("ui.activity.shouchong.ShouchongTabThreeUI",t.activity.shouchong.ShouchongTabThreeUI),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("activity/shouchong/Shouchong")},o=a,i.ShouchongUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.shouchong||(e.shouchong={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/shouchong/ShouchongTabOne")},o=a,i.ShouchongTabOneUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.shouchong||(e.shouchong={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/shouchong/ShouchongTabThree")},o=a,i.ShouchongTabThreeUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.shouchong||(e.shouchong={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/shouchong/ShouchongTabTwo")},o=a,i.ShouchongTabTwoUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.shouchong||(e.shouchong={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("activity/shouchong/Shouchongtishi")},o=a,i.ShouchongtishiUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.supervip||(e.supervip={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/supervip/SuperVip")},o=a,i.SuperVipUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.testrebate||(e.testrebate={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/testrebate/TestRebate")},o=a,i.TestRebateUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.timelimitactivity||(e.timelimitactivity={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/timelimitactivity/ExchangeItem")},o=a,i.ExchangeItemUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.timelimitactivity||(e.timelimitactivity={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/timelimitactivity/HuodongRender")},o=a,i.HuodongRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.timelimitactivity||(e.timelimitactivity={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/timelimitactivity/JiJinIR")},o=a,i.JiJinIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.timelimitactivity||(e.timelimitactivity={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("game.TlTabIR",game.TlTabIR),View.regComponent("game.TlInfoIR",game.TlInfoIR),n.prototype.createChildren.call(this),this.loadUI("activity/timelimitactivity/TimeLimitActivity")},o=a,i.TimeLimitActivityUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.timelimitactivity||(e.timelimitactivity={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.FundTabIR",game.FundTabIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.FundRewardIR",game.FundRewardIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("activity/timelimitactivity/WeekFund")},o=a,i.WeekFundUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.activity||(t.activity={}),i=e.timelimitactivity||(e.timelimitactivity={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("activity/timelimitactivity/xianshiView")},o=a,i.xianshiViewUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.arena||(e.arena={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.ArenaIR",game.ArenaIR),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("arena/arena/Arena")},o=a,i.ArenaUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.arena||(e.arena={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.ChannelBox",common.ChannelBox),View.regComponent("game.ClgRewardIR",game.ClgRewardIR),n.prototype.createChildren.call(this),this.loadUI("arena/arena/ArenaFail")},o=a,i.ArenaFailUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.arena||(e.arena={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.RankIR",common.RankIR),View.regComponent("common.AwardRankIR",common.AwardRankIR),n.prototype.createChildren.call(this),this.loadUI("arena/arena/ArenaRank")},o=a,i.ArenaRankUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.arena||(e.arena={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle2View",common.CommonTitle2View),View.regComponent("game.ArenaRecordIR",game.ArenaRecordIR),n.prototype.createChildren.call(this),this.loadUI("arena/arena/ArenaRecord")},o=a,i.ArenaRecordUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.arena||(e.arena={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("game.ArenaBrandIR",game.ArenaBrandIR),View.regComponent("game.ClgRewardIR",game.ClgRewardIR),n.prototype.createChildren.call(this),this.loadUI("arena/arena/ArenaSucc")},o=a,i.ArenaSuccUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.arena||(e.arena={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("arena/arena/ArenaTopRank")},o=a,i.ArenaTopRankUI=o}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.arena||(t.arena={}),i=e.arena||(e.arena={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),o.prototype.createChildren.call(this),this.loadUI("arena/arena/render/ArenaBrandIR")},a=r,n.ArenaBrandIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.arena||(t.arena={}),i=e.arena||(e.arena={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){o.prototype.createChildren.call(this),this.loadUI("arena/arena/render/ArenaIR")},a=r,n.ArenaIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.arena||(t.arena={}),i=e.arena||(e.arena={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),o.prototype.createChildren.call(this),this.loadUI("arena/arena/render/ArenaRecordIR")},a=r,n.ArenaRecordIRUI=a}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.match||(e.match={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.MatchIR",game.MatchIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("arena/match/MatchMain")},o=a,i.MatchMainUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.match||(e.match={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.RankIR",common.RankIR),n.prototype.createChildren.call(this),this.loadUI("arena/match/MatchRank")},o=a,i.MatchRankUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.match||(e.match={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.ChannelBox",common.ChannelBox),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("arena/match/MatchResult")},o=a,i.MatchResultUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.arena||(t.arena={}),i=e.match||(e.match={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.AwardRankIR",common.AwardRankIR),View.regComponent("game.KuafuRewardIR",game.KuafuRewardIR),n.prototype.createChildren.call(this),this.loadUI("arena/match/MatchReward")},o=a,i.MatchRewardUI=o}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.arena||(t.arena={}),i=e.match||(e.match={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),o.prototype.createChildren.call(this),this.loadUI("arena/match/render/KuafuRewardIR")},a=r,n.KuafuRewardIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.arena||(t.arena={}),i=e.match||(e.match={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),o.prototype.createChildren.call(this),this.loadUI("arena/match/render/MatchIR")},a=r,n.MatchIRUI=a}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.artifact||(t.artifact={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("ui.artifact.itemRender.ArtifactItemRenderUI",t.artifact.itemRender.ArtifactItemRenderUI),View.regComponent("game.godTabIR",game.godTabIR),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SkillBox",common.SkillBox),View.regComponent("game.TabBaptize",game.TabBaptize),View.regComponent("game.TabEnchant",game.TabEnchant),View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("artifact/Artifact")},n=o,e.ArtifactUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.artifact||(t.artifact={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.ArtifactListIR",game.ArtifactListIR),i.prototype.createChildren.call(this),this.loadUI("artifact/ArtifactList")},n=o,e.ArtifactListUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.artifact||(t.artifact={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("artifact/ArtifactUnLock")},n=o,e.ArtifactUnLockUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.itemRender||(e.itemRender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("artifact/itemRender/ArtifactItemRender")},o=a,i.ArtifactItemRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.itemRender||(e.itemRender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("artifact/itemRender/ArtifactListIR")},o=a,i.ArtifactListIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.itemRender||(e.itemRender={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("artifact/itemRender/BaptizeAttriRender")},o=a,i.BaptizeAttriRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.tab||(e.tab={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("ui.artifact.itemRender.BaptizeAttriRenderUI",t.artifact.itemRender.BaptizeAttriRenderUI),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("artifact/tab/ArtifactBaptize")},o=a,i.ArtifactBaptizeUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.tab||(e.tab={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("artifact/tab/ArtifactEnchant")},o=a,i.ArtifactEnchantUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.tip||(e.tip={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),n.prototype.createChildren.call(this),this.loadUI("artifact/tip/ArtDetails")},o=a,i.ArtDetailsUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.tip||(e.tip={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),n.prototype.createChildren.call(this),this.loadUI("artifact/tip/BaptizeDetails")},o=a,i.BaptizeDetailsUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.tip||(e.tip={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),n.prototype.createChildren.call(this),this.loadUI("artifact/tip/BaptizeTip")},o=a,i.BaptizeTipUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.tip||(e.tip={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),n.prototype.createChildren.call(this),this.loadUI("artifact/tip/EnchantTip")},o=a,i.EnchantTipUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.artifact||(t.artifact={}),i=e.tip||(e.tip={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),n.prototype.createChildren.call(this),this.loadUI("artifact/tip/ObtainTip")},o=a,i.ObtainTipUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("ui.bag.TabUI",t.bag.TabUI),View.regComponent("common.HeadBox2",common.HeadBox2),View.regComponent("common.RaceBox",common.RaceBox),View.regComponent("game.ChooseTreasureIR",game.ChooseTreasureIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("bag/Bag")},n=o,e.BagUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.PropretyIR",game.PropretyIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("bag/Bagdetails")},n=o,e.BagdetailsUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("bag/BaseBox")},n=o,e.BaseBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.PropretyIR",game.PropretyIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("bag/Details")},n=o,e.DetailsUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.BaseBox",game.BaseBox),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("bag/ItemBox")},n=o,e.ItemBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.DetailIR",game.DetailIR),View.regComponent("game.BoxIR",game.BoxIR),i.prototype.createChildren.call(this),this.loadUI("bag/ItemRender")},n=o,e.ItemRenderUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.BaseBox",game.BaseBox),i.prototype.createChildren.call(this),this.loadUI("bag/RecycBox")},n=o,e.RecycBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.RecycIR",game.RecycIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("bag/Recycle")},n=o,e.RecycleUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("ui.bag.RewardSelectIRUI",t.bag.RewardSelectIRUI),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("bag/RewardSelect")},n=o,e.RewardSelectUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("bag/RewardSelectIR")},n=o,e.RewardSelectIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("bag/Tab")},n=o,e.TabUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.bag||(t.bag={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("bag/Use")},n=o,e.UseUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.boss||(t.boss={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("boss/BossIR")},n=o,e.BossIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.boss||(t.boss={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("boss/BossRewardIR")},n=o,e.BossRewardIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.boss||(t.boss={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.BossFightRankIR",game.BossFightRankIR),i.prototype.createChildren.call(this),this.loadUI("boss/FightRank")},n=o,e.FightRankUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.boss||(t.boss={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("boss/FightRankIR")},n=o,e.FightRankIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.boss||(t.boss={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.BossRankIR",game.BossRankIR),i.prototype.createChildren.call(this),this.loadUI("boss/Rank")},n=o,e.RankUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.boss||(t.boss={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.CommonRankIR",common.CommonRankIR),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("boss/RankIR")},n=o,e.RankIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.boss||(t.boss={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.AwardRankIR",common.AwardRankIR),i.prototype.createChildren.call(this),this.loadUI("boss/Reward")},n=o,e.RewardUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.boss||(t.boss={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.BossRewardIR",game.BossRewardIR),View.regComponent("game.BossIR",game.BossIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("boss/WorldBoss")},n=o,e.WorldBossUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("box/AwardRankIR")},n=o,e.AwardRankIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/BaoxiangBox")},n=o,e.BaoxiangBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/BuzhenBox")},n=o,e.BuzhenBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.HeadBox",common.HeadBox),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("box/BuzhenItemBox")},n=o,e.BuzhenItemBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("HTMLDivElement",laya.html.dom.HTMLDivElement),i.prototype.createChildren.call(this),this.loadUI("box/CommonRuleIR")},n=o,e.CommonRuleIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/CostIR")},n=o,e.CostIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("box/effItemBox")},n=o,e.effItemBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("box/EquipItemBox")},n=o,e.EquipItemBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/GodRaceAdd")},n=o,e.GodRaceAddUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/HeadBox")},n=o,e.HeadBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.HeadBox",common.HeadBox),i.prototype.createChildren.call(this),this.loadUI("box/HeadBox2")},n=o,e.HeadBox2UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.HeadBox",common.HeadBox),i.prototype.createChildren.call(this),this.loadUI("box/HeadNameBox")},n=o,e.HeadNameBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/ItemBox")},n=o,e.ItemBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("box/ItemBox2")},n=o,e.ItemBox2UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("box/ItemBox21")},n=o,e.ItemBox21UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("box/ItemBox3")},n=o,e.ItemBox3UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/RaceBox")},n=o,e.RaceBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.CommonRankIR",common.CommonRankIR),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("box/RankIR")},n=o,e.RankIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/ResBox")},n=o,e.ResBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/SimpleItemBox")},n=o,e.SimpleItemBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/SkillBox")},n=o,e.SkillBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("box/TabIR1")},n=o,e.TabIR1UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("box/TabIR2")},n=o,e.TabIR2UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("box/TabIR3")},n=o,e.TabIR3UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("box/TabIR4")},n=o,e.TabIR4UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.box||(t.box={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("box/UserHeadBox1")},n=o,e.UserHeadBox1UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.chat||(t.chat={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.FaceView",game.FaceView),View.regComponent("game.ChatQuickView",game.ChatQuickView),View.regComponent("game.ChatTabIR",game.ChatTabIR),i.prototype.createChildren.call(this),this.loadUI("chat/Chat")},n=o,e.ChatUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.chat||(t.chat={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("chat/ChatIR")},n=o,e.ChatIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.chat||(t.chat={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("chat/ChatQuick")},n=o,e.ChatQuickUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.chat||(t.chat={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("chat/ChatTabIR")},n=o,e.ChatTabIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.chat||(t.chat={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("chat/Face")},n=o,e.FaceUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.chat||(t.chat={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("game.PrivateChatIR",game.PrivateChatIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.FaceView",game.FaceView),i.prototype.createChildren.call(this),this.loadUI("chat/PrivateChat")},n=o,e.PrivateChatUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.chat||(t.chat={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("chat/PrivateChatIR")},n=o,e.PrivateChatIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/AlertBox")},n=o,e.AlertBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/BuyBattleCount")},n=o,e.BuyBattleCountUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=Dialog),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/Camra")},n=o,e.CamraUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/ChannelBox")},n=o,e.ChannelBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),i.prototype.createChildren.call(this),this.loadUI("component/Chushou")},n=o,e.ChushouUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/Combobox")},n=o,e.ComboboxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.DialogOpenEff",common.DialogOpenEff),i.prototype.createChildren.call(this),this.loadUI("component/CommonFightTitle")},n=o,e.CommonFightTitleUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.DialogOpenEff",common.DialogOpenEff),i.prototype.createChildren.call(this),this.loadUI("component/CommonLevelUpTitle")},n=o,e.CommonLevelUpTitleUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/CommonRankItem")},n=o,e.CommonRankItemUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("component/CommonRankItemRendeer")},n=o,e.CommonRankItemRendeerUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("component/CommonRewardBox")},n=o,e.CommonRewardBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),i.prototype.createChildren.call(this),this.loadUI("component/CommonRule")},n=o,e.CommonRuleUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/CommonTitle")},n=o,e.CommonTitleUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/CommonTitle2")},n=o,e.CommonTitle2UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/CommonTitle4")},n=o,e.CommonTitle4UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/CommonTitle5")},n=o,e.CommonTitle5UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/CommonTitle6")},n=o,e.CommonTitle6UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/CommonTitle7")},n=o,e.CommonTitle7UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/CommonTitle9")},n=o,e.CommonTitle9UI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/ConsumeAlert")},n=o,e.ConsumeAlertUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/GodStarInfo")},n=o,e.GodStarInfoUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("component/ItemTip")},n=o,e.ItemTipUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonLevelUpTitleView",common.CommonLevelUpTitleView),View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("component/LevelUp")},n=o,e.LevelUpUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("component/ManyItemsTip")},n=o,e.ManyItemsTipUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),View.regComponent("common.CommonLineupView",common.CommonLineupView),i.prototype.createChildren.call(this),this.loadUI("component/PlayerInfo")},n=o,e.PlayerInfoUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),View.regComponent("common.CommonLineupView",common.CommonLineupView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/PlayerLinuepInfo")},n=o,e.PlayerLinuepInfoUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/RedPoint")},n=o,e.RedPointUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/RedPointCopy")},n=o,e.RedPointCopyUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/SkillTip")},n=o,e.SkillTipUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/SoundEffect")},n=o,e.SoundEffectUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/StarList")},n=o,e.StarListUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("component/Tishi")},n=o,e.TishiUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/ToastView")},n=o,e.ToastViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.component||(t.component={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("component/XianshiBaoxiang")},n=o,e.XianshiBaoxiangUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("dafuweng/biYanLiIR")},n=o,e.biYanLiIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.bowieIR",game.bowieIR),i.prototype.createChildren.call(this),this.loadUI("dafuweng/biYanLiView")},n=o,e.biYanLiViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("dafuweng/boxIR")},n=o,e.boxIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("dafuweng/caiDaXiaoView")},n=o,e.caiDaXiaoViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("dafuweng/caiQuanView")},n=o,e.caiQuanViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.SysTopResIR",game.SysTopResIR),View.regComponent("game.QiyuBtnView",game.QiyuBtnView),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("dafuweng/dafuwengView")},n=o,e.dafuwengViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("dafuweng/diamondIR")},n=o,e.diamondIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("dafuweng/goAndOutIR")},n=o,e.goAndOutIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("dafuweng/propIR")},n=o,e.propIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("dafuweng/QiyuAnim")},n=o,e.QiyuAnimUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("dafuweng/QiyuBtn")},n=o,e.QiyuBtnUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("dafuweng/QiyuResult")},n=o,e.QiyuResultUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("dafuweng/QiyuTabIR")},n=o,e.QiyuTabIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.QiyuTabIR",game.QiyuTabIR),View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("dafuweng/QiyuView")},n=o,e.QiyuViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("dafuweng/questionIR")},n=o,e.questionIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("dafuweng/questionPanel")},n=o,e.questionPanelUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("dafuweng/startIR")},n=o,e.startIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dafuweng||(t.dafuweng={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("dafuweng/yanliBoxIR")},n=o,e.yanliBoxIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dailycopy||(t.dailycopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.DailyCopyIR",game.DailyCopyIR),i.prototype.createChildren.call(this),this.loadUI("dailycopy/DailyCopy")},n=o,e.DailyCopyUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dailycopy||(t.dailycopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("dailycopy/DailyCopyBuy")},n=o,e.DailyCopyBuyUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dailycopy||(t.dailycopy={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("dailycopy/DailyCopyIR")},n=o,e.DailyCopyIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.dailycopy||(t.dailycopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("dailycopy/DailyCopyMain")},n=o,e.DailyCopyMainUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),i.prototype.createChildren.call(this),this.loadUI("equip/EquipChange")},n=o,e.EquipChangeUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("equip/EquipLvup")},n=o,e.EquipLvupUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.MasterItemRender",game.MasterItemRender),i.prototype.createChildren.call(this),this.loadUI("equip/EquipMaster")},n=o,e.EquipMasterUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("equip/EquipRecycle")},n=o,e.EquipRecycleUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.PropretyIR",game.PropretyIR),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.CostIR",common.CostIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("equip/EquipRefine")},n=o,e.EquipRefineUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("game.strengthAttriRender",game.strengthAttriRender),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.CostIR",common.CostIR),i.prototype.createChildren.call(this),this.loadUI("equip/EquipStrengthen")},n=o,e.EquipStrengthenUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),i.prototype.createChildren.call(this),this.loadUI("equip/EquipSuit")},n=o,e.EquipSuitUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("equip/EquipSuitLvup")},n=o,e.EquipSuitLvupUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("equip/EquipTips")},n=o,e.EquipTipsUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.TabEquip",game.TabEquip),View.regComponent("game.TabBaoshiNew",game.TabBaoshiNew),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.EquipGodIR",game.EquipGodIR),View.regComponent("game.godTabIR",game.godTabIR),i.prototype.createChildren.call(this),this.loadUI("equip/EquipView")},n=o,e.EquipViewUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.equip||(t.equip={}),i=e.gemstone||(e.gemstone={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("equip/gemstone/BaoShiIR")},o=a,i.BaoShiIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.equip||(t.equip={}),i=e.gemstone||(e.gemstone={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.EquipItemIR",game.EquipItemIR),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("equip/gemstone/EquipBaoshiIR")},o=a,i.EquipBaoshiIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.equip||(t.equip={}),i=e.gemstone||(e.gemstone={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.Combobox",common.Combobox),n.prototype.createChildren.call(this),this.loadUI("equip/gemstone/GemstoneCompound")},o=a,i.GemstoneCompoundUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.equip||(t.equip={}),i=e.gemstone||(e.gemstone={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("equip/gemstone/GemstoneReplace")},o=a,i.GemstoneReplaceUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.equip||(t.equip={}),i=e.gemstone||(e.gemstone={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("equip/gemstone/GemstoneTips")},o=a,i.GemstoneTipsUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.equip||(t.equip={}),i=e.gemstone||(e.gemstone={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("equip/gemstone/SingleCompound")},o=a,i.SingleCompoundUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.equip||(t.equip={}),i=e.gemstone||(e.gemstone={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.EquipBaoshiIR",game.EquipBaoshiIR),View.regComponent("game.BaoshiIR",game.BaoshiIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("equip/gemstone/TabBaoshiNew")},o=a,i.TabBaoshiNewUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.GetItemRender",game.GetItemRender),View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("equip/JumpView")},n=o,e.JumpViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.equip||(t.equip={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("equip/MasterRender")},n=o,e.MasterRenderUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.equip||(t.equip={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.HeadBox",common.HeadBox),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("equip/render/EquipGodIR")},o=a,i.EquipGodIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.equip||(t.equip={}),i=e.tab||(e.tab={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.EquipItemIR",game.EquipItemIR),View.regComponent("ui.god.render.AttrBoxUI",t.god.render.AttrBoxUI),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.CostIR",common.CostIR),n.prototype.createChildren.call(this),this.loadUI("equip/tab/TabEquip")},o=a,i.TabEquipUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.escort||(t.escort={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.HeadBox2",common.HeadBox2),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("escort/CaravanInfo")},n=o,e.CaravanInfoUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.escort||(t.escort={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.EscortIR",game.EscortIR),i.prototype.createChildren.call(this),this.loadUI("escort/Escort")},n=o,e.EscortUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.escort||(t.escort={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.EscortCircleIR",game.EscortCircleIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("escort/EscortMain")},n=o,e.EscortMainUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.escort||(t.escort={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle7View",common.CommonTitle7View),View.regComponent("game.EscortCircleIR",game.EscortCircleIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("escort/EscortReward")},n=o,e.EscortRewardUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.escort||(t.escort={}),i=e.itemRender||(e.itemRender={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("escort/itemRender/CaravanIRender")},o=a,i.CaravanIRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.escort||(t.escort={}),i=e.itemRender||(e.itemRender={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("escort/itemRender/EscortCircleIR")},o=a,i.EscortCircleIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.escort||(t.escort={}),i=e.itemRender||(e.itemRender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("escort/itemRender/EscortIRender")},o=a,i.EscortIRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.escort||(t.escort={}),i=e.itemRender||(e.itemRender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("escort/itemRender/RobRecordIRender")},o=a,i.RobRecordIRenderUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.escort||(t.escort={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle2View",common.CommonTitle2View),i.prototype.createChildren.call(this),this.loadUI("escort/RobbedRecord")},n=o,e.RobbedRecordUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fenjie||(t.fenjie={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("ui.god.render.ChooseBoxUI",t.god.render.ChooseBoxUI),View.regComponent("common.RaceBox",common.RaceBox),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("fenjie/Fenjie")},n=o,e.FenjieUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.fight||(t.fight={}),i=e.box||(e.box={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("fight/box/ArtifactRender")},o=a,i.ArtifactRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.fight||(t.fight={}),i=e.box||(e.box={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("fight/box/BossBuffBox")},o=a,i.BossBuffBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.fight||(t.fight={}),i=e.box||(e.box={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("fight/box/FightItemBox")},o=a,i.FightItemBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.fight||(t.fight={}),i=e.box||(e.box={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("fight/box/playSkillBox")},o=a,i.playSkillBoxUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fight||(t.fight={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.AutoLayoutList",common.AutoLayoutList),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("fight/FightGuildCopyResult")},n=o,e.FightGuildCopyResultUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fight||(t.fight={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("fight/fightHead")},n=o,e.fightHeadUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fight||(t.fight={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.fightBossBuffIR",game.fightBossBuffIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("fight/fights")},n=o,e.fightsUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fight||(t.fight={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("Text",laya.display.Text),i.prototype.createChildren.call(this),this.loadUI("fight/FightTishi")},n=o,e.FightTishiUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fight||(t.fight={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("fight/GloryFightResult")},n=o,e.GloryFightResultUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fight||(t.fight={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.AutoLayoutList",common.AutoLayoutList),View.regComponent("game.FightItemBox",game.FightItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("fight/shengli")},n=o,e.shengliUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fight||(t.fight={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("fight/shengliQieCuo")},n=o,e.shengliQieCuoUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fight||(t.fight={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ChannelBox",common.ChannelBox),i.prototype.createChildren.call(this),this.loadUI("fight/shibai")},n=o,e.shibaiUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.firstguide||(t.firstguide={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("firstguide/FirstGuide")},n=o,e.FirstGuideUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fogforest||(t.fogforest={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("fogforest/Award")},n=o,e.AwardUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fogforest||(t.fogforest={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.ForestGuanqiaBox",game.ForestGuanqiaBox),View.regComponent("game.forestAwardView",game.forestAwardView),View.regComponent("game.forestRankIR",game.forestRankIR),i.prototype.createChildren.call(this),this.loadUI("fogforest/FogForest")},n=o,e.FogForestUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fogforest||(t.fogforest={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("fogforest/GuanqiaBox")},n=o,e.GuanqiaBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fogforest||(t.fogforest={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("fogforest/RankIR")},n=o,e.RankIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fogforest||(t.fogforest={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("fogforest/RewardIR")},n=o,e.RewardIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.fogforest||(t.fogforest={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.ForestRewardIR",game.ForestRewardIR),i.prototype.createChildren.call(this),this.loadUI("fogforest/RewardView")},n=o,e.RewardViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.friend||(t.friend={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.AddFriendIR",game.AddFriendIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("friend/AddFriend")},n=o,e.AddFriendUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.friend||(t.friend={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("friend/AddFriendIR")},n=o,e.AddFriendIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.friend||(t.friend={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.ApplyFriendIR",game.ApplyFriendIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("friend/Applyfriend")},n=o,e.ApplyfriendUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.friend||(t.friend={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("friend/ApplyfriendIR")},n=o,e.ApplyfriendIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.friend||(t.friend={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("friend/FriendIR")},n=o,e.FriendIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.friend||(t.friend={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.FriendIR",game.FriendIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("friend/FriendList")},n=o,e.FriendListUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.friend||(t.friend={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.FriendsView",game.FriendsView),View.regComponent("game.AddView",game.AddView),View.regComponent("game.ApplyView",game.ApplyView),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("friend/FriendMain")},n=o,e.FriendMainUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.glory||(t.glory={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.gloryFightPlayerIR",game.gloryFightPlayerIR),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("glory/FightList")},n=o,e.FightListUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.glory||(t.glory={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.gloryAwardIR",game.gloryAwardIR),i.prototype.createChildren.call(this),this.loadUI("glory/GloryAward")},n=o,e.GloryAwardUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.glory||(t.glory={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.gloryFightListView",game.gloryFightListView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("glory/GloryFight")},n=o,e.GloryFightUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.glory||(t.glory={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle2View",common.CommonTitle2View),View.regComponent("game.gloryMatchPlayerIR",game.gloryMatchPlayerIR),i.prototype.createChildren.call(this),this.loadUI("glory/GloryGroup")},n=o,e.GloryGroupUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.glory||(t.glory={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("glory/GloryWait")},n=o,e.GloryWaitUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.glory||(t.glory={}),i=e.iRender||(e.iRender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("glory/iRender/AwardIR")},o=a,i.AwardIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.glory||(t.glory={}),i=e.iRender||(e.iRender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("glory/iRender/FightPlayerIR")},o=a,i.FightPlayerIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.glory||(t.glory={}),i=e.iRender||(e.iRender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("glory/iRender/MatchPlayerIR")},o=a,i.MatchPlayerIRUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.glory||(t.glory={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.gloryFightListView",game.gloryFightListView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("glory/LastReview")},n=o,e.LastReviewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.glory||(t.glory={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle2View",common.CommonTitle2View),View.regComponent("game.gloryMatchPlayerIR",game.gloryMatchPlayerIR),i.prototype.createChildren.call(this),this.loadUI("glory/Record")},n=o,e.RecordUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.godBuzhenIR",game.godBuzhenIR),View.regComponent("common.HeadNameBox",common.HeadNameBox),View.regComponent("game.BuzhenGodIR",game.BuzhenGodIR),View.regComponent("common.RaceBox",common.RaceBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.GuanghuanView",game.GuanghuanView),i.prototype.createChildren.call(this),this.loadUI("god/Buzhen")},n=o,e.BuzhenUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.ChooseGodIR",game.ChooseGodIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("god/ChooseGod")},n=o,e.ChooseGodUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.HeadNameBox",common.HeadNameBox),View.regComponent("game.GuanghuanView",game.GuanghuanView),i.prototype.createChildren.call(this),this.loadUI("god/CommonLineupView")},n=o,e.CommonLineupViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),i.prototype.createChildren.call(this),this.loadUI("god/GodAttr")},n=o,e.GodAttrUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.GodIntroduceView",game.GodIntroduceView),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("god/GodCulture")},n=o,e.GodCultureUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.GodTreasureView",game.GodTreasureView),View.regComponent("ui.god.render.AttrIRUI",t.god.render.AttrIRUI),View.regComponent("common.ListBase",common.ListBase),View.regComponent("ui.god.render.TabItemRenderUI",t.god.render.TabItemRenderUI),i.prototype.createChildren.call(this),this.loadUI("god/GodIntroduce")},n=o,e.GodIntroduceUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("god/GodLiHui")},n=o,e.GodLiHuiUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GodSkinIR",game.GodSkinIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox2",common.ItemBox2),i.prototype.createChildren.call(this),this.loadUI("god/GodSkin")},n=o,e.GodSkinUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.HeadBox",common.HeadBox),View.regComponent("common.SkillBox",common.SkillBox),i.prototype.createChildren.call(this),this.loadUI("god/Guaiwuxinxi")},n=o,e.GuaiwuxinxiUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("god/Guanghuan")},n=o,e.GuanghuanUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.GodIntroduceView",game.GodIntroduceView),View.regComponent("game.LineupGodIR",game.LineupGodIR),i.prototype.createChildren.call(this),this.loadUI("god/NewGodMain")},n=o,e.NewGodMainUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("god/render/AttrBox")},o=a,i.AttrBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("god/render/AttrIR")},o=a,i.AttrIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.HeadBox",common.HeadBox),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("god/render/ChooseBox")},o=a,i.ChooseBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("god/render/GetItemBox")},o=a,i.GetItemBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("god/render/GodMaterialIR")},o=a,i.GodMaterialIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("god/render/GodSkinIR")},o=a,i.GodSkinIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("god/render/HaveItemBox")},o=a,i.HaveItemBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.GodRaceAddIR",common.GodRaceAddIR),n.prototype.createChildren.call(this),this.loadUI("god/render/KeZhiForceBox")},o=a,i.KeZhiForceBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.HeadBox",common.HeadBox),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("god/render/LineupGodIR")},o=a,i.LineupGodIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.HeadBox",common.HeadBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("god/render/ReplaceIR")},o=a,i.ReplaceIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("god/render/RonghunBox")},o=a,i.RonghunBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.GodSkillItemIR",game.GodSkillItemIR),n.prototype.createChildren.call(this),this.loadUI("god/render/SkillInfoBox")},o=a,i.SkillInfoBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("god/render/SkillItemIR")},o=a,i.SkillItemIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("god/render/TabItemRender")},o=a,i.TabItemRenderUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle2View",common.CommonTitle2View),View.regComponent("game.godReplaceIR",game.godReplaceIR),View.regComponent("common.RaceBox",common.RaceBox),i.prototype.createChildren.call(this),this.loadUI("god/ReplaceGod")},n=o,e.ReplaceGodUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),i.prototype.createChildren.call(this),this.loadUI("god/RonghunLvInfo")},n=o,e.RonghunLvInfoUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("god/Shengjie")},n=o,e.ShengjieUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.tab||(e.tab={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("game.GodSkillItemIR",game.GodSkillItemIR),View.regComponent("game.SkillInfoBox",game.SkillInfoBox),n.prototype.createChildren.call(this),this.loadUI("god/tab/TabInfo")},o=a,i.TabInfoUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.tab||(e.tab={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("game.GodMaterialIR",game.GodMaterialIR),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("god/tab/TabJuexing")},o=a,i.TabJuexingUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.tab||(e.tab={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.godFuseUseIR",game.godFuseUseIR),View.regComponent("game.godFuseIR",game.godFuseIR),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("god/tab/TabRonghun")},o=a,i.TabRonghunUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.tab||(e.tab={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("game.GodMaterialIR",game.GodMaterialIR),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("god/tab/TabStarup")},o=a,i.TabStarupUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.ChooseTreasureIR",game.ChooseTreasureIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("god/treasure/ChooseMaterial")},o=a,i.ChooseMaterialUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.ChooseTreasureIR",game.ChooseTreasureIR),n.prototype.createChildren.call(this),this.loadUI("god/treasure/ChooseTreasure")},o=a,i.ChooseTreasureUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("god/treasure/GodTreasure")},o=a,i.GodTreasureUI=o}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),o.prototype.createChildren.call(this),this.loadUI("god/treasure/render/ChooseTreasureIR")},a=r,n.ChooseTreasureIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),o.prototype.createChildren.call(this),this.loadUI("god/treasure/render/SingleSelectTreasureIR")},a=r,n.SingleSelectTreasureIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("game.StrengthAttrIR",game.StrengthAttrIR),o.prototype.createChildren.call(this),this.loadUI("god/treasure/render/StarAttrPreviewIR")},a=r,n.StarAttrPreviewIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){o.prototype.createChildren.call(this),this.loadUI("god/treasure/render/StarupAttrIr")},a=r,n.StarupAttrIrUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){o.prototype.createChildren.call(this),this.loadUI("god/treasure/render/StrengthAttrIR")},a=r,n.StrengthAttrIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),o.prototype.createChildren.call(this),this.loadUI("god/treasure/render/TreasureMaterialIR")},a=r,n.TreasureMaterialIRUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),n=i.render||(i.render={}),__extends(r,o=DialogExt),r.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),o.prototype.createChildren.call(this),this.loadUI("god/treasure/render/TujianIR")},a=r,n.TujianIRUI=a}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("god/treasure/StarAttrPreview")},o=a,i.StarAttrPreviewUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("game.SingleSelectTreasureIR",game.SingleSelectTreasureIR),View.regComponent("common.CostIR",common.CostIR),View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("god/treasure/TreasureRebirth")},o=a,i.TreasureRebirthUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("game.TreasureMaterialIR",game.TreasureMaterialIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.StarupAttrIR",game.StarupAttrIR),n.prototype.createChildren.call(this),this.loadUI("god/treasure/TreasureStarup")},o=a,i.TreasureStarupUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.StrengthAttrIR",game.StrengthAttrIR),View.regComponent("game.ChooseTreasureIR",game.ChooseTreasureIR),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("god/treasure/TreasureStrength")},o=a,i.TreasureStrengthUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.god||(t.god={}),i=e.treasure||(e.treasure={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("game.TreasueTujianIR",game.TreasueTujianIR),n.prototype.createChildren.call(this),this.loadUI("god/treasure/TreasureTujian")},o=a,i.TreasureTujianUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitleView",common.CommonTitleView),i.prototype.createChildren.call(this),this.loadUI("god/Tupo")},n=o,e.TupoUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitleView",common.CommonTitleView),View.regComponent("game.GodSkillItemIR",game.GodSkillItemIR),i.prototype.createChildren.call(this),this.loadUI("god/Uplevelsucc")},n=o,e.UplevelsuccUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.god||(t.god={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),i.prototype.createChildren.call(this),this.loadUI("god/ZhenYingKeZhi")},n=o,e.ZhenYingKeZhiUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("goddomain/AutoMatch")},n=o,e.AutoMatchUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("goddomain/BattleResult")},n=o,e.BattleResultUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),View.regComponent("common.ChannelBox",common.ChannelBox),i.prototype.createChildren.call(this),this.loadUI("goddomain/BattleSettlement")},n=o,e.BattleSettlementUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),View.regComponent("game.GodDmDuizhanIR",game.GodDmDuizhanIR),i.prototype.createChildren.call(this),this.loadUI("goddomain/fightStart")},n=o,e.fightStartUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("goddomain/GodDomain")},n=o,e.GodDomainUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("goddomain/InviteJoin")},n=o,e.InviteJoinUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GodDmInviteIR",game.GodDmInviteIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("goddomain/InviteList")},n=o,e.InviteListUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("goddomain/MemberMenu")},n=o,e.MemberMenuUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.RankIR",common.RankIR),View.regComponent("common.AwardRankIR",common.AwardRankIR),i.prototype.createChildren.call(this),this.loadUI("goddomain/RankView")},n=o,e.RankViewUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.goddomain||(t.goddomain={}),i=e.render||(e.render={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("goddomain/render/DuizhanIR")},o=a,i.DuizhanIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.goddomain||(t.goddomain={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("goddomain/render/InviteIR")},o=a,i.InviteIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.goddomain||(t.goddomain={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("HTMLDivElement",laya.html.dom.HTMLDivElement),n.prototype.createChildren.call(this),this.loadUI("goddomain/render/MemberIR")},o=a,i.MemberIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.goddomain||(t.goddomain={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("goddomain/render/TeamIR")},o=a,i.TeamIRUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.MemberMenuView",game.MemberMenuView),View.regComponent("game.GodDmMemberIR",game.GodDmMemberIR),i.prototype.createChildren.call(this),this.loadUI("goddomain/Team")},n=o,e.TeamUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GodDmTeamIR",game.GodDmTeamIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("goddomain/TeamList")},n=o,e.TeamListUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddomain||(t.goddomain={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("goddomain/TeamMatch")},n=o,e.TeamMatchUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddoor||(t.goddoor={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GodDoorTabDoor",game.GodDoorTabDoor),View.regComponent("game.GodDoorTabTurn",game.GodDoorTabTurn),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.TabIR3",common.TabIR3),i.prototype.createChildren.call(this),this.loadUI("goddoor/CurMain")},n=o,e.CurMainUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.goddoor||(t.goddoor={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),i.prototype.createChildren.call(this),this.loadUI("goddoor/Jiangli")},n=o,e.JiangliUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.goddoor||(t.goddoor={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("goddoor/render/JiangliIR")},o=a,i.JiangliIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.goddoor||(t.goddoor={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("goddoor/render/TabDoor")},o=a,i.TabDoorUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.goddoor||(t.goddoor={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.StarList",common.StarList),View.regComponent("game.godChooseIR",game.godChooseIR),View.regComponent("common.RaceBox",common.RaceBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("goddoor/render/TabTurn")},o=a,i.TabTurnUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("guaji/FastFight")},n=o,e.FastFightUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("game.RedPointPropCopy",game.RedPointPropCopy),View.regComponent("game.UpRoadEntrance",game.UpRoadEntrance),View.regComponent("game.GuajiBottomView",game.GuajiBottomView),i.prototype.createChildren.call(this),this.loadUI("guaji/Guaji")},n=o,e.GuajiUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("guaji/GuajiBottom")},n=o,e.GuajiBottomUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.EffItemBox",common.EffItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("guaji/GuaJiReward")},n=o,e.GuaJiRewardUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.HeadBox",common.HeadBox),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("guaji/GuanQiaInfo")},n=o,e.GuanQiaInfoUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.GuanQiaNewIR",game.GuanQiaNewIR),i.prototype.createChildren.call(this),this.loadUI("guaji/GuanQiaNew")},n=o,e.GuanQiaNewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("guaji/GuanQiaNewIR")},n=o,e.GuanQiaNewIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("guaji/OpenChapterView")},n=o,e.OpenChapterViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitleView",common.CommonTitleView),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.DialogOpenEff",common.DialogOpenEff),i.prototype.createChildren.call(this),this.loadUI("guaji/Shouyi")},n=o,e.ShouyiUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),i.prototype.createChildren.call(this),this.loadUI("guaji/ShouyiUp")},n=o,e.ShouyiUpUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("guaji/ShouYiXiangQing")},n=o,e.ShouYiXiangQingUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("guaji/SysOpen")},n=o,e.SysOpenUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guaji||(t.guaji={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("guaji/WorldMap")},n=o,e.WorldMapUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guide||(t.guide={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("guide/GuideMask")},n=o,e.GuideMaskUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guide||(t.guide={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("guide/GuideTalk")},n=o,e.GuideTalkUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GuildRankItemRender",game.GuildRankItemRender),n.prototype.createChildren.call(this),this.loadUI("guild/copy/atkEndRank")},o=a,i.atkEndRankUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GuildRankItemRender",game.GuildRankItemRender),n.prototype.createChildren.call(this),this.loadUI("guild/copy/DamageRank")},o=a,i.DamageRankUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GuildGuanqiaItemRender",game.GuildGuanqiaItemRender),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/copy/GuildCopy")},o=a,i.GuildCopyUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonFightTitleView",common.CommonFightTitleView),View.regComponent("common.AutoLayoutList",common.AutoLayoutList),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/copy/GuildCopySweepResult")},o=a,i.GuildCopySweepResultUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("guild/copy/GuildGuanqia")},o=a,i.GuildGuanqiaUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("guild/copy/GuildRankItemRender")},o=a,i.GuildRankItemRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("game.JishaJiangliItemRender",game.JishaJiangliItemRender),n.prototype.createChildren.call(this),this.loadUI("guild/copy/JishaJiangli")},o=a,i.JishaJiangliUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("guild/copy/JishaJiangliItemRender")},o=a,i.JishaJiangliItemRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.TongguanJiangliItemRender",game.TongguanJiangliItemRender),View.regComponent("game.JishaJiangliView",game.JishaJiangliView),n.prototype.createChildren.call(this),this.loadUI("guild/copy/TongguanJiangli")},o=a,i.TongguanJiangliUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.copy||(e.copy={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),n.prototype.createChildren.call(this),this.loadUI("guild/copy/TongguanJiangliItemRender")},o=a,i.TongguanJiangliItemRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.donation||(e.donation={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("ui.guild.donation.GuildDonationItemRenderUI",t.guild.donation.GuildDonationItemRenderUI),n.prototype.createChildren.call(this),this.loadUI("guild/donation/GuildDonation")},o=a,i.GuildDonationUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.donation||(e.donation={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/donation/GuildDonationItemRender")},o=a,i.GuildDonationItemRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.ChestItemRender",game.ChestItemRender),n.prototype.createChildren.call(this),this.loadUI("guild/fight/GradeChest")},o=a,i.GradeChestUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GuildRankIRender",game.GuildRankIRender),n.prototype.createChildren.call(this),this.loadUI("guild/fight/GroupRank")},o=a,i.GroupRankUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.MemberItemRender",game.MemberItemRender),View.regComponent("game.FightMenuPanel",game.FightMenuPanel),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("guild/fight/GuildFight")},o=a,i.GuildFightUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("guild/fight/GuildFightMenu")},o=a,i.GuildFightMenuUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.FightMenuPanel",game.FightMenuPanel),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/fight/GuildFightWait")},o=a,i.GuildFightWaitUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.HonorGuildIRender",game.HonorGuildIRender),n.prototype.createChildren.call(this),this.loadUI("guild/fight/HonorHall")},o=a,i.HonorHallUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.AwardRankIR",common.AwardRankIR),View.regComponent("game.PersonRankIRender",game.PersonRankIRender),n.prototype.createChildren.call(this),this.loadUI("guild/fight/PersonRank")},o=a,i.PersonRankUI=o}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),o.prototype.createChildren.call(this),this.loadUI("guild/fight/render/ChestItemRender")},a=r,n.ChestItemRenderUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.HeadBox",common.HeadBox),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),o.prototype.createChildren.call(this),this.loadUI("guild/fight/render/GuildFightRender")},a=r,n.GuildFightRenderUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),o.prototype.createChildren.call(this),this.loadUI("guild/fight/render/GuildRongyuRender")},a=r,n.GuildRongyuRenderUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.CommonRankIR",common.CommonRankIR),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),o.prototype.createChildren.call(this),this.loadUI("guild/fight/render/GuildSaiQuRender")},a=r,n.GuildSaiQuRenderUI=a}(ui=ui||{}),function(t){var e,i,n,o,a;function r(){return o.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),n=i.render||(i.render={}),__extends(r,o=View),r.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),o.prototype.createChildren.call(this),this.loadUI("guild/fight/render/SeasonAwardIRender")},a=r,n.SeasonAwardIRenderUI=a}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.fight||(e.fight={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.AwardIRender",game.AwardIRender),View.regComponent("game.GuildRankIRender",game.GuildRankIRender),n.prototype.createChildren.call(this),this.loadUI("guild/fight/SeasonAward")},o=a,i.SeasonAwardUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.guild||(t.guild={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("guild/GuildMain")},n=o,e.GuildMainUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.hall||(e.hall={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GuildApplyRender",game.GuildApplyRender),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/hall/GuildApplyList")},o=a,i.GuildApplyListUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.hall||(e.hall={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/hall/GuildApplyRender")},o=a,i.GuildApplyRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.hall||(e.hall={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.MemberInfoRender",game.MemberInfoRender),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("guild/hall/GuildInfo")},o=a,i.GuildInfoUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.hall||(e.hall={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/hall/GuildNotice")},o=a,i.GuildNoticeUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.hall||(e.hall={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/hall/GuildPopUp")},o=a,i.GuildPopUpUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.hall||(e.hall={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/hall/GuildSetUp")},o=a,i.GuildSetUpUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.hall||(e.hall={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("guild/hall/MemberInfoRender")},o=a,i.MemberInfoRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.hall||(e.hall={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/hall/MemberSetup")},o=a,i.MemberSetupUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.hall||(e.hall={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),View.regComponent("common.CommonLineupView",common.CommonLineupView),n.prototype.createChildren.call(this),this.loadUI("guild/hall/Memberzhenrou")},o=a,i.MemberzhenrouUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.help||(e.help={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.ListBase",common.ListBase),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/help/AskHelpView")},o=a,i.AskHelpViewUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.help||(e.help={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("ui.guild.help.MyHelpViewUI",t.guild.help.MyHelpViewUI),View.regComponent("ui.guild.help.OhtersHelpViewUI",t.guild.help.OhtersHelpViewUI),View.regComponent("common.TabBase",common.TabBase),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("guild/help/HelpMainView")},o=a,i.HelpMainViewUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.help||(e.help={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/help/MyHelpIR")},o=a,i.MyHelpIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.help||(e.help={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.GuildMyHelpIR",game.GuildMyHelpIR),n.prototype.createChildren.call(this),this.loadUI("guild/help/MyHelpView")},o=a,i.MyHelpViewUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.help||(e.help={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.GuildOthersHelpIR",game.GuildOthersHelpIR),n.prototype.createChildren.call(this),this.loadUI("guild/help/OhtersHelpView")},o=a,i.OhtersHelpViewUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.help||(e.help={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("guild/help/OthersHelpIR")},o=a,i.OthersHelpIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.init||(e.init={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/init/CreateGuild")},o=a,i.CreateGuildUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.init||(e.init={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GuildinitRender",game.GuildinitRender),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/init/Guildinit")},o=a,i.GuildinitUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.init||(e.init={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("guild/init/GuildinitRender")},o=a,i.GuildinitRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.init||(e.init={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.IconRender",game.IconRender),n.prototype.createChildren.call(this),this.loadUI("guild/init/IconChange")},o=a,i.IconChangeUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.init||(e.init={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("guild/init/IconRender")},o=a,i.IconRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.skill||(e.skill={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.GuildSkillRender",game.GuildSkillRender),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("guild/skill/GuildSkill")},o=a,i.GuildSkillUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.guild||(t.guild={}),i=e.skill||(e.skill={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("guild/skill/GuildSkillRender")},o=a,i.GuildSkillRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.entrance||(e.entrance={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.EntranceIR",game.EntranceIR),n.prototype.createChildren.call(this),this.loadUI("hud/entrance/EntranceList")},o=a,i.EntranceListUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.entrance||(e.entrance={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("hud/entrance/EntranceListIR")},o=a,i.EntranceListIRUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.hud||(t.hud={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("hud/HudBox")},n=o,e.HudBoxUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.hud||(t.hud={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("ui.hud.ShousuoBtnUI",t.hud.ShousuoBtnUI),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("HTMLDivElement",laya.html.dom.HTMLDivElement),View.regComponent("game.RedPointPropCopy",game.RedPointPropCopy),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("hud/MainView")},n=o,e.MainViewUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.player||(e.player={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),n.prototype.createChildren.call(this),this.loadUI("hud/player/ChangeName")},o=a,i.ChangeNameUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.player||(e.player={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),n.prototype.createChildren.call(this),this.loadUI("hud/player/HeroicModelMain")},o=a,i.HeroicModelMainUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.player||(e.player={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("hud/player/PlayerDetails")},o=a,i.PlayerDetailsUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.player||(e.player={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("ui.guild.init.IconRenderUI",t.guild.init.IconRenderUI),n.prototype.createChildren.call(this),this.loadUI("hud/player/TabChangeHead")},o=a,i.TabChangeHeadUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.player||(e.player={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("hud/player/TabChangeHeadBox")},o=a,i.TabChangeHeadBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.player||(e.player={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("hud/player/TabChangeHeroicModel")},o=a,i.TabChangeHeroicModelUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.player||(e.player={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("hud/player/TabCustomerService")},o=a,i.TabCustomerServiceUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.player||(e.player={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("hud/player/TabPlayerInfo")},o=a,i.TabPlayerInfoUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.player||(e.player={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("hud/player/TabSysSetting")},o=a,i.TabSysSettingUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("hud/render/ActivityBtnIR")},o=a,i.ActivityBtnIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("hud/render/LoginNoticeIR")},o=a,i.LoginNoticeIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("hud/render/SysTopBtnIR")},o=a,i.SysTopBtnIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("hud/render/SysTopResIR")},o=a,i.SysTopResIRUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.hud||(t.hud={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("hud/ShousuoBtn")},n=o,e.ShousuoBtnUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.view||(e.view={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),n.prototype.createChildren.call(this),this.loadUI("hud/view/Cheat")},o=a,i.CheatUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.view||(e.view={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("hud/view/ExchangeGold")},o=a,i.ExchangeGoldUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.view||(e.view={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("hud/view/LoginNotice")},o=a,i.LoginNoticeUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.view||(e.view={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("game.SysTopBtnIR",game.SysTopBtnIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.scaleButton",common.scaleButton),n.prototype.createChildren.call(this),this.loadUI("hud/view/SysTop")},o=a,i.SysTopUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.hud||(t.hud={}),i=e.view||(e.view={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("hud/view/VipLvUp")},o=a,i.VipLvUpUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.island||(t.island={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("island/EmptyOre")},n=o,e.EmptyOreUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.island||(t.island={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("ui.island.itemrender.OccupyFlagIRUI",t.island.itemrender.OccupyFlagIRUI),i.prototype.createChildren.call(this),this.loadUI("island/IslandMain")},n=o,e.IslandMainUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.island||(t.island={}),i=e.itemrender||(e.itemrender={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("island/itemrender/OccupyFlagIR")},o=a,i.OccupyFlagIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.island||(t.island={}),i=e.itemrender||(e.itemrender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("ui.island.itemrender.OccupyFlagIRUI",t.island.itemrender.OccupyFlagIRUI),n.prototype.createChildren.call(this),this.loadUI("island/itemrender/OreSpotItemRender")},o=a,i.OreSpotItemRenderUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.island||(t.island={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("island/OreExplain")},n=o,e.OreExplainUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.island||(t.island={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.OreSpotIR",game.OreSpotIR),i.prototype.createChildren.call(this),this.loadUI("island/OreMap")},n=o,e.OreMapUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.island||(t.island={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("island/OreSettlement")},n=o,e.OreSettlementUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.island||(t.island={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.CommonLineupView",common.CommonLineupView),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("island/PlayerOre")},n=o,e.PlayerOreUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.island||(t.island={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("island/SelfOre")},n=o,e.SelfOreUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.login||(t.login={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("login/CreateRole")},n=o,e.CreateRoleUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.login||(t.login={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("login/Login")},n=o,e.LoginUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.login||(t.login={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("login/SelectServer")},n=o,e.SelectServerUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.login||(t.login={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),i.prototype.createChildren.call(this),this.loadUI("login/UserNotice")},n=o,e.UserNoticeUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.login||(t.login={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("login/Wait")},n=o,e.WaitUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.mail||(t.mail={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("mail/MailIR")},n=o,e.MailIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.mail||(t.mail={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("mail/MailRead")},n=o,e.MailReadUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.mail||(t.mail={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.MailIR",game.MailIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("mail/MailView")},n=o,e.MailViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.prompt||(t.prompt={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("ui.prompt.StarUpRenderUI",t.prompt.StarUpRenderUI),View.regComponent("common.SkillBox",common.SkillBox),i.prototype.createChildren.call(this),this.loadUI("prompt/RoleEff")},n=o,e.RoleEffUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.prompt||(t.prompt={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("prompt/StarUpRender")},n=o,e.StarUpRenderUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.prompt||(t.prompt={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("prompt/upPower")},n=o,e.upPowerUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.rank||(t.rank={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.RankTabIR",game.RankTabIR),i.prototype.createChildren.call(this),this.loadUI("rank/RankTabView")},n=o,e.RankTabViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.rank||(t.rank={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.RankModuleIR",game.RankModuleIR),i.prototype.createChildren.call(this),this.loadUI("rank/RankView")},n=o,e.RankViewUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.rank||(t.rank={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.CommonRankIR",common.CommonRankIR),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("rank/render/RankIR")},o=a,i.RankIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.rank||(t.rank={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("rank/render/RankTabIR")},o=a,i.RankTabIRUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.shop||(t.shop={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("shop/Buy")},n=o,e.BuyUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.shop||(t.shop={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("game.ShopTabIR",game.ShopTabIR),View.regComponent("game.ShopThreeIR",game.ShopThreeIR),View.regComponent("common.RaceBox",common.RaceBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("shop/Shop")},n=o,e.ShopUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.shop||(t.shop={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("shop/ShopIR")},n=o,e.ShopIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.shop||(t.shop={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("shop/ShopRefresh")},n=o,e.ShopRefreshUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.shop||(t.shop={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("shop/ShopTabIR")},n=o,e.ShopTabIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.shop||(t.shop={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.ShopIR",game.ShopIR),i.prototype.createChildren.call(this),this.loadUI("shop/ShopThreeIR")},n=o,e.ShopThreeIRUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.bianqiang||(e.bianqiang={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.RedPointProp",game.RedPointProp),View.regComponent("game.BianQiangIR",game.BianQiangIR),View.regComponent("game.ChallengeTitleIR",game.ChallengeTitleIR),n.prototype.createChildren.call(this),this.loadUI("task/bianqiang/BianQiang")},o=a,i.BianQiangUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.bianqiang||(e.bianqiang={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("task/bianqiang/BianQiangIR")},o=a,i.BianQiangIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.bianqiang||(e.bianqiang={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.TaskIR",game.TaskIR),n.prototype.createChildren.call(this),this.loadUI("task/bianqiang/ChallengeDetail")},o=a,i.ChallengeDetailUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.bianqiang||(e.bianqiang={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SimpleItemBox",common.SimpleItemBox),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("task/bianqiang/ChallengeTitleIR")},o=a,i.ChallengeTitleIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.itemrender||(e.itemrender={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("task/itemrender/TaskBaoxiangIR")},o=a,i.TaskBaoxiangIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.itemrender||(e.itemrender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.SimpleItemBox",common.SimpleItemBox),n.prototype.createChildren.call(this),this.loadUI("task/itemrender/TaskIR")},o=a,i.TaskIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.itemrender||(e.itemrender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("task/itemrender/TrialIR")},o=a,i.TrialIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.itemrender||(e.itemrender={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("task/itemrender/WarriorIR")},o=a,i.WarriorIRUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.task||(t.task={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.TaskIR",game.TaskIR),i.prototype.createChildren.call(this),this.loadUI("task/TabAchievement")},n=o,e.TabAchievementUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.task||(t.task={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.TaskIR",game.TaskIR),i.prototype.createChildren.call(this),this.loadUI("task/TabDaily")},n=o,e.TabDailyUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.task||(t.task={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.TrialTaskIR",game.TrialTaskIR),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("task/TabTrial")},n=o,e.TabTrialUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.task||(t.task={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.WarriorIR",game.WarriorIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("task/TabWarrior")},n=o,e.TabWarriorUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.task||(t.task={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.ListBase",common.ListBase),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("task/Task")},n=o,e.TaskUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.warrior||(e.warrior={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox2",common.ItemBox2),n.prototype.createChildren.call(this),this.loadUI("task/warrior/WarriorBuyLevel")},o=a,i.WarriorBuyLevelUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.task||(t.task={}),i=e.warrior||(e.warrior={}),__extends(a,n=DialogExt),a.prototype.createChildren=function(){View.regComponent("common.CommonTitleView",common.CommonTitleView),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("task/warrior/WarriorJinjie")},o=a,i.WarriorJinjieUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("common.CommonLineupView",common.CommonLineupView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.ItemBox21",common.ItemBox21),i.prototype.createChildren.call(this),this.loadUI("teamcopy/BattleInfo")},n=o,e.BattleInfoUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.teamcopy||(t.teamcopy={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("teamcopy/render/RewardIR")},o=a,i.RewardIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.teamcopy||(t.teamcopy={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.HeadBox2",common.HeadBox2),n.prototype.createChildren.call(this),this.loadUI("teamcopy/render/TeamApplyRender")},o=a,i.TeamApplyRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.teamcopy||(t.teamcopy={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("teamcopy/render/TeamBuildRender")},o=a,i.TeamBuildRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.teamcopy||(t.teamcopy={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.HeadBox2",common.HeadBox2),n.prototype.createChildren.call(this),this.loadUI("teamcopy/render/TeamInfoRender")},o=a,i.TeamInfoRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.teamcopy||(t.teamcopy={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.TeamInviteChiRender",game.TeamInviteChiRender),n.prototype.createChildren.call(this),this.loadUI("teamcopy/render/TeamInvitationRender")},o=a,i.TeamInvitationRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.teamcopy||(t.teamcopy={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.CommonRankIR",common.CommonRankIR),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("teamcopy/render/TeamRankRender")},o=a,i.TeamRankRenderUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.teamcopy||(t.teamcopy={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),n.prototype.createChildren.call(this),this.loadUI("teamcopy/render/TeamTransferRender")},o=a,i.TeamTransferRenderUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("game.TeamBuildRender",game.TeamBuildRender),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("teamcopy/TeamBuild")},n=o,e.TeamBuildUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("game.TeamApplyRender",game.TeamApplyRender),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("teamcopy/TeamCopyApply")},n=o,e.TeamCopyApplyUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("game.TeamInviteRender",game.TeamInviteRender),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("teamcopy/TeamCopyInvitation")},n=o,e.TeamCopyInvitationUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),i.prototype.createChildren.call(this),this.loadUI("teamcopy/TeamCopyMain")},n=o,e.TeamCopyMainUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.CopyTeamRankRender",game.CopyTeamRankRender),i.prototype.createChildren.call(this),this.loadUI("teamcopy/TeamCopyRank")},n=o,e.TeamCopyRankUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.CopyTeamRewardIR",game.CopyTeamRewardIR),i.prototype.createChildren.call(this),this.loadUI("teamcopy/TeamCopyReward")},n=o,e.TeamCopyRewardUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("teamcopy/teamCopyStart")},n=o,e.teamCopyStartUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("game.TeamInfoItemRender",game.TeamInfoItemRender),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("teamcopy/TeamInfo")},n=o,e.TeamInfoUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.teamcopy||(t.teamcopy={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("game.TeamTransferRender",game.TeamTransferRender),i.prototype.createChildren.call(this),this.loadUI("teamcopy/transferLeader")},n=o,e.transferLeaderUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tower||(t.tower={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("tower/GuanqiaIR")},n=o,e.GuanqiaIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tower||(t.tower={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.CommonLineupView",common.CommonLineupView),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("tower/GuanqiaView")},n=o,e.GuanqiaViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tower||(t.tower={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("tower/JiangliIR")},n=o,e.JiangliIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tower||(t.tower={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.TowerJiangliIR",game.TowerJiangliIR),i.prototype.createChildren.call(this),this.loadUI("tower/JiangliView")},n=o,e.JiangliViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tower||(t.tower={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.TowerRankIR",game.TowerRankIR),i.prototype.createChildren.call(this),this.loadUI("tower/Rank")},n=o,e.RankUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tower||(t.tower={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.CommonRankIR",common.CommonRankIR),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),i.prototype.createChildren.call(this),this.loadUI("tower/RankIR")},n=o,e.RankIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tower||(t.tower={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.TowerGuanqiaIR",game.TowerGuanqiaIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("tower/shiliantaView")},n=o,e.shiliantaViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),i.prototype.createChildren.call(this),this.loadUI("tujian/AttrView")},n=o,e.AttrViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.FateIR",game.FateIR),i.prototype.createChildren.call(this),this.loadUI("tujian/FateView")},n=o,e.FateViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("tujian/Pingjia")},n=o,e.PingjiaUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("tujian/PingjiaShuru")},n=o,e.PingjiaShuruUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.tujian||(t.tujian={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.HeadBox2",common.HeadBox2),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("tujian/render/FateIR")},o=a,i.FateIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.tujian||(t.tujian={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),n.prototype.createChildren.call(this),this.loadUI("tujian/render/pingjiaIR")},o=a,i.pingjiaIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.tujian||(t.tujian={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.HeadBox",common.HeadBox),n.prototype.createChildren.call(this),this.loadUI("tujian/render/TuijianIR")},o=a,i.TuijianIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.tujian||(t.tujian={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.GodStarInfo",common.GodStarInfo),n.prototype.createChildren.call(this),this.loadUI("tujian/render/TujianIR")},o=a,i.TujianIRUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.tujian||(t.tujian={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.loadUI("tujian/render/YeqianIR")},o=a,i.YeqianIRUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("game.FateIR",game.FateIR),i.prototype.createChildren.call(this),this.loadUI("tujian/TabFate")},n=o,e.TabFateUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.TujianHeadIR",game.TujianHeadIR),View.regComponent("game.YeqianIR",game.YeqianIR),i.prototype.createChildren.call(this),this.loadUI("tujian/TabTuijian")},n=o,e.TabTuijianUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.TujianIR",game.TujianIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.RaceBox",common.RaceBox),i.prototype.createChildren.call(this),this.loadUI("tujian/TabTujian")},n=o,e.TabTujianUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.TujianHeadIR",game.TujianHeadIR),View.regComponent("game.YeqianIR",game.YeqianIR),i.prototype.createChildren.call(this),this.loadUI("tujian/TuijianView")},n=o,e.TuijianViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.GodSkillItemIR",game.GodSkillItemIR),View.regComponent("common.GodStarInfo",common.GodStarInfo),View.regComponent("game.SkillInfoBox",game.SkillInfoBox),View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("tujian/TujianHero")},n=o,e.TujianHeroUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.tujian||(t.tujian={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle5View",common.CommonTitle5View),View.regComponent("game.TujianIR",game.TujianIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("common.RaceBox",common.RaceBox),View.regComponent("game.TuijianView",game.TuijianView),View.regComponent("game.FateView",game.FateView),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("tujian/TujianView")},n=o,e.TujianViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.uproad||(t.uproad={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("uproad/UpRoadEntrance")},n=o,e.UpRoadEntranceUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.uproad||(t.uproad={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitleView",common.CommonTitleView),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("uproad/UpRoadSuccesssView")},n=o,e.UpRoadSuccesssViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.uproad||(t.uproad={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("uproad/UpRoadTabIR")},n=o,e.UpRoadTabIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.uproad||(t.uproad={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("HTMLDivElement",laya.html.dom.HTMLDivElement),i.prototype.createChildren.call(this),this.loadUI("uproad/UpRoadTaskIR")},n=o,e.UpRoadTaskIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.uproad||(t.uproad={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.ItemBox",common.ItemBox),View.regComponent("game.UpRoadTabIR",game.UpRoadTabIR),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("game.UpRoadTaskIR",game.UpRoadTaskIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("uproad/UpRoadView")},n=o,e.UpRoadViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.yuanzheng||(t.yuanzheng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("yuanzheng/BaoxiangIR")},n=o,e.BaoxiangIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.yuanzheng||(t.yuanzheng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle4View",common.CommonTitle4View),View.regComponent("game.BuzhenGodIR",game.BuzhenGodIR),View.regComponent("common.UserHeadBox1",common.UserHeadBox1),View.regComponent("common.ItemBox2",common.ItemBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.GuanghuanView",game.GuanghuanView),i.prototype.createChildren.call(this),this.loadUI("yuanzheng/ChallengeInfoView")},n=o,e.ChallengeInfoViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.yuanzheng||(t.yuanzheng={}),__extends(o,i=View),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.loadUI("yuanzheng/GuanqiaIR")},n=o,e.GuanqiaIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.yuanzheng||(t.yuanzheng={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.HeadBox2",common.HeadBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("yuanzheng/HelpFriendIR")},n=o,e.HelpFriendIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.yuanzheng||(t.yuanzheng={}),__extends(o,i=View),o.prototype.createChildren=function(){View.regComponent("common.HeadBox2",common.HeadBox2),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("yuanzheng/HelpMeIR")},n=o,e.HelpMeIRUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.yuanzheng||(t.yuanzheng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.YZHelpFriendIR",game.YZHelpFriendIR),View.regComponent("game.YZHelpMeIR",game.YZHelpMeIR),View.regComponent("game.RedPointProp",game.RedPointProp),i.prototype.createChildren.call(this),this.loadUI("yuanzheng/HelpView")},n=o,e.HelpViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.yuanzheng||(t.yuanzheng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("game.BuzhenGodIR",game.BuzhenGodIR),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),i.prototype.createChildren.call(this),this.loadUI("yuanzheng/HuifuView")},n=o,e.HuifuViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.yuanzheng||(t.yuanzheng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("common.CommonTitle6View",common.CommonTitle6View),View.regComponent("common.ItemBox",common.ItemBox),i.prototype.createChildren.call(this),this.loadUI("yuanzheng/JiangliView")},n=o,e.JiangliViewUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.yuanzheng||(t.yuanzheng={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.YZGuanqiaIR",game.YZGuanqiaIR),View.regComponent("game.YZBaoxiangIR",game.YZBaoxiangIR),i.prototype.createChildren.call(this),this.loadUI("yuanzheng/YuanzhengView")},n=o,e.YuanzhengViewUI=n}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.zhaohuan||(t.zhaohuan={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("game.TujianIR",game.TujianIR),n.prototype.createChildren.call(this),this.loadUI("zhaohuan/render/ZhaohuanBox")},o=a,i.ZhaohuanBoxUI=o}(ui=ui||{}),function(t){var e,i,n,o;function a(){return n.call(this)||this}e=t.zhaohuan||(t.zhaohuan={}),i=e.render||(e.render={}),__extends(a,n=View),a.prototype.createChildren=function(){View.regComponent("common.scaleButton",common.scaleButton),View.regComponent("common.SoundEffectProp",common.SoundEffectProp),View.regComponent("game.RedPointProp",game.RedPointProp),n.prototype.createChildren.call(this),this.loadUI("zhaohuan/render/ZhaohuanIR")},o=a,i.ZhaohuanIRUI=o}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.zhaohuan||(t.zhaohuan={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.ZhaohuanBoxIR",game.ZhaohuanBoxIR),i.prototype.createChildren.call(this),this.loadUI("zhaohuan/Result")},n=o,e.ResultUI=n}(ui=ui||{}),function(t){var e,i,n;function o(){return i.call(this)||this}e=t.zhaohuan||(t.zhaohuan={}),__extends(o,i=DialogExt),o.prototype.createChildren=function(){View.regComponent("game.ZhaohuanIR",game.ZhaohuanIR),i.prototype.createChildren.call(this),this.loadUI("zhaohuan/Zhaohuan")},n=o,e.ZhaohuanUI=n}(ui=ui||{});var Lans,LanMgr=function(){function h(){}return h.getLan=function(t,e){void 0===e&&(e=-1);for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=h.lans[e]||t;if(0<i.length&&e!=Lans.cost&&(o=FormatStr(o,i)),e==Lans.daimond||10037==e||10073==e||10130==e||10156==e)dispatchEvt(new game.TopUpEvent(game.TopUpEvent.SHOW_CHONGZHI_PANEL));else if(10082==e)dispatchEvt(new game.TopUpEvent(game.TopUpEvent.SHOW_CHONGZHI_PANEL),!0);else if(e==Lans.glod)UIMgr.showUI(UIConst.ExchangeGoldView);else if(e==Lans.cost){o=FormatStr(o,[(a=tb.TB_item.get_TB_itemById(i[0]))?a.name:"资源"]),i[0]==iface.tb_prop.resTypeKey.gold?UIMgr.showUI(UIConst.ExchangeGoldView):UIUtil.showJumpPanle(a?a.ID:null)}else if(e==Lans.awakenCost){var a=tb.TB_item.get_TB_itemById(i[0]);UIUtil.showJumpPanle(a?a.ID:null)}return o},h.getLanArr=function(t,e){void 0===e&&(e=[]);for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];for(var o=h.lansArr[t]||e,a=0,r=o;a<r.length;a++)for(var s=r[a],u=0;u<s.length;u++)s[u]=FormatStr(s[u],i);return o},h.getMsgById=function(t){var e=tb.TB_msgCode.get_TB_msgCodeById(t);return e?e.text:"TB_msgCode不存在id:"+t},h.getMsgByCode=function(t){var e=tb.TB_msgCode.get_TB_msgCodeByCode(t);return e?e.text:t},h.lans={1e4:"该邮件已过期",10001:"当前无可删除的邮件",10002:"当前无可领取的邮件",10003:"今日获得的友情点已达上限，请明天再领取",10004:"今日刷新次数已达上限",10005:"钻石不足",10006:"快速战斗",10007:"剩余次数:{0}/{1}",10008:"暂无出战英雄，请前往布阵",10009:"手动",10010:"自动",10011:"今日快速战斗次数已用完",10012:"发送内容不能为空",10013:"还需{0}秒后才可发言",10014:"关卡未解锁",10015:"该难度未解锁",10016:"请先通关第{0}章",10017:"暂无英雄，请前往抽卡",10018:"该关卡已通关，重置后方可重复挑战",10019:"层级信息 :",10020:"怪物信息 :",10021:"挑 战",10022:"体力不足",10023:"数量不等的钻石",10024:"重置倒计时:",10025:"天",10026:"小时",10027:"分钟",10028:"我的排名:未上榜",10029:"我的排名:第{0}名",10030:"第{0}关",10031:"级",10032:"请先领取前一关卡的boss奖励",10033:"已领取奖励",10034:"该关卡没有奖励",10035:"{0}级开启",10036:"已购买",10037:"货币不足",10038:"确 定",10039:"取 消",10040:"系 统",10041:"领 取",10042:"前 往",10043:"已领取",10044:"(进度:{0}/{1})",10045:"未完成",10046:"赶快去领取通关奖励",10047:"别急，箱子还没装满",10048:"没有出战英雄",10049:"占领奖励:{0}",10050:"占领玩家:{0}",10051:"暂无",10052:"占领收益:{0}",10053:"可领取收益:{0}",10054:"撤退将会产生{0}分钟抢占冷却时间，确定撤退吗？",10055:"占领信息已更新，请重新选择。",10056:"你已占领传说宝藏，不能同时占领其他宝藏",10057:"只能占领更高级的宝藏",10058:"该领地在抢占中，请稍后",10059:"你的抢占还在冷却中,还需要{0}分钟",10060:"该领地已被抢占",10061:"该领地无人占领，且该玩家增加{0}分钟抢占冷却时间",10062:"不能抢占自己",10063:"公会:无",10064:"宝藏守护者",10065:"{0}分钟后发放奖励",10066:"占 领",10067:"抢 占",10068:"长度最多为6个汉字或12个字母数字!",10069:"不能包含特殊符号!",10070:"暂无记录!",10071:"请加入公会，才能使用公会聊天!",10072:"金币不足",10073:"钻石不足",10074:"公会贡献不足",10075:"每周{0}次",10076:"每日{0}次",10077:"请先通关当前关卡",10078:"该怪物已被击杀",10079:"第{0}章",10080:"我的伤害:{0}",10081:"剩余次数:{0}",10082:"购买次数不足，提高VIP等级可以增加购买次数",10083:"该关卡已经通关",10084:"挑战次数不足",10085:"请先通关前一难度",10086:"本次伤害:{0}",10087:"总 伤 害:{0}",10088:"伤害:{0}",10089:"剩余领取次数:{0}",10090:"未达到",10091:"无可领取次数",10092:"等级:{0}",10093:"开始挑战",10094:"查看排行",10095:"活动已过期",10096:"未到达领取条件，无法领取",10097:"无可兑换次数",10098:"购买",10099:"暂未开启，敬请期待！",10100:"请先通关普通难度",10101:"BOSS已死亡，{0}分钟后复活",10102:"普通{0}层",10103:"困难{0}层",10104:"等级不足",10105:"剩余次数不足",10106:"（剩余购买次数{0}次）",10107:"该关卡已挑战成功",10108:"请完成当前操作",10109:"请选择一个要转换的英雄",10110:"请选择要回复血量的英雄",10111:"请选择要复活的英雄",10112:"该英雄已死亡",10113:"只有30级以上英雄才可以上阵",10114:"没有挑战的玩家数据",10115:"回复血量成功",10116:"复活成功",10117:"神力:{0}",10118:"点击选择要回复血量的英雄:",10119:"点击选择要复活的英雄:",10120:"{0}不足！",10121:"剩余次数:{0}次",10122:"通关后解锁",10123:"vip{0}开启，或玩家等级{1}开启",10124:"剩余次数不足",10125:"暂无活动",10126:"达到购买上限",10127:"无可回复的英雄",10128:"无可复活的英雄",10129:"请输入你的名字",10130:"钻石不足，修改失败",10131:"名字太长，修改失败",10132:"名字存在敏感字符",10133:"该玩家已是你的好友",10134:"对方无阵容无法切磋",10135:"好友才能进行私聊",10136:"请输入要发送的信息",10137:"信息中包含非法字符",10138:"该玩家不是你的好友，不能进行聊天",10140:"删除聊天对象同时删除聊天记录？",10141:"私聊列表为空，点击好友头像可进行私聊",10142:"剩余次数:{0}次",10143:"未开启",10144:"{0}分后复活",10145:"{0}人抢夺",10146:"购买次数不足",10147:"无争夺人数",10148:"关卡",10149:"伤害",10150:"退出公会",10151:"解散公会",10152:"会长很懒，什么都没留下",10153:"级以上可自动加入",10154:"级以上可申请",10155:"申请列表为空",10156:"VIP等级不足，请前往充值",10157:"Lv.{0}",10158:"{0}级解锁",10159:"未达到公会限制等级",10160:"请输入公会名称！",10161:"护送次数:{0}",10162:"掠夺次数:{0}",10163:"护送次数不足",10164:"掠夺次数不足",10165:"该玩家已被掠夺{0}次",10166:"护送时间结束,不能掠夺",10167:"同一时间只能护送一次",10168:"自己商队不能掠夺",10169:"当前已经是最高品质",10170:"刷新品质中...",10171:"探 险",10172:"刷 新",10173:"免费刷新",10174:"不能连续掠夺同一个玩家2次",10175:"护送时间已结束",10176:"探险积分不足",10177:"探险未完成，不能领取奖励",10178:"有紫色以上品质未接取，确定要刷新吗",10179:"英雄已达上限",10180:"该英雄已在探险中",10181:"无满足条件英雄",10182:"派遣的英雄不符合条件",10183:"每只英雄只能同时在一只探险队伍",10184:"最大层数:{0}层",10185:"当前已是最高关卡",10186:"{0}后恢复一次",10187:"{0}分钟后恢复一次",10188:"剩余掠夺次数:{0}次",10189:"今日可占领次数:{0}次",10190:"{0}后刷新",10191:"产量:{0}",10192:"预计完成时间:{0}分钟",10193:"累积奖励:{0}",10194:"该矿点已采集完成",10195:"占领次数不足",10196:"删 除",10197:"该玩法只能自动战斗",10198:"本次战斗无法跳过",10199:"{0}回合之后才可跳过",10200:"神力达到{0}才可继续挑战",10201:"Vip可以增加扫荡次数",10202:"以上奖励通关邮件发放",10203:"你已在队伍中",10204:"没有上阵英雄，快去设置吧",10205:"友情点不足！",10206:"传说召唤需要VIP{0}解锁",10207:"请输入评价语!",10208:"不能挑战自己",10209:"请提升你的排名，才可以挑战该玩家",10210:"英雄不存在，不能添加",10211:"你在组队挑战中被踢出队伍",10212:"你在组队挑战中成为队长",10213:"请求超时",10214:"VIP{0}可以购买",10215:"已领取全部奖励",10216:"今日奖励已领取",10217:"微端下载成功，请前往微端体验！",10218:"不在活动时间",10219:"今日钻石已领取",10220:"每日奖励只能领取1次",10221:"请输入兑换码！",10222:"已达今日许愿上限，请明日再来!",10223:"限时热购已结束",10224:"活动已结束",10225:"今日可购买次数不足",10226:"英雄列表已满，是否前往分解英雄？",10227:"未达到可领取天数",10228:"该奖励已领取",10229:"暂未开启",10230:"未完成领取条件",10231:"取消了分享",10232:"分享失败{0}[{1}]",10233:"内测返利只能领取一次",10234:"兑换材料不足",10235:"购买后才可以领取",10236:"还未达到可领取天数",10237:"请选择其中一张卡片",10238:"最多锁定两个属性",10239:"锁定的属性不存在",10240:"洗练后才能更换属性",10241:"更换后神力将会降低，确定要更换吗？",10242:"该神器已满星",10243:"完成进阶之路可以解锁神器",10244:"解锁{0}把神器开启神器{1}",10245:"需要神器达到{0}级",10246:"未满足解锁条件",10247:"{0}后可领",10248:"数量不足，无法合成",10249:"请从奖励中选取一个",10250:"语音还没准备好！",10251:"{0}级才能发送同省聊天消息",10252:"{0}级才能发送跨服聊天消息",10253:"请加入队伍再发送组队信息",10254:"还有{0}秒才可以发送同省聊天消息",10255:"还有{0}秒才可以发送跨服聊天消息",10256:"你已加入其他公会",10257:"你成功加入公会{0}",10258:"申请成功，等待审核",10259:"加入公会后才能发送招募信息",10260:"今日次数已用完",10261:"你在组队挑战中，加入了{0}的队伍",10262:"没有符合条件的转移对象",10263:"没有更多了",10264:"请通关本章",10265:"数据不存在",10266:"队员{0}还未通过前置关卡",10267:"只有队长才能进行挑战",10268:"请通关前置关卡",10269:"你的最高关卡小于队伍的限制关卡",10270:"不能转移给最高关卡大于队长的玩家",10271:"确定要将队长转移给{0}吗",10272:"系统未开放",10273:"组队申请成功",10274:"请先创建队伍",10275:"队伍人数已满，无法邀请",10276:"{0} 拒绝你的组队邀请",10277:"每日只能派遣1只英雄",10278:"派遣成功",10279:"每日最多雇佣{0}个",10280:"雇佣成功",10281:"暂无奇遇事件",10282:"踩上滑板车，前进{0}格",10283:"衰神附体，后退{0}格",10284:"骰子不足，可通过挂机获得",10285:"未触发该问题事件",10286:"该奇遇已过期",10287:"资源不足",10288:"平局，请重新选择",10289:"强化等级已达上限",10290:"该装备未穿戴，不能强化",10291:"该英雄没有穿戴装备",10292:"精炼等级已达上限",10293:"该装备未穿戴，不能精炼",10294:"暂无可以镶嵌宝石",10295:"没有合成配置:{0}",10296:"数量不足,合成需要{0}个宝石",10297:"暂无可合成宝石",10298:"已是最高等级",10299:"最少合成一个",10300:"紫色以上才有套装属性",10301:"未穿戴装备",10302:"无满足条件可穿戴装备",10303:"穿戴6件装备才能激活{0}大师",10304:"强化",10305:"精炼",10306:"装备已达到最大等级",10307:"是否花费{0}",10308:"快速完成护送",10309:"一次性选择最多10个",10310:"六星以上英雄不能分解",10311:"开启2倍速需要VIP{0}级",10312:"或者{0}级",10313:"{0}需VIP{1}或者玩家{2}级后可跳过",10314:"{0}需VIP{1}或者{2}回合后可跳过",10315:"{0}需VIP{1}可跳过",10316:"数据异常",10317:"条件不满足",10318:"通关迷雾森林{0}层或者VIP{1}开启",10319:"该关卡已通过",10320:"不能添加自己为好友",10321:"请先输入名称",10322:"好友列表已满，无法申请",10323:"暂无可申请玩家",10324:"暂无好友申请",10325:"好友列表已满",10326:"成功添加{0}个好友",10327:"您同意了{0}的好友申请",10328:"您拒绝了{0}的好友申请",10329:"当前无好友，无法领取并赠送",10330:"无可赠送好友",10331:"已向所有好友赠送友情点",10332:"已领取所有好友赠送的友情点",10333:"上届荣耀之战未开启",10334:"暂无战斗记录",10335:"本来轮空没有回放",10336:"本来轮空没有押注",10337:"（战斗结束前{0}分钟不能押注）",10338:"（战斗结束前{0}秒不能押注）",10339:"不能押注同一组多次",10340:"比赛已结束不能押注",10341:"跨服对决未开启",10342:"当前不在报名时间内",10343:"不能重复报名",10344:"本服对决未开启",10345:"已满级",10346:"满阶以后才可升七星",10347:"请按要求添加指定的神灵",10348:"当前英雄觉醒已满级",10349:"当前英雄觉醒等级达到上限，请前往升星",10350:"请按要求添加指定的英雄",10351:"下阵失败，主阵容不允许为空",10352:"布阵失败！",10353:"不能同时上阵相同英雄",10354:"确定要更换2个英雄的装备和宝石？",10355:"替换装备失败！",10356:"上阵失败！",10357:"上阵成功！",10358:"到账成功",10359:"请输入信息",10360:"次数已用完，请明日再来",10361:"提升VIP等级可以增加挑战次数",10362:"该圣物不能升星",10363:"无可穿戴圣物",10364:"已养成的紫色品质以上才可以重生",10365:"下阵失败，黑暗森林进攻阵容不允许为空",10366:"一次性选择最多{0}个",10367:"请选择要重生的圣物",10368:"无满足要求的材料",10369:"当前无{0}星{1}",10370:"当前无{0}星{1}圣物",10371:"当前选择经验不足以强化1级",10372:"无可更换英雄",10373:"激活道具不足",10374:"已达融魂上限",10375:"融魂等级已达最大",10376:"需要{0}星才能突破",10377:"您已有队伍，不能再加入其它队伍",10378:"该队伍已满员",10379:"房间已满，无需一键邀请",10380:"{0}s之后才能一键邀请",10381:"您已被请出队伍",10382:"该玩家已离开",10383:"该玩家已加入队伍",10384:"房间人数已满，无需要求",10385:"需要满3个人才能进行匹配",10386:"所有队员准备后才能进行匹配",10387:"{0} 拒绝你的组队邀请",10388:"提升VIP等级，可增加快速战斗次数",10389:"当前战斗正在进行中",10390:"还需要{0}秒才能挑战Boss",10391:"战斗中无法切换地图",10392:"每日只能捐赠一次",10393:"会长才能报名",10394:"周六不能报名（本届公会战将于今日22点结束）",10395:"您没有参与本次公会战，不能进行挑战",10396:"次数不足，无法挑战",10397:"该玩家已死亡",10398:"没有上轮排名数据",10399:"本赛季公会未达到{0}段位",10400:"该段位已领取过",10401:"购买次数不足，请次日挑战",10402:"挑战过当前BOSS才可以进行扫荡",10403:"公会关卡最新数据已更新,请重新选择关卡挑战",10404:"公会战还有{0}开启",10405:"已有公会",10406:"每个公会最多{0}个副会长",10407:"会长离线{0}天以上，副会长才可篡位",10408:"会长离线{0}天以上，成员才可篡位",10409:"今日无招募次数",10410:"钻石不足",10411:"发布招募成功",10412:"会长和副会长才可以进行操作",10413:"当前无可领取求援奖励",10414:"当前无需进行求助",10415:"发送求助间隔需要5分钟",10416:"成功发送求援信息",10417:"不能同时求援同一阵营的英雄碎片",10418:"该援助已完成",10419:"援助次数已用完",10420:"请选择求援的碎片",10421:"当前已有公会，请退出后再来创建",10422:"VIP{0}可创建公会",10423:"该技能已满级",10424:"升级技能后才能重置",10425:"重置公会技能会返还所有帮贡，确定要花费{0}{1}重置公会技能?",10426:"装备总数已达上限",10427:"点击右上角世界地图解锁新章节",10428:"当前头像框已配置",10429:"头像框更换成功",10430:"获得英雄{0}解锁",10431:"当前头像已配置",10432:"头像更换成功",10433:"该形象已穿戴",10434:"未解锁",10435:"更换成功",10436:"最多提交200个字符",10437:"反馈内容不能为空",10438:"每日最多反馈三次",10439:"反馈失败",10440:"暂无更新内容",10441:"矿点不存在，请刷新",10442:"请输入账号",10443:"请阅读并同意，游戏用户须知和隐私保护指引",10444:"没有可用的服务器",10445:"该服务器正处于维护中，无法登录",10446:"该服于{0}开放",10447:"暂无排行信息",10448:"该商场未开放，无法进入",10449:"购买{0}*{1}",10450:"已达该道具限购上限，请下次再来",10451:"今日钻石刷新次数已达上限",10452:"解锁进阶奖励后可领取",10453:"本周积分礼包已领取",10454:"未开放",10455:"购买成功",10456:"本轮勇者之证进阶奖励已解锁",10457:"本轮勇者之证已满级，无需购买等级",10459:"未达到可领取等级",10460:"该奖励已全部领取",10461:"解锁进阶奖励后可以领取",10462:"神力未达到{0}，无法挑战",10463:"{0}级开启，升级可通关重复挑战或扫荡副本",10464:"请通关前面章节",10465:"请先领取前面通关奖励",10466:"玩家等级达到30级才可以进行评论",10467:"拥有该英雄才可以进行评价",10468:"无法点赞自己的评价",10469:"VIP{0}可领取",10470:"每日登录可领取",10471:"VIP3可领取",10472:"充值任意金额可领取",10473:"等待到账",10474:"已过期",10475:"￥",10476:"领取",10477:"布阵列表不允许为空",10478:"上阵队列已满",10479:"每场战斗只能使用一个雇佣英雄",10480:"布阵成功",10481:"是否要离开队伍?",10482:"奖励次数为0，确定要继续匹配吗?",10483:"拖动玩家可以对换位置",10484:"反馈成功",10485:"删除后的好友无法恢复，确定删除？",10486:"确定拉黑该好友？",10487:"确定取消拉黑该好友？",10488:"游戏版本更新",10489:"账号已在别处登录",10490:"连接已断开，请重新登录({0})",10491:"服务器繁忙请重新登录",10492:"获取数据失败，请稍后重试！",10493:"你的挂机收益达到上限，请前往挂机界面领取",10494:"每次补签需要花费{0}钻石，确定补签？",10495:"洗练后神力大于洗练前神力，确定要继续洗练吗？",10496:"确定要将玩家名字踢出队伍吗?",10497:"你已加入激战神域队伍中，确定要退出并前往组队挑战?",10498:"购买1个回复药水？",10499:"购 买",10500:"分解的英雄中包含4星以上英雄，是否确定分解？",10501:"该英雄已上阵，是否要下阵？",10502:"是否花费",10503:"押注？",10504:"押 注",10505:"奖励次数为0，确定要继续准备吗？",10506:"确定要取消匹配？",10507:"已用时：{0}秒",10508:"是",10509:"否",10510:"确定要按照本关最高伤害{0}进行扫荡吗？",10511:"免费",10512:"花费{0}钻石",10513:"确定要向世界发布招募信息，本次{0}。(今日剩余{1}次)",10514:"确定要解散公会[{0}]，解散公会操作不可逆，请三思！",10515:"确定要退出公会[{0}]",10516:"{0}离开了我们，祝他一路走好！",10517:"确定要转让会长给{0}?",10518:"确定要罢免{0}副会长职位?",10519:"确定要任命{0}为副会长?",10520:"{0}是副会长,确定要将逐出公会?",10521:"确定要逐出公会?",10522:"转让会长",10523:"罢免副会长",10524:"任命副会长",10525:"逐出公会",10526:"篡位",10527:"你要对{0}执行的操作是",10528:"确定要退出游戏？",10529:"确定要切换账号？",10530:"占领数据已刷新",10531:"你已占领其他领地，确定要撤退其他领地，占领该领地吗？",10532:"登录参数错误",10533:"连接服务器...",10534:"获取服务器列表失败！",10535:"游戏暂未开放",10536:"提 示",10537:"正在充值中，请稍等。",10538:"网络已断开,等待重连",10539:"准备首次精彩的战斗",10540:"初始化场景",10541:"连接中...",10542:"正在启动模块",10543:"加载语言包",10544:"加载基础资源",10545:"技能加载中",10546:"角色加载中",10547:"特效加载中",10548:"场景加载中",10549:"正在重连...",10550:"购买次数",10551:"确定要花费{0}",10552:"是否花费{0}",10553:"购买{0}次奖励次数",10554:"购买{0}次挑战次数",10555:"好友详情",10556:"扫 荡",10557:"积分x{0}",10558:"前排",10559:"后排",12e3:"请按要求添加指定的圣物",12001:"继续领取",12002:"第{0}层",12003:"神秘岛屿",12004:"结算信息",12005:"战斗和挂机可以获得魂石，魂石用于英雄升级！",12006:"这里就是黑龙的巢穴，务必小心！",12007:"雅典娜",12008:"吼~~，诸神黄昏将要来临，你们会在我的黑焰下燃成灰烬",12009:"尼德霍格",12010:"在诸神面前，你只有死路一条！",12011:"托尔",12012:"不好，世界树的力量越来越弱！",12013:"这场神界浩劫终究还是没办法避免！",12014:"诸神在经历大战之后，需要长时间恢复！",12015:"但是冥界的力量已经开始侵蚀各地，我们需要一个神界召唤师加入！",12016:"欢迎来到神界，想要成为合格的召唤师必须拥有自己的英雄。",12017:"消耗 <span style='color:#f36f2f;'>神秘召唤书</span> 可以进行 <span style='color:#f36f2f;'>神秘召唤</span>，可以随机获得<span style='color:#f36f2f;'>3-5星英雄</span>哦！",12018:"太棒了，竟然召唤到<span style='color:#f36f2f;'>守护{0}</span>！",12019:"召唤师，我已经迫不及待了，快设置我出战！",12020:"点击英雄头像，选择上阵英雄！",12021:"刚刚战斗掉落了{0}碎片，一定数量的碎片可以合成英雄哦！",12022:"我们合成了强力输出{0}！",12023:"哼，你就是新的守护者么？就暂时与你并肩作战吧！",12024:"每隔一段时间可以领取挂机收益，点击宝箱就可以领取了哦！",12025:"快速战斗可以直接获得挂机2个小时收益。",12026:"每个英雄都需要装备，装备可以大幅度提高英雄战斗力！",12027:"进阶之路记录着召唤师的成长轨迹，进阶还可以领取传说神器。",12028:"哇！有了{0}的加入，我们的颜值提升了一大截！",12029:"凡人，与我并肩作战是你的荣誉。我能治疗受伤的神灵，但是别忘了布置我上阵！",12030:"每完成5场战斗，可以获得挑战BOSS的资格。",12031:"当然挑战BOSS可以获得通关奖励，别忘记领取了。",12032:"装备强化可以大幅度提高装备基础属性！",12033:"当英雄等级达到上限，需要进阶突破等级上限！",12034:"别忘了领取七日奖励，次日登录领取<span style='color:#f36f2f;'>加百列</span>，七日登录领取<span style='color:#f36f2f;'>哈迪斯</span>!",12035:"召唤师，恭喜你，完成的初级试炼！",12036:"神器拥有强大的力量，面对越来越强大的黑暗力量，神器是必不可少的。",12037:"雷神之锤上阵后可以提高所有英雄属性，还可以释放神器技能。",12038:"神器在战斗时候会触发神器技能，赶紧去试试吧！",12039:"我们又获得一把神器，宙斯之盾是最强的防御神器！",12040:"解锁2把神器之后就可以开始强化。",12041:"神器养成是所有神器共享，不用担心换神器带来的损失！",12042:"竞技场汇聚着许多优秀召唤师，是证明实力的地方。",12043:"神界发现一条裂缝，裂缝中出现了世界BOSS，大法师已经号令所有召唤师一起击杀它！",12044:"神界之门开启后能聚集神界力量，召唤出指定阵营英雄！",12045:"点击左右按钮，可以切换阵营",12046:"每日副本能够产出大量魂石、金币等资源，是召唤师每日必做功能！",12047:"精炼玩法已经开启，精炼可以大幅度提高战斗力！",12048:"公会功能已经开启，公会中可以结识很多志同道合的召唤师。",12049:"点击申请你心仪的公会申请或者创建一个公会！",12050:"报告主人，在一片神秘岛屿发现了大量矿产。",12051:"神秘岛屿分为普通、中级、高级，岛屿越好刷新的矿产等级越高",12052:"由于争夺人数太多，神界指定规则，只有实力最强的人才可以占领并进行采集。",12053:"现在我们选择一个占领玩家实力相近的或者无人占领矿点进行采集！",12054:"新功能失落遗迹已经开启！失落遗迹埋葬的许多圣物，我们前往一探究竟。",12055:"失落遗迹分为15关，每3关可以获得一个宝箱奖励。",12056:"每次战斗都会记录剩余血量，记得合理上阵英雄哦！",12057:"在神界的西部，有一片迷雾森林，只要进入的英雄都会迷失方向，只等待浓雾散开。我们快前往一探究竟！",12058:"迷雾森林进行到一定关卡，可以领取丰厚奖励",12059:"迷雾森林会产出融魂道具，融魂可以大幅度提高英雄属性。",12060:"探险玩法已经开启，快来体验格子世界的乐趣！",12061:"装备宝石可以增加装备属性，快速提升战斗力！",12062:"宝石分为3种：攻击宝石、生命宝石、防御宝石，每次升级宝石需要消耗指定数量的宝石。",12063:"哥布林是大陆上最精明的商人，但是他们矮小的身材导致经常被掠夺。",12064:"哥布林商人发出请求，只要成功护送他们的召唤师，都可以获得丰厚奖励。",12065:"掠夺其他玩家的护送商人，也可以获得可观奖励。",12066:"试练塔已经解锁，里面充满了挑战。",12067:"通关每个关卡可以获得进化徽章，进化徽章是英雄进阶的必备材料哦",12068:"英雄觉醒可以大幅度提高英雄属性，还可以使用3星以下英雄作为材料！",12069:"觉醒100级还可以获得新的时装！",12070:"圣物蕴涵着强大的能量，拥有之后击败魔物将会更加得心应手！",12071:"提升圣物等级可以让圣物的能量更加强大",12072:"魔物数量众多，组队作战可以事半功倍哦，现在可以通过世界聊天寻找你的小伙伴！",12073:"欢迎加入公会，在公会中可以挑战公会BOSS和公会战，还可以提高公会技能和兑换特殊奖励",12074:"大厅可以查看公会信息和公会成员",12075:"捐献可以获得公会贡献",12076:"使用公会贡献兑换特殊奖励",12077:"技能可以增加指定阵营属性",12078:"首充可以领取超值大礼包！",12079:"6星雅典娜拥有强力群攻，充值任意金额即可获得！",12080:"艾米",12081:"神力",12082:"积分：",12083:"公会：",12084:"无",12085:"({0}装备中)",12086:"亿",12087:"万",12088:"天",12089:"小时",12090:"分钟",12091:"个月",12092:"前",12093:"秒",12094:"倒计时: {0}天{1}小时",12095:"倒计时: {0}小时{1}分",12096:"{0}天{1}小时",12097:"分钟前",12098:"小时前",12099:"天前",12100:"刚刚离线",12101:"离线{0}分钟",12102:"离线{0}小时",12103:"离线{0}天",12104:"离线1个月以上",12105:"后免费",12106:"召唤一次",12107:"召唤十次",12108:"次",12109:"十连必出",12110:"首次十连必出",12111:"四星英雄",12112:"五星英雄",12113:"圣物",12114:"新手阵容",12115:"基础阵容",12116:"进阶阵容",12117:"图 鉴",12118:"英雄背景",12119:"剩余可输入文字：{0}",12120:"图鉴进度：{0}/{1}",12121:"属性总览",12122:"普通",12123:"困难",12124:"试炼塔排行",12125:"公会：{0}",12126:"试炼塔奖励",12127:"关卡信息",12128:"神力达到{0}",12129:"等级达到{0}",12130:"任 务",12131:"日 常",12132:"勇者之证",12133:"试炼任务",12134:"成 就",12135:"活动时间: {0}月{1}日~{0}月{1}日",12136:"激活专属奖励,勇者等级+{0}",12137:"购买等级",12138:"购买{0}级,升至{1}级",12139:"升至{0}级,立即领取以下奖励",12140:"[每周]",12141:"[赛季]",12142:"已解锁",12143:"解锁领取",12144:"每周挑战",12145:"终极试炼",12146:"活跃度+{0}",12147:"进行中...",12148:"完成上个任务开启",12149:"我要变强",12150:"新手入门",12151:"小资必备",12152:"土豪必刷",12153:"集 市",12154:"商 城",12155:"勋章商店",12156:"公会商店",12157:"结晶商店",12158:"遗迹商城",12159:"荣耀商店",12160:"神域商店",12161:"刷新有惊喜,别忘了哦!",12162:"走过路过,千万别错过!",12163:"挑战竞技场,可以获得勋章!",12164:"积极参与公会活动,获得公会贡献!",12165:"开启神界之门也会获得一个结晶哦!",12166:"失落遗迹奖励丰厚,每日0点更新!",12167:"参与荣耀之战或者进行押注,都可以获得大量荣耀币!",12168:"与好友组队,一起决战神域!",12169:"{0}折",12170:"刷新次数：{0}/{1}",12171:"免费次数:({0}/{1})",12172:"倒计时:{0}",12173:"集市刷新",12174:"确定要花费      {0}刷新集市商品",12175:"购买商品",12176:"今日可买{0}次",12177:"拥有：",12178:"我的神力",12179:"等级",12180:"我的等级",12181:"关卡",12182:"我的关卡",12183:"试炼塔",12184:"公会",12185:"公会等级",12186:"排行榜",12187:"未上榜",12188:"已膜拜",12189:"膜拜",12190:"邮件数量：{0}",12191:"邮 件",12192:"最近登录",12193:"默认分页",12194:"用户须知",12195:"隐私保护指引",12196:"汇杰思特游戏用户协议",12197:"你已占领新矿产，以下是上个矿产采集奖励",12198:"以上为上个矿点收益",12199:"采集成功",12200:"采集失败",12201:"{0}掠夺了你的矿点，损失了",12202:"{0}掠夺了你的矿点，没有损失",12203:"你抵御了{0}的抢占",12204:"你抵御了{0}的掠夺",12205:"你占领的{0}已经采集完成，以下是采集奖励。",12206:"请前往神秘岛屿领取！",12207:"你的{0}被{1}占领。",12208:"截止被占领，你共获得以下奖励",12209:"暂无收益",12210:"矿产",12211:"神秘人",12212:"开启",12213:"开启中...",12214:"当前可获得金币",12215:"剩余兑换次数",12216:"可掠夺:{0}次",12217:"可占领:{0}次",12218:"初始",12219:"觉醒",12220:"时装",12221:"未获得",12222:"更 换",12223:"玩家信息",12224:"修改昵称",12225:"英雄形象",12226:"英雄形象设置",12227:"头像设置",12228:"头像框设置",12229:"公 告",12230:"未知",12231:"加入",12232:"申请",12233:"我要加入",12234:"点击加入",12235:"公会技能",12236:"输出,治疗,辅助,控制,坦克",12237:"创建公会",12238:"VIP{0}可创建公会",12239:"免费援助",12240:"援助",12241:"求援中",12242:"可领取",12243:"公会救援",12244:"今日求援完成次数 ({0}/{1})",12245:"免费援助次数：",12246:"钻石援助次数：",12247:"求 援",12248:"在线",12249:"会长",12250:"副会长",12251:"成员",12252:"需要验证",12253:"直接加入",12254:"设 置",12255:"公会大厅",12256:"会长{0}退位让贤，将会长职位传给了{0}",12257:"道不同不相为谋，会长将{0}踢出了公会。",12258:"欢迎{0}加入了大家庭，一同求道！",12259:"申请列表",12260:"通关第{0}关",12261:"奖 励",12262:"最高关卡",12263:"公会副本",12264:"公会副本排行",12265:"我的排名：",12266:"击杀排行",12267:"青铜",12268:"白银",12269:"铂金",12270:"王者",12271:"暂无公会达到王者段位",12272:"赛季排名",12273:"我的赛季积分:",12274:"未入王者",12275:"会员排名",12276:"S{0}赛季",12277:"赛区排名",12278:"{0}组排名",12279:"段位宝箱",12280:"查看上轮排名",12281:"已报名",12282:"由于{0}级人数小于{1}人，不能参与本轮比赛",12283:"由于本轮轮空，直接获得积分，请静候下轮比赛",12284:"报名",12285:"等待会长报名中",12286:"王者第{0}名",12287:"下轮比赛倒计时：",12288:"未报名",12289:"赛",12290:"总战斗力：",12291:"已击败",12292:"挑 战",12293:"区服",12294:"公会贡献",12295:"已捐献",12296:"捐 献",12297:"奖励详情",12298:"收益提升",12299:"开启新章节",12300:"挂机",12301:"下一层",12302:"未通关",12303:"回合",12304:"通关奖励",12305:"击杀",12306:"{0}关后可击杀",12307:"快速战斗",12308:"神界之门",12309:"英雄转换",12310:"{0}星英雄掉落(整卡掉落概率{1}%，碎片掉落概率{2}%)",12311:"组队信息",12312:"激战神域邀请",12313:"你的好友{0}邀请你组队，一起激战神域，是否要加入？",12314:"神域积分：{0}",12315:"神域币：{0}",12316:"奖励次数：{0}次",12317:"{0}秒后自动准备",12318:"拖动玩家可以对换位置",12319:"{0}秒后自动开始",12320:"开始战斗",12321:"取消准备",12322:"准备",12323:"组队奖励加成{0}%",12324:"排 名",12325:"邀请好友",12326:"奖励加成：{0}%",12327:"准备完毕",12328:"未准备",12329:"队长",12330:"已邀请",12331:"邀 请",12332:"已阵亡",12333:"出战中",12334:"速度",12335:"生命上限",12336:"攻击上限",12337:"防御上限",12338:"更换英雄",12339:"阵营克制",12340:"主动技能",12341:"被动技能",12342:"类型",12343:"（{0}阶激活）",12344:"融魂",12345:"觉醒",12346:"升星",12347:"信息",12348:"速度增加",12349:"(英雄达到{0}星)",12350:"上限",12351:"生命",12352:"攻击",12353:"防御",12354:"英雄升阶",12355:"等级上限",12356:"升  阶",12357:"升  星",12358:"自动融魂",12359:"条件：英雄达到{0}星",12360:"觉醒+{0}解锁新时装",12361:"觉醒+{0}激活",12362:"敬请期待",12363:"消耗道具{0}激活",12364:"获得{0}解锁",12365:"已穿戴",12366:"穿 戴",12367:"激 活",12368:"解锁条件:英雄达到{0}阶",12369:"该技能已满级",12370:"升级条件:英雄达到{0}星自动升级",12371:"选择英雄",12372:"圣物图鉴",12373:"基础属性",12374:"品质：{0}",12375:"强 化",12376:"升星属性",12377:"升 星",12378:"介绍",12379:"替 换",12380:"脱 装",12381:"选 择",12382:"圣物升星",12383:"星级预览",12384:"圣物重生",12385:"已激活",12386:"未激活",12387:"本届",12388:"上届",12389:"第{0}组",12390:"已截止",12391:"报名倒计时：",12392:"预选赛进行中：",12393:"本服对决已结束",12394:"本届荣誉之战已结束",12395:"下一场开始倒计时：",12396:"跨服对决倒计时：",12397:"押注奖励",12398:"奖励",12399:"我的记录",12400:"对战选手",12401:"本服",12402:"跨服",12403:"冠军王位",12404:"胜利",12405:"失败",12406:"押注成功",12407:"押注失败",12408:"已押注",12409:"押注",12410:"社交",12411:"已收到请求 :{0}",12412:"层",12413:"荣耀之战",12414:"匹配赛",12415:"竞技场",12416:"好友切磋",12417:"每日副本",12418:"失落遗迹",12419:"关",12420:"迷雾森林",12421:"世界BOSS",12422:"商队护送",12423:"公会战",12424:"公会副本",12425:"神秘岛屿",12426:"激战神域",12427:"组队副本",12428:"{0}掠夺了你,损失了",12429:"{0}掠夺了你,由于护送的是传说商队，所以没有损失",12430:"掠夺记录",12431:"护送奖励",12432:"护送：{0}次",12433:"掠夺：{0}次",12434:"掠夺次数：{0}",12435:"强化大师{0}级",12436:"精炼大师{0}级",12437:"全身装备强化{0}级",12438:"全身装备精炼{0}级",12439:"获取途径",12440:"数量：{0}",12441:"精炼属性",12442:"精 炼",12443:"套装属性",12444:"{0}+{1}% (穿戴{2}件激活)",12445:"红色",12446:"橙色",12447:"紫色",12448:"强化大师未激活",12449:"精炼大师未激活",12450:"宝石合成",12451:"宝石背包",12452:"暂无未镶嵌的{0}",12453:"全部",12454:"神界答题",12455:"恭喜你！答对了，获得以下奖励：",12456:"很遗憾，回答错误，请再接再厉！",12457:"猜大小",12458:"恭喜你！猜对了大小，获得以下奖励：",12459:"很遗憾，你猜错了，请再接再厉！",12460:"前进",12461:"后退",12462:"猜拳对决",12463:"恭喜你！战胜了对手，获得以下奖励：",12464:"胜败乃兵家常事，不要气馁！",12465:"随机获得其中一种物品",12466:"眼力比拼",12467:"恭喜你！打开杯子后获得以下奖励：",12468:"奖励预览",12469:"回复血量",12470:"复活英雄",12471:"好友助阵",12472:"今日已雇佣: {0}/{1}",12473:"不能选择超过我方的最高神力英雄{0}%的好友英雄",12474:"来自好友",12475:"组队挑战排行榜",12476:"未挑战",12477:"转移队长",12478:"已通关",12479:"当前队伍关卡",12480:"组队挑战邀请",12481:"你的好友{0}邀请你进行组队挑战，是否要加入？",12482:"好友邀请",12483:"队  伍",12484:"组队大厅",12485:"单人挑战",12486:"挑  战",12487:"等待玩家加入",12488:"已申请",12489:"申 请",12490:"精炼副本",12491:"宝石副本",12492:"碎片副本",12493:"等级{0}级开启",12494:"扫 荡",12495:"召唤师，欢迎回到神界！",12496:"系统",12497:"表情",12498:"私聊",12499:"点击输入文字",12500:"{0}造成了{1}点伤害",12501:"大于",12502:"复活中",12503:"争夺人数：{0}",12504:"({0}后恢复1次)",12505:"伤害排名",12506:"概率",12507:"必掉",12508:"虚位以待",12509:"英雄碎片",12510:"选择奖励",12511:"开启倒计时：",12512:'恭喜获得神器"{0}"',12513:"技能",12514:"洗练",12515:"已解锁{0}把",12516:"解锁{0}把神器开启强化",12517:"提升",12518:"神器{0}级",12519:"解锁{0}把神器开启技能升级",12520:"规 则",12521:"选择神器",12522:"卸 下",12523:"神器收集",12524:"把",12525:"神器升星",12526:"各星级特殊属性",12527:"（以上属性不叠加，只会生效最高星）",12528:"星",12529:"当前星级：{0}星",12530:"神器洗练",12531:"洗练等级：{0}级",12532:"当前经验",12533:"已满",12534:"自动升星",12535:"停止",12536:"（ 点击单条属性可锁定不被洗练 ）",12537:"已锁定{0}个技能，每次洗练消耗{1}钻石。",12538:"洗练有5级以上属性，确定要洗练吗？",12539:"战斗记录",12540:"挑战",12541:"防守",12542:"成功",12543:"积分",12544:"段位",12545:"本轮倒计时：",12546:"获得",12547:"本服排名:",12548:"跨服排名:",12549:"排名",12550:"历史最高：",12551:"竞技场排名",12552:"每日{0}结算，排名奖励通过邮件发放",12553:"开服基金",12554:"已结束",12555:"倒计时：",12556:"当前全服首充：{0}人",12557:"已关闭",12558:"已结束(领奖倒计时:{0})",12559:"兑换物品",12560:"公会：{0}",12561:"暂无公会",12562:"阵 容",12563:"{0}级：{1}",12564:"(被动)",12565:"(主动)",12566:"首次加载时间较长，请耐心等待",12567:"点击刷新",12568:"抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。",12569:"适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。",12570:"加载中...",12571:"再来一次",12572:"下一关",12573:"前往下一关",12574:"前往下一关({0}s)",12575:"英雄分解",12576:"分解预览",12577:"选择分解英雄",12578:"已拥有英雄：{0}/{1}",12579:"装备",12580:"精炼",12581:"宝石",12582:"分解",12583:"更换",12584:"穿戴",12585:"卸下",12586:"生       命：",12587:"攻       击：",12588:"防       御：",12589:"（已满级）",12590:"（已达上限）",12591:"装备分解",12592:"你将分解{0}件装备",12593:"未激活{0}大师",12594:"已激活{0}大师{1}级",12595:"强化大师",12596:"精炼大师",12597:"套装",12598:"{0}件套加成",12599:"选择装备",12600:"无套装加成",12601:"{0}{1}件套加成",12602:"剩余兑换{0}次",12603:"兑换",12604:"前往",12605:"充值",12606:"已充值",12607:"剩余{0}次",12608:"限购{0}次",12609:"基金",12610:"第{0}天可领取",12611:"你在删档测试中累计充值：{0}元",12612:"现在可以领取返利：{0}钻石",12613:"超级会员",12614:"单日累计充值{0}元",12615:"历史累计充值{0}元",12616:"分享奖励",12617:"英雄计划",12618:"快来一起战斗吧！",12619:"去邀请",12620:"今日福利",12621:"今日目标",12622:"今日任务",12623:"今日抢购",12624:"第{0}天",12625:"实名认证",12626:"去认证",12627:"我要领取",12628:"通关",12629:"星级",12630:"我的星级：{0}星",12631:"排行",12632:"剩余时间:",12633:"神界排行",12634:"关卡排行",12635:"等级排行",12636:"英雄星级",12637:"神力排行",12638:"恭喜购买成功！",12639:"等待到账...",12640:"{0}元礼包",11e3:"进度条满之后才可挑战",11001:"通关前一关卡",11002:"Lv.{0}级开启",11003:"通关前一章节",11004:"战力达到{0}开启",11005:"通关主线{0}后开启",11006:"已完成",11007:"正在完成",11008:"操作处于cd中",11009:"尚未达成",11010:"已結束",11011:"请选择要分解的装备",11012:"操作过于频繁",11013:"没有可选装备",11014:"兑换后超装备可拥有上限,无法兑换",11015:"刷新太频繁，请稍后再试",11016:"材料不足，觉醒失败",11017:"             {0}级可以发送消息",11018:"队伍已解散",20003:"世界之树，孕育着人类和英雄。",20004:"古老的封印被解开，黑龙“尼德霍格”苏醒了！",20005:"当黑龙啃食完世界之树的树根后，",20006:"面对这场浩劫，东西方的诸神将全力阻止这一切。",20007:"诸神将迎来毁灭的黄昏。",20011:"        为了预防青少年过渡游戏，未满18周岁的用户和身份信息不完整的用户将受到防沉迷系统的限制，《守护神域》积极响应国家新闻出版总署防沉迷政策要求，开发出手机游戏防沉迷系统。年龄已满18周岁的玩家，在填写身份资料后，可以不受防沉迷系统影响，自由进行游戏。根据身份信息未成年的，5小时将被强制下线并且必须下线休息5小时。\n        说明:系统只支持输入15位或18位中国身份证号码，持有其他证件（如:外国护照，军人证等）者，请与客服GM联系处理。填写身份信息将使我们可以对您的年龄做出判断，以确定您的游戏时间是否需要按照国家新闻出版总署的要求纳入防沉迷系统的管理。\n        隐私说明:用户填写的身份信息属于用户隐私、《守护神域》游戏绝对尊重用户个人的隐私权。所以，《守护神域》游戏绝对不会公开，编辑或透露用户的信息内容，除非有法律许可及公安管理规定。",20020:"      全服首充人数达到要求，并且玩家累计充值达到指定金额，即可领取奖励。",20021:"亲爱的异界勇士们：\n《英雄计划》欢迎各位勇士参与本次游戏测试！\n本次测试为计费删档测试。\n开服时间：11月29日10:00\n关服时间：12月6日10:00\n测试结束后服务器将关闭，游戏内的角色数据也会被删除。\n当前测试为删档内测，不代表游戏的最终品质，所有问题和建议将安排在后续的开服计划中，为各位勇士呈现最优秀的游戏品质。\n感谢大家对游戏的支持，祝大家游戏愉快。",20022:"为了给各位勇士提供更优质的游戏体验，在本次测试中，我们为各位勇士准备了以下的活动：\n【测试充值返还】\n在本次测试进行付费体验的玩家，系统会记录同一平台以及相同账号下累计充值总金额，并在不删档首发时返还同一账号下充值金额的200%钻石！\n返还规则：\n       1、删档期间玩家购买了游戏内任意礼包，则该类型礼包购买金额也应计入充值金额；\n        2、在不删档首发开启后，删档测试期间充值的玩家可通过游戏内领取钻石；\n        3、在不删档首发开启后，玩家可登陆删档期间的本账号所创建的任意一角色，但钻石会返利到首发期间首次创建的角色，完成一次领取后即完成返还。\n       4、返还的钻石不会激活游戏内的充值奖励（如首充奖励、累计充值奖励等）；\n       5、累计充值金额为本账号下所有角色充值金额的总和，系统赠送的钻石不会返还(包括充值时额外赠送的钻石)；\n       6、结合上述规则，例如：\n      加百列在删档测试期间一共充值了1000元，则在首发时可以获得20000钻石的返利。"},h.lansArr={20002:[["规 则","1.公会副本每一关有一个BOSS，全公会玩家一起挑战，每次挑战后记录BOSS剩余血量.","2.每次挑战可以获得挑战奖励，击杀BOSS后，额外获得伤害排名奖励.","3.通关奖励和伤害排名奖励只能领取一次.","4.每个关卡通关奖励次数不能超过公会上限人数."]],20003:[["规 则","1.活动期间，购买基金即可激活.","2.七天内每天可以领取一次奖励，七天共可领取七次奖励."]],20004:[["规 则","1.每次许愿可以获得转盘上其中一个奖励.","2.每天可以获得一次免费许愿次数.","3.如果没有免费次数，许愿花费50钻石进行许愿.","4.每天限制许愿次数，提升VIP可以获得更多次数."]],20008:[["规 则","1.世界BOSS是来自己黑暗深渊的魔物，只有全服玩家齐心协力才能消灭.","2.世界BOSS分为不同等级，需要达到要求等级才能挑战.","3.挑战次数按照时间恢复，上限10次，可以花费钻石购买.","4.奖励分为:挑战奖励和排名奖励."]],20009:[["规 则","1.每天有一定掠夺和护送次数，每天0点重置.","2.每次护送最多被掠夺2次.","3.每天特定时间段，护送奖励翻倍.","4.可以花费钻石刷新到稀有商队.","5.每次护送15分钟，可以花费钻石进行加速"]],20012:[["矿点分类","1.矿点分为1-5级，1-3级为金币矿，4-5级为钻石矿.","2.岛屿等级越高刷新出等级越高."],["刷新规则","1.每个岛屿特定时间点会刷新10个资源矿，资源矿等级根据岛屿等级决定.","2.已占领矿点不会刷新，只会在采集完成后消失."],["抢占规则","1.每个玩家只能占领一个矿点，每天只能占领3个岛屿.","2.玩家可以选择掠夺其他玩家矿点，掠夺成功会获得一定比例已采集的矿产.","3.掠夺会消耗一定的掠夺次数，掠夺次数可以购买.","4.玩家也可以选择直接抢占其他玩家矿点，抢占成功可以获得已采集部分矿产并占领该玩家矿点."]],20013:[["概 要","1.公会战采用跨服形式，相邻服务器进行战斗."],["休赛期规则","1.每周日1点-24点为跨服争霸休赛期，也是下个赛季报名期.","2.报名需要公会10名以上30级玩家.","3.报名成功后，公会中30级玩家均可以参加公会战."],["比赛期规则","1.每周一到周六为比赛期，比赛期每天6:00-22:00进行一轮比赛.","2.周一到周五均可以报名，报名成功会加入次日青铜组比赛.","3.每天5:30计算公会30级以上玩家数量，人数不足的公会本轮比赛休战，次轮人数达到才可以参加.","4.每天5:30更新玩家本轮比赛防守阵容，防守阵容根据竞技场防守阵容决定.","5.轮空的公会将直接获胜，并获得与所有公会成员积分之和以及获胜积分"],["比赛规则","1.每周一0点，清空积分，初始都是青铜段位.","2.挑战战胜敌方公会玩家，可获得比赛积分.","3.比赛结束后根据比赛积分，判断双方胜负，胜利的公会会加上额外比赛积分.<br/>分别是青铜:1500 、白银:3000、铂金:4500、王者:7500","4.根据22:00的比赛积分，会确定小组排名.<br/>\ta、青铜组:1-6晋级，其余保级<br/>\tb、白银组:1-5晋级，6-9保级，其余保级<br/>\tc、铂金组:1-4晋级，5-8保级，其余降级<br/>\td、王者组:进入王者组后，不会再降级","5.赛季累计积分:赛季开始后每轮比赛获得的积分将累计，作为最后王者组排名依旧.","6.每轮比赛开始后，2个公会积分都为0."],["挑战规则","1.每名玩家每天可以有3次出手机会，每个对手有3条生命.","2.如果未击败对手，对手血量将会记录，下次调整按照当前血量挑战.","3.每次挑战无论胜负，均可以获得1次翻拍奖励."],["奖励设定","1.公会在本赛季每提升一个段位均可开启对应段位宝箱，段位宝箱数量为当前公会晋级时的公会人数上限.","2.相同段位的宝箱每人每赛季最多领取1次，更换公会无法重复获取.","3.每个赛季周六23点发放赛季排名奖励.","4.每个公会内按照本赛季累计积分排行，每周结算一次，奖励按照最终段位发放."]],20014:[["规 则","1.荣耀之战为个人PVP争霸赛，玩家只需报名，后续系统自动匹配战斗，期间可以进行押注.","2.荣耀之战分为本服对决和跨服对决，本服对决的前16名玩家自动晋级到跨服对决比赛.","3.比赛采取淘汰制，胜利晋级下一轮比赛，失败则止步.","4.比赛开始时候，切记要保证最强阵容."],["比赛时间","1.报名时间:周一0点-周三11:30","2.本服预选赛:周三11:30-12:00","3.本服16进8:周三20:00","4.本服8进4:周四12:00","5.本服半决赛:周四20:00","6.本服决赛:周五12:00","7.跨服预选赛:周五20:00","8.跨服16进8:周六12:00","9.跨服8进4:周六20:00","10.跨服半决赛:周天12:00","11.跨服决赛:周天20:00"],["押注规则","1.除了预选赛，其他比赛均可押注，押注成功即可获得奖励，奖励邮箱领取。每一轮比赛开始{0}分钟前均可进行押注."]],20015:[["规 则","1.匹配赛每周一开启，周日22:00结算本周奖励，重置挑战次数宝箱奖励.","2.匹配赛胜负会产生积分变化，积分会在赛季结束后重置，每个赛季结束时间以公告为准.","3.玩家根据分数决定自己的段位，段位分为荣耀王者、最强王者、钻石、铂金、黄金、白银、青铜.","4.每周会根据玩家段位和本服积分排名发放奖励.","5.玩家每天有一定挑战次数，挑战次数每日24点刷新."]],20016:[["规 则","1.活跃玩家加成:{0}%<br/>(除了一键邀请外玩家均是活跃玩家，每个玩家加成{3}%).","2.队长好友加成:{1}%<br/>(队伍中每有一名队长的好友，全队收益加成{4}%).","公会成员加成:{2}%<br/>(队伍中每有一名队长的公会成员，全队收益加成{5}%)."]],20017:[["玩法概述","1.激战神域是跨服3人组队战斗玩法，其中神域积分用于争夺排名，获得稀有奖励，神域币用于商店兑换专属奖励."],["单人状态","1.自动匹配:系统将自动寻找并加入开服房间的空缺队伍.","2.创建队伍:成为队长，创建一个房间.","3.神域商店:兑换物品奖励.","4.排行榜:按照本服积分进行排行，神域积分每周一0点重置并发放奖励."],["组队状态","1.邀请好友:所有玩家都可以邀请好友，点击空置即可邀请.","2.更换位置:队长可以拖动玩家进行位置更换.","3.剩余奖励次数:每日3次，0点重置，可以购买，VIP越高购买次数越多.","4.出战:所有玩家准备完毕后，队长才可以开始."],["战斗状态","1.战斗采取车轮战.","2.按照出站顺序出战，死亡后，下一个上场.","3.每场之间保存血量.","4.全部死亡的一方判断为失败，另外一方胜利.","5.胜利失败均可获得奖励.","6.MVP为击杀最多的玩家;如果击杀一样，则判断积分高的为MVP;如果积分一样，则按照出站先的为MVP."]],20018:[["规 则","1.只有橙色和红色圣物才可以进行重生.","2.每次重生需要消耗一个重生石.","3.重生返还所有养成资源:经验返还成圣物升级石，升星消耗返还消耗的同种圣物."]],20019:[["规 则","1.圣物升级可以消耗圣物升级石或者其他圣物.","2.只有紫色及以下的圣物才能被作为材料消耗，按照选择圣物品质从低到高消耗.","3.每次只能强化1级，多余经验会返还成圣物升级石.","4.如果消耗的圣物已强化，则圣物的等级转换成经验继承到新的圣物上."]],20021:[["神界之门","1.每个神界密钥可以从对应阵营的神界之门中召唤1次英雄.","2.召唤将概率获得整卡或者碎片.","3.每次召唤必定获得1个神界结晶和一定数量转换星尘，一定数量的神界结晶可以用来兑换指定英雄."],["神力转换","1.通过转换星尘，可以4/5星英雄进行同阵营间随机转换.","2.英雄转换后，新生的英雄将继承原来英雄所有的属性和装备."]],30001:[["规 则","1.历练分为3个难度，普通、困难和地狱.","2.每个难度有10个副本，每个副本有10关卡，第10关是BOSS关卡.","3.通关普通所有关卡后才能开启困难，通关困难所有关卡后才能开启地狱."]],30002:[["规 则","1.英雄分为4个阵营，阵营之间存在克制关系，攻击克制单位可以造成额外的伤害.","2.自动战斗时，英雄会优先攻击克制的单位.","3.英雄出手顺序按照速度决定，速度越快，出手越早."]],40001:[["规 则","1.升星需要消耗若干个指定英雄，6星以后还需额外消耗一定数量进化徽章.","2.被消耗的英雄后会还所有养成材料.","3.3星以上英雄才可以升星，部分初始4星英雄只能升到6星，初始5星英雄都可以升到10星（可以通过图鉴辨别）.","4.9星升10星需要消耗9星任意阵营的英雄."]],40002:[["探险规则","1.每个骰子随机1-6点，根据点数移动对应格子，并触发格子事件.","2.事件分为：空、物品奖励、问题和奇遇等.","3.每完成一圈可以获得通关奖励.","4.骰子主要获得途径是领取挂机奖励."]],40003:[["组队副本","1.组队副本为多人玩法，玩家可以组建自己的队伍，或者加入他人队伍.","2.单人和组队都可以通关副本，只能挑战已解锁关卡.","3.队伍的关卡限制等于队长的最高关卡，加入和邀请的玩家需要不小于限制才能加入."],["奖 励","1.奖励分为：个人首通奖励、阶段性奖励和全服首通奖励.","2.个人首通奖励：首次通关新副本，可以获得首通奖励。队长直接挑战活动，队员通过邮件发放.","3.阶段性奖励：每通关指定关卡，可以领取阶段性奖励，阶段性奖励很丰厚，欢迎玩家突破自己.","4.全服首通奖励：全服首通了新副本，全服所有玩家都可以收到首通该副本奖励邮件."]]},h.numChinese=["零","一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十","二十一","二十二","二十三","二十四","二十五","二十六","二十七","二十八","二十九","三十","三十一","三十二","三十三","三十四","三十五","三十六","三十七","三十八","三十九","四十","四十一","四十二","四十三","四十四","四十五","四十六","四十七","四十八","四十九","五十"],h.qualityColor=["","白色","绿色","蓝色","紫色","橙色","红色"],h.qualityName=["","普通","高级","精良","稀有","史诗","传说"],h.attrName=["","生命","攻击","防御","速度","暴击率","暴击伤害","效果命中","效果抵抗","吸血","反击","再次出手","眩晕","伤害加成","治疗加成","增伤","减伤","怒气","免疫控制"],h.baoshiName=["","生命宝石","攻击宝石","防御宝石"],h.GOD_RACE_NAME=["全部","神殿","玄门","圣域","光明","黑暗"],h.RACE_FORCE_STR=["全能之力","神殿之力","玄门之力","圣域之力","光明之力","黑暗之力"],h.godTypeName=["","输出","治疗","辅助","控制","坦克"],h.starName=["","一星","二星","三星","四星","五星","六星","七星","八星","九星","十星"],h.channelNames=["","世界","公会","组队","私聊","同省","跨服","系统"],h}();!function(t){t[t.thew=10022]="thew",t[t.glod=10072]="glod",t[t.daimond=10005]="daimond",t[t.cost=10120]="cost",t[t.awakenCost=11016]="awakenCost",t[t.GroupNotRegTime=321]="GroupNotRegTime",t[t.OccupyInfoHasRefresh=221]="OccupyInfoHasRefresh"}(Lans=Lans||{});var ItemVo=function(){function t(t,e,i,n,o,a){if(this.show=!0,this.bag=!1,this.isFirst=!1,this.selected=!1,this.startAction=!1,this.using=new Array,this.door=!1,this.eat=!1,this.hideSuipian=!1,this.showStar=!0,this.quality=0,this.isDisabled={},this.constNum=0,this.countFromBag=!1,this.isShowEff=!1,0!=t){this.id=t,this.count=e,this.extral=o,this.isFirst=a;var r=tb.TB_item.get_TB_itemById(this.id);r?(this.using=r?r.using_effect:[],this.type=i||r.type):logerror("道具不存在："+this.id)}}return t.prototype.getShow=function(){return this.show},t.prototype.getExtParm=function(){return this.extPram},t.prototype.firstFlag=function(){return this.isFirst},t.prototype.getNum=function(){return this.countFromBag?App.hero.getBagItemNum(this.id):this.count},t.prototype.isInLinuep=function(){return!1},t.prototype.isStartAction=function(){return this.startAction},t.prototype.isMoreThanSix=function(){return 6<=this.getStar()},t.prototype.getQulity=function(){var t=1;return t=this.type==iface.tb_prop.itemTypeKey.god&&6<(t=this.star)?6:0!=this.quality?this.quality:GameUtil.getItemQulityByID(this.id),SkinUtil.getBoxQulityIcon(t)},t.prototype.getIconUrl=function(){if(this.clientUrl)return this.clientUrl;var t=tb.TB_item.get_TB_itemById(this.id);return t?SkinUtil.getItemIcon(t):""},t.prototype.getName=function(){var t=tb.TB_item.get_TB_itemById(this.id);return t?t.name:""},t.prototype.getConstNum=function(){return this.constNum},t.prototype.isChip=function(){var t=tb.TB_item.get_TB_itemById(this.id);return!this.hideSuipian&&(t&&t.isChip())},t.prototype.getChipSkin=function(){var t=tb.TB_item.get_TB_itemById(this.id);return t?t.getChipSkin():""},t.prototype.showRace=function(){var t=tb.TB_item.get_TB_itemById(this.id);return t&&t.icon[2]?t.icon[2]:0},t.prototype.getStar=function(){if(0<this.star)return this.star;var t=tb.TB_item.get_TB_itemById(this.id);return t&&t.icon[3]&&this.showStar?t.icon[3]:0},t.prototype.getLvStr=function(){return this.lvStr},t.NULL=new t(0,0),t.ITEM_QUALITY_COLORS=["","#ffffff","#319c28","#0000ff","#ca1fe2","#de8a0b","#ff0000"],t}(),BaseFightVo=function(){function t(){}return t.prototype.setLineupInfo=function(t){this.lineupInfo=t,this.lineupGods=[];for(var e=t&&t[0]?t[0]:[],i=0;i<e.length;i++){var n=e[i];if(n){var o={templateId:n[0],starLevel:n[1],level:n[2],degree:n[4],awakenLv:n[5],skinId:n[6]},a=App.hero.createGodVo(o,-i);n[3]&&(a.iSeverAttri=map2ary(n[3])),this.lineupGods.push(a)}else this.lineupGods.push(null)}this.shenqiVo=t&&t[1]?t[1]:[]},t.prototype.getShenqiAry=function(){return this.shenqiVo},t.prototype.getLineupGodIds=function(){for(var t=[],e=0;e<this.lineupGods.length;e++){var i=this.lineupGods[e];i?t.push(i.templateId):t.push(0)}return t},t.prototype.getExistGods=function(){return this.lineupGods.filter(function(t){return t&&t.templateId})},t.prototype.setDataType=function(t){for(var e=0,i=this.lineupGods;e<i.length;e++){var n=i[e];n&&(n.dataType=t)}},t.prototype.getLineupGods=function(){return this.lineupGods},t.prototype.getGodTotalHp=function(e){var t=(this.lineupInfo&&this.lineupInfo[0]?this.lineupInfo[0]:[]).find(function(t){return t&&t[0]==e});return t&&t[3]?t[3][1]:0},t.prototype.getLineupTotalHp=function(){for(var t=0,e=0,i=this.lineupInfo&&this.lineupInfo[0]?this.lineupInfo[0]:[];e<i.length;e++){var n=i[e];t+=n&&n[3][1]?n[3][1]:0}return t},t.prototype.isHasLineup=function(){return this.lineupInfo&&0<this.lineupInfo.length},t.prototype.turnTemplatID=function(t){var e={},i=this.lineupInfo[0];for(var n in t){e[i[Number(n)%10-1][0]]=t[n]}return e},t.prototype.clearLineupInfo=function(){this.lineupInfo=[],this.lineupGods=[],this.shenqiVo=[]},t}();(game||(game={})).ShareItemVo=function(){};__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.ItemBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){if(this._dataSource=t,this.lbLevel.visible=!1,t){this.img_icon.skin=t.getIconUrl(),this.img_qulity.skin=t.getQulity();var e=t.isChip();if((this.img_suipian.visible=e)&&GameUtil.isFunction(t.getChipSkin)&&(this.img_suipian.skin=t.getChipSkin()),t.isMoreThanSix()?(this.list_awake.repeatX=t.getStar()-5,this.list_awake.visible=!0,this.list_star.visible=!1):(this.list_star.visible=0!=t.getStar(),this.list_star.repeatX=t.getStar(),this.list_awake.visible=!1),this.img_race.visible=0!=t.showRace(),this.img_race.visible&&(this.img_race.skin=SkinUtil.getGodRaceSkin(Number(t.showRace()))),GameUtil.isFunction(t.getLvStr)){var i=t.getLvStr();this.lbLevel.visible=i&&""!=i,this.lbLevel.text=i}if(t instanceof ItemVo||t instanceof tb.TB_item||t instanceof TreasureItemVo||t instanceof GemstoneItemVo){var n=t.getNum(),o=t.getConstNum();t.getShow()&&this.on(Laya.Event.CLICK,this,this.showTip),0<n||0<o?(this.label_number.visible=!0,0<o?(this.label_number.text=Snums(n)+"/"+Snums(o),this.label_number.color=o<=n?ColorConst.WHITE:ColorConst.redFont):this.label_number.text="x"+Snums(n)):this.label_number.text="",t instanceof TreasureItemVo?(this.label_number.text=0<n&&!t.isExsitGod()?"x"+Snums(n):"",this.lbLevel.visible=0<t.strengthLv,this.lbLevel.text="+"+t.strengthLv):t instanceof GemstoneItemVo&&(this.label_number.text=0<n&&!t.isExsitGod()?"x"+Snums(n):"",this.lbLevel.visible=0<t.gemLv,this.lbLevel.text="Lv."+t.gemLv)}else if(t instanceof EquipItemVo)if(t.getShow()&&this.on(Laya.Event.CLICK,this,this.showTip),1==t.type){var a=t.getRefineLevel();this.label_number.visible=0!=a,this.label_number.text="+"+a,this.label_number.y=7}else 0==t.type?(a=t.getStrengthLv(),this.label_number.visible=0!=a,this.label_number.text="+"+a,this.label_number.y=62):this.label_number.text="";else this.label_number.text="";t.isStartAction()&&(this.scale(1.4,1.4),this.visible=!1)}else this.list_star.visible=!1,this.off(Laya.Event.CLICK,this,this.showTip),this.img_qulity.skin=SkinUtil.getBoxQulityIcon(1),this.img_icon.skin=null,this.label_number.text=""},enumerable:!0,configurable:!0}),n.prototype.addTipsListener=function(){this.on(Laya.Event.CLICK,this,this.showTip)},n.prototype.showTip=function(){if(this._dataSource instanceof ItemVo||this._dataSource instanceof tb.TB_item){var t=void 0;if((t=this._dataSource instanceof ItemVo?tb.TB_item.get_TB_itemById(this._dataSource.id):this._dataSource)&&t.type==iface.tb_prop.itemTypeKey.treasure){var e=new TreasureItemVo(t);UIUtil.showTip(e)}else UIUtil.showTip(this._dataSource)}else UIUtil.showTip(this._dataSource)},n);function n(){return e.call(this)||this}t.ItemBox=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var s,e=(s=Laya.Component,__extends(i,s),i.prototype.onCreate=function(){this._itemsParent=new Laya.Panel,this.addChildAt(this._itemsParent,0),this._itemsParent.size(this._scrollWidth,this._scrollHeight),this._buffRenderList=[],this._items=new Array,this._itemsParent.vScrollBarSkin="",this._scrollBar=this._itemsParent.vScrollBar,this._scrollBar.scrollSize=this._scrollSize,this._scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange),this.on(Laya.Event.MOUSE_WHEEL,this,this.onMouseWheel)},i.prototype.stopScroll=function(){this._scrollBar.stopScroll()},i.prototype.onRemove=function(){this._buffRenderList.length=0,this._array.length=0,this.removeAll()},i.prototype.layoutItem=function(t,e){t.y=this.sumHeight,t.x=0,this.sumHeight+=t.height+this._spaceY},i.prototype.layoutAllItem=function(){for(var t=this.sumHeight=0;t<this._itemCount;t++)this.layoutItem(this._items[t],t);this.onScrollBarChange(),this.updateScrollMax()},i.prototype.updateScrollMax=function(){this.callLater(this.scrollToMax)},i.prototype.scrollToMax=function(){var t=this.sumHeight>this._scrollHeight?this.sumHeight-(this._spaceY+this._scrollHeight):0,e=!0;this._scrollBar.value<this._scrollBar.max&&(e=!1),this._offset>t&&(this.offset=t),this._scrollBar.max,this._scrollBar.max=t,this._isAutoScroll&&e&&this.setScrollBarValue(t)},i.prototype.updateScrollMaxForce=function(){Laya.timer.frameOnce(4,this,this.scrollToMaxForce)},i.prototype.scrollToMaxForce=function(){var t=this.sumHeight>this._scrollHeight?this.sumHeight-(this._spaceY+this._scrollHeight):0;this._offset>t&&(this.offset=t),this._scrollBar.max=t,this._isAutoScroll&&this.setScrollBarValue(t)},Object.defineProperty(i.prototype,"isAutoScroll",{get:function(){return this._isAutoScroll},set:function(t){this._isAutoScroll=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollSize",{set:function(t){this._scrollSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"spaceY",{get:function(){return this._spaceY},set:function(t){this._spaceY=t,this.callLater(this.layoutAllItem)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollBar",{get:function(){return this._scrollBar},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"offset",{set:function(t){this._offset!=t&&(this._offset=t,this.refreshRender())},enumerable:!0,configurable:!0}),i.prototype.refreshRender=function(){this.setScrollBarValue(this._offset)},Object.defineProperty(i.prototype,"itemRender",{get:function(){return this._itemRender},set:function(t){this._itemRender=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"itemRenderWidth",{set:function(t){this._itemRenderWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"max",{get:function(){return this._max},set:function(t){this._max=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"useInitBuff",{get:function(){return this._useInitBuff},set:function(t){this._useInitBuff=t},enumerable:!0,configurable:!0}),i.prototype.setScrollChangeHandler=function(t,e){this._scrollChangeHandler=t,this._scrollChangeHandlerContext=e},i.prototype.onScrollBarChange=function(){for(var t=Math.round(this._scrollBar.value),e=0;e<this._items.length;e++){var i=this._items[e];this.setItemVisiable(i)}t!=this._offset&&(this.offset=t)},i.prototype.setItemVisiable=function(t){var e=Math.round(this._scrollBar.value),i=this._scrollHeight+e;t.y>=e&&t.y<=i?t.visible||(t.visible=!0):t.y>e?t.visible&&(t.visible=!1):e-t.y<t.height?t.visible||(t.visible=!0):t.visible&&(t.visible=!1)},i.prototype.onMouseWheel=function(t){var e=this._scrollBar.value-t.delta/Math.abs(t.delta)*this._scrollSize;this.setScrollBarValue(e)},i.prototype.setScrollBarValue=function(t){this._scrollChangeHandler&&this._scrollChangeHandler.apply(this._scrollChangeHandlerContext,[t,t>=this._scrollBar.value]),this._scrollBar.value=t},i.prototype.scrollBarTo=function(t){Laya.timer.frameOnce(2,this,this.setScrollBarValue,[t])},Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._array},set:function(t){this.removeAll(),this._array=t||[],this.callLater(this.initItems)},enumerable:!0,configurable:!0}),i.prototype.initItems=function(){this.sumHeight=0;for(var t=this._array.length,e=0;e<t;e++)this._useInitBuff?this.addItem(this._array[e]):this.addItemAt(this._array[e],e)},i.prototype.compearArry=function(t){for(var e=t.length,i=e-1;0<=i;i--)if(-1!=this._array.indexOf(t[i]))return i;return e},i.prototype.inster=function(t){var e=t.length;this._itemCount,e==this._max&&Math.min(this.compearArry(t),this._itemCount);for(var i=this._itemCount;i!=e;i++)this.addItemAt(t[i],i)},i.prototype.beginBuffRender=function(){!this._buffing&&0<this._buffList.length&&(this._buffing=!0,Laya.timer.frameLoop(2,this,this.exeBuffRender))},i.prototype.exeBuffRender=function(){if(this._buffing)for(var t=this._buffRenderSpeed;0<t;)if(t--,this.addItemAt(this._buffList.shift(),this._itemCount),this._buffList.length<=0)return void this.stopBuffRender()},i.prototype.stopBuffRender=function(){this._buffing=!1,Laya.timer.clear(this,this.exeBuffRender)},i.prototype.clearBuffRender=function(){this.stopBuffRender(),this._buffList.splice(0,this._buffList.length)},i.prototype.createItem=function(){var t;return this._buffRenderList.length?t=this._buffRenderList.pop():this._itemRender&&(t=new this._itemRender),t&&(this._itemsParent.addChild(t),0<this._itemRenderWidth&&(t.width=this._itemRenderWidth)),t.y=this.sumHeight,t.x=0,t},i.prototype.removeAll=function(){for(;0<this._itemCount;)this.removeItemAt(0);this.clearBuffRender(),this.scrollBar.value=0,this.scrollBar.max=0,this.sumHeight=0},i.prototype.removeItem=function(t){var e=this._array.indexOf(t);-1!=e?this.removeItemAt(e):this._buffRenderList.splice(this._buffRenderList.indexOf(t),1)},i.prototype.removeItemAt=function(t){var e=this._items[t];e&&(this._items.splice(t,1),e.removeSelf(),e.dataSource=null,this._buffRenderList.push(e),this._itemCount=this._items.length)},i.prototype.addItem=function(t){this._buffList.push(t),this.beginBuffRender()},i.prototype.addItemAt=function(t,e){var i=!1;0<this._max&&this._itemCount>=this._max&&(this.removeItemAt(0),i=!0),Math.round(this._scrollBar.value);var n=this.createItem();n.dataSource=t,this.sumHeight+=n.height+this._spaceY,this.setItemVisiable(n),this._items.splice(e,0,n),this._itemCount=this._items.length,i?this.callLater(this.layoutAllItem):this.updateScrollMax()},Object.defineProperty(i.prototype,"cells",{get:function(){return this._items},enumerable:!0,configurable:!0}),i.prototype.getCell=function(t){return this._items[t]},i);function i(t,e,i,n,o,a){void 0===n&&(n=0),void 0===o&&(o=2),void 0===a&&(a=!0);var r=s.call(this)||this;return r._itemRenderWidth=0,r._isAutoScroll=!1,r._scrollSize=8,r._offset=0,r._useInitBuff=!0,r._buffList=new Array,r._buffing=!1,r._buffRenderSpeed=2,r._scrollWidth=t,r._scrollHeight=e,r._max=n,r._buffRenderSpeed=o,r._useInitBuff=a,r.onCreate(),r}t.BuffRenderList=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=t.BuffRenderList,__extends(i,n),i.prototype.onCreate=function(){this.isAutoScroll=!1,n.prototype.onCreate.call(this),tl3d.ModuleEventManager.addEvent(a.SELECT_TAB,this.onSelect,this)},i.prototype.onSelect=function(t){for(var e=t.data,i=0,n=this._items.length;i<n;i++){var o=this._items[i];if(o==e){if(o.isShow&&o.isShow()){o.onHide&&o.onHide();break}o.onShow&&o.onShow(t.data)}else o.onHide&&o.onHide()}this.layoutAllItem()},i.prototype.onRemove=function(){n.prototype.onRemove.call(this),tl3d.ModuleEventManager.removeEvent(a.SELECT_TAB,this.onSelect,this)},i);function i(t,e){var i=n.call(this,t,e,null)||this;return i.useInitBuff=!1,i}t.Accordion=e;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SELECT_TAB="TREE_SELECT_TAB",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.TreeEvent=a}(common=common||{});var UserHeadVo=function(){function t(t,e,i,n){void 0===i&&(i=0),this._head=t,this._level=e,this._headFrame=i||0,this._guild=n}return t.prototype.getStyle=function(){return 0},t.prototype.getLevel=function(){return this._level?this._level:1},t.prototype.getQulity=function(){return""},t.prototype.getIconUrl=function(){return this._guild?SkinUtil.getGuildHeadIconById(this._head):SkinUtil.getHeroIcon(this._head)},t.prototype.getFrame=function(){return this._guild?null:0<this._headFrame?SkinUtil.getHeadFrame(this._headFrame):null},t.prototype.getImgLv=function(){return this._guild?SkinUtil.default_lv_frame:0<this._headFrame?SkinUtil.getLvFrame(this._headFrame):SkinUtil.default_lv_frame},t.prototype.setLevel=function(t){this._level=t},t.prototype.setHead=function(t){this._head=t},t.prototype.setHeadFrame=function(t){this._headFrame=t},t}(),TreasureItemVo=function(){function t(t){this.show=!1,this.isFirst=!1,this.startAction=!1,this.type=0,this.templateId=t.templateId?t.templateId:null,this.tbItem=tb.TB_item.get_TB_itemById(this.templateId)||t,this.tbItem||logerror("不存在该圣物：",this.templateId),this.slot=t.slot||this.tbItem.defined[0],this.godId=t.godId||null,this.quality=t.quality||this.tbItem.quality||1,this.starLv=t.starLv||0,this.strengthLv=t.strengthLv||0,this.num=t.num||0,this.show=!1,this.isFirst=!1,this.startAction=!1,this.clientUrl=null,this.type=0}return t.prototype.getExtParm=function(){return null},t.prototype.getTbStarup=function(){return this.quality<=tb.TB_treasure_set.getSet().star_quality?null:tb.TB_treasure_star.getTbItem(this.quality,this.slot,this.starLv)},t.prototype.getTbStrength=function(){return tb.TB_treasure.getTbItem(this.quality,this.slot,this.strengthLv)},t.prototype.getStrengthAttr=function(){return game.TreasureUtil.getTbStrengthAttr(this.quality,this.slot,this.strengthLv)},t.prototype.getStarAttr=function(){return game.TreasureUtil.getTbStarAttr(this.quality,this.slot,this.starLv)},t.prototype.isTopStarLv=function(){return!tb.TB_treasure_star.getTbItem(this.quality,this.slot,this.starLv+1)},t.prototype.isTopStrengthLv=function(){return!tb.TB_treasure.getTbItem(this.quality,this.slot,this.strengthLv+1)},t.prototype.isCanRebirth=function(){return!this.isExsitGod()&&this.quality>QualityConst.PURPLE&&(0<this.strengthLv||0<this.starLv)},t.prototype.isForbitStarup=function(){return this.quality<=tb.TB_treasure_set.getSet().star_quality},t.prototype.getNum=function(){return this.num},t.prototype.getStar=function(){return this.starLv},t.prototype.getShow=function(){return this.show},t.prototype.firstFlag=function(){return this.isFirst},t.prototype.isMoreThanSix=function(){return 5<this.starLv},t.prototype.getConstNum=function(){return 0},t.prototype.getStrengthLv=function(){return this.strengthLv},t.prototype.getRefineLevel=function(){return this.starLv},t.prototype.isStartAction=function(){return this.startAction},t.prototype.getQulity=function(){return SkinUtil.getBoxQulityIcon(this.quality)},t.prototype.getIconUrl=function(){return this.clientUrl?this.clientUrl:this.tbItem?SkinUtil.getItemIcon(this.tbItem):""},t.prototype.showRace=function(){return 0},t.prototype.isExsitGod=function(){return this.godId&&""!=this.godId},t.prototype.isChip=function(){return!(!this.tbItem||!this.tbItem.icon||1!=this.tbItem.icon[1])},t.prototype.getChipSkin=function(){return SkinUtil.chip_normal},t}();!function(t){var e;(e=t.RankSvrType||(t.RankSvrType={}))[e.common=0]="common",e[e.matchCrossSvr=1]="matchCrossSvr";var i=(n.prototype.setArrayTypeGroupCopyFloor=function(t,e){void 0===e&&(e=0),this.playerId=t[0],this.value=t[1],this.force=t[2],this.name=t[3],this.head=t[4],this.level=t[5],this.headFrame=t[6],this.rank=e},n.prototype.setArray=function(t,e){void 0===e&&(e=0),this.playerId=t[0],this.value=t[1],this.name=t[2],this.head=t[3],this.level=t[4],this.force=t[5],this.headFrame=t[6],this.rank=e},n.prototype.setSvo=function(t){this.playerId=t.playerId,this.name=t.name,this.head=t.head,this.headFrame=t.headFrame,this.level=t.level,this.force=t.force,this.value=t.value,this.rank=t.rank,this.guildName=t.guildName},n.prototype.getHeadVo=function(){return this._headVo||(this._headVo=new UserHeadVo(this.head,this.level,this.headFrame)),this._headVo},n.prototype.getRankUrl=function(){return SkinUtil.getRankingSkin(this.rank-1)},n.prototype.getMidDesc=function(){return LanMgr.getLan("",12082)},n.prototype.getMid=function(){return this.force},n.prototype.isShowMid=function(){return!!this.getMid()},n.prototype.getBottomDesc=function(){return LanMgr.getLan("",12083)},n.prototype.getBottom=function(){return this.guildName?this.guildName:LanMgr.getLan("",12084)},n.prototype.isShowBottom=function(){return!!this.guildName},n.prototype.getValue=function(){return this.value},n.prototype.getValueDesc=function(){return LanMgr.getLan("",12081)},n);function n(){}t.RankVo=i}(common=common||{});var ListVo=function(){function t(t){this.Zorder=UI_DEPATH_VALUE.TOP+1,this.initData(t)}return t.prototype.initData=function(t){this._dataSource=t._dataSource,this._repeatX=t._repeatX,this._repeatY=t._repeatY,this._spaceX=t._spaceX,this._spaceY=t._spaceY},t.prototype.setZorder=function(t){this.Zorder=t==UI_DEPATH_VALUE.ALERT?t:t+1},t.prototype.setPosition=function(t,e){this._x=t,this._y=e},t.prototype.setWidth=function(t){this._width=t},t.prototype.setHeight=function(t){this._height=t},t}(),LimitItemVo=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(h){function t(t,e,i,n,o,a,r,s){var u=h.call(this,i,n,o,a,r,s)||this;return u.limitTime=e,u.uuid=t,u}return __extends(t,h),t}(ItemVo)),GuildHeadVo=function(){function t(t,e){this._head=t,this._level=e}return t.prototype.getStyle=function(){return 1},t.prototype.getLevel=function(){return this._level?this._level:1},t.prototype.getQulity=function(){return""},t.prototype.getFrame=function(){return null},t.prototype.getImgLv=function(){return SkinUtil.default_lv_frame},t.prototype.getIconUrl=function(){return SkinUtil.getGuildHeadIconById(this._head)},t}(),GodSkillVo=function(){function t(){this.skillfile="0",this.selectFlag=!1,this.deathNum=0}return t.prototype.getLevel=function(){return this.tabskill1.getLevel()},t.prototype.getQulity=function(){return this.tabskill1.getQulity()},t.prototype.getIconUrl=function(){return this.tabskill1.getIconUrl()},t.prototype.triggerSkill=function(){logfight("触发技能：",this.tabskill1.ID,0==this.tabskill1.type?"被动":"主动"),this.trigger_count++,this.cd=0},t.prototype.settlementSkill=function(){this.cd=0<this.cd?this.cd-1:0},t}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n},GodItemVo=function(){function n(t){if(this.skinId=0,this.isAttackFight=!1,this.isDefendFight=!1,this.isYuanzhengFight=!1,this.selected=!1,this.dataType=0,this.fightPower=0,this.svrForce=0,this.sortNum=0,this.awakenLv=0,this.maxAwakenLv=0,this.maxTbLv=0,this.gemInfo={},this.gemsList=[],this.iSeverAttri=new Array,this.isAid=!1,t){this.templateId=t.templateId?t.templateId:t.ID,t.star?this.starLevel=t.star[0]:this.starLevel=t.starLevel,this.level=t.level?t.level:1,this.skinId=t.skinId?t.skinId:0,this.exp=t.exp?t.exp:0,this.degree=t.degree?t.degree:0,this.fuseLevel=t.fuseLevel?t.fuseLevel:1,this.awakenLv=t.awakenLv?t.awakenLv:0,this.fuseAttrLevels=t.fuseAttrLevels?t.fuseAttrLevels:{},this.local=[99999,99999,99999,99999];var e=this.tab_god?this.tab_god.star[1]:1;this.maxAwakenLv=tb.TB_awaken_conditions.getTbById(e).awake_section_max,this.maxTbLv=tb.TB_god_evolution.get_TB_god_evolutionById(e).level}else logerror("god item error :",t)}return n.getData=function(t,e){var i=new n(t);return i.tab_god=tb.TB_god.get_TB_godById(i.templateId),i.tab_god||logerror("英雄不存在",i.templateId),i.uuid=e,i},n.prototype.setgemInfo=function(t){if(this.gemInfo=t||{},this.gemsList=[],t)for(var e in t)if(t[e]){var i=game.GemstoneModel.getInstance().getGemstoneByUuid(t[e]);i||logerror("没有该宝石:",t[e]),this.gemsList.push(i)}},n.prototype.isExistGem=function(t){return!!this.gemInfo[t]},n.prototype.getGemsBySlot=function(t){var e=this.gemInfo[t];return e?this.gemsList.find(function(t){return t.uuid==e}):null},n.prototype.isStarupGod=function(){return 4<=this.starLevel},n.prototype.getName=function(){return this.getObjectData().name},n.prototype.getLevel=function(){return this.level},n.prototype.getLevelStr=function(){return this.levelStr},n.prototype.getDataType=function(){return this.dataType},n.prototype.getStar=function(){return this.starLevel},n.prototype.getRaceType=function(){return this.tab_god.race_type},n.prototype.getAttrType=function(){return this.tab_god.type},Object.defineProperty(n.prototype,"tab_god",{get:function(){return this._tab_god||(this._tab_god=tb.TB_god.get_TB_godById(this.templateId)),this._tab_god||logerror("god templateId undef : "+this.templateId),this._tab_god},set:function(t){this._tab_god=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"starUpTb",{get:function(){var t=game.GodUtils.getGodStarId(this.starLevel,this.templateId);return tb.TB_god_star.get_TB_god_starById(t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"costtab",{get:function(){return tb.TB_god_evolution.get_TB_god_evolutionById(this.starLevel)},enumerable:!0,configurable:!0}),n.prototype.getQulity=function(){return SkinUtil.getBoxQulityIcon(this.tab_god.quality+1)},n.prototype.getIconUrl=function(){return SkinUtil.getHeadIcon(this.tab_god.icon)},n.prototype.getFrameUrl=function(){var t=this.starLevel;return 6<t&&(t=6),SkinUtil.getBoxQulityIcon(t)},n.prototype.inLine=function(){for(var t=4,e=0;e<this.local.length;e++)if(99999!=this.local[e]){t=e;break}return t},n.prototype.isAwaken=function(){return this.awakenLv>=tb.TB_god_set.get_TB_god_set().awake_section},n.prototype.isMoreThanSix=function(){return 6<=this.starLevel},n.prototype.isInLinuep=function(t){void 0===t&&(t=0);var e=[],i=App.hero.lineupInfo,n=[];if(0==t)for(var o in i)Number(o)!=iface.tb_prop.lineupTypeKey.expedition&&(n=i[o]?i[o]:[],e.push.apply(e,n));else n=i[t]?i[t]:[],e.push.apply(e,n);return-1!=e.indexOf(this.uuid)},n.prototype.isEquipBySlot=function(t){return!!this.getEquipmentBySlot(t)},n.prototype.getEquipmentBySlot=function(e){return this.equipKeys.find(function(t){return Number(t.slot)==e})},n.prototype.isCanLvup=function(){var t=6==this.degree?this.starLevel:this.degree,e=tb.TB_god_evolution.get_TB_god_evolutionById(t).level,i=tb.TB_god_level.get_TB_god_levelnById(this.level);return this.level<e&&App.isEnoughByAry(i.cost)},n.prototype.isCanDegreeUp=function(){if(App.IsSysOpen(ModuleConst.SHENGJIE)){var t=6<=this.starLevel?6:this.starLevel;if(this.degree>=t)return!1;var e=tb.TB_god_evolution.get_TB_god_evolutionById(this.degree),i=e.level;return this.level==i&&App.isEnoughByAry(e.cost)&&0!=e.cost.length}},n.prototype.isCanWearTreasure=function(){if(App.IsSysOpen(ModuleConst.TREASURE))return 0==this.treasureKeys.length&&0<game.TreasureModel.getInstance().getTreasureChooseList(!1).length},n.prototype.isCanOneKeyEquip=function(){return 0!=game.EquipModel.getInstance().equipQiuck(this).length},n.prototype.hasStarUpCost=function(){var t=this.costtab.cost;return this.starLevel<6||6<=this.starLevel&&App.isEnoughByAry(t)},n.prototype.forbitStarUpTo7=function(){return 6==this.starLevel&&this.degree<6},n.prototype.isCanStarUp=function(t){return void 0===t&&(t=!1),!(!(App.IsSysOpen(ModuleConst.SHENGXING)&&this.starUpTb&&this.hasStarUpCost())||this.forbitStarUpTo7())&&game.GodUtils.isEnoughMaterial(this,this.starUpTb.getGodMaterialList(),t)},n.prototype.isCanAwaken=function(){if(!App.IsSysOpen(ModuleConst.JUEXING)||this.awakenLv>=this.maxAwakenLv)return!1;if(this.awakenLv>=this.getCurMaxAwakenLv())return!1;var t=tb.TB_god_awaken.getTbById(this.awakenLv);return App.isEnoughByAry(t.material)&&game.GodUtils.isEnoughMaterial(this,t.getGodMaterialList())},n.prototype.getObjectData=function(){return tb.TB_god.get_TB_godById(this.templateId)},n.prototype.canStarUp=function(){var t=game.GodUtils.getGodStarId(this.starLevel,this.templateId);return!!tb.TB_god_star.get_TB_god_starById(t)&&4<=this.starLevel&&this.starLevel<this.tab_god.star[1]},n.prototype.getStrengthNum=function(){var e=0;return this.equipKeys.forEach(function(t){e+=t.strengthLv}),e},n.prototype.isStrengthToLv=function(t,e){var i=0;return this.equipKeys.forEach(function(t){t.strengthLv>=e&&i++}),t<=i},n.prototype.getRefineNum=function(){var e=0;return this.equipKeys.forEach(function(t){e+=t.refineLv}),e},n.prototype.isRefineToLv=function(t,e){var i=0;return this.equipKeys.forEach(function(t){t.refineLv>=e&&i++}),t<=i},n.prototype.getStrengthLowLv=function(){if(0==this.equipKeys.length)return 0;var e=this.equipKeys[0].strengthLv;return this.equipKeys.forEach(function(t){t.strengthLv<e&&(e=t.strengthLv)}),e},n.prototype.getRefineLowLv=function(){if(0==this.equipKeys.length)return 0;var e=this.equipKeys[0].refineLv;return this.equipKeys.forEach(function(t){t.refineLv<e&&(e=t.refineLv)}),e},n.prototype.getQualityEquips=function(e){return this.equipKeys.filter(function(t){return t.quality==e})},n.prototype.isHaveLowEquip=function(e){var i=this;return this.equipKeys.some(function(t){return e==EquipTabType.strength?t.strengthLv<i.level:t.refineLv<tb.TB_equip_set.getRefineLimit(i.degree)})},n.prototype.getLowestEquipSlots=function(i){var t=__spreadArrays(this.equipKeys);t.sort(function(t,e){return i==EquipTabType.strength?t.strengthLv-e.strengthLv:t.refineLv-e.refineLv});for(var e=[],n=t[0]?i==EquipTabType.strength?t[0].strengthLv:t[0].refineLv:0,o=0;o<t.length;o++)(i==EquipTabType.strength&&t[o].strengthLv==n||i==EquipTabType.refine&&t[o].refineLv==n)&&e.push(t[o].slot);return e},n.prototype.getCanUpGradeEquips=function(i){var n=[],o=0==i?this.getRefineLowLv():this.getStrengthLowLv();return this.equipKeys.forEach(function(t){var e=0==i?t.refineLv:t.strengthLv;(0==i?t.isTopRefineLv():t.isTopStrengthLv())||e!=o||n.push(t)}),n},n.prototype.isAllEquipLvTop=function(t,e){var i;return t==EquipTabType.strength?e?(i=this.getEquipmentBySlot(e))&&i.isTopStrengthLv():0!=this.equipKeys.length&&this.equipKeys.every(function(t){return t.isTopStrengthLv()}):t==EquipTabType.refine&&(e?(i=this.getEquipmentBySlot(e))&&i.isTopRefineLv():0!=this.equipKeys.length&&this.equipKeys.every(function(t){return t.isTopRefineLv()}))},n.prototype.getRefineCost=function(t){void 0===t&&(t=1);var e={},i=this.getCanUpGradeEquips(0);for(var n in i){var o=i[n].getRefineCost(t);for(var a in o)e[a]?e[a]+=o[a]:e[a]=o[a]}return map2ary(e)},n.prototype.getStrengthCost=function(t){void 0===t&&(t=1);var e={},i=this.getCanUpGradeEquips(1);for(var n in i){var o=i[n].strengthCost(t);for(var a in o)e[a]?e[a]+=o[a]:e[a]=o[a]}return map2ary(e)},n.prototype.getCurLvAttriAndNext=function(i){var n=[],o=[],a=0==i?this.getRefineLowLv():this.getStrengthLowLv();this.equipKeys.forEach(function(t){var e=0==i?t.refineLv:t.strengthLv;(0==i?t.isTopRefineLv():t.isTopStrengthLv())||e!=a?o.push(t):n.push(t)});for(var t={},e={},r=0,s=n;r<s.length;r++){var u=s[r],h=0==i?u.getRefineAttr(1):u.getStrengthAttr(1);for(var l in h)e[l]=e[l]||0,e[l]+=Number(h[l]);for(var l in h=0==i?u.getRefineAttr(0):u.getStrengthAttr(0))t[l]=t[l]||0,t[l]+=Number(h[l])}for(var c=0,p=o;c<p.length;c++){u=p[c],h=0==i?u.getRefineAttr(0):u.getStrengthAttr(0);for(var l in h)t[l]=t[l]||0,t[l]+=Number(h[l]),e[l]=e[l]||0,e[l]+=Number(h[l])}var d=[];for(var _ in{1:0,2:0,3:0}){var f=e[_]||0;f=0==i?Math.round(1e4*f)/100+"%":f;var g=t[_]||0;g=0==i?Math.round(1e4*g)/100+"%":g,d.push([Number(_),g]),d.push([Number(_),f])}return d},n.prototype.getProperty=function(t,e,i){if(0<this.iSeverAttri.length)return this.iSeverAttri;var n,o=new Array,a=tb.TB_god.get_TB_godById(Number(this.templateId)),r=tb.TB_god_set.get_TB_god_set(),s=null==e?this.starLevel:e,u=null==t?this.level:t,h=null==i?this.degree:i;if(!(n=s<=r.star_evolution&&h<=r.star_evolution?tb.TB_god_evolution.get_TB_god_evolutionById(h):tb.TB_god_evolution.get_TB_god_evolutionById(s)))return logerror("tab error:",h,s),o;for(var l=0;l<=7;l++){var c=void 0;if(l<3){var p=n.star_prop[l][1],d=n.star_growth[l][1];c=Number(a.attr_init[l][1]*p+a.attr_grow[l][1]*d*(u-1))}else c=4<=l?100*Number(a.attr_init[l][1]):Number(a.attr_init[l][1]);o.push([l+1,c])}var _=tb.TB_god_awaken.getTbById(this.awakenLv);if(_)for(var f=0,g=_.attr;f<g.length;f++){var y=g[f];o[y[0]-1][1]+=y[1]}return o},n.prototype.getAttrValByKeyOnBaseAttr=function(t){for(var e=this.getProperty(),i=0;i<e.length;i++)if(Number(e[i][0])==t)return Number(e[i][1]);return 0},n.prototype.jisuanchushi=function(t,e){void 0===t&&(t=this.starLevel),void 0===e&&(e=this.level);for(var i=tb.TB_god.get_TB_godById(Number(this.templateId)),n=tb.TB_god_evolution.get_TB_god_evolutionById(t),o=new Array,a=0;a<3;a++){var r,s=n?n.star_prop[a][1]:1,u=n?n.star_growth[a][1]:1;r=Number(i.attr_init[a][1]*s+i.attr_grow[a][1]*u*(e-1)),o.push([a+1,r])}var h=tb.TB_god_awaken.getTbById(this.awakenLv);if(h)for(var l=0,c=h.attr;l<c.length;l++){var p=c[l],d=p[0]-1;o[d]||(o[d]=[]),o[d][1]+=p[1]}return o},n.prototype.jisuanjineng=function(){return tb.TB_god.get_TB_godById(Number(this.templateId)).getAllSkill(this.degree,this.getStar())},n.prototype.getSkillIdByDegree=function(t){for(var e=0,i=getSkillList(tb.TB_god.get_TB_godById(Number(this.templateId)).skill,t,this.getStar());e<i.length;e++){var n=i[e];if(n[1]==t)return n[0]}return 0},n.prototype.getEquipAttributes=function(){for(var t=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],e=0;e<this.equipKeys.length;e++){if(this.equipKeys[e]){var i=this.equipKeys[e].getStrengthAttr();for(var n in i)t[0][Number(n)-1]+=i[n]}}for(e=0;e<this.equipKeys.length;e++){if(this.equipKeys[e]){i=this.equipKeys[e].getRefineAttr();for(var n in i)t[1][Number(n)-1]+=i[n]}}for(var o=0,a=this.gemsList;o<a.length;o++){var r=a[o],s=r?r.tbGem:null;if(s){i=s.getAttr();for(var n in i)t[0][Number(n)-1]+=i[n]}}var u=this.getEquipSuit();for(var e in u)for(var h in u[e])t[e][h]+=u[e][h];return t},n.prototype.getEquipSuit=function(){var t={},e=this.equipKeys,i=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]];for(var n in e)t[e[n].quality]=0;for(var n in e)e[n].quality>=QualityConst.PURPLE&&t[e[n].quality]++;for(var n in t){var o=[];Number(n);if(t[n]>=EquipSuit.two){for(var a=EquipSuit.four;a>=EquipSuit.two;--a)a<=t[n]&&o.push(Number(n+a.toString()));for(var r in o){var s=tb.TB_equip_suit.get_TB_equip_suitById(o[r]);s?i[s.suit_percent[1]][s.suit_percent[0]-1]+=Number(s.suit_percent[2]):logerror("未找到Id("+o+")装备套装数据表")}}}return i},n.prototype.getAllAttr=function(t){for(var e,i,n=this.getProperty(),o=this.getJiachengAttr(t),a=game.GuildModel.getInstance().isHasGuild(),r=a?game.GuildSkillModel.getInstance().getCurSkillAttr(this.tab_god.type):null,s=this.isAttackFight?game.FateModel.getInstance().getCurFateAttr():null,u={},h=o[0],l=o[1],c=0;c<18;c++){var p=n[c]&&n[c][1]||0;if(c<4)i=u[e=String(n[c][0])]||0,u[e]=i+p+p*l[e]+h[e];else{var d=[c+1,0];n[c]&&(d=n[c]),i=u[e=String(d[0])]||0;var _=h[e]||0;u[e]=i+d[1]/100+_}this.isAttackFight&&s[c]&&(u[e]+=s[c][1]||0),a&&(u[e]+=p*(r[1][c+1]||0)+(r[0][c+1]||0))}var f=game.GodModel.getInstance().getRaceAdd(t);if(f)for(var g=0;g<f.length;g++)if(0<f[g]){var y=String(g);g<5?4==g||(u[y]*=1+f[g]):u[y]+=f[g]}return map2ary(u)},n.prototype.getFightAttr=function(t){for(var e={},i=0,n=this.getAllAttr(t);i<n.length;i++){var o=n[i];e[o[0]]=o[1]}return e},n.prototype.getPavSkillAttr=function(){for(var t=[],e=this.getSkillList(),i=0;i<e.length;i++){var n=e[i];this.degree>=n[1]&&t.push(n[0])}return modifyPasvAttr(t)},n.prototype.getPropertyValue=function(e){if(this.isAid){var t=game.YuanzhengModel.getInstance().getHelpItemByUuid(this.uuid);return t&&t.godInfo[3][1]}var i=this.getAllAttr().find(function(t){return t[0]==e});return i?i[1]:0},n.prototype.getJiachengAttr=function(t){void 0===t&&(t=1);for(var e={},i={},n=this.getEquipAttributes(),o=0;o<n.length;o++)for(var a=0;a<n[o].length;a++){var r=a+1;o==ValueType.fixed?this.modifyAttr(e,r,n[o][a]):this.modifyAttr(i,r,n[o][a])}var s=game.ArtifactModel.getArtAttr();if(s)for(o=0;o<s.length;o++)for(a=0;a<s[o].length;a++){r=a+1;o==ValueType.fixed?this.modifyAttr(e,r,s[o][a]):this.modifyAttr(i,r,s[o][a])}var u=game.ArtifactModel.getInstance().getBapAttri(this.tab_god.race_type,2);if(u)for(o=0;o<u.length;o++)for(a=0;a<u[o].length;a++){r=a+1;o==ValueType.fixed?this.modifyAttr(e,r,u[o][a]):this.modifyAttr(i,r,u[o][a])}var h=game.ArtifactModel.getInstance().getEnchantAtttri(null,0,!1,!0);if(h)for(o=0;o<h.length;o++)for(a=0;a<h[o].length;a++){r=a+1;o==ValueType.fixed?this.modifyAttr(e,r,h[o][a]):this.modifyAttr(i,r,h[o][a])}var l=this.getCurTreasure();if(l){var c={},p=l.getStrengthAttr();for(var d in p)for(var _ in c=p[d])Number(d)==ValueType.fixed?this.modifyAttr(e,_,c[_]):this.modifyAttr(i,_,c[_]);var f=l.getStarAttr();for(var g in f)for(var y in c=f[g])Number(g)==ValueType.fixed?this.modifyAttr(e,y,c[y]):this.modifyAttr(i,y,c[y])}if(this.tab_god.skin&&0<this.tab_god.skin.length)for(var m=0,v=this.tab_god.skin;m<v.length;m++){var b=v[m];if(-1!=App.hero.skinIds.indexOf(b)){var I=tb.TB_skin.getTbById(b).getAttr();for(var T in I){c=I[T];for(var _ in c)Number(T)==ValueType.fixed?this.modifyAttr(e,_,c[_]):this.modifyAttr(i,_,c[_])}}}var w=this.countRonghunAttr();for(var E in w)this.modifyAttr(e,E,w[E]);var C=game.ArtifactModel.getInstance().getStrengthAttr();if(C)for(var E in C)this.modifyAttr(e,E,C[E]);var S=this.getQianghuaDashi(this.countMasterLevel());if(S)for(var E in S)this.modifyAttr(e,E,S[E]);var L=this.getJinglianDashi(this.refineMasterLevel());if(L)for(var E in L)this.modifyAttr(e,E,L[E]);var x=this.getPavSkillAttr();return this.mergePavSkillAttr(x[0],e),this.mergePavSkillAttr(x[1],i),[e,i]},n.prototype.mergePavSkillAttr=function(t,e){if(!isEmptyObject(t))for(var i in t)this.modifyAttr(e,i,t[i])},n.prototype.modifyAttr=function(t,e,i){t.hasOwnProperty(e)||(t[e]=0),t[e]+=i},n.prototype.getQianghuaDashi=function(t){var e;0<t&&(e=tb.TB_strength_suit.get_TB_strength_suitById(t).getAttr());return e},n.prototype.getJinglianDashi=function(t){var e;0<t&&(e=tb.TB_refine_suit.get_TB_refine_suitById(t).getAttr());return e},n.prototype.countMasterLevel=function(){var t=this.equipKeys,e=0;if(t.length>=game.EquipModel.EQUIP_COUNT){e=t[0].strengthLv;for(var i=0,n=t;i<n.length;i++){var o=n[i];o.strengthLv<e&&(e=o.strengthLv)}var a=tb.TB_strength_suit.get_TB_strength_suitByLv(e);e=a?a.ID:0}return e},n.prototype.refineMasterLevel=function(){var t=this.equipKeys,e=0;if(t.length>=game.EquipModel.EQUIP_COUNT){e=t[0].refineLv;for(var i=0,n=t;i<n.length;i++){var o=n[i];o.refineLv<e&&(e=o.refineLv)}var a=tb.TB_refine_suit.get_TB_refine_suitByLv(e);e=a?a.ID:0}return e},n.prototype.getShenli=function(t){return void 0===t&&(t=iface.tb_prop.lineupTypeKey.attack),getForce(this.getFightAttr(t),this.tab_god.quality)},n.prototype.countRonghunAttr=function(){for(var t=tb.TB_fusion_soul.get_TB_fusion_soulById(this.fuseLevel),e={},i=1;i<4;i++){var n=this.fuseAttrLevels[i];if(n){var o=tb.TB_fusion_soul.get_TB_fusion_soulById(this.fuseLevel-1),a=(o?o.getMaxAttr(i):0)+(n-(o?o.getMaxLv(i):0))*t.getOnceAdd(i);a=a>t.getMaxAttr(i)?t.getMaxAttr(i):a,e[i]=a}else e[i]=0}return e[Number(t.special_attr[0][0])]=Number(t.special_attr[0][1]),e},n.prototype.isRonghunMax=function(){for(var t=tb.TB_fusion_soul.get_TB_fusion_soulById(this.fuseLevel),e=this.countRonghunAttr(),i=!0,n=0;n<3;n++)if(t.attr_max[n][1]>e[n+1]){i=!1;break}return i},n.prototype.getEquipItems=function(){for(var t=[],e=0,i=this.equipKeys;e<i.length;e++){var n=i[e];t.push(n.uuid)}return t},n.prototype.isActivitySkill=function(t){for(var e=0,i=this.tab_god.skill;e<i.length;e++){var n=i[e];if(n[0]==t)return this.degree>=n[1]}return!1},n.prototype.getSkillList=function(){return getSkillList(this.tab_god.skill,this.degree,this.getStar())},n.prototype.getCurMaxAwakenLv=function(){return tb.TB_awaken_conditions.getTbById(this.starLevel).awake_section_max},n.prototype.getModel=function(){return game.GodUtils.getGodModel(this.skinId,this.tab_god)},n.prototype.getMaxQualityAnNum=function(){for(var t=0,e=0,i=0,n=0,o=this.equipKeys;n<o.length;n++){var a=o[n].tab_item.quality;a==QualityConst.PURPLE?t++:a==QualityConst.ORANGE?e++:a==QualityConst.RED&&i++}return 2<=i?[QualityConst.RED,i]:2<=e?[QualityConst.ORANGE,e]:2<=t?[QualityConst.PURPLE,t]:[]},n.prototype.getTreasureVo=function(e){return this.treasureKeys.find(function(t){return t.uuid==e})},n.prototype.getCurTreasure=function(){return this.treasureKeys[0]},n}(),GodBuffVo=function(){this.shieldnum=0},GemstoneItemVo=function(){function t(){this.show=!1,this.isFirst=!1,this.startAction=!1,this.show=!1,this.isFirst=!1,this.startAction=!1,this.clientUrl=null}return t.prototype.getExtParm=function(){return null},t.prototype.setData=function(t){this.templateId=t.templateId?t.templateId:null,this.tbItem=tb.TB_item.get_TB_itemById(this.templateId)||t,this.tbItem||logerror("道具表不存在该宝石：",this.templateId),this.tbItem.show=!1,this.tbItem.showNum=!1,this.tbGem=tb.TB_gemstone_new.getTBOneById(this.tbItem.defined[0]),this.tbGem||logerror("宝石等级属性表不存在该宝石：",this.tbItem.defined[0]),this.gemType=this.tbGem.getType(),this.quality=t.quality||this.tbItem.quality||1,this.gemLv=this.tbGem.getLevel(),this.num=t.num||0,this.godId=t.godId||null},t.prototype.getNum=function(){return this.num},t.prototype.getStar=function(){return 0},t.prototype.getShow=function(){return this.show},t.prototype.firstFlag=function(){return this.isFirst},t.prototype.isMoreThanSix=function(){return!1},t.prototype.getConstNum=function(){return 0},t.prototype.getStrengthLv=function(){return this.gemLv},t.prototype.getRefineLevel=function(){return 0},t.prototype.isStartAction=function(){return this.startAction},t.prototype.getQulity=function(){return SkinUtil.getBoxQulityIcon(this.quality)},t.prototype.getIconUrl=function(){return this.clientUrl?this.clientUrl:this.tbItem?SkinUtil.getItemIcon(this.tbItem):""},t.prototype.showRace=function(){return 0},t.prototype.isExsitGod=function(){return this.godId&&""!=this.godId},t.prototype.isChip=function(){return!!this.tbItem&&this.tbItem.isChip()},t.prototype.getChipSkin=function(){return SkinUtil.chip_normal},t}(),EquipItemVo=function(){function t(t){this.bag=!1,this.show=!1,this.isFirst=!1,this.isAni=!1,this.startAction=!1,this.updateData(t)}return t.prototype.getExtParm=function(){return null},t.prototype.updateData=function(t){this.type=0,this.slot=t.slot?t.slot:0,this.godId=t.godId?t.godId:null,this.quality=t.quality?t.quality:1,this.refineLv=t.refineLv?t.refineLv:0,this.refineExp=t.refineExp?t.refineExp:0,this.strengthLv=t.strengthLv?t.strengthLv:0,this.templateId=t.templateId?t.templateId:null,this.tab_item=tb.TB_item.get_TB_itemById(this.templateId)?tb.TB_item.get_TB_itemById(this.templateId):t,this.refineId=1e4*this.quality+1e3*this.tab_item.defined[0]+this.refineLv,this.strengthId=1e4*this.quality+1e3*this.tab_item.defined[0]+this.strengthLv},t.prototype.getNum=function(){return this.strengthLv},t.prototype.getStar=function(){return 0},t.prototype.getShow=function(){return this.show},t.prototype.firstFlag=function(){return this.isFirst},t.prototype.isMoreThanSix=function(){return!1},t.prototype.getcurRefineExp=function(){return this.refineExp},t.prototype.getConstNum=function(){return 0},t.prototype.getStrengthLv=function(){return this.strengthLv},t.prototype.getRefineLevel=function(){return this.refineLv},t.prototype.isStartAction=function(){return this.startAction},t.prototype.getQulity=function(){return SkinUtil.getBoxQulityIcon(this.tab_item.quality)},t.prototype.getIconUrl=function(){return this.tab_item?SkinUtil.getEquipIcon(this.tab_item.icon[0]):""},t.prototype.showRace=function(){return this.tab_item.icon[2]?this.tab_item.icon[2]:0},t.prototype.isExsitGod=function(){return this.godId&&""!=this.godId},t.prototype.getGodName=function(){if(this.godId){var t=App.hero.getGodVoById(this.godId).getName();return t||null}return null},t.prototype.getSortNum=function(){return 1e6*this.quality+100*this.strengthLv+this.refineLv},t.prototype.getWearGodName=function(){return this.getGodName()?LanMgr.getLan("",12085,this.getGodName()):""},t.prototype.isTopRefineLv=function(){var t=tb.TB_equip_set.get_TB_equip_setById(1).refine_maxlevel;return this.refineLv>=t},t.prototype.isTopStrengthLv=function(){var t=tb.TB_equip_set.get_TB_equip_setById(1).strength_maxlevel;return this.strengthLv>=t},t.prototype.getStrengthAttr=function(t){void 0===t&&(t=0);var e=tb.TB_equip_strength.get_TB_equip_strengthById(this.strengthId+t);return e?e.getAttr():{}},t.prototype.getRefineAttr=function(t){void 0===t&&(t=0);var e=tb.TB_equip_refine.get_TB_equip_refineById(this.refineId+t);return e?e.getAttr():{}},t.prototype.getAttributeByValue=function(t,e){void 0===e&&(e=0);var i=LanMgr.attrName,n=0==t?this.getRefineAttr(e):this.getStrengthAttr(e),o=[];for(var a in n){var r=LanMgr.getLan(i[Number(a)],-1),s=0==t?r+"+"+Math.round(1e4*n[a])/100+"%":r+"+"+n[a];o.push(s)}return o},t.prototype.getEquipAllSuitArray=function(){var t=[];if(this.quality>=QualityConst.PURPLE)for(var e=EquipSuit.two;e<=EquipSuit.four;e+=1){var i=tb.TB_equip_suit.get_TB_equip_suitById(Number(this.quality.toString()+e.toString()));t.push(i)}return t},t.prototype.strengthCost=function(t){void 0===t&&(t=1);var e=game.EquipModel.getInstance().tbEquipSet.strength_maxlevel;t=this.strengthLv+t>e?e-this.strengthLv:t;var i=tb.TB_equip_strength.get_TB_equip_strengthById(this.strengthId+t).total_cost,n=tb.TB_equip_strength.get_TB_equip_strengthById(this.strengthId).total_cost,o=ary2map(i),a=ary2map(n);for(var r in o)a&&a[r]&&(o[r]-=a[r]);return o},t.prototype.getRefineCost=function(t){void 0===t&&(t=1);var e=game.EquipModel.getInstance().tbEquipSet.refine_maxlevel;t=this.refineLv+t>e?e-this.refineLv:t;var i=tb.TB_equip_refine.get_TB_equip_refineById(this.refineId+t).total_cost,n=tb.TB_equip_refine.get_TB_equip_refineById(this.refineId).total_cost,o=ary2map(i),a=ary2map(n);for(var r in o)a&&a[r]&&(o[r]-=a[r]);return o},t.prototype.getCanRefineNum=function(){for(var t=game.EquipModel.getInstance().tbEquipSet.refine_maxlevel,e=1;e<=t;e++){var i=this.getRefineCost(e);for(var n in i)if(i[n]>App.hero.getBagItemNum(n))return e-1}return t},t.prototype.isChip=function(){return!(!this.tab_item.icon[1]||1!=this.tab_item.icon[1])},t.prototype.getChipSkin=function(){return SkinUtil.chip_normal},t}(),AwardRankData=function(){function t(t,e,i){this.rank=t,this.rankStr=e,this.rewardList=i}return t.prototype.getRank=function(){return this.rank},t.prototype.getRankStr=function(){return this.rankStr},t.prototype.getRankSkin=function(){return this.rank<=3?SkinUtil.getRankingSkin(this.rank-1):""},t.prototype.getRewardList=function(){return this.rewardList},t}(),ArtifactItemVo=function(){function t(t){this.exp=0,this.starLv=0,this.skillLv=1,this.baptizeLv=1,this.baptizeExp=0,this.strengthLv=0,this.baptizeAttrs={},this.tmpBaptizeAttrs={},this.ID=t}return t.prototype.getExtParm=function(){return null},t.prototype.getNum=function(){return 0},t.prototype.getStar=function(){return 0},t.prototype.getShow=function(){return!1},t.prototype.showRace=function(){return 0},t.prototype.firstFlag=function(){return!1},t.prototype.isChip=function(){return!1},t.prototype.getConstNum=function(){return 0},t.prototype.isStartAction=function(){return!1},t.prototype.isMoreThanSix=function(){return!1},t.prototype.getQulity=function(){return SkinUtil.getBoxQulityIcon(5)},t.prototype.getIconUrl=function(){return this.tbArtifact?SkinUtil.getEquipIcon(this.tbArtifact.icon):""},Object.defineProperty(t.prototype,"enchantNum",{get:function(){return this.exp/this.tbSet.enchant_plan},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillId",{get:function(){return 1e3*this.ID+this.skillLv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tbSet",{get:function(){return tb.TB_artifact_set.get_TB_artifact_setById()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tbSkill",{get:function(){return tb.TB_skill.get_TB_skillById(this.tbArtifactSkill.skill)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tbArtifactSkill",{get:function(){return tb.TB_artifact_skill.get_TB_artifact_skillById(this.skillId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enchantId",{get:function(){return 100*this.ID+this.starLv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tbArtifact",{get:function(){return tb.TB_artifact.get_TB_artifactById(this.ID)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tbArtifactEnchant",{get:function(){return tb.TB_artifact_enchant.get_TB_artifact_enchantById(this.enchantId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strengthId",{get:function(){return 1e3*this.ID+this.strengthLv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tbArtifactStrength",{get:function(){return tb.TB_artifact_strength.get_TB_artifact_strengthById(this.strengthId)},enumerable:!0,configurable:!0}),t.prototype.isYiJieSuo=function(){return App.hero.artifactInfo.hasOwnProperty(this.ID)},t.prototype.isWearByType=function(t){return App.hero.lineupArtifactInfo.hasOwnProperty(t)&&App.hero.lineupArtifactInfo[t]==this.ID},t.prototype.isWear=function(){for(var t=1;t<4;t++)if(this.isWearByType(t))return!0;return!1},t.prototype.isCanJieSuo=function(){var t=this.tbArtifact.cost;return t&&App.hero.getBagItemNum(t[0][0])>=t[0][1]&&!this.isYiJieSuo()},t.prototype.isCanEnchant=function(){return App.hero.getBagItemNum(this.tbArtifactEnchant.cost[0])>=this.tbArtifactEnchant.cost[1]},t.prototype.isCanStrengh=function(){var t=tb.TB_artifact_set.get_TB_artifact_setById();if(this.strengthLv>=t.max_strength_level)return!1;var e=this.tbArtifactStrength.cost;return App.hero.getBagItemNum(e[0][0])>=e[0][1]&&this.isYiJieSuo()&&this.strengthLv<t.max_strength_level},t.prototype.isCanSkillUp=function(){var t=tb.TB_artifact_set.get_TB_artifact_setById();return this.skillLv,t.max_skill_level,!1},t.prototype.isCanBaptize=function(t){return!(1<App.hero.welfare.loginCount)&&(t==Artifact.PBAPTIZE?App.hero.getBagItemNum(this.tbSet.general_baptize[0][0])>=this.tbSet.general_baptize[0][1]:App.hero.getBagItemNum(this.tbSet.rare_baptize[0][0])>=this.tbSet.rare_baptize[0][1])},t.prototype.getSortNum=function(t){if(t&&this.isWearByType(t))return 0;if(!t&&this.isWear())return 0;if(this.isYiJieSuo())return t?1:3;var e=this.tbArtifact.cost,i=App.hero.getBagItemNum(e[0][0]);return!t&&i>=e[0][1]?2:4},t}();!function(t){var e=(i.prototype.initPage=function(t){},i.prototype.initState=function(){},i.prototype.addlist=function(t,e){-1==t.indexOf(e)&&t.push(e)},i.prototype.getPreloadIds=function(){return{roles:[],skills:[]}},i.prototype.getWaveNum=function(){return 0},i.prototype.getWaveObj=function(){return this.waveObj[this.curwave]},i.prototype.getTitle=function(){return""},i.prototype.getNextRound=function(t){return void 0===t&&(t=!1),null},i.prototype.setAuto=function(t){this.auto=t},i.prototype.selectSkillFight=function(t){},i.prototype.getResult=function(){return playState.FAILURE},i.prototype.quickFight=function(){this.isQuick=!0},i.prototype.getLossHpObj=function(){return{}},i.prototype.getMaxHpObj=function(){return{}},i.prototype.clonePage=function(t){return null},i.prototype.onDestroy=function(){},i);function i(){this.isQuick=!1,this.waveObj={}}t.FightPage=e}(game=game||{}),function(l){var t=(e.prototype.init=function(t,e,i,n,o){var a;this.atkInfos=t||[],this.defInfos=e||[],this.maxRound=n,this.initHpObjs=o||{},this.defType=i;var r=l.BatteConsts.BATTLE_CAMPATK;for(a=0;a<this.atkInfos.length;a++){var s=this.waveResults[r]=this.waveResults[r]||[];s[a]=s[a]||0}for(r=l.BatteConsts.BATTLE_CAMPDEF,a=0;a<this.defInfos.length;a++){var u=this.waveResults[r]=this.waveResults[r]||[];u[a]=u[a]||0}logfight("battle init. waveResults %j",this.waveResults)},e.prototype.getWave=function(){return this.defInfos.length},e.prototype.getDefInfos=function(){return this.defInfos},e.prototype.getAtkInfos=function(){return this.atkInfos},e.prototype.getLineupInfo=function(t){var e=null;switch(t){case l.BatteConsts.BATTLE_CAMPATK:e=this.atkInfos[this.getCampWave(t)-1];break;case l.BatteConsts.BATTLE_CAMPDEF:e=this.defInfos[this.getCampWave(t)-1]}return e},e.prototype.getCampWave=function(t){return this.campWaves[t]||1},e.prototype.addWave=function(){if(0!==this.winCamp){var t=getOppoCamp(this.winCamp);this.campWaves[t]=this.campWaves[t]||1,this.campWaves[t]++,this.wave++,this.isNewWave=!0}},e.prototype.createPlayerData=function(t){var e=this.getLineupInfo(t);if(e){var i=this.createBattleGods(t,e[0],iface.tb_prop.battleObjTypeKey.god),n={objs:i,artifact:this.createBattleArtifact(t,e[1])};for(var o in this.campDatas[t]=n,i){var a=i[o],r=a.idx,s=100*a.camp+r,u=isEmptyObject(this.initHpObjs)?-1:this.initHpObjs.hasOwnProperty(s)?this.initHpObjs[s]:-1;a.afterCreate(u)}}},e.prototype.createBattleGods=function(t,e,i){if(!e||e.length<=0)return{};for(var n={},o=0;o<e.length;o++){var a=e[o];if(a){var r=o+1,s=100*t+r,u=isEmptyObject(this.initHpObjs)?-1:this.initHpObjs.hasOwnProperty(s)?this.initHpObjs[s]:-1,h=void 0;(h=i==iface.tb_prop.battleObjTypeKey.monster?new l.BattleMonster(t,r,a):new l.BattleGod(t,r,a)).onCreate(this,u),n[o]=h}}return n},e.prototype.createBattleArtifact=function(t,e){if(!e||e.length<=0)return null;var i=new l.BattleArtifact(t,e);return i.onCreate(this),i},e.prototype.createMonsterData=function(t){var e=this.getLineupInfo(t);if(!e||e.length<=0)return{};var i=this.createBattleGods(t,e[0],iface.tb_prop.battleObjTypeKey.monster),n={objs:i,artifact:this.createBattleArtifact(t,e[1])};for(var o in this.campDatas[t]=n,i){var a=i[o],r=a.idx,s=100*a.camp+r,u=isEmptyObject(this.initHpObjs)?-1:this.initHpObjs.hasOwnProperty(s)?this.initHpObjs[s]:-1;a.afterCreate(u)}},e.prototype.getCampData=function(t){return this.campDatas[t]},e.prototype.getCampObjs=function(t){var e=this.campDatas[t];return e?e.objs:{}},e.prototype.getCampRowObjs=function(t,e,i){var n={},o=this.campDatas[t];if(o){var a=o.objs;for(var r in a){var s=a[r];s.row==e&&(i?s.isAlive()&&(n[r]=s):n[r]=s)}}return n},e.prototype.getCampArtifact=function(t){var e=this.campDatas[t];return e?e.artifact:null},e.prototype.getLossHpObj=function(t){void 0===t&&(t=-1);var e={};if(-1==t){var i=this.campDatas;for(var n in i){var o=i[n].objs;for(var a in o)e[(s=o[a]).getObjId()]=Math.floor(s.getLossHp())}}else{var r=this.getCampObjs(t);for(var a in r){var s;e[(s=r[a]).getObjId()]=Math.floor(s.getLossHp())}}return e},e.prototype.getMaxHpObj=function(){var t={},e=this.campDatas;for(var i in e){var n=e[i].objs;for(var o in n){var a=n[o];t[a.getObjId()]=a.hpMax}}return t},e.prototype.start=function(){this.onBattleStart(),this.battleLoop()},e.prototype.onBattleStart=function(){this.createAtkData(),this.createDefData()},e.prototype.battleLoop=function(){for(;!this.checkBattleEnd();)this.nextWave();this.battleEnd()},e.prototype.checkBattleEnd=function(){if(0===this.winCamp)return!1;var t=getOppoCamp(this.winCamp);return!this.getLineupInfo(t)},e.prototype.nextWave=function(){this.onWaveStart(),this.waveLoop(),this.addWave()},e.prototype.onWaveStart=function(){if(this.round=0,(this.showRound=0)<this.winCamp){var t=getOppoCamp(this.winCamp);t===l.BatteConsts.BATTLE_CAMPATK?this.createAtkData():t===l.BatteConsts.BATTLE_CAMPDEF&&this.createDefData()}for(var e in this.winCamp=0,this.campDatas){var i=this.campDatas[e],n=i.objs;for(var o in n)n[o].onWaveStart();var a=i.artifact;a&&a.onWaveStart()}},e.prototype.createAtkData=function(){logfight("createAtkData"),this.createPlayerData(l.BatteConsts.BATTLE_CAMPATK)},e.prototype.createDefData=function(){logfight("createDefData"),this.defType!==iface.tb_prop.battleObjTypeKey.monster?this.createPlayerData(l.BatteConsts.BATTLE_CAMPDEF):this.createMonsterData(l.BatteConsts.BATTLE_CAMPDEF)},e.prototype.waveLoop=function(){for(;!this.checkWaveEnd();)this.roundLoop();this.statWaveResults()},e.prototype.roundLoop=function(){for(this.roundStart();!this.checkRoundEnd()&&!this.checkResult();)this.nextRound();this.checkRoundEnd()&&(logfight(" roundEnd "),this.roundEnd())},e.prototype.roundStart=function(){this._atkList||(this._atkList=[]),this._atkList.length<=0&&(this.showRound++,this._atkList=this.getAtkList()),this.roundStartTrigger()},e.prototype.roundStartTrigger=function(){for(var t in this.round++,this.recordStartRound(),this.campDatas){var e=this.campDatas[t].objs;for(var i in e)(n=e[i]).doBuffTrigger(iface.tb_prop.buffTrigTypeKey.bigRoundBefore)}for(var t in this.campDatas)for(var i in e=this.campDatas[t].objs){var n;(n=e[i]).isAlive()&&n.doPasvSkill(iface.tb_prop.triggerTypeKey.roundBefore)}},e.prototype.roundEnd=function(){},e.prototype.checkRoundEnd=function(){var t=this.getStrikeBackObj();return!t&&!this.getAngerFullAtft()&&!(t=this.getRampageObj())&&this._atkList.length<=0},e.prototype.statWaveResults=function(){var t=this.waveResults[this.winCamp];if(t){var e=this.getCampWave(this.winCamp)-1;t[e]=t[e]||0,t[e]++}},e.prototype.checkWaveEnd=function(){return!!this.checkResult()||!!this.checkMaxRound()&&(this.winCamp=this.calWinCamp(),!0)},e.prototype.checkResult=function(){return this.isAllDead(l.BatteConsts.BATTLE_CAMPATK)?(this.winCamp=l.BatteConsts.BATTLE_CAMPDEF,logfight("atk All Dead"),!0):!!this.isAllDead(l.BatteConsts.BATTLE_CAMPDEF)&&(this.winCamp=l.BatteConsts.BATTLE_CAMPATK,logfight("def All Dead"),!0)},e.prototype.checkMaxRound=function(){return this.showRound>=this.maxRound},e.prototype.calWinCamp=function(){return l.BatteConsts.BATTLE_CAMPDEF},e.prototype.isAllDead=function(t){var e=this.campDatas[t];if(!e)return!0;var i=e.objs;for(var n in i)if(i[n].isAlive())return!1;return!0},e.prototype.nextRound=function(){this.round++,this.isBackAtk=!1;var t=this.getStrikeBackObj();if(t)return this.isBackAtk=!0,logfight("strikeBack %s",this.curObj=t),void t.startStrikeBack();var e=this.getAngerFullAtft();return e?(this.curObj=e,logfight("artifact round %s",this.curObj),void e.startRound()):(t=this.getRampageObj())?(this.curObj=t,logfight("Rampage round %s",this.curObj),void t.startRound(!0)):void((t=this.getNextAtk())&&(this.curObj=t,logfight("normal round %s",this.curObj),t.startRound(!1)))},e.prototype.deadOpt=function(){for(var t in this.campDatas){var e=this.campDatas[t].objs;for(var i in e)e[i].onDeadEnd()}},e.prototype.teamMateDeadOpt=function(t,e){var i=this.campDatas[t.camp].objs;for(var n in i){var o=i[n];o.isAlive()&&t.getObjId()!==o.getObjId()&&o.doPasvSkill(iface.tb_prop.triggerTypeKey.ownDead,null,e)}},e.prototype.getAtkList=function(){var t=[];for(var e in this.campDatas){var i=this.campDatas[e].objs;for(var n in i){var o=i[n];o.isAlive()&&t.push(o)}}return t},e.prototype.getNextAtk=function(){return!this._atkList||this._atkList.length<=0?null:(this._atkList.sort(this.speedRank),this._atkList.shift())},e.prototype.speedRank=function(t,e){return t.atkSpd===e.atkSpd?t.idx-e.idx:e.atkSpd-t.atkSpd},e.prototype.removeAtkItem=function(t){logyhj("死亡选手：",t);var e=this._atkList.indexOf(t);-1!=e&&(logyhj("剔除死亡选手：",e),this._atkList.splice(e,1))},e.prototype.getStrikeBackObj=function(){var t=[];for(var e in this.campDatas){var i=this.campDatas[e].objs;for(var n in i){var o=i[n];o.isAlive()&&o.stBackTarget&&t.push(o)}}if(t.length<=0)return null;t.sort(this.strikeBackRank);var a=t[0];return logfight("strikeBack!!!! %s",a.getObjId()),a},e.prototype.getAngerFullAtft=function(){var t=[];for(var e in this.campDatas){var i=this.campDatas[e].artifact;i&&i.isAngerFull()&&t.push(i)}if(t.length<=0)return null;t.sort(this.artifactRank);var n=t[0];return logfight("atft Anger Full!!!! camp: %s",n.camp),n},e.prototype.getRampageObj=function(){var t=[];for(var e in this.campDatas){var i=this.campDatas[e].objs;for(var n in i){var o=i[n];if(o.isAlive()&&o.getRoundFlag){if(o.getObjId()===this.lastObjId)return o;t.push(o)}}}if(t.length<=0)return null;t.sort(this.rampageRank);var a=t[0];return logfight("rampage!!!! %s",a.getObjId()),a},e.prototype.atkBarRank=function(t,e){return 0},e.prototype.strikeBackRank=function(t,e){return t.idx-e.idx},e.prototype.artifactRank=function(t,e){return e.camp===Number(this.lastObjId/10)?-1:1},e.prototype.rampageRank=function(t,e){return t.camp!==e.camp?e.camp===Number(this.lastObjId/10)?-1:1:t.idx-e.idx},e.prototype.recordOperate=function(t,e){var i=this.battleReport[this.wave]=this.battleReport[this.wave]||{},n=i[this.round]=i[this.round]||{};(n[t=t||0]=n[t]||[]).push(e)},e.prototype.checkPasvSkillRecord=function(t,e){if(t===e)return!1;var i=this.battleReport[this.wave];if(!i)return!1;var n=i[this.round];if(!n)return!1;if(!n[t]||n[t].length<=0)return!1;var o=n[e];if(o)for(var a=0;a<o.length;a++){var r=o[a];if(r.type===iface.tb_prop.battleOpTypeKey.trigPasvSkill&&r.skillId===t)return!1}return!0},e.prototype.genBuffInstId=function(){return this.buffInstId++},e.prototype.doCampPasvSkill=function(t,e,i,n){var o=this.campDatas[t];if(o){var a=o.objs;for(var r in a){var s=a[r];s.isAlive()&&s.doPasvSkill(e,i,n)}}},e.prototype.clearCampShareBuffByCaster=function(t,e,i){var n=this.campDatas[t];if(n){var o=n.objs;for(var a in o){var r=o[a];r.isAlive()&&r.clearShareBuffByCaster(e,i)}}},e.prototype.clearCampSneerBuffByCaster=function(t,e,i){var n=this.campDatas[t];if(n){var o=n.objs;for(var a in o){var r=o[a];r.isAlive()&&r.clearSneerBuffByCaster(e,i)}}},e.prototype.battleEnd=function(){logfight("battle end. winCamp %d report %j",this.winCamp,this.battleReport)},e.prototype.getObjById=function(t){for(var e in this.campDatas){var i=this.campDatas[e].objs;for(var n in i){var o=i[n];if(o.getObjId()===t)return o}}return null},e.prototype.getCampByObjid=function(t){var e=this.getObjById(t);return e?e.camp:l.BatteConsts.BATTLE_CAMPATK},e.prototype.onAddBuffBefore=function(t,e,i,n){for(var o in this.campDatas){var a=this.campDatas[o].objs;for(var r in a){var s=a[r];s.isAlive()&&s.doPasvSkill(iface.tb_prop.triggerTypeKey.addBuff,e,n,{tempBuff:t})}}},e.prototype.recordStartRound=function(){var t={type:iface.tb_prop.battleOpTypeKey.nextRound,round:this.showRound};this.recordOperate(0,t)},e);function e(t){this.waveResults={},this.type=t,this.campDatas={},this.atkInfos=[],this.defInfos=[],this.defType=null,this.campWaves={},this.wave=1,this.isNewWave=!0,this.round=0,this.showRound=0,this.winCamp=0,this.lastObjId=0,this.buffInstId=0,this.isInit=!1,this.battleReport={},this._atkList=[]}l.BattleScene=t}(battle=battle||{}),function(r){var t=(e.prototype.initSkillDatas=function(t){if(!t||t.length<=0)return null;for(var e=0;e<t.length;e++){var i=t[e],n=new r.SkillData(i);n.isPassive()?this.pasvSkills[i]=n:(this.skills[i]=n).isAnger()?this.skillag=n:this.skillpt=n}},e.prototype.getObjId=function(){return 10*this.camp+this.idx},e.prototype.isArtifact=function(){return!1},e.prototype.onCreate=function(t,e){this.scene=t,this.updateAttrs(0,!0,!0),this.anger+=this.getBaseAttr(iface.tb_prop.attrTypeKey.anger),this.setInitHp(e),this.recordObjInit()},e.prototype.initCaptainSkill=function(){},e.prototype.setbAlive=function(t,e){t!==this._bAlive&&(this._bAlive=t,this.doPasvSkill(iface.tb_prop.triggerTypeKey.inScene,null,e))},Object.defineProperty(e.prototype,"bAlive",{get:function(){return this._bAlive},enumerable:!0,configurable:!0}),e.prototype.setInitHp=function(t){this.hp=-1===t?this.hpMax:t<=1?t*this.hpMax:t,this.initHp=this.hp,this.oldMaxHp=this.hpMax},e.prototype.afterCreate=function(t){this.doPasvSkill(iface.tb_prop.triggerTypeKey.enterScene),this.doCaptainSkill(),this.oldMaxHp!==this.hpMax&&(this.setInitHp(t),this.recordHpMaxChange()),this.bCreateDone=!0,logfight("objId:%d ,生命 %f,攻击 %f,防御 %f,攻速 %f,暴击率 %f,暴击伤害 %f,效果命中 %f,效果抵抗 %f,吸血 %f,反击 %f,再次出手 %f,晕眩 %f,伤害加成 %f,治疗加成 %f,增伤 %f,减伤 %f,免疫控制 %f",this.getObjId(),this.hpMax,this.atk,this.def,this.atkSpd,this.crit,this.critDmg,this.effectHit,this.effectResist,this.suckBlood,this.strikeBack,this.rampage,this.dizzy,this.dmgRate,this.healRate,this.addDmg,this.delDmg,this.immeDizzy)},e.prototype.getLossHp=function(){return this.initHp-this.hp},e.prototype.onWaveStart=function(){this.clearBuff(),this.updateAttrs(0,!0,!0),this.bNewObj?this.bNewObj=!1:this.recordObjInit(),this.setbAlive(0<this.hp)},e.prototype.doCaptainSkill=function(){},e.prototype.updateAttrs=function(t,e,i){if(e||!(Object.keys(this.attrMask).length<=0))for(var n in iface.tb_prop.attrTypeKey)this.calAttr(iface.tb_prop.attrTypeKey[n],t,e,i)},e.prototype.calAttr=function(t,e,i,n){if(i||this.getAttrMask(t)){this.clearAttrMask(t);var o=this.getBaseAttr(t),a=this.getTmpAmend(t,iface.tb_prop.addAttrTypeKey.fixedVal),r=this.getTmpAmend(t,iface.tb_prop.addAttrTypeKey.percentVal),s=this.getBuffAmend(t),u=0;switch(t){case iface.tb_prop.attrTypeKey.hpMax:case iface.tb_prop.attrTypeKey.atk:case iface.tb_prop.attrTypeKey.def:case iface.tb_prop.attrTypeKey.atkSpd:u=o*Math.max(1+r+s,0)+a;break;case iface.tb_prop.attrTypeKey.crit:case iface.tb_prop.attrTypeKey.effectHit:case iface.tb_prop.attrTypeKey.effectResist:case iface.tb_prop.attrTypeKey.suckBlood:case iface.tb_prop.attrTypeKey.strikeBack:case iface.tb_prop.attrTypeKey.rampage:case iface.tb_prop.attrTypeKey.dizzy:case iface.tb_prop.attrTypeKey.immuDizzy:u=Math.max(o+r+s+a,0);break;case iface.tb_prop.attrTypeKey.addDmg:case iface.tb_prop.attrTypeKey.subDmg:u=o+r+s+a;break;case iface.tb_prop.attrTypeKey.critDmg:case iface.tb_prop.attrTypeKey.dmgRate:case iface.tb_prop.attrTypeKey.healRate:u=Math.max(1+o+r+s+a,0)}i||logfight("calAttr type %d value %s base %s tmpAmendpercent %s tmpAmendfiexd %s buffAmend %s",t,u,o,r,a,s),this.setAttr(t,e,u,n)}},e.prototype.setAttr=function(t,e,i,n){switch(t){case iface.tb_prop.attrTypeKey.hpMax:this.hpMax!==i&&(this.hpMax=i,this.hp>this.hpMax&&(this.hp=this.hpMax),!n&&this.bCreateDone&&this.recordHpMaxChange(e));break;case iface.tb_prop.attrTypeKey.atk:this.atk=i;break;case iface.tb_prop.attrTypeKey.def:this.def=i;break;case iface.tb_prop.attrTypeKey.atkSpd:this.atkSpd!==i&&(this.atkSpd=i,n||this.recordAtkSpdChange(e));break;case iface.tb_prop.attrTypeKey.crit:this.crit=i;break;case iface.tb_prop.attrTypeKey.critDmg:this.critDmg=i;break;case iface.tb_prop.attrTypeKey.effectHit:this.effectHit=i;break;case iface.tb_prop.attrTypeKey.effectResist:this.effectResist=i;break;case iface.tb_prop.attrTypeKey.suckBlood:this.suckBlood=i;break;case iface.tb_prop.attrTypeKey.strikeBack:this.strikeBack=i;break;case iface.tb_prop.attrTypeKey.rampage:this.rampage=i;break;case iface.tb_prop.attrTypeKey.dizzy:this.dizzy=i;break;case iface.tb_prop.attrTypeKey.dmgRate:this.dmgRate=i;break;case iface.tb_prop.attrTypeKey.healRate:this.healRate=i;break;case iface.tb_prop.attrTypeKey.addDmg:this.addDmg=i;break;case iface.tb_prop.attrTypeKey.subDmg:this.delDmg=i;break;case iface.tb_prop.attrTypeKey.immuDizzy:this.immeDizzy=i}},e.prototype.getAttr=function(t,e){var i=0,n=0;switch(t){case iface.tb_prop.attrTypeKey.hpMax:i=this.hpMax;break;case iface.tb_prop.attrTypeKey.atk:i=this.atk;break;case iface.tb_prop.attrTypeKey.def:i=this.def;break;case iface.tb_prop.attrTypeKey.atkSpd:i=this.atkSpd;break;case iface.tb_prop.attrTypeKey.crit:i=this.crit;break;case iface.tb_prop.attrTypeKey.effectHit:i=this.effectHit;break;case iface.tb_prop.attrTypeKey.effectResist:i=this.effectResist;break;case iface.tb_prop.attrTypeKey.suckBlood:i=this.suckBlood;break;case iface.tb_prop.attrTypeKey.strikeBack:i=this.strikeBack;break;case iface.tb_prop.attrTypeKey.rampage:i=this.rampage;break;case iface.tb_prop.attrTypeKey.dizzy:i=this.dizzy;break;case iface.tb_prop.attrTypeKey.critDmg:i=this.critDmg;break;case iface.tb_prop.attrTypeKey.dmgRate:i=this.dmgRate;break;case iface.tb_prop.attrTypeKey.healRate:i=this.healRate;break;case iface.tb_prop.attrTypeKey.addDmg:i=this.addDmg;break;case iface.tb_prop.attrTypeKey.subDmg:i=this.delDmg;break;case iface.tb_prop.attrTypeKey.immuDizzy:i=this.immeDizzy}if(!e)return i;var o=this.getTagTmpAmend(e);if(!o)return i;var a=o[String(1e4*t+iface.tb_prop.addAttrTypeKey.percentVal)]||0,r=o[String(1e4*t+iface.tb_prop.addAttrTypeKey.fixedVal)]||0;switch(t){case iface.tb_prop.attrTypeKey.hpMax:case iface.tb_prop.attrTypeKey.atk:case iface.tb_prop.attrTypeKey.def:case iface.tb_prop.attrTypeKey.atkSpd:n=i*Math.max(1+a,0)+r;break;case iface.tb_prop.attrTypeKey.crit:case iface.tb_prop.attrTypeKey.effectHit:case iface.tb_prop.attrTypeKey.effectResist:case iface.tb_prop.attrTypeKey.suckBlood:case iface.tb_prop.attrTypeKey.strikeBack:case iface.tb_prop.attrTypeKey.rampage:case iface.tb_prop.attrTypeKey.dizzy:case iface.tb_prop.attrTypeKey.immuDizzy:case iface.tb_prop.attrTypeKey.critDmg:case iface.tb_prop.attrTypeKey.dmgRate:case iface.tb_prop.attrTypeKey.healRate:n=Math.max(i+a+r,0);break;case iface.tb_prop.attrTypeKey.addDmg:case iface.tb_prop.attrTypeKey.subDmg:n=i+a+r}return n},e.prototype.getBaseAttr=function(t){return this.attrs[t]||0},e.prototype.getTmpAmend=function(t,e){return this.tmpAmends[1e4*t+e]||0},e.prototype.getTagTmpAmend=function(t){return this.targetTmpAmends&&this.targetTmpAmends.hasOwnProperty(t)?this.targetTmpAmends[t]:null},e.prototype.getBuffAmend=function(t){return this.buffAmends[t]||0},e.prototype.suckHp=function(t,e){if(!(t<=0)){var i=tb.TB_skill.get_TB_skillById(e),n=(i?i.recover_percent/100:0)+this.suckBlood;if(!(n<=0))if(this.hasBuff(iface.tb_prop.buffTypeKey.banRecover))this.recordFlyText(iface.tb_prop.flyTextTypeKey.banRecover,!1,e);else{var o=t*n;logfight("suckHp rate %s",o),this.updateHp(this,o,e)}}},e.prototype.getOwnObjs=function(){return this.scene.getCampObjs(this.camp)},e.prototype.getEnemyObjs=function(){var t=getOppoCamp(this.camp);return this.scene.getCampObjs(t)},e.prototype.getEnemyRowObjs=function(t){var e=getOppoCamp(this.camp);return this.scene.getCampRowObjs(e,t)},e.prototype.getEnemyRowObjsByAlive=function(t){var e=getOppoCamp(this.camp);return this.scene.getCampRowObjs(e,t,!0)},e.prototype.getOwnRowObjs=function(t){return this.scene.getCampRowObjs(this.camp,t)},e.prototype.startRound=function(t){if(logfight("camp %d idx %d atkSpd %d",this.camp,this.idx,this.atkSpd),t&&this.recordFlyText(iface.tb_prop.flyTextTypeKey.rampage),this.beforeRound(),this.isAlive())return this.skipRound?(this.skipRound=!1,void logfight("skipRound!!!")):void this.aiStart()},e.prototype.aiStart=function(){var t=this.selectSkill();this.useSkill(t,!0),this.afterRound(t)},e.prototype.beforeRound=function(){this.getRoundFlag=!1,this.updateBuff(!0),this.updateAttrs(0,!0),this.recordNextRound()},e.prototype.afterRound=function(t){this.updateBuff(!1),!this.getRoundFlag&&0<this.rampage&&Math.random()<this.rampage&&(this.getRoundFlag=!0),this.scene.lastObjId=this.getObjId(),this.stBackTarget=null,t.isAnger()&&this.setAnger(0,t.skillId)},e.prototype.setAnger=function(t,e){t!=this.anger&&(this.anger=t,this.recordAddAnger(e))},e.prototype.chgAnger=function(t,e,i){var n=0;t==iface.tb_prop.addAttrTypeKey.fixedVal?n+=e:t==iface.tb_prop.addAttrTypeKey.percentVal&&(n+=this.anger*e/100),n<0&&this.recordFlyText(iface.tb_prop.flyTextTypeKey.angerDown,!1,i),n=Math.max(this.anger+n,0),this.setAnger(n,i)},e.prototype.startStrikeBack=function(){this.recordFlyText(iface.tb_prop.flyTextTypeKey.strikeBack),this.useSkill(this.skillpt),this.stBackTarget=null},e.prototype.selectSkill=function(){var t=this.hasBuff(iface.tb_prop.buffTypeKey.silence),e=this.hasBuff(iface.tb_prop.buffTypeKey.sneer);return!t&&!e&&this.anger>=tb.TB_skill_set.getSkillSet().spell_anger?this.skillag:this.skillpt},e.prototype.useSkill=function(t,e){var i={totalDmg:0,robAtkBar:0,tagDmg:{},critAnyEnemy:!1,eftAnyObj:!1,eftObj:{},hasFixedVal:!1};if(t){t.useSkill(this,e,i);var n=t.getMainTargetIds();if(0<n.length){if(this.camp==this.scene.getCampByObjid(n[0]))return;this.onBeAtkEnd(n,t.skillId,i)}this.scene.deadOpt()}else logfight("skillData is null")},e.prototype.onBeAtkEnd=function(t,e,i){for(var n=this.camp,o=0;o<t.length;o++){var a=this.scene.getObjById(t[o]);n=a.camp,a.doPasvSkill(iface.tb_prop.triggerTypeKey.selfBeAtk,this,e,i),a.doBuffTrigger(iface.tb_prop.buffTrigTypeKey.beAtk,null,e),o==t.length-1&&this.scene.doCampPasvSkill(n,iface.tb_prop.triggerTypeKey.ownBeAtk,a,e)}},e.prototype.onDeadEnd=function(){if(!isEmptyObject(this._deadObj))if(this.isAlive())this._deadObj=null;else{logfight(this.getObjId()+"触发死亡被动和buff判断");var t=this._deadObj.skillid;this.scene.teamMateDeadOpt(this,t),this.settlementOpt(!1,t),this.settlementOpt(!0,t),this._deadObj=null}},e.prototype.settlementOpt=function(t,e){this.isAlive()||(this.doPasvSkillEnd(t,e),this.doBuffTriggerEnd(t,e))},e.prototype.doPasvSkillEnd=function(t,e){for(var i in this.pasvSkills){var n=this.pasvSkills[i];t==n.hasRebornInSubSkill()&&n.doPasvSkill(iface.tb_prop.triggerTypeKey.selfDead,this,this,e)}},e.prototype.doBuffTriggerEnd=function(t,e){for(var i in this.buffs){var n=this.buffs[i];for(var o in n){var a=n[o];t==a.hasRebornEffect()&&a.canTrigger(iface.tb_prop.buffTrigTypeKey.dead)&&(a.trigger(!1,e),a.checkAlive()||this.rmBuff(a,e))}}},e.prototype.useSkillFast=function(t,e){new r.SkillData(t).useSkillFast(this,{totalDmg:0,robAtkBar:0,tagDmg:{},critAnyEnemy:!1,eftAnyObj:!1,eftObj:{},hasFixedVal:!1},e)},e.prototype.doPasvSkill=function(t,e,i,n){for(var o in this.pasvSkills)this.pasvSkills[o].doPasvSkill(t,this,e,i,n)},e.prototype.shareBuffTrigger=function(t,e,i,n,o,a){var r=this.buffs[iface.tb_prop.buffTypeKey.shareDmg];if(r){var s=0,u=t.value;for(var h in r){var l=r[h],c=Math.floor(u*(l.tplt.effect_percent/100));l.caster.recordFlyText(iface.tb_prop.flyTextTypeKey.share,!1,n),updateObjHp(e,l.caster,-c,n,o,a),s+=c,logfight(l.caster.getObjId()+"分摊了"+c+"伤害")}t.value-=s,updateObjHp(e,i,-t.value,n,o,a)}else updateObjHp(e,i,-t.value,n,o,a)},e.prototype.modifyDmg=function(t,e){for(var i=[iface.tb_prop.buffTypeKey.attr,iface.tb_prop.buffTypeKey.god,iface.tb_prop.buffTypeKey.shield],n=0;n<i.length;n++){var o=this.buffs[i[n]];if(o)for(var a in o){var r=o[a];r.modifyDmg(t,e)&&(this.doBuffTrigger(iface.tb_prop.buffTrigTypeKey.buffDefAndCasterTriggerSkill,null,e),this.rmBuff(r,e))}}return 0<t.value},e.prototype.onBeAtk=function(t,e){this.rmBuffByType(iface.tb_prop.buffTypeKey.sleep,e)},e.prototype.onBeCrit=function(t,e){this.doPasvSkill(iface.tb_prop.triggerTypeKey.beCrit,this,e)},e.prototype.onAtkObj=function(t,e){this.doBuffTrigger(iface.tb_prop.buffTrigTypeKey.atking,null,t)},e.prototype.onCritObj=function(t,e,i){this.doPasvSkill(iface.tb_prop.triggerTypeKey.crit),this.doSubSkillEffects(t,e,i,iface.tb_prop.triggerTypeKey.crit)},e.prototype.doSubSkillEffects=function(t,e,i,n){var o=this.skills[e];if(o){var a=o.subSkills[i];a?a.doEffects(t,n,this):logfight("subData %d is null",i)}else logfight("skillData %d is null",e)},e.prototype.onCritAnyEnemy=function(t,e,i){this.doPasvSkill(iface.tb_prop.triggerTypeKey.critAnyEnemy,null,i),this.doSkillEffects(t,e,iface.tb_prop.triggerTypeKey.critAnyEnemy)},e.prototype.onEftAnyObj=function(t,e,i){this.doPasvSkill(iface.tb_prop.triggerTypeKey.eftAnyObj,null,i),this.doSkillEffects(t,e,iface.tb_prop.triggerTypeKey.eftAnyObj)},e.prototype.doSkillEffects=function(t,e,i){var n=this.skills[e];if(n)for(var o in n.subSkills){var a=n.subSkills[o];a?a.doEffects(t,i,this):logfight("subData %d is null",o)}else logfight("skillData %d is null",e)},e.prototype.updateHp=function(t,e,i,n,o,a,r){void 0===n&&(n=!1);var s=Math.max(this.hp+e,0);if(a&&0==s&&this.doPasvSkill(iface.tb_prop.triggerTypeKey.enterSceneFirst,this,i),this.immuneDmg)return this.recordFlyText(iface.tb_prop.flyTextTypeKey.immune,!1,i),void(this.immuneDmg=!1);if(this.hp=Math.min(s,this.hpMax),this.recordHpChange(o,e,i,n,r),this.hp<=0){if(!this.hasBuff(iface.tb_prop.buffTypeKey.noDeath))return void this.dead(t,i);this.hp=1,logfight("noDeath %s",i)}this.doPasvSkill(iface.tb_prop.triggerTypeKey.addDamage,null,i)},e.prototype.isAlive=function(){return this.bAlive},e.prototype.dead=function(t,e){logfight("Dead!! objId %d atkerObjId %d skillId %d",this.getObjId(),t.getObjId(),e),this.setbAlive(!1,e),t.isArtifact()||(t.doPasvSkill(iface.tb_prop.triggerTypeKey.enemyDead,this,e),t.doSkillEffects({},e,iface.tb_prop.triggerTypeKey.enemyDead)),this.clearEnemySneerBuff(e),this.clearOwnShareBuff(e),this.setAnger(0,e),this.scene.removeAtkItem(this),this._deadObj={isdead:!0,skillid:e}},e.prototype.reborn=function(t,e,i){this.setbAlive(!0,i),this.stBackTarget=null,this.getRoundFlag=!1,this.skipRound=!1,this.recordFlyText(iface.tb_prop.flyTextTypeKey.reborn,!1,i),this.clearBuff(),this.updateAttrs(i,!0),this.setHpPer(t,e,i)},e.prototype.setHpPer=function(t,e,i){var n=this.hpMax*e-this.hp;this.updateHp(t,n,i)},e.prototype.setHp=function(t,e,i){var n=e-this.hp;this.updateHp(t,n,i)},e.prototype.chgHpPer=function(t,e,i,n,o,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),e){if(0<e){if(this.hasBuff(iface.tb_prop.buffTypeKey.banRecover))return void this.recordFlyText(iface.tb_prop.flyTextTypeKey.banRecover,i,n);e*=this.healRate}o&&this.hp+e<=0&&(e=-(this.hp-1)),this.updateHp(t,e,n,i,!1,!1,0<e&&a)}},e.prototype.isSameCamp=function(t){return this.camp===t.camp},e.prototype.setAttrMask=function(t){this.attrMask[t]=!0},e.prototype.clearAttrMask=function(t){delete this.attrMask[t]},e.prototype.getAttrMask=function(t){return this.attrMask[t]},e.prototype.modifyTmpAmend=function(t,e,i,n){this.setAttrMask(t);var o=1e4*t+e;this.tmpAmends[o]=this.tmpAmends[o]||0,this.tmpAmends[o]+=i,this.updateAttrs(n)},e.prototype.modifyTagTmpAmend=function(t,e,i,n){this.targetTmpAmends||(this.targetTmpAmends={}),this.targetTmpAmends.hasOwnProperty(t)||(this.targetTmpAmends[t]={});var o=this.targetTmpAmends[t],a=1e4*e+i;o[a]=o[a]||0,o[a]+=n},e.prototype.clearTmpAmend=function(t){for(var e in this.tmpAmends)this.setAttrMask(Math.floor(Number(e)/1e4));this.tmpAmends={},this.updateAttrs(t),this.targetTmpAmends={}},e.prototype.addBuff=function(t,e,i,n,o){var a=tb.TB_buff.get_TB_buffById(t);if(a){if(this.checkAddBuff(a,i)&&(this.scene.onAddBuffBefore(a.ID,this,e,i),!this.checkBuffReact(a,e,i,n,o))){var r=this.createBuff(e,a,this.scene.genBuffInstId(),i,n,o);this.buffs[a.type]=this.buffs[a.type]||{},this.buffs[a.type][r.buffInstId]=r,this.recordAddBuff(r,!0)}}else logerror("addBuff tb_buff[%s] is null",t)},e.prototype.checkAddBuff=function(t,e){switch(t.status_type){case iface.tb_prop.buffStatTypeKey.positive:if(this.hasBuff(iface.tb_prop.buffTypeKey.disablePositive))return!1;break;case iface.tb_prop.buffStatTypeKey.negative:if(this.hasBuff(iface.tb_prop.buffTypeKey.immune))return this.recordFlyText(iface.tb_prop.flyTextTypeKey.resist,!1,e),!1}var i=t.type;return i===iface.tb_prop.buffTypeKey.bleed&&(this.isImmunePoison()||this.hasBuff(iface.tb_prop.buffTypeKey.immuBleed))||i===iface.tb_prop.buffTypeKey.dizzy&&(this.isImmuneCtrl()||this.hasBuff(iface.tb_prop.buffTypeKey.immuDizzy))?(this.recordFlyText(iface.tb_prop.flyTextTypeKey.resist,!1,e),!1):i!==iface.tb_prop.buffTypeKey.sleep||!this.isImmuneCtrl()&&!this.hasBuff(iface.tb_prop.buffTypeKey.immuSleep)||(this.recordFlyText(iface.tb_prop.flyTextTypeKey.resist,!1,e),!1)},e.prototype.checkBuffReact=function(t,e,i,n,o){var a=this.getBuffsById(t.ID);if((t.stack_type===iface.tb_prop.buffStackTypeKey.coexistStack||t.stack_type===iface.tb_prop.buffStackTypeKey.coexistCover)&&Object.keys(a).length<t.stack_max)return!1;for(var r in a){var s=a[r];if(s.getStackType()===iface.tb_prop.buffStackTypeKey.stack||s.getStackType()===iface.tb_prop.buffStackTypeKey.coexistStack)return s.onStack(i,o),!0;if(s.getStackType()===iface.tb_prop.buffStackTypeKey.cover||s.getStackType()===iface.tb_prop.buffStackTypeKey.coexistCover)return s.onCover(e,i,n,o),!0}return!1},e.prototype.createBuff=function(t,e,i,n,o,a){return new r.BuffObj(this,t,e,i,n,o,a)},e.prototype.clearBuff=function(){var t,e=[];for(var i in this.buffs){var n=this.buffs[i];for(var o in n)(t=n[o]).isDeadExist()?e.push(t):t.onRemove(!0)}this.buffs={};for(var a=0;a<e.length;a++)(t=e[a])&&(this.buffs[t.getType()]=this.buffs[t.getType()]||{},this.buffs[t.getType()][t.buffInstId]=t)},e.prototype.rmBuff=function(t,e){var i=this.buffs[t.getType()];i&&i[t.buffInstId]&&t.checkRemove(this.scene.round)&&(delete i[t.buffInstId],t.onRemove(),this.recordRmBuff(t,e))},e.prototype.rmBuffById=function(t,e){var i=tb.TB_buff.get_TB_buffById(t);if(i){var n=this.buffs[i.type];if(n)for(var o in n){var a=n[o];a.getTpltId()===t&&this.rmBuff(a,e)}}else logfight("rmBuffById tb_buff[%s] is null",t)},e.prototype.rmBuffByType=function(t,e){var i=this.buffs[t];if(i)for(var n in i){var o=i[n];this.rmBuff(o,e)}},e.prototype.rmBuffByStatType=function(t,e,i){var n=[];for(var o in e=e||0,this.buffs){var a=this.buffs[o];for(var r in a){var s=a[r];if(s.getStatType()===t&&(this.rmBuff(s,i),n.push(s),0<e&&--e<=0))return n}}return n},e.prototype.getBuffs=function(t){return this.buffs[t]},e.prototype.getBuffsById=function(t){var e=tb.TB_buff.get_TB_buffById(t);if(!e)return logerror("getBuffsById tb_buff[%s] is null",t),{};var i=this.buffs[e.type];if(!i)return{};var n={};for(var o in i){var a=i[o];a.getTpltId()===t&&(n[o]=a)}return n},e.prototype.hasBuff=function(t){var e=this.buffs[t];return!!(e&&0<Object.keys(e).length)},e.prototype.hasBuffById=function(t){var e=tb.TB_buff.get_TB_buffById(t);if(!e)return logfight("hasBuffById tb_buff[%s] is null",t),!1;var i=this.buffs[e.type];if(!i)return!1;for(var n in i)if(i[n].getTpltId()===t)return!0;return!1},e.prototype.hasBuffByStatType=function(t){for(var e in this.buffs){var i=this.buffs[e];for(var n in i)if(i[n].getStatType()===t)return!0}return!1},e.prototype.getBuffNumByStatType=function(t){var e=0;for(var i in this.buffs){var n=this.buffs[i];for(var o in n)n[o].getStatType()===t&&e++}return e},e.prototype.doBuffTrigger=function(t,e,i){for(var n in this.buffs){var o=this.buffs[n];for(var a in o){var r=o[a];r.canTrigger(t,e)&&(r.trigger(!1,i),r.checkAlive()||this.rmBuff(r,i))}}},e.prototype.getStBackTarget=function(){return this.stBackTarget&&this.stBackTarget.isAlive()?this.stBackTarget:null},e.prototype.getSneerTarget=function(){var t=this.buffs[iface.tb_prop.buffTypeKey.sneer];if(!t)return null;for(var e in t){var i=t[e];if(i){var n=i.caster;if(n&&!n.isArtifact()&&n.isAlive())return n}}return null},e.prototype.clearEnemySneerBuff=function(t){var e=getOppoCamp(this.camp);this.scene.clearCampSneerBuffByCaster(e,this,t)},e.prototype.clearOwnShareBuff=function(t){this.scene.clearCampShareBuffByCaster(this.camp,this,t)},e.prototype.clearSneerBuffByCaster=function(t,e){if(t){var i=this.buffs[iface.tb_prop.buffTypeKey.sneer];if(i)for(var n in i){var o=i[n];o&&o.caster&&o.caster.getObjId()===t.getObjId()&&this.rmBuff(o,e)}}},e.prototype.clearShareBuffByCaster=function(t,e){if(t){var i=this.buffs[iface.tb_prop.buffTypeKey.shareDmg];if(i)for(var n in i){var o=i[n];o&&o.caster&&o.caster.getObjId()===t.getObjId()&&this.rmBuff(o,e)}}},e.prototype.transNegativeBuff=function(t,e,i){for(var n=this.rmBuffByStatType(iface.tb_prop.buffStatTypeKey.negative,e,i),o=0;o<n.length;o++){var a=n[o];a&&(logfight("transNegativeBuff %d round %d stackCnt %d",a.getTpltId(),a.round,a.stackCnt),t.addBuff(a.getTpltId(),this,i,a.round,a.stackCnt))}},e.prototype.transPositiveBuff=function(t,e,i){for(var n=t.rmBuffByStatType(iface.tb_prop.buffStatTypeKey.positive,e,i),o=0;o<n.length;o++){var a=n[o];a&&(logfight("transPositiveBuff %d round %d stackCnt %d",a.getTpltId(),a.round,a.stackCnt),this.addBuff(a.getTpltId(),this,i,a.round,a.stackCnt))}},e.prototype.updateBuff=function(t){for(var e in this.buffs){var i=this.buffs[e];for(var n in i){var o=i[n];o.canDoEffect(t)&&(o.doEffect(t),o.checkAlive()||this.rmBuff(o,t?0:-1))}}},e.prototype.modifyBuffAmend=function(t,e,i,n){this.setAttrMask(t),this.buffAmends[t]=this.buffAmends[t]||0,this.buffAmends[t]+=e,this.updateAttrs(i,!1,n)},e.prototype.getRaceGrade=function(t){return getRaceGrade(this.race,t.race)},e.prototype.recordNextRound=function(){var t={type:iface.tb_prop.battleOpTypeKey.nextRound,objId:this.getObjId()};this.scene.recordOperate(0,t)},e.prototype.recordObjInit=function(){var t={type:iface.tb_prop.battleOpTypeKey.objInit,objId:this.getObjId(),objType:this.type,templateId:this.templateId,hp:Number(this.hp),hpMax:Number(this.hpMax),atkSpd:Math.round(100*this.atkSpd)/100,level:this.level,degree:this.degree,starLev:this.starLev,awakenLv:this.awakenLv,skinId:this.skinId,anger:this.anger,uuid:this.uuid};this.scene.recordOperate(0,t)},e.prototype.recordHpMaxChange=function(t){var e={type:iface.tb_prop.battleOpTypeKey.hpMaxChange,objId:this.getObjId(),hp:Number(this.hp),hpMax:Number(this.hpMax)};this.scene.recordOperate(t,e)},e.prototype.recordAtkSpdChange=function(t){var e={type:iface.tb_prop.battleOpTypeKey.atkSpdChange,objId:this.getObjId(),atkSpd:Math.round(100*this.atkSpd)/100};this.scene.recordOperate(t,e)},e.prototype.recordUseSkill=function(t,e,i){if(e){var n={type:iface.tb_prop.battleOpTypeKey.useSkill,skillId:t,objId:this.getObjId(),targetIds:e};this.scene.recordOperate(0<i?i:0,n)}},e.prototype.recordAddAnger=function(t){var e={type:iface.tb_prop.battleOpTypeKey.roleAngerChange,anger:this.anger,objId:this.getObjId()};this.scene.recordOperate(0<t?t:0,e)},e.prototype.recordTrigPasvSkill=function(t,e,i){if(this.scene.checkPasvSkillRecord(t,e)&&i){var n={type:iface.tb_prop.battleOpTypeKey.trigPasvSkill,skillId:t,objId:this.getObjId(),targetIds:i};this.scene.recordOperate(0<e?e:0,n)}},e.prototype.recordHpChange=function(t,e,i,n,o){this.recordFlyText(t?iface.tb_prop.flyTextTypeKey.crit:iface.tb_prop.flyTextTypeKey.hpChange,n,i,e,o);var a=tb.TB_skill.get_TB_skillById(i);if(!i||!a.isSkillDmgMultiSection()){var r={type:iface.tb_prop.battleOpTypeKey.hpChange,objId:this.getObjId(),hp:Number(this.hp)};this.scene.recordOperate(n?-1:i,r)}},e.prototype.recordFlyText=function(t,e,i,n,o){void 0===e&&(e=!1);var a={type:iface.tb_prop.battleOpTypeKey.flyText,objId:this.getObjId(),flyTextType:t};n&&(a.value=parseInt(n)),o&&(a.showeff=1),this.scene.recordOperate(e?-1:i,a)},e.prototype.recordAddBuff=function(t,e){this.recordBuff(iface.tb_prop.battleOpTypeKey.addBuff,t,t.skillId,!1,e)},e.prototype.recordBuffChange=function(t,e,i,n){this.recordBuff(iface.tb_prop.battleOpTypeKey.buffChange,t,e,i,n)},e.prototype.recordRmBuff=function(t,e){this.recordBuff(iface.tb_prop.battleOpTypeKey.rmBuff,t,e)},e.prototype.recordBuff=function(t,e,i,n,o){var a;void 0===n&&(n=!1),e.isShow()&&(i=i||0,a={type:t,objId:this.getObjId(),casterId:e.caster.getObjId(),skillId:e.skillId,buffId:e.getTpltId(),buffInstId:e.buffInstId,round:e.round,stackCnt:e.stackCnt},o&&(a.showeff=1),t===iface.tb_prop.battleOpTypeKey.rmBuff&&(a={type:t,buffInstId:e.buffInstId}),t===iface.tb_prop.battleOpTypeKey.buffChange&&n&&(a.bAdd=!0),this.scene.recordOperate(i,a))},e.prototype.addSelfAnger=function(t){var e=this.scene.getCampArtifact(this.camp);e&&e.addAngerOnAtk(t)},e.prototype.addEnemyAnger=function(t){var e=getOppoCamp(this.camp),i=this.scene.getCampArtifact(e);i&&i.addAngerOnBeAtk(t)},e.prototype.isImmunePoison=function(){return!1},e.prototype.isImmuneCtrl=function(){return!1},e.prototype.isBeCrit=function(){return this.beCrit},e.prototype.setBeCrit=function(){this.beCrit=!0},e.prototype.clearBeCrit=function(){this.beCrit=!1},e);function e(t,e,i,n,o){this.scene=null,this.camp=t,this.idx=e,this.attrs=i||{},this.buffs={},this.skills={},this.pasvSkills={},this.hp=0,this.hpMax=0,this.oldMaxHp=0,this.initHp=0,this.atk=0,this.def=0,this.atkSpd=0,this.crit=0,this.critDmg=1,this.effectHit=0,this.effectResist=0,this.suckBlood=0,this.strikeBack=0,this.profession=n,this.rampage=0,this.dizzy=0,this.dmgRate=1,this.healRate=1,this.addDmg=0,this.delDmg=0,this.immeDizzy=0,this.attrMask={},this.tmpAmends={},this.targetTmpAmends={},this.buffAmends={},this.stBackTarget=null,this.getRoundFlag=!1,this.immuneDmg=!1,this.skipRound=!1,this.bNewObj=!0,this.bCreateDone=!1,this.beCrit=!1,this.uuid=0,this.skillpt=null,this.skillag=null,this.row=e<=2?1:2,this.anger=tb.TB_skill_set.getSkillSet().begin_anger,replaceSkill(o),this.initSkillDatas(o)}r.BattleObj=t}(battle=battle||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(g){var t,e=(t=g.FightPage,__extends(i,t),i.prototype.initPage=function(t){this.pagejson=t,this.waveKey=Object.keys(this.pagejson),this.curwave=0,this.curround=0},i.prototype.initState=function(){this.curwave=0,this.curround=0,this.isQuick=!1},i.prototype.getPreloadIds=function(){var t,e,i=[],n=[];for(var o in this.pagejson){var a=this.pagejson[o][0];if(a){for(var r={1:{god:{},monster:{}},2:{god:{},monster:{}}},s=a[g.StepKeyConst.START],u=0;s&&u<s.length;u++){var h=s[u];if(void 0!==h.type&&h.type==iface.tb_prop.battleOpTypeKey.objInit&&(t=Math.floor(h.objId/10),e=h.objId%10-1,h.templateId&&h.objType)){var l=[],c=void 0;if(h.objType==iface.tb_prop.battleObjTypeKey.god){r[t].god[e]=h.templateId,c=tb.TB_god.get_TB_godById(h.templateId);for(var p=0;p<c.skill.length;p++)c.skill[p][1]<=h.degree&&l.push(c.skill[p][0])}else r[t].monster[e]=h.templateId,l=(c=tb.TB_monster.get_TB_monsterById(h.templateId)).skill;this.addlist(i,c.model);for(var d=0;d<l.length;d++){var _;if(0<(_=tb.TB_skill.get_TB_skillById(l[d])).effect){var f=tb.TB_skill_effect.get_TB_skill_effectById(_.effect).effect_id;this.addlist(n,f);break}}}void 0!==h.type&&h.type==iface.tb_prop.battleOpTypeKey.atftInit&&(h.templateId&&this.addlist(i,tb.TB_artifact.get_TB_artifactById(h.templateId).model),!h.skillId||0<(_=tb.TB_skill.get_TB_skillById(h.skillId)).effect&&(f=tb.TB_skill_effect.get_TB_skill_effectById(_.effect).effect_id,this.addlist(n,f)))}this.waveObj[o]=r}}return{roles:i,skills:n}},i.prototype.getWaveNum=function(){return this.waveKey.length},i.prototype.getTitle=function(){return this.curwave+"/"+this.getWaveNum()},i.prototype.resetWave=function(t){this.curwave=t,this.curround=-1},i.prototype.getNextRound=function(t){if(void 0===t&&(t=!1),0==this.curwave&&this.resetWave(1),this.curwave>this.getWaveNum())return this.resetWave(0),null;this.curround++;var e=this.pagejson[String(this.curwave)],i=String(this.curround);if(e.hasOwnProperty(i)){var n=[],o=e[i];return o[g.StepKeyConst.START]&&n.push(o[g.StepKeyConst.START]),o[g.StepKeyConst.END]&&n.push(o[g.StepKeyConst.END]),[{roundary:n,roundmap:o,newWave:t,succOpt:[]}]}return this.resetWave(this.curwave+1),this.getNextRound(!0)},i.prototype.getLossHpObj=function(){return this.lossHpObj||{}},i.prototype.getMaxHpObj=function(){return this.maxHpObj||{}},i.prototype.getResult=function(){return this.result},i.prototype.clonePage=function(t){var e=new i;return e.initPage(this.pagejson),e.result=this.getResult(),e},i);function i(){return t.call(this)||this}g.ServerPage=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.component.XianshiBaoxiangUI,__extends(n,i),n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.zOrder=this.dataSource},n.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.btnConfirm.on(Laya.Event.CLICK,this,this.close)},n.prototype.onClosed=function(t){i.prototype.onClosed.call(this,t)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!1,t}t.XianshiBaoxiangView=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.login.WaitUI,__extends(n,e),n.prototype.onOpened=function(){this.lbl_progress.text=this.dataSource?this.dataSource:LanMgr.getLan("加载中...",-1),this.ani_load&&this.ani_load.play(0,!0),e.prototype.onOpened.call(this)},n.prototype.onClosed=function(){this.ani_load&&this.ani_load.stop(),e.prototype.onClosed.call(this)},n.prototype.setProgress=function(t){this._progress=Math.ceil(100*t),this.lbl_progress.text=this._progress+"%"},n);function n(){return e.call(this)||this}t.WaitView=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var o,e=(o=ui.component.SkillTipUI,__extends(i,o),i.prototype.initPosition=function(){this.img_bg.height=146,this.list_miaoshu.height=24,this.img_bg.x=this._Objectpos.x-this.img_bg.width/2,this.img_bg.y=this._Objectpos.y-this.img_bg.height},i.prototype.setPosition=function(){if(this.img_bg.x+this.img_bg.width>Laya.stage.width){var t=this.img_bg.x+this.img_bg.width-Laya.stage.width;this.img_bg.x-=10+t}else if(this.img_bg.y+this.img_bg.height>Laya.stage.height){var e=this.img_bg.y+this.img_bg.height-Laya.stage.height;this.img_bg.y-=10+e}else this.img_bg.x<0?this.img_bg.x=10:this.img_bg.y<0&&(this.img_bg.y=10)},i.prototype.onRenderMiaoshu=function(t,e){if(!(e>this.list_miaoshu.dataSource.length)){var i=this.list_miaoshu.dataSource[e];if(i){var n=t.getChildByName("img_dianliang");n.visible=!1,i.level&&i.level<=this._dataSource.level&&(n.visible=!0),t.getChildByName("lab_miaoshu").text=LanMgr.getLan("{0}级：{1}",-1,i.level,i.info)}}},i.prototype.timerOnce=function(){Laya.timer.once(1900,this,this.Tweento)},i.prototype.Tweento=function(){Laya.Tween.to(this,{alpha:0},200,null,new Handler(this,function(){UIMgr.hideUIByName(UIConst.SkillTip)}))},i.prototype.onOpened=function(){o.prototype.onOpened.call(this);var t=this.dataSource[0];if(this._Objectpos.x=this.dataSource[1],this._Objectpos.y=this.dataSource[2],t.skilldata){var e=t.skilldata[0];Laya.timer.clearAll(this),this.timerOnce(),this.initPosition(),this.lab_type.text=0==e.type?LanMgr.getLan("(被动)",-1):LanMgr.getLan("(主动)",-1),this.lab_type.visible=0==e.type,this.lab_skillname.text=e.name,this.lab_skillname.event(Laya.Event.RESIZE),this.lab_skillinfo.text=e.info,this.lab_skillinfo.event(Laya.Event.RESIZE),t.skilldata.shift();var i=this.lab_skillinfo.height-20;this.lab_cd.text="",this.lab_cd.height=0,this.lab_cd.event(Laya.Event.RESIZE),this.list_miaoshu.visible=!1,this.list_miaoshu.height+=i-24,this.img_bg.height+=i-24,this.img_bg.height-=20;var n=this.img_bg.height-146;this.img_bg.y-=n,this.setPosition(),Laya.Tween.to(this,{alpha:1},200)}},i.prototype.onClosed=function(){o.prototype.onClosed.call(this)},i);function i(){var t=o.call(this)||this;return t._Objectpos=new Laya.Point,t.mouseEnabled=!1,t.mouseThrough=!0,t.lab_miaoshusize.mouseEnabled=!1,t.list_miaoshu.renderHandler=new Handler(t,t.onRenderMiaoshu),t}t.SkillTip=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.ManyItemsTipUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this),this.initView(this.dataSource.data),this.dataSource.info&&(this.lab_info.text=this.dataSource.info)},n.prototype.initView=function(t){this.list_item.x=301-(45+this.list_item.spaceX/2)*this.dataSource.length,this.list_item.array=t,this.list_item.width=90*t.length+(t.length-1)*this.list_item.spaceX},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.list_item.array=null},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t}t.ManyItemsTip=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.component.ItemTipUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},n.prototype.init=function(){var t=this.dataSource,e=new ItemVo(t.ID||t.id,t.getNum());e.show=!1,this.ui_Itembox.dataSource=e;var i=tb.TB_item.get_TB_itemById(t.ID||t.id);this.lab_name.text=i.name,this.lab_num.text=Snums(App.hero.getBagItemNum(e.id.toString()))+"",this.lab_desc.text=i.desc,this.lab_way.text=i.way},n.prototype.startScrollText=function(t){this.prevX=this.lab_desc.mouseX,this.prevY=this.lab_desc.mouseY,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.finishScrollText)},n.prototype.finishScrollText=function(t){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.finishScrollText)},n.prototype.scrollText=function(t){var e=this.lab_desc.mouseX,i=this.lab_desc.mouseY;this.lab_desc.textField.scrollX+=this.prevX-e,this.lab_desc.textField.scrollY+=this.prevY-i,this.prevX=e,this.prevY=i},n.prototype.close=function(){i.prototype.close.call(this)},n);function n(){var t=i.call(this)||this;return t.prevX=0,t.prevY=0,t.isModelClose=!0,t.lab_desc.on(Laya.Event.MOUSE_DOWN,t,t.startScrollText),t}t.ItemTip=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.SoundEffectUI,__extends(n,e),n.prototype.onDelay=function(){this.soundUrl||(this.soundUrl="sound/button.mp3"),this.parent&&this.parent.on(Laya.Event.CLICK,this,this.onClick)},n.prototype.setSoundUrl=function(t){this.soundUrl=t},n.prototype.onClick=function(){this.soundUrl&&AudioMgr.playSound(this.soundUrl)},n.prototype.onDispose=function(){this.soundUrl="",this.soundtName="",this.soundType=0,this.off(Laya.Event.CLICK,this,this.onClick)},n);function n(){var t=e.call(this)||this;return t.frameOnce(2,t,t.onDelay),t}t.SoundEffectProp=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.DialogExt,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},n.prototype.show=function(){e.prototype.show.call(this),this.initView()},n.prototype.initView=function(){this._bg||(this._bg=new Laya.Image("comp/bg/zhezhao3.png"),this._bg.x=this._bg.y=0,this._bg.width=Laya.stage.width,this._bg.height=Laya.stage.height,this._bg.alpha=.5,this.addChild(this._bg)),this.uiScene||(this.uiScene=new Base2dSceneLayer,this.uiScene.scene.changeBloodManager(new BloodManagerExt),this.addChild(this.uiScene)),this._skillLab||(this._skillLab=new Laya.Label,this._skillLab.x=300,this._skillLab.y=700,this._skillLab.fontSize=60,this._skillLab.color="#ffffff",this._skillLab.strokeColor="#000000",this._skillLab.stroke=5,this.addChild(this._skillLab)),this.setData()},n.prototype.setData=function(){var t=this;this.dataSource&&(this.uiScene.addModelChar(String(this.dataSource.model),this.dataSource.charx,this.dataSource.chary,170,this.dataSource.scale),this.uiScene.addEffect(this,1000009,new tl3d.Vector3D(0,0,this.dataSource.effz),10,0,function(t){},0,0,!1,.5),this._skillLab.text=this.dataSource.text),setTimeout(function(){t.dataSource&&t.dataSource.cb&&t.dataSource.cb(),t.close()},800)},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.uiScene.onExit()},n);function n(){var t=e.call(this)||this;return t.x=t.y=0,t.width=Laya.stage.width,t.height=Laya.stage.height,t}t.showSkill=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=Laya.Image,__extends(i,n),i.prototype.onDelay=function(){this.initScaleX=this.scaleX||1,this.initScaleY=this.scaleY||1},i.prototype.scaleSmall=function(){Laya.Tween.to(this,{scaleX:.9,scaleY:.9},this.scaleTime)},i.prototype.scaleBig=function(){Laya.Tween.to(this,{scaleX:this.initScaleX,scaleY:this.initScaleY},this.scaleTime)},i);function i(t,e){void 0===t&&(t=null),void 0===e&&(e="");var i=n.call(this,t)||this;return i.scaleTime=100,i.initScaleX=1,i.initScaleY=1,i.on(Laya.Event.MOUSE_DOWN,i,i.scaleSmall),i.on(Laya.Event.MOUSE_UP,i,i.scaleBig),i.on(Laya.Event.MOUSE_OUT,i,i.scaleBig),i.frameOnce(2,i,i.onDelay),i}t.scaleButton=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=t.DialogExt,__extends(n,i),n.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.setProgres2(),this.lbl_progress.text=this.dataSource?this.dataSource:LanMgr.getLan("加载中...",-1),this.bar_value.scaleX=0},n.prototype.setProgress=function(t){var e=this.dataSource?this.dataSource:LanMgr.getLan("加载中...",-1);this.lbl_progress.text=e+Math.ceil(100*t).toFixed(0)+"%",this.bar_value.scaleX=t},n.prototype.setProgres2=function(){var t=this;this.bar_value2.scaleX=0,this.parent&&Laya.Tween.to(this.bar_value2,{scaleX:1},2e3,Laya.Ease.linearInOut,Laya.Handler.create(this,function(){Laya.timer.frameOnce(10,t,function(){t.setProgres2()})}))},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),Laya.Tween.clearAll(this.bar_value2),this.bar_value2.scaleX=0},n);function n(){var t=i.call(this)||this;t.width=Laya.stage.width,t.height=Laya.stage.height,t.group=UIConst.login_group;var e=new Laya.Image("preload/black.jpg");return e.width=t.width,e.height=t.height,t.addChild(e),t.bg=new Laya.Image(SkinUtil.getSysMapSkin(ModuleConst.loading)),t.bg.centerX=0,t.bg.centerY=0,t.logo=new Laya.Image("preload/logo_da.png"),t.logo.right=10,t.logo.top=10,t.tip=new Laya.Label("首次加载时间较长，请耐心等待"),t.tip.anchorX=.5,t.tip.x=t.width>>1,t.tip.y=1131+Launch.offsetY,t.tip.color=ColorConst.BLACK,t.tip.fontSize=23,t.lbl_refreh=new Laya.Label("点击刷新"),t.lbl_refreh.x=530+Launch.offsetX,t.lbl_refreh.y=1131+Launch.offsetY,t.lbl_refreh.align="center",t.lbl_refreh.color=ColorConst.GREEN,t.lbl_refreh.fontSize=23,t.lbl_refreh.underline=!0,t.lbl_refreh.once(Laya.Event.CLICK,t,function(){BingoSDK.gameRefresh()}),t.lbl_info=new Laya.Label("抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。"),t.lbl_info.centerX=0,t.lbl_info.y=1200+Launch.offsetY,t.lbl_info.align="center",t.lbl_info.color=ColorConst.BLACK,t.lbl_info.fontSize=18,t.lbl_info2=new Laya.Label("适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。"),t.lbl_info2.centerX=0,t.lbl_info2.y=1230+Launch.offsetY,t.lbl_info2.align="center",t.lbl_info2.color=ColorConst.BLACK,t.lbl_info2.fontSize=18,t.bar_bg=new Laya.Image("preload/bar_bg.png"),t.bar_value=new Laya.Image("preload/bar.png"),t.bar_bg2=new Laya.Image("preload/bar_bg.png"),t.bar_value2=new Laya.Image("preload/bar.png"),t.lbl_progress=new Laya.Label("加载中......"),t.box_bar=new Laya.Box,t.box_bar.x=26+Launch.offsetX,t.box_bar.y=1046+Launch.offsetY,t.box_bar.width=668,t.box_bar.height=75,t.bar_value.x=27,t.bar_value.y=5,t.bar_value2.x=27,t.bar_value2.y=50,t.bar_bg2.y=45,t.bar_value2.scaleX=0,t.lbl_progress.centerX=0,t.lbl_progress.y=1,t.lbl_progress.anchorX=.5,t.lbl_progress.align="center",t.lbl_progress.color=ColorConst.ZONGSE,t.lbl_progress.fontSize=22,t.box_bar.addChildren(t.bar_bg,t.bar_value,t.lbl_progress,t.bar_bg2,t.bar_value2),t.addChild(t.bg),t.addChild(t.logo),t.addChild(t.tip),t.addChild(t.lbl_refreh),t.addChild(t.lbl_info),t.addChild(t.lbl_info2),t.addChild(t.box_bar),t}t.LoadingView=e}(common=common||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(c){var t=(e.prototype.setData=function(t){this.downClient=1,this.shareVisable=1,this.bindPhone=1,this.realNameVisable=1,this.vipService=1,this.force=t.base.forceNum,this.name=t.base.name,this.sex=t.base.sex,this.head=t.base.head?t.base.head:"",this.headId=t.base.headId,this.headFrame=t.base.headFrame||0,this.showGodId=t.base.showGodId||c.GlobalData.DEFAULT_SHOW_GODID,this.showSkinId=t.base.showSkinId||c.GlobalData.DEFAULT_SHOW_SKINID,this.updateSelfHead(),this.playerId=t.playerId,this.equipKey=t.bag.equipKey,this.bagItemsObj=t.bag.items,this.bagEquipsObj=t.bag.equips,this.bagTimeItemsObj=t.bag.timeItems||{},this.gods=t.god.gods||{},this.skinIds=t.god.skinIds||[],this.godAwakens=t.god.godAwakens||[],this.maxStarLvInfo=t.god.maxStarLvInfo||{},this.level=null==t.base.level?1:t.base.level,game.HudModel.getInstance().oldUserLv=this.level,this.exp=t.base.exp,this.copyUnlockId=t.copy.copyUnlockId||1e3,this.lastProgressTime=t.extend.lastProgressTime||0,this.guildHelpEndTime=t.extend.guildHelpEndTime||0,this.treasureBooks=t.extend.treasureBooks||[],this.treasures=t.bag.treasures||{},game.TreasureModel.getInstance().initModel(),this.gemstones=t.bag.gemstones||{},game.GemstoneModel.getInstance().initData(),this.firstIds=t.extend.firstIds||[],this.godFateIds=t.extend.godFateIds||[],this.createTime=t.base.createTime,this.isNewPlayer=t.base.isNewPlayer,this.loginCount=t.welfare.loginCount,this.bindMobileAward=t.welfare.bindMobileAward,this.vip=t.base.vipLevel||0,this.mapBoxAwardIds=t.copy.mapBoxAwardIds||[],this.isReceiveWDXZ=0!=t.welfare.downloadApkAward,this.guildId=t.base.guildId||"",this.guildExp=t.base.guildExp||0,this.guildDonate=t.currency.guildDonate||0,this.guildName=t.base.guildName||"",this.guildCopyDamageInfo=t.extend.guildCopyDamageInfo||{},this.guildCopyMaxDmg=t.extend.guildCopyMaxDmg||{},this.guildCopyAwardInfo=t.extend.guildCopyAwardInfo||{},this.guildSkillInfo=t.extend.guildSkillInfo||{},this.guildWarAwardCount=t.extend.guildWarAwardCount||{},this.maxHistoryForce=t.extend.maxHistoryForce||0,this.artifactInfo=t.extend.artifactInfo||{},this.lineupArtifactInfo=t.extend.lineupArtifactInfo||{},this.artifactStrengthLv=t.extend.artifactStrengthLv||0,this.artifactSkillLv=t.extend.artifactSkillLv||1,this.artifactBaptizeLv=t.extend.artifactBaptizeLv||1,this.artifactBaptizeExp=t.extend.artifactBaptizeExp||0,this.artifactBaptizeAttrs=t.extend.artifactBaptizeAttrs||{},this.artifactStarLv=t.extend.artifactStarLv||0,this.artifactStarExp=t.extend.artifactStarExp||0,this.worshipInfo=t.extend.worshipInfo||{},this.diamond=t.currency.diamond||0,this.friend=t.currency.friend||0,this.arena=t.currency.arena||0,this.gold=t.currency.gold||0,this.convertDust=t.currency.convertDust||0,this.darkEssence=t.currency.darkEssence||0,this.godCrystal=t.currency.godCrystal||0,this.legendChip=t.currency.legendChip||0,this.soulStone=t.currency.soulStone||0,this.vipScore=t.currency.vipScore||0,this.lastLoginIp=t.base.lastLoginIp||"",this.runeCopyInfo=t.extend.runeCopyInfo||{},this.copyChallengeInfo=t.copy.copyChallengeInfo||{},this.groundCopyInfo=t.extend.groundCopyInfo||{},this.towerCopyInfo=t.extend.towerCopyInfo||{},this.towerAwardInfo=t.extend.towerAwardInfo||{},this.totalOnlineTime=t.extend.totalOnlineTime||0,this.onlineEndTime=t.extend.onlineEndTime||0,this.copyInfo=t.copy,this.copyInfo.helpGodId=this.copyInfo.helpGodId||[],this.copyInfo.friendHelpList=this.copyInfo.friendHelpList||[],this.dailyCopyIds=t.copy.dailyCopyIds||[];var e=iface.tb_prop.limitTypeKey,i=t.extend.limitInfo;for(var n in e)this.limitInfo[e[n]]=i&&i[e[n]]?i[e[n]]:0;var o=iface.tb_prop.overplusTypeKey,a=t.extend.overplusInfo;for(var n in o)this.overplusInfo[o[n]]=a&&a[o[n]]?a[o[n]]:0;this.lastGetAfkTime=t.extend.lastGetAfkTime||0,this.redPointInfo=t.extend.redPointInfo||{};var r=game.MailModel.getInstance();r.loginMailRp=!!this.redPointInfo[iface.tb_prop.redPointTypeKey.mail],r.loginPointRp=!!this.redPointInfo[iface.tb_prop.redPointTypeKey.point],game.FriendModel.getInstance().loginApplyRp=!!this.redPointInfo[iface.tb_prop.redPointTypeKey.friend],game.GuildModel.getInstance().hasNewApply=!!this.redPointInfo[iface.tb_prop.redPointTypeKey.guildApply],game.GuildCopyModel.getInstance().hasNewAward=!!this.redPointInfo[iface.tb_prop.redPointTypeKey.guildCopyAward],game.EscortModel.getInstance().hasNewRecord=!!this.redPointInfo[iface.tb_prop.redPointTypeKey.escort],game.IslandModel.getInstance().hasNewRecord=!!this.redPointInfo[iface.tb_prop.redPointTypeKey.mine],this.arenaClgListTime=t.extend.arenaClgListTime||0,this.arenaFailTime=t.extend.arenaFailTime||0,this.lineupInfo=t.extend.lineupInfo||{},this.godAlbum=t.extend.godAlbum||[],this.godExp=t.currency.godExp||0,this.worldBossReplyTime=t.extend.worldBossReplyTime||0,this.mineRobReplyTime=t.extend.mineRobReplyTime||0;var s=game.MatchModel.getInstance();for(var u in s.lastRefreshTime=t.extend.matchClgListTime||0,s.challengeCount=t.extend.clgMatchNum||0,s.doneMatchChests=t.extend.doneMatchChests||[],this.marketRefreshReplyTime=t.extend.marketRefreshReplyTime||0,this.escortTradeId=t.extend.escortTradeId,this.tasks=t.tasks||{},this.welfare=t.welfare||{},game.DafuwengModel.getInstance().initData(),this.isCertification=t.base.isCertification||0,this.isIndulge=t.base.isIndulge||0,this.indulgeEndTime=t.extend.indulgeEndTime||0,this.indulgeOnlineTime=t.extend.indulgeOnlineTime||0,this.indulgeOutlineTime=t.extend.indulgeOutlineTime||0,this.honour=t.currency.honour||0,this.godDomain=t.currency.godDomain||0,game.GloryModel.getInstance().updateServerPhase(),this.forestCurFloor=t.extend.forestCurFloor||0,this.forestMaxFloor=t.extend.forestMaxFloor||0,this.doneForestChests=t.extend.doneForestChests||0,this.summonScore=t.welfare.summonScore||0,this.doneSummonChests=t.welfare.doneSummonChests||[],game.CopyTeamModel.getInstance().initGroupData(t.friend),this.initTasks(),this.initEquipAry(),this._godAry=[],this.gods){var h=this.createGodVo(this.gods[u],u);this._godAry.push(h)}this.fightState(),this.setLimitBoxMintime(),Laya.stage.clearTimer(this,this.tickFun),Laya.stage.frameLoop(3,this,this.tickFun),this.putPatch();var l=App.serverTime;this._curDate.setTime(l),this._curDay=this._curDate.getDate()},e.prototype.putPatch=function(){var t=game.GuajiModel.getInstance().getMaxChapter();if(this.copyUnlockId<t){var e={};e[Protocol.game_copy_copyUnlock.args.id]=t,PLC.request(Protocol.game_copy_copyUnlock,e,function(t){t&&(App.hero.copyUnlockId=t.copyUnlockId)})}},Object.defineProperty(e.prototype,"arenaNum",{get:function(){return this.getOverplusValue(iface.tb_prop.overplusTypeKey.arenaNum)},enumerable:!0,configurable:!0}),e.prototype.getHeadId=function(){return this.headId},e.prototype.updateSelfHead=function(){var t=0<this.headId?this.headId:this.head&&""!=this.head?this.head:c.GlobalData.DEFAULT_HEAD;this.setHeadId(t)},e.prototype.setHeadId=function(t){this.headId=t,this.headIcon=SkinUtil.getHeroIcon(t)},e.prototype.tickFun=function(){var t=Laya.timer.delta;this.updateRedpoint(t),this.UpdateCrossDay(t),this.updateTimeItems(),App.hero.isIndulge&&this.updateIndulge(t)},e.prototype.UpdateCrossDay=function(t){if(this._curCrossTime+=t,!(this._curCrossTime<3e3)){this._curCrossTime=0;var e=App.serverTime;this._curDate.setTime(e);var i=this._curDate.getDate(),n=this._curDate.getSeconds();this._curDay!=i&&3<=n&&(App.updateCrossDayInfo(),this._curDay=i)}},e.prototype.updateTimeItems=function(){-1!=this._mintimeBox&&this._mintimeBox<=App.getServerTime()&&(this.setLimitBoxMintime(),dispatchEvt(new game.ResEvent(game.ResEvent.TIME_PROP_CHANGE)))},e.prototype.offline=function(){Laya.stage.clearTimer(this,this.tickFun),game.RedPointManager.removeAll(),this.initData=null},e.prototype.getCreateDayTiem=function(){var t=new Date(this.createTime);return t.setHours(0,0,0,0),t.getTime()},e.prototype.updateRedpoint=function(t){var s=this;this._time+=t,this._time<3300||(this._time=0,dispatchEvt(new game.OnlineEvent(game.OnlineEvent.RED_CHANGE_EVENT)),c.EffectList.updateEffectShow(),UIMgr.hasStage(UIConst.GuajiView)&&UIMgr.getUIByName(UIConst.GuajiView).updateShouchongTishi(),UIMgr.hasStage(UIConst.FightViews)||(PLC.request(Protocol.game_common_redPoint,null,function(t){for(var e=t&&t.redPointInfo?t.redPointInfo:[],i=game.MailModel.getInstance(),n=game.IslandModel.getInstance(),o=0,a=e;o<a.length;o++){var r=a[o];switch(r){case iface.tb_prop.redPointTypeKey.newMail:i.updateNewMail(!0);break;case iface.tb_prop.redPointTypeKey.newPoint:i.updateNewPoint(!0);break;case iface.tb_prop.redPointTypeKey.newFriend:game.FriendModel.getInstance().updateFriendApply(!0);break;case iface.tb_prop.redPointTypeKey.newArena:game.ArenaModel.getInstance().setNewRecordFlag(!0);break;case iface.tb_prop.redPointTypeKey.newRecharge:PLC.request(Protocol.game_recharge_updateRecharge,null,function(t){if(t){s.refreshWelfareData(t),t.diamond&&(s.diamond=t.diamond);var e=s.vip,i=s.vipScore;if(t.vipLevel&&(s.vip=t.vipLevel),t.vipScore&&(s.vipScore=t.vipScore),s.vip>e){var n={};n.oldVip=e,n.newVip=s.vip,n.oldScore=i,n.newScore=s.vipScore,game.ChongzhiModel.getInstance().chongzhiVipData=n}dispatchEvt(new game.ResEvent(game.ResEvent.RESOURCE_CHANGE)),dispatchEvt(new game.ResEvent(game.ResEvent.VIP_LEVEL_CHANGE)),dispatchEvt(new game.OpenserverEvent(game.OpenserverEvent.VIEW_CHANGE)),dispatchEvt(new game.TopUpEvent(game.TopUpEvent.SHOW_CHONGZHISUCC_PANEL),t),dispatchEvt(new game.HuodongEvent(game.TopUpEvent.CHONGZHI_SUCCESS),t)}});break;case iface.tb_prop.redPointTypeKey.sevenDay:PLC.request(Protocol.game_activity_updateSevenDayCondCount,null,function(){});break;case iface.tb_prop.redPointTypeKey.rechargeSum:case iface.tb_prop.redPointTypeKey.consumeSum:case iface.tb_prop.redPointTypeKey.singleRecharge:case iface.tb_prop.redPointTypeKey.dailyRecharge:case iface.tb_prop.redPointTypeKey.giftPacks:case iface.tb_prop.redPointTypeKey.exchange:case iface.tb_prop.redPointTypeKey.loginSum:case iface.tb_prop.redPointTypeKey.dailyRechargeSum:game.TimelimitModel.getInstance().refreshActivityByTab(r);break;case iface.tb_prop.redPointTypeKey.guildApply:game.GuildModel.getInstance().updateNewApply(!0);break;case iface.tb_prop.redPointTypeKey.guildCopyAward:game.GuildCopyModel.getInstance().updateNewAward(!0);break;case iface.tb_prop.redPointTypeKey.escort:game.EscortModel.getInstance().updateNewRecord(!0);break;case iface.tb_prop.redPointTypeKey.mine:n.updateNewRecord(!0),game.IslandQueueMgr.getInstance().requestRobbed(!0,!0);break;case iface.tb_prop.redPointTypeKey.myMine:n.clearMyInfo(),dispatchEvt(new game.IslandsEvent(game.IslandsEvent.UPDATE_ORE_LIST)),n.updateEndTime(!0),game.IslandQueueMgr.getInstance().requestRobbed(!0,!0);break;case iface.tb_prop.redPointTypeKey.inviteList:game.GodDmThread.getInstance().showInviteJoinView();break;case iface.tb_prop.redPointTypeKey.refuseInvite:game.GodDmThread.getInstance().noticeRefuse();break;case iface.tb_prop.redPointTypeKey.newCommon:PLC.request(Protocol.game_common_updateCommonData,null,function(t){});break;case iface.tb_prop.redPointTypeKey.inviteCopyList:game.CopyTeamThread.getInstance().showInviteJoinView();break;case iface.tb_prop.redPointTypeKey.refuseCopyInvite:game.CopyTeamThread.getInstance().noticeRefuse();break;case iface.tb_prop.redPointTypeKey.groupCopyChange:game.CopyTeamThread.getInstance().requestMyTeamInfo();break;case iface.tb_prop.redPointTypeKey.applyGroupCopy:game.CopyTeamThread.getInstance().getApplyList();break;case iface.tb_prop.redPointTypeKey.groupCopyKick:game.CopyTeamThread.getInstance().requestMyTeamInfo(),showToast(LanMgr.getLan("",10211));break;case iface.tb_prop.redPointTypeKey.groupCopyAppoint:game.CopyTeamThread.getInstance().requestMyTeamInfo(),showToast(LanMgr.getLan("",10212))}}},!1),dispatchEvt(new game.HudEvent(game.HudEvent.UPDATE_CHATNOTICE_TEXT))))},e.prototype.updateIndulge=function(t){this._IndulgeCountTime+=t,this._IndulgeCountTime<2e4&&this._IndulgeLoginRemind||(this._IndulgeCountTime=0)},e.prototype.baseAddVipNum=function(t){var e=tb.TB_vip.get_TB_vipById(this.vip);switch(t){case iface.tb_prop.vipPrivilegeTypeKey.wishNum:return e?e.wish_limit+tb.TB_wish_set.get_TB_wish_set().max_num:tb.TB_wish_set.get_TB_wish_set().max_num;case iface.tb_prop.vipPrivilegeTypeKey.godMaxNum:return e?e.god_limit+tb.TB_game_set.get_TB_game_setById(1).limit_god:tb.TB_game_set.get_TB_game_setById(1).limit_god;case iface.tb_prop.vipPrivilegeTypeKey.arenaBuyNum:return e?e.arena_buy+tb.TB_arena_new_set.getArenaNewSet().buy_limit:tb.TB_arena_new_set.getArenaNewSet().buy_limit;case iface.tb_prop.vipPrivilegeTypeKey.hangupIncome:return e?e.hang_up:0;case iface.tb_prop.vipPrivilegeTypeKey.offlineIncomeTime:var i=tb.TB_copy_set.getCopySet().offline_time;return 1==App.hero.welfare.lifelongCard?tb.TB_month_card.getTbMonthCardById(2).offline_time+i:i;case iface.tb_prop.vipPrivilegeTypeKey.quickBattleNum:return e?e.fast_fighting+tb.TB_copy_set.getCopySet().fast_fighting:tb.TB_copy_set.getCopySet().fast_fighting;case iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum:return e?e.daily_copy+tb.TB_copy_set.getCopySet().daily_copy_buy:tb.TB_copy_set.getCopySet().daily_copy_buy;case iface.tb_prop.vipPrivilegeTypeKey.guildCopyBuyNum:return e?e.guildcopy_buy+tb.TB_guild_set.getSet().copy_buy:tb.TB_guild_set.getSet().copy_buy;case iface.tb_prop.vipPrivilegeTypeKey.goldBuyNum:return e?e.gold_exchange+tb.TB_exchange_set.getSet().num:tb.TB_exchange_set.getSet().num+tb.TB_exchange_set.getSet().daily_free;case iface.tb_prop.vipPrivilegeTypeKey.worldBossNum:return e?e.worldboss+tb.TB_boss_set.getSet().normal_buy:tb.TB_boss_set.getSet().normal_buy;case iface.tb_prop.vipPrivilegeTypeKey.runeCopyExtraNum:return e?e.sweep_add:0;case iface.tb_prop.vipPrivilegeTypeKey.matchBuyNum:return e?e.match_buy+tb.TB_match_set.getSet().buy_limit:tb.TB_match_set.getSet().buy_limit;case iface.tb_prop.vipPrivilegeTypeKey.godDmRewardNum:return e?e.fight_goddomain+tb.TB_fight_goddomain_set.getSet().buy_num:tb.TB_fight_goddomain_set.getSet().buy_num}return 0},e.prototype.totalFreeCount=function(t){var e=0;switch(t){case iface.tb_prop.limitTypeKey.fastFrightFreeNum:e=tb.TB_copy_set.getCopySet().free_fastfight_num,App.hero.welfare.monthCardEndTime>App.getServerTime()&&(e+=tb.TB_month_card.getTbMonthCardById(1).free_fastfight_num)}return e},e.prototype.levelPrivilege=function(t){var e=tb.TB_vip_privilege.get_TB_vip_privilegeById(t);return!(!e||!(e.vip_level<=this.vip||e.general_level<=this.level))&&(0==e.para||e.para)},e.prototype.refreshWelfareData=function(t){for(var e in t)null!=this.welfare[e]&&(this.welfare[e]=t[e])},e.prototype.refreshShopData=function(){dispatchEvt(new game.ShopEvent(game.ShopEvent.REFRESH_SHOP_CROSSDAY))},e.prototype.updateCrossDayInfo=function(t){this.updateCopyInfo(t),game.YuanzhengModel.getInstance().resetDataByCrossDay(),t.hasOwnProperty("forestCurFloor")&&(this.forestCurFloor=t.forestCurFloor,dispatchEvt(new game.FogForestEvent(game.FogForestEvent.UPDATE_VIEW))),this.refreshShopData(),this.refreshWelfareData(t),t.overplusInfo&&(this.overplusInfo=t.overplusInfo,dispatchEvt(new game.ResEvent(game.ResEvent.LIMIT_VALUE_CHANGE))),t.limitInfo&&(this.limitInfo=t.limitInfo,dispatchEvt(new game.ResEvent(game.ResEvent.LIMIT_VALUE_CHANGE))),this.refreshData(t,Protocol.game_common_getCrossDayInfo.name),game.TaskModel.getInstance().resetDataByCrossDay(t),game.TimelimitModel.getInstance().refreshActivity(),game.HuodongModel.getInstance().refreshActivity();var e=new Date;e.setTime(App.serverTime),e.getDay()==WeekNum.Mon&&(game.GloryModel.getInstance().weekRest(),(UIMgr.hasStage(UIConst.GloryFightView)||UIMgr.hasStage(UIConst.GloryLastReview))&&dispatchEvt(new game.GloryEvent(game.GloryEvent.SHOW_MAIN_VIEW))),game.GuildHelpModel.getInstance().clearCrossDayData(),dispatchEvt(new game.HuodongEvent(game.HuodongEvent.AWARD_EVENT)),dispatchEvt(new game.HudEvent(game.HudEvent.UPDATE_CROSS_DAY_INFO))},e.prototype.initEquipAry=function(){for(var t in this._equipAry=[],this.bagEquipsObj){var e=new EquipItemVo(this.bagEquipsObj[t]);e.uuid=t,this._equipAry.push(e)}},e.prototype.getEquipByuuid=function(e){return this._equipAry.find(function(t){return t.uuid==e})},e.prototype.setEquipAryByUuid=function(t,e){for(var i in this._equipAry)if(this._equipAry[i].uuid==t){this._equipAry[i].godId=this.bagEquipsObj[t].godId,game.BagModel.getInstance().updateEquObj(t,game.EQUTYPE.MODIFY,this._equipAry[i]),dispatchEvt(new game.BagEvent(game.BagEvent.CHANGE_EQUIP_ITEM),{type:game.EQUTYPE.MODIFY,vo:this._equipAry[i]});break}},e.prototype.createItemVo=function(t,e){var i=tb.TB_item.get_TB_itemById(e),n=Number(e),o=i.type;return new ItemVo(n,t,o)},e.prototype.getGodsNum=function(){return this._godAry.length},e.prototype.getEqusNum=function(){return this._equipAry.length},e.prototype.setGodAryByUuid=function(t,e){for(var i in this._godAry)if(this._godAry[i].uuid==t){var n=this.createGodVo(this.gods[t],t),o=(this._godAry[i].getShenli(),n.getShenli());0==e&&(this._godAry[i].equipKeys=n.equipKeys,this._godAry[i].fightPower=o);break}},e.prototype.getGodArr=function(){return this._godAry},e.prototype.sortGodList=function(i,t){var e=new Array;if(-1==t)e=__spreadArrays(this._godAry);else{e=new Array;for(var n=0;n<this._godAry.length;n++){var o=this._godAry[n];o.tab_god.type!=t&&e.push(o)}}return e.sort(function(t,e){if(i==iface.tb_prop.lineupTypeKey.attack){if(t.local[0]!=e.local[0])return t.local[0]-e.local[0]}else if(i==iface.tb_prop.lineupTypeKey.expedition&&t.local[2]!=e.local[2])return t.local[2]-e.local[2];return t.inLine()==e.inLine()?t.isInLinuep()?e.fightPower-t.fightPower:t.level==e.level?t.starLevel==e.starLevel?t.tab_god.race_type==e.tab_god.race_type?e.templateId-t.templateId:t.tab_god.race_type-e.tab_god.race_type:e.starLevel-t.starLevel:e.level-t.level:t.inLine()-e.inLine()}),e},e.prototype.createGodVo=function(t,e){var i=this.getGodVoById(e);if(i)for(var n in t)i[n]=t[n];else i=GodItemVo.getData(t,e);if(i.equipKeys=[],t.equipKeys)for(var o in t.equipKeys)if(t.equipKeys[o]){var a=App.hero.getEquipByuuid(t.equipKeys[o]);if(!a){logerror("不存在该装备：",o);continue}i.equipKeys.push(a)}if(i.treasureKeys=[],t.treasureKeys)for(var o in t.treasureKeys)if(t.treasureKeys[o]){var r=game.TreasureModel.getInstance().getTreasureByUuid(t.treasureKeys[o]);r||logerror("没有该圣物:",t.treasureKeys[o]),i.treasureKeys.push(r)}return i.setgemInfo(t.gemInfo),i.fightPower=i.getShenli(),i},e.prototype.getGodVoById=function(t){for(var e=0;e<this._godAry.length;e++)if(this._godAry[e].uuid==t)return this._godAry[e];return null},e.prototype.getEquips=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1);var i=this._equipAry.filter(function(t){return 0==e||t.slot==e});return t&&i.sort(function(t,e){return e.getSortNum()-t.getSortNum()}),i},e.prototype.getEquipBagByType=function(t){void 0===t&&(t=0);for(var e=this.getEquips(t,!0),i=[],n=0;n<e.length;)e[n].godId?(i.push(e[n]),e.splice(Number(n),1)):n++;return i.concat(e)},e.prototype.refreshData=function(t,e){if(void 0===e&&(e=""),t){t.hasOwnProperty("doneTask")&&this.addDoneTask(t.doneTask),t.hasOwnProperty("doneDaily")&&this.addDoneDailyTask(t.doneDaily),t.hasOwnProperty("doneChests")&&(this.tasks.doneChests=t.doneChests,dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_LIVENESS_DATA)));var i=t.hasOwnProperty("warriorLevel"),n=t.hasOwnProperty("warriorExp");if((i||n)&&(i&&(this.tasks.warriorLevel=t.warriorLevel),n&&(this.tasks.warriorExp=t.warriorExp),dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_WARRIOR_EXP))),t.runeCopyInfo&&(this.runeCopyInfo=t.runeCopyInfo,dispatchEvt(new game.GuajiEvent(game.GuajiEvent.UPDATE_FUWEN_COPY_INFO))),t.copyChallengeInfo)for(var o in t.copyChallengeInfo)this.copyChallengeInfo[o]=t.copyChallengeInfo[o];if(t.addGodFateId){var a=Number(t.addGodFateId);-1==this.godFateIds.indexOf(a)&&this.godFateIds.push(a)}if(t.addSkinId&&(a=Number(t.addSkinId),-1==this.skinIds.indexOf(a)&&this.skinIds.push(a),dispatchEvt(new game.GodEvent(game.GodEvent.ADD_SKINID),a)),t.addGodAwakens&&(a=Number(t.addGodAwakens),-1==this.godAwakens.indexOf(a)&&this.godAwakens.push(a)),t.towerCopyInfo&&(this.towerCopyInfo=t.towerCopyInfo,game.TowerModel.getInstance().updateData(),dispatchEvt(new game.TowerEvent(game.TowerEvent.PROGRESS_CHANGE))),t.towerAwardInfo&&(this.towerAwardInfo=t.towerAwardInfo,game.TowerModel.getInstance().updateData(),dispatchEvt(new game.TowerEvent(game.TowerEvent.GET_BOSS_AWARD_SUC))),t.forestMaxFloor&&(this.forestMaxFloor=t.forestMaxFloor,dispatchEvt(new game.FogForestEvent(game.FogForestEvent.CHALLENGE_SUCCESS))),t.doneForestChests&&(this.doneForestChests=t.doneForestChests,dispatchEvt(new game.FogForestEvent(game.FogForestEvent.CHALLENGE_SUCCESS))),t.summonScore&&(this.summonScore=t.summonScore),null!=t.arenaFailTime&&(this.arenaFailTime=t.arenaFailTime),t.doneSummonChests&&(this.doneSummonChests=t.doneSummonChests),t.monthCardAward&&(this.welfare.monthCardAward=t.monthCardAward),t.openSvrGiftAwardNums&&(this.welfare.openSvrGiftAwardNums=t.openSvrGiftAwardNums,dispatchEvt(new game.OpenserverEvent(game.OpenserverEvent.OS_GIFT_CHANGE))),t.sevendayAwardCount){var r=getobjectFirstAttribute(t.sevendayAwardCount);this.welfare.sevendayInfo||(this.welfare.sevendayInfo={}),this.welfare.sevendayInfo[r]||(this.welfare.sevendayInfo[r]={}),this.welfare.sevendayInfo[r].rewardCount=t.sevendayAwardCount[r]}if(t.sevendayExtraAward){var s=getobjectFirstAttribute(t.sevendayExtraAward);this.welfare.sevendayExtraAward[s]=t.sevendayExtraAward[s]}if(t.luckEquipAward){var u=getobjectFirstAttribute(t.luckEquipAward);this.welfare.luckEquipAward[u]=t.luckEquipAward[u],dispatchEvt(new game.HuodongEvent(game.HuodongEvent.LUCK_EQUIP_REWARD_CHANGE))}if(t.lifelongCardAward&&(this.welfare.lifelongCardAward=t.lifelongCardAward),t.signInLoginCount&&(this.welfare.signInLoginCount=t.signInLoginCount),t.signInVipCount&&(this.welfare.signInVipCount=t.signInVipCount),t.signInRechargeCount&&(this.welfare.signInRechargeCount=t.signInRechargeCount),t.todaySignIn&&(this.welfare.todaySignIn=t.todaySignIn),null!=t.luckGodNum&&(this.welfare.luckGodNum=t.luckGodNum,dispatchEvt(new game.HuodongEvent(game.HuodongEvent.LUCK_GOD_VALUE_CHANGE))),t.autonymAwardNum&&(this.welfare.autonymAwardNum=t.autonymAwardNum),null!=t.luckEquipNum&&(this.welfare.luckEquipNum=t.luckEquipNum,dispatchEvt(new game.HuodongEvent(game.HuodongEvent.LUCK_EQUIP_VALUE_CHANGE))),null!=t.luckTreasureNum&&(this.welfare.luckTreasureNum=t.luckTreasureNum,dispatchEvt(new game.HuodongEvent(game.HuodongEvent.LUCK_TREASURE_VALUE_CHANGE))),t.dailySignIn){var h=getobjectFirstAttribute(t.dailySignIn);this.welfare.dailySignIn[h]=t.dailySignIn[h]}if(t.levelFundAward&&(h=getobjectFirstAttribute(t.levelFundAward),this.welfare.levelFundAward[h]=t.levelFundAward[h]),t.loginGiftPack&&(h=getobjectFirstAttribute(t.loginGiftPack),this.welfare.loginGiftPack[h]=t.loginGiftPack[h],dispatchEvt(new game.HuodongEvent(game.HuodongEvent.LOGIN_GIFT_RECEIVE))),t.firstRecharge){var l=getobjectFirstAttribute(t.firstRecharge);this.welfare.firstRecharge[l]=t.firstRecharge[l]}if(t.totalSignIn){var c=getobjectFirstAttribute(t.totalSignIn);this.welfare.totalSignIn[c]=t.totalSignIn[c]}if(t.levelGiftPack){var p=getobjectFirstAttribute(t.levelGiftPack);this.welfare.levelGiftPack[p]=t.levelGiftPack[p]}if(t.levelGiftPack){var d=getobjectFirstAttribute(t.levelGiftPack);this.welfare.levelGiftPack[d]=t.levelGiftPack[d]}if(t.modifyWorshipInfo){var _=getobjectFirstAttribute(t.modifyWorshipInfo);this.worshipInfo[_]=t.modifyWorshipInfo[_],dispatchEvt(new game.RankingListEvent(game.RankingListEvent.RANK_MOBAI_CHANGE))}if(t.addMapBoxAwardIds&&(this.mapBoxAwardIds.push(t.addMapBoxAwardIds),dispatchEvt(new game.GuajiEvent(game.GuajiEvent.FUBEN_REWARD_CHANGE))),t.dayRechargeLimit){for(var f in t.dayRechargeLimit)this.welfare.dayRechargeLimit||(this.welfare.dayRechargeLimit={}),this.welfare.dayRechargeLimit[f]=t.dayRechargeLimit[f];dispatchEvt(new game.TopUpEvent(game.TopUpEvent.XIANGOU_LIBAO_CHANGE))}if(t.weekRechargeLimit){for(var f in t.weekRechargeLimit)this.welfare.weekRechargeLimit||(this.welfare.weekRechargeLimit={}),this.welfare.weekRechargeLimit[f]=t.weekRechargeLimit[f];dispatchEvt(new game.TopUpEvent(game.TopUpEvent.XIANGOU_LIBAO_CHANGE))}if(t.monthRechargeLimit){for(var f in t.monthRechargeLimit)this.welfare.monthRechargeLimit||(this.welfare.monthRechargeLimit={}),this.welfare.monthRechargeLimit[f]=t.monthRechargeLimit[f];dispatchEvt(new game.TopUpEvent(game.TopUpEvent.XIANGOU_LIBAO_CHANGE))}if(t.openSvrRechargeSum&&(this.welfare.openSvrRechargeSum=t.openSvrRechargeSum,dispatchEvt(new game.TimelimitEvent(game.TimelimitEvent.GROUP_RED_EVENT))),t.weekFundAwardId&&(this.welfare.weekFundAward.push(t.weekFundAwardId),dispatchEvt(new game.TimelimitEvent(game.TimelimitEvent.FUND_RED_EVENT))),t.weekFund&&(this.welfare.weekFund=t.weekFund?0===t.weekFund?[]:t.weekFund:[],dispatchEvt(new game.TimelimitEvent(game.TimelimitEvent.FUND_EVENT)),dispatchEvt(new game.TimelimitEvent(game.TimelimitEvent.FUND_RED_EVENT))),null!=t.totalLoginDay&&(this.welfare.totalLoginDay=t.totalLoginDay,dispatchEvt(new game.HuodongEvent(game.HuodongEvent.TOTAL_LOGIN_DAY))),(t.monthCardAward||t.lifelongCardAward||t.todaySignIn||t.dailySignIn||t.monthCardGiftNum||0==t.monthCardGiftNum||t.lifeLongCardGiftNum||0==t.lifeLongCardGiftNum||t.loginGiftPack||t.firstRecharge||t.totalSignIn||t.firstRechargeTime||t.levelGiftPack||t.luckEquipAward||t.autonymAwardNum||t.signInLoginCount||t.levelFundAward)&&dispatchEvt(new game.HuodongEvent(game.HuodongEvent.AWARD_EVENT)),t.targetGod)for(var o in t.targetGod)if(t.targetGod.hasOwnProperty(o)){for(var g=this.createGodVo(t.targetGod[o],o),y=0;y<this._godAry.length;y++){var m=this._godAry[y];m.uuid==g.uuid&&(g.isAttackFight=m.isAttackFight,g.isDefendFight=m.isDefendFight,g.isYuanzhengFight=m.isYuanzhengFight,g.local=m.local,g.fightPower=g.getShenli(),g.awakenLv=Math.max(g.awakenLv,m.awakenLv),g.level=Math.max(g.level,m.level))}var v=this.gods[o],b=t.targetGod[o];this.gods[o]=this.checkVo(v,b),dispatchEvt(new game.GodEvent(game.GodEvent.GOD_PORP_CHANGE),g)}if(t.targetEquips){var I=void 0;for(var o in t.targetEquips)if(this.bagEquipsObj[o]=t.targetEquips[o],t.targetEquips.hasOwnProperty(o)){var T=t.targetEquips[o],w=this.getEquipByuuid(o);w&&(w.updateData(T),game.BagModel.getInstance().updateEquObj(w.uuid,game.EQUTYPE.MODIFY,w),dispatchEvt(new game.BagEvent(game.BagEvent.CHANGE_EQUIP_ITEM),{type:game.EQUTYPE.MODIFY,vo:w}),w.godId&&(I=w.godId))}I&&(this.setGodAryByUuid(I,0),dispatchEvt(new game.EquipEvent(game.EquipEvent.CHANGE_EQUIP_ITEM),!0))}if(null!=t.artifactStrengthLv&&(this.artifactStrengthLv=t.artifactStrengthLv,dispatchEvt(new game.ArtifactEvent(game.ArtifactEvent.ARTIFACT_STRENGTH_LV_CHANGE),[this.artifactStrengthLv])),null!=t.artifactSkillLv&&(this.artifactSkillLv=t.artifactSkillLv,dispatchEvt(new game.ArtifactEvent(game.ArtifactEvent.ARTIFACT_SKILL_LV_CHANGE),[this.artifactSkillLv])),null!=t.artifactBaptizeLv||null!=t.artifactBaptizeExp||null!=t.artifactBaptizeAttrs||null!=t.tmpBaptizeAttrs){null!=t.artifactBaptizeLv&&(this.artifactBaptizeLv=t.artifactBaptizeLv),null!=t.artifactBaptizeExp&&(this.artifactBaptizeExp=t.artifactBaptizeExp),null!=t.artifactBaptizeAttrs&&(this.artifactBaptizeAttrs=t.artifactBaptizeAttrs,this.artifactBaptizeTempAttr={});var E=Artifact.CHANGE;null!=t.tmpBaptizeAttrs&&(E=Artifact.GBAPTIZE,this.artifactBaptizeTempAttr=t.tmpBaptizeAttrs),dispatchEvt(new game.ArtifactEvent(game.ArtifactEvent.ARTIFACT_BAPTIZE_CHANGE),E)}if(null==t.artifactStarLv&&null==t.artifactStarExp||(null!=t.artifactStarLv&&(this.artifactStarLv=t.artifactStarLv),null!=t.artifactStarExp&&(this.artifactStarExp=t.artifactStarExp),dispatchEvt(new game.ArtifactEvent(game.ArtifactEvent.ARTIFACT_STAR_CHANGE))),null!=t.artifactInfo){var C=[];for(var S in t.artifactInfo)this.artifactInfo[S]=t.artifactInfo[S],C.push(Number(S));dispatchEvt(new game.ArtifactEvent(game.ArtifactEvent.ARTIFACT_ACTIVE),C)}if(null!=t.guildCopyMaxDmg)for(var L in C=[],t.guildCopyMaxDmg)this.guildCopyMaxDmg[L]=t.guildCopyMaxDmg[L];if(null!=t.advanceLevel){var x=this.tasks.advanceLevel;this.tasks.advanceLevel=t.advanceLevel,dispatchEvt(new game.UpRoadEvent(game.UpRoadEvent.UR_LEVEL_CHANGE),[this.tasks.advanceLevel,x])}if(null!=t.modifyAdvanceReward){for(var A in C=[],t.modifyAdvanceReward)this.tasks.advanceInfos[A].reward=t.modifyAdvanceReward[A],C.push(Number(A));dispatchEvt(new game.UpRoadEvent(game.UpRoadEvent.UR_REWARD_CHANGE),C)}this.updateDailyCopy(t);var M=t.commonData;M&&this.refreshCommonData(M);var D=t.firstData;D&&this.refreshCommonData(D),t.targetTreasure&&game.TreasureModel.getInstance().updateTargetTreasures(t.targetTreasure)}},e.prototype.checkVo=function(t,e){var i={};for(var n in e)t.hasOwnProperty(n)&&-1!=this.checkKey.indexOf(n)?i[n]=Math.max(e[n],t[n]):i[n]=e[n];return i},e.prototype.refreshCommonData=function(t){if(t.addFirstIds&&(this.firstIds=this.firstIds.concat(t.addFirstIds)),t.delEquips){var e=t.delEquips;for(var i in t.delEquips){var n=t.delEquips[i];delete this.bagEquipsObj[n],game.BagModel.getInstance().updateEquObj(n,game.EQUTYPE.DEL)}for(var o=this._equipAry.length-1;0<=o;o--)-1!=e.indexOf(this._equipAry[o].uuid)&&this._equipAry.splice(o,1);dispatchEvt(new game.BagEvent(game.BagEvent.CHANGE_EQUIP_ITEM),{type:game.EQUTYPE.DEL,vo:null}),dispatchEvt(new game.ResEvent(game.ResEvent.EQUIPMENET_CHANGE))}if(t.addEquips){for(var i in t.addEquips)t.addEquips.hasOwnProperty(i)&&(this.bagEquipsObj[i]=t.addEquips[i],(v=new EquipItemVo(t.addEquips[i])).uuid=i,this._equipAry.push(v),game.BagModel.getInstance().updateEquObj(v.uuid,game.EQUTYPE.ADD,v));dispatchEvt(new game.BagEvent(game.BagEvent.CHANGE_EQUIP_ITEM),{type:game.EQUTYPE.ADD,vo:null}),dispatchEvt(new game.ResEvent(game.ResEvent.EQUIPMENET_CHANGE))}if(t.modifyEquips||t.modifyGodEquips){if(t.modifyEquips)for(var o in t.modifyEquips)this.bagEquipsObj[o]&&(this.bagEquipsObj[o].godId=t.modifyEquips[o],this.setEquipAryByUuid(o,t.modifyEquips[o]));if(t.modifyGodEquips)for(var o in t.modifyGodEquips)this.gods[o]&&(this.gods[o].equipKeys=t.modifyGodEquips[o],this.setGodAryByUuid(o,0));dispatchEvt(new game.EquipEvent(game.EquipEvent.CHANGE_EQUIP_ITEM),!0),dispatchEvt(new game.ResEvent(game.ResEvent.EQUIPMENET_CHANGE))}if(t.addTreasureBook)for(var a=0,r=t.addTreasureBook;a<r.length;a++){var s=r[a];-1==this.godFateIds.indexOf(s)&&this.treasureBooks.push(s)}var u=game.TreasureModel.getInstance();t.addTreasures&&u.addTreasure(t.addTreasures),t.delTreasures&&u.delTreasure(t.delTreasures),t.modifyTreasureNum&&u.modifyNum(t.modifyTreasureNum),t.modifyTreasures&&u.modifyTreasures(t.modifyTreasures),t.modifyGodTreasures&&u.modifyGodTreasures(t.modifyGodTreasures);var h=game.GemstoneModel.getInstance();if(t.addGemstones&&h.addGemstones(t.addGemstones),t.delGemstones&&h.delGemstone(t.delGemstones),t.modifyGemstoneNum&&h.modifyNum(t,t.modifyGemstoneNum),t.modifyGemstones&&h.modifyGemstones(t,t.modifyGemstones),t.modifyGodGemstones&&h.modifyGodGemstones(t.modifyGodGemstones),t.modifySevenDays){this.welfare.sevendayInfo||(this.welfare.sevendayInfo={});var l=t.modifySevenDays;for(var c in l)this.welfare.sevendayInfo[c]||(this.welfare.sevendayInfo[c]={}),this.welfare.sevendayInfo[c].condCount=l[c];dispatchEvt(new game.SevendaysEvent(game.SevendaysEvent.SEVENDAYS_RED_EVENT))}if(t.modifyForce&&(this.force=t.modifyForce,dispatchEvt(new game.HudEvent(game.HudEvent.UPDATE_POWER))),t.modifyCondInfo&&game.TimelimitModel.getInstance().updateData(t.modifyCondInfo),t.modifyLineups&&(l=t.modifyLineups,this.refreshLineUp(l)),t.vipLevel&&(this.vip=t.vipLevel,dispatchEvt(new game.ResEvent(game.ResEvent.VIP_LEVEL_CHANGE))),t.addResource&&(this.refreshres(t.addResource,!0),dispatchEvt(new game.ResEvent(game.ResEvent.RESOURCE_CHANGE))),t.costResource&&(this.refreshres(t.costResource,!1),dispatchEvt(new game.ResEvent(game.ResEvent.RESOURCE_CHANGE))),t.lastProgressTime&&(this.lastProgressTime=t.lastProgressTime,dispatchEvt(new game.GuajiEvent(game.GuajiEvent.CHANGE_GUAJI_BTN))),t.addBagItems&&(this.refreshbag(t.addBagItems,!0),dispatchEvt(new game.ResEvent(game.ResEvent.PROP_CHANGE))),t.delBagItems&&(this.refreshbag(t.delBagItems,!1),dispatchEvt(new game.ResEvent(game.ResEvent.PROP_CHANGE))),t.addGodAlbum&&(this.godAlbum=this.godAlbum.concat(t.addGodAlbum),dispatchEvt(new game.TujianEvent(game.TujianEvent.ACTIVITY_TUJIAN_SUCC))),t.addRechargeNum&&(this.welfare.rechargeSum+=t.addRechargeNum),t.modifyMaxHistoryForce&&(this.maxHistoryForce=t.modifyMaxHistoryForce),t.modifyTasks&&this.refreshTasks(t.modifyTasks),t.modifyDailys&&this.refreshDailyTask(t.modifyDailys),t.modifyLimits){for(var p in t.modifyLimits)this.limitInfo[p]=t.modifyLimits[p];dispatchEvt(new game.ResEvent(game.ResEvent.LIMIT_VALUE_CHANGE))}if(t.modifyOverplus){for(var p in t.modifyOverplus)this.overplusInfo[p]=t.modifyOverplus[p];dispatchEvt(new game.ResEvent(game.ResEvent.OVERPLUS_VALUE_CHANGE))}if(t.modifyReplyTime&&(this.worldBossReplyTime=t.modifyReplyTime,game.BossModel.getInstance().refreshInterval()),t.modifyMineRobReplyTime&&(this.mineRobReplyTime=t.modifyMineRobReplyTime,game.IslandUtil.resetInterval()),null!=t.modifyAdvanceCount){var d=[];for(var _ in t.modifyAdvanceCount)this.tasks.advanceInfos[_].count=t.modifyAdvanceCount[_],d.push(Number(_));dispatchEvt(new game.UpRoadEvent(game.UpRoadEvent.UR_COUNT_CHANGE),d)}if(null!=t.modifyMaxStarLvInfo){for(var f in t.modifyMaxStarLvInfo)this.maxStarLvInfo[f]=t.modifyMaxStarLvInfo[f];dispatchEvt(new game.GodEvent(game.GodEvent.GOD_MAX_STAR_LV_CHANGE))}null!=t.modifyMarketRefreshTime&&(this.marketRefreshReplyTime=t.modifyMarketRefreshTime,dispatchEvt(new game.ShopEvent(game.ShopEvent.MARKET_REFRESH_REPLY_TIME_CHNAGE)));var g=t.hasOwnProperty("modifyWarriorWeekCount"),y=t.hasOwnProperty("modifyWarriorMonthCount");if((g||y)&&(g&&game.TrialTaskModel.getInstance().modifyFinishNum(t.modifyWarriorWeekCount,!0),y&&game.TrialTaskModel.getInstance().modifyFinishNum(t.modifyWarriorMonthCount,!1)),t.hasOwnProperty("warriorAdvance")&&(this.tasks.warriorAdvance=t.warriorAdvance,dispatchEvt(new game.TaskEvent(game.TaskEvent.UNLOCK_WARRIOR_JINJIE_SUCC))),t.hasOwnProperty("warriorLevel")&&(this.tasks.warriorLevel=t.warriorLevel,dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_WARRIOR_EXP))),t.addGods){var m=new Array;for(var i in t.addGods)if(t.addGods.hasOwnProperty(i)){this.gods[i]=t.addGods[i];var v=this.createGodVo(t.addGods[i],i);this._godAry.push(v),m.push(v)}dispatchEvt(new game.GodEvent(game.GodEvent.ADD_GODS)),dispatchEvt(new game.SummonEvent(game.SummonEvent.SHOW_SUM_RESULT_PANEL),{godlist:m,reward:t.addResource})}if(t.delGods){for(var i in t.delGods)delete this.gods[t.delGods[i]];function b(e){var t=I._godAry.findIndex(function(t){return t.uuid==e});-1!=t&&I._godAry.splice(t,1)}for(var I=this,T=0,w=t.delGods;T<w.length;T++)b(C=w[T]);dispatchEvt(new game.GodEvent(game.GodEvent.GOD_CHANGE),1)}if(t.addTimeItems){for(var E in t.addTimeItems){var C=Number(E);this.bagTimeItemsObj[C]?logerror("道具重复下发：",C):(l=this.bagTimeItemsObj[C]=t.addTimeItems[C],game.BagModel.getInstance().updateLimitTimeRes(C,game.LIMITTIMETYPE.ADD,t.addTimeItems[C]),v=new LimitItemVo(C,Number(l.limitTime),l.templateId,1),dispatchEvt(new game.BagEvent(game.BagEvent.CHANGE_ITEM),v),game.addTimeItem2Group(C,l),l.limitTime>App.getServerTime()&&(this._mintimeBox=-1==this._mintimeBox?l.limitTime:Math.min(l.limitTime,this._mintimeBox)))}dispatchEvt(new game.ResEvent(game.ResEvent.PROP_CHANGE))}if(t.delTimeItems){for(var S=0;S<t.delTimeItems.length;S++){var L=Number(t.delTimeItems[S]);this.bagTimeItemsObj.hasOwnProperty(L)&&(game.BagModel.getInstance().updateLimitTimeRes(L,game.LIMITTIMETYPE.DEL),v=new LimitItemVo(L,Number(this.bagTimeItemsObj[L].limitTime),Number(this.bagTimeItemsObj[L].templateId),0),dispatchEvt(new game.BagEvent(game.BagEvent.CHANGE_ITEM),v),game.removeTimeItem2Group(L),delete this.bagTimeItemsObj[L])}dispatchEvt(new game.ResEvent(game.ResEvent.PROP_CHANGE))}},e.prototype.modifyCopyAwardCount=function(t){if(t&&t.modifyCopyAwardCount)for(var e in t.modifyCopyAwardCount)this.guildCopyAwardInfo[e]=t.modifyCopyAwardCount[e]},e.prototype.refreshres=function(t,e){for(var i in t){var n=Number(t[i]);switch(parseInt(i)){case iface.tb_prop.resTypeKey.gold:this.gold=e?this.gold+n:this.gold-n;break;case iface.tb_prop.resTypeKey.diamond:this.diamond=e?this.diamond+n:this.diamond-n;var o=App.hero,a=window.platform.serverInfo;BingoSDK.gameReport("itemChange",o.playerId,o.accountName,a.serverId,a.srv_name,{itemName:"diamond",count:(e?n:-n).toString(),reason:"",balance:this.diamond});break;case iface.tb_prop.resTypeKey.friend:this.friend=e?this.friend+n:this.friend-n;break;case iface.tb_prop.resTypeKey.arena:this.arena=e?this.arena+n:this.arena-n;break;case iface.tb_prop.resTypeKey.roleExp:this.exp=e?this.exp+n:this.exp-n,this.calculateLv(),dispatchEvt(new game.ResEvent(game.ResEvent.ROLE_EXP_CHANGE));break;case iface.tb_prop.resTypeKey.godExp:this.godExp=e?this.godExp+n:this.godExp-n,dispatchEvt(new game.ResEvent(game.ResEvent.GOD_EXP_CHANGE));break;case iface.tb_prop.resTypeKey.guildExp:this.guildExp=e?this.guildExp+n:this.guildExp-n,game.GuildModel.getInstance().updateGuildExp(this.guildExp);break;case iface.tb_prop.resTypeKey.guildDonate:this.guildDonate=e?this.guildDonate+n:this.guildDonate-n,dispatchEvt(new game.ResEvent(game.ResEvent.GUILE_DONATE_CHANGE));break;case iface.tb_prop.resTypeKey.convertDust:this.convertDust=e?this.convertDust+n:this.convertDust-n;break;case iface.tb_prop.resTypeKey.darkEssence:this.darkEssence=e?this.darkEssence+n:this.darkEssence-n;break;case iface.tb_prop.resTypeKey.godCrystal:this.godCrystal=e?this.godCrystal+n:this.godCrystal-n;break;case iface.tb_prop.resTypeKey.legendChip:this.legendChip=e?this.legendChip+n:this.legendChip-n;break;case iface.tb_prop.resTypeKey.soulStone:this.soulStone=e?this.soulStone+n:this.soulStone-n;break;case iface.tb_prop.resTypeKey.honour:this.honour=e?this.honour+n:this.honour-n;break;case iface.tb_prop.resTypeKey.godDomain:this.godDomain=e?this.godDomain+n:this.godDomain-n;break;case iface.tb_prop.resTypeKey.vipScore:var r=this.vipScore;this.vipScore=e?this.vipScore+n:this.vipScore-n,UIUtil.saveVipupData(r,this.vipScore);break;case iface.tb_prop.resTypeKey.rechargeDmd:this.diamond=e?this.diamond+n:this.diamond-n}}},e.prototype.calculateLv=function(){var t=TableData.getInstance().getTableByName(TableData.tb_role).maxId,e=!1,i=this.level,n=!0;for(game.HudModel.getInstance().oldUserLv=this.level;n&&this.level<t;){var o=tb.TB_role.get_TB_rolenById(this.level);o&&this.exp>=o.exp?(e=!0,this.exp-=o.exp,this.level=Math.min(t,this.level+1)):n=!1}if(e){tb.TB_role.get_TB_rolenById(this.level),tb.TB_role.get_TB_rolenById(i),UIMgr.showUI(UIConst.LevelUpView),dispatchEvt(new game.ResEvent(game.ResEvent.ROLE_LEVEL_CHANGE));var a=window.platform.serverInfo;BingoSDK.gameReport("upgrade",this.playerId,this.accountName,a.serverId,a.srv_name,{level:this.level,vip:this.vip,charge:App.hero.welfare.rechargeSum})}},e.prototype.refreshLineUp=function(t){var e;for(var i in t)e=Number(i),this.lineupInfo[e]=t[i];this.fightState(e),e==iface.tb_prop.lineupTypeKey.attack&&game.registerGodAndEquipGroup(),dispatchEvt(new game.GodEvent(game.GodEvent.BUZHEN_COMPLETE)),dispatchEvt(new game.ResEvent(game.ResEvent.RESOURCE_CHANGE))},e.prototype.fightState=function(t){void 0===t&&(t=-1),-1==t?(this.setlineUpState2GodList(iface.tb_prop.lineupTypeKey.attack),this.setlineUpState2GodList(iface.tb_prop.lineupTypeKey.expedition)):this.setlineUpState2GodList(t)},e.prototype.setlineUpState2GodList=function(t){var e=this.lineupInfo[t];if(e&&0!=e.length){for(var i=0;i<this._godAry.length;i++)this.lineUpHasGod(e,this._godAry[i],t);game.GodModel.getInstance().onAttackLineChange(t)}},e.prototype.lineUpHasGod=function(t,e,i){var n=!1;for(var o in t)e.uuid==t[o]&&(n=!0,i==iface.tb_prop.lineupTypeKey.attack?(e.isAttackFight=!0,e.local[0]=Number(o)):i==iface.tb_prop.lineupTypeKey.expedition&&(e.isYuanzhengFight=!0,e.local[2]=Number(o)));n||(i==iface.tb_prop.lineupTypeKey.attack?(e.isAttackFight=!1,e.local[0]=99999):i==iface.tb_prop.lineupTypeKey.expedition&&(e.isYuanzhengFight=!1,e.local[2]=99999))},e.prototype.getLineUpTeamIds=function(t,e){void 0===e&&(e=!1);var i=[],n=this.lineupInfo[t];if(n&&0<n.length)for(var o=0;o<6;o++){var a=n[o];a?i.push(a):e&&i.push(null)}return 0==i.length&&(i=[null,null,null,null,null,null]),i},e.prototype.getLineUpTeam=function(t,e){void 0===e&&(e=!1);var i=[],n=this.lineupInfo[t];if(n)for(var o=Object.keys(n),a=game.YuanzhengModel.getInstance().getAidTag(),r=0;r<6;r++)if(o.length>r){var s=n[o[r]];if(a&&Number(s)<0&&a.uuid==s){i.push(a);continue}if(s){var u=this.getGodVoById(s);if(!u){logerror("don`t find lineUpGod");continue}i.push(u)}else e&&i.push(null)}else e&&i.push(null);else e&&(i=[null,null,null,null,null,null]);return i},e.prototype.hasLineUp=function(t){if(this.lineupInfo[t])for(var e in this.lineupInfo[t])if(this.lineupInfo[t][e])return!0;return!1},e.prototype.isInLineup=function(t,e){return-1!=this.getLineUpTeamIds(e).indexOf(t)},e.prototype.refreshbag=function(t,e){for(var i in t)if(t.hasOwnProperty(i)){var n=0;this.bagItemsObj.hasOwnProperty(i)&&(n=this.bagItemsObj[i]);var o=Number(t[i]);this.bagItemsObj[i]=e?n+o:Math.max(0,n-o),n=this.bagItemsObj[i];var a=Number(i);game.BagModel.getInstance().updateBagObj(a,n);var r=App.hero.createItemVo(n,a);dispatchEvt(new game.BagEvent(game.BagEvent.CHANGE_ITEM),r)}},e.prototype.getBagItemNum=function(t){if(t==iface.tb_prop.resTypeKey.gold)return App.hero.gold;if(t==iface.tb_prop.resTypeKey.diamond)return App.hero.diamond;if(t==iface.tb_prop.resTypeKey.godExp)return App.hero.godExp;if(t==iface.tb_prop.resTypeKey.convertDust)return App.hero.convertDust;if(t==iface.tb_prop.resTypeKey.legendChip)return App.hero.legendChip;if(this.bagItemsObj&&this.bagItemsObj[t])return this.bagItemsObj[t];var e=tb.TB_item.get_TB_itemById(t);return e&&e.type==iface.tb_prop.itemTypeKey.gemstone?game.GemstoneUtils.getOwnNum(e.ID):0},e.prototype.getGodAry=function(t,e){return void 0===t&&(t=-1),void 0===e&&(e=-1),this.sortGodList(e,t)},e.prototype.isActiveArtifact=function(t){return this.artifactInfo&&this.artifactInfo.hasOwnProperty(t.toString())},e.prototype.isActiveArtifactAttr=function(){if(this.artifactInfo)for(var t=tb.TB_artifact.get_TB_artifact(),e=0;e<t.length;e++)if(this.isActiveArtifact(t[e].ID))return!0;return!1},e.prototype.isWearArtifact=function(t,e){void 0===e&&(e=0);var i=e.toString();if(0!=e)return this.lineupArtifactInfo.hasOwnProperty(i)&&this.lineupArtifactInfo[i]==t;for(var n=1;n<4;n++)if(i=n.toString(),this.lineupArtifactInfo.hasOwnProperty(i)&&this.lineupArtifactInfo[i]==t)return!0;return!1},e.prototype.getArtifactIDByLineType=function(t){return void 0===t&&(t=1),this.lineupArtifactInfo.hasOwnProperty(t)?Number(this.lineupArtifactInfo[t]):0},e.prototype.isPassRuneCopyInfo=function(t,e){return!!App.hero.runeCopyInfo.hasOwnProperty(e)&&t<=Number(App.hero.runeCopyInfo[e])},e.prototype.updateDailyCopy=function(t){null==t.dailyCopyIds&&null==t.dailyCopyId||(null!=t.dailyCopyIds&&this.dailyCopyIds.push(t.dailyCopyIds),null!=t.dailyCopyId&&this.dailyCopyIds.push(t.dailyCopyId),dispatchEvt(new game.DailyEvent(game.DailyEvent.DAILY_COPY_ID_CHANGE)))},e.prototype.isPassDailyCopy=function(t){return-1!=this.dailyCopyIds.indexOf(t)},e.prototype.getMarketFreeInfo=function(){var t=tb.TB_market_set.getItemById(1),e=App.serverTimeSecond,i=this.getOverplusValue(iface.tb_prop.overplusTypeKey.marketRefreshNum);if(i>=t.reply_num||0==this.marketRefreshReplyTime||e<=this.marketRefreshReplyTime)return this._marketFreeInfo[0]=i,this._marketFreeInfo[1]=e+t.reply_interval,this._marketFreeInfo;var n=e-this.marketRefreshReplyTime,o=Math.floor(n/t.reply_interval);return(i+=o)>t.reply_num&&(i=t.reply_num),this._marketFreeInfo[0]=i,this._marketFreeInfo[1]=this.marketRefreshReplyTime+(o+1)*t.reply_interval,this._marketFreeInfo},e.prototype.getMarkeyBuyRefreshCount=function(){return this.getlimitValue(iface.tb_prop.limitTypeKey.buyMarketRefreshNum)},e.prototype.initTasks=function(){for(var t in this.tasks.curTasks)this.tasks.curTasks[t].id=parseInt(t);for(var t in this.tasks.dailyTasks)this.tasks.dailyTasks[t].id=parseInt(t);this.tasks.guideStep=this.tasks.guideStep?this.tasks.guideStep:0,this.tasks.guideWeakStep=this.tasks.guideWeakStep?this.tasks.guideWeakStep:[],game.TaskModel.getInstance().updateHonorList(),dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_ACHIEVEMENT_DATA))},e.prototype.refreshTasks=function(t){var e=this.tasks.curTasks,i=(this.tasks.doneTasks,!1),n=!1;for(var o in t){var a=tb.TB_task.getTaskById(parseInt(o));if(!a)return;if(a.type==iface.tb_prop.taskTypeKey.achievement?i=!0:a.type==iface.tb_prop.taskTypeKey.limitTime&&(n=!0),e.hasOwnProperty(o))for(var r in t[o])e[o][r]=t[o][r];else e[o]=t[o],e[o].id=parseInt(o)}i&&(game.TaskModel.getInstance().updateHonorList(),dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_ACHIEVEMENT_DATA))),n&&dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_LIMIT_TASK))},e.prototype.addDoneTask=function(t){var e=this.tasks.doneTasks;-1==(e=e||[]).indexOf(t)&&e.push(t);var i=this.tasks.curTasks;i.hasOwnProperty(t)&&delete i[t],tb.TB_task.getTaskById(t).type==iface.tb_prop.taskTypeKey.achievement&&(game.TaskModel.getInstance().updateHonorList(),dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_ACHIEVEMENT_DATA)))},e.prototype.refreshDailyTask=function(t){var e=this.tasks.dailyTasks;for(var i in t)for(var n in t[i])e[i][n]=t[i][n];dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_DAILY_TASK))},e.prototype.updateDailyLivess=function(t){t&&t.hasOwnProperty("liveness")&&(this.tasks.liveness=t.liveness,dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_LIVENESS_DATA)))},e.prototype.addDoneDailyTask=function(t){var e=this.tasks.dailyTasks;for(var i in e)if(parseInt(i)==t){e[t].done=!0;break}dispatchEvt(new game.TaskEvent(game.TaskEvent.UPDATE_DAILY_TASK))},e.prototype.getlimitValue=function(t){return this.limitInfo[t]?this.limitInfo[t]:0},e.prototype.getOverplusValue=function(t){return this.overplusInfo[t]?this.overplusInfo[t]:0},e.prototype.setOverplusValue=function(t,e){this.overplusInfo[t]=e,dispatchEvt(new game.ResEvent(game.ResEvent.OVERPLUS_VALUE_CHANGE))},e.prototype.chuzhanModels=function(t,e){void 0===e&&(e=iface.tb_prop.lineupTypeKey.attack);var i=new Array,n=this.getLineUpTeamIds(e);if(!n||0==n.length||!n[0])return[];for(var o=0,a=n.length;o<a;o++){var r=n[o];if(o<t){var s=this.getGodVoById(r);s&&i.push(s.tab_god.model)}}return i},e.prototype.updateGuajiData=function(t){t&&t.hasOwnProperty("lastGetAfkTime")&&(this.lastGetAfkTime=t.lastGetAfkTime,dispatchEvt(new game.GuajiEvent(game.GuajiEvent.UPDATE_LASTGET_AFKTIME)))},e.prototype.updateCopyInfo=function(t){if(t){if(t.hasOwnProperty("expeditionRewardInfo")&&(this.copyInfo.expeditionRewardInfo=t.expeditionRewardInfo),t.hasOwnProperty("expeditionSelfHpInfo")&&(this.copyInfo.expeditionSelfHpInfo=t.expeditionSelfHpInfo),t.hasOwnProperty("expeditionId")&&(this.copyInfo.expeditionId=t.expeditionId,game.YuanzhengModel.getInstance().updateCurGuanqia()),t.hasOwnProperty("modifySelfHpInfo")){var e=this.copyInfo.expeditionSelfHpInfo;for(var i in t.modifySelfHpInfo)e[i]=t.modifySelfHpInfo[i]}if(t.hasOwnProperty("modifyRewardInfo"))for(var i in e=this.copyInfo.expeditionRewardInfo,t.modifyRewardInfo)e[i]=t.modifyRewardInfo[i];dispatchEvt(new game.YuanzhengEvent(game.YuanzhengEvent.UPDATE_VIEW))}},e.prototype.isInBlockList=function(t){return-1!=this.blockLists.indexOf(t)},e.prototype.addBlockList=function(t){return!(!t||""==t||(this.blockLists.push(t),0))},e.prototype.removeBlockListById=function(t){if(!t||""==t)return!1;var e=this.blockLists.indexOf(t);return-1!=e&&(this.blockLists.splice(e,1),!0)},e.prototype.removeBlackList=function(t){if(t&&Array.isArray(t))for(var e=0,i=t;e<i.length;e++){var n=i[e];this.removeBlockListById(n)}},e.prototype.setLimitBoxMintime=function(){for(var t in this._mintimeBox=-1,this.bagTimeItemsObj){var e=this.bagTimeItemsObj[t];e.limitTime>App.getServerTime()&&(this._mintimeBox=-1==this._mintimeBox?e.limitTime:Math.min(e.limitTime,this._mintimeBox))}},e.prototype.getFirstUse=function(t){return this.firstIds&&-1!=this.firstIds.indexOf(t)},e);function e(){this.puid="",this.accountName="",this.uid="",this.playerId="",this.isNewPlayer=0,this.name="",this.head="",this.headId=0,this.sex=1,this.headIcon="",this.level=1,this.exp=666,this.artifactStrengthLv=0,this.artifactSkillLv=0,this.artifactBaptizeLv=0,this.artifactBaptizeExp=0,this.artifactStarLv=0,this.artifactStarExp=0,this.diamond=0,this.friend=0,this.arena=0,this.gold=0,this.godExp=0,this.guildId="",this.guildLv=0,this.guildExp=0,this.guildDonate=0,this.guildName="",this.guildHelpNum=0,this.vip=0,this.limitInfo={4:0,5:0},this.runeCopyInfo={},this.groundCopyInfo={},this.towerCopyInfo={},this.towerAwardInfo={},this.arenaClgListTime=0,this.arenaFailTime=0,this.lastGetAfkTime=0,this.maxHistoryForce=0,this.overplusInfo={},this.copyChallengeInfo={},this.guildWarAwardCount={},this.bindPhone=1,this.honourStage=0,this.kuafuHonourStage=0,this.dailyCopyIds=[],this._time=0,this._IndulgeCountTime=0,this._IndulgeLoginRemind=!1,this._curCrossTime=0,this._curDate=new Date,this._curDay=0,this.checkKey=["awakenLv","level"],this._marketFreeInfo=[0,0],this._mintimeBox=-1}c.Hero=t}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=ui.component.GodStarInfoUI,__extends(o,n),Object.defineProperty(o.prototype,"starLevel",{get:function(){return this._starLv},set:function(t){if(t<0&&(t=0),this._starLv!=t){var e=(this._starLv=t)>this._starNum?"comp/image/juexing_xingji.png":"comp/image/xinxi_xingji.png";this._showNum=(t-1)%this._starNum+1;for(var i=0;i<this._starNum;i++)i<this._showNum?(this._allStar[i].visible=!0,this._allStar[i].skin=e):this._allStar[i].visible=!1;this.layoutStar()}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"starAlign",{get:function(){return this._starAlign},set:function(t){this._starAlign!=t&&(this._starAlign=t,this.layoutStar())},enumerable:!0,configurable:!0}),o.prototype.layoutStar=function(){if(!(this._showNum<=0)){var t=this._starWidth*this._showNum,e=0;switch(this._starAlign){case o.STAR_ALIGN_CENTER:e=(this.width-t)/2;break;case o.STAR_ALIGN_RIGHT:e=this.width-t}for(var i=0;i<this._showNum;i++)this._allStar[i].x=e+i*this._starWidth}},o.prototype.getTotalStarWidth=function(){return this._showNum*this._starWidth},o.STAR_ALIGN_LEFT=0,o.STAR_ALIGN_CENTER=1,o.STAR_ALIGN_RIGHT=2,o);function o(){var t=n.call(this)||this;t._starNum=0,t._starWidth=0,t._showNum=0,t._starLv=0,t._starAlign=0,t._allStar=[];for(var e=0;e<10;e++){var i=t.getChildByName("img_star_"+e);if(!i)break;i.visible=!1,t._allStar[e]=i}return t._starNum=t._allStar.length,t._starWidth=t.width/t._starNum,t.starAlign=o.STAR_ALIGN_CENTER,t}t.GodStarInfo=e}(common=common||{});var UI_FLYTEXT;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=tl3d.BaseEvent,__extends(i,n),i.DIALOG_CREATED="DIALOG_CREATED",i.DIALOG_OPENED="DIALOG_OPENED",i.DIALOG_CLOSED="DIALOG_CLOSED",i);function i(t,e){void 0===e&&(e=null);var i=n.call(this,t)||this;return i.data=e,i}t.GlobalEvent=e}(common=common||{}),function(t){var e=(o.getHechengChipId=function(){for(var t=0,e=tb.TB_copy_info.get_TB_copy_infoById(o.GUAJI_COPY_1_1).reward;t<e.length;t++){var i=e[t],n=tb.TB_item.get_TB_itemById(i[0]);if(n&&n.type==iface.tb_prop.itemTypeKey.chip)return n.ID}return 0},o.DIALOG_EFFECT_TIME=500,o.GUIDE_USER_LEVEL=5,o.SHOUCHONG_OPEN_LV=11,o.GUAJI_COPY_1_1=10001,o.GUAJI_COPY_1_2=10002,o.GUAJI_COPY_1_3=10003,o.GUAJI_COPY_1_4=10004,o.GUAJI_COPY_1_5=10005,o.GUAJI_COPY_1_6=10006,o.GUAJI_COPY_1_7=10007,o.GUAJI_COPY_2_10=10110,o.HOUYI_GOD_ID=3003,o.XIANSHI_BX_700=700,o.DEFAULT_HEAD=2010,o.DEFAULT_SHOW_GODID=2010,o.DEFAULT_SHOW_SKINID=0,o);function o(){}t.GlobalData=e}(common=common||{}),function(t){t[t.AWAKEN=0]="AWAKEN",t[t.UPSTART=1]="UPSTART"}(UI_FLYTEXT=UI_FLYTEXT||{}),(common||(common={})).FlyText=function(){},function(i){var t=(e.prototype.addTabItem=function(t){if(!this.isExist(t.viewName))return this._dataList.push(t),this;logerror("重复添加视图数据失败",t.viewName)},e.prototype.setTabItemist=function(t){for(var e=this._dataList.length=0;e<t.length;e++)this.addTabItem(t[e])},e.prototype.onVerifyCallback=function(t){var e=this._dataList[t];return!e||!e.onSelectVerify||e.onSelectVerify()},e.prototype.onSelectHandler=function(t){var e=this._dataList[t];e&&e.viewClz&&(e.onSelectBefore?e.onSelectBefore(this.selectTabItem.bind(this,e)):this.selectTabItem(e))},e.prototype.selectTabItem=function(t){if(t.viewClz){for(var e in this._viewMap.hasOwnProperty(t.viewName)||(this._viewMap[t.viewName]=this.createView(t),this._viewMap[t.viewName].visible=!1),this._viewMap){var i=this._viewMap[e],n=i.visible,o=e==t.viewName;o&&(this._selectedName=t.viewName,i.dataSource&&i.dataSource==t.dataSource||(i.dataSource=t.dataSource)),n!=o&&(o&&t.onShow?t.onShow(i):!o&&t.onHide&&t.onHide(i)),i.visible=o}t.onSelectAfter&&t.onSelectAfter()}else logerror("没有设置视图类",t.viewName)},e.prototype.createView=function(t){var e=new t.viewClz;return e.name=t.viewName,e.dataSource=t.dataSource,t.onCreated&&t.onCreated(e),this._parentContainer.addChild(e),e},e.prototype.updateItemByName=function(t,e){var i=this.getViewInfoByName(t);if(i){i.dataSource=e;var n=this.getViewByName(t);n&&(n.dataSource=e),i.onShow&&i.onShow(n)}},e.prototype.refreshItemByItem=function(t){var e=this.getViewInfoByName(t);if(e){var i=this.getViewByName(t);e.onShow&&e.onShow(i)}},e.prototype.getViewByName=function(t){return this._viewMap[t]},e.prototype.getViewInfoByName=function(e){return this._dataList.find(function(t){return t.viewName==e})},e.prototype.getViewIndex=function(e){return this._dataList.findIndex(function(t){return t.viewName==e})},e.prototype.getViewName=function(t){var e=this._dataList[t];return e?e.viewName:null},e.prototype.getSelectedName=function(){return this._selectedName},e.prototype.removeTabItem=function(e){var t=this._viewMap[e];t&&t.removeSelf(),this._viewMap[e]=null,delete this._viewMap[e];var i=this._dataList.findIndex(function(t){return t.viewName==e});-1!=i&&this._dataList.splice(i,1)},e.prototype.isExist=function(e){return this._dataList.some(function(t){return t.viewName==e})},e.prototype.getViewNum=function(){return this._dataList.length},e.prototype.clearSelected=function(){for(var t in this._tab.selectedIndex=-1,this._selectedName=null,this._viewMap)this._viewMap[t]&&(this._viewMap[t].visible=!1)},e.prototype.viewDispose=function(){for(var t=0,e=this._dataList;t<e.length;t++){var i=e[t],n=this.getViewByName(i.viewName);i.onClosed&&i.onClosed(n)}this.clearSelected()},e.prototype.realDispose=function(){for(var t=0,e=this._dataList;t<e.length;t++){var i=e[t],n=this.getViewByName(i.viewName);i.onClosed&&i.onClosed(n)}this._dataList.length=0,this._viewMap={},this._selectedName=null,this._parentContainer.removeChildren()},e);function e(t,e){this._dataList=[],this._viewMap={},this._tab=t,this._parentContainer=e,this._tab instanceof i.ListBase&&(this._tab.verifyHandler=new Handler(this,this.onVerifyCallback)),this._tab.selectHandler=new Handler(this,this.onSelectHandler)}i.TabListOperate=t}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=Laya.Tab,__extends(n,e),Object.defineProperty(n.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){if(this._selectedIndex!=t){if(-1==t)return void this.toSelect(t);if(this.verifyHandler&&!this.verifyHandler.runWith(t))return;this.onSelectBefore?this.onSelectBefore(t,this.toSelect.bind(this,t)):this.toSelect(t)}},enumerable:!0,configurable:!0}),n.prototype.toSelect=function(t){this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(t,!0),this.event(Laya.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex)},n);function n(){return e.call(this)||this}t.TabBase=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.component.StarListUI,__extends(h,i),h.prototype.setStarNum=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=0),t<0&&(t=0),this._num!=t||e)if(this._num=t,0==this._num)this.visible=!1;else if(this.visible=!0,this._starList){var n=this._starList.length,o=this._num%n;0==o&&(o=n);for(var a=0;a<n;a++){var r=this._starList[a];a<o?(r.visible=!0,r.skin=n<t?"comp/image/juexing_xingji.png":"comp/image/xinxi_xingji.png"):r.visible=!1}var s=h.STAR_WIDTH*o+(o-1)*i,u=(this.width-s+h.STAR_WIDTH)/2;for(a=0;a<o;a++)(r=this._starList[a]).x=u,u+=h.STAR_WIDTH+i}},h.STAR_WIDTH=28,h);function h(){var t=i.call(this)||this;t._num=0,t._starList=[];for(var e=0;e<5;e++)t._starList[e]=t["img_"+e];return t.setStarNum(0,!0),t}t.StarList=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=Laya.Animation,__extends(n,e),n.prototype.showEff=function(t,e){void 0===e&&(e=null),this._isInit||(this._isInit=!0,this.zOrder=t.zOrder,this.x+=t.x,this.y+=t.y),t.visible=!1,Dialog.manager.addChild(this),this.visible=!0,this.play(),Laya.timer.once(100,this,function(){t.visible=!0,t.popupEffect.runWith(t),e&&e.run()}),Laya.timer.once(500,this,this.closeEff)},n.prototype.closeEff=function(){this.removeSelf(),this.visible=!1,this.stop(),Laya.timer.clearAll(this)},n);function n(){var t=e.call(this)||this;return t._isInit=!1,t}t.DialogOpenEff=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=Laya.List,__extends(n,e),Object.defineProperty(n.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){if(this._selectedIndex!=t){if(this.verifyHandler&&!this.verifyHandler.runWith(t))return;this._selectedIndex=t,this.changeSelectStatus(),this.event(Laya.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(t),this.startIndex=this._startIndex}},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.ListBase=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=i.DialogExt,__extends(n,e),n.showEffectList=function(t){if(t._dataSource.length<=0)return null;var e=Laya.Pool.getItemByClass("EffectList",i.EffectList);return e.initView(t),Dialog.manager.addChild(e),e},n.updateEffectShow=function(){for(var t=0,e=Dialog.manager._childs;t<e.length;t++){var i=e[t];"EffectList"==i.name&&(this.viewIsShow(UIConst.FightGuildCopyResultView)||this.viewIsShow(UIConst.CommonRewardView)||this.viewIsShow(UIConst.FightVictory)||this.viewIsShow(UIConst.GuajiVictory)||this.viewIsShow(UIConst.Topup_GiftSuccView)||this.viewIsShow(UIConst.Topup_SuccView)||this.viewIsShow(UIConst.LevelUpView)||this.viewIsShow(UIConst.ShowRewardItem)||this.viewIsShow(UIConst.DFW_QiyuResultView)||this.viewIsShow(UIConst.GuildCopySweepResultView)||i.stratEndAction())}},n.prototype.initView=function(t){this.listVo=t,this.list_item||(this.list_item=new Laya.List,this.list_item.itemRender=i.ItemBox,this.list_item.vScrollBarSkin="",this.addChild(this.list_item)),this.list_item.height=t._height?t._height:200,this.list_item.x=t._x,this.zOrder=t.Zorder,this.list_item.spaceX=t._spaceX,this.list_item.spaceY=t._spaceY,this.list_item.repeatX=t._repeatX,this.list_item.y=t._y,this.list_item.array=this.setVoToItemVo(t._dataSource),t._width?this.list_item.width=t._width:this.list_item.width=null,this.height=this.list_item.height,this.width=this.list_item.width,this.startEnd=!1,this.index=0,Laya.timer.loop(150,this,this.itemBoxStartAction),tl3d.ModuleEventManager.addEvent(game.HudEvent.SCREEN_SIZE_CHNAGE,this._onResize,this)},n.prototype._onResize=function(){this.x=Launch.offsetX,this.y=Launch.offsetY},n.prototype.setVoToItemVo=function(t){for(var e in t)t[e]instanceof EquipItemVo&&(t[e].startAction=!0,t[e].templateId=null,t[e].show=!0);return t},n.viewIsShow=function(t){return UIMgr.hasStage(t)},n.prototype.itemBoxStartAction=function(){if(this.list_item&&this.list_item.array)if(this.index!=this.list_item.array.length){var t=this.list_item.getCell(this.index);t&&(this.index++,t.dataSource?(t.visible=!0,t.dataSource.startAction=!1,Laya.Tween.to(t,{scaleX:1,scaleY:1},150)):t.visible=!1)}else Laya.timer.clear(this,this.itemBoxStartAction)},n.prototype.isStartEndAction=function(){return!this.list_item||0==this.list_item.length},n.prototype.stratEndAction=function(){if(!this.isStartEndAction()){Laya.timer.clear(this,this.itemBoxStartAction),this.list_item.scrollTo(0),this.list_item.width=999,this.list_item.height=800,this.index=this.list_item.length;for(var t=0;t<this.index;t++){var e=this.list_item.getCell(t);Laya.Tween.clearTween(e),e&&(e.scale(1,1),e.visible=!0,e.dataSource.startAction=!1)}this.itemBoxEndAction();var i=6<=this.index?50:100;Laya.timer.loop(i,this,this.itemBoxEndAction),tl3d.ModuleEventManager.removeEvent(game.HudEvent.SCREEN_SIZE_CHNAGE,this._onResize,this)}},n.prototype.itemBoxEndAction=function(){var t=this;if(this.index<0)Laya.timer.clear(this,this.itemBoxEndAction);else{this.index--;var e=UIMgr.getUIByName(UIConst.HudView),i=this.list_item.globalToLocal(e.getBtnPos(e.btn_bag)),n=this.index<=0,o=this.list_item.getCell(this.index);o&&(BezierTween.clear(o),o.scale(1,1),BezierTween.to(o,500,[{x:o.x,y:o.y},{x:i.x,y:i.y}],{scaleX:.5,scaleY:.5},null,new Handler(this,function(){o.visible=!1,n&&(t.list_item.array=null,t.removeSelf(),Laya.Pool.recover("EffectList",t))})))}},n);function n(){var t=e.call(this)||this;return t.startEnd=!1,t.index=0,t.zOrder=UI_DEPATH_VALUE.TOP+5,t.mouseThrough=!0,t.name="EffectList",t.isIgnore=!0,t.close=null,t}i.EffectList=t}(common=common||{}),function(t){var r,e,i=(Object.defineProperty(n.prototype,"buttons",{set:function(t){for(var e=0,i=this._buttonList=t;e<i.length;e++)i[e].on(Laya.Event.CLICK,this,this.onSelected)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"buttonsData",{set:function(t){this._buttonsData=t;for(var e=0,i=this._buttonList.length;e<i;e++)t[e]&&t[e].name&&(this._buttonList[e].label=t[e].name);this.updateLockState()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){var i=this;if(!(e>=this._buttonList.length)&&this._selectedIndex!=e){var n=this.getButtonData(e);if(n&&n.openHandler){if(n.openHandler instanceof Laya.Handler)return void(n.openHandler.run()?this.doSelectedIndex(e):n.prompt&&showToast(n.prompt));n.openHandler instanceof Promise&&n.openHandler.then(function(t){t?i.doSelectedIndex(e):n.prompt&&showToast(n.prompt)})}else this.doSelectedIndex(e)}},enumerable:!0,configurable:!0}),n.prototype.doSelectedIndex=function(t){this._selectedIndex=t,this.updateSelectState(),this.runHandler()},Object.defineProperty(n.prototype,"selectHandler",{set:function(t){this._selectHandler=t},enumerable:!0,configurable:!0}),n.prototype.runHandler=function(){var t=this._selectedIndex;-1!=t&&this._selectHandler&&this._selectHandler.runWith([t])},n.prototype.onSelected=function(t){var e=t.target,i=this._buttonList.indexOf(e);this.selectedIndex=i},n.prototype.updateSelectState=function(){for(var t=this._buttonList.length,e=0;e<t;e++)this._buttonList[e].selected=e==this._selectedIndex},n.prototype.updateLockState=function(){function t(t){var e=a._buttonList[t],i=a.getButtonData(t);if(!i)return 1;var n=i.openTye;if(n==r.gray)i.openHandler instanceof Laya.Handler?e.gray=!i.openHandler.run():i.openHandler instanceof Promise?i.openHandler.then(function(t){e.gray=!t}):e.gray=!1;else if(n==r.visible){var o=e.imgLock;if(!o)return 1;i.openHandler instanceof Laya.Handler?e.gray=!i.openHandler.run():i.openHandler instanceof Promise?i.openHandler.then(function(t){e.gray=!t}):o.visible=!1}}for(var e=this._buttonList.length,a=this,i=0;i<e;i++)t(i)},n.prototype.getButtonData=function(t){return this._buttonsData?this._buttonsData[t]:null},n.prototype.onClose=function(){for(var t=0,e=this._buttonList;t<e.length;t++)e[t].off(Laya.Event.CLICK,this,this.onSelected);this._buttonList.length=0,this._buttonsData=null,this._selectHandler=null,this._selectedIndex=-1},n);function n(){this._buttonList=[],this._selectedIndex=-1,this._buttonList=[]}t.CustomTabBar=i,(e=r=t.BtnOpenType||(t.BtnOpenType={}))[e.none=0]="none",e[e.gray=1]="gray",e[e.visible=2]="visible"}(common=common||{}),function(t){var e=(i.prototype.setComponent=function(t,e,i,n,o,a){void 0===a&&(a=10),this.btnAddOne=t,this.btnAddDuo=e,this.btnRedOne=i,this.btnRedDuo=n,this.textInput=o,this._addMultiNum=a,this.textInput instanceof Laya.TextInput&&(this.textInput.type=Laya.Input.TYPE_NUMBER,this.textInput.on(Laya.Event.INPUT,this,this.onput)),this.btnAddOne.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.btnAddOne.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.btnAddOne.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.btnAddDuo.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.btnAddDuo.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.btnAddDuo.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.btnRedOne.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.btnRedOne.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.btnRedOne.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.btnRedDuo.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.btnRedDuo.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.btnRedDuo.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut)},i.prototype.setInitData=function(t,e,i){this._curNum=t,this._maxNum=e,this._callBack=i,this.updateBtn()},i.prototype.onMouseDown=function(t){var e=t.currentTarget,i=1;e==this.btnAddOne?i=1:e==this.btnAddDuo?i=this._addMultiNum:e==this.btnRedOne?i=-1:e==this.btnRedDuo&&(i=-this._addMultiNum),this._downTime=(new Date).getTime(),Laya.timer.loop(300,this,this.onLoop,[i])},i.prototype.onMouseUp=function(t){var e=t.currentTarget,i=1;e==this.btnAddOne?i=1:e==this.btnAddDuo?i=this._addMultiNum:e==this.btnRedOne?i=-1:e==this.btnRedDuo&&(i=-this._addMultiNum),(new Date).getTime()-this._downTime<200&&this.excute(i),Laya.timer.clearAll(this)},i.prototype.onMouseOut=function(){Laya.timer.clearAll(this)},i.prototype.onLoop=function(t){(this._curNum+t>=this._maxNum||this._curNum+t<=1)&&Laya.timer.clear(this,this.onLoop),this.excute(t)},i.prototype.excute=function(t){this._curNum+=t,this._curNum=Math.min(this._maxNum,this._curNum),this._curNum=Math.max(1,this._curNum),this.doCallBack()},i.prototype.onput=function(){var t=Number(this.textInput.text);t=Math.max(1,t),t=Math.min(this._maxNum,t),this._curNum=t,this.doCallBack()},i.prototype.doCallBack=function(){this.updateBtn(),this._callBack&&this._callBack(this._curNum)},i.prototype.updateBtn=function(){this.btnRedOne.disabled=this.btnRedDuo.disabled=this._curNum<=1,this.btnAddOne.disabled=this.btnAddDuo.disabled=this._curNum>=this._maxNum},i.prototype.getCurNum=function(){return this._curNum},i.prototype.dispose=function(){this.textInput&&this.textInput.off(Laya.Event.INPUT,this,this.onput),this.btnAddOne.off(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.btnAddOne.off(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.btnAddOne.off(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.btnAddDuo.off(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.btnAddDuo.off(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.btnAddDuo.off(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.btnRedOne.off(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.btnRedOne.off(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.btnRedOne.off(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.btnRedDuo.off(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.btnRedDuo.off(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.btnRedDuo.off(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this._callBack=null},i);function i(){this._addMultiNum=10}t.CounterBar=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.ComboboxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.renderView()},enumerable:!0,configurable:!0}),n.prototype.renderView=function(){var t=this.dataSource;if(t&&0<t.length){this.removeLabels();for(var e=4,i=this._labelList.length=0;i<t.length;i++){var n=new Laya.Box;n.x=0,n.height=this.lbValue.fontSize+8,n.width=this.boxContent.width,n.y=e,e+=n.height,this.boxContent.addChild(n);var o=new Laya.Label(t[i]);o.bold=this.lbValue.bold,o.fontSize=this.lbValue.fontSize,o.color=this.lbValue.color,o.stroke=this.lbValue.stroke,o.strokeColor=this.lbValue.strokeColor,o.x=this.lbValue.x,o.centerY=0,n.addChild(o),n.on(Laya.Event.CLICK,this,this.onSelect,[i]),this._labelList.push(n)}this.boxContent.height=e,this.height=this.boxContent.y+this.boxContent.height,this.boxContent.visible=!1,this.btnShow.on(Laya.Event.CLICK,this,this.onOpenOrHide),this.imgBg.on(Laya.Event.CLICK,this,this.onOpenOrHide)}else this.removeLabels(),this.boxContent.visible=!1,this.btnShow.off(Laya.Event.CLICK,this,this.onOpenOrHide),this.imgBg.off(Laya.Event.CLICK,this,this.onOpenOrHide)},n.prototype.removeLabels=function(){for(var t=0,e=this._labelList;t<e.length;t++){var i=e[t];i.offAll(),i.removeSelf()}this._labelList.length=0},n.prototype.onOpenOrHide=function(){var t=this;this.boxContent.visible=!this.boxContent.visible,this.showHandler&&this.showHandler.runWith(this.boxContent.visible),this.boxContent.visible?Laya.timer.callLater(this,function(){t.stage.on(Laya.Event.CLICK,t,t.onClickView)}):this.stage.off(Laya.Event.CLICK,this,this.onClickView)},n.prototype.onClickView=function(t){t.target!=this&&this.onOpenOrHide()},n.prototype.onSelect=function(t){this.selectedIndex=t},Object.defineProperty(n.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){if(this._selectedIndex!=t){this._selectedIndex=t;var e=this.dataSource;this.lbValue.text=e?e[t]:"无",this.selectHandler&&this.selectHandler.runWith(t)}},enumerable:!0,configurable:!0}),n);function n(){var t=e.call(this)||this;return t.boxContent.visible=!1,t.boxContent.y=t.height+4,t._labelList=[],t.mouseThrough=!1,t}t.Combobox=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.ChannelBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"callback",{set:function(t){this._callback=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){game.ChongzhiModel.getInstance().isAllReward()&&this.btn_firstrecharge&&(this.btn_firstrecharge.visible=!1);var t=0==this.btn_firstrecharge.visible,e=t?this.width/4:this.width/5;this.btn_god.x=e/2,this.btn_buzhen.x=e+e/2,this.btn_firstrecharge.x=2*e+e/2,this.btn_equip.x=t?2*e+e/2:3*e+e/2,this.btn_artifact.x=t?3*e+e/2:4*e+e/2},n.prototype.onJump=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=tb.TB_sys_open.get_TB_sys_openById(t[0]);if(i&&!App.IsSysOpen(t[0]))return showToast(i.prompt),void(this._callback&&this._callback(!1));this._callback&&this._callback(!0),dispatchEvt(new game.HudEvent(game.HudEvent.SHOW_MODULE_VIEW),t)},n);function n(){var t=e.call(this)||this;return t.btn_god.on(Laya.Event.CLICK,t,t.onJump,[ModuleConst.SHENLING]),t.btn_equip.on(Laya.Event.CLICK,t,t.onJump,[ModuleConst.EQUIPMENT]),t.btn_artifact.on(Laya.Event.CLICK,t,t.onJump,[ModuleConst.ARTIFACT]),t.btn_buzhen.on(Laya.Event.CLICK,t,t.onJump,[ModuleConst.SHENLING,1]),t.btn_firstrecharge.on(Laya.Event.CLICK,t,t.onJump,[ModuleConst.SHOUCHONG]),t}t.ChannelBox=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.component.CamraUI,__extends(n,i),n.prototype.Change1=function(t){this.lbl_1.text=t.toString(),this._scene.gameScene.camRotationX=t},n.prototype.Change2=function(t){this.lbl_2.text=t.toString(),this._scene.gameScene.camRotationY=t},n.prototype.Change3=function(t){this.lbl_3.text=t.toString(),this._scene.gameScene.camDistance=t},n.prototype.Change4=function(t){this.lbl_4.text=t.toString(),this._scene.gameScene.camPositionX=t},n.prototype.Change5=function(t){this.lbl_5.text=t.toString(),this._scene.gameScene.camPositionY=t},n.prototype.Change6=function(t){this.lbl_6.text=t.toString(),this._scene.gameScene.camPositionZ=t},n.prototype.Change7=function(t){this.lbl_7.text=t.toString(),this._scene.gameScene.camViewLH=t/100},n.prototype.Change8=function(t){this.lbl_8.text=t.toString(),this._scene.gameScene.camFar=t},n.prototype.Change9=function(t){this.lbl_9.text=t.toString(),Scene_data.fogData[0]=t},n.prototype.Change10=function(t){this.lbl_10.text=t.toString(),Scene_data.fogData[1]=t/1e3},n.prototype.initCam=function(){this.bar_1.value=this._scene.gameScene.camRotationX,this.bar_2.value=this._scene.gameScene.camRotationY,this.bar_3.value=this._scene.gameScene.camDistance,this.bar_4.value=this._scene.gameScene.camPositionX,this.bar_5.value=this._scene.gameScene.camPositionY,this.bar_6.value=this._scene.gameScene.camPositionZ,this.bar_7.value=100*this._scene.gameScene.camViewLH,this.bar_8.value=this._scene.gameScene.camFar,this.bar_9.value=Scene_data.fogData[0],this.bar_10.value=1e3*Scene_data.fogData[1]},n);function n(t){var e=i.call(this)||this;return e._vis=!0,e._scene=t,e.bar_1.changeHandler=new Handler(e,e.Change1),e.bar_2.changeHandler=new Handler(e,e.Change2),e.bar_3.changeHandler=new Handler(e,e.Change3),e.bar_4.changeHandler=new Handler(e,e.Change4),e.bar_5.changeHandler=new Handler(e,e.Change5),e.bar_6.changeHandler=new Handler(e,e.Change6),e.bar_7.changeHandler=new Handler(e,e.Change7),e.bar_8.changeHandler=new Handler(e,e.Change8),e.bar_9.changeHandler=new Handler(e,e.Change9),e.bar_10.changeHandler=new Handler(e,e.Change10),e.btn_fre.on(Laya.Event.CLICK,e,e.initCam),e.btn_vis.on(Laya.Event.CLICK,e,function(){e._scene.LogPos(),e._vis=!e._vis,e.box_item.visible=e._vis}),e.initCam(),e}t.CamraView=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=t.Accordion,__extends(i,n),i.prototype.onSelect=function(t){var e=t.data;if(e){for(var i=e.selectid==e.indexid?-1:e.indexid,n=0,o=this._items.length;n<o;n++){for(var a=this._items[n],r=0;r<a.dataSource.length;r++)a.dataSource[r].selectid=i;a instanceof game.BagIR&&a.list_lineitem.refresh(),-1!=i?Math.floor(i/game.BagModel.line_num)==n?a.onShow&&a.onShow(e):a.isShow&&a.isShow()&&a.onHide&&a.onHide():a.onHide&&a.onHide()}this.layoutAllItem()}},i);function i(t,e){var i=n.call(this,t,e)||this;return i.useInitBuff=!0,i}t.BagRenderList=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=Laya.List,__extends(n,e),n.prototype.AutoLayout=function(t,e){void 0===e&&(e=null);var i=(e=e||this.array)?e.length:0,n=0;0<i&&(n=i<this.repeatX?(this.getCell(0).width+this.spaceX)*i-this.spaceX:this.width),this.x=(t-n)/2},n);function n(){return null!==e&&e.apply(this,arguments)||this}t.AutoLayoutList=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var o,e=(o=ui.hud.view.CheatUI,__extends(i,o),i.prototype.onOpened=function(){o.prototype.onOpened.call(this)},i.prototype.onGm=function(t){var o=this,e=t.target,a="",i="";if(e==this.btn1||e==this.btn2||e==this.btn5)a=e.label;else if(e==this.btn3||e==this.btn4)a=e.name;else if(e==this.btnAddItem)this.lbAddID.text?this.lbAddNum.text||(i="物品数量不能为空"):i="物品id不能为空",a="@additem "+this.lbAddID.text+" "+this.lbAddNum.text;else if(e==this.btnDelItem)this.lbDelId.text?this.lbDelNum.text||(i="物品数量不能为空"):i="物品id不能为空",a="@costitem "+this.lbDelId.text+" "+this.lbDelNum.text;else if(e==this.btnLv)this.lbLv.text||(i="等级不能为空"),a="@等级 "+this.lbLv.text;else if(e==this.btnAddMail)this.lbMailID.text||(i="邮件id不能为空"),a="@邮件 "+this.lbMailID.text;else if(e==this.btnJishiRef)this.lbJishi.text||(i="集市刷新时间不能为空"),a="@集市刷新时间 "+this.lbJishi.text;else if(e==this.btnAddGod){if(this.lbGodID.text||(i="英雄id不能为空"),!tb.TB_god.get_TB_godById(Number(this.lbGodID.text)))return void showToast(LanMgr.getLan("",10210));a="@addgod "+this.lbGodID.text+" "+this.lbGodQua.text+" "+this.lbGodLv.text}else if(e==this.btnPassTower)this.lbTowerId.text||(i="副本id不能为空"),a="@tower "+this.lbTowerId.text;else if(e==this.btnReset)a="@重置 "+this.resetCombo.selectedIndex;else if(e==this.btnCmd)a=""+this.lbCmd.text;else if(e==this.btnGuide){var n=this.guideCombo.selectedIndex;return void(0==n?game.GuideManager.allPass():1==n&&game.GuideWeakManager.allPass())}if(i&&""!=i)logdebug("gm格式错误：",a,i);else{logdebug("gm命令：",a);var r={};r[Protocol.game_gm_command.args.content]=a,PLC.request(Protocol.game_gm_command,r,function(t){if(t&&t.content&&(o.lbContent.text=t.content,o.lbContent.event(Laya.Event.RESIZE)),"@清空聊天CD"==a&&game.ChatModel.getInstance().clearCdTime(),"@center重置 1"==a&&game.GuildHelpModel.getInstance().clearCrossDayData(),"@honour 0"==a&&(App.hero.copyInfo.honourWarRegTime=0),"@honour 1"==a&&game.GloryModel.getInstance().testChange(),t&&t.roleLevel&&(App.hero.level=t.roleLevel,App.hero.exp=0,dispatchEvt(new game.ResEvent(game.ResEvent.ROLE_LEVEL_CHANGE)),dispatchEvt(new game.ResEvent(game.ResEvent.RESOURCE_CHANGE))),t&&t.battleReport){logyhj("开始战斗：",t.battleReport);var e=new game.FightVo;e.copyType=CopyType.test;var i=new game.ServerPage;i.initPage(t.battleReport.reportData),i.result=playState.VICTORY,e.fightPageControl=i;var n={vo:e,responseData:t.battleReport.reportData};dispatchEvt(new game.FightsEvent(game.FightsEvent.ENTER_FIGHT_EVENT),n)}})}},i.prototype.onSelectItem=function(t){var e=this.itemCombo.selectedLabel,i=tb.TB_item.get_TB_item("name",e);i&&0<i.length&&(this.lbAddID.text=i[0].ID+"",this.lbDelId.text=i[0].ID+"")},i.prototype.startScrollText=function(t){this.prevX=this.lbContent.mouseX,this.prevY=this.lbContent.mouseY,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.finishScrollText)},i.prototype.finishScrollText=function(t){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.finishScrollText)},i.prototype.scrollText=function(t){var e=this.lbContent.mouseX,i=this.lbContent.mouseY;this.lbContent.textField.scrollX+=this.prevX-e,this.lbContent.textField.scrollY+=this.prevY-i,this.prevX=e,this.prevY=i},i.prototype.onCam=function(){game.FightView.chkCam=this.chk_cam.selected,game.FightView.chkCam&&(ExtConfig.LOG_LEVEL=999)},i);function i(){var t=o.call(this)||this;t.prevX=0,t.prevY=0,t.isModelClose=!0,t.chk_cam.on(Laya.Event.CLICK,t,t.onCam),t.btn1.on(Laya.Event.CLICK,t,t.onGm),t.btn2.on(Laya.Event.CLICK,t,t.onGm),t.btn3.on(Laya.Event.CLICK,t,t.onGm),t.btn4.on(Laya.Event.CLICK,t,t.onGm),t.btn5.on(Laya.Event.CLICK,t,t.onGm),t.btnAddGod.on(Laya.Event.CLICK,t,t.onGm),t.btnAddItem.on(Laya.Event.CLICK,t,t.onGm),t.btnAddMail.on(Laya.Event.CLICK,t,t.onGm),t.btnCmd.on(Laya.Event.CLICK,t,t.onGm),t.btnDelItem.on(Laya.Event.CLICK,t,t.onGm),t.btnJishiRef.on(Laya.Event.CLICK,t,t.onGm),t.btnLv.on(Laya.Event.CLICK,t,t.onGm),t.btnPassTower.on(Laya.Event.CLICK,t,t.onGm),t.btnReset.on(Laya.Event.CLICK,t,t.onGm),t.btnGuide.on(Laya.Event.CLICK,t,t.onGm),t.bgPanel.dataSource={uiName:UIConst.CheatView,closeOnSide:t.isModelClose,closeOnButton:!0};var e=tb.TB_item.get_TB_item();e=e.filter(function(t){return 5!=t.type&&6!=t.type});for(var i=[],n=0;n<e.length;n++)i.push(e[n].name);return t.itemCombo.labels=i.join(","),t.itemCombo.selectHandler=new Handler(t,t.onSelectItem),t.lbContent.on(Laya.Event.MOUSE_DOWN,t,t.startScrollText),t}t.CheatView=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.UserHeadBox1UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{set:function(t){if(this._dataSource=t){var e=t.getFrame();this.img_frame.visible=!!e,e&&(this.img_frame.skin=e),this.imgLv.skin=t.getImgLv(),this.img_icon.skin=t.getIconUrl(),0<=t.getLevel()?(this.box_lev.visible=!0,this.txt_lv.text=t.getLevel().toString()):(this.box_lev.visible=!1,this.txt_lv.text="")}else this.img_icon.skin=null,this.img_frame.visible=!1,this.box_lev.visible=!1},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.UserHeadBox1=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.TabIR3UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){if(t)switch(this.lab_tab.text=t.label,t.red&&""!=t.red?this.redpoint.setRedPointName(t.red):this.redpoint.onDispose(),null!=t.type?t.type:n.TYPE_BOTTOM){case n.TYPE_BOTTOM:this.img_bg.scaleY=1,this.lab_tab.y=23;break;case n.TYPE_TOP:this.img_bg.scaleY=-1,this.lab_tab.y=32}else this.redpoint.onDispose()},n.prototype.setSelect=function(t){this._isSelect!=t&&((this._isSelect=t)?(this.img_bg.skin=SkinUtil.fenye_down,this.lab_tab.color="#7e5336"):(this.img_bg.skin=SkinUtil.fenye_up,this.lab_tab.color="#e6ca91"))},n.onSelectCell=function(t,e){if(t&&!(t.length<1))for(var i=0;i<t.length;i++){var n=t[i];n&&n.setSelect(i==e)}},n.TYPE_TOP=0,n.TYPE_BOTTOM=1,n);function n(){var t=e.call(this)||this;return t._isSelect=!1,t}t.TabIR3=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.TabIR1UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){t?(this.btn_tab.label=t[0],""!=t[1]?this.redpoint.setRedPointName(t[1]):this.redpoint.onDispose()):this.redpoint.onDispose()},n);function n(){return e.call(this)||this}t.TabIR1=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.SkillBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{set:function(t){t?(this._dataSource=t.skill,this._array=this.getSkillInfo(t.skill),this.img_icon.skin=t.skill.getIconUrl(),this.lab_dengji.text="Lv "+t.skill.getLevel().toString(),this.gray=t.dgLv<t.openDgLv,t.isShow&&this.on(Laya.Event.CLICK,this,this.onOut,[!0,t.isShowlist])):(this.off(Laya.Event.CLICK,this,this.onOut),this.img_icon.skin=null)},enumerable:!0,configurable:!0}),n.prototype.onOut=function(t,e){var i=this.localToGlobal(new Laya.Point(0,0));if(0!==this._array.length){var n={skilldata:this._array.concat([]),isShowlist:e};UIUtil.isShowInfoBox(n,t,i.x+this.width/2,i.y)}else UIUtil.isShowInfoBox(null,!1,i.x+this.width/2,i.y)},n.prototype.getSkillInfo=function(t){for(var e=[],i=t;i;)e.push(i),i=tb.TB_skill.get_TB_skillById(i.ID+1);for(i=tb.TB_skill.get_TB_skillById(t.ID-1);i;)e.push(i),i=tb.TB_skill.get_TB_skillById(i.ID-1);return e.sort(function(t,e){return t.level-e.level}),e},n);function n(){var t=e.call(this)||this;return t._array=new Array,t}t.SkillBox=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.SimpleItemBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{set:function(t){(this._dataSource=t)&&(this.imgIcon.skin=t.getIconUrl(),this.lbCount.text="x"+Snums(t.getNum()))},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.SimpleItemBox=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.box.RankIRUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.lbName.text=t.name,this.lbMidDesc.text=t.getMidDesc(),this.lbMid.text=t.getMid(),this.boxMid.visible=t.isShowMid(),this.lbMidDesc.event(Laya.Event.RESIZE),this.lbBottomDesc.text=t.getBottomDesc(),this.lbBottom.text=t.getBottom(),this.boxBottom.visible=t.isShowBottom(),this.lbBottomDesc.event(Laya.Event.RESIZE),this.lbValue.text=t.getValue(),this.lbValueDesc.text=t.getValueDesc(),this.headBox.dataSource=t.getHeadVo(),this.ui_view.dataSource={rank:t.rank},this.headBox.on(Laya.Event.CLICK,this,this.onShowInfo)):(this.headBox.dataSource=null,this.headBox.off(Laya.Event.CLICK,this,this.onShowInfo))},n.prototype.onShowInfo=function(){var t=this.dataSource;t&&t.playerId&&(t.rankSvrType==e.RankSvrType.matchCrossSvr?UIUtil.showMatchLineupInfo(t):UIUtil.showPlayerLineupInfo(t.playerId))},n);function n(){var t=i.call(this)||this;return t.lbMidDesc.autoSize=t.lbBottomDesc.autoSize=!0,t}e.RankIR=t}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.RaceBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{set:function(t){null!=(this._dataSource=t)&&(this.img_race.skin=SkinUtil.getGodBigRaceSkin(t))},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.RaceBox=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.ItemBox3UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){var e=this;this._dataSource=t,(this.itemBox.dataSource=t)&&t instanceof ItemVo&&t.isShowEff?(this.ani_light.visible=!0,this.ani_light.loadAnimation(ResConst.anim_teshutishi,Handler.create(null,function(){e.ani_light.play(1,!0)}),ResConst.atlas_teshutishi)):(this.ani_light.visible=!1,this.ani_light.stop())},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.ItemBox3=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.ItemBox21UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,(this.ui_item.dataSource=t)&&(this.img_receive.visible=t.getExtParm())},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.ItemBox21=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.ItemBox2UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.itemBox.dataSource=t},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.ItemBox2=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.HeadNameBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"img_shangzhen",{get:function(){return this.ui_head.img_shangzhen},enumerable:!0,configurable:!0}),n.prototype.getDataSource=function(){return this._dataSource},Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.ui_head.dataSource=t,this.lab_name.text=t?t.getName():""},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.HeadNameBox=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.HeadBox2UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.hadBox.dataSource=t},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.HeadBox2=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=Laya.Image,n=(e=ui.box.HeadBoxUI,__extends(o,e),Object.defineProperty(o.prototype,"img_shangzhen",{get:function(){return this._img_shangzhen||(this._img_shangzhen=new i(SkinUtil.chuzhan),this._img_shangzhen.scale(.7,.7),this._img_shangzhen.x=1,this._img_shangzhen.y=33,this.addChild(this._img_shangzhen)),this._img_shangzhen},enumerable:!0,configurable:!0}),o.prototype.getDataSource=function(){return this._dataSource},Object.defineProperty(o.prototype,"dataSource",{set:function(t){(this._dataSource=t)?(this.img_icon.skin=t.getIconUrl(),this.img_qulity.skin=t.getFrameUrl(),"function"==typeof t.getLevelStr&&void 0!==t.getLevelStr()?this.txt_lv.text=t.getLevelStr():this.txt_lv.text=0==t.getLevel()?"":t.getLevel().toString(),this.img_race.visible=t.getRaceType(),t.getRaceType()&&(this.img_race.skin=SkinUtil.getGodRaceSkin(t.getRaceType())),1==this._dataSource.getDataType()&&this.img_icon.on(Laya.Event.CLICK,this,this.onshow),t.isMoreThanSix()?(this.list_awake.repeatX=t.getStar()-5,this.list_awake.visible=!0,this.list_star.visible=!1):(this.list_star.visible=0!=t.getStar(),this.list_star.repeatX=t.getStar(),this.list_awake.visible=!1)):(this.img_race.visible=!1,this.img_icon.skin=this.img_qulity.skin=null,this.txt_lv.text="",this.img_icon.off(Laya.Event.CLICK,this,this.onshow),this.list_awake.visible=!1,this.list_star.visible=!1,this.list_awake.repeatX=0,this.list_star.repeatX=0)},enumerable:!0,configurable:!0}),o.prototype.onshow=function(){dispatchEvt(new game.TujianEvent(game.TujianEvent.SHOW_GUAIWUXINXI_PANEL),this._dataSource)},o);function o(){return e.call(this)||this}t.HeadBox=n}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.GodRaceAddUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refresh()},enumerable:!0,configurable:!0}),n.prototype.autoCheckActive=function(t){this._autoCheck=t},n.prototype.refresh=function(){var t=this.dataSource;if(t){var e=t.tbData;this.lab_title.text=e.conditionStr+":",this.lab_content.text=e.desc,this.lab_content.color=this.lab_title.color=t.isActive?"#008f07":"#656565",this.lab_content.x=this.lab_title.x+this.lab_title.width+5}},n);function n(){var t=e.call(this)||this;return t._autoCheck=!0,t}t.GodRaceAddIR=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.effItemBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){var e=this;t?(this.visible=!0,(this.ui_item.dataSource=t).isShowEff?(this.eff.visible=!0,this.eff.loadAnimation(ResConst.anim_teshutishi,Handler.create(null,function(){e.eff.play(1,!0)}),ResConst.atlas_teshutishi)):(this.eff.visible=!1,this.eff.stop())):(this.visible=!1,this.eff.stop())},n);function n(){return e.call(this)||this}t.EffItemBox=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();var CostVo=function(){function e(t){this.itemId=0,this.needNum=0,this.itemId=t[0],this.needNum=t[1]}return e.prototype.gethasCostNum=function(){return App.hero.getBagItemNum(this.itemId)},e.prototype.isNotHaveCost=function(){return this.gethasCostNum()<this.needNum},e.createCostVos=function(t){return isArrayFn(t)||(t=map2ary(t)),t.map(function(t){return new e(t)})},e}();!function(t){var e,i=(e=ui.box.CostIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)&&(this.refresh(),this.resSizeEvent())},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){var t=this.dataSource;this.lbNeed.text="/"+Snums(t.needNum),this.lbHas.text=Snums(t.gethasCostNum()),this.imgCost.skin=SkinUtil.getCostSkin(t.itemId),this.lbHas.color=t.isNotHaveCost()?ColorConst.redFont:ColorConst.normalFont},n.prototype.resSizeEvent=function(){this.imgCost.event(Laya.Event.RESIZE),this.lbNeed.event(Laya.Event.RESIZE),this.lbHas.event(Laya.Event.RESIZE),this.hbox.event(Laya.Event.RESIZE)},n);function n(){return e.call(this)||this}t.CostIR=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.CommonRuleIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.lbTitle.text=t[0],this.htmlText.width=this.width-60,this.htmlText.x=this.width/2-this.htmlText.width/2+8;for(var e="",i=1;i<t.length;i++)e+=i==t.length-1?t[i]:t[i]+"<br/>";this.htmlText.innerHTML=e,this.height=this.htmlText.y+this.htmlText.contextHeight+10}},n);function n(){var t=e.call(this)||this;return t.htmlText.style.align="left",t.htmlText.style.fontSize=22,t.htmlText.style.wordWrap=!0,t.htmlText.style.leading=10,t.htmlText.autoSize=!0,t.htmlText.style.color=ColorConst.normalFont,t}t.CommonRuleIR=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonRankItemUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t&&(this.imgRank.visible=t.rank<=3,this.imgRank.visible&&(this.imgRank.skin=SkinUtil.getRankingSkin(t.rank-1)),this.lbRank.text=t.rank+"",this.lbRank.visible=3<t.rank)},n);function n(){return e.call(this)||this}t.CommonRankIR=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.BaoxiangBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;if(t){this.imgBox.skin=t.getSkin();var e=t.isCanReward();this.imgGuang.visible=e,Laya.Tween.clearTween(this.imgGuang),e&&this.loopRotation(),this.lbCount.text=t.getCount()+"",this.on(Laya.Event.CLICK,this,this.onClick)}else Laya.Tween.clearTween(this.imgGuang),this.off(Laya.Event.CLICK,this,this.onClick)},n.prototype.loopRotation=function(){var t=this;this.imgGuang.rotation=0,Laya.Tween.to(this.imgGuang,{rotation:360},2e3,Laya.Ease.linearInOut,new Handler(this,function(){t.loopRotation()}))},n.prototype.onClick=function(){var t=this.dataSource;t.isCanReward()?dispatchEvt(t.getEvent(),t):UIMgr.showUI(UIConst.ManyItemsTip,{data:t.getRewardList()})},n);function n(){return e.call(this)||this}t.BaoxiangBox=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.AwardRankIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=t.getRankStr();e.length,this.lbRank.text=e,this.lbRank.visible=!0,this.imgRank.visible=!1;var i=t.getRank();isNaN(i)||(this.lbRank.visible=3<i,this.imgRank.visible=i<=3,this.imgRank.skin=i<=3?t.getRankSkin(i):""),this.lbRank.event(Laya.Event.RESIZE),this.itemList.array=t.getRewardList()}else this.itemList.array=null},n);function n(){return e.call(this)||this}t.AwardRankIR=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.hud.view.VipLvUpUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},n.prototype.onOpened=function(){e.prototype.onOpened.call(this),this.eff_guang.play()},n.prototype.initView=function(){var t=this.dataSource;this.lbScore.text="积分x"+(t.newScore-t.oldScore),this.oldClip.value=t.oldVip,this.newClip.value=t.newVip},n.prototype.close=function(){e.prototype.close.call(this),this.dataSource&&this.dataSource.callback&&this.dataSource.callback.call(null),this.eff_guang.stop()},n.prototype.onClosed=function(){e.prototype.onClosed.call(this)},n);function n(){var t=e.call(this)||this;return t.isModelClose=!1,t.btnComfirnm.on(Laya.Event.CLICK,t,t.close),t}t.VipLvUpView=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.prompt.upPowerUI,__extends(n,e),n.prototype.show=function(){e.prototype.show.call(this,!1,!1),this.updateEff()},n.prototype.updateEff=function(){if(this.dataSource){this.resetAll(),this.box_changNum.visible=!1,this._start=this.dataSource.start,this._end=this.dataSource.end,this._start=Math.round(this._start),this._end=Math.round(this._end),this.clip_power.value=String(this._start);var t=this.getLen(),e=t+68;this.img_bg.width=e,this.box_changNum.x=35+t;var i=(Laya.stage.width>>1)-(e>>1)-32;this.x=i,this.y=(Laya.stage.height>>1)-this.dataSource.posy,this.moveOk()}else this.close()},n.prototype.getLen=function(){var t=String(this._end).length,e=String(this._start).length,i=Math.max(t,e);if(0!=i)return 29*i+this.clip_power.spaceX*(i-1)},n.prototype.moveOk=function(){var t=0;t=this._end>this._start?this._end-this._start:this._start-this._end,this._num=t/700*20,this._num=Math.max(1,this._num),this.clip_power.timerLoop(20,this,this.loopFun)},n.prototype.loopFun=function(){var t=Number(this.clip_power.value);if(this._end>this._start)if(this._end<=t)this.clip_power.clearTimer(this,this.loopFun),this.clip_power.value=String(this._end),this.onclose();else{var e=Math.ceil(t+this._num);this.clip_power.value=String(e)}else this._end>=t?(this.clip_power.clearTimer(this,this.loopFun),this.clip_power.value=String(this._end),this.onclose()):(e=Math.ceil(t-this._num),this.clip_power.value=String(e))},n.prototype.onclose=function(){var t=this;this.box_changNum.visible=!0,this.box_changNum.y=20;var e=this._end>=this._start;this.clip_changNum.skin=SkinUtil.getclipNum(e),this.img_changNum.skin=SkinUtil.getAddOrDec(e);var i=e?this._end-this._start:this._start-this._end;i=Math.round(i),this.clip_changNum.value=String(i),e?Laya.Tween.to(this.box_changNum,{y:-14},300):Laya.Tween.to(this.box_changNum,{y:75},300),this._ticknum=setTimeout(function(){t.close()},600)},n.prototype.resetAll=function(){this.clip_power.clearTimer(this,this.loopFun),clearTimeout(this._ticknum),Laya.Tween.clearAll(this.box_changNum)},n.prototype.close=function(){e.prototype.close.call(this),this.resetAll()},n);function n(){var t=e.call(this)||this;return t.mouseEnabled=!1,t.mouseThrough=!0,t.isIgnore=!0,t}t.UpPower=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.TishiUI,__extends(n,e),n.getInstance=function(){return n._alertBox||(n._alertBox=new n),n._alertBox},n.close=function(){n.getInstance().close()},n.showTishi=function(t){t.yes=t.yes?t.yes:LanMgr.getLan("",10038),t.no=t.no?t.yes:LanMgr.getLan("",10039),n.getInstance().showTishi(t)},n.showTishiYes=function(t){t.yes=t.yes?t.yes:LanMgr.getLan("",10038),n.getInstance().showTishi(t)},n.prototype.showTishi=function(t){this._confirmVo=t,this.isModal=!0,this.popupCenter=!0,this.popup(!1),this.bgPanel.setTitleVisible(!!t.title),t.title&&(this.bgPanel.lbTitle.text=t.title),this.btn_No.label=t.no,this.btn_Yes.label=t.yes,this.chk_auto.selected=!1,this._htmlText.innerHTML=t.text,this.btn_No.on(Laya.Event.CLICK,this,this.onClose),this.btn_Yes.on(Laya.Event.CLICK,this,this.onConfirm),this._htmlText.y=85-(this._htmlText.contextHeight-22)/2,t.no?(this.btn_No.visible=!0,this.btn_Yes.right=this.btn_No.left=90):(this.btn_Yes.centerX=0,this.btn_No.visible=!1)},n.prototype.initHtmlText=function(){this._htmlText.style.color=ColorConst.normalFont,this._htmlText.style.align="center",this._htmlText.style.wordWrap=!0,this._htmlText.mouseEnabled=!1,this._htmlText.style.fontSize=22,this._htmlText.style.leading=5,this._htmlText.style.width=380,this.addChild(this._htmlText),this._htmlText.x=110,this._htmlText.y=85},n.prototype.onConfirm=function(){this._confirmVo.confirmCb&&this._confirmVo.confirmCb(this.chk_auto.selected),this.onClose()},n.prototype.onClose=function(){this.close()},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this._confirmVo=null,this.btn_No.off(Laya.Event.CLICK,this,this.onClose),this.btn_Yes.off(Laya.Event.CLICK,this,this.onConfirm)},n);function n(){var t=e.call(this)||this;return t._htmlText=new Laya.HTMLDivElement,t.initHtmlText(),t.isModelClose=!0,t.name=UIConst.TishiView,t.zOrder=UI_DEPATH_VALUE.GUIDE,t.bgPanel.dataSource={uiName:UIConst.TishiView,closeOnSide:t.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",10536)},t}t.TishiView=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var a,e=(a=ui.prompt.RoleEffUI,__extends(i,a),Object.defineProperty(i.prototype,"godVo",{get:function(){return this.dataSource[0]},enumerable:!0,configurable:!0}),i.prototype.onOpened=function(){var e=this;if(a.prototype.onOpened.call(this),!this.dataSource){var t=new GodItemVo(tb.TB_god.get_TB_godById(4107));t.starLevel=10,this.dataSource=[t,UI_FLYTEXT.UPSTART]}this.img_zhezhao.on(Laya.Event.CLICK,this,this.onExit),this.uiScene.onShow();var i=this.godVo,n=this.dataSource[1];if(this.lab_info.visible=!1,this._lastTime=Date.now(),this.drawListView(i),this.img_bgs.visible=this.imgBg.visible=this.list_stars_0.visible=n!=UI_FLYTEXT.UPSTART,this.box_skill.visible=!1,this.starList.visible=n==UI_FLYTEXT.UPSTART&&this.godVo.starLevel<=5,n==UI_FLYTEXT.UPSTART)this.playGodStarUpEffect(),this.setModel(i.getModel());else if(n==UI_FLYTEXT.AWAKEN){var o=i.tab_god.model;this.setModel(o),this.drawStar(i.getStar())}setTimeout(function(){e.uiScene.addEffect(e,1000002,new tl3d.Vector3D(180,0,-640),3,30,function(t){e.roleRotation(t,i,n)})},500)},i.prototype.drawListView=function(t){this.lab_name.text=t.tab_god.name},i.prototype.drawStar=function(t){var e=6<=t?t-5:t;this.list_stars_0.repeatX=e;for(var i=new Array,n=0;n<e;n++)i[n]=6<=t;this.list_stars_0.dataSource=i,this.list_stars_0.x=291+29*(5-e)/2},i.prototype.onXingjiRender=function(t,e){t.dataSource?(t.skin=SkinUtil.superXing,t.width=29,t.height=31):t.skin=SkinUtil.xingxing},i.prototype.onClosed=function(){this.dataSource&&this.dataSource[2]&&UIUtil.showRewardView(this.dataSource[2]),a.prototype.onClosed.call(this),this.img_zhezhao.off(Laya.Event.CLICK,this,this.onExit),this._anis.forEach(function(t){return t.destroy()}),this._anis.length=0,this.uiScene.onExit(),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),this.onRemoveEffect()},i.prototype.onRemoveEffect=function(){for(var t=0,e=this.effList;t<e.length;t++){var i=e[t];this.uiScene.removeEffect(i)}this.effList.length=0},i.prototype.onExit=function(){UIMgr.hideUIByName(UIConst.ShowRole)},i.prototype.roleRotation=function(t,e,i){var n=this;setTimeout(function(){n.img_bgs.visible=!0,n.img_bgs.alpha=0,Laya.Tween.to(n.img_bgs,{alpha:i!=UI_FLYTEXT.UPSTART?1:0},1e3,null,Handler.create(n,function(){i==UI_FLYTEXT.AWAKEN?(n.setModel(e.tab_god.awake_model),n.drawStar(e.getStar())):i==UI_FLYTEXT.UPSTART&&(n.setModel(e.getModel()),n.drawStar(e.getStar()),n.showSkill(e)),Laya.Tween.to(n.img_bgs,{alpha:0},1e3,null,Handler.create(n,function(){n.img_bgs.visible=!1})),i!=UI_FLYTEXT.UPSTART?(n.uiScene.addEffect(n,10000015,new tl3d.Vector3D(180,0,-200),7,-30,null,180),setTimeout(function(){n.lab_info.visible=!0},500)):n.lab_info.visible=!0}))},500)},i.prototype.showSkill=function(t){var e=t.getStar();if(t.degree,t&&!(e<2)){for(var i=tb.TB_god_evolution.get_TB_god_evolutionById(e),n=tb.TB_god_evolution.get_TB_god_evolutionById(e-1),o=-1,a=0,r=0,s=0;s<i.evolution_effect.length;s++)if(i.evolution_effect[s]>n.evolution_effect[s]){o=s,a=i.evolution_effect[s],r=n.evolution_effect[s];break}if(-1!=o){var u=t.tab_god.getAllSkill(t.degree,t.getStar()-1),h=t.jisuanjineng();if(u&&!(o>=u.length)&&h&&!(o>=h.length)){this.box_skill.visible=!0;var l=u[o],c={skill:l,openDgLv:l.level,dgLv:r,isShow:!1,isShowlist:!1};this.oldSkill.dataSource=c;var p=h[o],d={skill:p,openDgLv:p.level,dgLv:a,isShow:!1,isShowlist:!1};this.newSkill.dataSource=d}}}},i.prototype.setModel=function(t){this.uiScene&&this.uiScene.addModelChar(t,360,850,180)},i.prototype.playGodStarUpEffect=function(){var i=this;this.effList.length=0;var t=this.godVo.starLevel;this._type=5<t;var n=this._type?t-5:t;if(5<t){function e(e){Laya.timer.once(200*(e+1),o,function(){var t=100+21*(5-n)+42*e;i.uiScene.addEffect(i,10000024,new tl3d.Vector3D(t,0,-120),3,3,function(t){UIMgr.hasStage(UIConst.ShowRole)?i.effList.push(t):i.onRemoveEffect()},180),e+1==n&&i.uiScene.addEffect(i,10000014,new tl3d.Vector3D(180,0,-200),7,3,null,180)})}for(var o=this,a=0;a<n;a++)e(a)}else this.starList.repeatX=n,this.starList.x=95+75*(5-this.starList.repeatX)/2,this.starList.cells.forEach(function(t,e){t.red.visible=t.glod.visible=!1,Laya.timer.once(200*(e+1),t,function(){i._type?t.red.visible=!0:t.glod.visible=!0,i._type?t.red.play(0,!1):t.glod.play(0,!1),e+1==i.starList.repeatX&&i.uiScene.addEffect(i,10000014,new tl3d.Vector3D(180,0,-200),7,3,null,180)})})},i);function i(){var t=a.call(this)||this;return t.effList=[],t._anis=[],t.popupCenter=!0,t.list_stars_0.renderHandler=new Handler(t,t.onXingjiRender),t.uiScene=new Base2dSceneLayer,t.uiScene.setModelBox(t,t.img_level,t.lab_name),t.addChildAt(t.uiScene,t.numChildren-2),t.isModelClose=!0,t}t.ShowRole=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.component.CommonRewardBoxUI,__extends(e,n),e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){this._rewardOpt=this.dataSource;var t=this._rewardOpt.rewardList;for(var e in t)t[e].show=!0,t[e].startAction=!0;this.imgBg.height=4<t.length?360:290,this.closeByBlank.y=4<t.length?359:289,this.list.repeatX=4<t.length?4:t.length,this.list.width=100*this.list.repeatX,this.list.height=4<t.length?220:100,this.list.y=4<t.length?this.y-48:this.y-35,this.list.x=Laya.stage.width/2-45-(this.list.repeatX-1)*((90+this.list.spaceX)/2),this.listVo.initData(this.list),this.listVo._dataSource=t,this.listVo.setZorder(this.zOrder),this.listVo.setWidth(this.list.width),this.listVo.setHeight(this.list._height),this.listVo.setPosition(this.list.x,this.list.y),this._efflist=i.EffectList.showEffectList(this.listVo)},e.prototype.close=function(){n.prototype.close.call(this),this.dataSource&&this.dataSource.callback&&this.dataSource.callback.call(null),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),AudioMgr.playSound("sound/getreward.mp3")},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),this.list.array=null,this._rewardOpt&&(this._rewardOpt.handler&&this._rewardOpt.handler.runWith([this._rewardOpt.type,this._rewardOpt.rewardList]),Laya.Pool.recover("RewardInfoVo",this._rewardOpt)),this._rewardOpt=null,ShowRewardUtil.CheckRewardList()},e);function e(){var t=n.call(this)||this;return t.isModelClose=!0,t.list.visible=!1,t.listVo=new ListVo(t.list),t}i.ShowRewardView=t}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,n,e,o=(i=ui.component.PlayerLinuepInfoUI,__extends(a,i),a.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.btnLinueUp.on(Laya.Event.CLICK,this,this.onLinueUp),this.btnChallenge.on(Laya.Event.CLICK,this,this.onChallenge)},a.prototype.popup=function(){var t=this.dataSource.type==n.arena;if(this.btnChallenge.visible=this.btnLinueUp.visible=t,this.btnChallenge.x=376,this.btnChallenge.label="挑战",t){var e=this.dataSource;this.btnLinueUp.visible=e.rank<e.myRank,this.btnChallenge.x=this.btnLinueUp.visible?376:275,this.btnChallenge.label=this.btnLinueUp.visible?"挑战":"扫荡"}this.height=this.img_bg.height=t?730:660,i.prototype.popup.call(this),this.initView()},a.prototype.initView=function(){this.btnClose.on(Laya.Event.CLICK,this,this.close);var t=this.dataSource;this.lab_title.text=t.type==n.arena?"挑 战":"阵 容",this.lbName.text=t.name,this.lbGuild.text=t.guildName?"公会："+t.guildName:"暂无公会",this.headBox.dataSource=new UserHeadVo(t.head,t.level,t.headFrame),this.lineupUI.dataSource={lineupGods:t.getLineupGods(),shenqiAry:t.getShenqiAry(),showShenli:!0,force:t.force,userLevel:t.level,title:""}},a.prototype.onLinueUp=function(){dispatchEvt(new game.GodEvent(game.GodEvent.SHOW_BUZHEN_PANEL),iface.tb_prop.lineupTypeKey.attack)},a.prototype.onChallenge=function(){var t=this.dataSource;if(t instanceof game.ArenaInfoVo){if(!t.canChallenge)return void(t.isMySelf()?showToast(LanMgr.getLan("",10208)):showToast(LanMgr.getLan("",10209)));t.rank>=t.myRank?dispatchEvt(new game.ArenaEvent(game.ArenaEvent.ARENA_BATTEL_SWEEP),this.dataSource):dispatchEvt(new game.ArenaEvent(game.ArenaEvent.ARENA_BATTEL_START),this.dataSource)}},a.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btnClose.off(Laya.Event.CLICK,this,this.close),this.lineupUI.dataSource=null},a);function a(){var t=i.call(this)||this;return t.isModelClose=!0,t}t.PlayerLineupInfoView=o,(e=n=t.LinuepType||(t.LinuepType={}))[e.glory=1]="glory",e[e.arena=2]="arena"}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.component.PlayerInfoUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.btnAdd.on(Laya.Event.CLICK,this,this.onClick),this.btnChat.on(Laya.Event.CLICK,this,this.onClick),this.btn_del.on(Laya.Event.CLICK,this,this.onClick),this.btn_qxlh.on(Laya.Event.CLICK,this,this.onClick),this.btn_lh.on(Laya.Event.CLICK,this,this.onClick),this.btnClose.on(Laya.Event.CLICK,this,this.close)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btn_del.visible=this.btn_lh.visible=this.btn_qxlh.visible=this.btnAdd.visible=this.btnChat.visible=!0,this.lineupUI.dataSource=null},e.prototype.initView=function(){this.lab_title.text="好友详情";var t=this.dataSource,e=t.clientVo;this.lbName.text=e&&e.name?e.name:t.svo.name;var i=e&&e.guildName?e.guildName:t.svo.guildName;this.lbGuild.text=i?LanMgr.getLan("",12560,i):LanMgr.getLan("",12561),this.headBox.dataSource=new UserHeadVo(t.svo.head,t.svo.level,t.svo.headFrame);var n=this._fdmodel.isMyFriend(t.svo.playerId);this.btnAdd.visible=!n,this.btn_del.visible=n,this.updateBlockBtn(),this.lineupUI.dataSource={lineupGods:t.getLineupGods(),shenqiAry:t.getShenqiAry(),showShenli:!0,force:t.svo.force,userLevel:t.svo.level,title:""},t.hideAllBtn&&(this.btn_del.visible=this.btn_lh.visible=this.btn_qxlh.visible=this.btnAdd.visible=this.btnChat.visible=!1)},e.prototype.updateBlockBtn=function(){var t=this.dataSource,e=App.hero.isInBlockList(t.svo.playerId);this.btn_lh.visible=!e,this.btn_qxlh.visible=e},e.prototype.onClick=function(t){var n=this,e=this.dataSource,i=t.target;i==this.btnAdd?dispatchEvt(new game.FriendEvent(game.FriendEvent.FRIEND_PANAEL_ADDFRIEND),e.svo.playerId):i==this.btnChat?(dispatchEvt(new game.ChatEvent(game.ChatEvent.SHOW_PRIVATE_CHAT_VIEW),e.svo.playerId),this.close()):i==this.btn_del?o.AlertBox.showAlert({text:LanMgr.getLan("",10485),confirmCb:function(t){var e={};e[Protocol.friend_friend_delete.args.playerId]=t.svo.playerId,PLC.request(Protocol.friend_friend_delete,e,function(t,e){if(t){n._fdmodel.delFriend(t.delfriend);var i=UIMgr.getUIByName(UIConst.Friend_MainView);i&&i.initFriendListView(),n.close()}})},parm:e}):i==this.btn_lh?o.AlertBox.showAlert({text:LanMgr.getLan("",10486),confirmCb:function(t){var e={};e[Protocol.friend_friend_pullBlack.args.playerId]=t.svo.playerId,PLC.request(Protocol.friend_friend_pullBlack,e,function(t,e){if(t){App.hero.addBlockList(t.addBlack),n._fdmodel.delFriend(t.delfriend);var i=UIMgr.getUIByName(UIConst.Friend_MainView);i&&i.initFriendListView(),n.close()}})},parm:e}):i==this.btn_qxlh&&o.AlertBox.showAlert({text:LanMgr.getLan("",10487),confirmCb:function(t){var e={};e[Protocol.friend_friend_pullWhite.args.playerId]=t.svo.playerId,PLC.request(Protocol.friend_friend_pullWhite,e,function(t,e){t&&(App.hero.removeBlockListById(t.delBlack),n.updateBlockBtn())})},parm:e})},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t._fdmodel=game.FriendModel.getInstance(),t}o.PlayerInfoView=t;var n,a=(__extends(r,n=BaseFightVo),r.prototype.setData=function(t,e,i,n,o,a){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=!1),void 0===a&&(a=!1),this.hideAllBtn=o,this.isCrossSvr=a,(this.svo=t).playerId=e,this.svo.event=i,this.svo.eventdata=n,this.setLineupInfo(t.lineupInfo),this.setDataType(1)},r);function r(){var t=n.call(this)||this;return t.hideAllBtn=!1,t.isCrossSvr=!1,t}o.PlayerInfoVo=a}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.component.LevelUpUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,!1),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,!1),this.initView()},n.prototype.initView=function(){AudioMgr.playSound("sound/uplevel.mp3"),this.isModelClose=!1,this.clipLv.value=App.hero.level.toString(),this.lbOldLv.text=game.HudModel.getInstance().oldUserLv+"",this.lbNewLv.text=App.hero.level.toString(),this.updateReward()},n.prototype.updateReward=function(){var t=tb.TB_role.get_TB_rolenById(App.hero.level-1);if(t&&0<t.reward.length){this.bgPanel.bg.visible=!0,this.box_reward.visible=!0;for(var e=ary2prop(t.reward),i=0,n=e;i<n.length;i++){var o=n[i];o.show=!0,o.startAction=!0}this.list_reward.repeatX=3<e.length?3:e.length,this.list_reward.width=100*this.list_reward.repeatX-10,this.list_reward.height=3<e.length?150:90,this.list_reward.x=(Laya.stage.width-this.list_reward.width)/2,this.list_reward.y=(Laya.stage.height-this.height)/2+283,this._listRewardVo.initData(this.list_reward),this._listRewardVo._dataSource=e,this._listRewardVo.setZorder(this.zOrder+1),this._listRewardVo.setWidth(this.list_reward.width),this._listRewardVo.setHeight(this.list_reward.height),this._listRewardVo.setPosition(this.list_reward.x,this.list_reward.y)}this.bgPanel.showTitle("zhandoubiaoxian/shengji.png",!0,!0,Handler.create(this,this.showTitleComplete),this)},n.prototype.showTitleComplete=function(){this._efflist=t.EffectList.showEffectList(this._listRewardVo),this.isModelClose=!0},n.prototype.close=function(){i.prototype.close.call(this),this.bgPanel.closeTitle(),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null,AudioMgr.playSound("sound/getreward.mp3"))},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),clearTimeout(this._timeid),this.lbNotice.visible=!1,this.isModelClose=!1},n);function n(){var t=i.call(this)||this;return t._timeid=0,t.list_reward.visible=!1,t._listRewardVo=new ListVo(t.list_reward),t}t.LevelUpView=e}(common=common||{});var ComsumeAlertType;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.ConsumeAlertUI,__extends(n,e),n.getInstance=function(){return n.comsumeAlert||(n.comsumeAlert=new n),n.comsumeAlert},n.close=function(){n.getInstance().close()},n.showAlert=function(t){t.type=ComsumeAlertType.NORMAL,t.yes=t.yes?t.yes:LanMgr.getLan("",10038),t.no=t.no?t.no:LanMgr.getLan("",10039),n.getInstance().showAlert(t)},n.prototype.showAlert=function(t){this.isModelClose=t.type!=ComsumeAlertType.NORMAL,this.popupCenter=!0,this.isModal=!0,this._confirmVo=t,this.popup(!1),this.bgPanel.setTitleVisible(!!t.title),t.title&&(this.bgPanel.lbTitle.text=t.title),this.btnNot.on(Laya.Event.CLICK,this,this.onCancel),this.btnYes.on(Laya.Event.CLICK,this,this.onConfirm),this.btnYes.label=t.yes,this.btnNot.label=t.no,this.lab_content0.text=t.text?t.text:"",this.lab_content1.text=t.text1?t.text1:"",this.lab_content2.text=t.text2?t.text2:"",this.hbox.refresh()},n.prototype.onConfirm=function(){this._confirmVo.confirmCb&&this._confirmVo.confirmCb(),this.onClose()},n.prototype.onCancel=function(){this._confirmVo.cancelCb&&this._confirmVo.cancelCb(),this.onClose()},n.prototype.onClose=function(){this.close()},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this._confirmVo=null,this.btnNot.off(Laya.Event.CLICK,this,this.onCancel),this.btnYes.off(Laya.Event.CLICK,this,this.onConfirm)},n);function n(){var t=e.call(this)||this;return t.name=UIConst.ComsumeAlert,t.zOrder=UI_DEPATH_VALUE.ALERT,t.bgPanel.dataSource={uiName:UIConst.ComsumeAlert,closeOnSide:t.isModelClose,closeOnButton:!1,title:"提 示"},t}t.ComsumeAlert=i}(common=common||{}),function(t){t[t.NORMAL=0]="NORMAL"}(ComsumeAlertType=ComsumeAlertType||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonTitleUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.eff_guang.play(),this.img_title.skin=t.title,this.closeByBlank.visible=!t.hasOwnProperty("closeOnSide")||t.closeOnSide):this.eff_guang.stop()},n);function n(){return e.call(this)||this}t.CommonTitleView=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonTitle9UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.eff_guang.play(),this.img_title.skin=t.title):this.eff_guang.stop()},n);function n(){return e.call(this)||this}t.CommonTitle9View=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonTitle7UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.btnClose.visible=!t.hasOwnProperty("closeOnButton")||t.closeOnButton,this.closeByBlank.visible=!t.hasOwnProperty("closeOnSide")||t.closeOnSide,this.closeByBlank.bottom=t.hasOwnProperty("bottom")?t.bottom:-60;var e=!!t.hasOwnProperty("title")&&t.title&&""!=t.title;this.lbTitle.text=e?t.title:"",this.setTitleVisible(e)}else this.setTitleVisible(!1)},n.prototype.updateTitle=function(t){var e=this.dataSource;e&&(e.title=t),this.lbTitle.text=t,this.setTitleVisible(!!t)},n.prototype.setTitleVisible=function(t){this.bgTitle.visible=this.lbTitle.visible=t},n.prototype.onClick=function(){if(this.dataSource&&this.dataSource.uiName)UIMgr.hideUIByName(this.dataSource.uiName);else{var t=this.parent;t&&t.close("buttonClose",!0)}},n);function n(){var t=e.call(this)||this;return t.btnClose.on(Laya.Event.CLICK,t,t.onClick),t.setTitleVisible(!1),t}t.CommonTitle7View=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonTitle6UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.btnClose.visible=!t.hasOwnProperty("closeOnButton")||t.closeOnButton,this.closeByBlank.visible=!t.hasOwnProperty("closeOnSide")||t.closeOnSide,this.closeByBlank.bottom=t.hasOwnProperty("bottom")?t.bottom:-60;var e=!!t.hasOwnProperty("title")&&t.title&&""!=t.title;this.lbTitle.text=e?t.title:"",this.setTitleVisible(e)}else this.setTitleVisible(!1)},n.prototype.updateTitle=function(t){var e=this.dataSource;e&&(e.title=t),this.lbTitle.text=t,this.setTitleVisible(!!t)},n.prototype.setTitleVisible=function(t){this.bgTitle.visible=this.lbTitle.visible=t},n.prototype.onClick=function(){if(this.dataSource&&this.dataSource.uiName)UIMgr.hideUIByName(this.dataSource.uiName);else{var t=this.parent;t&&t.close("buttonClose",!0)}},n);function n(){var t=e.call(this)||this;return t.btnClose.on(Laya.Event.CLICK,t,t.onClick),t.setTitleVisible(!1),t}t.CommonTitle6View=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonTitle5UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.btnClose.visible=!t.hasOwnProperty("closeOnButton")||t.closeOnButton,this.closeByBlank.visible=!t.hasOwnProperty("closeOnSide")||t.closeOnSide,this.closeByBlank.bottom=t.hasOwnProperty("bottom")?t.bottom:-60;var e=!!t.hasOwnProperty("title")&&t.title&&""!=t.title;this.lbTitle.text=e?t.title:"",this.setTitleVisible(e)}else this.setTitleVisible(!1)},n.prototype.updateTitle=function(t){var e=this.dataSource;e&&(e.title=t),this.lbTitle.text=t,this.setTitleVisible(!!t)},n.prototype.setTitleVisible=function(t){this.bgTitle.visible=this.lbTitle.visible=t},n.prototype.onClick=function(){if(this.dataSource&&this.dataSource.uiName)UIMgr.hideUIByName(this.dataSource.uiName);else{var t=this.parent;t&&t.close("buttonClose",!0)}},n);function n(){var t=e.call(this)||this;return t.btnClose.on(Laya.Event.CLICK,t,t.onClick),t}t.CommonTitle5View=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonTitle4UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.bgContent.visible=!t.centerBgHide,this.btnClose.visible=!t.hasOwnProperty("closeOnButton")||t.closeOnButton,this.closeByBlank.visible=!t.hasOwnProperty("closeOnSide")||t.closeOnSide,this.closeByBlank.bottom=t.hasOwnProperty("bottom")?t.bottom:-60;var e=!!t.hasOwnProperty("title")&&t.title&&""!=t.title;this.lbTitle.text=e?t.title:"",this.setTitleVisible(e)}else this.setTitleVisible(!1)},n.prototype.updateTitle=function(t){var e=this.dataSource;e&&(e.title=t),this.lbTitle.text=t,this.setTitleVisible(!!t)},n.prototype.setTitleVisible=function(t){this.bgTitle.visible=this.lbTitle.visible=t},n.prototype.onClick=function(){if(this.dataSource&&this.dataSource.uiName)UIMgr.hideUIByName(this.dataSource.uiName);else{var t=this.parent;t&&t.close("buttonClose",!0)}},n);function n(){var t=e.call(this)||this;return t.btnClose.on(Laya.Event.CLICK,t,t.onClick),t.setTitleVisible(!1),t}t.CommonTitle4View=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonTitle2UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.btnClose.visible=!t.hasOwnProperty("closeOnButton")||t.closeOnButton,this.closeByBlank.visible=!t.hasOwnProperty("closeOnSide")||t.closeOnSide,this.closeByBlank.bottom=t.hasOwnProperty("bottom")?t.bottom:-60;var e=!!t.hasOwnProperty("title")&&t.title&&""!=t.title;this.lbTitle.text=e?t.title:"",this.setTitleVisible(e)}else this.setTitleVisible(!1)},n.prototype.updateTitle=function(t){var e=this.dataSource;e&&(e.title=t),this.lbTitle.text=t,this.setTitleVisible(!!t)},n.prototype.setTitleVisible=function(t){this.bgTitle.visible=this.lbTitle.visible=t},n.prototype.onClick=function(){if(this.dataSource&&this.dataSource.uiName)UIMgr.hideUIByName(this.dataSource.uiName);else{var t=this.parent;t&&t.close("buttonClose",!0)}},n);function n(){var t=e.call(this)||this;return t.btnClose.on(Laya.Event.CLICK,t,t.onClick),t.setTitleVisible(!1),t}t.CommonTitle2View=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var i,t=(i=ui.component.CommonRuleUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.ctPanel.vScrollBarSkin=""},e.prototype.show=function(t,e){this.initView(),i.prototype.show.call(this,t,e)},e.prototype.popup=function(t,e){this.initView(),i.prototype.popup.call(this,t,e)},e.prototype.close=function(){i.prototype.close.call(this),this.removeRules()},e.prototype.initView=function(){var t=this.dataSource;this.width=t.width,this.ctPanel.width=t.width-40;var e=0;this.removeRules();for(var i=0;i<t.content.length;i++){var n=Laya.Pool.getItemByClass("CommonRuleIR",a.CommonRuleIR);n.width=this.ctPanel.width,n.dataSource=t.content[i],n.y=e,e+=n.height,this.ctPanel.addChild(n),this._ruleList.push(n)}if(0<t.height)this.height=t.height,this.ctPanel.height=this.height-this.ctPanel.y-60;else{var o=this.ctPanel.y+e+60;o<350&&(o=350),800<o&&(o=800),this.height=o,this.ctPanel.height=this.height-this.ctPanel.y-60}},e.prototype.removeRules=function(){for(var t=0,e=this._ruleList;t<e.length;t++){var i=e[t];i.dataSource=null,Laya.Pool.recover("CommonRuleIR",i)}this._ruleList.length=0,this.ctPanel.removeChildren()},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.CommonRuleView,closeOnSide:t.isModelClose,title:"提 示"},t._ruleList=[],t}a.CommonRuleView=t}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.component.CommonRewardBoxUI,__extends(e,n),e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){this._rewardOpt=this.dataSource,this.zOrder=this._rewardOpt.zorder;var t=this._rewardOpt.itemList;for(var e in t)t[e].show=!0,t[e].startAction=!0;this.imgBg.height=4<t.length?360:290,this.closeByBlank.y=4<t.length?359:289,this.list.repeatX=4<t.length?4:t.length,this.list.width=100*this.list.repeatX,this.list.height=4<t.length?220:100,this.list.y=4<t.length?this.y-48:this.y-35,this.list.x=Laya.stage.width/2-45-(this.list.repeatX-1)*((90+this.list.spaceX)/2),this.listVo.initData(this.list),this.listVo._dataSource=t,this.listVo.setZorder(this._rewardOpt.zorder),this.listVo.setWidth(this.list.width),this.listVo.setHeight(this.list._height),this.listVo.setPosition(this.list.x,this.list.y),this._efflist=i.EffectList.showEffectList(this.listVo)},e.prototype.close=function(){n.prototype.close.call(this),this.dataSource&&this.dataSource.callback&&this.dataSource.callback.call(null),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),AudioMgr.playSound("sound/getreward.mp3")},e.prototype.onClosed=function(){this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),n.prototype.onClosed.call(this),this.list.array=null,this._rewardOpt=null,UIUtil.vipData&&(UIUtil.showVipupPanel(UIUtil.vipData),UIUtil.vipData=null)},e);function e(){var t=n.call(this)||this;return t.isModelClose=!0,t.list.visible=!1,t.listVo=new ListVo(t.list),t}i.CommonRewardView=t}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.god.CommonLineupViewUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._godItems=[];for(var t=0;t<6;t++){var e=this["godBox"+t];e.ui_head.mouseEnabled=!1,e.on(Laya.Event.CLICK,this,this.onShowGodInfo),this._godItems.push(e)}},Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)?this.initView():this.onExit()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t.userLevel=t.userLevel||999,this.setLinueBox();var e=t.shenqiAry,i=e&&0<e.length?e[0]:0;if(this.imgShenqi.visible=0<i,0<i){var n=tb.TB_artifact.get_TB_artifactById(i);this.imgShenqi.skin=SkinUtil.getArtifCircleIcon(n.icon)}this.lbShenli.visible=this.imgShenli.visible=t.showShenli,this.lbTitle.visible=!t.showShenli,this.lbShenli.text=t.force+"",this.lbTitle.text=t.title},n.prototype.setLinueBox=function(){var t=this.dataSource;if(t){for(var e=t.lineupGods||[],i=[],n=tb.TB_game_set.get_TB_game_setById(1),o=0;o<6;o++){var a=e[o],r=this._godItems[o],s=this["lbPos"+o],u=this["lbLock"+o],h=this["imgLock"+o],l=n.lineup[o]<=t.userLevel;s.visible=l&&!a,u.visible=h.visible=!l,u.text=n.lineup[o]+"级开启",s.text=o<2?"前排":"后排",a instanceof GodItemVo?(r.dataSource=a,r.visible=!!a,i.push(a.tab_god.race_type)):a instanceof tb.TB_monster?(r.dataSource=a,r.visible=!!a,i.push(a.race_type)):(r.visible=!1,i.push(-1))}this.guanghuanUI.initView(0,i)}},n.prototype.clearGodList=function(){for(var t=0;t<this._godItems.length;t++)this._godItems[t].dataSource=null},n.prototype.onShowGodInfo=function(t){var e=t.currentTarget;e&&e.dataSource&&dispatchEvt(new game.TujianEvent(game.TujianEvent.SHOW_GUAIWUXINXI_PANEL),e.dataSource)},n.prototype.onExit=function(){this.guanghuanUI.onExit(),this.clearGodList(),this._dataSource=null},n);function n(){return i.call(this)||this}t.CommonLineupView=e}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonLevelUpTitleUI,__extends(n,e),n.prototype.showTitle=function(t,e,i,n,o){void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=null),void 0===o&&(o=null),this.closeTitle(!1),this._isShowStar=e,this._isShowLight=i,this._callBack=n,this._titleparent=o,this._isShow=!0,o&&this._titleparent.box_content&&(this._titleparent.box_content.visible=!1),this.img_title.skin=t,this._step=0,Laya.timer.loop(30,this,this.update)},n.prototype.update=function(){this._cdTime-=30,this._cdTime<=0&&(0!=this._step||this.box_cb.visible?1!=this._step||this.box_light_eff.visible?2==this._step?(this._step=3,this.ani_bg_pd.play(0,!0)):3<=this._step&&this.endUpdate():(this._step=2,this._isShowLight&&(this.box_light_eff.visible=!0,this.eff_guang.play(),this._cdTime=200),this._titleparent&&this._titleparent.box_content&&(this._titleparent.box_content.visible=!0),this.ani_bg_sf.play(0,!1),this.ani_cb_hd.play(),this.box_star.visible=!0,this.ani_xx_xz.play()):(this._step=1,this.box_cb.visible=!0,this.ani_cb_zk.play(0,!1),this._isShowStar&&(this.ani_star.visible=!0,this.ani_star.play(0,!0)),this.img_hg_bg.visible=!0,this._cdTime=100))},n.prototype.endUpdate=function(){this._callBack&&(this._callBack.run(),this._callBack=null),Laya.timer.clear(this,this.update)},n.prototype.closeTitle=function(t){void 0===t&&(t=!0),(t||this._isShow)&&(this._isShow=!1,this.ani_cb_hd.stop(),this.ani_cb_zk.stop(),this.box_cb.visible=!1,this.ani_star.stop(),this.ani_star.visible=!1,this.ani_xx_xz.stop(),this.box_star.visible=!1,this.img_hg_bg.visible=!1,this.eff_guang.stop(),this.box_light_eff.visible=!1,this.ani_bg_sf.gotoAndStop(0),this.ani_bg_pd.gotoAndStop(0),Laya.timer.clearAll(this),this._callBack&&(this._callBack.recover(),this._callBack=null),this._titleparent&&this._titleparent.box_content&&(this._titleparent.box_content.visible=!0),this._titleparent=null)},n);function n(){var t=e.call(this)||this;return t._isShow=!1,t._isShowStar=!1,t._isShowLight=!1,t._step=0,t._cdTime=0,t.closeTitle(),t}t.CommonLevelUpTitleView=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.CommonFightTitleUI,__extends(n,e),n.prototype.showTitle=function(t,e,i,n,o,a,r,s){if(void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=!0),this.closeTitle(!1),this._isWin=t,this._isShowStar=i,this._isShowHg=n,this._isShowLight=o,this._callBack=a,this._titleparent=r,this._isShow=!0,this._isNoClose=s,r&&(this.bg.width=this._titleparent.width+40,this.bg.height=this._titleparent.height-this.bg.y,this._titleparent.box_content&&(this._titleparent.box_content.visible=!1)),s){var u=r||this.parent;u&&(u.isModelClose=!1)}this.img_title.skin=e,t?(this.img_dao_l.skin=this.img_dao_r.skin="zhandoubiaoxian/dao.png",this.img_hf.skin="comp/image/caidai.png",this.img_zs.skin="comp/image/zhuangshi.png",this.bg.skin="zhandoubiaoxian/hongsedi.png",n&&(this.img_hg_bg.skin="zhandoubiaoxian/di.png",this.img_hg.skin="zhandoubiaoxian/huangguan.png",this.img_hg.top=-94,this.img_hg.rotation=0)):(this.img_dao_l.skin=this.img_dao_r.skin="zhandoubiaoxian/dao2.png",this.img_hf.skin="zhandoubiaoxian/caidai2.png",this.img_zs.skin="zhandoubiaoxian/zhuangshi2.png",this.bg.skin="zhandoubiaoxian/lansedi.png",n&&(this.img_hg_bg.skin="zhandoubiaoxian/di2.png",this.img_hg.skin="zhandoubiaoxian/huangguan2.png",this.img_hg.top=-80,this.img_hg.rotation=18)),this._step=0,Laya.timer.loop(30,this,this.update)},n.prototype.update=function(){this._isWin?(this._cdTime-=30,this._cdTime<=0&&(0!=this._step||this.box_cb.visible?1!=this._step||this.img_hg_bg.visible?2<=this._step&&this.endUpdate():(this._step=2,this._isShowHg&&(this.img_hg_bg.visible=!0,this.img_hg.visible=!0,this.ani_hg_fd.play()),this._isShowLight&&(this.box_light_eff.visible=!0,this.eff_guang.play()),(this._isShowHg||this._isShowLight)&&(this._cdTime=200),this._titleparent&&this._titleparent.box_content&&(this._titleparent.box_content.visible=!0)):(this._step=1,this.box_cb.visible=!0,this.ani_cb_zk.play(0,!1),this.img_dao_l.visible=!0,this.img_dao_r.visible=!0,this.ani_dao.play(0,!1),this.ani_bg_sf.play(0,!1),this._isShowStar&&(this.ani_star.visible=!0,this.ani_star.play(0,!1)),this._cdTime=100)),0<this._step&&!this.ani_cb_zk.isPlaying&&this.ani_cb_hd.play(),this._isShowStar&&0<this._step&&!this.ani_star.isPlaying&&(this.box_star.visible=!0,this.ani_star.visible=!1,this.ani_xx_xz.play())):(this._cdTime-=30,this._cdTime<=0&&(0!=this._step||this.box_cb.visible?1!=this._step||this.img_hg_bg.visible?2<=this._step&&this.endUpdate():(this._step=2,this._isShowHg&&(this.img_hg_bg.visible=!0,this.img_hg.visible=!0,this.ani_hg_dx.play(0,!1),this._cdTime=200),this._titleparent&&this._titleparent.box_content&&(this._titleparent.box_content.visible=!0)):(this._step=1,this.box_cb.visible=!0,this.ani_cb_dx.play(0,!1),this.img_dao_l.visible=!0,this.img_dao_r.visible=!0,this.ani_dao.play(0,!1),this.ani_bg_sf.play(0,!1),this._cdTime=100)))},n.prototype.endUpdate=function(){if(this._isNoClose){var t=this._titleparent||this.parent;t&&(t.isModelClose=!0)}this._callBack&&(this._callBack.run(),this._callBack=null),Laya.timer.clear(this,this.update)},n.prototype.closeTitle=function(t){void 0===t&&(t=!0),(t||this._isShow)&&(this._isShow=!1,this.ani_cb_dx.stop(),this.ani_cb_hd.stop(),this.ani_cb_zk.stop(),this.box_cb.visible=!1,this.ani_star.stop(),this.ani_star.visible=!1,this.ani_xx_xz.stop(),this.box_star.visible=!1,this.ani_dao.stop(),this.img_dao_l.visible=!1,this.img_dao_r.visible=!1,this.ani_hg_dx.stop(),this.ani_hg_fd.stop(),this.img_hg_bg.visible=!1,this.img_hg.visible=!1,this.eff_guang.stop(),this.box_light_eff.visible=!1,this.ani_bg_sf.gotoAndStop(0),Laya.timer.clearAll(this),this._callBack&&(this._callBack.recover(),this._callBack=null),this._titleparent&&this._titleparent.box_content&&(this._titleparent.box_content.visible=!0),this._titleparent=null)},n);function n(){var t=e.call(this)||this;return t._isShow=!1,t._isWin=!1,t._isShowStar=!1,t._isShowHg=!1,t._isShowLight=!1,t._isNoClose=!1,t._step=0,t._cdTime=0,t.closeTitle(),t}t.CommonFightTitleView=i}(common=common||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=ui.component.BuyBattleCountUI,__extends(r,n),r.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.BuyBattleCount,closeOnSide:this.isModelClose,title:"购买次数"},this._counterBar=new t.CounterBar,this._counterBar.setComponent(this.btn_add,this.btn_addTen,this.btn_red,this.btn_redTen,this.are_putin)},r.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},r.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},r.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this),this.btnYes.off(Laya.Event.CLICK,this,this.buy),this.btnNot.off(Laya.Event.CLICK,this,this.close)},r.prototype.initView=function(){if(this.zOrder=UI_DEPATH_VALUE.TOP+2,this.btnYes.on(Laya.Event.CLICK,this,this.buy),this.btnNot.on(Laya.Event.CLICK,this,this.close),this._type=this.dataSource.type,this._callback=this.dataSource.callback,this._buymaxnum=this.getMaxNum(),this._buymaxnum<=0)return App.hero.vip>=tb.TB_vip.getMaxVip()?showToast(LanMgr.getLan("",10360)):(showToast(LanMgr.getLan("",10361)),dispatchEvt(new game.TopUpEvent(game.TopUpEvent.SHOW_CHONGZHI_PANEL),[1])),void this.close();this._buyNum=1,this._counterBar.setInitData(this._buyNum,this._buymaxnum,this.setBuySumMoney.bind(this)),this.setBuySumMoney(),this.lab_remain.text=LanMgr.getLan("（剩余购买次数：{0}次）",-1,this._buymaxnum)},r.prototype.setBuySumMoney=function(){this._buyNum=this._counterBar.getCurNum(),this.are_putin.text=this._buyNum.toString(),this._buysumMoney=this.getConsume(this._buyNum),this.lab_consume.text="X"+Snums(this._buysumMoney),this.lab_content0.text=LanMgr.getLan(this.getContent0(),-1,this._buysumMoney),this.lab_content1.text=LanMgr.getLan(this.getContent1(),-1,this._buyNum),this.img_gem.x=this.lab_content0.width+5,this.lab_content1.x=this.img_gem.x+this.img_gem.width+5},r.prototype.getContent0=function(){switch(this._type){case r.TYPE_ARENA:return"确定要花费{0}";default:return"是否花费{0}"}},r.prototype.getContent1=function(){switch(this._type){case r.TYPE_GODDOMAIN:case r.TYPE_ARENA:return"购买{0}次奖励次数";default:return"购买{0}次挑战次数"}},r.prototype.buy=function(){if(this._buysumMoney>App.hero.diamond)return showToast(LanMgr.getLan("",10005)),dispatchEvt(new game.TopUpEvent(game.TopUpEvent.SHOW_CHONGZHI_PANEL)),void this.close();this._callback&&this._callback(this._buyNum),this.close()},r.prototype.getMaxNum=function(){var t=0,e=0;switch(this._type){case r.TYPE_ARENA:t=iface.tb_prop.vipPrivilegeTypeKey.arenaBuyNum,e=iface.tb_prop.limitTypeKey.buyArenaNum;break;case r.TYPE_BOSS:e=iface.tb_prop.limitTypeKey.buyWorldBossNum,t=iface.tb_prop.vipPrivilegeTypeKey.worldBossNum;break;case r.TYPE_MATCH:e=iface.tb_prop.limitTypeKey.buyMatchNum,t=iface.tb_prop.vipPrivilegeTypeKey.matchBuyNum;break;case r.TYPE_GODDOMAIN:e=iface.tb_prop.limitTypeKey.buyGodDmRewardNum,t=iface.tb_prop.vipPrivilegeTypeKey.godDmRewardNum;break;case r.TYPE_GUILDCOPY:e=iface.tb_prop.limitTypeKey.buyGuildCopyNum,t=iface.tb_prop.vipPrivilegeTypeKey.guildCopyBuyNum;break;case r.TYPE_DAILYCOPY_ONE:e=iface.tb_prop.limitTypeKey.buyDailyCopyNum1,t=iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum;break;case r.TYPE_DAILYCOPY_TWO:e=iface.tb_prop.limitTypeKey.buyDailyCopyNum2,t=iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum;break;case r.TYPE_DAILYCOPY_THREE:e=iface.tb_prop.limitTypeKey.buyDailyCopyNum3,t=iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum;break;case r.TYPE_MINEROB:return tb.TB_island_set.getSet().buy_max-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyMineRobNum)}return App.hero.baseAddVipNum(t)-App.hero.getlimitValue(e)},r.prototype.getConsume=function(t){var e,i;switch(this._type){case r.TYPE_ARENA:var n=tb.TB_arena_new_set.getArenaNewSet(),o=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyArenaNum);return this.getLeiJI(t,o,n.buy_cost);case r.TYPE_BOSS:return tb.TB_boss_set.getSet().buy_cost*t;case r.TYPE_MATCH:return tb.TB_match_set.getSet().buy_cost*t;case r.TYPE_GODDOMAIN:return e=tb.TB_fight_goddomain_set.getSet().buy_cost,i=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyGodDmRewardNum),this.getLeiJI(t,i,e);case r.TYPE_GUILDCOPY:return e=tb.TB_guild_set.getSet().buy_cost,i=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyGuildCopyNum),this.getLeiJI(t,i,e);case r.TYPE_DAILYCOPY_ONE:case r.TYPE_DAILYCOPY_TWO:case r.TYPE_DAILYCOPY_THREE:e=tb.TB_copy_set.getCopySet().daily_copy_cost;var a=this._type==r.TYPE_DAILYCOPY_ONE?iface.tb_prop.limitTypeKey.buyDailyCopyNum1:this._type==r.TYPE_DAILYCOPY_TWO?iface.tb_prop.limitTypeKey.buyDailyCopyNum2:iface.tb_prop.limitTypeKey.buyDailyCopyNum3;return i=App.hero.getlimitValue(a),this.getLeiJI(t,i,e);case r.TYPE_MINEROB:return e=tb.TB_island_set.getSet().buy_cost,i=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyMineRobNum),this.getLeiJI(t,i,e)}return 0},r.prototype.getLeiJI=function(t,e,i){for(var n=0,o=0;o<t;o++)e+o>=i.length?n+=i[i.length-1]:n+=i[e+o];return n},r.TYPE_ARENA=0,r.TYPE_BOSS=1,r.TYPE_MATCH=2,r.TYPE_GODDOMAIN=3,r.TYPE_GUILDCOPY=4,r.TYPE_DAILYCOPY_ONE=5,r.TYPE_DAILYCOPY_TWO=6,r.TYPE_DAILYCOPY_THREE=7,r.TYPE_MINEROB=8,r);function r(){var t=n.call(this)||this;return t._buyNum=1,t._buymaxnum=0,t._buysumMoney=0,t._type=0,t._callback=null,t}t.BuyBattleCountView=e}(common=common||{});var common;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e;(e=i=t.ALERTTYPE||(t.ALERTTYPE={}))[e.WARN=0]="WARN",e[e.PROMPT=1]="PROMPT",e[e.NORMAL=2]="NORMAL",e[e.RECHARGE=3]="RECHARGE";var n,o=(n=ui.component.AlertBoxUI,__extends(a,n),a.getInstance=function(){return a._alertBox||(a._alertBox=new a),a._alertBox},a.close=function(){a.getInstance().close()},a.showAlert=function(t){t.type=i.NORMAL,t.yes=t.yes?t.yes:LanMgr.getLan("",10038),t.no=t.no?t.no:LanMgr.getLan("",10039),a.getInstance().showAlert(t)},a.showWarn=function(t){t.type=i.WARN,a.getInstance().showAlert(t)},a.showAlertYes=function(t,e){t.type=e?i.RECHARGE:i.NORMAL,t.yes=t.yes?t.yes:LanMgr.getLan("",10038),a.getInstance().showAlert(t)},a.showAlertPrompt=function(t){t.type=i.PROMPT,t.yes=t.yes?t.yes:LanMgr.getLan("",10038),t.no=t.no?t.no:LanMgr.getLan("",10039),t.isprompt=!0,a.getInstance().showAlert(t)},a.prototype.initHtmlText=function(){this._htmlText.style.color=ColorConst.normalFont,this._htmlText.style.wordWrap=!0,this._htmlText.mouseEnabled=!1,this._htmlText.style.align="center",this._htmlText.style.fontSize=22,this._htmlText.style.leading=15,this._htmlText.style.width=400,this.addChild(this._htmlText),this._htmlText.y=105.5,this._htmlText.x=100},a.prototype.showAlert=function(t){this.img_editbg.visible=t.type==i.PROMPT,this.img_editbg.visible&&(this.edit.prompt=t.text),this.isModelClose=t.type==i.NORMAL,this.popupCenter=!0,this.isModal=!0,this._confirmVo=t,this.popup(!1,!1),this.bgPanel&&this.bgPanel.updateTitle(t.title?t.title:LanMgr.getLan("",10536)),this.btnNot.on(Laya.Event.CLICK,this,this.onCancel),this.btnYes.on(Laya.Event.CLICK,this,this.onConfirm),this.btnYes.label=t.yes,this.btnNot.label=t.no,this.btnYes.visible=t.type==i.NORMAL||t.type==i.PROMPT,this._htmlText.style.fontSize=t.type==i.RECHARGE||t.type==i.WARN?28:22,this._htmlText.y=t.type==i.RECHARGE||t.type==i.WARN?165:105.5,this._htmlText.innerHTML=t.isprompt?"":t.text,t.type==i.RECHARGE?(this.timerOnce(3e3,this,this.autoClose),tl3d.ModuleEventManager.addEvent(game.TopUpEvent.SHOW_CHONGZHISUCC_PANEL,this.toClose,this)):this._htmlText.y=125.5-(this._htmlText.contextHeight-20)/2,t.no?(this.btnNot.visible=!0,this.btnYes.x=346,this.btnNot.x=110):(this.btnNot.visible=!1,this.btnYes.x=229)},a.prototype.autoClose=function(){showToast(LanMgr.getLan("",10358)),this.toClose()},a.prototype.onConfirm=function(){if(this._confirmVo.isprompt){var t=this.edit.text;if(!t&&t.length<=0)return void showToast(LanMgr.getLan("",10359))}this._confirmVo.confirmCb&&this._confirmVo.confirmCb(this._confirmVo.isprompt?this.edit.text:this._confirmVo.parm),this._confirmVo.confirmNotClose||this.toClose()},a.prototype.onCancel=function(){this._confirmVo.cancelCb&&this._confirmVo.cancelCb(this._confirmVo.parm),this.toClose()},a.prototype.toClose=function(){this.close(),tl3d.ModuleEventManager.removeEvent(game.TopUpEvent.SHOW_CHONGZHISUCC_PANEL,this.onClosed,this)},a.prototype.onClosed=function(){n.prototype.onClosed.call(this),this._confirmVo&&this._confirmVo.closeCb&&this._confirmVo.closeCb(),this._confirmVo=null,this.clearTimer(this,this.autoClose),this.btnNot.off(Laya.Event.CLICK,this,this.onCancel),this.btnYes.off(Laya.Event.CLICK,this,this.onConfirm)},a);function a(){var t=n.call(this)||this;return t._htmlText=new Laya.HTMLDivElement,t.initHtmlText(),t.name=UIConst.AlertBox,t.zOrder=UI_DEPATH_VALUE.ALERT,t.bgPanel&&(t.bgPanel.dataSource={uiName:UIConst.AlertBox,closeOnSide:t.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",10536)}),t}t.AlertBox=o}(common=common||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};var getTimeShortStr=function(t){return new Date(t).toTimeString()};function logdebug(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ExtConfig.LOG_LEVEL<3||console.log.apply(console,__spreadArrays([getTimeShortStr(Laya.timer.currTimer)],t))}function logNeed(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ExtConfig.LOG_LEVEL<1||console.log.apply(console,__spreadArrays([getTimeShortStr(Laya.timer.currTimer)],t))}function logwarn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ExtConfig.LOG_LEVEL<2||console.warn.apply(console,__spreadArrays([getTimeShortStr(Laya.timer.currTimer),"[W]"],t))}function logerror(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ExtConfig.LOG_LEVEL<1||console.error.apply(console,__spreadArrays([getTimeShortStr(Laya.timer.currTimer),"[E]"],t))}function logyhj(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!(ExtConfig.LOG_LEVEL<5)){var n=Date.now();console.log.apply(console,__spreadArrays(["%c [yhj]:"+n+" "+t,"color:#ff0000"],e))}}function logfight(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!(ExtConfig.LOG_LEVEL<999)){var n=getTimeShortStr(Laya.timer.currTimer);console.log.apply(console,__spreadArrays(["%c [fight]:"+n+" %c"+t,"color:#ff0000","color:#000000"],e))}}function logzhanbao(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!(ExtConfig.LOG_LEVEL<998)){var i=getTimeShortStr(Laya.timer.currTimer);console.log.apply(console,__spreadArrays(["%c [zhanbao]:"+i+" ","color:#ff0000"],t))}}function loghgy(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!(ExtConfig.LOG_LEVEL<6)){var i=getTimeShortStr(Laya.timer.currTimer);console.log.apply(console,__spreadArrays(["%c hgy:"+i+" ","color:#ff0000"],t))}}function showToast(t,e){void 0===e&&(e=ColorConst.WHITE),t&&""!=t&&ToastMgr.getInstance().arrTextPushBack({$text:t,color:e})}function dispatchEvt(t,e){void 0===e&&(e=null),t.data||(t.data=e),tl3d.ModuleEventManager.dispatchEvent(t)}function randomWord(t,e,i){var n="",o=e,a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];t&&(o=Math.round(Math.random()*(i-e))+e);for(var r=0;r<o;r++)n+=a[Math.round(Math.random()*(a.length-1))];return n}function num2ChiNum(t){return LanMgr.numChinese[t]}function Snums(t){if(1e8<=t){var e=LanMgr.getLan("",12086);return t%1e8==0?t/1e8+e:(t/1e8).toFixed(2)+e}if(1e4<=t){var i=LanMgr.getLan("",12087);return t%1e4==0?t/1e4+i:1e6<=t?Number((t/1e4).toFixed(0))+i:Number((t/1e4).toFixed(2))+i}return String(t)}function FormatStr(t,e){for(var i=0;i<e.length;i++){var n=new RegExp("\\{"+i+"\\}","g");t=t.replace(n,e[i])}return t}function isEmptyObject(t){var e;if(!t)return!0;for(e in t)return!1;return!0}function randomNum(t){for(var e="",i=0;i<t;i++)e+=Math.floor(10*Math.random());return e}function replaceall(t,e,i,n){for(var o=e.indexOf(i);0<=o;){var a=i.length,r=n.repeat(a);e=e.replace(i,r),t=t.substring(0,o)+r+t.substring(o+a),o=e.indexOf(i)}return t}function doShield1(t){var e=(t=t.replace(RegConst.EMPTY_ALL_REG,"")).toLowerCase(),i=TableData.getInstance().getTableByName(TableData.tb_shield);for(var n in i.data)t=replaceall(t,e,i.data[n].name,"*");return t}function perc2num(t){return Number(t)/100}function ext2num(t){return t/1e4}function buquan(t,e){var i=t.toString(),n=i.length;if(i.length>=e)return i;for(var o=0;o<e-n;o++)i="0"+i;return i}function generateUUID(){var i=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"==t?e:3&e|8).toString(16)})}function frame2time(t){return t&&0<t?Math.floor(1e3/30*t):0}function getEffectUrl(t){return"effect/scene/"+t+getBaseUrl()+".txt"}function StringToTime(t){var e=parseInt(t),i=0,n=0,o="00:00";return 0<=e&&(60<e&&(i=parseInt((e/60).toString()),e=parseInt((e%60).toString()),60<i&&(n=parseInt((i/60).toString()),i=parseInt((i%60).toString()))),o=e<10?"0"+parseInt(e.toString()):""+parseInt(e.toString()),o=i<10?"0"+parseInt(i.toString())+":"+o:parseInt(i.toString())+":"+o,0<n&&(o=n<10?"0"+parseInt(n.toString())+":"+o:parseInt(n.toString())+":"+o)),o}function GetTime(t){(t+="").length<12&&(t=1e3*parseInt(t)),t=parseInt(t);var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1;n=n<10?parseInt("0"+n):n;var o=e.getDay();o=o<10?parseInt("0"+o):o;var a=e.getHours();a=a<10?parseInt("0"+a):a;var r=e.getMinutes();r=r<10?parseInt("0"+r):r;var s=e.getSeconds();return i+"-"+n+"-"+o+"-"+a+"-"+r+"-"+(s=s<10?parseInt("0"+s):s)+"-"}function logindifference(t,e){var i=LanMgr.getLan("",12088),n=(e-t)/86400;return n<1?(n*=24,i=LanMgr.getLan("",12089),n<1&&(n*=60,i=LanMgr.getLan("",12090))):30<n&&(n=1,i=LanMgr.getLan("",12091)),~~n+i+LanMgr.getLan("",12092)}function activityTime(t,e){var i="",n=Math.floor(Math.abs(t-e)),o=0,a=0;return 86400<=n?(o=Math.floor(n/86400),a=Math.floor((n-86400*o)/3600),i+=o+LanMgr.getLan("",12088)+a+LanMgr.getLan("",12089)):3600<=n?(o=Math.floor(n/3600),a=Math.floor((n-3600*o)/60),i+=o+LanMgr.getLan("",12089)+a+LanMgr.getLan("",12090)):60<=n?(o=Math.floor(n/60),a=Math.floor(n-60*o),i+=o+LanMgr.getLan("",12090)+a+LanMgr.getLan("",12093)):i+=n+LanMgr.getLan("",12093),i}function duanweiValueToString(t){return["","I","II","III"][t]}function getDuanwei(t){var e=tb.TB_rank_score.get_TB_rank_score();for(var i in e.sort(function(t,e){return e.ID-t.ID}),e)if(t===e[i].ID)return Number(i);return 13}function getScoreByRank(t){var e=tb.TB_arena_rank.get_TB_arena_rank();for(var i in e)if(t>=e[i].rank[0]&&t<=e[i].rank[1])return e[i].need_value;return 1500}function listAtCenter(t,e,i,n,o){void 0===o&&(o=90),t.x=n<i?e+(i-n)*(o+t.spaceX)/2:e}function getSignAwardValue(t){var e=tb.TB_guild_sign.get_TB_guild_sign();for(var i in e.sort(function(t,e){return e.ID-t.ID}),e)if(t>=e[i].scope[0])return e[i].ID}function guildMemberChatSend(t){var e={};e[Protocol.chat_chat_send.args.channel]=iface.tb_prop.chatChannelTypeKey.guild,e[Protocol.chat_chat_send.args.type]=iface.tb_prop.chatTypeKey.text,e[Protocol.chat_chat_send.args.content]=t,PLC.request(Protocol.chat_chat_send,e,function(t,e){})}function getHonorReward(t){var e=tb.TB_rank_score.get_TB_rank_score();for(var i in e)if(e[i].ID==t)return e[i].victory_medal[0]}function getQueryString(t){if(window.wx)return null;if(!window.location||!window.location.search)return null;var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):null}function getMonthDays(t){var e=new Date(1e3*t);return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function getobjectFirstAttribute(t){for(var e in t)return e}function checkUserName(t){for(var e,i=1,n=t,o=/[a-z\d]/i,a=/[\u4e00-\u9fa5]/,r=0,s=0,u=n.length;s<u;s++)if(e=n.charAt(s),o.test(e))r+=1;else{if(!a.test(e)){i=3;break}r+=2}return{state:i,strlen:r}}function getNextMonthTime(t){var e=new Date(t),i=11==e.getMonth()?e.getFullYear()+1:e.getFullYear(),n=11==e.getMonth()?0:e.getMonth()+1;return new Date(i,n).getTime()}function isArrayFn(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function map2ary(t){var e=[];for(var i in t)e.push([Number(i),t[i]]);return e}function ary2map(t){if(t instanceof Array){for(var e={},i=0;i<t.length;i++)e[t[i][0]]=t[i][1];return e}}function ary2prop(t){for(var e=[],i=0;t&&i<t.length;i++)e.push(new ItemVo(t[i][0],t[i][1]));return e}function convertMapValueToArr(t,e){var i=[];for(var n in t){var o=t[n];e&&"function"==typeof e&&!e(o)||i.push(o)}return i}function clone(t){var e;switch(typeof t){case"undefined":break;case"string":e=t+"";break;case"number":e=+t;break;case"boolean":e=t;break;case"object":if(null===t)e=null;else if(t instanceof Array){e=[];for(var i=0,n=t.length;i<n;i++)e.push(clone(t[i]))}else for(var o in e={},t)e[o]=clone(t[o]);break;default:e=t}return e}function getDistance(t){var e=0;if(t&&2==t.length){var i=t[0].stageX-t[1].stageX,n=t[0].stageY-t[1].stageY;e=Math.sqrt(i*i+n*n)}return e}function getForce(t,e){for(var i=map2ary(t),n=0,o=tb.TB_game_set.get_TB_game_setById(1),a=0;a<i.length;a++){var r=i[a][0],s=i[a][1];n+=(s=r<=4?Math.floor(s):s)*o.selectAttrItem(r)}return n*=Number(o.quality_para[e-1]),Math.round(n)}function getLineupForce(t){for(var e=t[0],i=null,n=0,o=0;o<e.length;o++){var a=e[o];a&&(i=tb.TB_god.get_TB_godById(Number(a[0])),n+=getForce(a[3],i?i.quality:1))}return n}var AchievementTabType,TweenDirection,CostTypeKey,CopyConditionType,SysConditionType,NoticeParamType,EquipOperation,Artifact,TURNTABLE,UIUtil=function(){function l(){}return l.showRewardView=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=UI_DEPATH.TOP),t=t||{};var o=[];if(Array.isArray(t))o=t;else{if(t.hasOwnProperty("addResource"))for(var a in t.addResource)o.push(new ItemVo(parseInt(a),t.addResource[a]));if(t.hasOwnProperty("addTreasures"))for(var a in t.addTreasures){var r=t.addTreasures[a];o.push(new ItemVo(r.templateId,r.num))}if(t.hasOwnProperty("returnEquip"))for(var s in t.returnEquip)o.push(t.returnEquip[s]);if(t.hasOwnProperty("addBagItems"))for(var a in t.addBagItems)o.push(new ItemVo(parseInt(a),t.addBagItems[a]));if(t.hasOwnProperty("addEquips")){var u={};for(var h in t.addEquips){u[a=t.addEquips[h].templateId]=u[a]?u[a]+1:1}for(var h in u)o.push(new ItemVo(parseInt(h),u[h]))}if(t.hasOwnProperty("addTimeItems"))for(var h in t.addTimeItems){r=t.addTimeItems[h];o.push(new LimitItemVo(Number(h),r.limitTime,r.templateId,1))}if(t.hasOwnProperty("useGodItems"))for(var h in t.useGodItems)o.push(new ItemVo(parseInt(h),t.useGodItems[h]));if(t.hasOwnProperty("addGemstones")||t.hasOwnProperty("clientAddGemsByModifyNum")||t.hasOwnProperty("clientAddGemsByModifyGems")){var l=game.GemstoneUtils.getGemRewardItemList(t);0<l.length&&(o=o.concat.apply(o,l))}if(t.hasOwnProperty("clientAddItemVoList"))for(var c=0,p=t.clientAddItemVoList;c<p.length;c++){var d=p[c];o.push(d)}}if(0<o.length){var _={itemList:o,isPreview:i,zorder:n,callback:e};UIMgr.showUI(UIConst.CommonRewardView,_),o.some(function(t){return t&&t.id==common.GlobalData.XIANSHI_BX_700})&&!game.GuideManager.isExecuteGuide()&&Laya.timer.callLater(this,function(){UIMgr.showUI(UIConst.XianshiBaoxiangView,n)})}else e&&e(null)},l.getRewardItemVoList=function(t,e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!0),e){if(e.addResource)for(var o in e.addResource){(s=new ItemVo(parseInt(o),e.addResource[o],0,0,null,i)).startAction=n,t.push(s)}if(e.hasOwnProperty("addTreasures"))for(var a in e.addTreasures){var r=e.addTreasures[a];(s=new ItemVo(r.templateId,r.num)).startAction=n,t.push(s)}if(e.addBagItems)for(var a in e.addBagItems){(s=new ItemVo(parseInt(a),e.addBagItems[a],0,0,null,i)).startAction=n,t.push(s)}if(e.addEquips)for(var a in e.addEquips){var s;(s=new EquipItemVo(e.addEquips[a])).uuid=a,s.startAction=n,s.isFirst=i,t.push(s)}if(e.hasOwnProperty("addGemstones")||e.hasOwnProperty("clientAddGemsByModifyNum")||e.hasOwnProperty("clientAddGemsByModifyGems"))for(var u=0,h=game.GemstoneUtils.getGemRewardItemList(e);u<h.length;u++){(r=h[u]).startAction=n,r.isFirst=i,t.push(r)}}},l.isShowInfoBox=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=null);var o=UIMgr.getUIByName(UIConst.SkillTip);if(e||o&&o.timerOnce(),UIMgr.hasStage(UIConst.SkillTip)&&o)return o.dataSource=[t,i,n],void o.onOpened();UIMgr.showUI(UIConst.SkillTip,[t,i,n])},l.showTip=function(t,e){var i;if(void 0===e&&(e=null),t instanceof tb.TB_item)i=t;else{if(t instanceof tb.TB_god){var n=e&&e.degree?e.degree:1,o=e&&e.starLevel?e.starLevel:1;return void l.showGodTip(t.ID,{degree:n,starLevel:o})}if(t instanceof EquipItemVo)UIMgr.showUI(UIConst.EquipTip,t);else{if(t instanceof TreasureItemVo)return void game.TreasureTipsView.popupTip(t,null,!1);var a=t;i=tb.TB_item.get_TB_itemById(a.id)}}if(i)if(i.type==iface.tb_prop.itemTypeKey.god){n=e&&e.degree?e.degree:Number(i.icon[3]<=6?Number(i.icon[3]):6),o=e&&e.starLevel?e.starLevel:Number(i.icon[3]);l.showGodTip(i.defined[0],{degree:n,starLevel:o})}else if(i.type==iface.tb_prop.itemTypeKey.equip){var r=new EquipItemVo(i);UIMgr.showUI(UIConst.EquipTip,r)}else l.showItemTip(t)},l.showGodTip=function(t,e){var i=tb.TB_god.get_TB_godById(t),n=e&&e.degree?e.degree:0,o=e&&e.starLevel?e.starLevel:0,a=1;e.hasOwnProperty("level")&&(a=e.level);var r={templateId:i.ID,starLevel:o,level:a,skill:i.skill,degree:n},s=new GodItemVo(r);s.tab_god=i,dispatchEvt(new game.TujianEvent(game.TujianEvent.SHOW_GUAIWUXINXI_PANEL),s)},l.showItemTip=function(t){UIMgr.showUI(UIConst.ItemTip,t)},l.showRole=function(t,e,i){UIMgr.showUI(UIConst.ShowRole,[t,e,i])},l.upPowerEff=function(t,e,i){void 0===i&&(i=250);var n={posy:i,start:t,end:e};if(UIMgr.hasStage(UIConst.UpPower)){var o=UIMgr.getUIByName(UIConst.UpPower);o.dataSource=n,o.updateEff()}else UIMgr.showUI(UIConst.UpPower,n)},l.loop=function(t,e,i,n,o,a){var r,s,u=this,h=a==TweenDirection.up||a==TweenDirection.down;a==TweenDirection.up?s=i-o:a==TweenDirection.down?s=i+o:r=a==TweenDirection.left?e+o:e-o,Laya.Tween.to(t,{y:h?s:i,x:h?e:r},n,Laya.Ease.linearInOut,new Handler(this,function(){Laya.Tween.to(t,{y:h?a==TweenDirection.up?s+o:s-o:i,x:h?e:a==TweenDirection.right?r+o:r-o},n,Laya.Ease.linearInOut,new Handler(u,function(){l.loop(t,e,i,n,o,a)}))}))},l.checkNotEnough=function(t,e){return!App.isEnough(t,e)&&(t==iface.tb_prop.resTypeKey.gold?showToast(LanMgr.getLan("",Lans.glod)):t==iface.tb_prop.resTypeKey.diamond?showToast(LanMgr.getLan("",10073)):t==iface.tb_prop.resTypeKey.guildDonate?showToast(LanMgr.getLan("",10074)):t==CostTypeKey.treasure_rebirth?showToast(LanMgr.getLan("",Lans.cost,[CostTypeKey.treasure_rebirth])):showToast(LanMgr.getLan("",Lans.cost)),!0)},l.checkLimitEnough=function(t,e){var i=App.hero.getlimitValue(t);if(App.hero.baseAddVipNum(e)<=i){var n=App.getMaxVipLv();return App.hero.vip>=n?showToast(LanMgr.getLan("",10146)):showToast(LanMgr.getLan("",10082)),!1}return!0},l.checkUnableToEnterFight=function(t){return void 0===t&&(t=iface.tb_prop.lineupTypeKey.attack),game.GodUtils.getGodsNum()<=0?(dispatchEvt(new game.SummonEvent(game.SummonEvent.SHOW_ZHAOHUAN_PANEL)),showToast(LanMgr.getLan("",10017)),!0):!App.hero.hasLineUp(t)&&(dispatchEvt(new game.GodEvent(game.GodEvent.SHOW_BUZHEN_PANEL),t),showToast(LanMgr.getLan("",10204)),!0)},l.showCommonTipView=function(t){var e={content:t,width:620};if(UIMgr.hasStage(UIConst.CommonRuleView)){var i=UIMgr.getUIByName(UIConst.CommonRuleView);i.dataSource=e,i.initView()}else UIMgr.showUI(UIConst.CommonRuleView,e)},l.showJumpPanle=function(t){var e=tb.TB_item.get_TB_itemById(t);e&&0!=e.way_link.length&&UIMgr.showUI(UIConst.Equip_JumpView,t)},l.showJumpPanle2=function(t){var e=[];1==t&&(e=[[ModuleConst.SUMMON],[ModuleConst.SHENMEN]]),0<e.length&&UIMgr.showUI(UIConst.Equip_JumpView,e)},l.createHeadMask=function(t,e){if(!t||e<0)return null;var i=new Sprite;return i.width=2*e,i.height=2*e,i.graphics.drawCircle(e,e,e,"#ff000001"),i.visible=!1,t.mask=i,t.parent&&t.parent.addChild(i),i},l.showEquipLvupView=function(t,e){if(UIMgr.hasStage(UIConst.EquipLvupView)){var i=UIMgr.getUIByName(UIConst.EquipLvupView);i.dataSource=[t,e],i.show()}else UIMgr.showUI(UIConst.EquipLvupView,[t,e])},l.checkEquipSuitLvup=function(t,e){if(!(!e||e.length<2||e[1]<2)){t=t||[];var i=e[0],n=e[1];if(t.length<=1)UIMgr.showUI(UIConst.EquipSuitLvupView,e);else{var o=t[0],a=t[1];1<=n-a?UIMgr.showUI(UIConst.EquipSuitLvupView,e):o<i&&a<=n&&UIMgr.showUI(UIConst.EquipSuitLvupView,e)}}},l.showSysTopView=function(t){if(UIMgr.hasStage(UIConst.SysTopView)){var e=UIMgr.getUIByName(UIConst.SysTopView);e.dataSource=t,e.show()}else UIMgr.showUI(UIConst.SysTopView,t)},l.getRewardItemList=function(t){var e=[];if(Array.isArray(t))e=t;else{if(t.hasOwnProperty("addResource"))for(var i in t.addResource)e.push(new ItemVo(parseInt(i),t.addResource[i]));if(t.hasOwnProperty("addTreasures"))for(var i in t.addTreasures){var n=t.addTreasures[i];e.push(new ItemVo(n.templateId,n.num))}if(t.hasOwnProperty("returnEquip"))for(var o in t.returnEquip)e.push(t.returnEquip[o]);if(t.hasOwnProperty("addBagItems"))for(var i in t.addBagItems)e.push(new ItemVo(parseInt(i),t.addBagItems[i]));if(t.hasOwnProperty("addEquips")){var a={};for(var r in t.addEquips){a[i=t.addEquips[r].templateId]=a[i]?a[i]+1:1}for(var r in a)e.push(new ItemVo(parseInt(r),a[r]))}if(t.hasOwnProperty("addAccs")){var s={};for(var r in t.addAccs){s[i=t.addAccs[r].templateId]=s[i]?s[i]+1:1}for(var r in s)e.push(new ItemVo(parseInt(r),s[r]))}if(t.hasOwnProperty("addTimeItems"))for(var r in t.addTimeItems){n=t.addTimeItems[r];e.push(new LimitItemVo(Number(r),n.limitTime,n.templateId,1))}if(t.hasOwnProperty("useGodItems"))for(var r in t.useGodItems)e.push(new ItemVo(parseInt(r),t.useGodItems[r]))}return e},l.listTween=function(r,t){for(var s=r.cells,e=0,i=s;e<i.length;e++){var n=i[e];Laya.Tween.clearTween(n),n.x=-n.width}r.scrollBar&&(r.scrollBar.touchScrollEnable=!1);function o(t,e){var i=s[t];if(!r.getItem(t))return 1;i.mouseEnabled=!1;var n=Math.ceil(i.width/7),o=.31*(i.width+n),a=.4*o*t;Laya.Tween.to(i,{x:n},o,Laya.Ease.linearIn,new Handler(h,function(){i.mouseEnabled=!0;var t=.8*n;Laya.Tween.to(i,{x:0},t,Laya.Ease.linearIn)}),a),u+=o}for(var u=0,h=this,a=0,l=s.length;a<l;a++)o(a);Laya.timer.once(u,this,function(){r.scrollBar&&(r.scrollBar.touchScrollEnable=!0),t&&t()})},l.boxUpDownTween=function(t,e,i,n,o,a,r){var s=this;void 0===n&&(n=!1),void 0===o&&(o=310),void 0===a&&(a=.1),t.y=e;var u=n?i-Math.ceil(t.height*a):i+Math.ceil(t.height*a),h=.82*o,l=o-h;Laya.Tween.to(t,{y:u},h,Laya.Ease.linearIn,new Handler(this,function(){Laya.Tween.to(t,{y:i},l,Laya.Ease.linearIn,new Handler(s,function(){r&&r()}))}))},l.boxLeftRightTween=function(t,e,i,n,o,a){void 0===n&&(n=!1),void 0===o&&(o=310),void 0===a&&(a=.1),t.x=e;var r=n?i-Math.ceil(t.width*a):i+Math.ceil(t.width*a),s=.82*o,u=o-s;Laya.Tween.to(t,{x:r},s,Laya.Ease.linearIn,new Handler(this,function(){Laya.Tween.to(t,{x:i},u,Laya.Ease.linearIn)}))},l.boxScaleTween=function(t,e,i,n,o){void 0===n&&(n=310),void 0===o&&(o=.1),t.scale(e,e);var a=i+i*o,r=.82*n,s=n-r;Laya.Tween.to(t,{scaleX:a,scaleY:a},r,Laya.Ease.linearIn,new Handler(this,function(){Laya.Tween.to(t,{scaleX:i,scaleY:i},s,Laya.Ease.linearIn)}))},l.showPlayerLineupInfo=function(t,i){if(t&&""!=t){var e={};e[Protocol.center_query_queryPlayer.args.playerId]=t,PLC.request(Protocol.center_query_queryPlayer,e,function(r,t){if(r){var e={type:i,name:r.name,guildName:r.guildName,force:r.force,head:r.head,headFrame:r.headFrame,sex:r.sex,level:r.level,getLineupGods:function(){for(var t=[],e=0,i=r.lineupInfo[0];e<i.length;e++){var n=i[e];if(n){var o=tb.TB_god.get_TB_godById(n[0]),a=new GodItemVo(o);a.starLevel=n[1],a.level=n[2],a.degree=n[4],a.dataType=1,n[3]&&(a.iSeverAttri=map2ary(n[3])),t.push(a)}else t.push(null)}return t},getShenqiAry:function(){return r.lineupInfo[1]}};UIMgr.showUI(UIConst.PlayerLineupInfoView,e)}})}},l.showMatchLineupInfo=function(i,n){if(i&&i.playerId){var t={};t[Protocol.center_match_observePlayer.args.obPlayerId]=i.playerId,PLC.request(Protocol.center_match_observePlayer,t,function(r,t){if(r){var e={type:n,name:i.name,guildName:i.guildName,force:getLineupForce(r.defInfo),head:i.head,headFrame:i.headFrame,sex:i.head,level:i.level,getLineupGods:function(){for(var t=[],e=0,i=r.defInfo[0];e<i.length;e++){var n=i[e];if(n){var o=tb.TB_god.get_TB_godById(n[0]),a=new GodItemVo(o);a.starLevel=n[1],a.level=n[2],a.dataType=1,n[3]&&(a.iSeverAttri=map2ary(n[3])),t.push(a)}else t.push(null)}return t},getShenqiAry:function(){return r.defInfo[1]}};UIMgr.showUI(UIConst.PlayerLineupInfoView,e)}})}},l.payDebug=function(t,i,n){void 0===i&&(i=null),void 0===n&&(n=null),i=i||{text:LanMgr.getLan("",10537)};var e={};e[Protocol.game_gm_command.args.content]="@充值 "+t,PLC.request(Protocol.game_gm_command,e,function(t,e){t&&(common.AlertBox.showAlertYes(i,!0),n&&n())})},l.showVipupPanel=function(t){if(t&&0<Object.keys(t).length){var e={};for(var i in t)e[i]=t[i];t=null,UIMgr.showUI(UIConst.VipLvUpView,e)}},l.saveVipupData=function(t,e){var i=game.HudModel.getTbVipByScore(t),n=game.HudModel.getTbVipByScore(e);if(n&&(!i||n.ID>i.ID)){var o={};o.oldVip=i?i.ID:0,o.newVip=n.ID,o.oldScore=t,o.newScore=e,l.vipData=o}},l.popEffectByLeft=function(t,e,i,n){return void 0===n&&(n=200),new Handler(this,function(){t.x=e,t.alpha=.3,Laya.Tween.to(t,{x:i,alpha:1},n,Laya.Ease.linearIn)})},l.closeEffectByLeft=function(t,e,i,n){return void 0===n&&(n=200),new Handler(this,function(){t.x=e,Laya.Tween.to(t,{x:i,alpha:.3},n,Laya.Ease.linearIn)})},l.playListEff=function(t){if(t){this.clearListEff(t);for(var e=0;e<t.length;e++){var i=t[e],n=i.y;i.y=n+900;var o=50*e;Laya.timer.once(o,i,this.onItemComplete,[i,n])}}},l.onItemComplete=function(t,e){Laya.Tween.to(t,{y:e},300)},l.clearListEff=function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e];Laya.timer.clear(i,this.onItemComplete),Laya.Tween.clearAll(i)}},l}(),UIConst=function(){function t(){}return t.hud_group="hud",t.two_group="two",t.team_two_group="team_two_group",t.login_group="login",t.HudView="HudView",t.SelectListView="SelectListView",t.LoginView="LoginView",t.Main3DView="Main3DView",t.ChatView="ChatView",t.XianshiBaoxiangView="XianshiBaoxiangView",t.SysTopView="SysTopView",t.ShowSkill="ShowSkill",t.PlayerDetailsView="PlayerDetailsView",t.HeroicModelView="HeroicModelView",t.CheatView="CheatView",t.Hud_ChangeNameView="Hud_ChangeNameView",t.Chat_SiliaoView="Chat_SiliaoView",t.CommonRewardView="CommonRewardView",t.GuideTalkView="GuideTalkView",t.GuideMask="GuideMask",t.CommonRuleView="CommonRuleView",t.CommonItemBuyView="CommonItemBuyView",t.PlayerInfoView="PlayerInfoView",t.ComsumeAlert="ComsumeAlert",t.AlertBox="AlertBox",t.ExchangeGoldView="ExchangeGoldView",t.PlayerLineupInfoView="PlayerLineupInfoView",t.FightViews="FightViews",t.FightResultView="FightResultView",t.FightActivityResultView="FightActivityResultView",t.FightGuildCopyResultView="FightGuildCopyResultView",t.FightFailure="FightFailure",t.FightVictory="FightVictory",t.FightVictoryQc="FightVictoryQc",t.FirstGuide="FirstGuide",t.FightTishiView="FightTishiView",t.GloryFightResultView="GloryFightResultView",t.GuajiView="GuajiView",t.GuanqiaView="GuanqiaView",t.OpenChapterView="OpenChapterView",t.Guaji_FastView="Guaji_FastView",t.Guaji_ShouyiUpView="Guaji_ShouyiUpView",t.Guaji_ShouyiView="Guaji_ShouyiView",t.GodDoorView="GodDoorView",t.GodDoor_JiangliView="GodDoor_JiangliView",t.ZH_ResultView="ZH_ResultView",t.ZH_MainView="ZH_MainView",t.God_MainView="God_MainView",t.BuzhenView="BuzhenView",t.God_kezhiView="God_kezhiView",t.XuanzeView="XuanzeView",t.SkillupView="SkillupView",t.GodUpStarView="GodUpStarView",t.GodUpLevelView="GodUpLevelView",t.God_DgUpView="God_DgUpView",t.God_DgUp_SUCCView="God_DgUp_SUCCView",t.God_AttrView="God_AttrView",t.God_fuseView="God_fuseView",t.God_TupoView="God_TupoView",t.God_ChooseGodView="God_ChooseGodView",t.God_ReplaceGodView="God_ReplaceGodView",t.God_GodCultureView="God_GodCultureView",t.GodSkinView="GodSkinView",t.GodLiHuiView="GodLiHuiView",t.UserNoticeView="UserNoticeView",t.ChooseTreasureView="ChooseTreasureView",t.TreasureStrengthView="TreasureStrengthView",t.TreasureStarupView="TreasureStarupView",t.TreasureTipsView="TreasureTipsView",t.ChooseTreasureMaterialView="ChooseTreasureMaterialView",t.TreasureStarAttrPreview="TreasureStarAttrPreview",t.TreasureTujianView="TreasureTujianView",t.TreasureRebirthView="TreasureRebirthView",t.LoginGiftView="LoginGiftView",t.TestRebateView="TestRebateView",t.PromptToast="PromptToast",t.ItemTip="ItemTip",t.SkillTip="SkillTip",t.EffectList="EffectList",t.ManyItemsTip="ManyItemsTip",t.EquipTip="EquipTip",t.XuyuanView="XuyuanView",t.TishiView="TishiView",t.TujianView="TujianView",t.Tujian_PingjiaShuruView="Tujian_PingjiaShuruView",t.TujianHeroView="TujianHeroView",t.Tujian_AttrView="Tujian_AttrView",t.TaskView="TaskView",t.ChallengeDetailView="ChallengeDetailView",t.WarriorBuyLevelView="WarriorBuyLevelView",t.WarriorJinjieView="WarriorJinjieView",t.MailView="MailView",t.MailReadView="MailReadView",t.ShopView="ShopView",t.Shop_RefreshView="Shop_RefreshView",t.Shop_BuyView="Shop_BuyView",t.Tujian_PingjiaView="Tujian_PingjiaView",t.GuaiwuxinxiView="GuaiwuxinxiView",t.WordMap="WordMap",t.FuwenBagView="FuwenBagView",t.FuwenBagDetails="FuwenBagDetails",t.Friend_MainView="Friend_MainView",t.FuwenStrength="FuwenStrength",t.BagView="BagView",t.ItemDetailView="ItemDetailView",t.Bag_UseView="Bag_UseView",t.Bag_RecycleView="Bag_RecycleView",t.ShowRole="ShowRole",t.ShiliantaView="ShiliantaView",t.SLT_GuanqiaView="SLT_GuanqiaView",t.SLT_JiangliView="SLT_JiangliView",t.SLT_RankView="SLT_RankView",t.TanxianView="TanxianView",t.GuildinitView="GuildinitView",t.GuildApplyListView="GuildApplyListView",t.CreateGuildView="CreateGuildView",t.GuildInfoView="GuildInfo",t.GuildNoticeView="GuildNoticeView",t.GuildSetUpView="GuildSetUpView",t.GuildMainView="GuildMainView",t.GuildDonationView="GuildDonationView",t.GuildCopyView="GuildCopyView",t.DamageRankView="DamageRankView",t.AtkEndRankView="AtkEndRankView",t.GuildNumBuyView="GuildNumBuyView",t.JishaJiangliView="JishaJiangliView",t.TongguanJiangliView="TongguanJiangliView",t.IconChangeView="IconChangeView",t.GuildSkillView="GuildSkillView",t.GuildCopySweepResultView="GuildCopySweepResultView",t.GuildHelpView="GuildHelpView",t.GuildAskHelpView="GuildAskHelpView",t.GuildMemberSetView="GuildMemberSetView",t.FightMainView="FightMainView",t.FightWaitView="FightWaitView",t.GroupRankView="GroupRankView",t.PersonRankView="PersonRankView",t.SeasonAwardView="SeasonAwardView",t.HonorHallView="HonorHallView",t.GradeChestView="GradeChestView",t.GloryFightView="GloryFightView",t.GloryLastReview="GloryLastReview",t.GloryWaitView="GloryWaitView",t.GloryRewardView="GloryRewardView",t.GloryRecordView="GloryRecordView",t.GloryGroupView="GloryGroupView",t.LevelUpView="LevelUpView",t.HechengView="HechengView",t.TupUp_FirstView="TupUp_FirstView",t.ShouchongtishiView="ShouchongtishiView",t.WelfareView="WelfareView",t.PayActivityView="PayActivityView",t.RealNameView="RealNameView",t.LuckyTurnView="LuckyTurnView",t.TurnRewardView="TurnRewardView",t.LuckRecordView="LuckRecordView",t.ChongzhiView="ChongzhiView",t.DafuwengView="DafuwengView",t.DFW_QiyuView="DFW_QiyuView",t.DFW_QiyuResultView="DFW_QiyuResultView",t.Lilian_RewardView="Lilian_RewardView",t.CreateRoleView="CreateRoleView",t.WorldBoss_BossView="WorldBoss_BossView",t.WorldBoss_RankView="WorldBoss_RankView",t.WorldBoss_RewardView="WorldBoss_RewardView",t.Copy_TeamMainView="Copy_TeamMainView",t.CopyTeamBattleInfo="CopyTeamBattleInfo",t.CopyTeamBuild="CopyTeamBuild",t.CopyTeamInfo="CopyTeamInfo",t.CopyTeamApply="CopyTeamApply",t.CopyTeamRewardView="CopyTeamRewardView",t.CopyTeamInvite="CopyTeamInvite",t.CopyTeamInviteJoinView="CopyTeamInviteJoinView",t.CopyTeamTransfer="CopyTeamTransfer",t.CopyTeamFightStart="CopyTeamFightStart",t.CopyTeamRank="CopyTeamRank",t.Copy_DailyView="Copy_DailyView",t.Copy_DailyMainView="Copy_DailyMainView",t.Copy_DailyBuyView="Copy_DailyBuyView",t.YuanzhengView="YuanzhengView",t.Yuanzheng_RecoveryView="Yuanzheng_RecoveryView",t.Yuanzheng_RewardView="Yuanzheng_RewardView",t.Yuanzheng_ChallengeView="Yuanzheng_ChallengeView",t.Yuanzheng_HelpView="Yuanzheng_HelpView",t.EscortMainView="EscortMainView",t.CaravanInfoView="CaravanInfoView",t.EscortView="EscortView",t.RobbedRecordView="RobbedRecordView",t.EscortRewardView="EscortRewardView",t.FogForestView="FogForestView",t.FogForestRewardView="FogForestRewardView",t.IslandView="IslandView",t.OreMapView="OreMapView",t.EmptyOreView="EmptyOreView",t.PlayerOreView="PlayerOreView",t.OreExplainView="OreExplainView",t.OreSettlementView="OreSettlementView",t.SelfOreView="SelfOreView",t.GuajiDefeated="GuajiDefeated",t.GuajiVictory="GuajiVictory",t.EquipChangeView="EquipChangeView",t.EquipView="EquipView",t.EquipLvupView="EquipLvupView",t.EquipSuitLvupView="EquipSuitLvupView",t.Equip_JumpView="Equip_JumpView",t.Equip_Refine="Equip_Refine",t.Equip_StrengthView="Equip_StrengthView",t.Equip_Recycle="Equip_Recycle",t.Equip_MasterView="Equip_MasterView",t.Equip_SuitView="Equip_SuitView",t.TimeLimitView="TimeLimitView",t.ExchangeItemView="ExchangeItemView",t.WeekFundView="WeekFundView",t.RankView="RankView",t.RankTabView="RankTabView",t.LoginNoticeView="LoginNoticeView",t.RatingFundView="RatingFundView",t.Artifact_UnLockView="Artifact_UnLockView",t.Artifact_BaptizeTip="Artifact_BaptizeTip",t.Artifact_EnchantTip="Artifact_EnchantTip",t.Artifact_ObtainTip="Artifact_ObtainTip",t.Artifact_WearView="Artifact_WearView",t.SevendaysView="SevendaysView",t.ArtifactView="ArtifactView",t.ArtifactListView="ArtifactListView",t.Topup_SuccView="Topup_SuccView",t.Topup_GiftSuccView="Topup_GiftSuccView",t.Topup_ScoreView="Topup_ScoreView",t.ChatNoticeEffect="ChatNoticeEffect",t.FenjieView="FenjieView",t.StoreView="StoreView",t.UpPower="UpPower",t.VipLvUpView="VipLvUpView",t.FirstShare="FirstShare",t.MainShare="MainShare",t.BindPhone="BindPhone",t.OnLineReward="OnLineReward",t.OpenReward="OpenReward",t.PowerRank="PowerRank",t.Pow_List="Pow_List",t.LimiteBuyView="LimiteBuyView",t.Lim_JiangLiView="Lim_JiangLiView",t.WeiDuanXiaZaiView="WeiDuanXiaZaiView",t.SuperVipView="SuperVipView",t.TuijianView="TuijianView",t.ArenaView="ArenaView",t.ArenaRankView="ArenaRankView",t.ArenaFailView="ArenaFailView",t.ArenaSuccView="ArenaSuccView",t.ArenaResultView="ArenaResultView",t.ArenaRecordView="ArenaRecordView",t.ArenaTopRankView="Arena_HistoryMaxView",t.ArenaMatchView="ArenaMatchView",t.MatchRewardView="MatchRewardView",t.MatchRankView="MatchRankView",t.MatchResultView="MatchResultView",t.GodDomainView="GodDomainView",t.GodDm_AutoMatchView="GodDm_AutoMatchView",t.GodDm_TeamView="GodDm_TeamView",t.GodDm_TeamListView="GodDm_TeamListView",t.GodDm_InviteView="GodDm_InviteView",t.GodDm_TeamMatchView="GodDm_TeamMatchView",t.GodDm_BattleResultView="GodDm_BattleResultView",t.GodDm_BattleSettlementView="GodDm_BattleSettlementView",t.GodDm_InviteJoinView="GodDm_InviteJoinView",t.GodDm_RankView="GodDm_RankView",t.BianQiangView="BianQiangView",t.ShouYiXiangQingView="ShouYiXiangQingView",t.EntranceList="EntranceList",t.EntranceList_lilian="EntranceList_lilian",t.EntranceList_jingji="EntranceList_jingji",t.EntranceList_kaufu="EntranceList_kuafu",t.General_FightStart="General_FightStart",t.GodDomain_FightStart="GodDomain_FightStart",t.BuyBattleCount="BuyBattleCount",t.OpenServerGift="OpenServerGift",t.RewardSelectView="RewardSelectView",t.GameNoticeView="GameNoticeView",t.UpRoadView="UpRoadView",t.UpRoadSuccessView="UpRoadSuccessView",t.ShowRewardItem="ShowRewardItem",t.GuanQiaNewView="GuanQiaNewView",t.GuanQiaInfoView="GuanQiaInfoView",t.GemstoneReplaceView="GemstoneReplaceView",t.GemstoneCompoundView="GemstoneCompoundView",t.SingleCompoundView="SingleCompoundView",t.GemstoneTipsView="GemstoneTipsView",t}(),ToastMgr=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(){function t(){this._arrText=new Array}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.arrTextPushBack=function(t){var e=0==this._arrText.length;this._arrText.push(t),e&&this.isArrText()},t.prototype.isArrText=function(){if(0!=this._arrText.length){var t=this._arrText[0];this.createToastWithData(t.$text,t.color)}},t.prototype.arrTextPop=function(){this._arrText.shift(),this.isArrText()},t.prototype.createToastWithData=function(t,e){var i=Laya.Pool.getItemByClass("toast",ToastView);i.init(t,e),Laya.stage.addChild(i),Laya.timer.once(300,this,this.arrTextPop),Laya.Tween.to(i,{y:i.y-200},1e3,null,Handler.create(this,function(){Laya.Pool.recover("toast",i),Laya.stage.removeChild(i)}))},t}()),ToastView=function(e){function t(){var t=e.call(this)||this;return t.zOrder=9999,t}return __extends(t,e),t.prototype.init=function(t,e){this.lab_text&&(this.alpha=1,this.lab_text.text=t,this.lab_text.color=e,this.x=Laya.stage.width/2,this.y=.75*Laya.stage.height)},t}(ui.component.ToastViewUI),SkinUtil=function(){function n(){}return n.getHeroIcon=function(t){isNaN(Number(t))||(t=Number(t));var e=n.getHeadIcon(common.GlobalData.DEFAULT_HEAD);if(0<t){var i=tb.TB_god.get_TB_godById(t);return i||(i=tb.TB_monster.get_TB_monsterById(t))?n.getHeadIcon(i.icon):e}return"string"==typeof t&&""!=t?t:e},n.getHeadFrame=function(t){return"hud/headFrame"+t+".png"},n.getLvFrame=function(t){return"hud/headFrameLv"+t+".png"},n.getAttrSkin=function(t){return"comp/image/attr"+t+".png"},n.getTeamPos=function(t){return"zudui/"+t+".png"},n.getChuzhanIcon=function(t){return 0==t?n.izsy_di13:n.izsy_di14},n.getExchangeConsume=function(t){switch(t){case 302:return"comp/image/molishuijing.png";case 303:case 309:return"comp/image/yijiesuzhi.png";case 304:case 310:return"comp/image/yuanguhupo.png";default:return""}},n.getCostSkin=function(t){var e=iface.tb_prop.resTypeKey;return t==e.diamond?"hud/zuanshi.png":t==e.arena?"comp/image/rongyu.png":t==e.gold?"hud/jingbi.png":t==e.friend?"comp/image/youqing.png":t==e.guildDonate?"comp/image/gongxian.png":t==e.soulStone?"comp/image/linghunshi.png":t==e.godCrystal?"comp/image/jiejing.png":t==e.darkEssence?"comp/image/heianjinghua.png":t==e.convertDust?"comp/image/xingchen.png":t==e.godExp?"hud/hunshi.png":t==e.roleExp?"hud/exp.png":t==e.arenaNum?"comp/image/tiaozhan.png":t==e.honour?"comp/image/rongyaobi.png":t==e.godDomain?"comp/image/shenyubi.png":t==CostTypeKey.huifu_yaoshui?"comp/image/xueping.png":t==CostTypeKey.fuhuo_yaoshui?"comp/image/fuhuoyaoshui.png":t==CostTypeKey.qianghuashi?"comp/image/qianghuashi.png":t==CostTypeKey.jinhuahuizhang?"comp/image/jinhuahuizhang.png":t==CostTypeKey.weizhi_zhaohuanshu?"comp/image/daojuquan.png":t==CostTypeKey.shenmi_zhaohuanshu?"comp/image/danchou.png":t==iface.tb_prop.resTypeKey.legendChip?"comp/image/chuanshuosuipian.png":t==CostTypeKey.escort_shuaxin?"comp/image/icon_husongshuaxinka.png":t==CostTypeKey.escort_husong?"comp/image/icon_gaojihusongka.png":t==CostTypeKey.risk_updatecard?"comp/image/icon_tanxianshuaxinka.png":t==CostTypeKey.xingmangshi?"comp/image/xincheng.png":t==CostTypeKey.longgang?"comp/image/gang.png":t==CostTypeKey.shenjiemiyao?"comp/image/yaoshi.png":t==CostTypeKey.jinglianshi?"comp/image/jinglianshi_1.png":t==CostTypeKey.mofajinghua_u?"comp/image/shangjimofajinghua.png":t==CostTypeKey.mofajinghua_m?"comp/image/zhongjimofajinghua.png":t==CostTypeKey.mofajinghua_l?"comp/image/xiajimofajinghua.png":t==CostTypeKey.shenlijinghua_u?"comp/image/shangjishenlijinghua.png":t==CostTypeKey.shenlijinghua_m?"comp/image/zhongjishenlijinghua.png":t==CostTypeKey.shenlijinghua_l?"comp/image/xiajishenlijinghua.png":t==CostTypeKey.treasure_rebirth?"comp/image/baowuchongshengshi.png":t==CostTypeKey.touzi?"comp/image/touzi.png":t==CostTypeKey.warrior_prove?"comp/image/warrior_coin.png":""},n.getBossIcon=function(t){return"guaji/guaji_boss0"+t+".png"},n.getTabBtnSkin=function(t){return"fbutton/"+t+".png"},n.getSysOpenSkin=function(t){return"icon/notice/"+t+".png"},n.getLiHuiIcon=function(t){return"icon/lihui/"+t+".png"},n.getArenaRankBg=function(t){return(t<1||5<t)&&(t=5),"jingjichang/jjc_0"+t+".png"},n.getUpOrDownSkinUrl=function(t){switch(t){case 1:return"comp/image/tishen_icon.png";case-1:return"comp/image/xiajiang_icon.png";default:return""}},n.getRankingSkin=function(t){return t<3?"comp/flag/rank"+(t+1)+".png":""},n.getStrengthSkin=function(){return"comp/image/qianghuashi.png"},n.getRefineSkin=function(){return"comp/image/jinglianshi_1.png"},n.getGodStarTypeSkin=function(t){return"comp/flag/chenwei_"+t+".png"},n.getBoxQulityIcon=function(t){return"comp/image/item_"+(t=t||"1")+".png"},n.getEscortQulityIcon=function(t){return"husong/img_quality_"+t+".png"},n.getRefineIcon=function(t){return"comp/image/jinglianshi_"+t+".png"},n.getHeadIcon=function(t){return"icon/head/"+t+".jpg"},n.getBuffIcon=function(t){return"icon/buff/"+t+".jpg"},n.getArtifactIcon=function(t){return"chuandaishenqi/artifact_"+t+".png"},n.getArtifCircleIcon=function(t){return"shenqi/"+t+".png"},n.getEquipIcon=function(t){return"icon/item/"+t+".jpg"},n.getAccsIcon=function(t){return"icon/item/"+t+".jpg"},n.getItemIcon=function(t){var e="icon/item/"+t.icon[0]+".jpg";switch(t.type){case iface.tb_prop.itemTypeKey.god:return n.getHeadIcon(t.icon[0]);case iface.tb_prop.itemTypeKey.chip:return t.ID<2e4&&1e4<t.ID?n.getHeadIcon(t.icon[0]):"icon/item/"+t.icon[0]+".jpg";case iface.tb_prop.itemTypeKey.materials:return 2==t.icon[1]?n.getHeadIcon(t.icon[0]):e}return e},n.getSkillIcon=function(t){return"icon/skill/"+t+".jpg"},n.getFuwenType=function(t){return"bag/fuwenbeibao/"+t+".png"},n.getFuwenBg=function(t){return"fuwen/fuben_ditu_"+t+".png"},n.getFuwenZhangjieIcon=function(t){return"fuwen/"+t+".png"},n.getFuwenLvIcon=function(t){return"fuwen/lv"+t+".png"},n.getGuajiGuaqiaBtn=function(t){return 0==t?"guaji/guanji_10.png":1==t?"comp/button/btn_guaji_2.png":2==t?"comp/button/btn_guaji_3.png":void 0},n.getLockStateSkin=function(t){return t?"comp/image/suo_yikaiqi.png":"comp/image/suo_weikaiqi.png"},n.getAddOrDec=function(t){return t?"comp/shuzi/zhanli_jia.png":"comp/shuzi/zhanli_jian.png"},n.getclipNum=function(t){return t?"comp/shuzi/zhanli_lv_num.png":"comp/shuzi/zhanli_hong_num.png"},n.getExpressionUrl=function(t){return t<game.ChatModel.ExpressionNum?"chat/face/img_chat_"+t+".png":null},n.getFirstRechargeName=function(t){return 1==t||3==t?"shouchong/shouchonglibao0"+t+"_1.jpg.png":""},n.getShiliantaRankUrl=function(t){return"shilianta/paiming/"+t+".png"},n.getDixiachengUrl=function(t){return"dixiachengfuben/btn_fuben_"+t+".png"},n.getPageStateUrl=function(t){return"shilianta/tower_cengshu"+t+".png"},n.getGuankaStateUrl=function(t){return"shilianta/tower_btn_guanqia"+t+".png"},n.getMailStateUrl=function(t){return"mail/mail_xinfeng"+t+".png"},n.getSancanUrl=function(t){return"huoyuehuodong/acitivty1/taocan"+t+".png"},n.getZuanshiUrl=function(t){return 328==t||648==t?"gonghui/donation/zuanshi_"+t+".png":"chongzhitequan/zuanshi_"+t+".png"},n.getChongzhiUrl=function(t){return"chongzhitequan/"+t+".png"},n.getRankSkin=function(t){return 1==t?"comp/flag/jin.png":2==t?"comp/flag/yin.png":"comp/flag/tong.png"},n.getDamageRankUrl=function(t){return 3<t?"":"comp/flag/rank"+t+".png"},n.getGodRaceSkin=function(t){return LanMgr.getLan("comp/image/race_{0}.png",-1,t)},n.getGodBigRaceSkin=function(t){return LanMgr.getLan("comp/image/race_big_{0}.png",-1,t)},n.getMonsterCircleIcon=function(t){return"icon/head/"+t+"_1.jpg"},n.getAutoFight=function(t){return t?"comp/button/btn_zidongzhandou.png":"comp/button/btn_shoudongzhandou.png"},n.getRonghunHave=function(t){switch(t){case CostTypeKey.hun_life:return"comp/image/shengming.png";case CostTypeKey.hun_attack:return"comp/image/gongji.png";case CostTypeKey.hun_defense:return"comp/image/fangyu.png"}return""},n.getGuildRankIcon=function(t){switch(t){case 1:return"comp/image/di1.png";case 2:return"comp/image/di2.png";case 3:return"comp/image/di3.png"}},n.getGuildHeadIcon=function(t){return"icon/guildhead/"+t},n.getGuildHeadIconById=function(t){return"icon/guildhead/guildhead"+(t=0<=t?t:0)+".png"},n.getGuildSkillIcon=function(t,e){return"icon/guildskill/jineng"+t+"_"+{1:"huaxia",2:"beiou",3:"xila",4:"guangming",5:"heian"}[e]+".png"},n.getGuildSkillSelectedIcon=function(t){return"gonghui/xuanzhongguangxiao_"+{1:"xila",2:"huaxia",3:"beiou",4:"guangming",5:"heian"}[t]+".png"},n.getIslandOreUrl=function(t){return"shenmidaoyu/daoyu_kuang"+t+".png"},n.getGuildUpGradeUrl=function(t){return t==game.GuildUpGradeType.up?"gonghui/fight/jinjiqu.png":t==game.GuildUpGradeType.keep?"gonghui/fight/baojiqu.png":t==game.GuildUpGradeType.down?"gonghui/fight/jiangjiqu.png":""},n.getGuildGradeBg=function(t){return t==game.GuildGrade.baiyin?"gonghui/fight/baiyindi.png":t==game.GuildGrade.bojin?"comp/image/bojindi.png":t==game.GuildGrade.wangzhe?"gonghui/fight/wangzhedi.png":""},n.getGuildQizhi=function(t){return"gonghui/fight/pic_qizhi"+t+".png"},n.getGuildXuwei=function(t){return"gonghui/fight/pic_xuwei"+t+".png"},n.getZhaohuanIcon=function(t){switch(t){case game.ZHAOHUAN.GENERAL:return"zhaohuan/pt.png";case game.ZHAOHUAN.FRIENDSHIP:return"zhaohuan/yq.png";case game.ZHAOHUAN.DIAMOND:return"zhaohuan/sm.png";case game.ZHAOHUAN.LEGEND:return"zhaohuan/cs.png"}return""},n.getServerState=function(t){var e="comp/image/weihu.png";return t.status==REALMFLAG.REALM_FLAG_RUNNING&&(e=t.style_status==SrvState.NORNAL?"comp/image/kongxian.png":t.style_status==SrvState.BETTER?"comp/image/renao.png":"comp/image/baoman.png"),e},n.getDonationImgUrl=function(t){return 1==t?"gonghui/donation/jinbi_box.png":2==t?"gonghui/donation/zuanshi_328.png":"gonghui/donation/zuanshi_648.png"},n.getBigIconById=function(t){return"icon/bighead/"+t+".jpg"},n.getTujianKuang=function(t){return"tujian/kapai_0"+t+".png"},n.getTujianRace=function(t){return"comp/image/race_"+t+".png"},n.getTaskIcon=function(t){return"comp/flag/renwu_icon0"+t+".png"},n.getJinduBox=function(t){return"shenling/jindu"+t+".png"},n.getAwakenIcon=function(t){return t==iface.tb_prop.attrTypeKey.hpMax?"shenling/shengming.png":t==iface.tb_prop.attrTypeKey.atk?"shenling/gongji.png":"shenling/fangyu.png"},n.getGodRaceSkin2=function(t){var e="";switch(t){case 0:e="shenjiezhimen/Szhushen.png";break;case 1:e="shenjiezhimen/Sxila.png";break;case 2:e="shenjiezhimen/Shuaxia.png";break;case 3:e="shenjiezhimen/Sbeiou.png";break;case 4:e="shenjiezhimen/Szhushen.png"}return e},n.getSysTitle=function(t){switch(t){case UIConst.EntranceList:return"comp/title/lilian.png";case UIConst.EntranceList_lilian:return"comp/title/maoxian.png";case UIConst.EntranceList_jingji:return"comp/title/jingji.png";case UIConst.EntranceList_kaufu:return"comp/title/kuafuzhan.png";case UIConst.ArenaView:return"comp/title/jingjichang.png";case UIConst.IslandView:case UIConst.OreMapView:return"comp/title/shemidaoyu.png";case UIConst.GloryFightView:case UIConst.GloryWaitView:case UIConst.GloryLastReview:return"comp/title/rongyuzhizhan.png";case UIConst.ArenaMatchView:return"comp/title/pipeishai.png";case UIConst.GodDomainView:case UIConst.GodDm_TeamView:return"comp/title/jizhanshenyu.png";case UIConst.ShiliantaView:return"comp/title/shiliantan.png";case UIConst.YuanzhengView:return"comp/title/siluoyiji.png";case UIConst.GuildMainView:return"comp/title/gonghui.png";case UIConst.FightMainView:case UIConst.FightWaitView:case UIConst.HonorHallView:return"comp/title/gonghuizhan.png";case UIConst.ZH_MainView:return"comp/title/zhaohuan.png";case UIConst.FogForestView:return"comp/title/miwusenglin.png";case UIConst.WorldBoss_BossView:return"";case UIConst.Copy_DailyMainView:return"comp/title/meirirenwu.png";case UIConst.EscortMainView:return"comp/title/shanduihusong.png";case UIConst.Copy_TeamMainView:return"comp/title/tizhan.png"}return""},n.guajiBtn=function(t){switch(t){case game.GuajiBtnState.JINGYING:return"guaji/tiaozhanjingying.png";case game.GuajiBtnState.CANBOSS:return"guaji/playboss.png";case game.GuajiBtnState.FIGHTING:return"guaji/zhandouzhong.png";case game.GuajiBtnState.MAP:return"guaji/shijieditu.png";default:return"guaji/anniu.png"}},n.getTreasureQualitySkin=function(t){return t==QualityConst.ORANGE?"baowu/bapwuchengse.jpg":t==QualityConst.RED?"baowu/bapwuhongse.jpg":""},n.getTaskBaoxiang=function(t,e){return 4==t?e?"comp/flag/task_baoxiang444.png":"comp/flag/task_baoxiang4.png":3==t?e?"comp/flag/task_baoxiang33.png":"comp/flag/task_baoxiang3.png":2==t?e?"comp/flag/task_baoxiang22.png":"comp/flag/task_baoxiang2.png":e?"comp/flag/task_baoxiang11.png":"comp/flag/task_baoxiang1.png"},n.getWorldBossQuality=function(t){return 2==t?"comp/bg/kuang_zi.png":3==t?"comp/bg/kuang_cheng.png":"comp/bg/kuang_lan.png"},n.getWelfareTitle=function(t){return t==game.WelfareType.dayLibao?"fuli/xianshi3.jpg":t==game.WelfareType.weekLibao?"fuli/xianshi2.jpg":t==game.WelfareType.monthLibao?"fuli/xianshi1.jpg":""},n.getShopTabSkin=function(t){switch(t){case ShopType.jishi:return"shop/js.png";case ShopType.shangcheng:return"shop/sd.png";case ShopType.jingjichang:return"shop/xz.png";case ShopType.guild:return"shop/gh.png";case ShopType.yuanzheng:return"shop/yj.png";case ShopType.shenjie:return"shop/jj.png";case ShopType.rongyao:return"shop/ry.png";case ShopType.godDm:return"shop/sy.png"}return""},n.getQiyuSkin=function(t){return"tanxian/qiyu"+t+".png"},n.getSysMapWH=function(){var t=Laya.stage.width,e=Laya.stage.height;return t>Launch.SCENE_WIDTH&&e>Launch.SCENE_HEIGHT?[900,1560]:e>Launch.SCENE_HEIGHT?[720,1560]:t>Launch.SCENE_WIDTH?[900,1280]:[720,1280]},n.getSysMapSkin=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i="");var n=Laya.stage.width,o=Laya.stage.height,a="",r="";switch(r=n>Launch.SCENE_WIDTH+1&&o>Launch.SCENE_HEIGHT+1||o>Launch.SCENE_HEIGHT+1?"mipmap/small1560":(Launch.SCENE_WIDTH,"mipmap/small1280"),t){case ModuleConst.MAIN:a=r+"/hudditu.jpg";break;case ModuleConst.GONGHUI:a=r+"/gonghuiditu.jpg";break;case ModuleConst.GONGHUI_FIGHT:a=r+"/gonghuiditu2.jpg";break;case ModuleConst.SUMMON:a=0==e?r+"/zhaohuanditu.jpg":r+"/zhaohuanbeijing.jpg";break;case ModuleConst.FIGHT:a=0==e?r+"/guaji/"+i+".jpg":"guaji/"+i+".png";break;case ModuleConst.SHILIANTA:a=r+"/shiliantaditu.jpg";break;case ModuleConst.EXPEDITION:a=r+"/shiluoyijiditu"+e+".jpg";break;case ModuleConst.Island:a=r+"/shenmidaoyuditu"+e+".jpg";break;case ModuleConst.SHENLING:a="shenling/yingxiongdi"+e+".jpg";break;case ModuleConst.BEIBAO:a=r+"/beibaoditu.jpg";break;case ModuleConst.EQUIPMENT:a=r+"/zhuangbeidi.jpg";break;case ModuleConst.ARTIFACT:a=r+"/shenqiditu.jpg";break;case ModuleConst.WANFA:a=r+"/"+i+".jpg";break;case ModuleConst.DAILY_COPY:a=r+"/meirifubenditu.jpg";break;case ModuleConst.CARAVAN_ESCORT:a=r+"/husongditu.jpg";break;case ModuleConst.WORLD_BOSS:a=r+"/bossditu.jpg";break;case ModuleConst.JINGJI:a=r+"/jjc_bj.jpg";break;case ModuleConst.GLORY_FIGHT:a=0==e?r+"/ryzz_bj01.jpg":r+"/ryzz_bj03.jpg";break;case ModuleConst.MATCH_FIGHT:a=r+"/pipeisai_bj02.jpg";break;case ModuleConst.GOD_DOMAIN:a=r+"/jzsy_bj02.jpg";break;case ModuleConst.login:a=r+"/login.jpg";break;case ModuleConst.loading:a=r+"/loading.jpg";break;case ModuleConst.ADVENTURE:a=r+"/dafuwenditu.jpg";break;case ModuleConst.GOD_LIHUI:a=r+"/lihuiditu.jpg"}return a},n.putong="comp/image/daojuquan.png",n.chatnotice="comp/bg/tishidi.png",n.danchou="comp/image/danchou.png",n.zhezhao2="comp/bg/zhezhao2.png",n.shilian="comp/image/shilian.png",n.chuanshuo="comp/image/chuanshuosuipian.png",n.jinxingzhong="comp/imag/jinxingzhong.png",n.kelingjiang="comp/imag/kelingjiang.png",n.superXing="comp/image/juexing_xingji.png",n.xingxing="comp/image/xinxi_xingji.png",n.iconxing="comp/image/buzhen_xingji.png",n.buttonGreen="comp/button/btn_qianwang.png",n.buttonNormal="comp/button/button.png",n.buttonRed="comp/button/btn_quxiao.png",n.yaoshi="comp/image/yaoshi.png",n.xingcheng="comp/image/xincheng.png",n.gang="comp/image/gang.png",n.weiJieSuo="shenqi/weijiesuo.png",n.btn_fanhui="comp/button/btn_fanhui.png",n.heianjinghua="comp/image/heianjinghua.png",n.loadbg="preload/loading2.jpg",n.baoxiangModelId="100001",n.chatBg1="chat/duihuakuang.png",n.chatBg2="chat/duihuakuang2.png",n.bagButtons=["comp/button/btn_yingxiong.png","bag/btn_suipian.png","bag/btn_cailiao.png","comp/button/btn_zhuangbei.png","bag/btn_baowu.png"],n.chuzhan="comp/image/shangzhen.png",n.box_xuanzhong="comp/image/huodong_wupinxuanzhong.png",n.jian_an="gonghui/fight/icon_jiandiban.png",n.jian_liang="gonghui/fight/icon_xiaojian.png",n.aixin_an="gonghui/fight/icon_aixindiban.png",n.aixin_liang="gonghui/fight/icon_aixin.png",n.dajian_an="gonghui/fight/icon_jiandikuang.png",n.dajian_liang="gonghui/fight/icon_jian.png",n.shengfudi="rongyaozhizhan/ryzz_shengfudi.png",n.lim_summon="fbutton/xszh_xs_icon.png",n.lim_group="fbutton/xstg_xs_icon.png",n.img_victory="rongyaozhizhan/ryzz_shengli.png",n.img_failure="rongyaozhizhan/ryzz_shibai.png",n.lb_victory="zhandoubiaoxian/sheng.png",n.lb_failure="zhandoubiaoxian/bai.png",n.izsy_di13="comp/bg/jzsy_bj13.png",n.izsy_di14="comp/bg/jzsy_bj14.png",n.izsy_bg_fail="zhandoubiaoxian/lanse.png",n.izsy_bg_succ="zhandoubiaoxian/hongse.png",n.btn_fangdajing="comp/button/btn_fangdajing.png",n.btn_bet="rongyaozhizhan/btn_yazhu.png",n.btn_vs="rongyaozhizhan/btn_vs.png",n.greenBg="comp/flag/woyaobianqiang_butiao00.png",n.blueBg="comp/flag/woyaobianqiang_butiao01.png",n.purpleBg="comp/flag/woyaobianqiang_butiao02.png",n.redBg="comp/flag/woyaobianqiang_butiao03.png",n.equip_sth_lvup="zhaungbei/qianghua1.png",n.equip_ref_lvup="zhaungbei/jinglian1.png",n.equip_purple_suit="zhaungbei/zizuang1.png",n.equip_orange_suit="zhaungbei/chengse1.png",n.equip_red_suit="zhaungbei/hongse1.png",n.equip_purple_suit_num="comp/shuzi/zizuang.png",n.equip_orange_suit_num="comp/shuzi/chengse.png",n.equip_red_suit_num="comp/shuzi/hongse.png",n.btn_shop="comp/button/btn_shangdian.png",n.btn_rank="comp/button/btn_paiming.png",n.btn_buzhen="comp/button/btn_buzhen.png",n.btn_rule="comp/button/btn_guizhe.png",n.btn_huiyuan="comp/button/btn_huiyuan.png",n.btn_jiangli="comp/button/btn_jiangli.png",n.btn_record="comp/button/btn_jilu.png",n.btn_glory_hall="comp/button/btn_rongyushangdian.png",n.btn_refresh="comp/button/btn_shuaxin.png",n.btn_team="comp/button/btn_zhuduixinxi.png",n.btn_saiji="comp/button/btn_saijipaiming.png",n.btn_fuhuo="comp/button/btn_fuhuoyingxiong.png",n.btn_huifu="comp/button/btn_huifushengming.png",n.btn_zhuzhan="comp/button/btn_haoyouzhuzhan.png",n.zuobiao_an="comp/image/gq_zuobiao.png",n.zuobiao_liang="comp/image/gq_zuobiao2.png",n.title_shengli="zhandoubiaoxian/shengli.png",n.title_shibai="zhandoubiaoxian/shibai.png",n.chip_normal="comp/image/suipian.png",n.chip_godSkin="comp/image/shizhuangjiaobiao.png",n.help_bx_noopen="comp/image/dabaoxiang.png",n.help_bx_open="comp/image/dabaoxiang2.png",n.wofang_guanghuan="comp/image/guanhuandi.png",n.difang_guanghuan="comp/image/guanhuandi2.png",n.fengexian="comp/image/zhaungbeixingxi02.png",n.difangjinengdi="comp/image/difangjinengdi.png",n.wofangjinengdi="comp/image/wofangjinengdi.png",n.wofangjinengGX="comp/image/wofangjinengdi2.png",n.difangjinengGX="comp/image/difangjinengdi2.png",n.fenye_down="comp/bg/fenye1.png",n.fenye_up="comp/bg/fenye2.png",n.default_head_frame="hud/zhuchengdi.png",n.default_lv_frame="hud/yubiaodi.png",n.guajiIndexImage="comp/image/xunzhong.png",n}(),ShowRewardUtil=function(){function t(){}return t.showRewardView=function(t,e,i,n){if(void 0===i&&(i=0),void 0===n&&(n=null),t&&0!=t.length){var o=Laya.Pool.getItemByClass("RewardInfoVo",RewardInfoVo);o.init(t,e,i,n),this._rewardList.push(o),0<o.weight&&(this._needSort=!0),Laya.timer.callLater(this,this.CheckRewardList)}},t.CheckRewardList=function(){if(!UIMgr.hasStage(UIConst.ShowRewardItem)){this._needSort&&(this._needSort=!1,this._rewardList.sort(function(t,e){return t.weight!=e.weight?e.weight-t.weight:t.id-e.id}));var t=this._rewardList.shift();t&&UIMgr.showUI(UIConst.ShowRewardItem,t)}},t._rewardList=[],t._needSort=!1,t}(),RewardInfoVo=function(){function o(){this.id=0,this.type=0,this.weight=0}return o.prototype.init=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=null),this.id=o.ID++,this.rewardList=t||[],this.type=e,this.weight=i,this.handler=n},o.prototype.clear=function(){this.id=0,this.rewardList=null,this.handler=null},o.ID=1,o}(),ResConst=function(){function t(){}return t.anim_strength="eff/StrengthenSuccEff.ani",t.atlas_strength_effect="effects/qianghuchenggong.atlas",t.anim_baoxiang="eff/BaoxiangEff.ani",t.atlas_baoxiang="effects/baoxiang.atlas",t.anim_teshutishi="eff/vipitemeff.ani",t.atlas_teshutishi="effects/teshutishi.atlas",t.anim_circle_select="eff/CircleSelect.ani",t.atlas_circle_select="comp/image.atlas",t.anim_yunceng="eff/YuncengEff.ani",t.yunceng1="tanxian/yun11.png",t.yunceng2="tanxian/yun22.png",t}(),RegConst=function(){function t(){}return t.TEL_REG=/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,t.HTML_REG=/<\/?.+?\/?>/gi,t.EMPTY_ALL_REG=/\s+/g,t}(),QualityConst=function(){function t(){}return t.WHITE=1,t.GREEN=2,t.BLUE=3,t.PURPLE=4,t.ORANGE=5,t.RED=6,t}(),ModuleConst=function(){function t(){}return t.MAIN=1e3,t.FIGHT=100,t.FAST_FIGHT=110,t.AUTO_FIGHT=120,t.CHAT=130,t.CHAT_PROVI=131,t.CHAT_CROSSSRV=132,t.SHEZHI=140,t.MAIL=150,t.SUMMON=210,t.Island=220,t.GONGHUI=230,t.GONGHUICOPY=231,t.GONGHUI_FIGHT=232,t.DIXIACHENG=240,t.SHILIANTA=250,t.JINGJI=260,t.TUJIAN=270,t.FRIEND=310,t.SHOUCHONG=320,t.CHONGZHI=790,t.HONOR=330,t.DAILY=340,t.JISHI=350,t.FULI=360,t.PAY_ACTIVITY=364,t.SHOP=370,t.ACTIVITY=380,t.KAIFU_JIJIN=393,t.LOGIN_QIRI=394,t.LOGIN_SHISIRI=395,t.TEST_REBATE=396,t.WARRIOR_PROVE=397,t.SHENLING=400,t.SHENGXING=770,t.JUEXING=401,t.RONGHUN=402,t.SHENGJIE=403,t.TREASURE=410,t.BEIBAO=500,t.EQUIP_FENJIE=510,t.FUWEN=600,t.QIRIKH=710,t.EXPEDITION=720,t.DAILY_COPY=730,t.WORLD_BOSS=740,t.PAIHBAN=750,t.SHENMEN=760,t.FENJIE=780,t.ARTIFACT=800,t.ARTIFACT_BAPTIZE=801,t.ARTIFACT_ENCHANT=802,t.ADVENTURE=810,t.CARAVAN_ESCORT=820,t.TEAM_COPY=960,t.FOG_FOREST=830,t.EQUIPMENT=910,t.EQUIP_STRENGTH=911,t.EQUIP_JINGLIAN=912,t.EQUIP_BAOSHI=913,t.GLORY_FIGHT=920,t.MATCH_FIGHT=930,t.GOD_DOMAIN=940,t.GOD_LIHUI=1000001,t.WANFA=1e4,t.login=10001,t.loading=10002,t}();!function(t){t[t.challenge=1]="challenge",t[t.honor=2]="honor"}(AchievementTabType=AchievementTabType||{}),function(t){t[t.up=1]="up",t[t.down=2]="down",t[t.left=3]="left",t[t.right=4]="right"}(TweenDirection=TweenDirection||{}),function(t){t[t.task_liveness=-10]="task_liveness",t[t.exp=5]="exp",t[t.mofajinghua_u=200]="mofajinghua_u",t[t.mofajinghua_m=201]="mofajinghua_m",t[t.mofajinghua_l=202]="mofajinghua_l",t[t.shenlijinghua_u=203]="shenlijinghua_u",t[t.shenlijinghua_m=204]="shenlijinghua_m",t[t.shenlijinghua_l=205]="shenlijinghua_l",t[t.weizhi_zhaohuanshu=206]="weizhi_zhaohuanshu",t[t.shenmi_zhaohuanshu=207]="shenmi_zhaohuanshu",t[t.shenjiemiyao=224]="shenjiemiyao",t[t.jinhuahuizhang=225]="jinhuahuizhang",t[t.shenlijinghua=230]="shenlijinghua",t[t.yuangumibao=231]="yuangumibao",t[t.touzi=234]="touzi",t[t.huifu_yaoshui=303]="huifu_yaoshui",t[t.fuhuo_yaoshui=304]="fuhuo_yaoshui",t[t.suipian_sanxing=350]="suipian_sanxing",t[t.suipian_sixing=351]="suipian_sixing",t[t.suipian_wuxing=352]="suipian_wuxing",t[t.liuxingka=503]="liuxingka",t[t.qixingka=504]="qixingka",t[t.baxingka=505]="baxingka",t[t.jiuxingka=506]="jiuxingka",t[t.qianghuashi=400]="qianghuashi",t[t.jinglianshi=401]="jinglianshi",t[t.xingmangshi=405]="xingmangshi",t[t.longgang=406]="longgang",t[t.risk_updatecard=407]="risk_updatecard",t[t.hun_life=411]="hun_life",t[t.hun_attack=412]="hun_attack",t[t.hun_defense=413]="hun_defense",t[t.baoshi_attack=415]="baoshi_attack",t[t.baoshi_life=416]="baoshi_life",t[t.baoshi_defense=417]="baoshi_defense",t[t.escort_shuaxin=418]="escort_shuaxin",t[t.escort_husong=419]="escort_husong",t[t.treasure_exp=423]="treasure_exp",t[t.treasure_rebirth=424]="treasure_rebirth",t[t.treasure_suipian_purple=425]="treasure_suipian_purple",t[t.treasure_suipian_orange=426]="treasure_suipian_orange",t[t.treasure_suipian_red=427]="treasure_suipian_red",t[t.warrior_prove=750]="warrior_prove",t[t.shenqi_leishenchui=30003]="shenqi_leishenchui"}(CostTypeKey=CostTypeKey||{}),function(t){t[t.id=1]="id",t[t.level=2]="level",t[t.taskid=3]="taskid",t[t.power=4]="power"}(CopyConditionType=CopyConditionType||{}),function(t){t[t.default=0]="default",t[t.level=1]="level",t[t.copy=2]="copy",t[t.taskId=3]="taskId"}(SysConditionType=SysConditionType||{}),function(t){t[t.god=1]="god",t[t.godStar=2]="godStar",t[t.item=3]="item",t[t.itemCnt=4]="itemCnt",t[t.rarityGod=5]="rarityGod",t[t.gloryId=6]="gloryId",t[t.guildHelpItem=7]="guildHelpItem",t[t.gotoGuildHelp=8]="gotoGuildHelp",t[t.joinGuildState=9]="joinGuildState",t[t.joinGuild=10]="joinGuild",t[t.joinTeamGroup=11]="joinTeamGroup"}(NoticeParamType=NoticeParamType||{}),function(t){t[t.RESOLVE=0]="RESOLVE",t[t.WEAR=1]="WEAR",t[t.CHANGE=2]="CHANGE",t[t.DISCHARGE=3]="DISCHARGE",t[t.STRENGTH=4]="STRENGTH",t[t.REFINE=5]="REFINE",t[t.ROOT_EQUIP_CHANGE=6]="ROOT_EQUIP_CHANGE",t[t.SWITCH=7]="SWITCH"}(EquipOperation=EquipOperation||{}),function(t){t[t.ENCHANT=0]="ENCHANT",t[t.RECYCLE=1]="RECYCLE",t[t.ACTIVATE=2]="ACTIVATE",t[t.STRENGTH=3]="STRENGTH",t[t.CHANGE=4]="CHANGE",t[t.PBAPTIZE=5]="PBAPTIZE",t[t.GBAPTIZE=6]="GBAPTIZE",t[t.SKILLUPGRADE=7]="SKILLUPGRADE",t[t.WEAR_OR_TAKEOFF=8]="WEAR_OR_TAKEOFF"}(Artifact=Artifact||{}),function(t){t[t.EQUIP=1]="EQUIP",t[t.WISH=3]="WISH",t[t.ART=2]="ART",t[t.GOD=0]="GOD",t[t.TREASURE=4]="TREASURE"}(TURNTABLE=TURNTABLE||{});var WeekNum,ShopType,GoodsLimitType,EquipSuit,ValueType,ChipType,GodType,TimeConst=function(){function t(){}return t.ONE_HOURS_SEC=3600,t.ONE_DAY_SEC=86400,t.ONE_DAY_MILSEC=864e5,t}();!function(t){t[t.Sun=0]="Sun",t[t.Mon=1]="Mon",t[t.Tue=2]="Tue",t[t.Wed=3]="Wed",t[t.Thu=4]="Thu",t[t.Fri=5]="Fri",t[t.Sat=6]="Sat"}(WeekNum=WeekNum||{}),function(t){t[t.jishi=-1]="jishi",t[t.shangcheng=1]="shangcheng",t[t.jingjichang=2]="jingjichang",t[t.guild=3]="guild",t[t.yuanzheng=4]="yuanzheng",t[t.shenjie=5]="shenjie",t[t.rongyao=7]="rongyao",t[t.godDm=8]="godDm"}(ShopType=ShopType||{}),function(t){t[t.none=0]="none",t[t.day=1]="day",t[t.week=2]="week"}(GoodsLimitType=GoodsLimitType||{}),function(t){t[t.two=2]="two",t[t.three=3]="three",t[t.four=4]="four"}(EquipSuit=EquipSuit||{}),function(t){t[t.fixed=0]="fixed",t[t.percent=1]="percent"}(ValueType=ValueType||{}),function(t){t[t.normal=1]="normal",t[t.godSkin=2]="godSkin"}(ChipType=ChipType||{}),function(t){t[t.shuchu=1]="shuchu",t[t.zhiliao=2]="zhiliao",t[t.fuzhu=3]="fuzhu",t[t.kongzhi=4]="kongzhi",t[t.fangyu=5]="fangyu"}(GodType=GodType||{});var HtmlUtil=function(){function t(){}return t.convertHtmlText=function(t,e){return void 0===e&&(e=!1),e?t.replace(RegConst.HTML_REG,""):t},t}(),GodUtil=function(){},GameUtil=(__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n},function(){function o(){}return o.toCountdown=function(t,e,i){var s,u,h=this;if(void 0===i&&(i=0),t<0)return"00:00:00";1==i?(s=0,u=Math.floor(t/3600),t%=3600):2==i?u=s=0:(s=Math.floor(t/86400),t%=86400,u=Math.floor(t/3600),t%=3600);var l=Math.floor(t/60);t%=60;var c=Math.floor(t),n=e.replace(/((\[)(.*?))?(D{1,2})(([^\]]?)\])?/gi,function(t,e,i,n,o,a,r){return"["==i&&s<=0?"":(n||"")+h.padNum(s,o)+(r||"")});return n=(n=(n=n.replace(/((\[)(.*?))?(H{1,2})(([^\]]?)\])?/gi,function(t,e,i,n,o,a,r){return"["==i&&u<=0?"":(n||"")+h.padNum(u,o)+(r||"")})).replace(/((\[)(.*?))?(M{1,2})(([^\]]?)\])?/gi,function(t,e,i,n,o,a,r){return"["==i&&u<=0&&l<=0?"":(n||"")+h.padNum(l,o)+(r||"")})).replace(/((\[)(.*?))?(S{1,2})(([^\]]?)\])?/gi,function(t,e,i,n,o,a,r){return"["==i&&0<u?"":(n||"")+h.padNum(c,o)+(r||"")})},o.padNum=function(t,e){var i=t.toString();return 0<e.length-i.length?"0"+i:i},o.aryIsChange=function(t,e){if(t.length!=e.length)return!0;for(var i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!0;return!1},o.concatArray=function(t,e){return t=t?__spreadArrays(t):[],e=e?__spreadArrays(e):[],__spreadArrays(t,e)},o.getTimeStr=function(t){var e="";if(t>TimeConst.ONE_DAY_SEC){var i=Math.floor(t/TimeConst.ONE_DAY_SEC),n=Math.ceil(t%TimeConst.ONE_DAY_SEC/TimeConst.ONE_HOURS_SEC);e=LanMgr.getLan("",12096,i,n)}else e=o.toCountdown(t,"hh:mm:ss");return e},o.getTimeStr2=function(t){var e="",i=Math.floor(t/TimeConst.ONE_DAY_SEC);if(1<=i){var n=Math.ceil((t-i*TimeConst.ONE_DAY_SEC)/TimeConst.ONE_HOURS_SEC);e=LanMgr.getLan("",12094,i,n)}else{n=Math.floor(t/TimeConst.ONE_HOURS_SEC);var o=Math.ceil((t-n*TimeConst.ONE_HOURS_SEC)/60);e=LanMgr.getLan("",12095,n,o)}return e},o.getFormatTime=function(t,e,i,n){void 0===n&&(n=0);var o=new Date;o.setTime(App.serverTime),o.setHours(0,0,0,0);var a=o.getTime()/1e3,r=o.getDay();return(t<=(r=r==WeekNum.Sun?7:r)?a-(r-t)*TimeConst.ONE_DAY_SEC:a+(t-r)*TimeConst.ONE_DAY_SEC)+e*TimeConst.ONE_HOURS_SEC+60*i+n},o.isString=function(t){return"string"==typeof t&&t.constructor==String},o.isArray=function(t){return"object"==typeof t&&t.constructor==Array},o.isNumber=function(t){return"number"==typeof t&&t.constructor==Number},o.isFunction=function(t){return"function"==typeof t&&t.constructor==Function},o.isObject=function(t){return"object"==typeof t&&t.constructor==Object},o.isDate=function(t){return"object"==typeof t&&t.constructor==Date},o.isIosNative=function(){return Laya.Browser.onIOS&&!Laya.Browser.onMiniGame},o.getItemQulityByID=function(t){var e=tb.TB_item.get_TB_itemById(t),i=1;return e&&(i=e.type==iface.tb_prop.itemTypeKey.god?6<(i=e.defined[1]||e.quality)?6:i:e.quality),i},o.requestRankList=function(a,r){return new Promise(function(o,t){var e={};e[Protocol.game_rank_getRankList.args.rankType]=a,PLC.request(Protocol.game_rank_getRankList,e,function(t){if(t){var e=[];for(var i in t.rankList){var n=new r;a==iface.tb_prop.rankTypeKey.groupCopyFloor?n.setArrayTypeGroupCopyFloor(t.rankList[i],Number(i)):n.setArray(t.rankList[i],Number(i)),e.push(n)}o({myRank:t.myRank,rankValue:t.rankValue,rankList:e})}})})},o.getTimePrev=function(t){var e=App.serverTimeSecond-t,i="";if(e<TimeConst.ONE_HOURS_SEC)i=(Math.floor(e/60)||1)+LanMgr.getLan("",12097);else if(e<TimeConst.ONE_DAY_SEC){i=(Math.floor(e/3600)||1)+LanMgr.getLan("",12098)}else{var n=Math.floor(e/86800);i=(7<n?7:n)+LanMgr.getLan("",12099)}return i},o.getOfflineTimeStr=function(t,e){var i=e-t;return i<60?LanMgr.getLan("",12100):i<3600?(i=Math.ceil(i/60),LanMgr.getLan("",12101,i)):i<86400?(i=Math.ceil(i/3600),LanMgr.getLan("",12102,i)):i<2592e3?(i=Math.ceil(i/86400),LanMgr.getLan("",12103,i)):LanMgr.getLan("",12104)},o.isFullScreen=function(){return!1},o.getMinOpenLv=function(t){for(var e=-1,i=0,n=t;i<n.length;i++){var o=n[i],a=tb.TB_sys_open.get_TB_sys_openById(o);a&&(-1==e||a.open_parameter<e)&&(e=a.open_parameter)}return e},o.strencode=function(t){var e=JSON.stringify(t),i=new Laya.Byte;return i.writeUTFBytes(e),i.pos=0,i.getUTFBytes()},o}()),FightConst=function(){function t(){}return t.TEAM1="1",t.TEAM2="2",t.SKILL0="0",t.SKILL1="1",t}(),ColorConst=function(){function e(){}return e.getRankdomColor=function(){return this.getQulityColor(random(6))},e.getQulityColor=function(t){switch(t){case 1:return e.WHITE;case 2:return e.GREEN;case 3:return e.BLUE;case 4:return e.PURPLE;case 5:return e.ORANGE;case 6:return e.RED}return e.WHITE},e.getLimiteBuyZheKouColor=function(t){switch(t){case 1:return"#e691f6";case 2:return"#830072";case 3:return"#ffec9c";case 4:return"#b14808";default:return"#000000"}},e.getFogForestRankColor=function(t){switch(t){case 1:return"#fff17d";case 2:return"#ad23ab";case 3:return"#1555c0";default:return"#000000"}},e.getTujianNameColor=function(t){switch(t){case 1:return"#f7edda";case 2:return"#d8ffb8";case 3:return"#b8fff4";case 4:return"#f8c6ff";case 5:return"#fff4dc";default:return"#000000"}},e.getDailyCopyColor=function(t){switch(t){case 1:return"#ffffff";case 2:return"#afe5a0";case 3:return"#a0dfe5";case 4:return"#daa0e5";case 5:return"#ffd649";case 6:return"#ff4848";default:return"#ffffff"}},e.getDailyCopyBtnStroke=function(t){return t?"#676767":"#ca7005"},e.getGradeColor=function(t){switch(t){case 1:return"#ffec6f";case 2:return"#ff6e6e";case 3:return"#e0ccff";case 4:return"#cffafc";case 5:return"#ffc455";case 6:return"#a9c4cb";case 7:return"#d1884c";default:return"#ffffff"}},e.getStarLvStrokeColor=function(t){var e=["#5b7007","#2c527c","#64217c","#9e6715","#9e1515"];return e[Math.floor((t-1)/2)]||e[0]},e.redFilter=new Laya.ColorFilter([1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0]),e.grayFilter=new Laya.ColorFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]),e.lightFilter=new Laya.GlowFilter("#ff0000",15,0,0),e.shadowFilter=new Laya.GlowFilter("#000000",8,8,8),e.normalFont="#7e5336",e.redFont="#ff0400",e.LIGHT_STH="#f66217",e.RED="#ff0000",e.ORANGE="#ff7000",e.PURPLE="#b700ff",e.GRAY="#848484",e.GREEN="#35cd41",e.FATE_GREEN="#3d9441",e.FIRST_GREEN="#99ff01",e.TASK_GREEN="#319c28",e.TASK_ORANGE="#c26939",e.FATE_GOLD="#7e5336",e.BLUE="#0000ff",e.WHITE="#ffffff",e.BLACK="#000000",e.ZONGSE="#fff5c1",e.TAB_FONT="#4C260D",e.LIGHT="#ffeecc",e.ORANGE_FILTER="#ca7005",e.RED_FILTER="#e6360d",e.GREEN_FILTER="#538901",e.CHAT_WORLD="#f69600",e.CHAT_GUILD="#19a816",e.CHAT_PROVINCE="#0a87bb",e.CHAT_CROSS_SVR="#e65700",e}(),BezierTween=function(){function h(){}return h.to=function(t,e,i,n,o,a){var r=Laya.Pool.getItemByClass("bezierTween",BezierItem);r.Anchorpoints=i;var s=r.Anchorpoints[0],u=(r.Anchorpoints[1],{x:s.x+Math.floor(100*Math.random()),y:s.y+Math.floor(300*Math.random())});r.Anchorpoints.splice(1,0,u),r.StartTime=Laya.timer.currTimer,r.Duration=e,r.EndTime=r.StartTime+r.Duration,r.Target=t,r.Complete=a,r.ease=o,r.props=n,r.onStart(),h.TWEEN_MAP.set(t,r)},h.clear=function(t){if(h.TWEEN_MAP.has(t)){var e=h.TWEEN_MAP.get(t);e.clear(),Laya.Pool.recover("bezierTween",e),h.TWEEN_MAP.delete(t)}},h.TWEEN_MAP=new Map,h}(),BezierItem=function(){function t(){}return t.prototype.onStart=function(){var t=this;this.bezierok=!1,this.tweenok=!0,this.props&&(this.tweenok=!1,Laya.Tween.to(this.Target,this.props,this.Duration,this.ease,Handler.create(this,function(){t.tweenok=!0,t.onComp()}))),Laya.timer.clear(this,this.updateBezier),Laya.timer.frameLoop(1,this,this.updateBezier)},t.prototype.updateBezier=function(){var t=Laya.timer.currTimer;if(t>this.EndTime)return Laya.timer.clear(this,this.updateBezier),this.bezierok=!0,void this.onComp();var e=(t-this.StartTime)/this.Duration,i=this.MultiPointBezier(this.Anchorpoints,e);this.Target.x=i.x,this.Target.y=i.y},t.prototype.MultiPointBezier=function(t,e){for(var i=t.length,n=0,o=0,a=0;a<i;a++){var r=t[a];n+=r.x*Math.pow(1-e,i-1-a)*Math.pow(e,a)*this.erxiangshi(i-1,a),o+=r.y*Math.pow(1-e,i-1-a)*Math.pow(e,a)*this.erxiangshi(i-1,a)}return{x:n,y:o}},t.prototype.erxiangshi=function(t,e){for(var i=1,n=1;0<e;)i*=t,n*=e,t--,e--;return i/n},t.prototype.onComp=function(){this.bezierok&&this.tweenok&&(this.Complete&&this.Complete.run(),BezierTween.clear(this.Target))},t.prototype.clear=function(){Laya.Tween.clearTween(this.Target),Laya.timer.clear(this,this.updateBezier),this.Anchorpoints=null,this.bezierok=!1,this.Duration=0,this.ease=null,this.EndTime=0,this.props=null,this.StartTime=0,this.Target=null,this.tweenok=!1},t}();__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(c){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"ZhaohuanProcessor"},i.prototype.listenModuleEvents=function(){return[new c.SummonEvent(c.SummonEvent.SHOW_SUM_RESULT_PANEL),new c.SummonEvent(c.SummonEvent.HIDE_ZHAOHUAN_RESULT),new c.SummonEvent(c.SummonEvent.HIDE_ZHAOHUAN_PANEL),new c.SummonEvent(c.SummonEvent.SHOW_ZHAOHUAN_PANEL),new c.SummonEvent(c.SummonEvent.SEND_ZHAOHUAN),new c.ResEvent(c.ResEvent.RESOURCE_CHANGE),new c.ResEvent(c.ResEvent.PROP_CHANGE),new c.ResEvent(c.ResEvent.LIMIT_VALUE_CHANGE)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof c.SummonEvent)switch(t.type){case c.SummonEvent.SHOW_ZHAOHUAN_PANEL:this.showchoukaPanel(t.data);break;case c.SummonEvent.HIDE_ZHAOHUAN_RESULT:this.hideSummonPanel();break;case c.SummonEvent.SHOW_SUM_RESULT_PANEL:this.showSummonResultPanel(t.data);break;case c.SummonEvent.SEND_ZHAOHUAN:this.sendZhaohuan(t.data)}if(t instanceof c.ResEvent)switch(t.type){case c.ResEvent.RESOURCE_CHANGE:this.coinsChange();break;case c.ResEvent.PROP_CHANGE:case c.ResEvent.LIMIT_VALUE_CHANGE:this.propChange()}},i.prototype.sendZhaohuan=function(t){var e=!1,i=tb.TB_god_employ_set.get_TB_god_employ_setnById(1),n=iface.tb_prop.godEmployTypeKey.propOnce;switch(t.type){case c.ZHAOHUAN.GENERAL:n=t.isOne?iface.tb_prop.godEmployTypeKey.propOnce:iface.tb_prop.godEmployTypeKey.propTen;var o=t.isOne?1:10;1==o&&0==App.hero.getlimitValue(iface.tb_prop.limitTypeKey.propFreeNum)||o<=App.hero.getBagItemNum(CostTypeKey.weizhi_zhaohuanshu)?e=!0:showToast(LanMgr.getLan("",10120));break;case c.ZHAOHUAN.FRIENDSHIP:n=t.isOne?iface.tb_prop.godEmployTypeKey.friendOnce:iface.tb_prop.godEmployTypeKey.friendTen;var a=t.isOne?i.friend_cost:10*i.friend_cost;App.hero.friend>=a?e=!0:showToast(LanMgr.getLan("",10205));break;case c.ZHAOHUAN.DIAMOND:n=t.isOne?iface.tb_prop.godEmployTypeKey.diamondOnce:iface.tb_prop.godEmployTypeKey.diamondTen;var r=t.isOne?i.zuanshi_once_priority:i.zuanshi_ten_priority;if(t.isOne&&0==App.hero.getlimitValue(iface.tb_prop.limitTypeKey.diamondFreeNum))e=!0;else if(App.hero.getBagItemNum(String(r[0]))>=r[1])e=!0;else{var s=t.isOne?i.zuanshi_once:i.zuanshi_ten;App.hero.diamond>=s?e=!0:showToast(LanMgr.getLan("",Lans.daimond))}break;case c.ZHAOHUAN.LEGEND:var u=App.hero.levelPrivilege(iface.tb_prop.levelPrivilegeTypeKey.legendEmploy);if(i.special_employ[1]<=App.hero.legendChip)if(u)n=iface.tb_prop.godEmployTypeKey.legend,e=!0;else{dispatchEvt(new c.TopUpEvent(c.TopUpEvent.SHOW_CHONGZHI_PANEL));var h=tb.TB_vip_privilege.get_TB_vip_privilegeById(iface.tb_prop.levelPrivilegeTypeKey.legendEmploy);showToast(LanMgr.getLan("",10206,h.vip_level))}else u?showToast(LanMgr.getLan("",10120)):(h=tb.TB_vip_privilege.get_TB_vip_privilegeById(iface.tb_prop.levelPrivilegeTypeKey.legendEmploy),showToast(LanMgr.getLan("",10206,h.vip_level)))}if(e){var l={};l[Protocol.game_god_employ.args.godEmployType]=n,PLC.request(Protocol.game_god_employ,l,function(t){t&&dispatchEvt(new c.SummonEvent(c.SummonEvent.ZHAOHUAN_SUCCESS))})}},i.prototype.showchoukaPanel=function(t){void 0===t&&(t=null),UIMgr.showUI(UIConst.ZH_MainView)},i.prototype.propChange=function(){UIMgr.hasStage(UIConst.ZH_MainView)&&UIMgr.getUIByName(UIConst.ZH_MainView).refreshList()},i.prototype.coinsChange=function(){UIMgr.hasStage(UIConst.ZH_MainView)&&UIMgr.getUIByName(UIConst.ZH_MainView).refreshList()},i.prototype.showSummonResultPanel=function(t){if(UIMgr.hasStage(UIConst.ZH_MainView)||UIMgr.hasStage(UIConst.LimiteBuyView))if(UIMgr.hasStage(UIConst.ZH_ResultView)){var e=UIMgr.getUIByName(UIConst.ZH_ResultView);e.dataSource=t,e.popup()}else UIMgr.showUI(UIConst.ZH_ResultView,t)},i.prototype.hideSummonPanel=function(){UIMgr.hideUIByName(UIConst.ZH_ResultView)},i);function i(){return t.call(this)||this}c.ZhaohuanProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"ZhaohuanModule"},n.prototype.listProcessors=function(){return[new t.ZhaohuanProcessor]},n.prototype.onRegister=function(){t.ZhaohuanModel.getInstance()},n);function n(){return e.call(this)||this}t.ZhaohuanModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.HIDE_ZHAOHUAN_RESULT="HIDE_ZHAOHUAN_RESULT",r.SHOW_ZHAOHUAN_PANEL="SHOW_ZHAOHUAN_PANEL",r.HIDE_ZHAOHUAN_PANEL="HIDE_ZHAOHUAN_PANEL",r.SHOW_SUM_RESULT_PANEL="SHOW_SUM_RESULT_PANEL",r.SEND_ZHAOHUAN="SEND_ZHAOHUAN",r.ZHAOHUAN_SUCCESS="ZHAOHUAN_SUCCESS",r.SHOW_BTN_VISIBLE_TRUE="SHOW_BTN_VISIBLE_TRUE",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.SummonEvent=a}(game=game||{}),function(t){var e=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},Object.defineProperty(i.prototype,"jumpAni",{get:function(){return this._jumpAni},set:function(t){this._jumpAni=t},enumerable:!0,configurable:!0}),i);function i(){this.curObj={isOne:!1,type:-1},this._jumpAni=!1}t.ZhaohuanModel=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i;(i=e=t.ZHAOHUAN||(t.ZHAOHUAN={}))[i.GENERAL=0]="GENERAL",i[i.FRIENDSHIP=1]="FRIENDSHIP",i[i.DIAMOND=2]="DIAMOND",i[i.LEGEND=3]="LEGEND";var n,o=(n=ui.zhaohuan.ZhaohuanUI,__extends(a,n),a.prototype.onClosed=function(){n.prototype.onClosed.call(this),t.ZhaohuanModel.getInstance().curObj.type=-1,UIMgr.hideUIByName(UIConst.SysTopView),Laya.timer.clearAll(this)},a.prototype.show=function(){n.prototype.show.call(this,!1,!1);var t=[{btnSkin:SkinUtil.btn_rule,callback:this.onShuoming.bind(this)}],e=[iface.tb_prop.resTypeKey.diamond];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onFanHui.bind(this)}),this.img_tips.visible=!1,this.list_zhaohuan.dataSource=this.listdata,this.addTick(),UIUtil.listTween(this.list_zhaohuan)},a.prototype.addTick=function(){var t=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.propFreeNum),e=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.diamondFreeNum);0!=t||0!=e?Laya.timer.loop(1e3,this,this.onTick):Laya.timer.clear(this,this.onTick),this.onTick()},a.prototype.onTick=function(){var t="",e=new Date(App.serverTime);e.setHours(0,0,0,0);var i=(e.getTime()+TimeConst.ONE_DAY_MILSEC)/1e3,n=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.propFreeNum);t=0!=n?GameUtil.toCountdown(i-App.getServerTime(),"hh:mm:ss")+LanMgr.getLan("",12105):"",this.list_zhaohuan.getCell(0).setTime(t);var o=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.diamondFreeNum);t=0!=o?GameUtil.toCountdown(i-App.getServerTime(),"hh:mm:ss")+LanMgr.getLan("",12105):"",this.list_zhaohuan.getCell(2).setTime(t),0!=n||0!=o||Laya.timer.clear(this,this.onTick)},a.prototype.refreshList=function(){this.list_zhaohuan.refresh(),this.addTick()},a.prototype.onFanHui=function(){dispatchEvt(new t.HudEvent(t.HudEvent.RETURN_LASTVIEW,UIConst.Main3DView))},a.prototype.onShuoming=function(t){this.img_tips.skin||(this.img_tips.skin="zhaohuan/summonTips.png"),this.img_tips.visible=!this.img_tips.visible},a);function a(){var t=n.call(this)||this;return t._ui=UIMgr.getInstance(),t.listdata=[{type:e.GENERAL},{type:e.FRIENDSHIP},{type:e.DIAMOND},{type:e.LEGEND}],t.group=UIConst.hud_group,t.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.SUMMON,0),t}t.ZhaohuanView=o}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var i,t=(i=ui.zhaohuan.ResultUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._uiGodItem=[];for(var t=0;t<10;t++)this._uiGodItem[t]=this["ui_god_"+t],this._uiGodItem[t].visible=!1},e.prototype.popup=function(){this.uiScene.onExit(),i.prototype.popup.call(this,!1,!1)},e.prototype.show=function(){this.uiScene.onExit(),i.prototype.show.call(this,!1,!1)},e.prototype.onOpened=function(){var e=this;i.prototype.onOpened.call(this),this.chk_jump.on(Laya.Event.CHANGE,this,this.onChkJump),this.initView(),this._particle||u.ZhaohuanModel.getInstance().jumpAni?this.onEffComplete():setTimeout(function(){e.uiScene.addEffect(e,1000001,new tl3d.Vector3D(180,0,-750),3.5,30,function(t){e._particle=t,e._particle.addEventListener(tl3d.BaseEvent.COMPLETE,e.onEffComplete,e)},0,0,!1,.9)},200),this.on(Laya.Event.CLICK,this,this.onClickHideModel)},e.prototype.initView=function(){this.uiScene.onShow(),this.box_btn.visible=!1,this.lab_txt.visible=!1,this.hideUiGodItem(),this.clearCardModel(),this.btn_rightpage.visible=this.btn_leftpage.visible=!1,this.img_starbg.visible=!1,this.list_stars.visible=!1,this.box_box.visible=!1,this.box_eff.visible=!1,this.img_rewardbg.visible=this.img_reward.visible=!1,this.chk_jump.selected=u.ZhaohuanModel.getInstance().jumpAni},e.prototype.removeEff=function(){this._particle&&(this._particle.removeEventListener(tl3d.BaseEvent.COMPLETE,this.onEffComplete,this),this.uiScene.removeEffect(this._particle),this._particle=null)},e.prototype.onEffComplete=function(){if(this._particle||u.ZhaohuanModel.getInstance().jumpAni){this.removeEff(),AudioMgr.playSound("sound/zhaohuanSucc.mp3"),this.box_eff.visible=!0;var t=this.dataSource.godlist;if(u.ZhaohuanModel.getInstance().jumpAni){for(var e=0;e<t.length;e++)this.showGodItem(e,t[e]);return 1<t.length?(this._uiGodItem[0].x=160,this._uiGodItem[0].y=100):(this._uiGodItem[0].x=335,this._uiGodItem[0].y=320),void this.endEff()}if(1<t.length){if(t.sort(function(t,e){return Math.floor(4*Math.random())-2}),this._isShowModel=!1,this._uiGodItem[0].x=160,this._uiGodItem[0].y=100,!this._isShowModel)for(e=0;e<this._uiGodItem.length;e++){var i=this._uiGodItem[e];this.addCardModel(i.x+this.box_eff.x-2,i.y+this.box_eff.y+106)}this.uiScene.timespeed1=1.2,this._totalnum=t.length,this._effnum=0,this._effidx=0,Laya.timer.callLater(this,this.playEff)}else this.uiScene.timespeed1=1.2,(i=this._uiGodItem[0]).x=335,i.y=320,this._isShowModel=!1,this.addCardModel(i.x+this.box_eff.x-2,i.y+this.box_eff.y+106),this._totalnum=1,this._effnum=0,Laya.timer.callLater(this,this.playEff)}},e.prototype.endEff=function(){if(this.dataSource.reward){var t=this.dataSource.reward[iface.tb_prop.resTypeKey.legendChip];t&&(this.img_reward.visible=this.img_rewardbg.visible=!0,this.lab_rewardnum.text="x "+t,this.img_reward.y=this.img_rewardbg.y=this.box_eff.visible?220:350)}this.uiScene.timespeed1=0,this._curIdx=0,this.box_box.y=0,this.box_eff.visible||this.addModelEff(),this.img_starbg.visible=!0,this.setBtn()},e.prototype.addModelEff=function(){var e=this;this._hasModelEff||(this._hasModelEff=!0,this.uiScene.addEffect(this,1000005,new tl3d.Vector3D(180,0,-630),1.5,30,function(t){e._modelEff=t,e._hasModelEff||e.removeModelEff()}))},e.prototype.removeModelEff=function(){this._hasModelEff=!1,this._modelEff&&(this.uiScene.removeEffect(this._modelEff),this._modelEff=null)},e.prototype.playEff=function(){var i=this;if(this._effnum>=this._totalnum&&!this._isShowModel)this.endEff();else{var t=this.dataSource.godlist[this._effnum];if(this._isShowModel){if(!(4<=t.getStar())){this._effnum=0,this._isShowModel=!1;for(var e=0;e<this._uiGodItem.length;e++){var n=this._uiGodItem[e];this.addCardModel(n.x+this.box_eff.x-2,n.y+this.box_eff.y+106)}return void this.playEff()}this.showModel(this._effnum)}else this.playCardModelTurn(this._effnum),Laya.timer.once(240,this,function(t,e){i.showGodItem(t,e)},[this._effnum,t]),clearTimeout(this._efftag),this._efftag=setTimeout(function(){i.playEff()},250);this._effnum++}},e.prototype.onAniComplete=function(){},e.prototype.setBtn=function(){var t=this,e=tb.TB_god_employ_set.get_TB_god_employ_setnById(1),i=u.ZhaohuanModel.getInstance().curObj;if(-1!=i.type){var n=0,o=0;if(i.type==u.ZHAOHUAN.GENERAL&&(n=App.hero.getBagItemNum(CostTypeKey.weizhi_zhaohuanshu),this.img_skin.skin=SkinUtil.putong,o=i.isOne?1:10),i.type==u.ZHAOHUAN.FRIENDSHIP&&(n=App.hero.friend,o=i.isOne?e.friend_cost:10*e.friend_cost,this.img_skin.skin=SkinUtil.getCostSkin(iface.tb_prop.resTypeKey.friend)),i.type==u.ZHAOHUAN.DIAMOND){var a=App.hero.getBagItemNum(CostTypeKey.shenmi_zhaohuanshu),r=tb.TB_god_employ_set.get_TB_god_employ_setnById(1),s=SkinUtil.getCostSkin(iface.tb_prop.resTypeKey.diamond);n=App.hero.diamond,o=i.isOne?r.zuanshi_once:r.zuanshi_ten,i.isOne?a>=r.zuanshi_once_priority[1]&&(n=a,s=SkinUtil.danchou,o=r.zuanshi_once_priority[1]):a>=r.zuanshi_ten_priority[1]&&(n=a,s=SkinUtil.danchou,o=r.zuanshi_ten_priority[1]),this.img_skin.skin=s}i.type==u.ZHAOHUAN.LEGEND&&(this.img_skin.skin=SkinUtil.chuanshuo,n=App.hero.legendChip,o=e.special_employ[1]),this.btn_again.label=i.type==u.ZHAOHUAN.LEGEND||i.isOne?LanMgr.getLan("",12106):LanMgr.getLan("",12107),this.lab_has.color=Number(n)>=Number(o)?ColorConst.WHITE:"#f62e08",this.lab_has.stroke=Number(n)>=Number(o)?0:2,this.lab_has.text=Snums(Number(n)),this.lab_need.text=" / "+o,this.lab_has.event(Laya.Event.RESIZE),this.box_btn.timerOnce(300,this,function(){t.box_btn.visible=!0,dispatchEvt(new u.SummonEvent(u.SummonEvent.SHOW_BTN_VISIBLE_TRUE))})}else this.lab_txt.timerOnce(1e3,this,function(){t.lab_txt.visible=!0,dispatchEvt(new u.SummonEvent(u.SummonEvent.SHOW_BTN_VISIBLE_TRUE))})},e.prototype.onAgain=function(){var t=this,e=u.ZhaohuanModel.getInstance().curObj,i=e.isOne?1:10;if(App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum)<=u.GodUtils.getGodsNum()+i){var n=LanMgr.getLan("",10226);common.AlertBox.showAlert({text:n,confirmCb:function(){t.close(),dispatchEvt(new u.FenjieEvent(u.FenjieEvent.SHOW_FENJIE_VIEW))}})}else dispatchEvt(new u.SummonEvent(u.SummonEvent.SEND_ZHAOHUAN),{isOne:e.isOne,type:e.type,again:1})},e.prototype.onSelect=function(t){if(-1!=t){this._curIdx=t;var e=this.dataSource.godlist[this._curIdx],i=e.tab_god;this.drawListView(i,e)}},e.prototype.showModel=function(t){this.box_eff.visible=!1;var e=this.dataSource.godlist[t],i=e.tab_god;this.drawListView(i,e),this.addModelEff()},e.prototype.clearModel=function(){this.box_eff.visible=!0,this.box_box.visible=!1,this.uiScene.clearSceneChar(),this.removeModelEff(),Laya.timer.clearAll(this),Laya.Tween.clearAll(this)},e.prototype.onClickHideModel=function(){this.box_box.visible&&(this.clearModel(),this.playEff())},e.prototype.drawListView=function(t,e){var i=this;this.lab_name.text=t.name;for(var n=6<=e.starLevel?e.starLevel-5:e.starLevel,o=new Array,a=0;a<n;a++)o[a]=6<=e.starLevel;this.list_stars.array=o,this.list_stars.width=30+30*o.length+this.list_stars.spaceX*(o.length-1),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),this.list_stars.visible=!1,5<=e.starLevel?Laya.timer.once(1e3,this,function(){var t=i.list_stars.cells;t.forEach(function(t,e){t.visible=!1}),i.list_stars.visible=!0;for(var e=0;e<t.length;e++)Laya.timer.once(200*e,i,function(t,e){t.scale(2,2),t.visible=!0,Laya.Tween.to(t,{scaleX:1,scaleY:1},200)},[t[e],e])}):this.list_stars.visible=!0,this.setModel(t.model),this.uiScene.sceneChar.alpha=0,Laya.Tween.to(this.uiScene.sceneChar,{alpha:1},2e3)},e.prototype.setModel=function(t){this.box_box.visible=!0,this.uiScene.addModelChar(t,360,900),this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_01,2)},e.prototype.onRenderStar=function(t,e){if(!(e>this.list_stars.array.length)){t.scale(1,1);var i=this.list_stars.array[e];t.skin=i?SkinUtil.superXing:SkinUtil.xingxing}},e.prototype.isCanClose=function(){return this.box_btn.visible||this.lab_txt.visible},e.prototype.showGodItem=function(t,e){this._uiGodItem&&(t<0||t>=this._uiGodItem.length||(this._uiGodItem[t].dataSource=e,this._uiGodItem[t].visible=null!=e))},e.prototype.hideUiGodItem=function(){if(this._uiGodItem)for(var t=0;t<this._uiGodItem.length;t++){var e=this._uiGodItem[t];e&&(e.visible=!1,e.dataSource=null)}},e.prototype.addCardModel=function(t,e,i,n){void 0===i&&(i=180),void 0===n&&(n=1.1);var o=new GameUIChar;this.uiScene.scene.addMovieDisplay(o),o.setRoleUrl(getRoleUrl("100002")),o.play(tl3d.CharAction.STANAD),o.forceRotationY=i,o.set2dPos(t,e),o.scale=n,this._cardModels.push(o)},e.prototype.playCardModelTurn=function(t){var i=this;if(void 0===t&&(t=-1),this._cardModels&&0!=this._cardModels.length)if(t<0||t>=this._cardModels.length)this._cardModels.forEach(function(t,e){i.charPlaySkill(t,function(){i.uiScene.removeModelChar(t)})});else{var e=this._cardModels[t];this.charPlaySkill(e,function(){i.uiScene.removeModelChar(e)})}},e.prototype.clearCardModel=function(){if(this._cardModels&&0!=this._cardModels.length){for(var t=0;t<this._cardModels.length;t++){var e=this._cardModels[t];this.uiScene.removeModelChar(e)}this._cardModels=[]}},e.prototype.charPlaySkill=function(t,e){var i=this;void 0===e&&(e=null),this._guajiskill=this.uiScene.scene.skillMgr.getSkill(getSkillUrl("100002"),"skill_01",function(){i.charPlaySkill(t,e)}),this._guajiskill.keyAry&&(this._guajiskill&&(this._guajiskill.reset(),this._guajiskill.isDeath=!1),t&&t.onStage&&(this._guajiskill.configFixEffect(t,e),this._guajiskill.needShock=!1,this.uiScene.scene.skillMgr.playSkill(this._guajiskill)))},e.prototype.onChkJump=function(){u.ZhaohuanModel.getInstance().jumpAni=this.chk_jump.selected},e.prototype.close=function(){i.prototype.close.call(this,"",!1),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),this.chk_jump.off(Laya.Event.CHANGE,this,this.onChkJump);var t=this.uiScene.sceneChar;t&&(t.alpha<1&&(t.alpha=1),Laya.Tween.clearTween(t)),this.removeEff(),this.uiScene.onExit()},e.prototype.onClosed=function(t){i.prototype.onClosed.call(this,t),this.box_btn.visible=!1,this.lab_txt.visible=!1,this.off(Laya.Event.CLICK,this,this.onClickHideModel),this.clearModel(),this.removeModelEff(),clearTimeout(this._efftag),this.clearCardModel()},e);function e(){var t=i.call(this)||this;return t._ui=UIMgr.getInstance(),t._isShowModel=!1,t._hasModelEff=!1,t._cardModels=[],t.btn_leftpage.on(Laya.Event.CLICK,t,function(){}),t.btn_rightpage.on(Laya.Event.CLICK,t,function(){}),t.uiScene=new Base2dSceneLayer,t.addChildAt(t.uiScene,1),t.uiScene.setModelBox(t,t.list_stars,t.lab_name),t.list_stars.renderHandler=new Handler(t,t.onRenderStar),t.btn_sure.on(Laya.Event.CLICK,t,t.close),t.btn_again.on(Laya.Event.CLICK,t,t.onAgain),t.img_tipbg.on(Laya.Event.CLICK,t,function(){t.lab_txt.visible&&t.close()}),t.img_tipbg.skin=SkinUtil.getSysMapSkin(ModuleConst.SUMMON,1),t}u.ZhaohuanResultView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.zhaohuan.render.ZhaohuanIRUI,__extends(i,e),i.prototype.onClick=function(t){var e=t.target,i=a.ZhaohuanModel.getInstance().curObj;i.type=this.dataSource.type,i.isOne="one"==e.name,i.type==a.ZHAOHUAN.LEGEND&&(i.isOne=!0);var n=i.isOne?1:10;if(App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum)<a.GodUtils.getGodsNum()+n){var o=LanMgr.getLan("",10226);common.AlertBox.showAlert({text:o,confirmCb:function(){dispatchEvt(new a.FenjieEvent(a.FenjieEvent.SHOW_FENJIE_VIEW))}})}else dispatchEvt(new a.SummonEvent(a.SummonEvent.SEND_ZHAOHUAN),{isOne:"one"==e.name,type:this.dataSource.type})},Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){if(this.dataSource){this.red_one.onDispose(),this.red_ten.onDispose();var t=this.dataSource.type;switch(this.imgBg.skin=SkinUtil.getZhaohuanIcon(t),this.boxTip.visible=t==a.ZHAOHUAN.DIAMOND,this.lbChuansuo.visible=!1,this.box_ten.x=249,t){case a.ZHAOHUAN.GENERAL:this.drawGeneral();break;case a.ZHAOHUAN.FRIENDSHIP:this.drawFriendship();break;case a.ZHAOHUAN.DIAMOND:this.drawDiamong();break;case a.ZHAOHUAN.LEGEND:this.drawLegend()}}},i.prototype.setTime=function(t){this.lab_time.visible=0<t.length,this.lab_time.text=t},i.prototype.drawGeneral=function(){this.boxOne.x=280,this.box_ten.x=480;var t=0==App.hero.getlimitValue(iface.tb_prop.limitTypeKey.propFreeNum);this.lab_upone.visible=!t,this.img_upone.visible=!t,this.txt_num.text=""+Snums(App.hero.getBagItemNum(CostTypeKey.weizhi_zhaohuanshu)),this.lbl_one.text=LanMgr.getLan("",10511),this.lbl_one.color="#00c828",this.lbl_one.x=66,t||(this.img_upone.skin=SkinUtil.putong,this.lab_upone.text="X1",this.lbl_one.text="1"+LanMgr.getLan("",12108),this.lbl_one.color="#ffedbb",this.lbl_one.x=85),this.lbten.text="10"+LanMgr.getLan("",12108),this.img_upten.skin=SkinUtil.putong,this.lab_upten.text="X10",this.red_one.setRedPointName("summon_weizhi1"),this.red_ten.setRedPointName("summon_weizhi10")},i.prototype.drawFriendship=function(){this.txt_num.text=""+Snums(App.hero.friend),this.boxOne.x=280,this.lbl_one.text="1"+LanMgr.getLan("",12108),this.lbl_one.color="#ffedbb",this.lbl_one.x=85;var t=tb.TB_god_employ_set.get_TB_god_employ_setnById(1);this.img_upone.skin=this.img_upten.skin=SkinUtil.getCostSkin(iface.tb_prop.resTypeKey.friend),this.lab_upone.text="X"+t.friend_cost,this.lbten.text="10"+LanMgr.getLan("",12108),this.box_ten.x=480,this.lab_upten.text="X"+10*t.friend_cost,this.red_ten.setRedPointName("summon_friend10")},i.prototype.drawDiamong=function(){this.boxOne.x=280,this.box_ten.x=480,this.txt_num.text=""+Snums(App.hero.getBagItemNum(CostTypeKey.shenmi_zhaohuanshu));var t=tb.TB_god_employ_set.get_TB_god_employ_setnById(1),e=App.hero.getBagItemNum(CostTypeKey.shenmi_zhaohuanshu),i=SkinUtil.getCostSkin(iface.tb_prop.resTypeKey.diamond),n=SkinUtil.getCostSkin(iface.tb_prop.resTypeKey.diamond),o=t.zuanshi_ten,a=t.zuanshi_once;e>=t.zuanshi_once_priority[1]&&(a=t.zuanshi_once_priority[1],i=SkinUtil.danchou),e>=t.zuanshi_ten_priority[1]&&(o=t.zuanshi_ten_priority[1],n=SkinUtil.danchou);var r=0==App.hero.getlimitValue(iface.tb_prop.limitTypeKey.diamondFreeNum);this.lab_upone.visible=!r,this.img_upone.visible=!r,this.lbl_one.text=LanMgr.getLan("",10511),this.lbl_one.color="#00c828",this.lbl_one.x=66,r||(this.img_upone.skin=i,this.lab_upone.text="X"+a,this.lbl_one.text="1"+LanMgr.getLan("",12108),this.lbl_one.color="#ffedbb",this.lbl_one.x=85),this.lbten.text="10"+LanMgr.getLan("",12108),this.img_upten.skin=n,this.lab_upten.text="X"+o,this.red_one.setRedPointName("summon_shenmi1"),this.red_ten.setRedPointName("summon_shenmi10"),this.lab_talk0.text=App.hero.getFirstUse(iface.tb_prop.firstTypeKey.godEmploy)?LanMgr.getLan("",12109):LanMgr.getLan("",12110),this.lab_talk1.text=App.hero.getFirstUse(iface.tb_prop.firstTypeKey.godEmploy)?LanMgr.getLan("",12111):LanMgr.getLan("",12112)},i.prototype.drawLegend=function(){this.btn_one.visible=!1,this.lbl_one.visible=!1,this.lab_upone.visible=!1,this.img_upone.visible=!1,this.lbten.text="1"+LanMgr.getLan("",12108),this.box_ten.x=480,this.txt_num.text=""+Snums(App.hero.legendChip);var t=tb.TB_god_employ_set.get_TB_god_employ_setnById(1);this.img_upten.skin=SkinUtil.chuanshuo,this.lab_upten.text="X"+t.special_employ[1],this.red_ten.setRedPointName("summon_legend"),this.lbten.visible=App.hero.levelPrivilege(iface.tb_prop.levelPrivilegeTypeKey.legendEmploy),this.lbChuansuo.visible=!App.hero.levelPrivilege(iface.tb_prop.levelPrivilegeTypeKey.legendEmploy)},i);function i(){var t=e.call(this)||this;return t.btn_one.on(Laya.Event.CLICK,t,t.onClick),t.btn_ten.on(Laya.Event.CLICK,t,t.onClick),t.lab_time.visible=!1,t}a.ZhaohuanIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.zhaohuan.render.ZhaohuanBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){!this._dataSource&&t&&(this.visible=!1),this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){this._dataSource?(this.ui_card.dataSource=this._dataSource,4<this._dataSource.getStar()?(Laya.timer.loop(1,this,this.update),this._startTime=Laya.timer.currTimer,this.update()):(this.ui_card.filters=null,Laya.timer.clear(this,this.update))):(this.visible=!1,this.ui_card.dataSource=null,Laya.timer.clear(this,this.update))},n.prototype.update=function(){var t=Laya.timer.currTimer-this._startTime;t<0&&(t=0);var e=0,i=n.TURN_TIME/2;e=i<(t%=n.TURN_TIME)?(n.TURN_TIME-t)/i:t/i,this._glowFilter.blur=n.BLUR_MIN+(n.BLUR_MAX-n.BLUR_MIN)*e,this.ui_card.filters=[this._glowFilter]},n.BLUR_MIN=3,n.BLUR_MAX=16,n.TURN_TIME=1200,n);function n(){var t=e.call(this)||this;return t._startTime=0,t._glowFilter=new Laya.GlowFilter("#ffff00",16,-1.5,-1.5),t}t.ZhaohuanBoxIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var o,t=(o=ui.uproad.UpRoadViewUI,__extends(e,o),e.prototype.createChildren=function(){o.prototype.createChildren.call(this)},e.prototype.show=function(t,e){o.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){o.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(t,e,i){void 0===i&&(i=!0),o.prototype.close.call(this),tl3d.ModuleEventManager.removeEvent(n.UpRoadEvent.UR_LEVEL_CHANGE,this.onUpRoadChange,this),tl3d.ModuleEventManager.removeEvent(n.UpRoadEvent.UR_COUNT_CHANGE,this.onConditionChange,this),tl3d.ModuleEventManager.removeEvent(n.UpRoadEvent.UR_REWARD_CHANGE,this.onConditionChange,this),this.btn_close.off(Laya.Event.CLICK,this,this.close),this.list_UR.selectHandler&&(this.list_UR.selectHandler.recover(),this.list_UR.selectHandler=null),this.uiScene.onExit(),this.stopTaskEff(),this.list_UR.array=null,this.list_URReward.array=null,this.list_URTask.array=null,this.ui_showitem.dataSource=null,this._allAdvanceRoadTs=[],this._curAdvanceRoadT=null,this._curURIdx=-1,this._lastmodel=-1},e.prototype.onClosed=function(t){o.prototype.onClosed.call(this)},e.prototype.initView=function(){tl3d.ModuleEventManager.addEvent(n.UpRoadEvent.UR_LEVEL_CHANGE,this.onUpRoadChange,this),tl3d.ModuleEventManager.addEvent(n.UpRoadEvent.UR_COUNT_CHANGE,this.onConditionChange,this),tl3d.ModuleEventManager.addEvent(n.UpRoadEvent.UR_REWARD_CHANGE,this.onConditionChange,this),this.list_UR.selectHandler=Handler.create(this,this.onURSelect,null,!1),this.btn_close.on(Laya.Event.CLICK,this,this.close),this._allAdvanceRoadTs=this.getAllAdvanceRoadT(),this._maxURLv=this._allAdvanceRoadTs.length,this._curURLv=App.hero.tasks.advanceLevel;var t=this.dataSource?this.dataSource:this._curURLv;this.updateURList(),this.onURSelect(t,!0),this.list_UR.scrollTo(t-1)},e.prototype.getAllAdvanceRoadT=function(){var t=[],e=TableData.getInstance().getTableByName(TableData.tb_advance_road).data;if(e)for(var i in e)t.push(e[i]);return t},e.prototype.onUpRoadChange=function(){this._curURLv=App.hero.tasks.advanceLevel,this.list_UR.refresh(),this.onURSelect(this._curURLv,!0),this.list_UR.scrollTo(this._curURLv)},e.prototype.onConditionChange=function(){this.list_URTask.refresh()},e.prototype.updateURList=function(){this.list_UR.array=this._allAdvanceRoadTs},e.prototype.onURSelect=function(t,e){void 0===e&&(e=!1),t>=this._maxURLv&&(t=this._maxURLv-1),t==this._curURIdx&&!e||(this._curURIdx=t,this._curAdvanceRoadT=this._allAdvanceRoadTs[t],this.list_UR.selectedIndex=t,this.showUR())},e.prototype.showUR=function(){this.updateURReward(),this.updateShow(),this.updateURTaskList(),Laya.timer.callLater(this,this.playTaskEff)},e.prototype.updateURReward=function(){this._curAdvanceRoadT&&(this.list_URReward.array=ary2prop(this._curAdvanceRoadT.reward),this.list_URReward.repeatX=this.list_URReward.array.length,this.list_URReward.x=(this.width-this.list_URReward.width)/2)},e.prototype.updateShow=function(){if(this.lab_propname.visible=this.lab_artifaceinfo.visible=this.lab_artifacename.visible=!1,this._curAdvanceRoadT){var t=this._curAdvanceRoadT.show.split(",");if(1<t.length){var e=parseInt(t[1]);if("1"==t[0]){var i=tb.TB_artifact.get_TB_artifactById(e);this.uiScene.onShow(),this.refreshModel(i.model),this.box_showitem.visible=!1,this.ui_showitem.dataSource=null,this.lab_artifaceinfo.visible=this.lab_artifacename.visible=!0,this.lab_artifacename.text=i.name,this.lab_artifaceinfo.text=i.desc}else{this.uiScene.onExit(),this._lastmodel=-1,this.box_showitem.visible=!0;var n=tb.TB_item.get_TB_itemById(e);this.ui_showitem.dataSource=new ItemVo(e,1),n.type==iface.tb_prop.itemTypeKey.treasure&&(this.lab_propname.visible=!0,this.lab_propname.text=""+LanMgr.qualityColor[n.quality]+LanMgr.getLan("",12113)+"-"+n.name)}}}},e.prototype.refreshModel=function(t){if(this._lastmodel!=t){var e=this._modelpos[t]?this._modelpos[t]:[0,520,180,2.25,0];this.uiScene.addModelChar(t+"",360+Number(e[0]),Number(e[1])+120,Number(e[2]),.8*Number(e[3]),Number(e[4])),this._lastmodel=t}},e.prototype.updateURTaskList=function(){this._curAdvanceRoadT&&this._curAdvanceRoadT.ID<=this._curURLv+1?(this.list_URTask.array=this._curAdvanceRoadT.getCondition(),this.box_lock.visible=!1,this.list_URTask.visible=!0):(this.list_URTask.array=null,this.list_URTask.visible=!1,this.box_lock.visible=!0)},e.prototype.playTaskEff=function(){if(this.stopTaskEff(),this.list_URTask.cells)for(var t=(Laya.stage.width-this.width)/2,e=0;e<this.list_URTask.cells.length;e++){var i=this.list_URTask.cells[e],n=0;i.x=-t-this.width;var o=0;e%2==0?o=100:(n=i.width+this.list_URTask.spaceX,this.PlayTaskTween(i,n)),o+=50*Math.floor(e/2),Laya.timer.once(o,i,this.PlayTaskTween,[i,n])}},e.prototype.PlayTaskTween=function(t,e){Laya.Tween.to(t,{x:e},350,Laya.Ease.sineInOut)},e.prototype.stopTaskEff=function(){if(this.list_URTask.cells)for(var t=0;t<this.list_URTask.cells.length;t++){var e=this.list_URTask.cells[t];Laya.Tween.clearAll(e),Laya.timer.clear(e,this.PlayTaskTween)}},e);function e(){var t=o.call(this)||this;return t._maxURLv=0,t._curURLv=0,t._curURIdx=-1,t._modelpos={1:[0,520,180,2.25,0],2:[125,565,180,2,45],3:[150,600,180,2,45],4:[125,560,180,1.8,45],6:[125,560,180,1.62,45]},t.isModelClose=!0,t.uiScene=new Base2dSceneLayer,t.addChildAt(t.uiScene,8),t}n.UpRoadView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.uproad.UpRoadTaskIRUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refresh()},enumerable:!0,configurable:!0}),i.prototype.refresh=function(){var t=this.dataSource;if(t){this.btn_receive.on(Laya.Event.CLICK,this,this.onClickReceive);var e=tb.TB_advance_condition.getAdvanceLevel(t.ID);if(this._curURLv=App.hero.tasks.advanceLevel,e>this._curURLv+1)return this.lab_title.text="",this.lab_has.text="",this.lab_need.text="",this.list_reward.dataSource=null,this.btn_receive.visible=!1,this.img_hasreceive.visible=!1,this.list_reward.visible=!1,void(this.ui_red.visible=!1);var i=App.hero.tasks.advanceInfos[t.ID].count?App.hero.tasks.advanceInfos[t.ID].count:0,n=t.num,o=App.hero.tasks.advanceInfos[t.ID].reward&&0<App.hero.tasks.advanceInfos[t.ID].reward;if(this.lab_title.text=t.name,this.list_reward.dataSource=ary2prop(t.reward),this.list_reward.visible=!0,o)this._curStatu=2,this.img_hasreceive.visible=!0,this.btn_receive.visible=!1,this.ui_red.visible=!1,this.lab_has.text=LanMgr.getLan("",11006),this.lab_has.color="#319c28",this.lab_need.text="(       )";else if(n<=i)this._curStatu=1,this.img_hasreceive.visible=!1,this.btn_receive.visible=!0,this.ui_red.visible=!0,this.btn_receive.label=LanMgr.getLan("",10041),this.btn_receive.skin="comp/button/btn_qianwang.png",this.btn_receive.labelStrokeColor="#538901",this.lab_has.text=LanMgr.getLan("",11006),this.lab_has.color="#319c28",this.lab_need.text="(       )";else if(this._curStatu=0,this.img_hasreceive.visible=!1,this.btn_receive.visible=!0,this.ui_red.visible=!1,this.btn_receive.label=LanMgr.getLan("",10042),this.btn_receive.skin="comp/button/button.png",this.btn_receive.labelStrokeColor="#ca7005",this.lab_has.color="#ff0000",1==n)this.lab_has.text=LanMgr.getLan("",10045),this.lab_need.text="(           )";else{this.lab_has.text=i.toString();var a=9<i?"(    /{0})":"(  /{0})";this.lab_need.text=LanMgr.getLan(a,-1,n)}this.lab_need.x=this.lab_title.x+this.lab_title.width+3,this.lab_has.x=this.lab_need.x+8}else this.list_reward.dataSource=null,this.btn_receive.off(Laya.Event.CLICK,this,this.onClickReceive)},i.prototype.onClickReceive=function(){if(1==this._curStatu){var i=this,t={};t[Protocol.game_task_getAdvanceReward.args.id]=this.dataSource.ID,PLC.request(Protocol.game_task_getAdvanceReward,t,function(t,e){t&&(null!=t.advanceLevel&&t.advanceLevel>i._curURLv?UIMgr.showUI(UIConst.UpRoadSuccessView,[t.advanceLevel,t.commonData]):UIUtil.showRewardView(t.commonData),dispatchEvt(new n.UpRoadEvent(n.UpRoadEvent.REWARD_SUCCESS)))})}else 2==this._curStatu||dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_MODULE_VIEW,this.dataSource.link))},i.prototype.destroy=function(t){void 0===t&&(t=!0),this.btn_receive.off(Laya.Event.CLICK,this,this.onClickReceive),e.prototype.destroy.call(this,t)},i);function i(){var t=e.call(this)||this;return t._curStatu=0,t.htmltext.style.fontSize=20,t.htmltext.style.color="#7e5336",t.htmltext.style.bold=!0,t.htmltext.style.wordWrap=!1,t}n.UpRoadTaskIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.uproad.UpRoadTabIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refresh()},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){var t=this.dataSource;if(t){var e=App.hero.tasks.advanceLevel;this.img_icon.gray=t.ID>e+1,this.img_icon.skin=LanMgr.getLan("zhaohuanshi/{0}.png",-1,t.ID),this.ani_select.loadAnimation(ResConst.anim_circle_select,Handler.create(this,function(){this.ani_select.play()}),ResConst.atlas_circle_select)}else this.ani_select.gotoAndStop(0)},n.prototype.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t)},n);function n(){return e.call(this)||this}t.UpRoadTabIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=ui.uproad.UpRoadSuccesssViewUI,__extends(i,n),i.prototype.createChildren=function(){n.prototype.createChildren.call(this)},i.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},i.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},i.prototype.close=function(t,e,i){void 0===i&&(i=!0),this.ShowReward(),n.prototype.close.call(this),this.bgPanel.dataSource=null,this.btn_close.off(Laya.Event.CLICK,this,this.close)},i.prototype.onClosed=function(t){n.prototype.onClosed.call(this)},i.prototype.ShowReward=function(){if(this.dataSource&&1<this.dataSource.length){var t=this.dataSource[1],e=UIUtil.getRewardItemList(t);ShowRewardUtil.showRewardView(e,0,0)}},i.prototype.initView=function(){this.bgPanel.dataSource={uiName:UIConst.TujianView,closeOnSide:!1,title:"comp/title/gongxijihuo.png"},this.btn_close.on(Laya.Event.CLICK,this,this.close);var t=this.dataSource[0];this._curAdvanceRoadT=tb.TB_advance_road.getSet(t),this.img_icon.skin=LanMgr.getLan("zhaohuanshi/{0}.png",-1,t),this._curAdvanceRoadT&&(this.lab_desc.text=this._curAdvanceRoadT.desc)},i);function i(){var t=n.call(this)||this;return t.isModelClose=!1,t.bgPanel.addChildAt(t.img_bg,3),t}t.UpRoadSuccessView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.uproad.UpRoadEntranceUI,__extends(n,i),n.prototype.show=function(){tl3d.ModuleEventManager.addEvent(e.UpRoadEvent.UR_REWARD_CHANGE,this.onConditionChange,this),tl3d.ModuleEventManager.addEvent(e.UpRoadEvent.UR_LEVEL_CHANGE,this.onUpRoadChange,this),this.on(Laya.Event.CLICK,this,this.onclick),this.ui_red.setRedPointName("uproad_red"),this._curURLv=App.hero.tasks.advanceLevel,this._maxLv=tb.TB_advance_road.getMaxLevel();var t=this._curURLv>=this._maxLv?this._maxLv:this._curURLv+1;this._curAdvanceRoadT=tb.TB_advance_road.getSet(t),this.updateLevel()},n.prototype.onConditionChange=function(){this.updateProgress()},n.prototype.onUpRoadChange=function(){var t=App.hero.tasks.advanceLevel;if(t!=this._curURLv){this._curURLv=t;var e=this._curURLv>=this._maxLv?this._maxLv:this._curURLv+1;this._curAdvanceRoadT=tb.TB_advance_road.getSet(e),this.updateLevel()}},n.prototype.updateLevel=function(){this._curAdvanceRoadT&&(this.imgIcon.skin=LanMgr.getLan("zhaohuanshi/{0}.png",-1,this._curAdvanceRoadT.ID),this.updateProgress())},n.prototype.updateProgress=function(){if(this._curAdvanceRoadT){var t=this.getCompleteNum(),e=this._curAdvanceRoadT.condition.length;this.lab_pro.text=LanMgr.getLan("{0}/{1}",-1,t,e),this.pro_value.value=t/e}},n.prototype.getCompleteNum=function(){if(!this._curAdvanceRoadT)return 0;for(var t=0,e=App.hero.tasks.advanceInfos,i=0;i<this._curAdvanceRoadT.condition.length;i++){var n=this._curAdvanceRoadT.condition[i];e[n]&&e[n].reward&&0<e[n].reward&&t++}return t},n.prototype.onclick=function(){UIMgr.showUI(UIConst.UpRoadView)},n.prototype.close=function(){tl3d.ModuleEventManager.removeEvent(e.UpRoadEvent.UR_REWARD_CHANGE,this.onConditionChange,this),tl3d.ModuleEventManager.removeEvent(e.UpRoadEvent.UR_LEVEL_CHANGE,this.onUpRoadChange,this),this.off(Laya.Event.CLICK,this,this.onclick),this.ui_red.onDispose(),this._curAdvanceRoadT=null,this.imgIcon.skin="",this.pro_value.value=0,this.lab_pro.text=""},n.prototype.destroy=function(t){void 0===t&&(t=!0),i.prototype.destroy.call(this,t)},n);function n(){var t=i.call(this)||this;return t._maxLv=0,t.imgIcon.skin="",t.pro_value.value=0,t.lab_pro.text="",t}e.UpRoadEntrance=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Processor,__extends(n,e),n.prototype.getName=function(){return"UpRoadProcessor"},n.prototype.listenModuleEvents=function(){return[]},n.prototype.receivedModuleEvent=function(t){},n);function n(){return e.call(this)||this}t.UpRoadProcessor=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"UpRoadModule"},n.prototype.listProcessors=function(){return[new t.UpRoadProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.UpRoadModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.UR_LEVEL_CHANGE="UR_LEVEL_CHANGE",r.UR_COUNT_CHANGE="UR_COUNT_CHANGE",r.UR_REWARD_CHANGE="UR_REWARD_CHANGE",r.REWARD_SUCCESS="UPROAD_REWARD_SUCCESS",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.UpRoadEvent=a}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.tujian.TujianViewUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.TujianView,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12117)},this.tab.selectHandler=new Handler(this,this.onTab),this.tab.selectedIndex=-1,this.list_tujian.mouseHandler=new Handler(this,this.onMouse),this.list_race.selectHandler=new Handler(this,this.onSelect),this.list_race.array=[0,1,2,3,4,5],this.list_race.selectedIndex=-1},e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this),this.tab.selectedIndex=-1,this.list_tujian.array=null,this.list_race.selectedIndex=-1,this.tuijianView.onExit(),this.ui_tujian.onExit(),this._allTuJianGodTemps=null},e.prototype.onClosed=function(t){n.prototype.onClosed.call(this)},e.prototype.initView=function(){if(!this._allTuJianGodTemps||0==this._allTuJianGodTemps.length){var t=i.TujianModel.getInstance().getTuJianGodTArr();this._allTuJianGodTemps=t.filter(function(t){return t.starLv==t.godTemp.star[0]||t.starLv==t.godTemp.star[1]||5==t.starLv||6==t.starLv})}this.tab.selectedIndex=0},e.prototype.onTab=function(t){-1!=t&&(0==(this.viewstack.selectedIndex=t)?(this.tuijianView.onExit(),this.ui_tujian.onExit(),this.list_race.selectedIndex=-1==this.list_race.selectedIndex?0:this.list_race.selectedIndex):1==t?(this.ui_tujian.onExit(),this.tuijianView.onShow()):2==t&&(this.tuijianView.onExit(),i.FateModel.getInstance().initFateList(),this.ui_tujian.onShow()),this.imgBg.visible=0!=t)},e.prototype.onSelect=function(e){var t;-1!=e&&(t=this._allTuJianGodTemps.filter(function(t){return 0==e||t.godTemp.race_type==e}),this.list_tujian.array=t,this.lbType.text=LanMgr.GOD_RACE_NAME[e])},e.prototype.onMouse=function(t,e){t.type==Laya.Event.CLICK&&dispatchEvt(new i.TujianEvent(i.TujianEvent.SHOW_XIANGXI_PANEL),[e,this.list_tujian.array])},e);function e(){return n.call(this)||this}i.TujianView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.tujian.render.TujianIRUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(tl3d.ModuleEventManager.addEvent(e.GodEvent.GOD_MAX_STAR_LV_CHANGE,this.onMaxStarLvChange,this),this._starLv=t instanceof GodItemVo?t.starLevel:t.starLv,this._godTemp=t instanceof GodItemVo?t.tab_god:t.godTemp,this.lbl_name.text=this._godTemp.name,this.lbl_name.color=ColorConst.getTujianNameColor(this._starLv),this.heroSkin=SkinUtil.getBigIconById(this._godTemp.icon),this.img_icon.skin=this.heroSkin,ResUseMgr.isExistRes(this.heroSkin)||ResUseMgr.useRes([this.heroSkin]),this.img_kuang.skin=SkinUtil.getTujianKuang(5<this._starLv?5:this._starLv),this.img_race.skin=SkinUtil.getTujianRace(this._godTemp.race_type),this.box_star.starLevel=this._starLv,this.onMaxStarLvChange()):(this.heroSkin&&ResUseMgr.isExistRes(this.heroSkin)&&ResUseMgr.releaseRes([this.heroSkin]),this.img_icon.skin="",this._godTemp=null,this._starLv=0,tl3d.ModuleEventManager.removeEvent(e.GodEvent.GOD_MAX_STAR_LV_CHANGE,this.onMaxStarLvChange,this),this.heroSkin=null)},n.prototype.onMaxStarLvChange=function(){!this._godTemp||this._starLv<1?this.gray=!0:this.gray=this.dataSource instanceof e.TuJianGodTemp&&!e.GodUtils.isActiveGodStarLv(this._godTemp.ID,this._starLv)},n);function n(){var t=i.call(this)||this;return t._starLv=0,t}e.TujianIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var n,t=(n=ui.tujian.TujianHeroUI,__extends(i,n),i.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.uiScene=new Base2dSceneLayer,this.boxRole.addChild(this.uiScene),this.uiScene.setModelBox(this,this.lab_name,this.lbType),this.skillList.array=null,this.skillList.mouseHandler=new Handler(this,this.onSkillClick),this.skillBox.visible=!1,this.skillBox.dataSource=null,this.ui_star.starAlign=common.GodStarInfo.STAR_ALIGN_LEFT,this.btn_peiyin.on(Laya.Event.CLICK,this,this.onClickPeiYin),this.btn_lihui.on(Laya.Event.CLICK,this,this.onClickLiHui),this.btnZiliao.on(Laya.Event.CLICK,this,this.onLookInfo)},i.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.init()},i.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.init()},i.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this),this.uiScene.onExit(),this._lastmodel=null,this.skillList.array=null,this.skillBox.visible=!1,this.skillBox.dataSource=null,this._arrTotalGods=[],Laya.timer.clearAll(this),Laya.stage.off(Laya.Event.CLICK,this,this.onClickStage)},i.prototype.init=function(){this.btnPrev.on(Laya.Event.CLICK,this,this.onLeft),this.btnNext.on(Laya.Event.CLICK,this,this.onRight),this.btnClose.on(Laya.Event.CLICK,this,this.onFanHui),this.btnSkin.on(Laya.Event.CLICK,this,this.onSkin),Laya.stage.on(Laya.Event.CLICK,this,this.onClickStage),this.uiScene.onShow(),this._curGodsindex=this.dataSource[0],this._arrTotalGods=this.dataSource[1],Laya.timer.frameOnce(3,this,this.updatedata,[this._curGodsindex,this._arrTotalGods])},i.prototype.onLookInfo=function(){var t=this._arrTotalGods[this._curGodsindex].godTemp;t&&dispatchEvt(new e.TujianEvent(e.TujianEvent.SHOW_EVALUATION_PANEL),t)},i.prototype.onClickLiHui=function(){var t=this._arrTotalGods[this._curGodsindex].godTemp;t&&t&&0!=t.paint&&UIMgr.showUI(UIConst.GodLiHuiView,t)},i.prototype.onClickPeiYin=function(){var t=this._arrTotalGods[this._curGodsindex].godTemp;t&&(this.playPySound(t.ID,"",!0),this.uiScene.sceneChar&&this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_01,2))},i.prototype.updatedata=function(t,e){this.skillBox.visible=!1,this.skillBox.dataSource=null,this._curGodsindex=t;var i=(this._arrTotalGods=e)[t].godTemp;if(i){this.btn_lihui.visible=0<i.paint,this.lbDesc.text="        "+i.desc,this.imgRace.skin=SkinUtil.getGodBigRaceSkin(i.race_type);var n=tb.TB_god_evolution.get_TB_god_evolutionById(e[t].starLv).level;this.lab_name.text="Lv."+n+"  "+i.name,this.lab_name.event(Laya.Event.RESIZE),this.lbType.text=LanMgr.godTypeName[i.type];var o=e[t].starLv;this.ui_star.starLevel=o,this.ui_star.x=this.width/2-this.ui_star.getTotalStarWidth()/2,new Array,this.refreshModel(i.model),this.btnPrev.gray=0==t,this.btnNext.gray=t>=e.length-1,this.playPySound(i.ID);var a=i.getAllSkill(o,o),r=[];for(var s in a)if(1!=a[s].type){var u=i.getSkillOpenDgLv(a[s].ID)||0;r.push({skill:a[s],godId:i.ID,openDgLv:u,dgLv:10,index:s})}this.skillList.array=r,this.skillList.y=148+109*(4-this.skillList.array.length)/2}},i.prototype.onSkin=function(){var t=this._arrTotalGods[this._curGodsindex].godTemp;t&&UIMgr.getInstance().showUI(UIConst.GodSkinView,[t])},i.prototype.onSkillClick=function(t,e){if(t.type==Laya.Event.CLICK){var i=this.skillList.getCell(e);i&&i.dataSource?(this.skillBox.dataSource=i.dataSource,this.skillBox.y=this.skillList.y+48+96*e+this.skillList.spaceY,this.skillBox.visible=!0):(this.skillBox.dataSource=null,this.skillBox.visible=!1)}else t.type==Laya.Event.MOUSE_UP||(t.type,Laya.Event.MOUSE_OUT)},i.prototype.onClickStage=function(t){t.target instanceof e.GodSkillItemIR||(this.skillBox.dataSource=null,this.skillBox.visible=!1)},i.prototype.refreshModel=function(t){this._lastmodel!=t&&(this.uiScene.addModelChar(t,360,710,180,3),this._lastmodel=t,this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_01,2))},i.prototype.playPySound=function(t,e,i){if(void 0===e&&(e=""),void 0===i&&(i=!0),i||this._pyGodId!=t){this.stopPySound(),this._pyGodId=t;var n=Laya.Render.isConchApp?"ogg":"mp3";e=LanMgr.getLan("sound/god_peiyin/{0}/voice_{1}_dub.{2}",-1,n,t,n),this._pySoundUrl=e&&""!=e?e:"sound/godpeiyin.mp3",AudioMgr.playSound(this._pySoundUrl)}},i.prototype.stopPySound=function(t){void 0===t&&(t=0),0!=t&&this._pyGodId!=t||(AudioMgr.StopSound(this._pySoundUrl),this._pyGodId=0)},i.prototype.Showpingjia=function(){dispatchEvt(new e.TujianEvent(e.TujianEvent.SHOW_EVALUATION_PANEL),this._arrTotalGods[this._curGodsindex].godTemp)},i.prototype.onLeft=function(){this.btnPrev.gray||(e.TujianModel.getInstance().index--,this.updatedata(e.TujianModel.getInstance().index,this._arrTotalGods))},i.prototype.onRight=function(){this.btnNext.gray||(e.TujianModel.getInstance().index++,this.updatedata(e.TujianModel.getInstance().index,this._arrTotalGods))},i.prototype.onFanHui=function(){this.close()},i);function i(){var t=n.call(this)||this;return t._arrTotalGods=[],t._curGodsindex=0,t._pyGodId=0,t._pySoundUrl="",t.isModelClose=!0,t}e.TujianHeroView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.tujian.TuijianViewUI,__extends(i,e),i.prototype.onShow=function(){this.btn_left.on(Laya.Event.CLICK,this,this.onChange,[!0]),this.btn_right.on(Laya.Event.CLICK,this,this.onChange,[!1]),this.list_buttons.dataSource=n.TujianModel.getInstance().tabNames,this.list_buttons.selectedIndex=0,this.onSelectTab(0)},i.prototype.onExit=function(){this.btn_left.off(Laya.Event.CLICK,this,this.onChange),this.btn_right.off(Laya.Event.CLICK,this,this.onChange),this.list_yeqian.dataSource=null,this.lab_info.text="",this.lab_location.text=""},i.prototype.onSelectTab=function(t){if(-1!=t){this.lbName.text=n.TujianModel.getInstance().tabNames[t],this.curTabIdx=t;var e=n.TujianModel.getInstance().yeqianData[t],i=(this.list_yeqian.dataSource=e).length;this.list_yeqian.repeatX=i,this.list_yeqian.width=20*i+(i-1)*this.list_yeqian.spaceX,this.list_yeqian.selectedIndex=0,this.onSelectYeqian(0)}},i.prototype.onSelectYeqian=function(t){-1!=t&&(this.curYeqianIdx=t,this.refreshTabData(t))},i.prototype.refreshTabData=function(t){var e=tb.TB_recommend_squad.get_TB_recommend_squadById(t+1+10*(this.curTabIdx+1)),i=tb.TB_recommend_squad.get_TB_recommend_squadById(t+2+10*(this.curTabIdx+1));this.btn_left.visible=0!=t,this.btn_right.visible=!!i,this.lab_info.text=e.desc,this.lab_location.text=e.location;for(var n=0;n<6;n++)this["ui_Item"+n].dataSource=e.god[n];this.panel_info.refresh()},i.prototype.onRenderTab=function(t,e){t.label=t.dataSource,t.skin=e==this.curTabIdx?SkinUtil.fenye_down:SkinUtil.fenye_up,t.labelSize=this.list_buttons.selectedIndex==e?24:22,t.labelColors=this.list_buttons.selectedIndex==e?"#7e5336,#7e5336,#7e5336":"#e6ca91,#e6ca91,#e6ca91",t.labelBold=!0},i.prototype.onRenderYeqian=function(t,e){t.img_yellow.visible=e==this.curYeqianIdx},i.prototype.onChange=function(t){this.list_yeqian.selectedIndex=t?this.curYeqianIdx-1:this.curYeqianIdx+1},i);function i(){var t=e.call(this)||this;return t.curTabIdx=-1,t.curYeqianIdx=-1,t.list_buttons.selectHandler=new Handler(t,t.onSelectTab),t.list_buttons.renderHandler=new Handler(t,t.onRenderTab),t.list_yeqian.selectHandler=new Handler(t,t.onSelectYeqian),t.list_yeqian.renderHandler=new Handler(t,t.onRenderYeqian),t.panel_info.vScrollBarSkin="",t}n.TuijianView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.tujian.render.TuijianIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){if(this._dataSource){var t=tb.TB_god.get_TB_godById(this._dataSource[0]),e=tb.TB_god_evolution.get_TB_god_evolutionById(this._dataSource[1]),i=this._dataSource[1]<=5?this._dataSource[1]:6,n={templateId:t.ID,starLevel:this._dataSource[1],level:e.level,skill:t.skill,degree:i},o=new GodItemVo(n);o.levelStr="",o.level=0,this.lab_name.text=t.name,this.headIcon.visible=!0,this.headIcon.dataSource=o,this.godInfoData=o}else this.headIcon.visible=!1,this.headIcon.dataSource=null},n.prototype.onHead=function(){dispatchEvt(new t.TujianEvent(t.TujianEvent.SHOW_GUAIWUXINXI_PANEL),this.godInfoData)},n);function n(){var t=e.call(this)||this;return t.headIcon.on(Laya.Event.CLICK,t,t.onHead),t}t.TujianHeadIR=i;var o,a=(o=ui.tujian.render.YeqianIRUI,__extends(r,o),Object.defineProperty(r.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),r.prototype.refreshData=function(){this._dataSource},r);function r(){return o.call(this)||this}t.YeqianIR=a}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.tujian.TabTujianUI,__extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.list_tujian.mouseHandler=new Handler(this,this.onMouse),this.list_race.selectHandler=new Handler(this,this.onSelect),this.list_race.array=[0,1,2,3,4,5],this.list_race.selectedIndex=-1},n.prototype.close=function(){Laya.timer.clearAll(this),this._allTuJianGodTemps=null,this.list_tujian.array=null,this.list_race.selectedIndex=-1},n.prototype.initView=function(){if(!this._allTuJianGodTemps||0==this._allTuJianGodTemps.length){var t=i.TujianModel.getInstance().getTuJianGodTArr();this._allTuJianGodTemps=t.filter(function(t){return t.starLv==t.godTemp.star[0]||t.starLv==t.godTemp.star[1]||5==t.starLv||6==t.starLv})}this.list_race.selectedIndex=0},n.prototype.onSelect=function(e){var t;-1!=e&&(t=this._allTuJianGodTemps.filter(function(t){return 0==e||t.godTemp.race_type==e}),this.list_tujian.array=t,this.lbType.text=LanMgr.GOD_RACE_NAME[e])},n.prototype.onMouse=function(t,e){t.type==Laya.Event.CLICK&&dispatchEvt(new i.TujianEvent(i.TujianEvent.SHOW_XIANGXI_PANEL),[e,this.list_tujian.array])},n);function n(){return t.call(this)||this}i.TabTujianView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var a=function(t){this.aryStr=t[0];var e=JSON.parse(t[0]);this.time=e[0],this.playerId=e[1],this.name=e[2],this.click=e[3],this.content=e[4],this.num=Number(t[1])};e.PingjiaInfo=a;var i,t=(i=ui.tujian.PingjiaUI,__extends(n,i),n.prototype.onClosed=function(){i.prototype.onClosed.call(this),Laya.timer.clearAll(this)},n.prototype.popup=function(){i.prototype.popup.call(this),this.initView()},n.prototype.initView=function(){var i=this,t=this.dataSource,e={};e[Protocol.game_god_getComment.args.templateId]=t.ID,PLC.request(Protocol.game_god_getComment,e,function(t,e){t&&i.updateData(t.allComment)}),this.lab_desc.text="        "+t.desc,this.lbl_name.text=t.name},n.prototype.updateData=function(t){this._evaluate.scrollBar.value,t=t||[];var e=[];for(var i in t){var n=new a(t[i]);e.push(n)}e.sort(function(t,e){return t.time-e.time}),this._evaluate.dataSource=e,i=0;for(var o=this._evaluate.cells.length;i<o;i++)this._evaluate.cells[i].refresh()},n.prototype.refreshList=function(){for(var t=0,e=this._evaluate.cells.length;t<e;t++)this._evaluate.cells[t].refresh()},n.prototype.getCurGodId=function(){return this.dataSource.ID},n.prototype.onAdd=function(){dispatchEvt(new e.TujianEvent(e.TujianEvent.SHOW_EVALUATIONINPUT_PANEL),this.dataSource)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t._evaluate=new common.Accordion(580,560),t.btn_Add.on(Laya.Event.CLICK,t,t.onAdd),t._evaluate.itemRender=e.PingjiaIR,t.addChild(t._evaluate),t._evaluate.spaceY=10,t._evaluate.x=52,t._evaluate.y=360,t._evaluate.isAutoScroll=!1,t.bgPanel.dataSource={closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12118)},t}e.PingjiaView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.tujian.PingjiaShuruUI,__extends(n,i),n.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.onPutText()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.textarea_put.text=""},n.prototype.onPutText=function(){this.label_residuetext.text=LanMgr.getLan("",12119,60-this.textarea_put.text.length)},n.prototype.onSure=function(){var t={};0!==this.textarea_put.text.length?(t[Protocol.game_god_publishComment.args.templateId]=this.dataSource.ID,t[Protocol.game_god_publishComment.args.content]=this.textarea_put.text,dispatchEvt(new e.TujianEvent(e.TujianEvent.UPDATE_EVALUATION),t),this.close()):showToast(LanMgr.getLan("",10207))},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.btn_Sure.on(Laya.Event.CLICK,t,t.onSure),t.btn_Calloff.on(Laya.Event.CLICK,t,t.close),t.textarea_put.on(Laya.Event.INPUT,t,t.onPutText),t}e.PingjiaShuruView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.tujian.render.pingjiaIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refresh()},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){var t=this.dataSource;t?(this.label_name.text=t.name,this.label_Numbers.text=t.num+"",this.label_godstext.text=t.content,this.label_godstext.event(Laya.Event.RESIZE),this.btn_giveup.on(Laya.Event.CLICK,this,this.onGiveup),this.imgBg.height=this.height=this.label_godstext.height+65):this.btn_giveup.off(Laya.Event.CLICK,this,this.onGiveup)},n.prototype.game_god_observeGod=function(){dispatchEvt(new e.TujianEvent(e.TujianEvent.SHOW_PINGLUNGOD_PANEL),this.dataSource)},n.prototype.onGiveup=function(){var t=this.dataSource;t&&(t.playerId!=App.hero.playerId?dispatchEvt(new e.TujianEvent(e.TujianEvent.DIANZAN),this.dataSource):showToast(LanMgr.getLan("",10468)))},n);function n(){return t.call(this)||this}e.PingjiaIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"TujianProcessor"},i.prototype.listenModuleEvents=function(){return[new n.TujianEvent(n.TujianEvent.SHOW_TUJIAN_PANEL),new n.TujianEvent(n.TujianEvent.SHOW_XIANGXI_PANEL),new n.TujianEvent(n.TujianEvent.SHOW_EVALUATION_PANEL),new n.TujianEvent(n.TujianEvent.SHOW_GUAIWUXINXI_PANEL),new n.TujianEvent(n.TujianEvent.UPDATE_EVALUATION),new n.TujianEvent(n.TujianEvent.SHOW_EVALUATIONINPUT_PANEL),new n.TujianEvent(n.TujianEvent.SHOW_PINGLUNGOD_PANEL),new n.TujianEvent(n.TujianEvent.DIANZAN)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof n.TujianEvent)switch(t.type){case n.TujianEvent.SHOW_TUJIAN_PANEL:this.showTujianPanel();break;case n.TujianEvent.SHOW_XIANGXI_PANEL:this.showXiangxiPanel(t.data);break;case n.TujianEvent.SHOW_EVALUATION_PANEL:this.getGodevaluations(t.data);break;case n.TujianEvent.SHOW_EVALUATIONINPUT_PANEL:this.showInput(t.data);break;case n.TujianEvent.SHOW_GUAIWUXINXI_PANEL:this.showTujianView(t.data);break;case n.TujianEvent.UPDATE_EVALUATION:this.updatePingjia(t.data);break;case n.TujianEvent.SHOW_PINGLUNGOD_PANEL:this.showPinglunPanel(t.data);break;case n.TujianEvent.DIANZAN:this.dianzan(t.data)}},i.prototype.showTujianPanel=function(){UIMgr.showUI(UIConst.TujianView);var t={};t[Protocol.game_common_openUI.args.type]=iface.tb_prop.uiTypeKey.album,PLC.request(Protocol.game_common_openUI,t,function(t,e){})},i.prototype.showXiangxiPanel=function(t){var e=t[0],i=t[1];n.TujianModel.getInstance().index=e,UIMgr.showUI(UIConst.TujianHeroView,[e,i])},i.prototype.getGodevaluations=function(t){UIMgr.showUI(UIConst.Tujian_PingjiaView,t)},i.prototype.updatePingjia=function(t){PLC.request(Protocol.game_god_publishComment,t,function(t,e){t&&UIMgr.hasStage(UIConst.Tujian_PingjiaView)&&UIMgr.getUIByName(UIConst.Tujian_PingjiaView).updateData(t.allComment)})},i.prototype.showInput=function(t){App.hero.level<tb.TB_god_set.get_TB_god_set().comment_needlevel?showToast(LanMgr.getLan("",10466)):n.GodUtils.isActiveGod(t.ID)?UIMgr.showUI(UIConst.Tujian_PingjiaShuruView,t):showToast(LanMgr.getLan("",10467))},i.prototype.showTujianView=function(t){UIMgr.showUI(UIConst.GuaiwuxinxiView,t)},i.prototype.showPinglunPanel=function(t){var e={};e[Protocol.game_god_observeGod.args.playerId]=t.playerId,e[Protocol.game_god_observeGod.args.templateId]=this.pingjiaView.getCurGodId(),PLC.request(Protocol.game_god_observeGod,e,function(t,e){if(t){var i=t.observeGodInfo,n=tb.TB_god.get_TB_godById(i[0]);if(n){var o=new GodItemVo(n);for(var a in i[3])o.iSeverAttri.push([Number(a),Number(i[3][a])]);o.starLevel=i[1],o.level=i[2],o.degree=i[4],o.awakenLv=i[5],o.skinId=i[6],UIMgr.showUI(UIConst.GuaiwuxinxiView,o)}else logerror("查看评价页面失败：",t)}})},i.prototype.dianzan=function(i){var n=this,t={};t[Protocol.game_god_likeComment.args.value]=i.aryStr,t[Protocol.game_god_likeComment.args.templateId]=this.pingjiaView.getCurGodId(),PLC.request(Protocol.game_god_likeComment,t,function(t,e){t&&(i.num++,n.pingjiaView.refreshList())})},Object.defineProperty(i.prototype,"xiangxiview",{get:function(){return UIMgr.getUIByName(UIConst.TujianHeroView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tbagView",{get:function(){return UIMgr.getUIByName(UIConst.TujianView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pingjiaView",{get:function(){return UIMgr.getUIByName(UIConst.Tujian_PingjiaView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}n.TujianProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"TujianModule"},n.prototype.listProcessors=function(){return[new t.TujianProcessor]},n.prototype.onRegister=function(){t.TujianModel.getInstance()},n);function n(){return e.call(this)||this}t.TujianModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_TUJIAN_PANEL="SHOW_TUJIAN_PANEL",r.SHOW_XIANGXI_PANEL="SHOW_XIANGXI_PANEL",r.SHOW_EVALUATION_PANEL="SHOW_EVALUATION_PANEL",r.UPDATE_EVALUATION="UPDATE_EVALUATION",r.SHOW_EVALUATIONINPUT_PANEL="SHOW_EVALUATIONINPUT_PANEL",r.SHOW_GUAIWUXINXI_PANEL="SHOW_GUAIWUXINXI_PANEL",r.SHOW_PINGLUNGOD_PANEL="SHOW_PINGLUNGOD_PANEL",r.DIANZAN="DIANZAN",r.ACTIVITY_TUJIAN_SUCC="ACTIVITY_TUJIAN_SUCC",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.TujianEvent=a}(game=game||{}),function(t){var e=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.getTuJianGodTArr=function(){if(!this._tuJianGodTArr){this._tuJianGodTArr=[];var t=TableData.getInstance().getTableByName(TableData.tb_god).data;if(t){for(var e in t){var i=t[e];if(i){var n=i.star[0],o=i.star[1];if(o<n){logwarn("英雄模板等级配置错误，最大等级小于最小等级:",i.name);continue}for(var a=n;a<=o;a++){var r=new s;r.init(i,a),this._tuJianGodTArr.push(r)}}}this._tuJianGodTArr.sort(function(t,e){var i=0,n=0;return n=t.starLv!=e.starLv?(i=t.starLv,e.starLv):(i=t.godTemp.race_type,e.godTemp.race_type),i-n})}}return this._tuJianGodTArr},i);function i(){this.index=0,this.yeqianData=[[1],[1,2,3],[1,2,3]],this.tabNames=[LanMgr.getLan("",12114),LanMgr.getLan("",12115),LanMgr.getLan("",12116)]}t.TujianModel=e;var s=(n.prototype.init=function(t,e){this.godTemp=t,this.starLv=e,this.starLv<t.star[0]?this.starLv=t.star[0]:this.starLv>t.star[1]&&(this.starLv=t.star[1])},n);function n(){}t.TuJianGodTemp=s}(game=game||{}),function(i){var t=(e.prototype.initGodList=function(){for(var t=0,e=this.tbGodFate.need_god;t<e.length;t++){var i=e[t],n=new GodItemVo(tb.TB_god.get_TB_godById(i));n.dataType=1,this.listItem.push(n)}},e.prototype.isActivite=function(){for(var t=0,e=this.tbGodFate.need_god;t<e.length;t++){var i=e[t];if(!this.isOwned(i))return!1}return!0},e.prototype.isActiviteComplete=function(){return-1!=App.hero.godFateIds.indexOf(this.tbGodFate.ID)},e.prototype.isOwned=function(e){return-1!=App.hero.godAlbum.findIndex(function(t){return t==e})},e.prototype.getAttr=function(t){for(var e=0,i=this.tbGodFate.attr;e<i.length;e++){var n=i[e];if(n[0]==t)return n[2]<1?Math.floor(1e4*n[2]/100):Number(n[2])}return 0},e.prototype.getAttrByIndex=function(t){var e=this.tbGodFate.attr[t][2]<1?Math.floor(1e4*this.tbGodFate.attr[t][2]/100)+"%":this.tbGodFate.attr[t][2];return[i.FateModel.getInstance().getNameById(Number(this.tbGodFate.attr[t][0])),String(e)]},e.prototype.getAttr2Power=function(t){for(var e=0,i=this.tbGodFate.attr;e<i.length;e++){var n=i[e];if(n[0]==t)return Number(n[2])}return 0},e);function e(t){this.listItem=[],this.id=t,this.tbGodFate=tb.TB_god_fate.get_TB_god_fateById(t),this.initGodList()}i.FateVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.tujian.FateViewUI,__extends(n,e),n.prototype.onShow=function(){this.initView(),tl3d.ModuleEventManager.addEvent(t.TujianEvent.ACTIVITY_TUJIAN_SUCC,this.updateNum,this)},n.prototype.onExit=function(){this.list_fate.array=null,this.btn_look.off(Laya.Event.CLICK,this,this.onLook),tl3d.ModuleEventManager.removeEvent(t.TujianEvent.ACTIVITY_TUJIAN_SUCC,this.updateNum,this)},n.prototype.initView=function(){this.list_fate.array=t.FateModel.getInstance().arrFateVo,this.btn_look.on(Laya.Event.CLICK,this,this.onLook),this.updateNum()},n.prototype.updateNum=function(){this.lb_tujian.text=LanMgr.getLan("",12120,t.FateModel.getInstance().getFateArrNum()[0],t.FateModel.getInstance().getFateArrNum()[1])},n.prototype.onLook=function(){UIMgr.showUI(UIConst.Tujian_AttrView)},n);function n(){return null!==e&&e.apply(this,arguments)||this}t.FateView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.tujian.render.FateIRUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),i.prototype.initView=function(){var t=this.dataSource;t?(this.list_god.array=t.listItem,this._totalnum=t.listItem.length,1==t.tbGodFate.attr.length?this.lb_desc.text=LanMgr.getLan("{0} ( {1} + {2} )",-1,t.tbGodFate.name,t.getAttrByIndex(0)[0],t.getAttrByIndex(0)[1]):2==t.tbGodFate.attr.length?this.lb_desc.text=LanMgr.getLan("{0} ( {1} + {2} , {3} + {4} )",-1,t.tbGodFate.name,t.getAttrByIndex(0)[0],t.getAttrByIndex(0)[1],t.getAttrByIndex(1)[0],t.getAttrByIndex(1)[1]):3==t.tbGodFate.attr.length&&(this.lb_desc.text=LanMgr.getLan("{0} ( {1} + {2} , {3} + {4} , {5} + {6} )",-1,t.tbGodFate.name,t.getAttrByIndex(0)[0],t.getAttrByIndex(0)[1],t.getAttrByIndex(1)[0],t.getAttrByIndex(1)[1],t.getAttrByIndex(2)[0],t.getAttrByIndex(2)[1])),this.refreshData()):(this.ani_item.visible=this.ani_item2.visible=!1,this.ani_item.stop(),this.ani_item2.stop(),clearTimeout(this._efftag))},i.prototype.refreshData=function(){var t=this.dataSource;if(t){if(t.isActiviteComplete())this.img_success.visible=!0,this.lb_success.visible=!0,this.lb_desc.color=ColorConst.FATE_GREEN,this.redPoint&&this.redPoint.onDispose();else if(this.img_success.visible=!1,this.lb_success.visible=!1,this.lb_desc.color=ColorConst.FATE_GOLD,this.redPoint){var e="fate_"+t.tbGodFate.ID;this.redPoint.setRedPointName(e)}this.btn_lightup.visible=!t.isActiviteComplete()&&t.isActivite()}},i.prototype.playEff=function(){var t=this;if(!(this._effnum>=this._totalnum)){var e=this.ani_item;this._effnum%2==1&&(e=this.ani_item2),e.visible&&e.isPlaying&&this.onAniComplete(),e.visible=!0;var i=this.list_god.getCell(this._effnum);e.x=this.list_god.x+i.x+45,e.y=this.list_god.y+i.y+45,this._effnum++,e.play(0,!1),clearTimeout(this._efftag),this._efftag=setTimeout(function(){t.playEff()},150)}},i.prototype.onAniComplete=function(){var t=this.list_god.getCell(this._effidx);t&&(t.visible=!0,this._effidx++)},i.prototype.onRender=function(t,e){t.gray=!this.dataSource.isOwned(this.dataSource.listItem[e].templateId)},i.prototype.onLightUp=function(){var i=this,t=this.dataSource;if(t){var e={};e[Protocol.game_god_godFate.args.id]=t.tbGodFate.ID,PLC.request(Protocol.game_god_godFate,e,function(t,e){t&&(i.refreshData(),i.list_god.cells.forEach(function(t){t.visible=!1}),i._effnum=0,i._effidx=0,i.playEff(),dispatchEvt(new n.TujianEvent(n.TujianEvent.ACTIVITY_TUJIAN_SUCC)))})}},i);function i(){var t=e.call(this)||this;return t.list_god.renderHandler=new Handler(t,t.onRender),t.btn_lightup.on(Laya.Event.CLICK,t,t.onLightUp),t.ani_item.on(Laya.UIEvent.COMPLETE,t,t.onAniComplete),t.ani_item2.on(Laya.UIEvent.COMPLETE,t,t.onAniComplete),t.ani_item.visible=t.ani_item2.visible=!1,t.ani_item.stop(),t.ani_item2.stop(),t}n.FateIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.tujian.AttrViewUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.close=function(){i.prototype.close.call(this)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this)},n.prototype.initView=function(){this.lb_ack.text=LanMgr.getLan(" + {0}",-1,t.FateModel.getInstance().getCurFateAttrById(1)),this.lb_def.text=LanMgr.getLan(" + {0}",-1,t.FateModel.getInstance().getCurFateAttrById(2)),this.lb_hp.text=LanMgr.getLan(" + {0}",-1,t.FateModel.getInstance().getCurFateAttrById(3)),this.lb_speed.text=LanMgr.getLan(" + {0}",-1,t.FateModel.getInstance().getCurFateAttrById(4)),this.lb_crit.text=LanMgr.getLan(" + {0}",-1,t.FateModel.getInstance().getCurFateAttrById(5)+"%"),this.lb_defcrit.text=LanMgr.getLan(" + {0}",-1,t.FateModel.getInstance().getCurFateAttrById(6)+"%"),this.lb_hit.text=LanMgr.getLan(" + {0}",-1,t.FateModel.getInstance().getCurFateAttrById(7)+"%"),this.lb_res.text=LanMgr.getLan(" + {0}",-1,t.FateModel.getInstance().getCurFateAttrById(8)+"%")},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.Tujian_AttrView,closeOnSide:t.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12121)},t.bgPanel.addChildAt(t.img_bg,3),t}t.AttrView=e}(game=game||{}),function(n){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initFateList=function(){if(!this.arrFateVo){this.arrFateVo=[];for(var t=0,e=tb.TB_god_fate.get_TB_god_fate();t<e.length;t++){var i=e[t];this.arrFateVo.push(new n.FateVo(i.ID))}}this.sort()},e.prototype.sort=function(){this.arrFateVo.sort(function(t,e){var i=t.isActiviteComplete();if(i!=e.isActiviteComplete())return i?1:-1;if(i)return t.tbGodFate.rank-e.tbGodFate.rank;var n=t.isActivite();return n==e.isActivite()?t.tbGodFate.rank-e.tbGodFate.rank:n?-1:1})},e.prototype.getFateArrNum=function(){var e=0,i=0;return this.arrFateVo.forEach(function(t){t.isActiviteComplete()&&e++,i++}),[e,i]},e.prototype.getNameById=function(t){return LanMgr.attrName[t]},e.prototype.getCurFateAttrById=function(t){for(var e=0,i=0,n=this.arrFateVo;i<n.length;i++){var o=n[i];o.isActiviteComplete()&&(e+=o.getAttr(t))}return e},e.prototype.getCurFateAttrById2Power=function(t){for(var e=0,i=0,n=this.arrFateVo;i<n.length;i++){var o=n[i];o.isActiviteComplete()&&(e+=o.getAttr2Power(t))}return e},e.prototype.getCurFateAttr=function(){this.initFateList();for(var t=[],e=1;e<=8;e++)t.push([e,this.getCurFateAttrById2Power(e)]);return t},e);function e(){}n.FateModel=t}(game=game||{}),function(i){var t=(e.prototype.getName=function(){return this.rank<=3?this.name+" ("+this.level+LanMgr.getLan("",10031)+")":this.name},e.prototype.getRank=function(){return this.rank},e.prototype.getHeadVo=function(){return this._headVo||(this._headVo=new UserHeadVo(this.head,this.level,this.headFrame)),this._headVo},e.prototype.getValue=function(){var t=tb.TB_copy_info.get_TB_copy_infoById(this.guanqia),e=t?tb.TB_copy.get_TB_copyById(t.area):null;return e?LanMgr.getLan("",e.sub_type==i.ShiliantaType.jiandan?10102:10103,t.area_number):LanMgr.getLan("",10051)},e.prototype.getDesc=function(){return LanMgr.getLan("",10148)},e);function e(t,e){this.uid=t[0],this.guanqia=t[1],this.name=t[2],this.head=t[3],this.level=t[4],this.guildName=t[5],this.headFrame=t[6],this.rank=e}i.RankVo=t}(game=game||{}),function(t){var e=(i.prototype.getName=function(){return 2==this.tbTrial.ID?""+LanMgr.getLan("",10023):this.itemVo.getName()+"x"+this.itemVo.getNum()},i.prototype.isReward=function(){return t.TowerModel.getInstance().isRewardById(this.tbTrial.ID,this.tbTrial.type)},i.prototype.getNandu=function(){return this.tbTrial.type==t.ShiliantaType.jiandan?LanMgr.getLan("",12122):LanMgr.getLan("",12123)},i);function i(t){this.tbTrial=t,this.itemVo=new ItemVo(parseInt(t.reward[0][0]),parseInt(t.reward[0][1]))}t.JiangliVo=e}(game=game||{}),function(i){var t=(e.prototype.getOpenLevel=function(){return this._openLv},e.prototype.getPrevId=function(){return this._prevId},e.prototype.isPass=function(){var t=i.TowerModel.getInstance().getGuanqiaModelVo(this.tbCopy.sub_type),e=t.curGuanqia;return!!t.isAllFinish()||this.tbCopyInfo.area_number<e.tbCopyInfo.area_number},e.prototype.isCurrent=function(){return i.TowerModel.getInstance().getGuanqiaModelVo(this.tbCopy.sub_type).curGuanqia.tbCopyInfo.ID==this.tbCopyInfo.ID},e.prototype.getMonsterList=function(){return this.tbCopyInfo.getMonsters()},e.prototype.isReward=function(){var t=App.hero.towerAwardInfo[this.tbCopy.sub_type];return!!t&&!!this.isBoss&&this.tbCopyInfo.ID<=t},e.prototype.isCanReward=function(){return this.isBoss&&this.isPass()&&!this.isReward()},e);function e(t,e){void 0===e&&(e=!1),this.isBoss=!1,this._openLv=0,this._prevId=0,this.tbCopyInfo=t,this.isBoss=e,this.tbCopy=tb.TB_copy.get_TB_copyById(t.area),this._prevId=this.tbCopyInfo.getConditionVal(CopyConditionType.id),this._openLv=this.tbCopyInfo.getConditionVal(CopyConditionType.level)}i.GuanqiaVo=t}(game=game||{}),function(a){var t=(e.prototype.updateGuanqia=function(){var t,e=App.hero.towerCopyInfo[this.tbCopy.sub_type],i=tb.TB_copy_info.get_TB_copy_infoById(e),n=i?tb.TB_copy.get_TB_copyById(i.area):null;i&&n&&n.type==iface.tb_prop.copyTypeKey.tower?(t=this.getGuanqiaVo(i.ID),i.next?this.curGuanqia=this.getGuanqiaVo(i.next):this.curGuanqia=this.getGuanqiaVo(e)):this.curGuanqia=this._guanqiaList[0];var o=this.curGuanqia.tbCopyInfo.area_number;t&&t.isBoss&&!t.isReward()&&(o=t.tbCopyInfo.area_number),this.curPage=Math.floor((o-1)/a.TowerModel.PAGE_NUM)},e.prototype.getGuanqiaVo=function(e){return this._guanqiaList.find(function(t){return t.tbCopyInfo.ID==e})},e.prototype.getGuanqiaVoByIndex=function(t){return this._guanqiaList[t]},e.prototype.getGuanqiaVoById=function(e){return this._guanqiaList.find(function(t){return t.tbCopyInfo.ID==e})},e.prototype.getListByPage=function(t){var e=a.TowerModel.PAGE_NUM*t;return this._guanqiaList.slice(e,e+a.TowerModel.PAGE_NUM)},e.prototype.isPassByPage=function(t){return this.getListByPage(t).every(function(t){return t.isPass()})},e.prototype.getJiangliList=function(){if(!this._jiangliList){this._jiangliList=[];var t=TableData.getInstance().getTableByName(TableData.tb_trial).data;for(var e in t){var i=t[e];0==i.type?this._jiangliList.push(new a.JiangliVo(t[e])):i.type==this.tbCopy.sub_type&&this._jiangliList.push(new a.JiangliVo(t[e]))}}return this._jiangliList},e.prototype.getCanRewardVo=function(){return this._guanqiaList.find(function(t){return t.isCanReward()})},e.prototype.isCanReward=function(){return!!this.getCanRewardVo()},e.prototype.isAllFinish=function(){return App.hero.towerCopyInfo[this.tbCopy.sub_type]>=this.endCopyId},e.prototype.isAllPass=function(){return this.isAllFinish()&&!this.isCanReward()},e);function e(t){var i=this;this._guanqiaList=[],this.pageNum=0,this.curPage=0,this.endCopyId=0,this.tbCopy=t,tb.TB_copy_info.get_TB_copy_info("area",String(t.ID)).forEach(function(t,e){i._guanqiaList.push(new a.GuanqiaVo(t,e%10==9))});var e=this._guanqiaList.length;this.endCopyId=this._guanqiaList[e-1].tbCopyInfo.ID,this.pageNum=Math.ceil(e/a.TowerModel.PAGE_NUM)}a.GuanqiaModelVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var i,t=(i=ui.tower.shiliantaViewUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._model=h.TowerModel.getInstance();for(var t=0;t<h.TowerModel.PAGE_NUM;t++)this["gkitem_"+t].index=t;this.uiScene=new Base2dSceneLayer,this.boxContent.addChild(this.uiScene),this.uiScene.setModelBox(this,this.btn_lev0,this.imgBoss),this.boxContent.addChild(this.imgBoss),this.boxContent.addChild(this.imgArrow),this.loadSkill(),this.pageList.selectEnable=!0,this.pageList.renderHandler=new Handler(this,this.renderPage),this.pageList.selectHandler=new Handler(this,this.selectPage),this._tabBar=new common.CustomTabBar,this._tabBar.buttons=[this.btn_lev0,this.btn_lev1];var e=this._model.putongModel;this._tabBar.buttonsData=[null,{openTye:common.BtnOpenType.gray,openHandler:new Handler(e,e.isAllPass),prompt:LanMgr.getLan("",10100)}],this._tabBar.selectHandler=new Handler(this,this.onTabSel),this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.SHILIANTA)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_buzhen,callback:this.onBuzhen.bind(this)},{btnSkin:SkinUtil.btn_rank,callback:this.onPaiming.bind(this)},{btnSkin:SkinUtil.btn_jiangli,callback:this.onJiangli.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onFanHui.bind(this)}),this._curPage=-1;var i=this.dataSource?parseInt(this.dataSource):0;this._tabBar.selectedIndex=i,this.uiScene.onShow(),this.boxBaoxiang.on(Laya.Event.CLICK,this,this.onClickBaoxiang)},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._bossGuanqia=null,this._curGuanqia=null,this.removeSkill(),this.uiScene.onExit(),Laya.Tween.clearTween(this.imgArrow),Laya.timer.clearAll(this),this._tabBar.selectedIndex=-1,this.boxBaoxiang.off(Laya.Event.CLICK,this,this.onClickBaoxiang),tl3d.ModuleEventManager.removeEvent(common.GlobalEvent.DIALOG_CLOSED,this.onNextPage,this),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.onTabSel=function(t){if(-1!=t){var e=this._model;0==t?(this.pageList.array=new Array(e.putongModel.pageNum),this.selectPage(e.putongModel.curPage)):(this.pageList.array=new Array(e.kunnanModel.pageNum),this.selectPage(e.kunnanModel.curPage))}},e.prototype.renderPage=function(t,e){t.getChildByName("lbNum").text=String(e+1)},e.prototype.selectPage=function(t){if(this._curPage!=t){var e=this._model;if(0<t){var i=this._tabBar.selectedIndex;if(!(0==i?e.putongModel.isPassByPage(t-1):e.kunnanModel.isPassByPage(t-1)))return showToast(LanMgr.getLan("",10464)),void(this.pageList.selectedIndex=this._curPage);if(!(0==i?e.putongModel.getListByPage(t-1):e.kunnanModel.getListByPage(t-1))[9].isReward())return showToast(LanMgr.getLan("",10465)),void(this.pageList.selectedIndex=this._curPage)}for(var n=0,o=this.pageList.cells.length;n<o;n++)this.pageList.cells[n].getChildByName("imgBg").skin=SkinUtil.getPageStateUrl(t==n?2:1);this._curPage=t,this.pageList.selectedIndex=this._curPage,this.renderGuanqia()}},e.prototype.renderGuanqia=function(){for(var t,e=this,i=this._tabBar.selectedIndex,n=this._model,o=0==i?n.putongModel.getListByPage(this._curPage):n.kunnanModel.getListByPage(this._curPage),a=0==i?n.putongModel.isPassByPage(this._curPage):n.kunnanModel.isPassByPage(this._curPage),r=0;r<h.TowerModel.PAGE_NUM;r++){var s=this["gkitem_"+r];s.dataSource=o[r],o[r].isCurrent()&&(t=s)}this.setIndexImage(t),this._curGuanqia=t,this._bossGuanqia=o[9];var u=tb.TB_trial.get_TB_trialById(this._bossGuanqia.tbCopyInfo.ID).model;Laya.timer.frameOnce(3,this,function(){e._bossGuanqia&&e.refreshModel(u,a,e._bossGuanqia.isReward())})},e.prototype.setIndexImage=function(t){t?(Laya.Tween.clearTween(this.imgArrow),this.imgArrow.x=t.x-18,this.imgArrow.y=t.y-80,this.imgArrow.visible=!0,UIUtil.loop(this.imgArrow,this.imgArrow.x,this.imgArrow.y,1e3,30,TweenDirection.down)):(this.imgArrow.visible=!1,Laya.Tween.clearTween(this.imgArrow))},e.prototype.loadSkill=function(){this.uiScene.scene.skillMgr.preLoadSkill(getSkillUrl("100001"))},e.prototype.refreshModel=function(t,e,i){this.removeSkill(),e?(this.uiScene.addModelChar(SkinUtil.baoxiangModelId,261,430,180,1),i?(this.uiScene.sceneChar.play(tl3d.CharAction.DEATH,1),this.boxBaoxiang.visible=!1):(this._skill=this.uiScene.scene.charPlaySkill(this.uiScene.sceneChar,"100001",tl3d.CharAction.STANAD),this.boxBaoxiang.visible=!0),this.imgBoss.visible=!1):(this.uiScene.addModelChar(t,261,430,180,1),this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_02,2),this.imgBoss.visible=!0,this.boxBaoxiang.visible=!1)},e.prototype.onBuzhen=function(){dispatchEvt(new h.GodEvent(h.GodEvent.SHOW_BUZHEN_PANEL),iface.tb_prop.lineupTypeKey.attack)},e.prototype.onJiangli=function(){var t=0==this._tabBar.selectedIndex?h.ShiliantaType.jiandan:h.ShiliantaType.kunnan;dispatchEvt(new h.TowerEvent(h.TowerEvent.SHOW_TOWER_JIANGLI,t))},e.prototype.onPaiming=function(){var t=0==this._tabBar.selectedIndex?h.ShiliantaType.jiandan:h.ShiliantaType.kunnan;dispatchEvt(new h.TowerEvent(h.TowerEvent.SHOW_TOWER_RANK,t))},e.prototype.onFanHui=function(){dispatchEvt(new h.HudEvent(h.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_MAOXIAN))},e.prototype.onClickBaoxiang=function(){var t=this;this._skill&&(this.removeSkill(),this._skill=this.uiScene.scene.charPlaySkill(this.uiScene.sceneChar,"100001",tl3d.CharAction.DEATH,function(){t.uiScene.sceneChar&&t.uiScene.sceneChar.play(tl3d.CharAction.DEATH,1)})),this._bossGuanqia&&this._bossGuanqia.isPass()&&!this._bossGuanqia.isReward()&&(dispatchEvt(new h.TowerEvent(h.TowerEvent.LINGQU_BOSS_JIANGLI,this._bossGuanqia)),tl3d.ModuleEventManager.addEvent(common.GlobalEvent.DIALOG_CLOSED,this.onNextPage,this))},e.prototype.onNextPage=function(t){var e=t.data;if(e&&(e.name==UIConst.ZH_ResultView||e.name==UIConst.CommonRewardView)){tl3d.ModuleEventManager.removeEvent(common.GlobalEvent.DIALOG_CLOSED,this.onNextPage,this);var i=this._model;0==this._tabBar.selectedIndex?i.putongModel.isAllFinish()?(this._tabBar.selectedIndex=1,this._tabBar.updateLockState()):this.selectPage(i.putongModel.curPage):this.selectPage(i.kunnanModel.curPage),UIMgr.showUI(UIConst.OpenChapterView,{type:h.OpenChapterView.TYPE_SHILIANTA})}},e.prototype.removeSkill=function(){this._skill&&(this.uiScene.scene.removeCharSkill(this._skill),this._skill=null)},e.prototype.getCurGuanqia=function(){return this._curGuanqia?this._curGuanqia:this.gkitem_0},e);function e(){var t=i.call(this)||this;return t._curPage=0,t.group=UIConst.hud_group,t}h.TowerView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.tower.RankUI,__extends(n,i),n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.list_rank.array=null},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.initView=function(){this.list_rank.itemRender=t.TowerRankIR,this.dataSource?(this.list_rank.array=this.dataSource.getList(),this.lb_myrank.text=this.dataSource.getRankDesc()):(this.list_rank.array=t.TowerModel.getInstance().getRankListVo().getList(),this.lb_myrank.text=t.TowerModel.getInstance().getRankListVo().getRankDesc())},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12124)},t}t.TowerRankView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.tower.RankIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.lbName.text=t.name,this.lbGuild.text=t.guildName?LanMgr.getLan("",12125,t.guildName):"",this.lbDesc.text=t.getDesc(),this.lbValue.text=t.getValue(),this.headBox.dataSource=t.getHeadVo(),this.headBox.on(Laya.Event.CLICK,this,this.onShowInfo),this.ui_view.dataSource={rank:t.getRank()}):(this.headBox.dataSource=null,this.headBox.off(Laya.Event.CLICK,this,this.onShowInfo))},n.prototype.onShowInfo=function(){var t=this.dataSource;t&&t.uid&&UIUtil.showPlayerLineupInfo(t.uid)},n);function n(){return e.call(this)||this}t.TowerRankIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.tower.JiangliViewUI,__extends(n,i),n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.liet_item.array=null},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.initView=function(){var i,n,t=e.TowerModel.getInstance().putongModel.getJiangliList().concat(e.TowerModel.getInstance().kunnanModel.getJiangliList());t.sort(function(t,e){return i=t.isReward()?t.tbTrial.ID*t.tbTrial.type*1e3:t.tbTrial.ID*t.tbTrial.type,n=e.isReward()?e.tbTrial.ID*e.tbTrial.type*1e3:e.tbTrial.ID*e.tbTrial.type,i-n}),this.liet_item.array=t},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12126)},t}e.TowerJiangliView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.tower.JiangliIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;this._dataSource?(this.lbName.text=t.getNandu(),this.lbDesc.text=t.tbTrial.desc,this.rewardList.dataSource=t.tbTrial.getRewardList(),this.imgLingqu.visible=t.isReward()):this.rewardList.array=null},n);function n(){return e.call(this)||this}t.TowerJiangliIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var i,t=(i=ui.tower.GuanqiaViewUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){this._tbCopyInfo=this.dataSource;var t=this._tbCopyInfo;this.lbTitle.text=LanMgr.getLan("",10019)+t.name;var e=!0,i=t.getConditionVal(CopyConditionType.power);if(App.hero.force<i)this.lab_condition.text=LanMgr.getLan("",12128,i),e=!1;else{var n=tb.TB_copy.get_TB_copyById(t.area),o=s.TowerModel.getInstance().getGuanqiaModelVo(n.sub_type).getGuanqiaVo(t.ID);App.hero.level<o.getOpenLevel()?(this.lab_condition.text=LanMgr.getLan("",12129,o.getOpenLevel()),e=!1):this.lab_condition.text=""}var a=t.getRewardItems();this.listReward.array=a,this.listReward.width=100*a.length+(a.length-1)*this.listReward.spaceX,tb.TB_copy.get_TB_copyById(t.area).type;var r=(iface.tb_prop.copyTypeKey.underground,t.getIconMonster());this.lineupUI.dataSource={lineupGods:r,shenqiAry:[],showShenli:!1,title:LanMgr.getLan("",10020)},this.height=e?810:830},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._tbCopyInfo=null,this.lineupUI.dataSource=null,this.listReward.array=null},e.prototype.onChallenge=function(){this._tbCopyInfo&&(tb.TB_copy.get_TB_copyById(this._tbCopyInfo.area).type==iface.tb_prop.copyTypeKey.tower&&dispatchEvt(new s.TowerEvent(s.TowerEvent.CHALLENGE_GUANQIA,this._tbCopyInfo)),UIMgr.hideUIByName(UIConst.SLT_GuanqiaView))},e.prototype.getCopyInfo=function(){return this._tbCopyInfo||this.dataSource},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.SLT_GuanqiaView,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12127)},t.btnChallenge.on(Laya.Event.CLICK,t,t.onChallenge),t}s.TowerGuanqiaView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.tower.GuanqiaIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;t?(this.lbNum.text=t.tbCopyInfo.area_number+"",t.isPass()?(this.btnRing.stateNum=2,this.btnRing.skin=SkinUtil.getGuankaStateUrl(1)):t.isCurrent()?(this.btnRing.stateNum=2,this.btnRing.skin=SkinUtil.getGuankaStateUrl(2)):(this.btnRing.stateNum=1,this.btnRing.skin=SkinUtil.getGuankaStateUrl(0)),this.on(Laya.Event.CLICK,this,this.onClick)):this.off(Laya.Event.CLICK,this,this.onClick),this.box.visible=9!=this.index},n.prototype.onClick=function(){dispatchEvt(new t.TowerEvent(t.TowerEvent.CLICK_GUANQIA,this.dataSource))},n);function n(){var t=e.call(this)||this;return t.index=0,t}t.TowerGuanqiaIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"TowerProcessor"},i.prototype.listenModuleEvents=function(){return[new h.TowerEvent(h.TowerEvent.SHOW_SHILIANTA_PANEL),new h.TowerEvent(h.TowerEvent.PROGRESS_CHANGE),new h.TowerEvent(h.TowerEvent.CLICK_GUANQIA),new h.TowerEvent(h.TowerEvent.CHALLENGE_GUANQIA),new h.TowerEvent(h.TowerEvent.SHOW_TOWER_JIANGLI),new h.TowerEvent(h.TowerEvent.SHOW_TOWER_RANK),new h.TowerEvent(h.TowerEvent.LINGQU_BOSS_JIANGLI)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof h.TowerEvent)switch(t.type){case h.TowerEvent.SHOW_SHILIANTA_PANEL:this.showView();break;case h.TowerEvent.PROGRESS_CHANGE:this.renderGuanqia();break;case h.TowerEvent.CLICK_GUANQIA:this.clickGuanqia(t.data);break;case h.TowerEvent.CHALLENGE_GUANQIA:this.challengeGuanqia(t.data);break;case h.TowerEvent.SHOW_TOWER_JIANGLI:this.towerJinagli(t.data);break;case h.TowerEvent.SHOW_TOWER_RANK:this.towerRank(t.data);break;case h.TowerEvent.LINGQU_BOSS_JIANGLI:this.bossJiangli(t.data)}},i.prototype.showView=function(){var t=this._model.putongModel,e=t.isAllFinish()&&!t.isCanReward()?1:0;this._model.resetTowerData(),UIMgr.showUI(UIConst.ShiliantaView,e)},i.prototype.renderGuanqia=function(){UIMgr.hasStage(UIConst.ShiliantaView)&&UIMgr.getUIByName(UIConst.ShiliantaView).renderGuanqia()},i.prototype.clickGuanqia=function(t){t.isPass()?showToast(LanMgr.getLan("",10018)):t.isCurrent()?UIMgr.showUI(UIConst.SLT_GuanqiaView,t.tbCopyInfo):showToast(LanMgr.getLan("",10014))},i.prototype.challengeGuanqia=function(t){var e=tb.TB_copy.get_TB_copyById(t.area),i=this._model.getGuanqiaModelVo(e.sub_type).getGuanqiaVo(t.ID),n=t.getConditionVal(CopyConditionType.power);if(App.hero.force<n)showToast(LanMgr.getLan("",10462,n));else if(i.isPass())showToast(LanMgr.getLan("",10018));else if(i.isCurrent())if(this._model.getGuanqiaModelVo(i.tbCopy.sub_type).isCanReward())showToast(LanMgr.getLan("",10032));else if(App.hero.level<i.getOpenLevel())showToast(LanMgr.getLan("",10463,i.getOpenLevel()));else{var o=new h.FightVo;o.copyType=iface.tb_prop.copyTypeKey.tower,o.tab_copyinfo=i.tbCopyInfo,o.tab_copy=tb.TB_copy.get_TB_copyById(o.tab_copyinfo.area);var a=new battle.BattleScenePve(o.copyType);a.init([o.getOwnTeam()],o.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.monster,o.getAllRound(),o.getTeamHp()),a.start();var r=a.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",r,"战报：",a.battleReport);var s=new h.NewClientPage;s.result=r?playState.VICTORY:playState.FAILURE,s.initPage(a.battleReport),s.defType=iface.tb_prop.battleObjTypeKey.monster,o.fightPageControl=s;var u={};u[Protocol.game_copy_settleTowerCopy.args.copyId]=t.ID,u[Protocol.game_copy_settleTowerCopy.args.isWin]=r,PLC.request(Protocol.game_copy_settleTowerCopy,u,function(t,e){if(t){o.resultData=t;var i={vo:o,event:new h.TowerEvent(h.TowerEvent.SHOW_SHILIANTA_PANEL)};dispatchEvt(new h.FightsEvent(h.FightsEvent.ENTER_FIGHT_EVENT),i)}})}else showToast(LanMgr.getLan("",10014))},i.prototype.towerJinagli=function(t){t=t||h.ShiliantaType.jiandan,UIMgr.showUI(UIConst.SLT_JiangliView,t)},i.prototype.towerRank=function(t){var e=this,i={};i[Protocol.game_rank_getRankList.args.rankType]=iface.tb_prop.rankTypeKey.towerCopyFloor,PLC.request(Protocol.game_rank_getRankList,i,function(t){t&&e._model.setRankList(t.rankList,t.myRank),UIMgr.showUI(UIConst.SLT_RankView,e._model.getRankListVo())})},i.prototype.bossJiangli=function(t){if(t.isBoss)if(t.isReward())showToast(LanMgr.getLan("",10033));else{var e={};e[Protocol.game_copy_getTowerAward.args.copyId]=t.tbCopyInfo.ID,PLC.request(Protocol.game_copy_getTowerAward,e,function(t){t&&UIUtil.showRewardView(t.commonData)})}else showToast(LanMgr.getLan("",10034))},i);function i(){var t=e.call(this)||this;return t._model=h.TowerModel.getInstance(),t}h.TowerProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"TowerModule"},n.prototype.listProcessors=function(){return[new t.TowerProcessor]},n.prototype.onRegister=function(){t.TowerModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.TowerModule=i;var o,a,r=(o=tl3d.BaseEvent,__extends(s,o),s.SHOW_SHILIANTA_PANEL="SHOW_SHILIANTA_PANEL",s.PROGRESS_CHANGE="PROGRESS_CHANGE",s.GET_BOSS_AWARD_SUC="GET_BOSS_AWARD_SUC",s.CLICK_GUANQIA="CLICK_GUANQIA",s.CHALLENGE_GUANQIA="CHALLENGE_GUANQIA",s.SHOW_TOWER_JIANGLI="SHOW_TOWER_JIANGLI",s.SHOW_TOWER_RANK="SHOW_TOWER_RANK",s.LINGQU_BOSS_JIANGLI="LINGQU_BOSS_JIANGLI",s);function s(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.TowerEvent=r,(a=t.ShiliantaType||(t.ShiliantaType={}))[a.all=0]="all",a[a.jiandan=1]="jiandan",a[a.kunnan=2]="kunnan"}(game=game||{}),function(a){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initModel=function(){for(var t=tb.TB_copy.shilianFuben,e=0,i=t.length;e<i;e++){var n=t[e];n.sub_type==a.ShiliantaType.jiandan?this.putongModel=new a.GuanqiaModelVo(n):n.sub_type==a.ShiliantaType.kunnan&&(this.kunnanModel=new a.GuanqiaModelVo(n))}this.updateTime(),this.updateData()},e.prototype.resetTowerData=function(){App.serverTime>this.resetTime&&(App.hero.towerCopyInfo={},this.updateTime(),this.updateData(),logdebug("重置时间到,重置试炼塔数据："))},e.prototype.updateTime=function(){this.resetTime=getNextMonthTime(App.serverTime)},e.prototype.updateData=function(){this.putongModel.updateGuanqia(),this.kunnanModel.updateGuanqia()},e.prototype.getGuanqiaModelVo=function(t){return t==a.ShiliantaType.jiandan?this.putongModel:t==a.ShiliantaType.kunnan?this.kunnanModel:null},e.prototype.getJiangliList=function(t){return t==a.ShiliantaType.jiandan?this.putongModel.getJiangliList():this.kunnanModel.getJiangliList()},e.prototype.getGuanqiaByIndex=function(t,e){return void 0===e&&(e=a.ShiliantaType.jiandan),e==a.ShiliantaType.jiandan?this.putongModel.getGuanqiaVoByIndex(t):this.kunnanModel.getGuanqiaVoByIndex(t)},e.prototype.getGuanqiaById=function(t,e){return void 0===e&&(e=a.ShiliantaType.jiandan),e==a.ShiliantaType.all?this.putongModel.getGuanqiaVoById(t)||this.kunnanModel.getGuanqiaVoById(t):e==a.ShiliantaType.jiandan?this.putongModel.getGuanqiaVoById(t):this.kunnanModel.getGuanqiaVoById(t)},e.prototype.isRewardByIndex=function(t,e){return void 0===e&&(e=a.ShiliantaType.jiandan),this.getGuanqiaByIndex(t,e).isReward()},e.prototype.isRewardById=function(t,e){return void 0===e&&(e=a.ShiliantaType.jiandan),this.getGuanqiaById(t,e).isReward()},e.prototype.isPassCopy=function(t){var e=tb.TB_copy_info.get_TB_copy_infoById(t),i=tb.TB_copy.get_TB_copyById(e.area);return t<=this.getMaxCopyIdByChapter(i.chapter)},e.prototype.getMaxCopyIdByChapter=function(t){var e=-1;return App.hero.towerCopyInfo.hasOwnProperty(t)&&(e=Number(App.hero.towerCopyInfo[t])),e},e.prototype.getMaxCopyId=function(){var t=-1;for(var e in App.hero.towerCopyInfo)App.hero.towerCopyInfo[e]>t&&(t=App.hero.towerCopyInfo[e]);return t},e.prototype.setRankList=function(t,e){var i=[];for(var n in t){var o=new a.RankVo(t[n],parseInt(n));i.push(o)}this._rankListVo={getList:function(){return i},getRankDesc:function(){return 0<e?LanMgr.getLan("",10029,e):LanMgr.getLan("",10028)}}},e.prototype.getRankListVo=function(){return this._rankListVo},e.prototype.getCopyRankDesc=function(t){var e=tb.TB_copy_info.get_TB_copy_infoById(t);if(e){var i=tb.TB_copy.get_TB_copyById(e.area);return LanMgr.getLan("",i.sub_type==a.ShiliantaType.jiandan?10102:10103,e.area_number)}return"无"},e.prototype.getSelfRankDesc=function(){var t=App.hero.towerCopyInfo[2]?App.hero.towerCopyInfo[2]:App.hero.towerCopyInfo[1];return this.getCopyRankDesc(t)},e.PAGE_NUM=10,e);function e(){this.resetTime=0}a.TowerModel=t}(game=game||{}),function(t){var e=(i.prototype.setTbData=function(t){this.tbData=t},i.prototype.clear=function(){this.tbData=null},i.prototype.isFinish=function(){return App.hero.tasks.warriorLevel>=this.tbData.level},i.prototype.isHasRewardCommon=function(){return t.WarriorProveModel.getInstance().isRewardCommon(this.tbData.ID)},i.prototype.isCanRewardCommon=function(){return this.isFinish()&&0<this.tbData.getRewardItems().length&&!this.isHasRewardCommon()},i.prototype.isHasRewardJinjie=function(){return t.WarriorProveModel.getInstance().isRewardJinjie(this.tbData.ID)},i.prototype.isCanRewardJinjie=function(){return this.isFinish()&&t.WarriorProveModel.getInstance().isUnlockJinjie()&&0<this.tbData.getSpecialItems().length&&!this.isHasRewardJinjie()},i.prototype.isCanReward=function(){return this.isCanRewardCommon()||this.isCanRewardJinjie()},i);function i(){}t.WarriorProveVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"WarriorProveProcessor"},i.prototype.listenModuleEvents=function(){return[new a.TaskEvent(a.TaskEvent.SHOW_WARRIOR_BUY_LEVEL),new a.TaskEvent(a.TaskEvent.SHOW_WARRIOR_JINJIE),new a.TaskEvent(a.TaskEvent.TO_REWARD_LEVEL),new a.TaskEvent(a.TaskEvent.TO_REWARD_TRAIL_TASK)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof a.TaskEvent)switch(t.type){case a.TaskEvent.SHOW_WARRIOR_BUY_LEVEL:this.showBuyLevel();break;case a.TaskEvent.SHOW_WARRIOR_JINJIE:this.showJinjie();break;case a.TaskEvent.TO_REWARD_LEVEL:this.rewardLevel(t.data);break;case a.TaskEvent.TO_REWARD_TRAIL_TASK:this.rewardTrialTask(t.data)}},i.prototype.showBuyLevel=function(){this._model.isMaxLevel()?showToast(LanMgr.getLan("",10457)):UIMgr.showUI(UIConst.WarriorBuyLevelView)},i.prototype.showJinjie=function(){this._model.isUnlockJinjie()?showToast(LanMgr.getLan("",10456)):UIMgr.showUI(UIConst.WarriorJinjieView)},i.prototype.rewardLevel=function(e){if(e&&e.dataSource){var t=e.dataSource;if(t.isFinish())if(t.isHasRewardCommon()&&t.isHasRewardJinjie())showToast(LanMgr.getLan("",10460));else{var i,n=this._model,o=n.isUnlockJinjie();if(o&&t.isCanRewardJinjie())(i={})[Protocol.game_task_getWarriorAdvanceAward.args.id]=t.tbData.ID,PLC.request(Protocol.game_task_getWarriorAdvanceAward,i,function(t){t&&(n.updateAwardState(t),dispatchEvt(new a.TaskEvent(a.TaskEvent.REWARD_LEVEL_SUCC)),e.refreshView(),t&&t.commonData&&UIUtil.showRewardView(t.commonData))});else if(t.isCanRewardCommon())(i={})[Protocol.game_task_getWarriorLevelAward.args.id]=t.tbData.ID,PLC.request(Protocol.game_task_getWarriorLevelAward,i,function(t){t&&(n.updateAwardState(t),dispatchEvt(new a.TaskEvent(a.TaskEvent.REWARD_LEVEL_SUCC)),e.refreshView(),t&&t.commonData&&UIUtil.showRewardView(t.commonData))});else if(!o)return showToast(LanMgr.getLan("",10461)),void this.showJinjie()}else showToast(LanMgr.getLan("",10459))}},i.prototype.rewardTrialTask=function(i){var t,n=this;i.isFinish()?i.isReward()?showToast(LanMgr.getLan("",10033)):i.isWeek?((t={})[Protocol.game_task_getWarriorWeekReward.args.id]=i.tbData.ID,PLC.request(Protocol.game_task_getWarriorWeekReward,t,function(t){if(t){a.TrialTaskModel.getInstance().modifyReward(t.modifyWarriorWeekReward,!0);var e=[];e.push(new ItemVo(CostTypeKey.warrior_prove,i.tbData.obtain_exp)),UIUtil.showRewardView({clientAddItemVoList:e}),n.updateTaskTabView(a.TaskTabType.trial)}})):((t={})[Protocol.game_task_getWarriorMonthReward.args.id]=i.tbData.ID,PLC.request(Protocol.game_task_getWarriorMonthReward,t,function(t){if(t){a.TrialTaskModel.getInstance().modifyReward(t.modifyWarriorMonthReward,!1);var e=[];e.push(new ItemVo(CostTypeKey.warrior_prove,i.tbData.obtain_exp)),UIUtil.showRewardView({clientAddItemVoList:e}),n.updateTaskTabView(a.TaskTabType.trial)}})):dispatchEvt(new a.TaskEvent(a.TaskEvent.TRIAL_TASK_GO,i))},i.prototype.updateTaskTabView=function(t){UIMgr.hasStage(UIConst.TaskView)&&UIMgr.getUIByName(UIConst.TaskView).onRefreshTask()},i);function i(){var t=e.call(this)||this;return t._model=a.WarriorProveModel.getInstance(),t}a.WarriorProveProcessor=t}(game=game||{}),function(f){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.resetDataByCrossDay=function(t){this.initModel(),UIMgr.hideUIByName(UIConst.WarriorBuyLevelView),UIMgr.hideUIByName(UIConst.WarriorJinjieView)},e.prototype.initModel=function(){var e=this,t=new Date(App.serverTime),i=t.getFullYear(),n=t.getMonth()+1;this.curTabCycle=tb.TB_warrior_cycle.getList().find(function(t){return t.time==100*i+n});for(var o=0,a=this._levelList;o<a.length;o++){var r=a[o];r.clear(),Laya.Pool.recover("WarriorProveVo",r)}if(this._levelList.length=0,this.maxLevel=0,this.startTime=0,this.endTime=0,this.curTabCycle){var s=Math.floor(this.curTabCycle.time/100),u=this.curTabCycle.time%100,h=new Date(s,u-1,1,0,0,0,0);this.startTime=h.getTime()/1e3;var l=new Date(s,u,1,0,0,0,0);this.endTime=l.getTime()/1e3;var c=this.curTabCycle.ID,p=tb.TB_warrior_prove.getList().filter(function(t){return t.cycle==c});p.sort(function(t,e){return t.level-e.level}),p.forEach(function(t){t.level>e.maxLevel&&(e.maxLevel=t.level)}),tb.TB_warrior_cycle.getList();for(var d=0;d<p.length;d++){var _=Laya.Pool.getItemByClass("WarriorProveVo",f.WarriorProveVo);_.setTbData(p[d]),this._levelList.push(_)}}f.TrialTaskModel.getInstance().initModel()},e.prototype.updateAwardState=function(t){t.hasOwnProperty("modifyWarriorLevelAward")&&App.hero.tasks.warriorLevelAwards.push(t.modifyWarriorLevelAward),t.hasOwnProperty("modifyWarriorAdvanceAward")&&App.hero.tasks.warriorAdvanceAwards.push(t.modifyWarriorAdvanceAward)},e.prototype.isOpen=function(){return!!f.HudModel.isHudShow(ModuleConst.WARRIOR_PROVE)&&App.IsSysOpen(ModuleConst.WARRIOR_PROVE)&&this.isInCycle()&&App.serverTimeSecond>=App.getOpenServerTime()+7*TimeConst.ONE_DAY_SEC},e.prototype.isInCycle=function(){return!!this.curTabCycle},e.prototype.getWarriorList=function(){return this._levelList},e.prototype.getWarriorVoByLv=function(e){return this._levelList.find(function(t){return t.tbData.level==e})},e.prototype.getTimeStr=function(){if(!this.curTabCycle)return"";var t=new Date(1e3*this.startTime),e=new Date(1e3*this.endTime-1),i=t.getMonth()+1;return LanMgr.getLan("",12135,i,t.getDate(),i,e.getDate())},e.prototype.getCurTbLevel=function(){var e=App.hero.tasks.warriorLevel;return 0<e?this._levelList.find(function(t){return t.tbData.level==e}):null},e.prototype.isCanReward=function(){return!!this.isOpen()&&this._levelList.some(function(t){return t.isCanReward()})},e.prototype.isCanRewardGift=function(){return!!this.isOpen()&&this.isUnlockJinjie()&&!this.isRewardWeekGift()},e.prototype.isMaxLevel=function(){return App.hero.tasks.warriorLevel>=this.maxLevel},e.prototype.isUnlockJinjie=function(){return 1==App.hero.tasks.warriorAdvance},e.prototype.isRewardCommon=function(t){return-1!=App.hero.tasks.warriorLevelAwards.indexOf(t)},e.prototype.isRewardJinjie=function(t){return-1!=App.hero.tasks.warriorAdvanceAwards.indexOf(t)},e.prototype.isRewardWeekGift=function(){return 1==App.hero.tasks.warriorWeekAward},e);function e(){this._levelList=[]}f.WarriorProveModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.task.warrior.WarriorJinjieUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.WarriorJinjieView,closeOnSide:this.isModelClose,title:"comp/title/jinjiejiangli.png"},this.btnBuy.on(Laya.Event.CLICK,this,this.onBuy)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.listExtral.array=null,this.listReward.array=null},e.prototype.initView=function(){var t=o.WarriorProveModel.getInstance().curTabCycle;this.lbAddLv.text=LanMgr.getLan("",12136,t.level_up);var e=t.getRewardItems();this.listReward.array=e,this.listReward.width=5<=e.length?480:100*e.length+(e.length-1)*this.listReward.spaceX;var i=t.getShowItems();this.listExtral.array=i,this.listExtral.width=100*i.length+(i.length-1)*this.listExtral.spaceX,this.listExtral.width=5<=i.length?480:100*i.length+(i.length-1)*this.listExtral.spaceX;var n=tb.TB_recharge.get_TB_rechargeById(t.recharge_id);this.btnBuy.label="￥"+n.recharge_count},e.prototype.onBuy=function(){if(o.WarriorProveModel.getInstance().isUnlockJinjie())showToast(LanMgr.getLan("",10456));else{var t=o.WarriorProveModel.getInstance().curTabCycle,e=t?tb.TB_recharge.get_TB_rechargeById(t.recharge_id):null;if(e){var i=Number(window.platform.pid);if(o.ChongzhiModel.isRealPay(i)){var n=tb.TB_recharge.get_TB_rechargeById(e.ID);o.ChongzhiModel.pay(n)}else UIUtil.payDebug(e.ID)}}},e);function e(){return i.call(this)||this}o.WarriorJinjieView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var e,t=(e=ui.task.itemrender.WarriorIRUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),i.prototype.refreshView=function(){var t=this.dataSource;if(t){this.lbLv.text=t.tbData.level+"";var e=t.tbData.getRewardItems();this.listReward.array=e;var i=t.tbData.getSpecialItems();this.listSpecail.array=i,this.btnLingqu.disabled=!1;var n=t.isFinish(),o=t.isCanRewardCommon(),a=t.isCanRewardJinjie(),r=l.WarriorProveModel.getInstance().isUnlockJinjie();n?o?(this.btnLingqu.label=LanMgr.getLan("",10041),this.btnLingqu.skin=SkinUtil.buttonGreen,this.btnLingqu.labelStrokeColor=ColorConst.GREEN_FILTER):a?(this.btnLingqu.label=0==e.length?LanMgr.getLan("",10041):LanMgr.getLan("",12001),this.btnLingqu.skin=SkinUtil.buttonGreen,this.btnLingqu.labelStrokeColor=ColorConst.GREEN_FILTER):r?(this.btnLingqu.label=LanMgr.getLan("",10043),this.btnLingqu.skin=SkinUtil.buttonNormal,this.btnLingqu.labelStrokeColor=ColorConst.ORANGE_FILTER,this.btnLingqu.disabled=!0):(this.btnLingqu.label=0==e.length?LanMgr.getLan("",10041):LanMgr.getLan("",12001),this.btnLingqu.skin=SkinUtil.buttonNormal,this.btnLingqu.labelStrokeColor=ColorConst.ORANGE_FILTER):(this.btnLingqu.label=LanMgr.getLan("",10045),this.btnLingqu.skin=SkinUtil.buttonNormal,this.btnLingqu.labelStrokeColor=ColorConst.ORANGE_FILTER),this.imgRedpoint.visible=t.isCanReward(),this.btnLingqu.on(Laya.Event.CLICK,this,this.onClick)}else this.listReward.array=null,this.listSpecail.array=null,this.btnLingqu.off(Laya.Event.CLICK,this,this.onClick)},i.prototype.onRenderSpecial=function(t,e){var i=this.dataSource;if(t&&i){var n=this.listSpecail.getItem(e),o=t.getChildByName("itemBox"),a=t.getChildByName("imgZhezhao"),r=t.getChildByName("imgSuo"),s=t.getChildByName("imgGouxuan");if(n){var u=l.WarriorProveModel.getInstance().isUnlockJinjie(),h=i.isHasRewardJinjie();o.dataSource=n,r.visible=!u,s.visible=h,a.visible=!u||h}else o.dataSource=null}},i.prototype.onRenderCommon=function(t,e){var i=this.dataSource;if(t&&i){var n=this.listReward.getItem(e),o=t.getChildByName("itemBox"),a=t.getChildByName("imgZhezhao"),r=t.getChildByName("imgGouxuan");n?(o.dataSource=n,r.visible=a.visible=i.isHasRewardCommon()):o.dataSource=null}},i.prototype.onClick=function(){this.dataSource&&dispatchEvt(new l.TaskEvent(l.TaskEvent.TO_REWARD_LEVEL),this)},i);function i(){var t=e.call(this)||this;return t.listSpecail.renderHandler=new Handler(t,t.onRenderSpecial),t.listReward.renderHandler=new Handler(t,t.onRenderCommon),t}l.WarriorIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(d){var i,t=(i=ui.task.warrior.WarriorBuyLevelUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.WarriorBuyLevelView,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12137)},this.addChild(this.bgPanel.btnClose),this._counterBar=new common.CounterBar,this._counterBar.setComponent(this.btnAddOne,this.btnAddTen,this.btnDelOne,this.btnDelTen,this.lbLv),this.btnBuy.on(Laya.Event.CLICK,this,this.onBuy)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.listReward.array=null},e.prototype.initView=function(){var t=d.WarriorProveModel.getInstance();this._buymaxnum=t.maxLevel-App.hero.tasks.warriorLevel,this._buyNum=1,this._counterBar.setInitData(this._buyNum,this._buymaxnum,this.setBuyLv.bind(this)),this.setBuyLv()},e.prototype.setBuyLv=function(){var t=d.WarriorProveModel.getInstance(),e=t.curTabCycle;if(e){this._buyNum=this._counterBar.getCurNum();var i=App.hero.tasks.warriorLevel+this._buyNum;this.lbLv.text=this._buyNum.toString(),this._buysumMoney=this._buyNum*e.buy_cost,this.lbCost.text="X"+Snums(this._buysumMoney),this.lbCost.color=App.hero.diamond>=this._buysumMoney?ColorConst.normalFont:ColorConst.RED,this.lbBuyDesc.text=LanMgr.getLan("",12138,this._buyNum,i),this.lbDesc.text=LanMgr.getLan("",12139,i);for(var n={},o=App.hero.tasks.warriorLevel+1;o<=i;o++){var a=t.getWarriorVoByLv(o);if(a){for(var r=0,s=a.tbData.getRewardItems();r<s.length;r++){var u=s[r];n.hasOwnProperty(u.id)||(n[u.id]=0),n[u.id]+=u.count}if(t.isUnlockJinjie())for(var h=0,l=a.tbData.getSpecialItems();h<l.length;h++)u=l[h],n.hasOwnProperty(u.id)||(n[u.id]=0),n[u.id]+=u.count}}var c=[];for(var p in n)c.push(new ItemVo(Number(p),n[p]));this.listReward.array=c,this.boxEmpty.visible=0==c.length,this.listReward.width=5<=c.length?480:100*c.length+(c.length-1)*this.listReward.spaceX}},e.prototype.onBuy=function(){var e=this;if(!UIUtil.checkNotEnough(iface.tb_prop.resTypeKey.diamond,this._buysumMoney)){var t={};t[Protocol.game_task_buyWarriorLevel.args.level]=this._buyNum,PLC.request(Protocol.game_task_buyWarriorLevel,t,function(t){t&&(showToast(LanMgr.getLan("",10455)),e.close())})}},e);function e(){var t=i.call(this)||this;return t._buyNum=1,t._buymaxnum=0,t._buysumMoney=0,t}d.WarriorBuyLevelView=t}(game=game||{}),function(t){var e=(i.prototype.setTbData=function(t,e){this.tbData=t,this.isWeek=e},i.prototype.clear=function(){this.tbData=null},i.prototype.getTitle=function(){return this.isWeek?""+LanMgr.getLan("",12140)+this.tbData.title:""+LanMgr.getLan("",12141)+this.tbData.title},i.prototype.getNum=function(){return t.TrialTaskModel.getInstance().getFinishNum(this.tbData.ID,this.isWeek)},i.prototype.isFinish=function(){return this.getNum()>=this.tbData.num},i.prototype.isReward=function(){return t.TrialTaskModel.getInstance().isReward(this.tbData.ID,this.isWeek)},i.prototype.isCanReward=function(){return this.isFinish()&&!this.isReward()},i);function i(){this.sortNum=0}t.TrialTaskVo=e}(game=game||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(l){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initModel=function(){for(var t=0,e=this._weekList;t<e.length;t++)(o=e[t]).clear(),Laya.Pool.recover("TrialTaskVo",o);for(var i=this._weekList.length=0,n=this._monthList;i<n.length;i++){var o;(o=n[i]).clear(),Laya.Pool.recover("TrialTaskVo",o)}this._monthList.length=0,this.weekStartTime=0,this.weekEndTime=0,this.monthStartTime=0,this.monthEndTime=0;var a=l.WarriorProveModel.getInstance().curTabCycle;if(a){this.weekStartTime=l.GloryUtil.getFormatTime(1,0,0,0),this.weekEndTime=l.GloryUtil.getFormatTime(7,23,59,59)+1,this.monthStartTime=l.WarriorProveModel.getInstance().startTime,this.monthEndTime=l.WarriorProveModel.getInstance().endTime;for(var r=tb.TB_week_trial.getList("cycle",a.ID),s=0;s<r.length;s++)(h=Laya.Pool.getItemByClass("TrialTaskVo",l.TrialTaskVo)).setTbData(r[s],!0),this._weekList.push(h);var u=tb.TB_month_trial.getList("cycle",a.ID);for(s=0;s<u.length;s++){var h;(h=Laya.Pool.getItemByClass("TrialTaskVo",l.TrialTaskVo)).setTbData(u[s],!1),this._monthList.push(h)}}},e.prototype.getWeekList=function(t){void 0===t&&(t=!1);var e=__spreadArrays(this._weekList);return t&&(e.forEach(function(t){t.sortNum=t.isReward()?1e5+t.tbData.ID:t.isFinish()?t.tbData.ID:1e4+t.tbData.ID}),e.sort(function(t,e){return t.sortNum-e.sortNum})),e},e.prototype.getMonthList=function(t){void 0===t&&(t=!1);var e=__spreadArrays(this._monthList);return t&&(e.forEach(function(t){t.sortNum=t.isReward()?1e5+t.tbData.ID:t.isFinish()?t.tbData.ID:1e4+t.tbData.ID}),e.sort(function(t,e){return t.sortNum-e.sortNum})),e},e.prototype.modifyReward=function(t,e){var i=t||{};for(var n in i)if(e){var o=App.hero.tasks.warriorWeekTasks||{};o[n]||(o[n]={count:0,reward:0}),o[n].reward=i[n]}else{var a=App.hero.tasks.warriorMonthTasks||{};a[n]||(a[n]={count:0,reward:0}),a[n].reward=i[n]}dispatchEvt(new l.TaskEvent(l.TaskEvent.UPDATE_TRIAL_TASK_REWARD))},e.prototype.modifyFinishNum=function(t,e){var i=t||{};for(var n in i)if(e){var o=App.hero.tasks.warriorWeekTasks||{};o[n]||(o[n]={count:0,reward:0}),o[n].count=i[n]}else{var a=App.hero.tasks.warriorMonthTasks||{};a[n]||(a[n]={count:0,reward:0}),a[n].count=i[n]}dispatchEvt(new l.TaskEvent(l.TaskEvent.UPDATE_TRIAL_TASK_COUNT))},e.prototype.isCanReward=function(t){return!!l.WarriorProveModel.getInstance().isOpen()&&(0==t?this._weekList.some(function(t){return t.isCanReward()}):this._monthList.some(function(t){return t.isCanReward()}))},e.prototype.getFinishNum=function(t,e){var i=App.hero.tasks.warriorWeekTasks||{},n=App.hero.tasks.warriorMonthTasks||{},o=e?i[t]:n[t];return o?o.count:0},e.prototype.isReward=function(t,e){var i=App.hero.tasks.warriorWeekTasks||{},n=App.hero.tasks.warriorMonthTasks||{},o=e?i[t]:n[t];return!!o&&1==o.reward},e.prototype.isRewardWeekGift=function(){return 1==App.hero.tasks.warriorWeekAward},e);function e(){this.weekStartTime=0,this.weekEndTime=0,this.monthStartTime=0,this.monthEndTime=0,this._weekList=[],this._monthList=[]}l.TrialTaskModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.task.itemrender.TrialIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;if(t){this.lbTitle.text=t.getTitle(),this.lbGetNum.text=t.tbData.obtain_exp+"",this.lbCount.text=t.getNum()+"/"+t.tbData.num,this.pbNum.value=t.getNum()/t.tbData.num;var e=t.isFinish(),i=t.isReward();this.lbContent.text=t.tbData.name,i?(this.btnLingqu.label=LanMgr.getLan("",10043),this.btnLingqu.skin=SkinUtil.buttonNormal,this.btnLingqu.labelStrokeColor=ColorConst.ORANGE_FILTER,this.btnLingqu.disabled=!0,this.lbContent.color=ColorConst.normalFont):(this.btnLingqu.disabled=!1,e?(this.btnLingqu.label=LanMgr.getLan("",10041),this.btnLingqu.skin=SkinUtil.buttonGreen,this.btnLingqu.labelStrokeColor=ColorConst.GREEN_FILTER,this.lbContent.color=ColorConst.GREEN):(this.btnLingqu.label=LanMgr.getLan("",10042),this.btnLingqu.skin=SkinUtil.buttonNormal,this.btnLingqu.labelStrokeColor=ColorConst.ORANGE_FILTER,this.lbContent.color=ColorConst.RED)),this.imgRedpoint.visible=e&&!i,this.btnLingqu.on(Laya.Event.CLICK,this,this.onClick)}else this.btnLingqu.off(Laya.Event.CLICK,this,this.onClick)},n.prototype.onClick=function(){var t=this.dataSource;t&&dispatchEvt(new e.TaskEvent(e.TaskEvent.TO_REWARD_TRAIL_TASK,t))},n);function n(){return t.call(this)||this}e.TrialTaskIR=i}(game=game||{}),function(e){var a=(t.prototype.getTaskVo=function(){return this._taskVo||(this._taskVo=e.TaskModel.getInstance().getTaskVoById(this.taskId)),this._taskVo},t.prototype.getSortNum=function(){var t=this.tbTask.label==AchievementTabType.challenge?this.tbTask.rank:this.tbTask.ID;return this.isCanReward()?t+=1e5:this.isReward()?t+=1e8:t+=1e7,t},t.prototype.getName=function(){return this.tbTask.name},t.prototype.getTotalNum=function(){return this.tbTask.check_num},t.prototype.isFinish=function(){return!!this.isReward()||this.getCount()>=this.tbTask.check_num},t.prototype.getCount=function(){if(this.isReward())return this.tbTask.check_num;var t=0;return this.getTaskVo()&&(t=this._taskVo.count>this.tbTask.check_num?this.tbTask.check_num:this._taskVo.count),t=t<0?0:t},t.prototype.isReward=function(){return-1!=App.hero.tasks.doneTasks.indexOf(this.taskId)},t.prototype.isCanReward=function(){return this.isFinish()&&!this.isReward()},t.prototype.isExcuting=function(){if(this.tbTask.label!=AchievementTabType.challenge)return!1;var t=e.BianQiangModel.getInstance().getChallengeTabData(this.tbTask.sub_label).getCurTask();return t&&t.tbTask.ID==this.tbTask.ID},t.prototype.getRewardList=function(){if(!this._rewardList){function t(t,e){var i={getQulity:function(){return""},getIconUrl:function(){return SkinUtil.getCostSkin(parseInt(n[t][0]))},getNum:function(){return parseInt(n[t][1])},getShow:function(){return!1},getConstNum:function(){return 0},isStartAction:function(){return!1},isChip:function(){return!1},showRace:function(){return 0},getStar:function(){return 0},isMoreThanSix:function(){return!1},getExtParm:function(){return null}};o._rewardList.push(i)}this._rewardList=[];for(var n=this.tbTask.reward,o=this,e=0,i=n.length;e<i;e++)t(e)}return this._rewardList},t.prototype.getItemList=function(){if(!this._itemList){this._itemList=[];for(var t=this.tbTask.reward,e=0,i=t.length;e<i;e++){var n=new ItemVo(parseInt(t[e][0]),parseInt(t[e][1]));n.isShowEff=!1,this._itemList.push(n)}}return this._itemList},t);function t(t){this.taskId=t,this.tbTask=tb.TB_task.getTaskById(t),this.getTaskVo()}e.TaskVo=a;var i=(n.prototype.getList=function(){if(!this._list){this._list=[];for(var t=tb.TB_task.getAchievementListByType(AchievementTabType.challenge,this.subLbType),e=0,i=t.length;e<i;e++){var n=t[e],o=new a(n.ID);this._list.push(o)}}return this.sortList(),this._list},n.prototype.sortList=function(){this._list&&this._list.sort(function(t,e){return t.getSortNum()-e.getSortNum()})},n.prototype.getTaskById=function(e){return this.getList().find(function(t){return t.taskId==e})},n.prototype.getTaskByIdx=function(t){return this.getList()[t]},n.prototype.getCount=function(){for(var t=0,e=0,i=this.getList();e<i.length;e++)i[e].isReward()&&t++;return t},n.prototype.getAllCount=function(){return this.getList().length},n.prototype.getCurTask=function(){for(var t=this.getList(),e=0,i=t.length;e<i;e++){var n=t[e];if(!n.isReward())return n}return null},n.prototype.canReward=function(){return this.getList().some(function(t){return t.isCanReward()})},n.prototype.isAllFinish=function(){return!this.getCurTask()},n);function n(t){this.subLbType=t,this.tbTitle=tb.TB_task_title.getCfgById(t)}e.ChallengeTabData=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.task.TaskUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.TaskView,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12130)},this._model=n.TaskModel.getInstance(),this.addChild(this.bgPanel.btnClose),this.listBtns.renderHandler=new Laya.Handler(this,this.onRenderTab),this.listBtns.selectedIndex=-1},e.prototype.initTaskTabBtns=function(){var t=n.WarriorProveModel.getInstance().isOpen();if(!this._tabOperate||this._openState!=t){var e=(this._openState=t)?[n.TaskTabType.daily,n.TaskTabType.warrior,n.TaskTabType.trial,n.TaskTabType.achievement]:[n.TaskTabType.daily,n.TaskTabType.achievement];this.listBtns.array=this._model.getTabListVo(e),this._tabInfoList=[];for(var i=0;i<e.length;i++)this._tabInfoList.push(this.buildTabInfo(e[i]));this._tabOperate||(this._tabOperate=new common.TabListOperate(this.listBtns,this.boxContent)),this._tabOperate.setTabItemist(this._tabInfoList)}},e.prototype.buildTabInfo=function(t){var e=this._model.getTabViewDatas(t);return{viewName:e.viewName,viewClz:e.viewClz,onSelectVerify:function(){return!!(t!=n.TaskTabType.warrior&&t!=n.TaskTabType.trial||n.WarriorProveModel.getInstance().curTabCycle)||(showToast(LanMgr.getLan("",10454)),!1)},onSelectAfter:function(){},onShow:function(t){t&&GameUtil.isFunction(t.initView)&&t.initView()},onHide:function(t){t&&GameUtil.isFunction(t.close)&&t.close()},onClosed:function(t){t&&GameUtil.isFunction(t.close)&&t.close()},dataSource:null}},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._tabOperate.viewDispose(),tl3d.ModuleEventManager.removeEvent(n.TaskEvent.UPDATE_ACHIEVEMENT_DATA,this.onRefreshTask,this),tl3d.ModuleEventManager.removeEvent(n.TaskEvent.UPDATE_DAILY_TASK,this.onRefreshTask,this)},e.prototype.initView=function(){this.initTaskTabBtns();var t=this.dataSource||0;t>=this._tabOperate.getViewNum()&&(t=0),this.listBtns.selectedIndex=t,tl3d.ModuleEventManager.addEvent(n.TaskEvent.UPDATE_ACHIEVEMENT_DATA,this.onRefreshTask,this),tl3d.ModuleEventManager.addEvent(n.TaskEvent.UPDATE_DAILY_TASK,this.onRefreshTask,this)},e.prototype.onSelectTab=function(t){this.listBtns.selectedIndex=t},e.prototype.onRenderTab=function(t,e){if(t){var i=t.getChildByName("btnTab"),n=t.getChildByName("redpoint"),o=this.listBtns.getItem(e);o?(n.setRedPointName(o[2]),i.label=o[1],i.selected=this.listBtns.selectedIndex==e):n.onDispose()}},e.prototype.refreshTaskList=function(){if(this.listBtns.selectedIndex==n.TaskTabType.daily){var t=this.tabDaily;t&&t.refreshTaskList()}},e.prototype.refreshLiveness=function(){if(this.listBtns.selectedIndex==n.TaskTabType.daily){var t=this.tabDaily;t&&t.refreshLiveness()}},e.prototype.onRefreshTask=function(){var t=this._tabOperate?this._tabOperate.getSelectedName():"";if(t==n.TaskModel.tabDaily)(e=this.tabDaily)&&e.onReresh();else if(t==n.TaskModel.tabWarrior)(e=this.tabWarrior)&&e.onReresh();else if(t==n.TaskModel.tabTrial)(e=this.tabTrial)&&e.onReresh();else if(t==n.TaskModel.tabAchievement){var e;(e=this.tabAchievement)&&e.onReresh()}},Object.defineProperty(e.prototype,"tabDaily",{get:function(){return this._tabOperate?this._tabOperate.getViewByName(n.TaskModel.tabDaily):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabWarrior",{get:function(){return this._tabOperate?this._tabOperate.getViewByName(n.TaskModel.tabWarrior):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabTrial",{get:function(){return this._tabOperate?this._tabOperate.getViewByName(n.TaskModel.tabTrial):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabAchievement",{get:function(){return this._tabOperate?this._tabOperate.getViewByName(n.TaskModel.tabAchievement):null},enumerable:!0,configurable:!0}),e);function e(){var t=i.call(this)||this;return t._openState=!1,t}n.TaskView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=tl3d.Processor,__extends(n,t),n.prototype.getName=function(){return"TaskProcessor"},n.prototype.listenModuleEvents=function(){return[new i.TaskEvent(i.TaskEvent.SHOW_TASK_VIEW),new i.TaskEvent(i.TaskEvent.SHOW_DETAIL_ACHIEVEMENT),new i.TaskEvent(i.TaskEvent.TASK_GOTO),new i.TaskEvent(i.TaskEvent.DAILY_TASK_GOTO),new i.TaskEvent(i.TaskEvent.TRIAL_TASK_GO),new i.TaskEvent(i.TaskEvent.RECEIVE_TASK_REWARD)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof i.TaskEvent)switch(t.type){case i.TaskEvent.SHOW_TASK_VIEW:this.showUI(t.data);break;case i.TaskEvent.SHOW_DETAIL_ACHIEVEMENT:this.showDetailUI(t.data);break;case i.TaskEvent.TASK_GOTO:this.goto(t.data);break;case i.TaskEvent.RECEIVE_TASK_REWARD:this.receiveTaskReward(t.data);break;case i.TaskEvent.DAILY_TASK_GOTO:this.gotoDaily(t.data);break;case i.TaskEvent.TRIAL_TASK_GO:this.gotoTrial(t.data)}},n.prototype.showUI=function(t){void 0===t&&(t=0),UIMgr.showUI(UIConst.TaskView,t||0)},n.prototype.showDetailUI=function(t){UIMgr.showUI(UIConst.ChallengeDetailView,t)},n.prototype.goto=function(t){logdebug("任务界面跳转:",t.link),dispatchEvt(new i.HudEvent(i.HudEvent.SHOW_MODULE_VIEW,t.link))},n.prototype.gotoDaily=function(t){logdebug("日常任务界面跳转:",t.link),dispatchEvt(new i.HudEvent(i.HudEvent.SHOW_MODULE_VIEW,t.link))},n.prototype.gotoTrial=function(t){logdebug("试炼任务界面跳转:",t.tbData.link),dispatchEvt(new i.HudEvent(i.HudEvent.SHOW_MODULE_VIEW,t.tbData.link))},n.prototype.receiveTaskReward=function(t){if(t.isCanReward()){var e={};e[Protocol.game_task_getTaskAward.args.taskId]=t.tbTask.ID,PLC.request(Protocol.game_task_getTaskAward,e,function(t){t&&(UIMgr.hasStage(UIConst.TaskView)&&UIMgr.getUIByName(UIConst.TaskView).refreshTaskList(),UIMgr.hasStage(UIConst.BianQiangView)&&UIMgr.getUIByName(UIConst.BianQiangView).resetTaskList(),t&&t.commonData&&UIUtil.showRewardView(t.commonData),dispatchEvt(new i.TaskEvent(i.TaskEvent.REWARD_TASK_SUCCESS)))})}},n);function n(){return t.call(this)||this}i.TaskProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"TaskModule"},n.prototype.listProcessors=function(){return[new t.TaskProcessor,new t.DailyTaskProcessor,new t.WarriorProveProcessor]},n.prototype.onRegister=function(){t.TaskModel.getInstance().initModel(),t.WarriorProveModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.TaskModule=i;var o,a,r=(o=tl3d.BaseEvent,__extends(s,o),s.REWARD_TASK_SUCCESS="REWARD_TASK_SUCCESS",s.SHOW_TASK_VIEW="SHOW_TASK_VIEW",s.SHOW_DETAIL_ACHIEVEMENT="SHOW_DETAIL_TASK",s.UPDATE_ACHIEVEMENT_DATA="UPDATE_ACHIEVEMENT_DATA",s.UPDATE_LIMIT_TASK="UPDATE_LIMIT_TASK",s.SHOW_DAILY_TASK="SHOW_DAILY_TASK",s.UPDATE_DAILY_TASK="UPDATE_DAILY_TASK",s.CLICK_DAILY_TASK="CLICK_DAILY_TASK",s.REWARD_LIVENESS="REWARD_LIVENESS",s.UPDATE_LIVENESS_DATA="UPDATE_LIVENESS_DATA",s.TASK_GOTO="TASK_GOTO",s.DAILY_TASK_GOTO="DAILY_TASK_GOTO",s.TRIAL_TASK_GO="TRIAL_TASK_GO",s.RECEIVE_TASK_REWARD="RECEIVE_TASK_REWARD",s.SHOW_WARRIOR_BUY_LEVEL="SHOW_WARRIOR_BUY_LEVEL",s.SHOW_WARRIOR_JINJIE="SHOW_WARRIOR_JINJIE",s.TO_REWARD_LEVEL="TO_REWARD_LEVEL",s.TO_REWARD_TRAIL_TASK="REWARD_TRAIL_TASK",s.REWARD_LEVEL_SUCC="REWARD_LEVEL_SUCC",s.UPDATE_WARRIOR_EXP="UPDATE_WARRIOR_EXP",s.UPDATE_TRIAL_TASK_COUNT="UPDATE_TRIAL_TASK_COUNT",s.UPDATE_TRIAL_TASK_REWARD="UPDATE_TRIAL_TASK_REWARD",s.UNLOCK_WARRIOR_JINJIE_SUCC="UNLOCK_WARRIOR_JINJIE_SUCC",s.REWARD_WEEK_GIFT_SUCC="REWARD_WEEK_GIFT_SUCC",s);function s(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.TaskEvent=r,(a=t.TaskTabType||(t.TaskTabType={}))[a.daily=0]="daily",a[a.warrior=1]="warrior",a[a.trial=2]="trial",a[a.achievement=3]="achievement"}(game=game||{}),function(o){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.resetDataByCrossDay=function(t){var e=App.hero.tasks;for(var i in e)t.hasOwnProperty(i)&&(e[i]=t[i]);for(var n in App.hero.updateDailyLivess(t),e.dailyTasks=t.dailyTasks,e.dailyTasks)e.dailyTasks[n].id=parseInt(n);this._dailyTasks=null,this.getDailyTasks(!0),o.WarriorProveModel.getInstance().resetDataByCrossDay(t),UIMgr.hideUIByName(UIConst.TaskView)},e.prototype.initModel=function(){this._tabMap[o.TaskTabType.daily]=[o.TaskTabType.daily,LanMgr.getLan("",12131),"task_daily_group"],this._tabMap[o.TaskTabType.warrior]=[o.TaskTabType.warrior,LanMgr.getLan("",12132),"task_warrior_group"],this._tabMap[o.TaskTabType.trial]=[o.TaskTabType.trial,LanMgr.getLan("",12133),"task_trial_group"],this._tabMap[o.TaskTabType.achievement]=[o.TaskTabType.achievement,LanMgr.getLan("",12134),"task_achievement_group"]},e.prototype.getTabViewDatas=function(t){switch(t){case o.TaskTabType.daily:return{viewName:e.tabDaily,viewClz:o.TabDailyTaskView};case o.TaskTabType.warrior:return{viewName:e.tabWarrior,viewClz:o.TabWarriorView};case o.TaskTabType.trial:return{viewName:e.tabTrial,viewClz:o.TabTrialView};case o.TaskTabType.achievement:return{viewName:e.tabAchievement,viewClz:o.TabAchievementView}}return null},e.prototype.getTabListVo=function(t){for(var e=[],i=0;i<t.length;i++)e.push(this._tabMap[t[i]]);return e},e.prototype.getDailyTasks=function(t){if(void 0===t&&(t=!1),!this._dailyTasks){this._dailyTasks=[];var e=App.hero.tasks.dailyTasks;for(var i in e)this._dailyTasks.push(new o.DailyTaskVo(e[i]))}return t&&this._dailyTasks.sort(function(t,e){return t.getSortNum()-e.getSortNum()}),this._dailyTasks},e.prototype.getViewList=function(){return this.getDailyTasks(!0).filter(function(t){return t.isOpen()})},e.prototype.getLivenessList=function(){if(!this._livenessList){this._livenessList=[];var t=TableData.getInstance().getTableByName(TableData.tb_daily_reward).data;for(var e in t)this._livenessList.push(new o.DailyLivenessData(t[e]));this._livenessList.sort(function(t,e){return t.tbLiveness.ID-e.tbLiveness.ID})}return this._livenessList},e.prototype.canRewardDailyTask=function(){var t=this.getDailyTasks(!1).some(function(t){return t.isCanReward()});return t=t||this.getLivenessList().some(function(t){return t.isCanReward()})},e.prototype.getHonorTasks=function(){return this._honorTasks},e.prototype.updateHonorList=function(){this._honorTasks=[];var t=App.hero.tasks.curTasks;for(var e in t){var i=t[e],n=tb.TB_task.getTaskById(i.id);n?n.type==iface.tb_prop.taskTypeKey.achievement&&n.label==AchievementTabType.honor&&this._honorTasks.push(new o.TaskVo(i.id)):logerror("未找到("+i.id+")tb.TB_task")}this._honorTasks.sort(function(t,e){return t.getSortNum()-e.getSortNum()})},e.prototype.canRewardHonor=function(){return this._honorTasks.some(function(t){return t.isCanReward()})},e.prototype.getTaskVoById=function(t){var e=App.hero.tasks.curTasks;for(var i in e)if(parseInt(i)==t)return e[i];return null},e.prototype.isReceivedRewardByID=function(t){return-1!=App.hero.tasks.doneTasks.indexOf(t)},e.prototype.isFinish=function(t){var e=this.isReceivedRewardByID(t);if(!e){var i=this.getTaskVoById(t),n=tb.TB_task.getTaskById(t);e=!(!i||!n)&&i.count>=n.check_num}return e},e.prototype.getPostTaskId=function(t){var e=tb.TB_task.getTaskById(t);return e?e.post_taskid:-1},e.prototype.getPrevTaskId=function(t){return tb.TB_task.getTaskById(t).pre_taskid},e.tabDaily="tabDaily",e.tabWarrior="tabWarrior",e.tabTrial="tabTrial",e.tabAchievement="tabAchievement",e);function e(){this._tabMap=[],this._honorTasks=[]}o.TaskModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var t,e=(t=ui.task.TabWarriorUI,__extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._model=r.WarriorProveModel.getInstance(),this.btnBuy.on(Laya.Event.CLICK,this,this.onBuy),this.btnUnlock.on(Laya.Event.CLICK,this,this.onUnlock),this.listTask.array=null},i.prototype.close=function(){this.listTask.array=null,Laya.timer.clearAll(this),tl3d.ModuleEventManager.removeEvent(r.TaskEvent.UPDATE_WARRIOR_EXP,this.initView,this),tl3d.ModuleEventManager.removeEvent(r.TaskEvent.UNLOCK_WARRIOR_JINJIE_SUCC,this.initView,this)},i.prototype.initView=function(){var t=this._model;if(this.lbLevel.text=App.hero.tasks.warriorLevel+"",0<App.hero.tasks.warriorLevel){var e=t.getWarriorVoByLv(App.hero.tasks.warriorLevel);this.pgExp.value=App.hero.tasks.warriorExp/e.tbData.exp,this.lbExp.text=App.hero.tasks.warriorExp+"/"+e.tbData.exp}else{var i=t.getWarriorVoByLv(1);this.lbLevel.text="0",this.pgExp.value=0,this.lbExp.text="0/"+i.tbData.total_exp}this.lbTime.text=t.getTimeStr();var n=t.isUnlockJinjie();this.btnUnlock.label=n?LanMgr.getLan("",12142):LanMgr.getLan("",12143),this.btnUnlock.visible=!n,this.imgSuo.visible=!n;var o=t.getWarriorList(),a=(this.listTask.array=o).findIndex(function(t){return t.isCanReward()});-1==a&&(a=-1==(a=o.findIndex(function(t){return!t.isFinish()}))?o.length-1:a),this.listTask.scrollTo(a),this._endTime=t.endTime,Laya.timer.clear(this,this.updateTime),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime(),tl3d.ModuleEventManager.addEvent(r.TaskEvent.UPDATE_WARRIOR_EXP,this.initView,this),tl3d.ModuleEventManager.addEvent(r.TaskEvent.UNLOCK_WARRIOR_JINJIE_SUCC,this.initView,this)},i.prototype.updateTime=function(){var t=this._endTime-App.serverTimeSecond;0<t?this.lbLastTime.text=GameUtil.getTimeStr2(t):(this.lbLastTime.text=LanMgr.getLan("",12094,0,0),Laya.timer.clear(this,this.updateTime))},i.prototype.onReresh=function(){},i.prototype.onBuy=function(){dispatchEvt(new r.TaskEvent(r.TaskEvent.SHOW_WARRIOR_BUY_LEVEL))},i.prototype.onUnlock=function(){dispatchEvt(new r.TaskEvent(r.TaskEvent.SHOW_WARRIOR_JINJIE))},i);function i(){return t.call(this)||this}r.TabWarriorView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.task.TabTrialUI,__extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.listBtn.selectHandler=new Handler(this,this.onSelectTab),this.listBtn.renderHandler=new Handler(this,this.onRenderTab),this.listBtn.selectedIndex=-1,this.listBtn.array=[0,1],this.btnJiangli.on(Laya.Event.CLICK,this,this.showJinjie),this.imgBaoxiang.on(Laya.Event.CLICK,this,this.onLingqu)},i.prototype.close=function(){this.animGuang.visible=!1,this.animGuang.gotoAndStop(0),this.ani1.gotoAndStop(0),Laya.timer.clearAll(this),this.listBtn.selectedIndex=-1,tl3d.ModuleEventManager.removeEvent(o.TaskEvent.UNLOCK_WARRIOR_JINJIE_SUCC,this.updateBaoxiangState,this)},i.prototype.initView=function(){this.listBtn.selectedIndex=0,this.updateBaoxiangState(),tl3d.ModuleEventManager.addEvent(o.TaskEvent.UNLOCK_WARRIOR_JINJIE_SUCC,this.updateBaoxiangState,this)},i.prototype.onSelectTab=function(t){if(-1!=t){var e=0==t,i=o.TrialTaskModel.getInstance(),n=e?i.getWeekList(!0):i.getMonthList(!0);this.listTask.array=n,this.listTask.scrollTo(0),this._endTime=e?i.weekEndTime>i.monthEndTime?i.monthEndTime:i.weekEndTime:i.monthEndTime,Laya.timer.clear(this,this.updateTime),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime()}},i.prototype.onRenderTab=function(t,e){var i=t.getChildByName("btnTab"),n=t.getChildByName("redpoint"),o=t.dataSource;if(isNaN(o))n.onDispose();else{n.setRedPointName(0==o?"task_trial_week":"task_trial_month"),i.label=0==o?LanMgr.getLan("",12144):LanMgr.getLan("",12145);var a=this.listBtn.selectedIndex;i.skin=e==a?SkinUtil.fenye_down:SkinUtil.fenye_up,i.labelSize=a==e?24:22,i.labelColors=a==e?"#7e5336,#7e5336,#7e5336":"#e6ca91,#e6ca91,#e6ca91",i.labelBold=!0}},i.prototype.updateBaoxiangState=function(){var t=o.WarriorProveModel.getInstance(),e=t.isUnlockJinjie(),i=t.isRewardWeekGift();this.btnJiangli.visible=!e,e&&!i?(this.ani1.play(0,!0),this.animGuang.visible=!0,this.animGuang.play(0,!0)):(this.animGuang.visible=!1,this.animGuang.gotoAndStop(0),this.ani1.gotoAndStop(0)),this.imgBaoxiang.skin=i?SkinUtil.help_bx_open:SkinUtil.help_bx_noopen,this.imgBaoxiang.gray=!e},i.prototype.updateTime=function(){var t=this._endTime-App.serverTimeSecond;0<t?this.lbLastTime.text=GameUtil.getTimeStr2(t):(this.lbLastTime.text=LanMgr.getLan("",12094,0,0),Laya.timer.clear(this,this.updateTime))},i.prototype.onReresh=function(){var t=0==this.listBtn.selectedIndex,e=o.TrialTaskModel.getInstance(),i=t?e.getWeekList(!0):e.getMonthList(!0);this.listTask.array=i},i.prototype.showJinjie=function(){dispatchEvt(new o.TaskEvent(o.TaskEvent.SHOW_WARRIOR_JINJIE))},i.prototype.onLingqu=function(){var i=this,t=o.WarriorProveModel.getInstance();t.isUnlockJinjie()?t.isRewardWeekGift()?showToast(LanMgr.getLan("",10453)):PLC.request(Protocol.game_task_getWarriorAdvanceWeekAward,null,function(t){if(t){App.hero.tasks.warriorWeekAward=t.modifyWarriorWeekAward||0,i.updateBaoxiangState();var e=[];e.push(new ItemVo(CostTypeKey.warrior_prove,tb.TB_warrior_set.getSet().warrior_gift)),UIUtil.showRewardView({clientAddItemVoList:e}),dispatchEvt(new o.TaskEvent(o.TaskEvent.REWARD_WEEK_GIFT_SUCC))}}):showToast(LanMgr.getLan("",10452))},i);function i(){return t.call(this)||this}o.TabTrialView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var a,t=(a=ui.task.TabDailyUI,__extends(e,a),e.prototype.createChildren=function(){a.prototype.createChildren.call(this),this._model=o.TaskModel.getInstance(),this._boxItems=[];for(var t=this._model.getLivenessList(),e=t.length,i=0;i<e;i++){var n=new o.TaskBaoxiangIR;n.dataSource=t[i],n.x=this.boxLiveness.width/e*(i+1)-43,i!=e-1&&(n.x+=10),n.y-=50,this.boxLiveness.addChild(n),this._boxItems.push(n)}},e.prototype.close=function(){for(var t=0,e=this._boxItems;t<e.length;t++)e[t].dataSource=null;this.taskList.array=null,Laya.timer.clearAll(this)},e.prototype.initView=function(){var t=App.hero.tasks;this.lbLiveness.text=t.liveness.toString(),this.progressBar.value=t.liveness/100;for(var e=this._model.getLivenessList(),i=0;i<e.length;i++)this._boxItems[i].dataSource=e[i];this.taskList.array=this._model.getViewList(),Laya.timer.loop(3e3,this,this.startAnim)},e.prototype.startAnim=function(){for(var t=0,e=this._boxItems;t<e.length;t++)e[t].startAni()},e.prototype.refreshTaskList=function(){var t=App.hero.tasks;this.lbLiveness.text=t.liveness.toString(),this.progressBar.value=t.liveness/100,this.taskList.array=this._model.getViewList(),this.taskList.refresh(),this.refreshLiveness()},e.prototype.refreshLiveness=function(){for(var t=0,e=this._boxItems;t<e.length;t++)e[t].refreshView()},e.prototype.onReresh=function(){this.taskList.refresh()},e);function e(){var t=a.call(this)||this;return t._model=o.TaskModel.getInstance(),t}o.TabDailyTaskView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.task.TabAchievementUI,__extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.honorList.array=null},n.prototype.close=function(){this.honorList.array=null},n.prototype.initView=function(){this.honorList.array=t.TaskModel.getInstance().getHonorTasks()},n.prototype.onReresh=function(){this.honorList.array=t.TaskModel.getInstance().getHonorTasks()},n);function n(){return e.call(this)||this}t.TabAchievementView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.task.itemrender.TaskIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this._dataSource;if(t){this.lbTitle.text=t.getName(),this.lbTitle.event(Laya.Event.RESIZE),this.lbProgress.text="("+Snums(t.getCount())+"/"+Snums(t.getTotalNum())+")",this.lbNotice.visible=this.imgFinish.visible=this.lbDailyLvs.visible=!1,this.btnOperate.visible=!0,t instanceof i.TaskVo&&t.tbTask.type==iface.tb_prop.taskTypeKey.achievement&&t.tbTask.label==AchievementTabType.challenge?(this.btnOperate.visible=!1,t.isReward()?this.imgFinish.visible=!0:(this.lbNotice.visible=!0,this.lbNotice.text=t.isExcuting()?LanMgr.getLan("",12147):LanMgr.getLan("",12148),this.lbNotice.color=t.isExcuting()?ColorConst.TASK_GREEN:ColorConst.TASK_ORANGE)):t instanceof i.DailyTaskVo&&(this.lbDailyLvs.visible=!0,this.lbDailyLvs.text=0<t.tbTask.liveness?LanMgr.getLan("",12146,t.tbTask.liveness):""),t.isReward()?(this.btnOperate.label=LanMgr.getLan("",10043),this.btnOperate.skin=SkinUtil.buttonNormal,this.btnOperate.labelStrokeColor=ColorConst.ORANGE_FILTER,this.btnOperate.disabled=!0,this.lbProgress.color=ColorConst.FATE_GOLD):(this.btnOperate.disabled=!1,t.isFinish()?(this.btnOperate.label=LanMgr.getLan("",10041),this.btnOperate.skin=SkinUtil.buttonGreen,this.btnOperate.labelStrokeColor=ColorConst.GREEN_FILTER,this.lbProgress.color=ColorConst.GREEN):(this.btnOperate.label=LanMgr.getLan("",10042),this.btnOperate.skin=SkinUtil.buttonNormal,this.btnOperate.labelStrokeColor=ColorConst.ORANGE_FILTER,this.lbProgress.color=ColorConst.RED));var e=t.getRewardList();this.rewardList.array=e,this.rewardList.width=120*e.length+(e.length-1)*this.rewardList.spaceX,this.lbDailyLvs.x=this.rewardList.x+this.rewardList.width,this.btnOperate.on(Laya.Event.CLICK,this,this.onClick)}else this.rewardList.array=null,this.btnOperate.off(Laya.Event.CLICK,this,this.onClick)},n.prototype.onClick=function(){var t=this._dataSource;t instanceof i.TaskVo?t.isCanReward()?dispatchEvt(new i.TaskEvent(i.TaskEvent.RECEIVE_TASK_REWARD,this.dataSource)):dispatchEvt(new i.TaskEvent(i.TaskEvent.TASK_GOTO,t.tbTask)):t instanceof i.DailyTaskVo&&dispatchEvt(new i.TaskEvent(i.TaskEvent.CLICK_DAILY_TASK,this.dataSource))},n);function n(){return t.call(this)||this}i.TaskIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.task.itemrender.TaskBaoxiangIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;if(t){this.imgBox.skin=t.getRewardSkin(),this.lab_num.text=String(t.getCount());var e=t.isCanReward();this.imgGuang.visible=e,Laya.Tween.clearTween(this.imgGuang),e?(this.loopRotation(),this.startAni()):this.ani1.gotoAndStop(0),this.on(Laya.Event.CLICK,this,this.onClick)}else Laya.Tween.clearTween(this.imgGuang),Laya.timer.clearAll(this),this.off(Laya.Event.CLICK,this,this.onClick),this.ani1.gotoAndStop(0)},n.prototype.startAni=function(){var t=this.dataSource;t&&t.isCanReward()?this.ani1.play(0,!1):this.ani1.gotoAndStop(0)},n.prototype.loopRotation=function(){var t=this;this.imgGuang.rotation=0,Laya.Tween.to(this.imgGuang,{rotation:360},2e3,Laya.Ease.linearInOut,new Handler(this,function(){t.loopRotation()}))},n.prototype.onClick=function(){var t=this.dataSource;t.isCanReward()?dispatchEvt(t.getEvent(),t):UIMgr.showUI(UIConst.ManyItemsTip,{data:t.getRewardList()})},n);function n(){return e.call(this)||this}t.TaskBaoxiangIR=i}(game=game||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(o){var t=(e.prototype.getSortNum=function(){var t=this.taskVo.id;return this.isReward()?t-=1e6:this.isFinish()?t-=1e8:t-=1e7,t},e.prototype.getName=function(){return this.tbTask.desc},e.prototype.getTotalNum=function(){return this.tbTask.num},e.prototype.getCount=function(){return this.taskVo.count>this.tbTask.num?this.tbTask.num:this.taskVo.count},e.prototype.isOpen=function(){var t=this.tbTask.link[0];return App.IsSysOpen(t)},e.prototype.isExcuting=function(){return!1},e.prototype.isFinish=function(){return this.taskVo.count>=(this.tbTask?this.tbTask.num:1)},e.prototype.isReward=function(){return this.taskVo.done},e.prototype.isCanReward=function(){return this.isFinish()&&!this.isReward()},e.prototype.getRewardList=function(){if(!this._rewardList){this._rewardList=[];for(var t=this.tbTask.reward,e=0,i=t.length;e<i;e++)this._rewardList.push(App.getCostItemVo(parseInt(t[e][0]),parseInt(t[e][1])))}var n=__spreadArrays(this._rewardList);return o.WarriorProveModel.getInstance().isOpen()&&0<this.tbTask.obtain_exp&&n.push(App.getCostItemVo(CostTypeKey.warrior_prove,this.tbTask.obtain_exp)),n},e);function e(t){this.taskVo=t,this.tbTask=tb.TB_daily.getTaskById(this.taskVo.id)}o.DailyTaskVo=t;var i=(n.prototype.getRewardSkin=function(){switch(this.getCount()){case 25:return SkinUtil.getTaskBaoxiang(1,this.isReward());case 50:return SkinUtil.getTaskBaoxiang(2,this.isReward());case 75:return SkinUtil.getTaskBaoxiang(3,this.isReward());case 100:return SkinUtil.getTaskBaoxiang(4,this.isReward());default:return SkinUtil.getTaskBaoxiang(1,this.isReward())}},n.prototype.isReward=function(){var t=App.hero.tasks.doneChests;return t&&-1!=t.indexOf(this.tbLiveness.ID)},n.prototype.isFinish=function(){return App.hero.tasks.liveness>=this.tbLiveness.liveness},n.prototype.isCanReward=function(){return this.isFinish()&&!this.isReward()},n.prototype.getCount=function(){return this.tbLiveness.liveness},n.prototype.getSkin=function(){return""},n.prototype.getRewardList=function(){return this.tbLiveness.getRewardList()},n.prototype.getEvent=function(){return new o.TaskEvent(o.TaskEvent.REWARD_LIVENESS)},n);function n(t){this.tbLiveness=t}o.DailyLivenessData=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"DailyTaskProcessor"},i.prototype.listenModuleEvents=function(){return[new o.TaskEvent(o.TaskEvent.CLICK_DAILY_TASK),new o.TaskEvent(o.TaskEvent.REWARD_LIVENESS)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof o.TaskEvent)switch(t.type){case o.TaskEvent.CLICK_DAILY_TASK:this.onClickDailyTask(t.data);break;case o.TaskEvent.REWARD_LIVENESS:this.rewardLiveness(t.data)}},i.prototype.onClickDailyTask=function(t){var e=this;if(!t.isReward()){var i=t.tbTask;if(t.isFinish()){var n={};n[Protocol.game_task_getDailyAward.args.dailyId]=i.ID,PLC.request(Protocol.game_task_getDailyAward,n,function(t){t&&(App.hero.updateDailyLivess(t),UIMgr.hasStage(UIConst.TaskView)&&e.taskView.refreshTaskList(),t&&t.commonData&&UIUtil.showRewardView(t.commonData))})}else dispatchEvt(new o.TaskEvent(o.TaskEvent.DAILY_TASK_GOTO,i))}},i.prototype.rewardLiveness=function(t){var e=this,i={};i[Protocol.game_task_getLivenessChest.args.chestId]=t.tbLiveness.ID,PLC.request(Protocol.game_task_getLivenessChest,i,function(t){t&&(UIMgr.hasStage(UIConst.TaskView)&&e.taskView.refreshLiveness(),t&&UIUtil.showRewardView(t.commonData))})},Object.defineProperty(i.prototype,"taskView",{get:function(){return UIMgr.getUIByName(UIConst.TaskView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}o.DailyTaskProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.task.bianqiang.ChallengeTitleIRUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this._dataSource;if(t){this.lbTitle.text=t.tbTitle.desc,this.pbBar.value=t.getCount()/t.getAllCount(),this.lbPercent.text=Math.floor(t.getCount()/t.getAllCount()*100)+"%",this.icon.skin=SkinUtil.getTaskIcon(t.tbTitle.ID);var e=t.getCurTask();e?(this.lbName.text=e.getName(),this.lbProgress.x=this.lbName.x+this.lbName.width+10,this.lbProgress.text="("+Snums(e.getCount())+"/"+Snums(e.getTotalNum())+")",this.rewardList.array=e.getRewardList(),e.isFinish()?(this.btnOperate.label=LanMgr.getLan("",10041),this.btnOperate.skin=SkinUtil.buttonGreen,this.btnOperate.labelStrokeColor=ColorConst.GREEN_FILTER,this.lbProgress.color=ColorConst.GREEN):(this.btnOperate.label=LanMgr.getLan("",10042),this.btnOperate.skin=SkinUtil.buttonNormal,this.btnOperate.labelStrokeColor=ColorConst.ORANGE_FILTER,this.lbProgress.color=ColorConst.RED),this.redpoint.visible=e.isCanReward(),this.lbNotice.visible=!1,this.lbName.visible=this.lbProgress.visible=this.rewardList.visible=this.btnOperate.visible=!0):(this.rewardList.array=null,this.redpoint.visible=!1,this.lbNotice.visible=!0,this.pbBar.value=1,this.lbName.visible=this.lbProgress.visible=this.rewardList.visible=this.btnOperate.visible=!1),this.btnOperate.on(Laya.Event.CLICK,this,this.onClick),this.btnCheck.on(Laya.Event.CLICK,this,this.onCheck)}else this.rewardList.array=null,this.btnOperate.off(Laya.Event.CLICK,this,this.onClick),this.btnCheck.off(Laya.Event.CLICK,this,this.onCheck)},n.prototype.onClick=function(){var t=this.dataSource.getCurTask();t&&(t.isCanReward()?dispatchEvt(new e.TaskEvent(e.TaskEvent.RECEIVE_TASK_REWARD,t)):dispatchEvt(new e.TaskEvent(e.TaskEvent.TASK_GOTO,t.tbTask)))},n.prototype.onCheck=function(t){dispatchEvt(new e.TaskEvent(e.TaskEvent.SHOW_DETAIL_ACHIEVEMENT,this.dataSource))},n);function n(){var t=i.call(this)||this;return t.lbName.autoSize=!0,t}e.ChallengeTitleIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.task.bianqiang.ChallengeDetailUI,__extends(n,i),n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.taskList.array=null},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.initView=function(){var t=this.dataSource;this.taskList.array=t.getList(),this.bgPanel.dataSource={uiName:UIConst.ChallengeDetailView,closeOnSide:this.isModelClose,title:t.tbTitle.desc}},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}t.ChallengeDetailView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.task.bianqiang.BianQiangUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btnClose.off(Laya.Event.CLICK,this,this.close),tl3d.ModuleEventManager.removeEvent(e.TaskEvent.UPDATE_ACHIEVEMENT_DATA,this.onReresh,this)},n.prototype.initView=function(){this.btnClose.on(Laya.Event.CLICK,this,this.close),this.tabBar.selectHandler=new Laya.Handler(this,this.onTabSel),this.tabBar.selectedIndex=this.dataSource?parseInt(this.dataSource):0,this.onTabSel(this.tabBar.selectedIndex),tl3d.ModuleEventManager.addEvent(e.TaskEvent.UPDATE_ACHIEVEMENT_DATA,this.onReresh,this)},n.prototype.onTabSel=function(t){0==(this.viewStack.selectedIndex=t)?this.BianQiangList.array=this.getBianQiangList():1==t&&(this.challengeList.array=e.BianQiangModel.getInstance().filterChallengeTask())},n.prototype.getBianQiangList=function(){for(var t=tb.TB_growth_guide.getGrowthGuideList(),e=[],i=0;i<t.length;i++)this.isOpenSys(t[i].link)&&e.push(t[i]);return e},n.prototype.isOpenSys=function(t){if(!t||!Array.isArray(t)||t.length<1)return!1;var e=t[0],i=(t[1],t[2],tb.TB_sys_open.get_TB_sys_openById(parseInt(e)));return!(i&&!App.IsSysOpen(i.ID))},n.prototype.resetTaskList=function(){1==this.viewStack.selectedIndex&&(this.challengeList.array=e.BianQiangModel.getInstance().filterChallengeTask())},n.prototype.onReresh=function(){1==this.viewStack.selectedIndex&&this.challengeList.refresh()},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.BianQiangView,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12149)},t}e.BianQiangView=t}(game=game||{}),function(n){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.getChallengeTasks=function(){if(!this._challengeTasks){this._challengeTasks=[];var t=TableData.getInstance().getTableByName(TableData.tb_task_title).data;for(var e in t){var i=t[e];this._challengeTasks.push(new n.ChallengeTabData(i.ID))}}return this._challengeTasks},e.prototype.filterChallengeTask=function(){return this.getChallengeTasks()},e.prototype.getChallengeTabData=function(t){for(var e=0,i=this.getChallengeTasks();e<i.length;e++){var n=i[e];if(n.tbTitle.ID==t)return n}return null},e.prototype.getChallengeTabTypeList=function(){var t=[],e=TableData.getInstance().getTableByName(TableData.tb_task_title).data;for(var i in e)t.push(i);return t},e);function e(){}n.BianQiangModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.task.bianqiang.BianQiangIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this._dataSource;t?(this.icon.skin=SkinUtil.getSysOpenSkin(t.icon),this.lab_title.text=t.name,t.recommend==n.TYPE_XSRM?(this.lab_type.text=LanMgr.getLan("",12150),this.lab_type.strokeColor="#297d0d"):t.recommend==n.TYPE_XZBB?(this.lab_type.text=LanMgr.getLan("",12151),this.lab_type.strokeColor="#6c4ac7"):t.recommend==n.TYPE_THBS?(this.lab_type.text=LanMgr.getLan("",12152),this.lab_type.strokeColor="#a22a2a"):(this.lab_type.text="",this.lab_type.strokeColor="#579f36"),this.lab_desc.text=t.desc,this.img_type.skin=this.getTypeIcon(t.recommend),this.btnOperate.on(Laya.Event.CLICK,this,this.onClick)):this.btnOperate.off(Laya.Event.CLICK,this,this.onClick)},n.prototype.getTypeIcon=function(t){switch(t){case n.TYPE_XSRM:return"comp/flag/woyaobianqiang_butiao01.png";case n.TYPE_XZBB:return"comp/flag/woyaobianqiang_butiao02.png";case n.TYPE_THBS:return"comp/flag/woyaobianqiang_butiao03.png";default:return""}},n.prototype.onClick=function(){var t=this._dataSource;dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW,t.link))},n.TYPE_XSRM=1,n.TYPE_XZBB=2,n.TYPE_THBS=3,n);function n(){return t.call(this)||this}e.BianQiangIR=i}(game=game||{}),function(t){var e=(i.prototype.isCanBuy=function(){return 0==this.tbGoods.buy_type||this.count<this.tbGoods.num},i.prototype.getLimitStr=function(){var t=this.tbGoods.buy_type;return t==GoodsLimitType.day?LanMgr.getLan("",10075,this.tbGoods.num-this.count):t==GoodsLimitType.week?LanMgr.getLan("",10076,this.tbGoods.num-this.count):""},i.prototype.isLimit=function(){return 0!=this.tbGoods.buy_type},i);function i(t,e){this.id=t,this.count=e,this.tbGoods=tb.TB_goods.get_TB_goodsById(t),this.tbItem=tb.TB_item.get_TB_itemById(this.tbGoods.item_id[0])}t.ShopItemVo=e;var n=(o.prototype.isCanBuy=function(){return this.count<1},o.prototype.getLimitStr=function(){return 0==this.id?LanMgr.getLan("",12169,this._specialItem[4]):LanMgr.getLan("",12169,this.tbMarket.discount)},o.prototype.isLimit=function(){return this.tbMarket&&0!=this.tbMarket.discount||this._specialItem&&0!=this._specialItem[4]},o);function o(t,e,i,n,o){this.key=t,this.id=e,this.count=i,this.price=n,this.itemInfo=o,0<e?this.tbMarket=tb.TB_market.getItemById(e):this._specialItem=tb.TB_market_set.getItemById(1).first_arise,this.tbItem=tb.TB_item.get_TB_itemById(o[0])}t.JishiItemVo=n}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var o,t=(o=ui.shop.ShopUI,__extends(e,o),e.prototype.setSize=function(t,e){o.prototype.setSize.call(this,t,e),this.boxTop.width=t,this.boxTop.height=GameUtil.isFullScreen()?54+n.HudModel.TOP_ADD_HEIGHT:54},e.prototype.show=function(t,e){o.prototype.show.call(this,t,e),this._shopDataList=this._model.getTabs(),this._initShopType=this.dataSource?this.dataSource:0,this.initView(!0),this.playSpeakEff(),this.tabList.scrollTo(this.getIndexByType(this.dataSource)-2);var i=UIMgr.getUIByName(UIConst.HudView);i&&i.setVisible(!1)},e.prototype.popup=function(t,e){o.prototype.popup.call(this,t,e),this._shopDataList=this._model.getTabs(),this._initShopType=this.dataSource?this.dataSource:0,this.initView(!0),this.playSpeakEff(),this.tabList.scrollTo(this.getIndexByType(this.dataSource)-2);var i=UIMgr.getUIByName(UIConst.HudView);i&&i.setVisible(!1)},e.prototype.onClosed=function(){o.prototype.onClosed.call(this),this.tabList.array=null,this.shopList.array=null,this.raceList.array=null,this.btn_refresh.off(Laya.Event.CLICK,this,this.onRefresh),Laya.timer.clear(this,this.updateTime),UIMgr.showUI(UIConst.Main3DView),tl3d.ModuleEventManager.removeEvent(n.ResEvent.RESOURCE_CHANGE,this.onUpdateRes,this),tl3d.ModuleEventManager.removeEvent(n.ResEvent.PROP_CHANGE,this.onUpdateRes,this),this.btn_close.off(Laya.Event.CLICK,this,this.close),this.btn_add_zuanshi.off(Laya.Event.CLICK,this,this.onclick),this.btn_addgold.off(Laya.Event.CLICK,this,this.onclick),this.clearEff(),this._marketSetTemp=null;var t=UIMgr.getUIByName(UIConst.HudView);if(t&&t.setVisible(!0),this._isOpen=!1,this.clearTabEff(),UIUtil.clearListEff(this.shopList.cells),this.stopSpeakEff(),0!=this._initShopType)switch(this._initShopType){case ShopType.guild:UIMgr.showUI(UIConst.GuildMainView);break;case ShopType.jingjichang:dispatchEvt(new n.ArenaEvent(n.ArenaEvent.SHOW_ARENA_PANEL));break;case ShopType.shenjie:dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.SHENMEN]);break;case ShopType.yuanzheng:dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.EXPEDITION]);break;case ShopType.rongyao:dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.GLORY_FIGHT]);break;case ShopType.godDm:dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.GOD_DOMAIN])}},e.prototype.initView=function(t){var e=this;void 0===t&&(t=!1);var i=this.dataSource;this._index=this.getIndexByType(i),this.tabList.array=this._shopDataList,this.tabList.selectedIndex=this._index,this.onUpdateRes(),this.updateShopList(this._model.getShopListByType(this.getCurData().type)),this.onUpdateRace(),this.onUpdateRefresh(),tl3d.ModuleEventManager.addEvent(n.ResEvent.RESOURCE_CHANGE,this.onUpdateRes,this),tl3d.ModuleEventManager.addEvent(n.ResEvent.PROP_CHANGE,this.onUpdateRes,this),this.btn_close.on(Laya.Event.CLICK,this,this.close),this.btn_refresh.on(Laya.Event.CLICK,this,this.onRefresh),this.btn_add_zuanshi.on(Laya.Event.CLICK,this,this.onclick),this.btn_addgold.on(Laya.Event.CLICK,this,this.onclick),Laya.timer.loop(1e3,this,this.updateTime),this._isOpen||(this._isOpen=!0,this.playEnterEff(),Laya.timer.callLater(this,this.playTabEff)),Laya.timer.callLater(this,function(){UIUtil.playListEff(e.shopList.cells)})},e.prototype.onTab=function(t){this._index!=t&&(this._index=t,this.playSpeakEff(),dispatchEvt(new n.ShopEvent(n.ShopEvent.SHOW_SHOP_VIEW),this.getCurData().type))},e.prototype.playSpeakEff=function(){this.stopSpeakEff(),this.ani3.on(Laya.Event.COMPLETE,this,this.onAni3Complete),this.ani3.play(0,!1),this.lab_speak.text=this.getCurData().speak},e.prototype.onAni3Complete=function(){this.ani4.play(0,!1)},e.prototype.stopSpeakEff=function(){this.ani4.gotoAndStop(0),this.ani3.gotoAndStop(0),this.ani3.off(Laya.Event.COMPLETE,this,this.onAni3Complete)},e.prototype.onTabRender=function(t,e){t.setSelect(this._index==e)},e.prototype.onUpdateRes=function(){var t=this._model.getResType(this.getCurData().type);switch(this.imgCost.skin=SkinUtil.getCostSkin(t),this.box_cost.visible=!0,this.boxRes.width=471,t){case iface.tb_prop.resTypeKey.arena:App.hero.arena<0?this.lbNum.text="0":this.lbNum.text=""+Snums(App.hero.arena);break;case iface.tb_prop.resTypeKey.guildDonate:App.hero.guildDonate<0?this.lbNum.text="X0":this.lbNum.text=""+Snums(App.hero.guildDonate);break;case iface.tb_prop.resTypeKey.darkEssence:App.hero.darkEssence<0?this.lbNum.text="0":this.lbNum.text=""+Snums(App.hero.darkEssence);break;case iface.tb_prop.resTypeKey.godCrystal:App.hero.godCrystal<0?this.lbNum.text="0":this.lbNum.text=""+Snums(App.hero.godCrystal);break;case iface.tb_prop.resTypeKey.soulStone:App.hero.soulStone<0?this.lbNum.text="0":this.lbNum.text=""+Snums(App.hero.soulStone);break;case iface.tb_prop.resTypeKey.honour:App.hero.honour<0?this.lbNum.text="0":this.lbNum.text=""+Snums(App.hero.honour);break;case iface.tb_prop.resTypeKey.godDomain:App.hero.godDomain<0?this.lbNum.text="0":this.lbNum.text=""+Snums(App.hero.godDomain);break;default:this.lbNum.text="",this.box_cost.visible=!1,this.boxRes.width=312}this.lab_zuanshi.text=Snums(App.hero.diamond),this.lab_money.text=Snums(App.hero.gold)},e.prototype.onUpdateRefresh=function(){if(this.boxRefresh.visible=this.getCurData().type==ShopType.jishi,1==this.boxRefresh.visible){this._marketSetTemp||(this._marketSetTemp=tb.TB_market_set.getItemById(1));var t=App.hero.getMarketFreeInfo();this._marketFreeCount=t[0],this._marketReplyTime=t[1];var e=App.hero.getMarkeyBuyRefreshCount();e>this._marketSetTemp.max_num&&(e=this._marketSetTemp.max_num),this.lab_gem_count.text=LanMgr.getLan("",12170,e,this._marketSetTemp.max_num),this.updateMarketRefreshBtn(),this.updateTime()}},e.prototype.updateMarketRefreshBtn=function(){0<this._marketFreeCount?(this.img_marketGem.visible=!1,this.lab_gem_num.visible=!1):(this.lab_gem_num.text=this._marketSetTemp.cost_diamond+"",this.img_marketGem.visible=!0,this.lab_gem_num.visible=!0),this.lab_free_num.text=LanMgr.getLan("",12171,this._marketFreeCount,this._marketSetTemp.reply_num)},e.prototype.updateTime=function(){if(this.boxRefresh.visible)if(this._marketFreeCount<this._marketSetTemp.reply_num){this.lb_time.visible=!0;var t=this._marketReplyTime-App.serverTimeSecond;if(t<=0)return this._marketFreeCount++,this._marketReplyTime+=this._marketSetTemp.reply_interval,this.updateMarketRefreshBtn(),void this.updateTime();this.lb_time.text=LanMgr.getLan("",12172,GameUtil.toCountdown(t,"hh:mm:ss"))}else this.lb_time.visible=!1},e.prototype.onUpdateRace=function(){this.raceList.array=[0,1,2,3,4,5],this.raceList.selectedIndex=0,this.box_race.visible=this.getCurData().type==ShopType.shenjie},e.prototype.onSelect=function(t){this.shopList.array=null,this.updateShopList(this._model.getGoodsByRace(t,this.getCurData().type))},e.prototype.updateShopList=function(t){var e=[];if(t&&0<t.length)for(var i=0;i<t.length;i+=4){for(var n=[],o=0;o<4;o++){var a=i+o;if(a>=t.length)break;n[o]=t[a]}e.push(n)}this.shopList.array=e},e.prototype.onRefresh=function(){if(!(Laya.timer.currTimer<this._onClickRefreshTime))if(this._onClickRefreshTime=Laya.timer.currTimer+500,this._marketFreeCount<=0){if(App.hero.getMarkeyBuyRefreshCount()>=this._marketSetTemp.max_num)return void showToast(LanMgr.getLan("",10451));if(n.RefreshView.IS_TIPS_TODAY)UIMgr.showUI(UIConst.Shop_RefreshView,this._marketSetTemp);else{if(App.hero.diamond<this._marketSetTemp.cost_diamond)return void showToast(LanMgr.getLan("",10073));dispatchEvt(new n.ShopEvent(n.ShopEvent.REFRESH_JISHI_VIEW))}}else dispatchEvt(new n.ShopEvent(n.ShopEvent.REFRESH_JISHI_VIEW))},e.prototype.getCurData=function(){return this._shopDataList[this._index]},e.prototype.playEnterEff=function(){this.ani1.gotoAndStop(0),this.ani2.play(0,!1),this.ani2.on(Laya.Event.COMPLETE,this,this.onFlyEffComplete)},e.prototype.onFlyEffComplete=function(){this.ani1.play(0,!0)},e.prototype.clearEff=function(){this.ani2.gotoAndStop(0),this.ani1.gotoAndStop(0),this.ani2.off(Laya.Event.COMPLETE,this,this.onFlyEffComplete)},e.prototype.playTabEff=function(){this.clearTabEff();var t=this.tabList.cells;if(t)for(var e=0;e<t.length;e++){var i=t[e],n=i.x;i.x=n+900;var o=50*e;Laya.timer.once(o,this,function(t,e){Laya.Tween.to(t,{x:e},300)},[i,n])}},e.prototype.clearTabEff=function(){var t=this.tabList.cells;if(t)for(var e=0;e<t.length;e++){var i=t[e];Laya.Tween.clearAll(i)}Laya.timer.clearAll(this)},e.prototype.onclick=function(t){switch(t.currentTarget){case this.btn_add_zuanshi:dispatchEvt(new n.TopUpEvent(n.TopUpEvent.SHOW_CHONGZHI_PANEL));break;case this.btn_addgold:UIMgr.showUI(UIConst.ExchangeGoldView)}},e.prototype.getIndexByType=function(t){for(var e=0;e<this._shopDataList.length;e++){var i=this._shopDataList[e];if(Number(i.type)==t)return e}return 0},e);function e(){var t=o.call(this)||this;return t._isOpen=!1,t._initShopType=0,t._onClickRefreshTime=0,t.isModelClose=!0,t.group=UIConst.hud_group,t.tabList.selectHandler=new Handler(t,t.onTab),t.tabList.renderHandler=new Handler(t,t.onTabRender),t.raceList.selectHandler=new Handler(t,t.onSelect),t._model=n.ShopModel.getInstance(),t}n.ShopView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.shop.ShopThreeIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.list_item.array=t},enumerable:!0,configurable:!0}),n);function n(){return e.call(this)||this}t.ShopThreeIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.shop.ShopTabIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t&&(this.img_tab.skin=SkinUtil.getShopTabSkin(t.type),this.redpoint.onDispose(),t.type===ShopType.jishi&&this.redpoint.setRedPointName("jishi_group"))},n.prototype.setSelect=function(t){this._isSelect!=t&&(this._isSelect=t,this.tab_zhuobu.selected=t)},n);function n(){var t=e.call(this)||this;return t._isSelect=!1,t}t.ShopTabIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.shop.ShopIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;t?(this.itemBox.dataSource=t.price?new ItemVo(t.itemInfo[0],t.itemInfo[1]):new ItemVo(t.tbGoods.item_id[0],t.tbGoods.item_id[1]),this.lbCost.text=t.price?"X"+Snums(t.price[1]):"X"+Snums(t.tbGoods.price),this.imgCost.skin=t.price?SkinUtil.getCostSkin(t.price[0]):SkinUtil.getCostSkin(t.tbGoods.money_type),this.imgLimit.visible=this.lbLimit.visible=t.isLimit(),this.lbLimit.text=t.getLimitStr(),this.btnBuy.disabled=!t.isCanBuy(),this.btnBuy.on(Laya.Event.CLICK,this,this.onBuy)):this.btnBuy.off(Laya.Event.CLICK,this,this.onBuy)},i.prototype.onBuy=function(){var e=this,i=this.dataSource;if(i.tbGoods){var t={item:i.tbGoods,arrlimit:i.isLimit()?i.tbGoods.num-i.count:0};dispatchEvt(new o.ShopEvent(o.ShopEvent.SHOW_GOUMAI_PANEL),t)}else if(i.price){if(UIUtil.checkNotEnough(i.price[0],i.price[1]))return;(n={})[Protocol.game_market_buy.args.id]=i.key,PLC.request(Protocol.game_market_buy,n,function(t){t&&(i.count++,UIUtil.showRewardView(t.commonData),e.refreshData())})}else{if(UIUtil.checkNotEnough(i.tbGoods.money_type,i.tbGoods.price))return;var n;(n={})[Protocol.game_shop_buy.args.id]=i.id,n[Protocol.game_shop_buy.args.num]=1,PLC.request(Protocol.game_shop_buy,n,function(t){t&&(i.count++,UIUtil.showRewardView(t.commonData),e.refreshData())})}},i);function i(){return t.call(this)||this}o.ShopIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.shop.ShopRefreshUI,__extends(n,i),n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btn_sure.off(Laya.Event.CLICK,this,this.onRefresh),this.btn_cancel.off(Laya.Event.CLICK,this,this.close),this.chk_tips.off(Laya.Event.CHANGE,this,this.onChkChange),this._marketSetTemp=null},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.initView=function(){this._marketSetTemp=this.dataSource,this.btn_sure.on(Laya.Event.CLICK,this,this.onRefresh),this.btn_cancel.on(Laya.Event.CLICK,this,this.close),this.chk_tips.on(Laya.Event.CHANGE,this,this.onChkChange),this.chk_tips.selected=!n.IS_TIPS_TODAY,this.lab_content.text=LanMgr.getLan("",12174,this._marketSetTemp.cost_diamond),this.img_Gem.x=this.lab_content.x+124},n.prototype.onChkChange=function(){n.IS_TIPS_TODAY=!this.chk_tips.selected},n.prototype.onRefresh=function(){this._marketSetTemp&&(UIUtil.checkNotEnough(iface.tb_prop.resTypeKey.diamond,this._marketSetTemp.cost_diamond)||dispatchEvt(new t.ShopEvent(t.ShopEvent.REFRESH_JISHI_VIEW)))},n.IS_TIPS_TODAY=!0,n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.Shop_RefreshView,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12173)},t}t.RefreshView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var n,t=(n=ui.shop.BuyUI,__extends(i,n),i.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.Shop_BuyView,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12175)},this._counterBar=new common.CounterBar,this._counterBar.setComponent(this.btn_add,this.btn_addTen,this.btn_red,this.btn_redTen,this.are_putin),this.btn_buy.on(Laya.Event.CLICK,this,this.buy)},i.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.init()},i.prototype.show=function(t,e){n.prototype.popup.call(this,t,e),this.init()},i.prototype.onClosed=function(t){n.prototype.onClosed.call(this,t)},i.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this),Laya.timer.clearAll(this)},i.prototype.init=function(){var t,e,i,n=this.dataSource;this._good=n.item;var o=tb.TB_item.get_TB_itemById(this._good.item_id[0]);this.img_type1.skin="",this.img_type2.skin=SkinUtil.getCostSkin(this._good.money_type),this.itembox.dataSource=new ItemVo(this._good.item_id[0],this._good.item_id[1]),e=0==o.max_overlap?9999:o.max_overlap;var a=0!=this._good.num;t=a?n.arrlimit:e;var r=this._good.money_type,s=App.getResNum(r);i=Math.floor(s/this._good.price),this._buymaxnum=Math.min(t,i,e),this._buyNum=1,this._counterBar.setInitData(this._buyNum,this._buymaxnum,this.setBuySumMoney.bind(this)),this.lab_name.text=o.name,this.lab_rouyu.text=LanMgr.getLan("",12177)+App.hero.getBagItemNum(this._good.item_id[0]),this.lab_overplus.visible=a,this.lab_overplus.text=LanMgr.getLan("",12176,this._buymaxnum),this.setBuySumMoney()},i.prototype.setBuySumMoney=function(){this._buyNum=this._counterBar.getCurNum(),this.are_putin.text=this._buyNum.toString(),this._buysumMoney=this._buyNum*this._good.price,this.lab_sum.text="X"+Snums(this._buysumMoney)},i.prototype.buy=function(){if(!UIUtil.checkNotEnough(this._good.money_type,this._buysumMoney))if(0!=this._good.num&&(this._buymaxnum<this._buyNum||this._buyNum<1))showToast(LanMgr.getLan("",10450));else{var t={id:this._good.ID,num:this._buyNum,type:this._good.type};dispatchEvt(new e.ShopEvent(e.ShopEvent.CHANGE_RONGYUSHANGDIAN_PANEL),t),this.close()}},i);function i(){var t=n.call(this)||this;return t._buyNum=1,t._buymaxnum=0,t._buysumMoney=0,t}e.BuyView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"ShopProcessor"},i.prototype.listenModuleEvents=function(){return[new n.ShopEvent(n.ShopEvent.SHOW_SHOP_VIEW),new n.ShopEvent(n.ShopEvent.REFRESH_JISHI_VIEW),new n.ShopEvent(n.ShopEvent.REFRESH_SHOP_CROSSDAY),new n.ShopEvent(n.ShopEvent.CHANGE_RONGYUSHANGDIAN_PANEL),new n.ShopEvent(n.ShopEvent.SHOW_GOUMAI_PANEL),new n.ShopEvent(n.ShopEvent.SHOW_RONGYUSHANGDIAN_PANEL)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof n.ShopEvent)switch(t.type){case n.ShopEvent.SHOW_SHOP_VIEW:this.showMainView(t.data);break;case n.ShopEvent.REFRESH_JISHI_VIEW:this.refreshJiShiList();break;case n.ShopEvent.REFRESH_SHOP_CROSSDAY:this.refreshShopData();break;case n.ShopEvent.CHANGE_RONGYUSHANGDIAN_PANEL:this.updateShopData(t.data);break;case n.ShopEvent.SHOW_GOUMAI_PANEL:this.showGoumaiView(t.data);break;case n.ShopEvent.SHOW_RONGYUSHANGDIAN_PANEL:this.showShopData()}},i.prototype.showMainView=function(t){var e=this._model;if(e.isOpenByType(t)){var i=UIMgr.getUIByName(UIConst.ShopView);t==ShopType.jishi?e.requestJishiList().then(function(){UIMgr.hasStage(UIConst.ShopView)?(i.dataSource=t,i.initView()):UIMgr.showUI(UIConst.ShopView,t)}):e.requestShopList(t).then(function(){UIMgr.hasStage(UIConst.ShopView)?(i.dataSource=t,i.initView()):UIMgr.showUI(UIConst.ShopView,t)})}else showToast(LanMgr.getLan("",10448))},i.prototype.refreshJiShiList=function(){var i=this._model;PLC.request(Protocol.game_market_refresh,{},function(t){if(t){i._jishiList=[];for(var e=0;e<t.marketList.length;e++)i._jishiList.push(new n.JishiItemVo(e,t.marketList[e].id,t.marketList[e].count,t.marketList[e].price,t.marketList[e].itemInfo));UIMgr.hasStage(UIConst.ShopView)&&UIMgr.getUIByName(UIConst.ShopView).initView(),UIMgr.hasStage(UIConst.Shop_RefreshView)&&UIMgr.hideUIByName(UIConst.Shop_RefreshView)}})},i.prototype.refreshShopData=function(){if(this._model.shopMap.clear(),UIMgr.hasStage(UIConst.ShopView)){var t=UIMgr.getUIByName(UIConst.ShopView);dispatchEvt(new n.ShopEvent(n.ShopEvent.SHOW_SHOP_VIEW),t.getCurData().type)}},i.prototype.updateShopData=function(a){var r=this,t={};t[Protocol.game_shop_buy.args.id]=a.id,t[Protocol.game_shop_buy.args.num]=a.num,PLC.request(Protocol.game_shop_buy,t,function(t,e){if(t){var i=tb.TB_goods.get_TB_goodsById(t.buyId),n=tb.TB_item.get_TB_itemById(i.item_id[0]).name;showToast(LanMgr.getLan("",10449,n,a.num*i.item_id[1]));var o=r._model.getGoodsById(a.id,a.type);0!=o.tbGoods.buy_type&&(o.count+=a.num),UIMgr.getUIByName(UIConst.ShopView)&&UIMgr.getUIByName(UIConst.ShopView).shopList.refresh()}})},i.prototype.showGoumaiView=function(t){UIMgr.showUI(UIConst.Shop_BuyView,t)},i.prototype.showShopData=function(){UIMgr.showUI(UIConst.ShopView,ShopType.jingjichang)},i);function i(){var t=e.call(this)||this;return t._model=n.ShopModel.getInstance(),t}n.ShopProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"ShopModule"},n.prototype.listProcessors=function(){return[new t.ShopProcessor]},n.prototype.onRegister=function(){t.ShopModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.ShopModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_SHOP_VIEW="SHOW_SHOP_VIEW",r.REFRESH_JISHI_VIEW="REFRESH_JISHI_VIEW",r.REFRESH_JISHI_RP="REFRESH_JISHI_RP",r.REFRESH_SHOP_CROSSDAY="REFRESH_SHOP_CROSSDAY",r.CHANGE_RONGYUSHANGDIAN_PANEL="CHANGE_RONGYUSHANGDIAN_PANEL",r.SHOW_GOUMAI_PANEL="SHOW_GOUMAI_PANEL",r.MARKET_REFRESH_REPLY_TIME_CHNAGE="MARKET_REFRESH_REPLY_TIME_CHNAGE",r.SHOW_RONGYUSHANGDIAN_PANEL="SHOW_RONGYUSHANGDIAN_PANEL",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.ShopEvent=a}(game=game||{}),function(l){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initModel=function(){this._ShopData=[{name:LanMgr.getLan("",12153),sysId:ModuleConst.JISHI,type:ShopType.jishi,speak:LanMgr.getLan("",12161)},{name:LanMgr.getLan("",12154),sysId:ModuleConst.SHOP,type:ShopType.shangcheng,speak:LanMgr.getLan("",12162)},{name:LanMgr.getLan("",12155),sysId:ModuleConst.JINGJI,type:ShopType.jingjichang,speak:LanMgr.getLan("",12163)},{name:LanMgr.getLan("",12156),sysId:ModuleConst.GONGHUI,type:ShopType.guild,speak:LanMgr.getLan("",12164)},{name:LanMgr.getLan("",12157),sysId:ModuleConst.SHENMEN,type:ShopType.shenjie,speak:LanMgr.getLan("",12165)},{name:LanMgr.getLan("",12158),sysId:ModuleConst.EXPEDITION,type:ShopType.yuanzheng,speak:LanMgr.getLan("",12166)},{name:LanMgr.getLan("",12159),sysId:ModuleConst.GLORY_FIGHT,type:ShopType.rongyao,speak:LanMgr.getLan("",12167)},{name:LanMgr.getLan("",12160),sysId:ModuleConst.GOD_DOMAIN,type:ShopType.godDm,speak:LanMgr.getLan("",12168)}]},e.prototype.getTabs=function(){for(var t=[],e=0;e<this._ShopData.length;e++){var i=this._ShopData[e];if(App.IsSysOpen(Number(i.sysId))){if(ShopType.guild==i.type&&!l.GuildModel.getInstance().isHasGuild())continue;t.push(i)}}return t},e.prototype.findShopDataByType=function(e){return this.getTabs().find(function(t){return Number(t.type)==e})},e.prototype.isOpenByType=function(t){var e=this.findShopDataByType(t);return ShopType.guild==e.type?App.IsSysOpen(e.sysId)&&l.GuildModel.getInstance().isHasGuild():App.IsSysOpen(e.sysId)},Object.defineProperty(e.prototype,"shopMap",{get:function(){return this._shopMap},set:function(t){this._shopMap=t},enumerable:!0,configurable:!0}),e.prototype.requestShopList=function(u){var h=this;return new Promise(function(s){if(h._shopMap.get(u))s();else{var t={};t[Protocol.game_shop_list.args.type]=u,PLC.request(Protocol.game_shop_list,t,function(t){if(t){for(var e=[],i=0,n=t.shopList;i<n.length;i++){var o=n[i],a=o.id,r=o.count;e.push(new l.ShopItemVo(a,r))}e.sort(function(t,e){return t.tbGoods.rank-e.tbGoods.rank}),h._shopMap.set(u,e),s()}else s()})}})},e.prototype.requestJishiList=function(){var n=this;return new Promise(function(i){n._jishiList.length<=0?PLC.request(Protocol.game_market_list,{},function(t){if(t){n._jishiList=[];for(var e=0;e<t.marketList.length;e++)n._jishiList.push(new l.JishiItemVo(e,t.marketList[e].id,t.marketList[e].count,t.marketList[e].price,t.marketList[e].itemInfo));i()}else i()}):i()})},e.prototype.getShopListByType=function(t){if(t==ShopType.jishi)return this.getJiShiList();var e=this._shopMap.get(t);return e||[]},e.prototype.getJiShiList=function(){return this._jishiList?this._jishiList:[]},e.prototype.getGoodsById=function(e,t){return this.getShopListByType(t).find(function(t){return t.id==e})},e.prototype.getGoodsByRace=function(e,t){var i=this.getShopListByType(t);return 0==e?i:i.filter(function(t){return t.tbGoods.label==e})},e.prototype.getLimitNumById=function(t,e){var i=this.getShopListByType(t).find(function(t){return t.id==e});return i.tbGoods.num-i.count},e.prototype.getResType=function(t){switch(t){case ShopType.shangcheng:case ShopType.jishi:return;case ShopType.jingjichang:return iface.tb_prop.resTypeKey.arena;case ShopType.guild:return iface.tb_prop.resTypeKey.guildDonate;case ShopType.yuanzheng:return iface.tb_prop.resTypeKey.darkEssence;case ShopType.shenjie:return iface.tb_prop.resTypeKey.godCrystal;case ShopType.rongyao:return iface.tb_prop.resTypeKey.honour;case ShopType.godDm:return iface.tb_prop.resTypeKey.godDomain}},e);function e(){this._shopMap=new Laya.Dictionary,this._jishiList=[]}l.ShopModel=t}(game=game||{}),function(a){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.addRule=function(t){return!this.hasRule(t.name)&&(this._rulesDic[t.name]=t,!0)},e.prototype.getRule=function(t){return this._rulesDic[t]},e.prototype.hasRule=function(t){return!!this._rulesDic[t]},e.prototype.getGroupRuleInfo=function(t){var e={},i=this.getRule(t);if(i)for(var n=0,o=i.getRuleNames();n<o.length;n++){var a=o[n],r=this.getRule(a);r&&(e[a]=r.visible)}return e},e.prototype.removeRule=function(t){var e=this.getRule(t);if(!e)return!1;if(e instanceof a.RedPointGroup)for(var i=0,n=e.getRuleNames();i<n.length;i++){var o=n[i];this.removeRule(o)}return e.onDispose(),delete this._rulesDic[t],!0},e.prototype.removeAll=function(){for(var t in this._rulesDic){var e=this.getRule(t);e&&e.onDispose()}this._rulesDic={}},e.injection=function(t){return e.getInstance().addRule(t),t},e.getRule=function(t){return e.getInstance().getRule(t)},e.hasRule=function(t){return e.getInstance().hasRule(t)},e.removeRule=function(t){return e.getInstance().removeRule(t)},e.removeAll=function(){return e.getInstance().removeAll()},e);function e(){this._rulesDic={}}a.RedPointManager=t}(game=game||{}),function(n){var t=(Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.prototype.initRules=function(){var i=this;0==this._initialized&&(this._initialized=!0,this.init(),this._ruleNames.forEach(function(t){var e=n.RedPointManager.getRule(t);e&&e.addHandler(new Handler(i,i.updateVisible))}))},e.prototype.init=function(){},e.prototype.updateVisible=function(){this._visible=this._ruleNames.some(function(t){var e=n.RedPointManager.getRule(t);return e&&e.visible}),this.runHandler()},e.prototype.runHandler=function(){for(var t=0;t<this._handlers.length;t++){var e=this._handlers[t];e.runWith(e.args)}},e.prototype.addHandler=function(t){this.initRules(),this.hasHandler(t.method,t.caller)?logdebug("RedPointGroup: the handler already exists"):(this._handlers.push(t),t.runWith(t.args))},e.prototype.hasHandler=function(e,i){return this._handlers.some(function(t){return t.caller==i&&t.method==e})},e.prototype.removeHandler=function(t,e){var i=this.getHandler(t,e);if(i){var n=this._handlers.indexOf(i);this._handlers.splice(n,1)}},e.prototype.clearHandler=function(){this._handlers=[]},e.prototype.getHandler=function(e,i){return this._handlers.find(function(t){return t.caller==i&&t.method==e})},e.prototype.hasRule=function(e){return this._ruleNames.some(function(t){return t==e})},e.prototype.addRule=function(t){return!this.hasRule(t.name)&&(this._ruleNames.push(t.name),t.addHandler(new Handler(this,this.updateVisible)),!0)},e.prototype.addRules=function(t){for(var e=0;e<t.length;e++){var i=t[e];this.addRule(i)}},e.prototype.removeRule=function(e){var t=this._ruleNames.findIndex(function(t){return t==e});-1!=t&&this._ruleNames.splice(t,1);var i=n.RedPointManager.getRule(e);i&&i.removeHandler(this.updateVisible,this)},e.prototype.getRuleNames=function(){return this._ruleNames},e.prototype.onDispose=function(){this._ruleNames=[],this._visible=!1,tl3d.ModuleEventManager.removeEventByTarget(this),this.runHandler(),this.clearHandler()},e);function e(t,e){this._ruleNames=[],this._handlers=[],this._initialized=!1,this._name=t,this._ruleNames=e}n.RedPointGroup=t}(game=game||{}),function(t){var e=(Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),i.prototype.init=function(){this._initialized||(this._initialized=!0)},i.prototype.updateVisible=function(t){this.visible=t,this.runHandler()},i.prototype.runHandler=function(){for(var t=0;t<this._handlers.length;t++){var e=this._handlers[t];e.runWith(e.args)}},i.prototype.addHandler=function(t){this.init(),this.hasHandler(t.method,t.caller)?logdebug("RedPointBaseRule: the handler already exists"):(this._handlers.push(t),t.runWith(t.args))},i.prototype.hasHandler=function(e,i){return this._handlers.some(function(t){return t.caller==i&&t.method==e})},i.prototype.removeHandler=function(t,e){var i=this.getHandler(t,e);if(i){var n=this._handlers.indexOf(i);this._handlers.splice(n,1)}},i.prototype.getHandler=function(e,i){return this._handlers.find(function(t){return t.caller==i&&t.method==e})},i.prototype.clearHandler=function(){this._handlers=[]},i.prototype.onDispose=function(){tl3d.ModuleEventManager.removeEventByTarget(this),Laya.timer.clearAll(this),this._visible=!1,this.runHandler(),this.clearHandler()},i);function i(t){this._handlers=[],this._initialized=!1,this._name=t}t.RedPointBaseRule=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.RedPointCopyUI,__extends(n,e),n.prototype.onDelay=function(){this.updateRule()},n.prototype.setRedPointName=function(t){this.redpointName=t,this.updateRule()},n.prototype.updateRule=function(){this._redPoint&&this._redPoint.removeHandler(this.updateState,this),this._redPoint=t.RedPointManager.getRule(this.redpointName),this._redPoint&&this._redPoint.addHandler(new Handler(this,this.updateState)),this.updateState()},n.prototype.updateState=function(){this.visible=!!this._redPoint&&this._redPoint.visible,this.visible?this.ani1.play(0,!0):this.ani1.stop()},n.prototype.onDispose=function(){this._redPoint&&this._redPoint.removeHandler(this.updateState,this),this._redPoint=null,this.redpointName="",this.visible=!1},n);function n(){var t=e.call(this)||this;return t.mouseEnabled=!1,t.visible=!1,t.frameOnce(2,t,t.onDelay),t}t.RedPointPropCopy=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.component.RedPointUI,__extends(n,e),n.prototype.onDelay=function(){this.updateRule()},n.prototype.setRedPointName=function(t){this.redpointName=t,this.updateRule()},n.prototype.updateRule=function(){this._redPoint&&this._redPoint.removeHandler(this.updateState,this),this._redPoint=t.RedPointManager.getRule(this.redpointName),this._redPoint&&this._redPoint.addHandler(new Handler(this,this.updateState)),this.updateState()},n.prototype.updateState=function(){this.visible=!!this._redPoint&&this._redPoint.visible},n.prototype.onDispose=function(){this._redPoint&&this._redPoint.removeHandler(this.updateState,this),this._redPoint=null,this.redpointName="",this.visible=!1},n);function n(){var t=e.call(this)||this;return t.mouseEnabled=!1,t.visible=!1,t.frameOnce(2,t,t.onDelay),t}t.RedPointProp=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(M){var n,D=(n=M.RedPointBaseRule,__extends(t,n),t.prototype.init=function(){n.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.OpenserverEvent.RED_CHANGE,this.updateState,this),this.updateState()},t.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},t.prototype._updateState=function(){M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.openGift)&&this._vo?(this.updateVisible(this._vo.isbuy()&&!this._vo.isReceive()),dispatchEvt(new M.HudEvent(M.HudEvent.UPDATE_MAINVIEW_BUTTON))):this.updateVisible(!1)},t);function t(t,e){var i=n.call(this,t)||this;return i._vo=e,i}var o,O=(o=M.RedPointBaseRule,__extends(e,o),e.prototype.init=function(){o.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.OnlineEvent.RED_CHANGE_EVENT,this.updateState,this),this.updateState()},e.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},e.prototype._updateState=function(){M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.onlineAward)&&this._vo?(this.updateVisible(this._vo.onRedPoint()),dispatchEvt(new M.HudEvent(M.HudEvent.UPDATE_MAINVIEW_BUTTON)),dispatchEvt(new M.HudEvent(M.HudEvent.UPDATE_ONLINEREWARD))):this.updateVisible(!1)},e);function e(t,e){var i=o.call(this,t)||this;return i._vo=e,i}var i,R=(i=M.RedPointBaseRule,__extends(a,i),a.prototype.init=function(){i.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.BIND_PHONE_EVENT,this.updateState,this),this.updateState()},a.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},a.prototype._updateState=function(){var t=1==App.hero.bindPhone,e=0!=App.hero.bindMobileAward;dispatchEvt(new M.HudEvent(M.HudEvent.UPDATE_MAINVIEW_BUTTON));var i=iface.tb_prop.sysOpenTypeKey.bindGift;this.updateVisible(M.HudModel.isHudShow(i)&&App.IsSysOpen(i)&&t&&!e)},a);function a(t){return i.call(this,t)||this}var r,P=(r=M.RedPointBaseRule,__extends(s,r),s.prototype.init=function(){r.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.SUPER_VIP_RP,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.VIP_LEVEL_CHANGE,this.updateState,this),this.updateState()},s.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},s.prototype._updateState=function(){var t=1==App.hero.welfare.superVip,e=1==App.hero.welfare.superVipAward,i=iface.tb_prop.sysOpenTypeKey.superVip;this.updateVisible(M.HudModel.isHudShow(i)&&App.IsSysOpen(i)&&-1!=App.hero.vipService&&t&&!e)},s);function s(t){return r.call(this,t)||this}var u,U=(u=M.RedPointBaseRule,__extends(h,u),h.prototype.init=function(){u.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.TEST_REBATE_RP,this.updateState,this),this.updateState()},h.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},h.prototype._updateState=function(){var t=ModuleConst.TEST_REBATE;this.updateVisible(M.HudModel.isHudShow(t)&&App.IsSysOpen(t)&&M.HuodongModel.getInstance().canRewardTestRebate())},h);function h(t){return u.call(this,t)||this}var l,k=(l=M.RedPointBaseRule,__extends(c,l),c.prototype.init=function(){l.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ShareEvent.RED_POINT_CHANGE,this.updateState,this),this.updateState()},c.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},c.prototype._updateState=function(){this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.share)&&App.IsSysOpen(iface.tb_prop.sysOpenTypeKey.share)&&-1!=App.hero.shareVisable&&M.ShareModel.redPointVisiable(this._id))},c);function c(t,e){var i=l.call(this,t)||this;return i._id=e,i}var p,m=(p=M.RedPointBaseRule,__extends(d,p),d.prototype.init=function(){p.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateState,this),this.updateState()},d.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},d.prototype._updateState=function(){this.updateVisible(M.DailyCopyModel.getInstance().canRedPoint(this._type))},d);function d(t,e){var i=p.call(this,t)||this;return i._type=e,i}var _,v=(_=M.RedPointBaseRule,__extends(f,_),f.prototype.init=function(){_.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.YuanzhengEvent.YZ_DISPATCH_SUCC,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.HudEvent.UPDATE_CROSS_DAY_INFO,this.updateState,this),this.updateState()},f.prototype.updateState=function(){App.IsSysOpen(ModuleConst.EXPEDITION)&&Laya.timer.frameOnce(3,this,this._updateState)},f.prototype._updateState=function(){this.updateVisible(M.YuanzhengModel.getInstance().getDispatchNum()<=0)},f);function f(t){return _.call(this,t)||this}var g,b=(g=M.RedPointBaseRule,__extends(y,g),y.prototype.init=function(){g.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.CopyTeamEvent.REWARD_SUCC,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.CopyTeamEvent.UPDATE_GROUP_INFO,this.updateState,this),this.updateState()},y.prototype.updateState=function(){App.IsSysOpen(ModuleConst.TEAM_COPY)&&Laya.timer.frameOnce(3,this,this._updateState)},y.prototype._updateState=function(){this.updateVisible(M.CopyTeamModel.getInstance().isCanReward())},y);function y(t){return g.call(this,t)||this}var I,T=(I=M.RedPointBaseRule,__extends(w,I),w.prototype.init=function(){I.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.CopyTeamEvent.UPDATE_APPLY_RP,this.updateState,this),this.updateState()},w.prototype.updateState=function(){App.IsSysOpen(ModuleConst.TEAM_COPY)&&Laya.timer.frameOnce(3,this,this._updateState)},w.prototype._updateState=function(){this.updateVisible(M.CopyTeamModel.getInstance().hasApplyRedPoint())},w);function w(t){return I.call(this,t)||this}var E,C=(E=M.RedPointBaseRule,__extends(S,E),S.prototype.init=function(){E.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ArtifactEvent.ARTIFACT_OPERATION_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ArtifactEvent.ADJUST_LINEUP_ARTIFACT_SUCCESS,this._updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},S.prototype.updateState=function(){App.IsSysOpen(ModuleConst.ARTIFACT)&&Laya.timer.frameOnce(3,this,this._updateState)},S.prototype._updateState=function(){this.updateVisible(M.ArtifactModel.getInstance().getArtifactRedPoint(this._id,this._type))},S);function S(t,e,i){var n=E.call(this,t)||this;return n._id=e,n._type=i,n}var L,x=(L=M.RedPointBaseRule,__extends(A,L),A.prototype.init=function(){L.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.RankingListEvent.RED_EVENT_RANKLIST,this.updateState,this),this.setState(this._id)},A.prototype.updateState=function(t){Laya.timer.frameOnce(3,this,this._updateState,[t])},A.prototype._updateState=function(t){this.setState(this._id)},A.prototype.setState=function(t){var e=M.GuajiModel.getInstance().isPassCopy(common.GlobalData.GUAJI_COPY_2_10)&&M.RankModel.getInstance().canRedPoint(t);this.updateVisible(e)},A);function A(t,e){var i=L.call(this,t)||this;return i._id=e,i}var B,V=(B=M.RedPointBaseRule,__extends(N,B),N.prototype.init=function(){B.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TopUpEvent.UPDATE_TEQUANRED_EVEN,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.VIP_LEVEL_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.RESOURCE_CHANGE,this.updateState,this),this.updateState()},N.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},N.prototype._updateState=function(){this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.recharge)&&M.ChongzhiModel.getInstance().tequanRedPoint())},N);function N(t){return B.call(this,t)||this}var G,H=(G=M.RedPointBaseRule,__extends(j,G),j.prototype.init=function(){G.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TopUpEvent.SHOUCHONG_RED_EVEN,this.updateState,this),this.setState(this._id)},j.prototype.updateState=function(t){Laya.timer.frameOnce(3,this,this._updateState,[t])},j.prototype._updateState=function(t){var e=t.data;e&&e==this._id?this.setState(e):this.setState(this._id)},j.prototype.setState=function(t){var e=M.ChongzhiModel.getInstance().canRedPoint(t);this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.firstCharge)&&e)},j);function j(t,e){var i=G.call(this,t)||this;return i._id=e,i}var F,W=(F=M.RedPointBaseRule,__extends(K,F),K.prototype.init=function(){F.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.SevendaysEvent.SEVENDAYS_RED_EVENT,this.updateState,this),this.setState(this._day,this._id)},K.prototype.updateState=function(t){Laya.timer.frameOnce(3,this,this._updateState,[t])},K.prototype._updateState=function(t){var e=t.data;e?e.day-7*(e.time_type-1)==this._day&&this.setState(this._day,this._id):this.setState(this._day,this._id)},K.prototype.setState=function(t,e){var i=M.SevendaysModel.getInstance().canRedPoint(t,e);this.updateVisible(i&&M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.sevenDay))},K);function K(t,e,i){var n=F.call(this,t)||this;return n._id=i,n._day=e,n}var q,z=(q=M.RedPointBaseRule,__extends(Y,q),Y.prototype.init=function(){q.prototype.init.call(this),this._updateState(),tl3d.ModuleEventManager.addEvent(M.SevendaysEvent.SEVENDAYS_RED_EVENT,this._updateState,this)},Y.prototype._updateState=function(){var t=M.SevendaysModel.getInstance().getSevendaysExtList().some(function(t){return t.isCanReward()});this.updateVisible(t&&M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.sevenDay))},Y);function Y(t){return q.call(this,t)||this}var X,J=(X=M.RedPointBaseRule,__extends(Q,X),Q.prototype.init=function(){X.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TimelimitEvent.RED_EVENT,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),M.TimelimitModel.getInstance().hasActivity()&&this.setState()},Q.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this.setState)},Q.prototype.setState=function(){var t=M.TimelimitModel.getInstance().canRedPoint(this._id);this.updateVisible(t&&M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.activity))},Q);function Q(t,e){var i=X.call(this,t)||this;return i._id=e,i}var Z,$=(Z=M.RedPointBaseRule,__extends(tt,Z),tt.prototype.init=function(){Z.prototype.init.call(this),this.updateState(),tl3d.ModuleEventManager.addEvent(M.TimelimitEvent.GROUP_RED_EVENT,this.updateState,this)},tt.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this.setState)},tt.prototype.setState=function(){var t=M.TimelimitModel.getInstance().canGroupBuyRedPoint();this.updateVisible(t&&M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.activity))},tt);function tt(t){return Z.call(this,t)||this}var et,it=(et=M.RedPointBaseRule,__extends(nt,et),nt.prototype.init=function(){et.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TimelimitEvent.FUND_RED_EVENT,this.updateState,this),this.setState()},nt.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this.setState)},nt.prototype.setState=function(){this.updateVisible(this.isCanReceive())},nt.prototype.isCanReceive=function(){if(!M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.openSvrFund))return!1;if(-1==App.hero.welfare.weekFund.indexOf(this._id))return!1;for(var t=App.getOpenServerTime(),e=(App.getServerTime()-t)/86400,i=0;i<this._fundList.length;i++){var n=this._fundList[i];if(e>=n.value-1&&-1==App.hero.welfare.weekFundAward.indexOf(n.ID))return!0}return!1},nt);function nt(t,e){var i=et.call(this,t)||this;return i._id=e,i._fundList=tb.TB_fund_reward.getFundListByType(e),i}var ot,at=(ot=M.RedPointBaseRule,__extends(rt,ot),rt.prototype.init=function(){ot.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.LimiteBuyEvent.UPDATE_RP,this.updateState,this),this.updateState()},rt.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},rt.prototype._updateState=function(){this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.timeLimitBuy)&&M.LimiteBuyModel.getInstance().isVisible())},rt);function rt(t){return ot.call(this,t)||this}var st,ut=(st=M.RedPointBaseRule,__extends(ht,st),ht.prototype.init=function(){st.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.UPDATE_DAILY_TASK,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.UPDATE_LIVENESS_DATA,this.updateState,this),this.updateState()},ht.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ht.prototype._updateState=function(){this.updateVisible(M.TaskModel.getInstance().canRewardDailyTask())},ht);function ht(t){return st.call(this,t)||this}var lt,ct=(lt=M.RedPointBaseRule,__extends(pt,lt),pt.prototype.init=function(){lt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.UNLOCK_WARRIOR_JINJIE_SUCC,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.UPDATE_WARRIOR_EXP,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.REWARD_LEVEL_SUCC,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.HudEvent.UPDATE_CROSS_DAY_INFO,this.updateState,this),this.updateState()},pt.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},pt.prototype._updateState=function(){this.updateVisible(M.WarriorProveModel.getInstance().isCanReward())},pt);function pt(t){return lt.call(this,t)||this}var dt,_t=(dt=M.RedPointBaseRule,__extends(ft,dt),ft.prototype.init=function(){dt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.UPDATE_TRIAL_TASK_COUNT,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.UPDATE_TRIAL_TASK_REWARD,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.HudEvent.UPDATE_CROSS_DAY_INFO,this.updateState,this),this.updateState()},ft.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ft.prototype._updateState=function(){this.updateVisible(M.TrialTaskModel.getInstance().isCanReward(this._type))},ft);function ft(t,e){var i=dt.call(this,t)||this;return i._type=e,i}var gt,yt=(gt=M.RedPointBaseRule,__extends(mt,gt),mt.prototype.init=function(){gt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.UNLOCK_WARRIOR_JINJIE_SUCC,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.REWARD_WEEK_GIFT_SUCC,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.HudEvent.UPDATE_CROSS_DAY_INFO,this.updateState,this),this.updateState()},mt.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},mt.prototype._updateState=function(){this.updateVisible(M.WarriorProveModel.getInstance().isCanRewardGift())},mt);function mt(t){return gt.call(this,t)||this}var vt,bt=(vt=M.RedPointBaseRule,__extends(It,vt),It.prototype.init=function(){vt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.MailEvent.UPDATE_MAIL_DATA,this.updateState,this),this.updateState()},It.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},It.prototype._updateState=function(){this.updateVisible(M.MailModel.getInstance().isShowMailRedpoint())},It);function It(t){return vt.call(this,t)||this}var Tt,wt=(Tt=M.RedPointBaseRule,__extends(Et,Tt),Et.prototype.init=function(){Tt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TujianEvent.ACTIVITY_TUJIAN_SUCC,this.updateState,this),this.updateState()},Et.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Et.prototype._updateState=function(){this.updateVisible(!this._vo.isActiviteComplete()&&this._vo.isActivite())},Et);function Et(t,e){var i=Tt.call(this,t)||this;return i._vo=e,i}var Ct;Ct=M.RedPointBaseRule,__extends(St,Ct),St.prototype.init=function(){Ct.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.MailEvent.UPDATE_FRIEND_POINT_DATA,this.updateState,this),this.updateState()},St.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},St.prototype._updateState=function(){this.updateVisible(M.MailModel.getInstance().canOperateFriendPoint())};function St(t){return Ct.call(this,t)||this}var Lt,xt=(Lt=M.RedPointBaseRule,__extends(At,Lt),At.prototype.init=function(){Lt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HudEvent.EXCHANGE_GOLD_CHANGE,this.updateState,this),this.updateState()},At.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},At.prototype._updateState=function(){var t=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.goldBuyFreeNum);this.updateVisible(t<tb.TB_exchange_set.getSet().daily_free)},At);function At(t){return Lt.call(this,t)||this}var Mt,Dt=(Mt=M.RedPointBaseRule,__extends(Ot,Mt),Ot.prototype.init=function(){Mt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TaskEvent.UPDATE_ACHIEVEMENT_DATA,this.updateState,this),this.updateState()},Ot.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ot.prototype._updateState=function(){this.updateVisible(M.TaskModel.getInstance().canRewardHonor())},Ot);function Ot(t){return Mt.call(this,t)||this}var Rt,Pt=(Rt=M.RedPointBaseRule,__extends(Ut,Rt),Ut.prototype.init=function(){Rt.prototype.init.call(this),this._data=M.BianQiangModel.getInstance().getChallengeTabData(this._id),tl3d.ModuleEventManager.addEvent(M.TaskEvent.UPDATE_ACHIEVEMENT_DATA,this.updateState,this),this.updateState()},Ut.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ut.prototype._updateState=function(){this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.beStrong)&&this._data.canReward())},Ut);function Ut(t,e){var i=Rt.call(this,t)||this;return i._id=e,i}var kt;kt=M.RedPointBaseRule,__extends(Bt,kt),Bt.prototype.init=function(){kt.prototype.init.call(this),this.updateState()},Bt.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Bt.prototype._updateState=function(){this.updateVisible(!1)};function Bt(t){return kt.call(this,t)||this}var Vt,Nt=(Vt=M.RedPointBaseRule,__extends(Gt,Vt),Gt.prototype.init=function(){Vt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},Gt.prototype.updateState=function(){App.IsSysOpen(ModuleConst.ADVENTURE)&&Laya.timer.frameOnce(3,this,this._updateState)},Gt.prototype._updateState=function(){var t=tb.TB_risk_set.getTabSet(),e=App.hero.getBagItemNum(t.once_cost[0]);this.updateVisible(App.IsSysOpen(ModuleConst.ADVENTURE)&&t.once_cost[1]<=e)},Gt);function Gt(t){return Vt.call(this,t)||this}var Ht,jt=(Ht=M.RedPointBaseRule,__extends(Ft,Ht),Ft.prototype.init=function(){Ht.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.DafuwengEvent.UPDATE_RISK_INFO,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.DafuwengEvent.ADD_RISK_INFO,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.DafuwengEvent.DEL_RISK_INFO,this.updateState,this),this.updateState()},Ft.prototype.updateState=function(){App.IsSysOpen(ModuleConst.ADVENTURE)&&Laya.timer.frameOnce(3,this,this._updateState)},Ft.prototype._updateState=function(){this.updateVisible(0<M.DafuwengModel.getInstance().getRiskList(!1).length)},Ft);function Ft(t){return Ht.call(this,t)||this}var Wt,Kt=(Wt=M.RedPointBaseRule,__extends(qt,Wt),qt.prototype.init=function(){Wt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.FriendEvent.UPDATE_FRIEND_APPLY,this.updateState,this),this.updateState()},qt.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},qt.prototype._updateState=function(){this.updateVisible(M.FriendModel.getInstance().friendApplyRp())},qt);function qt(t){return Wt.call(this,t)||this}var zt,Yt=(zt=M.RedPointBaseRule,__extends(Xt,zt),Xt.prototype.init=function(){zt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ChatEvent.UPDATE_NEW_CHAT_COUNT,this.updateState,this),this.updateState()},Xt.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Xt.prototype._updateState=function(){this.updateVisible(M.ChatModel.getInstance().hasNewNum())},Xt);function Xt(t){return zt.call(this,t)||this}var Jt,Qt=(Jt=M.RedPointBaseRule,__extends(Zt,Jt),Zt.prototype.init=function(){Jt.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ChatEvent.UPDATE_PRIVATE_CHAT,this.updateState,this),this.updateState()},Zt.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Zt.prototype._updateState=function(){this.updateVisible(M.ChatModel.getInstance().hasNewPrivateChat())},Zt);function Zt(t){return Jt.call(this,t)||this}var $t,te=($t=M.RedPointBaseRule,__extends(ee,$t),ee.prototype.init=function(){$t.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.LIMIT_VALUE_CHANGE,this.updateState,this),this.updateState()},ee.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ee.prototype._updateState=function(){var t=M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.welfare);this.updateVisible(App.hero.getlimitValue(t&&iface.tb_prop.limitTypeKey.wishFreeNum)<tb.TB_wish_set.getFreeNum())},ee);function ee(t){return $t.call(this,t)||this}var ie,ne=(ie=M.RedPointBaseRule,__extends(oe,ie),oe.prototype.init=function(){ie.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.AWARD_EVENT,this.updateState,this),this.updateState()},oe.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},oe.prototype._updateState=function(){var e=M.HuodongModel.getTotalSignNum(),t=tb.TB_total_sign.get_TB_total_sign().filter(function(t){return e>=t.total_day&&!(App.hero.welfare.totalSignIn[t.ID]&&1==App.hero.welfare.totalSignIn[t.ID])}),i=!M.HuodongModel.isTodaySign()||0<t.length;this.updateVisible(i&&M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.welfare))},oe);function oe(t){return ie.call(this,t)||this}var ae,re=(ae=M.RedPointBaseRule,__extends(se,ae),se.prototype.init=function(){ae.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.AWARD_EVENT,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.VIP_LEVEL_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.RESOURCE_CHANGE,this.updateState,this),this.updateState()},se.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},se.prototype._updateState=function(){this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.payActivity)&&M.HuodongModel.getInstance().ratingFundRedPoint())},se);function se(t){return ae.call(this,t)||this}var ue,he=(ue=M.RedPointBaseRule,__extends(le,ue),le.prototype.init=function(){ue.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.ROLE_LEVEL_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.AWARD_EVENT,this.updateState,this),this.updateState()},le.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},le.prototype._updateState=function(){var t=M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.welfare);this.updateVisible(t&&M.HuodongModel.getInstance().levelPackIsAllGet())},le);function le(t){return ue.call(this,t)||this}var ce,pe=(ce=M.RedPointBaseRule,__extends(de,ce),de.prototype.init=function(){ce.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.RESOURCE_CHANGE,this.updateState,this),this.updateState()},de.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},de.prototype._updateState=function(){this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.payActivity)&&App.hero.welfare.monthCardEndTime>App.getServerTime()&&1!=App.hero.welfare.monthCardAward)},de);function de(t){return ce.call(this,t)||this}var _e,fe=(_e=M.RedPointBaseRule,__extends(ge,_e),ge.prototype.init=function(){_e.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.RESOURCE_CHANGE,this.updateState,this),this.updateState()},ge.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ge.prototype._updateState=function(){this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.payActivity)&&1==App.hero.welfare.lifelongCard&&1!=App.hero.welfare.lifelongCardAward)},ge);function ge(t){return _e.call(this,t)||this}var ye;ye=M.RedPointBaseRule,__extends(me,ye),me.prototype.init=function(){ye.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.AWARD_EVENT,this.updateState,this),this.updateState()},me.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},me.prototype._updateState=function(){this.updateVisible(!(1==App.hero.welfare.autonymAwardNum))};function me(t){return ye.call(this,t)||this}var ve,be=(ve=M.RedPointBaseRule,__extends(Ie,ve),Ie.prototype.init=function(){ve.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.LUCK_EQUIP_VALUE_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.LUCK_EQUIP_REWARD_CHANGE,this.updateState,this),this.updateState()},Ie.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ie.prototype._updateState=function(){this.updateVisible(M.HuodongModel.getInstance().luckyEquipExtRewardRP())},Ie);function Ie(t){return ve.call(this,t)||this}var Te,we=(Te=M.RedPointBaseRule,__extends(Ee,Te),Ee.prototype.init=function(){Te.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.LIMIT_VALUE_CHANGE,this.updateState,this),this.updateState()},Ee.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ee.prototype._updateState=function(){var t=0<M.HuodongModel.getLuckFreeCount(TURNTABLE.EQUIP);this.updateVisible(0!=App.hero.welfare.luckEquipId&&t)},Ee);function Ee(t){return Te.call(this,t)||this}var Ce,Se=(Ce=M.RedPointBaseRule,__extends(Le,Ce),Le.prototype.init=function(){Ce.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.LUCK_TREASURE_VALUE_CHANGE,this.updateState,this),this.updateState()},Le.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Le.prototype._updateState=function(){var t=!1;if(0<App.hero.welfare.luckTreasureId){var e=tb.TB_luck_treasure_time.getTempById(App.hero.welfare.luckTreasureId);t=App.hero.welfare.luckTreasureNum>=e.luck_value}this.updateVisible(t)},Le);function Le(t){return Ce.call(this,t)||this}var xe,Ae=(xe=M.RedPointBaseRule,__extends(Me,xe),Me.prototype.init=function(){xe.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.LIMIT_VALUE_CHANGE,this.updateState,this),this.updateState()},Me.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Me.prototype._updateState=function(){var t=0<M.HuodongModel.getLuckFreeCount(TURNTABLE.TREASURE);this.updateVisible(0!=App.hero.welfare.luckTreasureId&&t)},Me);function Me(t){return xe.call(this,t)||this}var De,Oe=(De=M.RedPointBaseRule,__extends(Re,De),Re.prototype.init=function(){De.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.LIMIT_VALUE_CHANGE,this.updateState,this),this.updateState()},Re.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Re.prototype._updateState=function(){var t=0<M.HuodongModel.getLuckFreeCount(TURNTABLE.GOD);this.updateVisible(0!=App.hero.welfare.luckGodId&&t)},Re);function Re(t){return De.call(this,t)||this}var Pe,Ue=(Pe=M.RedPointBaseRule,__extends(ke,Pe),ke.prototype.init=function(){Pe.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.LIMIT_VALUE_CHANGE,this.updateState,this),this.updateState()},ke.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ke.prototype._updateState=function(){var t=0<M.HuodongModel.getLuckFreeCount(TURNTABLE.ART);this.updateVisible(0!=App.hero.welfare.luckArtId&&t)},ke);function ke(t){return Pe.call(this,t)||this}var Be,Ve=(Be=M.RedPointBaseRule,__extends(Ne,Be),Ne.prototype.init=function(){Be.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.PowerrankEvent.UPDATE_REDPOINT,this.updateState,this),this.updateState()},Ne.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ne.prototype._updateState=function(){this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.godRank)&&M.PowerrankModel.getInstance().firstLogin)},Ne);function Ne(t){return Be.call(this,t)||this}var Ge,He=(Ge=M.RedPointBaseRule,__extends(je,Ge),je.prototype.init=function(){Ge.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.AWARD_EVENT,this.updateState,this),this.updateState()},je.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},je.prototype._updateState=function(){this.updateVisible(M.HudModel.isHudShow(iface.tb_prop.sysOpenTypeKey.welfare)&&M.HuodongModel.getInstance().everyDaySignRP())},je);function je(t){return Ge.call(this,t)||this}var Fe,We=(Fe=M.RedPointBaseRule,__extends(Ke,Fe),Ke.prototype.init=function(){Fe.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.ROLE_LEVEL_CHANGE,this.updateState,this),this.updateState()},Ke.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ke.prototype._updateState=function(){var t=App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.worldBossNum),e=App.IsSysOpen(ModuleConst.WORLD_BOSS);this.updateVisible(0<t&&e),e&&tl3d.ModuleEventManager.removeEvent(M.ResEvent.ROLE_LEVEL_CHANGE,this.updateState,this)},Ke);function Ke(t){return Fe.call(this,t)||this}var qe,ze=(qe=M.RedPointBaseRule,__extends(Ye,qe),Ye.prototype.init=function(){qe.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.GUILD_DONATE_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_GUILD_INFO,this.updateState,this),this.updateState()},Ye.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ye.prototype._updateState=function(){this.updateVisible(M.GuildModel.getInstance().isCanDonate())},Ye);function Ye(t){return qe.call(this,t)||this}var Xe,Je=(Xe=M.RedPointBaseRule,__extends(Qe,Xe),Qe.prototype.init=function(){Xe.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_GUILD_INFO,this.updateState,this),this.updateState()},Qe.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Qe.prototype._updateState=function(){this.updateVisible(M.GuildCopyModel.getInstance().isCanChallenge())},Qe);function Qe(t){return Xe.call(this,t)||this}var Ze,$e=(Ze=M.RedPointBaseRule,__extends(ti,Ze),ti.prototype.init=function(){Ze.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.RECEIVE_JIANGLI_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_JIANGLI_INFO,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_GUILD_INFO,this.updateState,this),this.updateState()},ti.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ti.prototype._updateState=function(){this.updateVisible(M.GuildCopyModel.getInstance().isCanReward())},ti);function ti(t){return Ze.call(this,t)||this}var ei,ii=(ei=M.RedPointBaseRule,__extends(ni,ei),ni.prototype.init=function(){ei.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_APPLY_INFO,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_GUILD_INFO,this.updateState,this),this.updateState()},ni.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ni.prototype._updateState=function(){this.updateVisible(M.GuildModel.getInstance().isHasNewApply())},ni);function ni(t){return ei.call(this,t)||this}var oi,ai=(oi=M.RedPointBaseRule,__extends(ri,oi),ri.prototype.init=function(){oi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.GUILD_SKILL_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_GUILD_INFO,this.updateState,this),this.updateState()},ri.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ri.prototype._updateState=function(){this.updateVisible(M.GuildSkillModel.getInstance().isHasDonateLevelUp())},ri);function ri(t){return oi.call(this,t)||this}var si,ui=(si=M.RedPointBaseRule,__extends(hi,si),hi.prototype.init=function(){si.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.REWARD_CHEST_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_WAR_REDPOINT,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_GUILD_INFO,this.updateState,this),this.updateState()},hi.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},hi.prototype._updateState=function(){this.updateVisible(M.GuildFightModel.getInstance().isCanReward())},hi);function hi(t){return si.call(this,t)||this}var li,ci=(li=M.RedPointBaseRule,__extends(pi,li),pi.prototype.init=function(){li.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.JOIN_FIGHT_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_WAR_REDPOINT,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_GUILD_INFO,this.updateState,this),this.updateState()},pi.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},pi.prototype._updateState=function(){this.updateVisible(M.GuildFightModel.getInstance().isCanJoin())},pi);function pi(t){return li.call(this,t)||this}var di,_i=(di=M.RedPointBaseRule,__extends(fi,di),fi.prototype.init=function(){di.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.SEND_ASK_HELP_SUCC,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_MY_HELP_LIST,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.HudEvent.UPDATE_CROSS_DAY_INFO,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_GUILD_INFO,this.updateState,this),this.updateState()},fi.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},fi.prototype._updateState=function(){this.updateVisible(M.GuildHelpModel.getInstance().isCanAskHelp())},fi);function fi(t){return di.call(this,t)||this}var gi,yi=(gi=M.RedPointBaseRule,__extends(mi,gi),mi.prototype.init=function(){gi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_MY_HELP_LIST,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.REWARD_HELPED_ITEM_SUCC,this.updateState,this),this.updateState()},mi.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},mi.prototype._updateState=function(){this.updateVisible(M.GuildHelpModel.getInstance().isCanRewardSuipian())},mi);function mi(t){return gi.call(this,t)||this}var vi,bi=(vi=M.RedPointBaseRule,__extends(Ii,vi),Ii.prototype.init=function(){vi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.UPDATE_OTHERS_HELP_LIST,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GuildEvent.HELP_OTHERS_SUCC,this.updateState,this),this.updateState()},Ii.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ii.prototype._updateState=function(){this.updateVisible(M.GuildHelpModel.getInstance().isCanHelpOthers())},Ii);function Ii(t){return vi.call(this,t)||this}var Ti,wi=(Ti=M.RedPointBaseRule,__extends(Ei,Ti),Ei.prototype.init=function(){Ti.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.EscortEvent.UPDATE_SELF_INFO,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.EscortEvent.ESCORT_GOODS_SUCCESS,this.updateState,this),this.updateState()},Ei.prototype.updateState=function(){App.IsSysOpen(ModuleConst.CARAVAN_ESCORT)&&Laya.timer.frameOnce(3,this,this._updateState)},Ei.prototype._updateState=function(){this.updateVisible(M.EscortModel.getInstance().canDoubleEscort())},Ei);function Ei(t){return Ti.call(this,t)||this}var Ci,Si=(Ci=M.RedPointBaseRule,__extends(Li,Ci),Li.prototype.init=function(){Ci.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.EscortEvent.UPDATE_RECORD_RP,this.updateState,this),this.updateState()},Li.prototype.updateState=function(){App.IsSysOpen(ModuleConst.CARAVAN_ESCORT)&&Laya.timer.frameOnce(3,this,this._updateState)},Li.prototype._updateState=function(){this.updateVisible(M.EscortModel.getInstance().hasNewRecord)},Li);function Li(t){return Ci.call(this,t)||this}var xi,Ai=(xi=M.RedPointBaseRule,__extends(Mi,xi),Mi.prototype.init=function(){xi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.DownloadeEvent.RED_CHANGE_EVENT,this.updateState,this),this.updateState()},Mi.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Mi.prototype._updateState=function(){dispatchEvt(new M.HudEvent(M.HudEvent.UPDATE_MAINVIEW_BUTTON));var t=iface.tb_prop.sysOpenTypeKey.microClient;this.updateVisible(M.HudModel.isHudShow(t)&&App.IsSysOpen(t)&&1==App.hero.downClient&&!App.hero.isReceiveWDXZ)},Mi);function Mi(t){return xi.call(this,t)||this}var Di,Oi=(Di=M.RedPointBaseRule,__extends(Ri,Di),Ri.prototype.init=function(){Di.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.EscortEvent.UPDATE_SELF_INFO,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.EscortEvent.UPDATE_REWARD_RP,this.updateState,this),this.updateState(),Laya.timer.loop(1e3,this,this.updateState)},Ri.prototype.updateState=function(){App.IsSysOpen(ModuleConst.CARAVAN_ESCORT)&&Laya.timer.frameOnce(3,this,this._updateState)},Ri.prototype._updateState=function(){this.updateVisible(M.EscortModel.getInstance().canReward())},Ri);function Ri(t){return Di.call(this,t)||this}var Pi,Ui=(Pi=M.RedPointBaseRule,__extends(ki,Pi),ki.prototype.init=function(){Pi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.CHALLENGE_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.ALL_PASS_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.RECEIVE_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.Init_FOREST,this.updateState,this),this.updateState()},ki.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ki.prototype._updateState=function(){this.updateVisible(M.FogForestModel.getInstance().isCanReward())},ki);function ki(t){return Pi.call(this,t)||this}var Bi,Vi=(Bi=M.RedPointBaseRule,__extends(Ni,Bi),Ni.prototype.init=function(){Bi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.ALL_PASS_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.Init_FOREST,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.UPDATE_CUR_GUANQIA,this.updateState,this),this.updateState()},Ni.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ni.prototype._updateState=function(){this.updateVisible(M.FogForestModel.getInstance().isCanOneKeyPass())},Ni);function Ni(t){return Bi.call(this,t)||this}var Gi,Hi=(Gi=M.RedPointBaseRule,__extends(ji,Gi),ji.prototype.init=function(){Gi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.CHALLENGE_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.ALL_PASS_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.SHOW_MAIN_VIEW,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.FogForestEvent.Init_FOREST,this.updateState,this),this.updateState()},ji.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ji.prototype._updateState=function(){this.updateVisible(M.FogForestModel.getInstance().isVisible())},ji);function ji(t){return Gi.call(this,t)||this}var Fi,Wi=(Fi=M.RedPointBaseRule,__extends(Ki,Fi),Ki.prototype.init=function(){Fi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.IslandsEvent.UPDATE_RECORD_INFO,this.updateState,this),this.updateState()},Ki.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Ki.prototype._updateState=function(){"island_record"==this.name?this.updateVisible(M.IslandModel.getInstance().hasNewRecord):this.updateVisible(M.IslandModel.getInstance().hasEndTime)},Ki);function Ki(t){return Fi.call(this,t)||this}var qi,zi=(qi=M.RedPointBaseRule,__extends(Yi,qi),Yi.prototype.init=function(){qi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.TOTAL_LOGIN_DAY,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.LOGIN_GIFT_RECEIVE,this.updateState,this),this.updateState()},Yi.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Yi.prototype._updateState=function(){var t=!1;if(this._allTemps&&0<this._allTemps.length)for(var e=App.hero.welfare.totalLoginDay?App.hero.welfare.totalLoginDay:0,i=App.hero.welfare.loginGiftPack?App.hero.welfare.loginGiftPack:{},n=0;n<this._allTemps.length;n++){var o=this._allTemps[n];if(o.ID<=e&&!i.hasOwnProperty(o.ID)){t=!0;break}}this.updateVisible(t)},Yi);function Yi(t,e){var i=qi.call(this,t)||this;return i._type=e,i._allTemps=tb.TB_sevendays.get_TB_sevendays(e),i}var Xi,Ji=(Xi=M.RedPointBaseRule,__extends(Qi,Xi),Qi.prototype.init=function(){Xi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},Qi.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Qi.prototype._updateState=function(){this._resType==iface.tb_prop.resTypeKey.friend?this.updateVisible(1e3<=App.hero.friend):this._resType==CostTypeKey.weizhi_zhaohuanshu?"summon_weizhi1"==this.name?this.updateVisible(0==App.hero.getlimitValue(iface.tb_prop.limitTypeKey.propFreeNum)):this.updateVisible(10<=App.hero.getBagItemNum(CostTypeKey.weizhi_zhaohuanshu)):this._resType==CostTypeKey.shenmi_zhaohuanshu&&("summon_shenmi10"==this.name?this.updateVisible(10<=App.hero.getBagItemNum(CostTypeKey.shenmi_zhaohuanshu)):"summon_shenmi1"==this.name&&this.updateVisible(1<=App.hero.getBagItemNum(CostTypeKey.shenmi_zhaohuanshu)||0==App.hero.getlimitValue(iface.tb_prop.limitTypeKey.diamondFreeNum)))},Qi);function Qi(t,e){var i=Xi.call(this,t)||this;return i._resType=e,i}var Zi,$i=(Zi=M.RedPointBaseRule,__extends(tn,Zi),tn.prototype.init=function(){Zi.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.HuodongEvent.REFRESH_YUEKA_PANEL,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.SummonEvent.ZHAOHUAN_SUCCESS,this.updateState,this),this.updateState()},tn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},tn.prototype._updateState=function(){var t=App.hero.levelPrivilege(iface.tb_prop.levelPrivilegeTypeKey.legendEmploy),e=tb.TB_god_employ_set.get_TB_god_employ_setnById(1).special_employ[1]<=App.hero.legendChip;this.updateVisible(t&&e)},tn);function tn(t){return Zi.call(this,t)||this}var en,nn=(en=M.RedPointBaseRule,__extends(on,en),on.prototype.init=function(){en.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.TIME_PROP_CHANGE,this.updateState,this),this.updateState()},on.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},on.prototype._updateState=function(){this.updateVisible(this._receiveTime<=App.getServerTime())},on);function on(t,e){var i=en.call(this,t)||this;return i._receiveTime=e,i}var an,rn=(an=M.RedPointBaseRule,__extends(sn,an),sn.prototype.init=function(){an.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},sn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},sn.prototype._updateState=function(){this.updateVisible(1<=App.hero.getBagItemNum(this._key))},sn);function sn(t,e){var i=an.call(this,t)||this;return i._key=e,i}var un,hn=(un=M.RedPointBaseRule,__extends(ln,un),ln.prototype.init=function(){un.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},ln.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},ln.prototype._updateState=function(){var t=tb.TB_item.get_TB_itemById(Number(this._key)),e=App.hero.getBagItemNum(this._key)>=Number(t.using_effect[1]);this.updateVisible(e)},ln);function ln(t,e){var i=un.call(this,t)||this;return i._key=e,i}var cn,pn=(cn=M.RedPointBaseRule,__extends(dn,cn),dn.prototype.init=function(){cn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.ROLE_LEVEL_CHANGE,this.updateState,this),this.updateState()},dn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},dn.prototype._updateState=function(){this.updateVisible(M.GodUtils.isCanBuzhen())},dn);function dn(t){return cn.call(this,t)||this}var _n,fn=(_n=M.RedPointBaseRule,__extends(gn,_n),gn.prototype.init=function(){_n.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GodEvent.USE_EXPPOOL_SUCCESS,this.updateStateByLv,this),tl3d.ModuleEventManager.addEvent(M.GodEvent.GOD_SHENGJIE_SUCCESS,this.updateStateByLv,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.GOD_EXP_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.RESOURCE_CHANGE,this.updateState,this),this.updateState()},gn.prototype.updateStateByExp=function(){this.updateState()},gn.prototype.updateStateByLv=function(t){this.gid==t.data&&this.updateState()},gn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},gn.prototype._updateState=function(){var t=App.hero.getGodVoById(this.gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this.gid)?this.updateVisible(t.isCanLvup()):this.updateVisible(!1)},gn);function gn(t,e){var i=_n.call(this,t)||this;return i.gid=e,i}var yn,mn=(yn=M.RedPointBaseRule,__extends(vn,yn),vn.prototype.init=function(){yn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GodEvent.USE_EXPPOOL_SUCCESS,this.updateStateByLv,this),tl3d.ModuleEventManager.addEvent(M.GodEvent.GOD_SHENGJIE_SUCCESS,this.updateStateByLv,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},vn.prototype.updateStateByLv=function(t){this.gid==t.data&&this.updateState()},vn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},vn.prototype._updateState=function(){var t=App.hero.getGodVoById(this.gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this.gid)?this.updateVisible(t.isCanDegreeUp()):this.updateVisible(!1)},vn);function vn(t,e){var i=yn.call(this,t)||this;return i.gid=e,i}var bn,In=(bn=M.RedPointBaseRule,__extends(Tn,bn),Tn.prototype.init=function(){bn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.ADD_SKINID,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},Tn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Tn.prototype._updateState=function(){var t=App.hero.getGodVoById(this.gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this.gid)?this.updateVisible(M.GodUtils.isCanActivitySkin(t.tab_god)):this.updateVisible(!1)},Tn);function Tn(t,e){var i=bn.call(this,t)||this;return i.gid=e,i}var wn,En=(wn=M.RedPointBaseRule,__extends(Cn,wn),Cn.prototype.init=function(){wn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.TreasureEvent.MODIFY_GOD_TREASURE,this.updateState,this),this.updateState()},Cn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Cn.prototype._updateState=function(){var t=App.hero.getGodVoById(this.gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this.gid)?this.updateVisible(t.isCanWearTreasure()):this.updateVisible(!1)},Cn);function Cn(t,e){var i=wn.call(this,t)||this;return i.gid=e,i}var Sn,Ln=(Sn=M.RedPointBaseRule,__extends(xn,Sn),xn.prototype.init=function(){Sn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.EQUIPMENET_CHANGE,this.updateState,this),this.updateState()},xn.prototype.updateState=function(){Laya.timer.frameOnce(5,this,this._updateState)},xn.prototype._updateState=function(){var t=App.hero.getGodVoById(this._gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this._gid)?this.updateVisible(!!M.EquipModel.getInstance().slotEquip(t,this._slot,!0)):this.updateVisible(!1)},xn);function xn(t,e,i){var n=Sn.call(this,t)||this;return n._gid=e,n._slot=i,n}var An,Mn=(An=M.RedPointBaseRule,__extends(Dn,An),Dn.prototype.init=function(){An.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.EQUIPMENET_CHANGE,this.updateState,this),this.updateState()},Dn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Dn.prototype._updateState=function(){var t=App.hero.getGodVoById(this._gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this._gid)?this.updateVisible(t.isCanOneKeyEquip()):this.updateVisible(!1)},Dn);function Dn(t,e){var i=An.call(this,t)||this;return i._gid=e,i}var On,Rn=(On=M.RedPointBaseRule,__extends(Pn,On),Pn.prototype.init=function(){On.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.EQUIPMENET_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.RESOURCE_CHANGE,this.updateState,this),this.updateState()},Pn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Pn.prototype._updateState=function(){var t=App.hero.getGodVoById(this._gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this._gid)?this.updateVisible(M.EquipModel.getInstance().isCanSth(null,t,!1)):this.updateVisible(!1)},Pn);function Pn(t,e){var i=On.call(this,t)||this;return i._gid=e,i}var Un,kn=(Un=M.RedPointBaseRule,__extends(Bn,Un),Bn.prototype.init=function(){Un.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.EQUIPMENET_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.RESOURCE_CHANGE,this.updateState,this),this.updateState()},Bn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Bn.prototype._updateState=function(){var t=App.hero.getGodVoById(this._gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this._gid)?this.updateVisible(M.EquipModel.getInstance().isCanRefine(null,t,!1)):this.updateVisible(!1)},Bn);function Bn(t,e){var i=Un.call(this,t)||this;return i._gid=e,i}var Vn,Nn=(Vn=M.RedPointBaseRule,__extends(Gn,Vn),Gn.prototype.init=function(){Vn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GemstoneEvent.MODIFY_GOD_GEMTONE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GemstoneEvent.MODIFY_GEMTONE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GemstoneEvent.ADD_GEMTONE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GemstoneEvent.DEL_GEMTONE,this.updateState,this),this.updateState()},Gn.prototype.updateState=function(){App.IsSysOpen(ModuleConst.EQUIP_BAOSHI)&&Laya.timer.frameOnce(3,this,this._updateState)},Gn.prototype._updateState=function(){var t=App.hero.getGodVoById(this._key);if(t){var e=t.getGemsBySlot(this._gemSlot);if(e)this.updateVisible(M.GemstoneModel.getInstance().isHasBetterGem(this._gemType,e.gemLv));else{var i=M.GemstoneModel.getInstance().getGemstoneByType(this._gemType);this.updateVisible(!!i&&0<i.num)}}},Gn);function Gn(t,e,i,n){var o=Vn.call(this,t)||this;return o._key=e,o._gemType=n,o._gemSlot=i,o}var Hn,jn=(Hn=M.RedPointBaseRule,__extends(Fn,Hn),Fn.prototype.init=function(){Hn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.RONGHUN_SUCCESS,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},Fn.prototype.updateState=function(){App.IsSysOpen(ModuleConst.RONGHUN)&&Laya.timer.frameOnce(3,this,this._updateState)},Fn.prototype._updateState=function(){var t=App.hero.getGodVoById(this.gid);if(t){var e=tb.TB_fusion_soul.get_TB_fusion_soulById(t.fuseLevel);if(e){var i=new Array;switch(this.type){case 1:i=e.cost_hp;break;case 2:i=e.cost_atk;break;case 3:i=e.cost_def}var n=t.countRonghunAttr(),o=App.hero.getBagItemNum(i[0][0]);1==this.times?this.updateVisible(o>=i[0][1]&&(!t.fuseAttrLevels[this.type]||n[this.type]<e.attr_max[this.type-1][1])):this.updateVisible(o>=10*Number(i[0][1])&&(!t.fuseAttrLevels[this.type]||n[this.type]<e.attr_max[this.type-1][1]))}}},Fn);function Fn(t,e,i,n){var o=Hn.call(this,t)||this;return o.gid=e,o.type=i,o.times=n,o}var Wn,Kn=(Wn=M.RedPointBaseRule,__extends(qn,Wn),qn.prototype.init=function(){Wn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GodEvent.GOD_PORP_CHANGE,this.updateState,this),this.updateState()},qn.prototype.updateState=function(){App.IsSysOpen(ModuleConst.SHENGXING)&&Laya.timer.frameOnce(3,this,this._updateState)},qn.prototype._updateState=function(){var t=App.hero.getGodVoById(this.gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this.gid)?this.updateVisible(t.isCanStarUp(!0)):this.updateVisible(!1)},qn);function qn(t,e){var i=Wn.call(this,t)||this;return i.gid=e,i}var zn,Yn=(zn=M.RedPointBaseRule,__extends(Xn,zn),Xn.prototype.init=function(){zn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodEvent.BUZHEN_COMPLETE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.GodEvent.GOD_PORP_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},Xn.prototype.updateState=function(){App.IsSysOpen(ModuleConst.JUEXING)&&Laya.timer.frameOnce(3,this,this._updateState)},Xn.prototype._updateState=function(){var t=App.hero.getGodVoById(this.gid);t&&-1!=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack).indexOf(this.gid)?this.updateVisible(t.isCanAwaken()):this.updateVisible(!1)},Xn);function Xn(t,e){var i=zn.call(this,t)||this;return i.gid=e,i}var Jn,Qn=(Jn=M.RedPointBaseRule,__extends(Zn,Jn),Zn.prototype.init=function(){Jn.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.ROLE_LEVEL_CHANGE,this.updateState,this),this.updateState()},Zn.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},Zn.prototype._updateState=function(){this.updateVisible(0<App.hero.arenaNum&&App.IsSysOpen(ModuleConst.JINGJI))},Zn.prototype.onDispose=function(){Jn.prototype.onDispose.call(this)},Zn);function Zn(t){return Jn.call(this,t)||this}var $n,to=($n=M.RedPointBaseRule,__extends(eo,$n),eo.prototype.init=function(){$n.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ArenaEvent.MATCH_REWARD_BOX_SUCC,this.updateState,this),this.updateState()},eo.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},eo.prototype._updateState=function(){this.updateVisible(M.MatchModel.getInstance().isCanReward())},eo);function eo(t){return $n.call(this,t)||this}var io,no=(io=M.RedPointBaseRule,__extends(oo,io),oo.prototype.init=function(){io.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateState,this),this.updateState()},oo.prototype.updateState=function(){App.IsSysOpen(ModuleConst.MATCH_FIGHT)&&Laya.timer.frameOnce(3,this,this._updateState)},oo.prototype._updateState=function(){this.updateVisible(App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.matchNum)>=tb.TB_match_set.getSet().limit_num)},oo);function oo(t){return io.call(this,t)||this}var ao,ro=(ao=M.RedPointBaseRule,__extends(so,ao),so.prototype.init=function(){ao.prototype.init.call(this),this.updateState()},so.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},so.prototype._updateState=function(){},so);function so(t){return ao.call(this,t)||this}var uo,ho=(uo=M.RedPointBaseRule,__extends(lo,uo),lo.prototype.init=function(){uo.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GodDoorEvent.OPEN_DOOR_EVENT,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.ResEvent.PROP_CHANGE,this.updateState,this),this.updateState()},lo.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},lo.prototype._updateState=function(){this.updateVisible(0<App.hero.getBagItemNum(CostTypeKey.shenjiemiyao)&&App.IsSysOpen(ModuleConst.SHENMEN))},lo);function lo(t){return uo.call(this,t)||this}var co,po=(co=M.RedPointBaseRule,__extends(_o,co),_o.prototype.init=function(){co.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GloryEvent.JOIN_SUCCESS,this.updateState,this),this.updateState(),Laya.timer.loop(1e3,this,this.updateState)},_o.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},_o.prototype._updateState=function(){this.updateVisible(M.GloryModel.getInstance().isCanJoin())},_o);function _o(t){return co.call(this,t)||this}var fo,go=(fo=M.RedPointBaseRule,__extends(yo,fo),yo.prototype.init=function(){fo.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.GloryEvent.SHOW_REDPOINT,this.updateState,this),this.updateState()},yo.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},yo.prototype._updateState=function(){var t=1==App.hero.loginCount;this.updateVisible(M.GloryModel.getInstance().isOpen()&&t&&!M.GloryModel.getInstance().isHasShow)},yo);function yo(t){return fo.call(this,t)||this}var mo,vo=(mo=M.RedPointBaseRule,__extends(bo,mo),bo.prototype.init=function(){mo.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateState,this),this.updateState(),Laya.timer.loop(1e3,this,this.updateState)},bo.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},bo.prototype._updateState=function(){this.updateVisible(M.GodDomainModel.getInstance().challengeRp())},bo);function bo(t){return mo.call(this,t)||this}var Io,To=(Io=M.RedPointBaseRule,__extends(wo,Io),wo.prototype.init=function(){Io.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.ResEvent.LIMIT_VALUE_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.TopUpEvent.SHOW_CHONGZHISUCC_PANEL,this.updateState,this),this.updateState(),Laya.timer.loop(1e3,this,this.updateState)},wo.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},wo.prototype._updateState=function(){var t=App.hero.totalFreeCount(iface.tb_prop.limitTypeKey.fastFrightFreeNum)-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.fastFrightFreeNum);this.updateVisible(0<t)},wo);function wo(t){return Io.call(this,t)||this}var Eo,Co=(Eo=M.RedPointBaseRule,__extends(So,Eo),So.prototype.init=function(){Eo.prototype.init.call(this),tl3d.ModuleEventManager.addEvent(M.UpRoadEvent.UR_LEVEL_CHANGE,this.updateLevel,this),tl3d.ModuleEventManager.addEvent(M.UpRoadEvent.UR_COUNT_CHANGE,this.updateState,this),tl3d.ModuleEventManager.addEvent(M.UpRoadEvent.UR_REWARD_CHANGE,this.updateState,this),this.updateLevel()},So.prototype.updateLevel=function(){var t=App.hero.tasks.advanceLevel,e=tb.TB_advance_road.getMaxLevel(),i=e<=t?e:t+1;this._curAdvanceRoadT=tb.TB_advance_road.getSet(i),this.updateState()},So.prototype.updateState=function(){Laya.timer.frameOnce(3,this,this._updateState)},So.prototype._updateState=function(){var t=!1;if(this._curAdvanceRoadT)for(var e=this._curAdvanceRoadT.getCondition(),i=0;i<e.length;i++){var n=e[i],o=App.hero.tasks.advanceInfos[n.ID];if(o&&(!o.reward||o.reward<1)&&(o.count?o.count:0)>=n.num){t=!0;break}}this.updateVisible(t)},So);function So(t){return Eo.call(this,t)||this}function Lo(t){for(var e=tb.TB_operate_activity.gettimeIdx(),i=[],n=0;n<e.length;n++){var o="timeActivity"+(h=e[n]);i.push(o),M.RedPointManager.injection(new J(o,h))}var a=tb.TB_activity_set.getTabSet().group_buy_time;if(App.hero.openSvrTime+a>App.getServerTime()){o="timeActivity"+M.TimelimitModel.ACTIVITY_OPENBUY_ID;i.push(o),M.RedPointManager.injection(new $(o))}M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.activity],i));var r=TableData.getInstance().getTableByName(TableData.tb_fund).data,s=[];for(var u in r){var h;o="FundActivity"+(h=r[u].ID);s.push(o),M.RedPointManager.injection(new it(o,h))}M.RedPointManager.injection(new M.RedPointGroup("timeActivity"+M.TimelimitModel.ACTIVITY_JIJIN_ID,s));for(var l=[],c=tb.TB_share.getTB_share(),p=0;p<c.length;p++){o="shareActivity"+c[p].ID;l.push(o),M.RedPointManager.injection(new k(o,c[p].ID))}M.RedPointManager.injection(new k("shareActivity0",0)),l.push("shareActivity0"),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.share],l)),M.RedPointManager.injection(new Ai("downClient")),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.microClient],["downClient"])),M.RedPointManager.injection(new R("bindPhoneActivity")),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.bindGift],["bindPhoneActivity"])),M.RedPointManager.injection(new P("superVipActivity")),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.superVip],["superVipActivity"])),M.RedPointManager.injection(new U("testRebateActivity")),M.RedPointManager.injection(new M.RedPointGroup(t[ModuleConst.TEST_REBATE],["testRebateActivity"])),M.RedPointManager.injection(new M.RedPointGroup(t[ModuleConst.WARRIOR_PROVE],["task_group"]));var d=[],_=M.OnlineModel.getInstance().getList();for(p=0;p<_.length;p++){if(!(y=_[p]).isReceive()){o="onlineActivity"+y.id;d.push(o),M.RedPointManager.injection(new O(o,y))}}d&&0<d.length&&M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.onlineAward],d));var f=[],g=M.OpenserverModel.getInstance().getList();for(p=0;p<g.length;p++){var y;if(!(y=g[p]).isReceive()){o="openRewardActivity"+y.id;f.push(o),M.RedPointManager.injection(new D(o,y))}}f&&0<f.length&&M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.openGift],f)),M.RedPointManager.injection(new at("limitebuy_reward")),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.timeLimitBuy],["limitebuy_reward"])),M.RedPointManager.injection(new te("fuli_xuyuan")),M.RedPointManager.injection(new he("fili_dengji")),M.RedPointManager.injection(new ne("fuli_qiandao")),M.RedPointManager.injection(new He("fuli_meiri")),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.welfare],["fuli_xuyuan","fuli_qiandao","fili_dengji","fuli_meiri"])),M.RedPointManager.injection(new re("fuli_jijin")),M.RedPointManager.injection(new pe("month_reward")),M.RedPointManager.injection(new fe("life_reward")),M.RedPointManager.injection(new M.RedPointGroup("fuli_yueka",["month_reward","life_reward"])),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.payActivity],["fuli_jijin","fuli_yueka"])),M.RedPointManager.injection(new Oe("lucky_god")),M.RedPointManager.injection(new be("lucky_equip_reward")),M.RedPointManager.injection(new we("lucky_equip_free")),M.RedPointManager.injection(new M.RedPointGroup("lucky_equip",["lucky_equip_reward","lucky_equip_free"])),M.RedPointManager.injection(new Ue("lucky_art")),M.RedPointManager.injection(new Ae("lucky_treasure_free")),M.RedPointManager.injection(new Se("lucky_treasure_reward")),M.RedPointManager.injection(new M.RedPointGroup("lucky_treasure",["lucky_treasure_free","lucky_treasure_reward"])),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.luckTurnTable],["lucky_god","lucky_equip","lucky_treasure"])),M.RedPointManager.injection(new Ve(t[iface.tb_prop.sysOpenTypeKey.godRank])),M.RedPointManager.injection(new V("tequan_canbuy")),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.recharge],["tequan_canbuy"]));var m=M.BianQiangModel.getInstance().getChallengeTabTypeList();m.forEach(function(t){M.RedPointManager.injection(new Pt("challenge_tab_"+t,t))}),M.RedPointManager.injection(new M.RedPointGroup("achievement_challenge",m.map(function(t){return"challenge_tab_"+t}))),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.beStrong],["achievement_challenge"]));var v=[],b=M.ChongzhiModel.getInstance().firstRechargeName;for(var I in b)v.push(b[I][1]),M.RedPointManager.injection(new H(b[I][1],Number(I)));M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.firstCharge],v));var T=[],w=M.SevendaysModel.getInstance().arrDays,E=M.SevendaysModel.getInstance().arrProJect;for(var I in w)T.push(w[I][1]);for(var C=0;C<T.length;C++){var S=[];for(var I in E){var L=E[I][1]+C;S.push(L),M.RedPointManager.injection(new W(L,C,Number(I)))}M.RedPointManager.injection(new M.RedPointGroup(T[C],S))}M.RedPointManager.injection(new z("sevendayExt"));var x=T.concat("sevendayExt");M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.sevenDay],x)),M.RedPointManager.injection(new M.RedPointGroup(t[iface.tb_prop.sysOpenTypeKey.halfMonth],x));for(var A=1;A<=tb.TB_sevendays.TYPE_NUM;A++)M.RedPointManager.injection(new zi("login_gift"+A,A));M.RedPointManager.injection(new M.RedPointGroup(t[ModuleConst.LOGIN_QIRI],["login_gift1"])),M.RedPointManager.injection(new M.RedPointGroup(t[ModuleConst.LOGIN_SHISIRI],["login_gift2"]))}function xo(){var t,e=M.BagModel.bagTypeName,i=[],n=tb.TB_item.get_TB_item("type","2");n=n.concat(tb.TB_item.get_TB_item("type","10"));for(var o=0;o<n.length;o++){var a="bag_material_"+n[o].ID;i.push(a),M.RedPointManager.injection(new rn(a,n[o].ID))}for(var r=[],s=tb.TB_item.get_TB_item("type","6"),u=0;u<s.length;u++){var h="bag_suipian_"+s[u].ID;r.push(h),M.RedPointManager.injection(new hn(h,s[u].ID))}t=i.concat(r);for(o=0;o<e.length;o++){var l=[];"bag_group_all"==e[o]?l=t:"bag_group_suipian"==e[o]?l=r:"bag_group_cailiao"==e[o]&&(l=i),M.RedPointManager.injection(new M.RedPointGroup(e[o],l))}M.RedPointManager.injection(new M.RedPointGroup("bag_group",e))}function Ao(){for(var t in App.hero.bagTimeItemsObj)Mo(t,App.hero.bagTimeItemsObj[t])}function Mo(t,e){var i=M.RedPointManager.getRule("bag_group_all"),n=M.RedPointManager.getRule("bag_group_cailiao"),o=new nn("bag_timeItem_"+t,0<e.limitTime?e.limitTime:0);M.RedPointManager.injection(o),i&&i.addRule(o),n.addRule(o)}function Do(){M.RedPointManager.injection(new Dt("task_achievement_group")),M.RedPointManager.injection(new ut("task_daily_group")),M.RedPointManager.injection(new ct("task_warrior_group")),M.RedPointManager.injection(new _t("task_trial_week",0)),M.RedPointManager.injection(new _t("task_trial_month",1)),M.RedPointManager.injection(new yt("task_trial_gift")),M.RedPointManager.injection(new M.RedPointGroup("task_trial_group",["task_trial_week","task_trial_month","task_trial_gift"])),M.RedPointManager.injection(new M.RedPointGroup("task_group",["task_achievement_group","task_daily_group","task_warrior_group","task_trial_group"])),M.RedPointManager.injection(new jt("adventure_qiyu")),M.RedPointManager.injection(new Nt("adventure_count")),M.RedPointManager.injection(new M.RedPointGroup("adventure_group",["adventure_qiyu","adventure_count"])),M.RedPointManager.injection(new M.RedPointGroup("lilian_group",["adventure_group","task_group","function100","function200","function300","function400","uproad_red","fast_fight"]))}function Oo(){var t=[],e=[],i=tb.TB_artifact.get_TB_artifact();for(var n in i){var o=i[n].ID;t.push(o),e.push("artifactGroup_"+o)}for(var a=0,r=t;a<r.length;a++){var s="artifactGroup_"+(o=r[a]),u=["artifact_activate_"+o,"artifact_strength_"+o,"artifact_skillUp_"+o,"artifact_pbaptize_"+o,"artifact_gbaptize_"+o,"artifact_enchant_"+o],h=[Artifact.ACTIVATE,Artifact.STRENGTH,Artifact.SKILLUPGRADE,Artifact.PBAPTIZE,Artifact.GBAPTIZE,Artifact.ENCHANT];for(var n in u){var l=u[n];M.RedPointManager.injection(new C(l,o,h[n]))}M.RedPointManager.injection(new M.RedPointGroup("artifact_jinengGroup_"+o,["artifact_skillUp_"+o])),M.RedPointManager.injection(new M.RedPointGroup("artifact_enchantGroup_"+o,["artifact_enchant_"+o])),M.RedPointManager.injection(new M.RedPointGroup("artifact_shengjiGroup_"+o,["artifact_strength_"+o])),M.RedPointManager.injection(new M.RedPointGroup("artifact_baptizeGroup_"+o,["artifact_pbaptize_"+o,"artifact_gbaptize_"+o])),M.RedPointManager.injection(new M.RedPointGroup(s,["artifact_activate_"+o,"artifact_shengjiGroup_"+o,"artifact_jinengGroup_"+o,"artifact_baptizeGroup_"+o,"artifact_enchantGroup_"+o]))}M.RedPointManager.injection(new M.RedPointGroup("artifact_RootGroup",e))}function Ro(){logdebug("重新设置英雄的红点设置");var v=M.RedPointManager.getRule("shenling_group");v=v||M.RedPointManager.injection(new M.RedPointGroup("shenling_group",[]));var b=M.RedPointManager.getRule("shenlingequip_group");if(b=b||M.RedPointManager.injection(new M.RedPointGroup("shenlingequip_group",[])),!v.hasRule("shenling_buzhen_group")){M.RedPointManager.injection(new pn("shenling_buzhen"));var t=M.RedPointManager.injection(new M.RedPointGroup("shenling_buzhen_group",["shenling_buzhen"]));v.addRule(t)}for(var e=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack),i=v.getRuleNames(),n=i.length-1;0<=n;n--){var o=i[n];if(o.includes("attack_linuep_god_")){var a=o.substr(18);-1==e.indexOf(a)&&M.RedPointManager.removeRule(o)}}var r=b.getRuleNames();for(n=r.length-1;0<=n;n--){var s=r[n];if(s.includes("attack_linuep_god_equip_")){a=s.substr(24);-1==e.indexOf(a)&&M.RedPointManager.removeRule(s)}}function u(e){var t="attack_linuep_god_"+e,i="attack_linuep_god_equip_"+e,n=M.RedPointManager.getRule(t);n=n||M.RedPointManager.injection(new M.RedPointGroup(t,[])),v.addRule(n);var o=M.RedPointManager.getRule(i);o=o||M.RedPointManager.injection(new M.RedPointGroup(i,[])),b.addRule(o);var a=M.RedPointManager.injection(new En("god_treasure_wear_"+e,e));n.addRule(a);var r=M.RedPointManager.injection(new In("god_skin_"+e,e));n.addRule(r);for(var s=M.GodModel.getInstance().tabredName,u=M.EquipModel.getInstance().equiptabredName,h=s.map(function(t){return t+"_"+e}),l=u.map(function(t){return t+"_"+e}),c=0;c<h.length;c++){var p=[];if(c==ShenlingTabType.info)p.push("god_lvup_"+e),M.RedPointManager.injection(new fn("god_lvup_"+e,e)),p.push("god_dgup_"+e),M.RedPointManager.injection(new mn("god_dgup_"+e,e));else if(c==ShenlingTabType.shengxin)p.push("god_starup_"+e),M.RedPointManager.injection(new Kn("god_starup_"+e,e));else if(c==ShenlingTabType.ronghun)for(var d=1;d<4;d++){var _=new Array;_.push("god_ball_"+e+"_"+d),p.push("god_ronghun_"+e+"_"+d),p.push("god_ronghunten_"+e+"_"+d),M.RedPointManager.injection(new jn("god_ball_"+e+"_"+d,e,d,1)),M.RedPointManager.injection(new M.RedPointGroup("god_ronghun_"+e+"_"+d,_)),M.RedPointManager.injection(new jn("god_ronghunten_"+e+"_"+d,e,d,10))}else c==ShenlingTabType.awaken&&(p.push("god_awaken_"+e),M.RedPointManager.injection(new Yn("god_awaken_"+e,e)));var f=M.RedPointManager.injection(new M.RedPointGroup(h[c],p));n.addRule(f)}for(c=0;c<l.length;c++){p=[];if(c==EquipTabType.strength){for(d=1;d<=4;d++)p.push("god_equip_"+e+"_"+d),M.RedPointManager.injection(new Ln("god_equip_"+e+"_"+d,e,d));p.push("god_onekey_equip_"+e),M.RedPointManager.injection(new Mn("god_onekey_equip_"+e,e)),p.push("god_onekey_strength_"+e),M.RedPointManager.injection(new Rn("god_onekey_strength_"+e,e))}else if(c==EquipTabType.refine)p.push("god_onekey_refine_"+e),M.RedPointManager.injection(new kn("god_onekey_refine_"+e,e));else if(c==EquipTabType.baoshi)for(d=1;d<=M.EquipModel.EQUIP_COUNT;d++){p.push("equip_baoshi_group_"+e+"_"+d);for(var g=new Array,y=1;y<=M.GemstoneModel.gemstone_type_count;y++){var m=(d-1)*M.GemstoneModel.gemstone_type_count+y;g.push("equip_baoshi_"+e+"_"+m),M.RedPointManager.injection(new Nn("equip_baoshi_"+e+"_"+m,e,m,y))}M.RedPointManager.injection(new M.RedPointGroup("equip_baoshi_group_"+e+"_"+d,g))}f=M.RedPointManager.injection(new M.RedPointGroup(l[c],p));o.addRule(f)}}for(var h=0,l=e;h<l.length;h++){u(a=l[h])}v.runHandler(),b.runHandler()}M.registerRedPoint=function(){M.RedPointManager.injection(new bt("mail_mail")),M.RedPointManager.injection(new M.RedPointGroup("mail_group",["mail_mail"])),M.FateModel.getInstance().initFateList();for(var t=M.FateModel.getInstance().arrFateVo,e=[],i=0;i<t.length;i++){var n=t[i];if(!n.isActiviteComplete()){var o="fate_"+n.tbGodFate.ID;e.push(o),M.RedPointManager.injection(new wt(o,n))}}M.RedPointManager.injection(new M.RedPointGroup("godFateRedPoint",e)),M.RedPointManager.injection(new M.RedPointGroup("tujian_group",["godFateRedPoint"])),M.RedPointManager.injection(new Kt("friend_apply")),M.RedPointManager.injection(new Qt("friend_privatechat")),M.RedPointManager.injection(new M.RedPointGroup("friend_group",["friend_apply","friend_privatechat"])),M.RedPointManager.injection(new ro("jishi_group")),M.RedPointManager.injection(new Ji("summon_weizhi1",CostTypeKey.weizhi_zhaohuanshu)),M.RedPointManager.injection(new Ji("summon_weizhi10",CostTypeKey.weizhi_zhaohuanshu)),M.RedPointManager.injection(new Ji("summon_shenmi1",CostTypeKey.shenmi_zhaohuanshu)),M.RedPointManager.injection(new Ji("summon_shenmi10",CostTypeKey.shenmi_zhaohuanshu)),M.RedPointManager.injection(new Ji("summon_friend10",iface.tb_prop.resTypeKey.friend)),M.RedPointManager.injection(new $i("summon_legend")),M.RedPointManager.injection(new M.RedPointGroup("summon_group",["summon_weizhi10","summon_shenmi1","summon_shenmi10","summon_friend10","summon_legend"])),M.RedPointManager.injection(new Qn("jingjichang_count")),M.RedPointManager.injection(new M.RedPointGroup("jingjichang_group",["jingjichang_count"])),M.RedPointManager.injection(new to("jjc_match_award")),M.RedPointManager.injection(new no("jjc_match_count")),M.RedPointManager.injection(new M.RedPointGroup("jjc_match_group",["jjc_match_award","jjc_match_count"])),M.RedPointManager.injection(new M.RedPointGroup("jingjichang_root_group",["jingjichang_group","jjc_match_group"])),M.RedPointManager.injection(new ho("godDoor_kaiqi")),M.RedPointManager.injection(new M.RedPointGroup("godDoor_group",["godDoor_kaiqi"])),M.RedPointManager.injection(new xt("exchange_gold")),M.RedPointManager.injection(new Yt("chat_group"));for(var a=[],r=0,s=[iface.tb_prop.overplusTypeKey.dailyCopyNum1,iface.tb_prop.overplusTypeKey.dailyCopyNum2,iface.tb_prop.overplusTypeKey.dailyCopyNum3];r<s.length;r++){var u=s[r];a.push("dailyCoyp_tab"+u),M.RedPointManager.injection(new m("dailyCoyp_Challenge"+u,u)),M.RedPointManager.injection(new M.RedPointGroup("dailyCoyp_tab"+u,["dailyCoyp_Challenge"+u]))}M.RedPointManager.injection(new M.RedPointGroup("dailycopy_group",a)),M.RedPointManager.injection(new v("yuanzheng_dispatch")),M.RedPointManager.injection(new M.RedPointGroup("yuanzheng_group",["yuanzheng_dispatch"])),M.RedPointManager.injection(new b("team_reward")),M.RedPointManager.injection(new T("CopyTeamRp")),M.RedPointManager.injection(new M.RedPointGroup("team_group",["team_reward","CopyTeamRp"]));var h=[],l=M.RankModel.getInstance().arrRankListName;for(var c in l)h.push(l[c][1]),M.RedPointManager.injection(new x(l[c][1],l[c][2]));M.RedPointManager.injection(new M.RedPointGroup("rankingList_group",h)),M.RedPointManager.injection(new We("boss_count")),M.RedPointManager.injection(new M.RedPointGroup("boss_group",["boss_count"])),M.RedPointManager.injection(new Je("guild_challenge")),M.RedPointManager.injection(new $e("guild_reward")),M.RedPointManager.injection(new M.RedPointGroup("guild_copy_group",["guild_challenge","guild_reward"])),M.RedPointManager.injection(new ii("guild_apply")),M.RedPointManager.injection(new M.RedPointGroup("guild_hall_group",["guild_apply"])),M.RedPointManager.injection(new ze("guild_donate")),M.RedPointManager.injection(new ai("guild_skill")),M.RedPointManager.injection(new ui("guild_war_award")),M.RedPointManager.injection(new ci("guild_war_join")),M.RedPointManager.injection(new M.RedPointGroup("guild_war_group",["guild_war_award","guild_war_join"])),M.RedPointManager.injection(new _i("guild_help_ask")),M.RedPointManager.injection(new yi("guild_help_award")),M.RedPointManager.injection(new M.RedPointGroup("guild_help_my_group",["guild_help_ask","guild_help_award"])),M.RedPointManager.injection(new bi("guild_help_others")),M.RedPointManager.injection(new M.RedPointGroup("guild_help_group",["guild_help_my_group","guild_help_others"])),M.RedPointManager.injection(new M.RedPointGroup("guild_root_group",["guild_donate","guild_copy_group","guild_hall_group","guild_skill","guild_war_group","guild_help_group"])),M.RedPointManager.injection(new wi("escort_escort")),M.RedPointManager.injection(new Si("escort_record")),M.RedPointManager.injection(new Oi("escort_reward")),M.RedPointManager.injection(new M.RedPointGroup("escort_group",["escort_escort","escort_record","escort_reward"])),M.RedPointManager.injection(new Hi("forest_MaxGuanqia")),M.RedPointManager.injection(new Vi("forest_onekey")),M.RedPointManager.injection(new Ui("forest_reward")),M.RedPointManager.injection(new M.RedPointGroup("forest_group",["forest_reward","forest_onekey","forest_MaxGuanqia"])),M.RedPointManager.injection(new Wi("island_record")),M.RedPointManager.injection(new Wi("island_endtime")),M.RedPointManager.injection(new M.RedPointGroup("island_group",["island_record","island_endtime"])),M.RedPointManager.injection(new po("glory_join")),M.RedPointManager.injection(new go("glory_login")),M.RedPointManager.injection(new M.RedPointGroup("glory_group",["glory_join","glory_login"])),M.RedPointManager.injection(new vo("goddm_challenge")),M.RedPointManager.injection(new M.RedPointGroup("godDm_group",["goddm_challenge"])),M.RedPointManager.injection(new Co("uproad_red")),M.RedPointManager.injection(new To("fast_fight"));var p={},d=[],_=M.HudModel.getInstance().upperBtnVos;for(var f in _){var g=_[f];p[g.sysOpenId]=g.redpointName,d.push(g.redpointName)}for(var y in Lo(p),xo(),M.RedPointManager.injection(new M.RedPointGroup("main_group",["guild_root_group","godDoor_group","summon_group","jishi_group","mail_group","task_group","tujian_group","friend_group","rankingList_group"].concat(d))),M.RedPointManager.injection(new M.RedPointGroup("shengcheng_group",[])),Ro(),Oo(),Do(),Ao(),tb.TB_function.FUNCTION_GROUP_REDPOINT)M.RedPointManager.injection(new M.RedPointGroup("function"+y,tb.TB_function.FUNCTION_GROUP_REDPOINT[y]))},M.registerActivityGroup=Lo,M.registerBagGroup=xo,M.registerTimeItemGroup=Ao,M.addTimeItem2Group=Mo,M.removeTimeItem2Group=function(t){M.RedPointManager.removeRule("bag_timeItem_"+t)},M.registerGuajiGroup=Do,M.registerArtifactGroup=Oo,M.registerGodAndEquipGroup=Ro}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var t,e=(t=ui.rank.render.RankTabIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t){this.on(Laya.Event.CLICK,this,this.onClickBg),this.btn_wordShip.on(Laya.Event.CLICK,this,this.onClickMB),tl3d.ModuleEventManager.addEvent(u.RankingListEvent.RANK_DATA_CHANGE,this.updateInfo,this),tl3d.ModuleEventManager.addEvent(u.RankingListEvent.RANK_MOBAI_CHANGE,this.updateBtn,this);var e=t.typeList;this._redName=e[1],this._rankType=e[2],this._bgSkin=e[5],this.img_bg.skin=LanMgr.getLan("paihangbang/{0}",-1,this._bgSkin),this.updateInfo()}else this._rankType=0,this._redName="",this._bgSkin="",this.img_bg.skin="",this.redPoint.setRedPointName(""),this._firstData=null,this.off(Laya.Event.CLICK,this,this.onClickBg),this.btn_wordShip.off(Laya.Event.CLICK,this,this.onClickMB),tl3d.ModuleEventManager.removeEvent(u.RankingListEvent.RANK_DATA_CHANGE,this.updateInfo,this),tl3d.ModuleEventManager.removeEvent(u.RankingListEvent.RANK_MOBAI_CHANGE,this.updateBtn,this)},i.prototype.updateInfo=function(){var t=this.dataSource;if(this._firstData=t?t.svo:null,this._firstData){this.box_info.visible=!0,this.lab_empty.visible=!1;var e=LanMgr.getLan(t.typeList[3],-1);if(this._rankType==RankListType.Guild){this.lab_name.text=this._firstData.name;var i=this._firstData.level+"";this.lab_value1.text=e+"："+i,this.ui_headBox.dataSource=new UserHeadVo(this._firstData.head,this._firstData.level,this._firstData.headFrame,!0)}else{var n=this._firstData[3],o=this._firstData[2],a=this._firstData[1],r=this._firstData[4],s=(this._firstData[0],this._firstData[5],this._firstData[6]);this.lab_name.text=o,i=a+"",this._rankType==RankListType.Tower?i=u.TowerModel.getInstance().getCopyRankDesc(a):this._rankType==RankListType.Copy&&(i=u.GuajiModel.getInstance().getCopyRankDesc(a)),this.lab_value1.text=e+"："+i,this.ui_headBox.dataSource=new UserHeadVo(n,r,s,!1)}this.redPoint.setRedPointName(this._redName),this.updateBtn()}else this.box_info.visible=!1,this.lab_empty.visible=!0,this.redPoint.setRedPointName("")},i.prototype.updateBtn=function(){App.hero.worshipInfo[this._rankType]?(this.btn_wordShip.gray=!0,this.btn_wordShip.label=LanMgr.getLan("",12188)):(this.btn_wordShip.gray=!1,this.btn_wordShip.label=LanMgr.getLan("",12189))},i.prototype.onClickBg=function(t){this._firstData?dispatchEvt(new u.RankingListEvent(u.RankingListEvent.SHOW_RANKINGLIST_PANEL),this._rankType):showToast(LanMgr.getLan("",10447))},i.prototype.onClickMB=function(t){t.stopPropagation(),this.btn_wordShip.gray||dispatchEvt(new u.RankingListEvent(u.RankingListEvent.RANKINGLIST_IS_WORKSHIP),this._rankType)},i);function i(){return t.call(this)||this}u.RankTabIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var t,e=(t=ui.rank.render.RankIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=a.RankModel.getInstance(),i=a.RankModel.getInstance().arrRankListName.find(function(t){return t[2]==e.curRankType});if(this.redPoint.setRedPointName(i[1]),this.ui_view.dataSource={rank:t.king+1},!t.hasOwnProperty("name"))return this.box_info.visible=!1,void(this.lab_empty.visible=!0);this.box_info.visible=!0,this.lab_empty.visible=!1,this.lab_guildName.text="公会："+(t.guildName?""==t.guildName?LanMgr.getLan("无",-1):t.guildName:LanMgr.getLan("无",-1));var n=!!App.hero.worshipInfo[i[2]],o=LanMgr.getLan(i[3],-1);this.lab_name.text=t.name,this.ui_headBox.dataSource=new UserHeadVo(t.head,t.level,t.headFrame,t instanceof a.GuildRankListVo),4==e.curRankType?(this.ui_headBox.off(Laya.Event.CLICK,this,this.onClick),this.lab_name.text="会长："+t.name,this.lab_name.y=70,this.lab_guildName.y=35):(this.ui_headBox.on(Laya.Event.CLICK,this,this.onClick),this.lab_name.y=35,this.lab_guildName.y=70),0==t.king?(this.lab_value1.text=o+"："+t.value,this.btn_wordShip.on(Laya.Event.CLICK,this,this.wordShip),this.btn_wordShip.selected=this.btn_wordShip.disabled=n,this.btn_wordShip.label=n?LanMgr.getLan("已膜拜",-1):LanMgr.getLan("膜拜",-1),4==e.curRankType?(this.lab_guildName.y=20,this.lab_name.y=50):(this.lab_name.y=20,this.lab_guildName.y=50),this.lab_value1.y=80):(this.lab_value2.text=o,this.lab_value22.text=t.value,this.btn_wordShip.off(Laya.Event.CLICK,this,this.wordShip)),this.lab_value2.visible=this.lab_value22.visible=!0,this.lab_value1.visible=!1,this.btn_wordShip.visible=!1}else this.btn_wordShip.off(Laya.Event.CLICK,this,this.wordShip),this.redPoint.onDispose()},i.prototype.updateBtn=function(){0==this.dataSource.king&&(this.btn_wordShip.visible=!1)},i.prototype.wordShip=function(){dispatchEvt(new a.RankingListEvent(a.RankingListEvent.RANKINGLIST_IS_WORKSHIP))},i.prototype.onClick=function(){this.dataSource&&UIUtil.showPlayerLineupInfo(this.dataSource.playerId)},i);function i(){return t.call(this)||this}a.RankModuleIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.rank.RankTabViewUI,__extends(n,i),n.prototype.close=function(){i.prototype.close.call(this),e.RankModel.getInstance().rankingList={},this.list_tab.array=null,this.bgPanel.dataSource=null},n.prototype.popup=function(){i.prototype.popup.call(this),this.initView()},n.prototype.initView=function(){var i=this.dataSource||[];this.bgPanel.dataSource={uiName:UIConst.RankTabView,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12186)};var t=e.RankModel.getInstance().arrRankListName.map(function(t,e){return{typeList:t,svo:i[e]}});this.list_tab.array=t},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}e.RankTabView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var e,t=(e=ui.rank.RankViewUI,__extends(i,e),i.prototype.close=function(){this._rankVoList=null,e.prototype.close.call(this),this.uiScene&&this.uiScene.onExit(),this.list_rankList.array=null},i.prototype.popup=function(){e.prototype.popup.call(this),this.initView(this.dataSource)},i.prototype.initView=function(t){var e,i=this._model,n=i.curRankType==RankListType.Guild;if(this._rankVoList=[],n){for(var o in t.levelRankList){var a=new l.GuildRankListVo(t.levelRankList[o]);this._rankVoList.push(a)}e=0==t.myRank?LanMgr.getLan("",12084):t.myRank,this.list_rankList.y=135,this.list_rankList.height=848,this.boxCommonRank.visible=!1}else{for(var o in t.rankList)a=new l.ServerRankListVo(t.rankList[o]),this._rankVoList.push(a);e=0!=t.myRank?t.myRank:LanMgr.getLan("",12187),this.list_rankList.y=614,this.list_rankList.height=369,this.boxCommonRank.visible=!0}for(var o in this._rankVoList)this._rankVoList[o].king=Number(o);this.lab_valueName.text=i.getValueName(),this.setSelectTabNum(~~l.RankModel.getInstance().arrRankListName.findIndex(function(t){return t[2]==i.curRankType}));var r=this._rankVoList.find(function(t){return t.playerId==App.hero.playerId});this.lab_myValue.text=r?r.value:i.getValue(),this.lab_myRank.text=e;var s=n?this._rankVoList:this._rankVoList.slice(3);if(n){if(s.length<6)for(o=s.length;o<6;o++)s.push({king:o})}else if(s.length<3)for(o=s.length;o<3;o++)s.push({king:o+3});if(this.lab_empty.visible=0==s.length,this.lab_empty.y=n?589:889,this.list_rankList.array=s,n)this.uiScene.onExit(),Laya.timer.clearAll(this);else{this.uiScene.onShow(),this.drawTopRank(this._rankVoList[0],this._rankVoList[1],this._rankVoList[2]);var u=t.godInfo||{},h=u[1]&&3<=u[1].length?l.GodUtils.getShowGodModel(u[1][0],u[1][2]):0;Laya.timer.once(400,this,this.showmodel1,[h]),h=u[2]&&3<=u[2].length?l.GodUtils.getShowGodModel(u[2][0],u[2][2]):0,Laya.timer.once(350,this,this.showmodel2,[h]),h=u[3]&&3<=u[3].length?l.GodUtils.getShowGodModel(u[3][0],u[3][2]):0,Laya.timer.once(300,this,this.showmodel3,[h])}},i.prototype.drawTopRank=function(t,e,i){var n=this,o=l.RankModel.getInstance().arrRankListName.find(function(t){return t[2]==n._model.curRankType}),a=LanMgr.getLan(o[3],-1);t&&(this.lbFirstName.text=t.name,this.lbFisrtDesc.text=a+"："+t.value),this.lbFirstName.visible=this.lbFisrtDesc.visible=!!t,this.lbFirstEmpty.visible=this.imgFirstEmpty.visible=!t,this.updateBtn(),e&&(this.lbSecondName.text=e.name,this.lbSecondDesc.text=a+"："+e.value),this.lbSecondName.visible=this.lbSecondDesc.visible=!!e,this.lbSecondEmpty.visible=this.imgSecondEmpty.visible=!e,i&&(this.lbThirdName.text=i.name,this.lbThirdDesc.text=a+"："+i.value),this.lbThirdName.visible=this.lbThirdDesc.visible=!!i,this.lbThirdEmpty.visible=this.imgThirdEmpty.visible=!i},i.prototype.updateBtn=function(){this._model.curRankType==RankListType.Guild&&this.list_rankList.refresh()},i.prototype.setSelectTabNum=function(t){this._selectTabNum=t,this.bgPanel.dataSource={uiName:UIConst.RankView,closeOnSide:this.isModelClose,title:l.RankModel.getInstance().arrRankListName[t][3]+LanMgr.getLan("",12186)}},i.prototype.onTabSelect=function(t){dispatchEvt(new l.RankingListEvent(l.RankingListEvent.SHOW_RANKINGLIST_PANEL),~~l.RankModel.getInstance().arrRankListName[t][2])},i.prototype.onTabRender=function(t,e){t.btn_tab.selected=e==this._selectTabNum},i.prototype.wordShip=function(){dispatchEvt(new l.RankingListEvent(l.RankingListEvent.RANKINGLIST_IS_WORKSHIP))},i.prototype.onShowInfo=function(t){var e=this._rankVoList?this._rankVoList[t]:null;e&&this._model.curRankType!=RankListType.Guild&&e instanceof l.ServerRankListVo&&UIUtil.showPlayerLineupInfo(e.playerId)},i.prototype.showmodel1=function(t){if(this._uiChar1&&(this._uiChar1.removeSelf(),this._uiChar1=null),0!=t){var e=this.imgFirstTY,i=e.localToGlobal(new Laya.Point(0,0));this._uiChar1=this.uiScene.addModelChar(String(t),i.x+e.width*e.scaleX/2-Launch.offsetX,i.y+40-Launch.offsetY,180,1.8)}},i.prototype.showmodel2=function(t){if(this._uiChar2&&(this._uiChar2.removeSelf(),this._uiChar2=null),0!=t){var e=this.imgSecondTY,i=e.localToGlobal(new Laya.Point(0,0));this._uiChar2=this.uiScene.addModelChar(String(t),i.x+e.width*e.scaleX/2-Launch.offsetX,i.y-20-Launch.offsetY,180,1.7),this._uiChar2.y=-40}},i.prototype.showmodel3=function(t){if(this._uiChar3&&(this._uiChar3.removeSelf(),this._uiChar3=null),0!=t){var e=this.imgThirdTY,i=e.localToGlobal(new Laya.Point(0,0));this._uiChar3=this.uiScene.addModelChar(String(t),i.x+e.width*e.scaleX/2-Launch.offsetX,i.y-20-Launch.offsetY,180,1.7),this._uiChar3.y=-40}},i);function i(){var t=e.call(this)||this;return t._selectTabNum=0,t.isModelClose=!0,t._model=l.RankModel.getInstance(),t.uiScene=new Base2dSceneLayerExt,t.boxRole.addChild(t.uiScene),t.boxFirst.on(Laya.Event.CLICK,t,t.onShowInfo,[0]),t.boxSecond.on(Laya.Event.CLICK,t,t.onShowInfo,[1]),t.boxThird.on(Laya.Event.CLICK,t,t.onShowInfo,[2]),t}l.RankModuleView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"RankProcessor"},i.prototype.listenModuleEvents=function(){return[new a.RankingListEvent(a.RankingListEvent.SHOW_RANKINGLIST_PANEL),new a.RankingListEvent(a.RankingListEvent.RANKINGLIST_IS_WORKSHIP),new a.RankingListEvent(a.RankingListEvent.RED_EVENT_RANKLIST),new a.RankingListEvent(a.RankingListEvent.REQUEST_RANK_DATA)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof a.RankingListEvent)switch(t.type){case a.RankingListEvent.SHOW_RANKINGLIST_PANEL:this.onProtocolRankingList(t.data);break;case a.RankingListEvent.RANKINGLIST_IS_WORKSHIP:this.onProtocolWorkShip(t.data);break;case a.RankingListEvent.REQUEST_RANK_DATA:this.requestRankData(t.data)}},i.prototype.onProtocolRankingList=function(i){var n=this,o=this._model;if(o.curRankType=i,UIMgr.hasStage(UIConst.RankView)&&o.rankingList.hasOwnProperty(i))this.rankingListView.initView(o.rankingList[i]);else if(i==RankListType.Guild)PLC.request(Protocol.guild_guild_levelRankList,null,function(t,e){t&&(App.hero.guildLv=t.rankValue,o.setRankData(i,t),UIMgr.hasStage(UIConst.RankView)?n.rankingListView.initView(o.rankingList[i]):UIMgr.showUI(UIConst.RankView,o.rankingList[i]))});else{var t={};t[Protocol.game_rank_getRankList.args.rankType]=i,PLC.request(Protocol.game_rank_getRankList,t,function(t){t&&(o.setRankData(i,t),UIMgr.hasStage(UIConst.RankView)?n.rankingListView.initView(o.rankingList[i]):UIMgr.showUI(UIConst.RankView,o.rankingList[i]))})}},i.prototype.requestRankData=function(i){var n=this._model;if(i==RankListType.Guild)PLC.request(Protocol.guild_guild_levelRankList,null,function(t,e){t&&(App.hero.guildLv=t.rankValue,n.setRankData(i,t))});else{var t={};t[Protocol.game_rank_getRankList.args.rankType]=i,PLC.request(Protocol.game_rank_getRankList,t,function(t){t&&n.setRankData(i,t)})}},i.prototype.onProtocolWorkShip=function(t){var n=this,o=this._model,e={};e[Protocol.game_rank_worship.args.rankType]=t||o.curRankType,PLC.request(Protocol.game_rank_worship,e,function(t){if(t){var e=a.RankModel.getInstance().arrRankListName,i=e.findIndex(function(t){return t[2]==o.curRankType});Math.min(e.length-1,i+1),dispatchEvt(new a.RankingListEvent(a.RankingListEvent.RED_EVENT_RANKLIST)),UIUtil.showRewardView(t.commonData),n.rankingListView&&n.rankingListView.updateBtn()}})},Object.defineProperty(i.prototype,"rankingListView",{get:function(){return UIMgr.getUIByName(UIConst.RankView)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=a.RankModel.getInstance(),t}a.RankProcessor=t}(game=game||{});var RankListType;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"RankModule"},n.prototype.listProcessors=function(){return[new t.RankProcessor]},n);function n(){return e.call(this)||this}t.RankModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_RANKINGLIST_PANEL="SHOW_RANKINGLIST_PANEL",r.RANKINGLIST_IS_WORKSHIP="RANKINGLIST_IS_WORKSHIP",r.RED_EVENT_RANKLIST="RED_EVENT_RANKLIST",r.RANK_DATA_CHANGE="RANK_DATA_CHANGE",r.REQUEST_RANK_DATA="REQUEST_RANK_DATA",r.RANK_MOBAI_CHANGE="RANK_MOBAI_CHANGE",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.RankingListEvent=a}(game=game||{}),function(t){t[t.Power=1]="Power",t[t.Level=2]="Level",t[t.Arena=3]="Arena",t[t.Guild=4]="Guild",t[t.Zuozhan=5]="Zuozhan",t[t.Copy=6]="Copy",t[t.Tower=7]="Tower"}(RankListType=RankListType||{}),function(i){var e=(t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.getValueName=function(){var e=this;return LanMgr.getLan(this.arrRankListName.find(function(t){return t[2]==e.curRankType})[4],-1)+"："},t.prototype.getValue=function(){return this.getvalueBytype(this.curRankType)},t.prototype.getvalueBytype=function(t){switch(t){case RankListType.Level:return App.hero.level.toString();case RankListType.Power:return App.hero.maxHistoryForce.toString();case RankListType.Copy:return i.GuajiModel.getInstance().getSelfRankDesc();case RankListType.Tower:return i.TowerModel.getInstance().getSelfRankDesc();case RankListType.Guild:return 0!=App.hero.guildLv?App.hero.guildLv.toString():LanMgr.getLan("",12084)}},t.prototype.canRedPoint=function(t){return!(t==RankListType.Guild&&App.hero.guildNum<=0||App.hero.worshipInfo[t])},t.prototype.getAllRankData=function(){return this.rankingList},t.prototype.getRankData=function(t){return this.rankingList[t]},t.prototype.setRankData=function(t,e){this.rankingList[t]=e,dispatchEvt(new i.RankingListEvent(i.RankingListEvent.RANK_DATA_CHANGE),t)},t);function t(){this.rankingList={},this.arrRankListName=[[LanMgr.getLan("",12081),"shenli",RankListType.Power,LanMgr.getLan("",12081),LanMgr.getLan("",12178),"shenli.png"],[LanMgr.getLan("",12179),"dengji",RankListType.Level,LanMgr.getLan("",12179),LanMgr.getLan("",12180),"dengji.png"],[LanMgr.getLan("",12181),"lilian",RankListType.Copy,LanMgr.getLan("",12181),LanMgr.getLan("",12182),"guanka.png"],[LanMgr.getLan("",12183),"shilianta",RankListType.Tower,LanMgr.getLan("",12181),LanMgr.getLan("",12182),"shilian.png"],[LanMgr.getLan("",12184),"gonghui",RankListType.Guild,LanMgr.getLan("",12179),LanMgr.getLan("",12185),"gonghui.png"]]}i.RankModel=e;function n(t){this.king=null,this.head=t[3],this.name=t[2],this.value=t[1],this.level=t[4],this.playerId=t[0],this.guildName=t[5],this.headFrame=t[6],e.getInstance().curRankType==RankListType.Tower?this.value=i.TowerModel.getInstance().getCopyRankDesc(this.value):e.getInstance().curRankType==RankListType.Copy&&(this.value=i.GuajiModel.getInstance().getCopyRankDesc(this.value))}i.ServerRankListVo=n;function o(t){this.king=null,this.sex=t.sex,this.name=t.name,this.level=t.level,this.value=t.score,this.playerId=t.playerId,this.guildName=t.guildName}i.JingjiRankListVo=o;function a(t){this.king=null,this.value=t.level,this.head=t.head?t.head:1,this.guildName=t.name,this.name=t.playerName,this.level=t.level,this.playerId=t.playerId}i.GuildRankListVo=a}(game=game||{});var Module=tl3d.Module,ModuleList=function(){function e(){}return e.getModuleList=function(){return e.allModules?e.allModules:e.allModules=[new game.GuajiModule,new game.FirstGuideModule,new game.FightsModule,new game.ResModule,new game.ZhaohuanModule,new game.HudModule,new game.GodModule,new game.TaskModule,new game.MailModule,new game.ChatModule,new game.TujianModule,new game.FriendModule,new game.BagModule,new game.TowerModule,new game.GuildModule,new game.HuodongModule,new game.ChongzhiModule,new game.EquipModule,new game.TimelimitModule,new game.BossModule,new game.RankModule,new game.DailyCopyModule,new game.YuanzhengModule,new game.SevendaysModule,new game.FenjieModule,new game.GodDoorModule,new game.ArtifactModule,new game.EscortModule,new game.FogForestModule,new game.IslandModule,new game.ShareModule,new game.OpenserverModule,new game.OnlineModule,new game.PowerrankModule,new game.LimiteBuyModule,new game.ShopModule,new game.GloryModule,new game.ArenaModule,new game.GodDomainModule,new game.DownloadModule,new game.DafuwengModule,new game.UpRoadModule,new game.CopyTeamModule]},e.startup=function(){App.hero.setData(App.hero.initData);e.getModuleList();UIMgr.getInstance().showLoading(LanMgr.getLan("",10542)),e.mtotal=e.allModules.length,Laya.timer.frameLoop(1,e,e.startModule)},e.startModule=function(){var t=e.allModules.length;0<t?(UIMgr.getInstance().loadingProcess(1-t/e.mtotal),Module.registerModule(e.allModules.shift())):(Laya.timer.clear(e,e.startModule),game.registerRedPoint(),0!=Number(App.hero.isNewPlayer)?dispatchEvt(new game.LoginLoadEvent(game.LoginLoadEvent.ENTERHUD_EVENT)):dispatchEvt(new game.LoginLoadEvent(game.LoginLoadEvent.LOADJUQING_EVENT),!0))},e.mtotal=0,e}();!function(a){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.updateNewMail=function(t){this.hasNewMail=t,dispatchEvt(new a.MailEvent(a.MailEvent.UPDATE_MAIL_DATA))},e.prototype.updateNewPoint=function(t){this.hasNewPointMail=t,dispatchEvt(new a.MailEvent(a.MailEvent.UPDATE_FRIEND_POINT_DATA))},e.prototype.setMailList=function(t){this._list=[];for(var e=0,i=t;e<i.length;e++){var n=i[e];this._list.push(new a.MailData(n))}this._list.sort(function(t,e){return e.svo.endtime-t.svo.endtime}),this.loginMailRp=!1,this.hasNewMail=!1,this._initedMail=!0,dispatchEvt(new a.MailEvent(a.MailEvent.UPDATE_MAIL_DATA))},e.prototype.needRequestMail=function(){return!this._initedMail||this.hasNewMail},e.prototype.getMailList=function(){return this._list},e.prototype.updateMailState=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e],o=this.getMailByID(n[0]);o&&(o.svo.state=n[1])}dispatchEvt(new a.MailEvent(a.MailEvent.UPDATE_MAIL_DATA))},e.prototype.delMail=function(t){var e=this.getMailByID(t);if(e){var i=this._list.indexOf(e);this._list.splice(i,1)}},e.prototype.delMails=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];this.delMail(n)}dispatchEvt(new a.MailEvent(a.MailEvent.UPDATE_MAIL_DATA))},e.prototype.getMailByID=function(e){return this._list.find(function(t){return t.svo.mailId==e})},e.prototype.getCanDelMailCnt=function(){return this._list.filter(function(t){return t.isReward()||t.isRead()&&!t.isHaveGift()}).length},e.prototype.getCanGetMailCnt=function(){return this._list.filter(function(t){return t.isHaveGift()&&!t.isReward()}).length},e.prototype.isShowMailRedpoint=function(){return this.loginMailRp||this.hasNewMail||this._list.some(function(t){return t.isUnread()||t.isCanReward()})},e.prototype.getPointList=function(){return this._pointList},e.prototype.needRequestPointMail=function(){return!this._initedPoint||this.hasNewPointMail},e.prototype.sePointList=function(t){this._pointList=[];for(var e=0,i=t;e<i.length;e++){var n=i[e];this._pointList.push(new a.PointData(n))}this._pointList.sort(function(t,e){return e.svo.endTime-t.svo.endTime}),this.loginPointRp=!1,this.hasNewPointMail=!1,this._initedPoint=!0,dispatchEvt(new a.MailEvent(a.MailEvent.UPDATE_FRIEND_POINT_DATA))},e.prototype.delPointMail=function(t){var e=this.getPointMailByID(t);if(e){var i=this._pointList.indexOf(e);this._pointList.splice(i,1)}},e.prototype.delPointMails=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];this.delPointMail(n)}dispatchEvt(new a.MailEvent(a.MailEvent.UPDATE_FRIEND_POINT_DATA))},e.prototype.getPointMailByID=function(e){return this._pointList.find(function(t){return t.svo.pointId==e})},e.prototype.canOperateFriendPoint=function(){return this.loginPointRp||this.hasNewPointMail||0<this._pointList.length},e.formatAryToStr=function(t){for(var e=[],i=0,n=t.length;i<n;i++){var o=t[i][0],a=t[i][1];switch(o){case iface.tb_prop.mailArgsTypeKey.none:e.push(a);break;case iface.tb_prop.mailArgsTypeKey.item:var r=tb.TB_item.get_TB_itemById(a);e.push(r.name);break;case iface.tb_prop.mailArgsTypeKey.honourBet:var s=tb.TB_honour.getItemById(a);e.push(s.name);break;case iface.tb_prop.mailArgsTypeKey.honourAward:var u=tb.TB_honour_reward.getItemById(a);e.push(u.desc)}}return e},e);function e(){this.loginMailRp=!1,this.loginPointRp=!1,this.hasNewMail=!1,this.hasNewPointMail=!1,this._list=[],this._initedMail=!1,this._pointList=[],this._initedPoint=!1}a.MailModel=t}(game=game||{}),function(e){var t=(i.prototype.getTime=function(){var t=this.svo.endtime-App.serverTimeSecond;return Math.ceil(t/86400)+LanMgr.getLan("",12088)},i.prototype.isUnread=function(){return this.svo.state==iface.tb_prop.mailStateTypeKey.unread},i.prototype.isRead=function(){return this.svo.state==iface.tb_prop.mailStateTypeKey.read},i.prototype.isReward=function(){return this.svo.state==iface.tb_prop.mailStateTypeKey.get},i.prototype.isHaveGift=function(){return 0<this.itemList.length},i.prototype.isCanReward=function(){return this.isHaveGift()&&!this.isReward()},i.prototype.isExpired=function(){return App.serverTimeSecond>=this.svo.endtime},i.prototype.getContent=function(){if(!this.svo.content)return this.tbMail.mail_content;var t=JSON.parse(this.svo.content);return FormatStr(this.tbMail.mail_content,e.MailModel.formatAryToStr(t))},i.prototype.getTitle=function(){if(!this.svo.title)return this.tbMail.mail_name;var t=JSON.parse(this.svo.title);return FormatStr(this.tbMail.mail_name,e.MailModel.formatAryToStr(t))},i);function i(t){this.itemList=[],this.svo=t,this.tbMail=tb.TB_mail.getItemById(t.type);for(var e=0,i=t.item;e<i.length;e++){var n=i[e];this.itemList.push(new ItemVo(n[0],n[1]))}}e.MailData=t;var n=(o.prototype.getTime=function(){var t=this.svo.endTime-App.serverTimeSecond;return Math.ceil(t/86400)+LanMgr.getLan("",10025)},o);function o(t){this.svo=t}e.PointData=n}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.mail.MailViewUI,__extends(e,n),e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.mailList.array=null,this.btnGetAll.off(Laya.Event.CLICK,this,this.onGetAll),this.btnDelAll.off(Laya.Event.CLICK,this,this.onDelAll)},e.prototype.initView=function(){this.resetView(),this.btnGetAll.on(Laya.Event.CLICK,this,this.onGetAll),this.btnDelAll.on(Laya.Event.CLICK,this,this.onDelAll)},e.prototype.resetView=function(){var t=i.MailModel.getInstance().getMailList();this.mailList.array=t,this.box_empty.visible=0==t.length,this.lab_mail_num.text=LanMgr.getLan("",-12190,t.length)},e.prototype.refreshView=function(){this.mailList.refresh(),this.box_empty.visible=0==this.mailList.array.length,this.lab_mail_num.text=LanMgr.getLan("",12190,this.mailList.array.length)},e.prototype.onClickHandler=function(t,e){t.type==Laya.Event.CLICK&&dispatchEvt(new i.MailEvent(i.MailEvent.SHOW_MAIL_READ_PANEL,[this.mailList.getItem(e),this.mailList.getCell(e)]))},e.prototype.onGetAll=function(){dispatchEvt(new i.MailEvent(i.MailEvent.GET_ALL_MAIL))},e.prototype.onDelAll=function(){dispatchEvt(new i.MailEvent(i.MailEvent.DEL_All_MAIL))},e);function e(){var t=n.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12191)},t.mailList.mouseHandler=new Handler(t,t.onClickHandler),t}i.MailView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.mail.MailReadUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btnOperate.off(Laya.Event.CLICK,this,this.onConfirm)},n.prototype.initView=function(){var t=this.dataSource;this.lab_title.text=t.getTitle(),this.lbContent.text="      "+t.getContent(),this.lbTime.text=t.getTime(),t.isHaveGift()?(this.boxItem.visible=!0,this.list.array=t.itemList,this.btnOperate.label=t.isReward()?LanMgr.getLan("",10196):LanMgr.getLan("",10041)):(this.boxItem.visible=!1,this.list.array=null,this.btnOperate.label=LanMgr.getLan("",10196)),this.btnOperate.on(Laya.Event.CLICK,this,this.onConfirm)},n.prototype.onConfirm=function(){var t=this.dataSource;t&&(t.isCanReward()?dispatchEvt(new e.MailEvent(e.MailEvent.MAIL_REWARD,this.dataSource)):dispatchEvt(new e.MailEvent(e.MailEvent.DEL_MAIL,this.dataSource)))},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}e.MailReadView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.mail.MailIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;t?(this.lbTitle.text=t.getTitle(),this.imgBox.visible=t.isHaveGift(),this.imgBox.skin=SkinUtil.getTaskBaoxiang(4,t.isReward()),this.lbTime.text=t.getTime(),this.imgIcon.skin=SkinUtil.getMailStateUrl(t.isUnread()?1:2),this.imgIcon.gray=t.isRead()||t.isReward()):(this.lbTitle.text="",this.lbTime.text="")},n);function n(){return e.call(this)||this}t.MailIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"MailProcessor"},i.prototype.listenModuleEvents=function(){return[new o.MailEvent(o.MailEvent.SHOW_MAIL_PANEL),new o.MailEvent(o.MailEvent.MAIL_REWARD),new o.MailEvent(o.MailEvent.SHOW_MAIL_READ_PANEL),new o.MailEvent(o.MailEvent.GET_ALL_MAIL),new o.MailEvent(o.MailEvent.DEL_All_MAIL),new o.MailEvent(o.MailEvent.DEL_MAIL)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof o.MailEvent)switch(t.type){case o.MailEvent.SHOW_MAIL_PANEL:this.showMailPanel(t.data);break;case o.MailEvent.MAIL_REWARD:this.mailReward(t.data);break;case o.MailEvent.SHOW_MAIL_READ_PANEL:this.showMailReadView(t.data);break;case o.MailEvent.GET_ALL_MAIL:this.getAllMail();break;case o.MailEvent.DEL_All_MAIL:this.delMails(null);break;case o.MailEvent.DEL_MAIL:this.delMails(t.data)}},i.prototype.showMailPanel=function(e){void 0===e&&(e=0);var i=this._model;i.needRequestMail()?PLC.request(Protocol.game_mail_mailList,{},function(t){t&&t.mailList&&i.setMailList(t.mailList),UIMgr.showUI(UIConst.MailView,e||0)}):UIMgr.showUI(UIConst.MailView,e||0)},i.prototype.showMailReadView=function(t){var e=t[0],i=t[1];if(e.isUnread()){var n={};n[Protocol.game_mail_mailUpdateState.args.id]=e.svo.mailId,PLC.request(Protocol.game_mail_mailUpdateState,n,function(t){t&&t.updateMail&&o.MailModel.getInstance().updateMailState(t.updateMail),i.refreshView(),UIMgr.showUI(UIConst.MailReadView,e)})}else UIMgr.showUI(UIConst.MailReadView,e)},i.prototype.mailReward=function(e){var i=this;if(e.isExpired())showToast(LanMgr.getLan("",1e4));else{var t={};t[Protocol.game_mail_mailGet.args.id]=e.svo.mailId,PLC.request(Protocol.game_mail_mailGet,t,function(t){t&&(t.updateMail&&i._model.updateMailState(t.updateMail),t.commonData&&UIUtil.showRewardView(t.commonData),i.delMails(e))})}},i.prototype.delMails=function(t){var e=this._model,i=null;if(t)i=t.svo.mailId;else if(e.getCanDelMailCnt()<=0)return void showToast(LanMgr.getLan("",10001));var n={};n[Protocol.game_mail_mailDelete.args.id]=i||0,PLC.request(Protocol.game_mail_mailDelete,n,function(t){t&&(t.delMail&&e.delMails(t.delMail),UIMgr.hasStage(UIConst.MailView)&&UIMgr.getUIByName(UIConst.MailView).resetView(),UIMgr.hideUIByName(UIConst.MailReadView))})},i.prototype.getAllMail=function(){var e=this._model;if(e.getCanGetMailCnt()<=0)showToast(LanMgr.getLan("",10002));else{var t={};t[Protocol.game_mail_mailGet.args.id]=0,PLC.request(Protocol.game_mail_mailGet,t,function(t){t&&t.updateMail&&e.updateMailState(t.updateMail),t&&t.commonData&&UIUtil.showRewardView(t.commonData),UIMgr.hasStage(UIConst.MailView)&&UIMgr.getUIByName(UIConst.MailView).refreshView()})}},i);function i(){var t=e.call(this)||this;return t._model=o.MailModel.getInstance(),t}o.MailProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"MailModule"},n.prototype.listProcessors=function(){return[new t.MailProcessor]},n.prototype.onRegister=function(){t.MailModel.getInstance()},n);function n(){return e.call(this)||this}t.MailModule=i;var o,a,r=(o=tl3d.BaseEvent,__extends(s,o),s.SHOW_MAIL_PANEL="SHOW_MAIL_PANEL",s.SHOW_MAIL_READ_PANEL="SHOW_MAIL_READ_PANEL",s.MAIL_REWARD="MAIL_REWARD",s.GET_ALL_MAIL="GET_ALL_MAIL",s.DEL_All_MAIL="DEL_All_MAIL",s.DEL_MAIL="DEL_MAIL",s.UPDATE_MAIL_DATA="UPDATE_MAIL_DATA",s.UPDATE_FRIEND_POINT_DATA="UPDATE_FRIEND_POINT_DATA",s);function s(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.MailEvent=r,(a=t.MailTabType||(t.MailTabType={}))[a.mail=0]="mail",a[a.friendPoint=1]="friendPoint"}(game=game||{}),(game||(game={})).ServerAreaInfo=function(){this.servers=[]};__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.login.UserNoticeUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._htmlText=this.createHtml(this.panel_content.width-40,this.panel_content.height-40),this._htmlText.x=20,this._htmlText.y=20,this.panel_content.addChild(this._htmlText),this.panel_content.vScrollBarSkin=""},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onOpened=function(){i.prototype.onOpened.call(this)},n.prototype.initView=function(){this._type=this.dataSource?this.dataSource:0,this._content="",this.btn_sure.on(Laya.Event.CLICK,this,this.onClickSure),this.loadText(),this.updateTitle(),this.updateView()},n.prototype.updateTitle=function(){var t=LanMgr.getLan("",12194);switch(this._type){case n.TYPE_YINSI:t=LanMgr.getLan("",12195);break;case n.TYPE_XIEYI:t=LanMgr.getLan("",12196)}this.bgPanel.updateTitle(t)},n.prototype.loadText=function(){var t="";switch(this._type){case n.TYPE_YINSI:t="yinsi.txt";break;case n.TYPE_XIEYI:t="xieyi.txt"}if(""!=t){var e=this;tl3d.LoadManager.getInstance().load("usernotice/"+t,tl3d.LoadManager.XML_TYPE,function(t){e.onLoadTextComplete(t)})}},n.prototype.onLoadTextComplete=function(t){this._content=t,this.updateView()},n.prototype.updateView=function(){this._htmlText.innerHTML=this._content,this._htmlText.event(Laya.Event.RESIZE),this._htmlText._height=this._htmlText.contextHeight},n.prototype.onClickSure=function(){this.close()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btn_sure.off(Laya.Event.CLICK,this,this.onClickSure),this._htmlText.innerHTML="",this._htmlText.event(Laya.Event.RESIZE),this.panel_content.vScrollBar.value=0},n.prototype.createHtml=function(t,e,i,n){void 0===i&&(i=20),void 0===n&&(n="#7e5336");var o=new Laya.HTMLDivElement;return o.style.align="left",o.style.fontSize=i,o.style.color=n,o.style.leading=5,o.style.wordWrap=!0,o.width=t,o},n.TYPE_YINSI=0,n.TYPE_XIEYI=1,n);function n(){var t=i.call(this)||this;return t._content="",t.isModelClose=!0,t}t.UserNoticeView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.login.SelectServerUI,__extends(n,i),Object.defineProperty(n.prototype,"curServer",{get:function(){return this._curServer},set:function(t){this._curServer=t},enumerable:!0,configurable:!0}),n.prototype.onOpened=function(){i.prototype.onOpened.call(this),this._time=Math.floor(Date.now()/1e3),this.box_entergame.visible=!0,this.box_selectserver.visible=!1,BaseSceneMgr.getInstance().showEffect(this,1,1000010,188,-268,5.8,0),this.list_group.dataSource=e.LoginModel.getInstance().areas,this.list_group.selectedIndex=0,this.curServer=this.dataSource,this.initCurrect(),this.btn_exit.visible=!0,this.img_bg.skin=SkinUtil.getSysMapSkin(ModuleConst.login),ExtConfig.RELEASE&&Number(window.platform.pid)!=iface.tb_prop.platformTypeKey.lezhong&&(this.btn_exit.visible=!1),UIMgr.getInstance().hideLoading();var t=Laya.LocalStorage.getItem("UserNotice");this.chk_un.selected=!t||"0"==t,this.lab_xieyi.on(Laya.Event.CLICK,this,this.onClickUserNotice,[e.UserNoticeView.TYPE_XIEYI]),this.lab_yinsi.on(Laya.Event.CLICK,this,this.onClickUserNotice,[e.UserNoticeView.TYPE_YINSI])},n.prototype.getChatNotice=function(){dispatchEvt(new e.LoginEvent(e.LoginEvent.SHOW_CHATNOTICE_PANEL))},n.prototype.onStartGameEvent=function(){var t=this;this.chk_un.selected?this.curServer?this.curServer.status!=REALMFLAG.REALM_FLAG_CLOSE?this.curServer.open_time>App.getServerTime()?showToast(LanMgr.getLan("",10446,getTimeShortStr(this.curServer.open_time))):this.touchtime&&(this.touchtime=!1,Laya.timer.once(1e3,this,function(){t.touchtime=!0}),dispatchEvt(new e.LoginEvent(e.LoginEvent.SEND_LOGIN_EVENT),this.curServer)):showToast(LanMgr.getLan("",10445)):showToast(LanMgr.getLan("",10444)):showToast(LanMgr.getLan("",10443))},n.prototype.onExitEvent=function(){BingoSDK.loginout(),this.clearLoacal(),UIMgr.showUI(UIConst.LoginView,null,!1),this.close()},n.prototype.onSelectListEvent=function(){this.box_selectserver.visible=!0,this.box_entergame.visible=!1},n.prototype.onSSelect=function(n){AudioMgr.playSound(),this.curServer=this.list_serverlist.selectedItem,this.list_serverlist.cells.forEach(function(t,e,i){t.selected=e==n}),this.initCurrect()},n.prototype.onGSelect=function(n){AudioMgr.playSound(),this.curArea=this.list_group.selectedItem,this.list_serverlist.array=this.curArea.servers,this.list_serverlist.selectedIndex=0,this.list_group.cells.forEach(function(t,e,i){t.selected=e==n})},n.prototype.onSelectOkEvent=function(){this.onSelectCanelEvent(),this.list_serverlist.selectedItem&&(this.curServer=this.list_serverlist.selectedItem),this.initCurrect()},n.prototype.onSelectCanelEvent=function(){this.box_selectserver.visible=!1,this.box_entergame.visible=!0},n.prototype.clearLoacal=function(){Laya.LocalStorage.setItem("puid",""),Laya.LocalStorage.setItem("pid",""),Laya.LocalStorage.setItem("uname","")},n.prototype.onGRender=function(t,e){t.label=t.dataSource.areaName},n.prototype.onSRender=function(t,e){var i=t.dataSource,n=t.getChildByName("state");t.label=i.srv_name,n.skin=SkinUtil.getServerState(i),t.getChildByName("img_new").visible=this._time-Number(i.open_time)<=3*TimeConst.ONE_DAY_SEC},n.prototype.initCurrect=function(){this.curServer&&(this.lbl_cname.text=this.curServer.srv_name,this.img_cstate.skin=SkinUtil.getServerState(this.curServer),this.img_curnew.visible=this._time-Number(this.curServer.open_time)<=3*TimeConst.ONE_DAY_SEC)},n.prototype.onClickUserNotice=function(t){UIMgr.showUI(UIConst.UserNoticeView,t)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),BaseSceneMgr.getInstance().removeEffect(1000010),Laya.loader.clearTextureRes(this.img_bg.skin);var t=this.chk_un.selected?"0":"1";Laya.LocalStorage.setItem("UserNotice",t),this.lab_xieyi.off(Laya.Event.CLICK,this,this.onClickUserNotice),this.lab_yinsi.off(Laya.Event.CLICK,this,this.onClickUserNotice)},n);function n(){var t=i.call(this)||this;return t.touchtime=!0,t.group=UIConst.hud_group,t.btn_entergame.on(Laya.Event.CLICK,t,t.onStartGameEvent),t.btn_exit.on(Laya.Event.CLICK,t,t.onExitEvent),t.btnNotice.on(Laya.Event.CLICK,t,t.getChatNotice),t.btn_selectlist.on(Laya.Event.CLICK,t,t.onSelectListEvent),t.btn_ok.on(Laya.Event.CLICK,t,t.onSelectOkEvent),t.btn_cancel.on(Laya.Event.CLICK,t,t.onSelectCanelEvent),t.list_serverlist.renderHandler=new Handler(t,t.onSRender),t.list_group.renderHandler=new Handler(t,t.onGRender),t.list_serverlist.selectHandler=new Handler(t,t.onSSelect),t.list_group.selectHandler=new Handler(t,t.onGSelect),t.list_group.selectEnable=!0,t.list_serverlist.selectEnable=!0,t}e.SelectServerView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.login.LoginUI,__extends(n,e),n.prototype.onOpened=function(){e.prototype.onOpened.call(this),BaseSceneMgr.getInstance().showEffect(this,1,1000010,188,-268,5.8,0)},n.prototype.onLoginEvent=function(){AudioMgr.playSound();var t=this.ed_account.text;t&&0!=t.length?this.sendSSO(t):showToast(LanMgr.getLan("",10442))},n.prototype.onTouristsLoginEvent=function(){AudioMgr.playSound(),this.sendSSO(randomWord(!1,8,8))},n.prototype.sendSSO=function(t){AudioMgr.playSound();var e=window.platform;e.gameId="1",e.uid=t,e.userName=t,e.time=(new Date).getTime()/1e3,e.head="",e.sex=0,e.fromUid="",e.fcm=0,e.pid="1",e.shiming=1,e.vconsle=0,dispatchEvt(new i.LoginEvent(i.LoginEvent.SEND_SSO_EVENT))},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),BaseSceneMgr.getInstance().removeEffect(1000010),this.btn_login.off(Laya.Event.CLICK,this,this.onLoginEvent),this.btn_touristslogin.off(Laya.Event.CLICK,this,this.onTouristsLoginEvent)},n);function n(){var t=e.call(this)||this;return t.btn_login.on(Laya.Event.CLICK,t,t.onLoginEvent),t.btn_touristslogin.on(Laya.Event.CLICK,t,t.onTouristsLoginEvent),t.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.login),t.width=Laya.stage.width,t.height=Laya.stage.height,t}i.LoginView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.login.CreateRoleUI,__extends(i,e),i.prototype.onOpened=function(){e.prototype.onOpened.call(this),DialogExt.manager.mouseEnabled||(DialogExt.manager.mouseEnabled=!0)},i.prototype.onClick=function(){var e=this,t=checkUserName(this.edit_name.text);if(3!=t.state)if(12<t.strlen)showToast(LanMgr.getLan("",10068));else if(t.strlen<1)showToast(LanMgr.getLan("",10012));else{var i={};i[Protocol.game_common_changePlayerData.args.name]=this.edit_name.text,i[Protocol.game_common_changePlayerData.args.sex]=0,PLC.request(Protocol.game_common_changePlayerData,i,function(t){t&&(App.hero.name=t.name,App.hero.sex=t.sex,App.hero.isNewPlayer=1,App.hero.updateSelfHead(),BingoSDK.gameReport("enterGame",App.hero.uid,App.hero.name,"HOODINN",window.platform.serverInfo.serverId,{level:App.hero.level,vipLevel:App.hero.vip,score:0,isNew:1,shareRole:0}),dispatchEvt(new n.HudEvent(n.HudEvent.SET_NAME)),e.close())})}else showToast(LanMgr.getLan("",10069))},i.prototype.onRandom=function(t){AudioMgr.playSound(),this.edit_name.text=tb.TB_random_name.getRandomName(Math.random()<.5?0:1)},i.prototype.onClosed=function(){e.prototype.onClosed.call(this),n.GuideManager.startInit()},i);function i(){var t=e.call(this)||this;return t.popupCenter=!0,t.btn_ok.on(Laya.Event.CLICK,t,t.onClick),t.btn_random.on(Laya.Event.CLICK,t,t.onRandom),t.edit_name.text=tb.TB_random_name.getRandomName(Math.random()<.5?0:1),t}n.CreateRoleView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"LoginProcessor"},i.prototype.listenModuleEvents=function(){return[new a.LoginEvent(a.LoginEvent.LOGININIT_EVENT),new a.LoginEvent(a.LoginEvent.SEND_SERVERLIST_EVENT),new a.LoginEvent(a.LoginEvent.SEND_SSO_EVENT),new a.LoginEvent(a.LoginEvent.SEND_LOGIN_EVENT),new a.LoginEvent(a.LoginEvent.SEND_RELOGIN_EVENT),new a.LoginEvent(a.LoginEvent.SHOW_CHATNOTICE_PANEL)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof a.LoginEvent)switch(t.type){case a.LoginEvent.LOGININIT_EVENT:this.initLogin();break;case a.LoginEvent.SEND_SERVERLIST_EVENT:this.reloginState=!1,this.sendRealmList();break;case a.LoginEvent.SEND_RELOGIN_EVENT:this.reLogin();break;case a.LoginEvent.SEND_SSO_EVENT:this.sendSSO();break;case a.LoginEvent.SEND_LOGIN_EVENT:this.sendLogin(t.data);break;case a.LoginEvent.SHOW_CHATNOTICE_PANEL:this.showChatNoticePanel(!0)}},i.prototype.initLogin=function(){var t=(new Date).getTime(),e=BingoSDK.platparam,i=window.platform;e?(i.gameId=e.gameId||1,i.uid=e.uid||"",i.userName=e.userName||"",i.time=e.time||0,i.head=e.head||"",i.sex=e.sex||0,i.fromUid=e.fromUid,i.fcm=0,i.pid=e.pid||1,i.shiming=e.shiming||0,i.vconsle=e.vconsle,logNeed("外部登陆参数",e)):(BingoSDK.platparam={clientVersion:"1",pid:"1",uid:1,uname:1,time:Math.floor(t/1e3)},logNeed("没有外部参数",e)),BingoSDK.platparam.hero=App.hero;var n=tb.Tb_version.get_TB_version_ById(1);PLC.JS_WS_CLIENT_VERSION=n?n.version:"1",ExtConfig.RELEASE||(i.userName||(i.userName=Laya.LocalStorage.getItem("uname")),i.uid||(i.uid=Laya.LocalStorage.getItem("puid"))),i.pid&&i.uid&&i.userName?(logyhj("开始登录"),UIMgr.getInstance().showWaiting(LanMgr.getLan("",10533)),dispatchEvt(new a.LoginEvent(a.LoginEvent.SEND_SSO_EVENT))):ExtConfig.RELEASE?common.AlertBox.showAlert({text:LanMgr.getLan("",10532)}):(UIMgr.showUI(UIConst.LoginView,null,!1),UIMgr.getInstance().hideLoading())},i.prototype.showChatNoticePanel=function(h){var t,e=window.platform.pid,i=Math.floor((new Date).getTime()/1e3);t="data=";var n="pf_id="+e;n+="&channel_id="+(BingoSDK.channelId||0),t+=encodeURIComponent(n),t+="&time="+i,t+="&sign="+hex_md5(n+i+ExtConfig.noticeKey),ExtConfig.notice_host&&PLC.getInstance().sendServermsg(this,ExtConfig.notice_host,t,"post",function(t){if(t){var e=JSON.parse(t[0]),i=e&&e.data&&e.data.bulletin_list?e.data.bulletin_list:{},n=Laya.LocalStorage.getItem(App.LOGIN_NOTICE_VERSION),o=e&&e.data?e.data.version:"-1";if(Laya.LocalStorage.setItem(App.LOGIN_NOTICE_VERSION,o),n&&n==o||Laya.LocalStorage.removeItem(App.LOGIN_NOTICE_CHECKBOX),logdebug("是否有新公告：",n,o),0<Object.keys(i).length){var a=[];for(var r in i){var s=i[r];a.push(s)}a[0].isfirst=!0,window.platform.noticelist=a;var u="1"==Laya.LocalStorage.getItem(App.LOGIN_NOTICE_CHECKBOX);!h&&u||UIMgr.showUI(UIConst.LoginNoticeView,a)}}})},i.prototype.sendLogin=function(t){var o=this;window.platform.serverInfo=t,window.platform.serverInfo.serverId=window.platform.serverInfo.srv_id%1e5,this.reloginState||UIMgr.getInstance().showLoading(LanMgr.getLan("",10541)),logNeed("reportErrorUrl:",ExtConfig.reportErrorUrl),UIMgr.hideUIByName(UIConst.SelectListView),logNeed("登陆游戏服",window.platform.token,App.hero.uid,window.platform.pid),ExtConfig.isLocal&&Laya.LocalStorage.setItem(App.hero.uid+"selectLineId",t.srv_id);var e=t.address?t.address:"https://"+t.domain+"/server"+("0"!==t.merge_id?t.merge_id:t.srv_id)+"/gateway";PLC.getInstance().authEntry(window.platform.token,App.hero.uid,{host:e},function(){logNeed("=============connect ok!"),PLC.getInstance().enterGame(function(t){if(o.setGameFunc(),App.hero.initData)return App.hero.setData(App.hero.initData),void(o.reloginState=!1);App.hero.guildNum=t.guildNum,App.hero.initData=t.curPlayer,App.hero.openSvrTime=t.openSvrTime||0,App.hero.signInStartTime=t.signInStartTime||0;var e=t.curPlayer.friend;App.hero.blockLists=e&&e.blackLists||[],App.hero.honourStage=t.honourStage||0,App.hero.kuafuHonourStage=t.kuafuHonourStage||0,App.hero.rechargePlayerNum=t.rechargePlayerNum?Number(t.rechargePlayerNum):0,App.hero.guildHelpNum=t.guildHelpNum||0,ModuleList.startup();var i=App.hero,n=window.platform.serverInfo;BingoSDK.gameReport("enterGame",i.playerId,i.accountName,n.serverId,n.srv_name,{level:i.level,vip:i.vip,charge:i.welfare.rechargeSum})})})},i.prototype.reLogin=function(){this.reloginState||(this.reloginState=!0,UIMgr.getInstance().showWaiting(LanMgr.getLan("",10549)),this.sendSSO())},i.prototype.sendSSO=function(){var i=this,t=window.platform;for(var e in this.userinfo)t.hasOwnProperty(e)&&(this.userinfo[e]=t[e]);var n=iface.tb_prop.platformTypeKey,o=Number(window.platform.pid),a=o==n.version||o==n.lezhong?PLC.SSO_LEZHONG:PLC.SSO;this.userinfo.robot=window.platform.redirect,this.userinfo.userToken=encodeURIComponent(BingoSDK.getUserToken()),this.userinfo.sign=this.getSign(),App.hero.accountName=this.userinfo.userName,App.hero.puid=this.userinfo.uid,Laya.LocalStorage.setItem("uname",this.userinfo.userName),Laya.LocalStorage.setItem("puid",this.userinfo.uid),logNeed("sso帐号验证",this.userinfo),PLC.getInstance().sendloginmsg(this,a,this.userinfo,"get",function(t){var e=JSON.parse(t[0]);logNeed("======帐号验证成功!======",e),200==e.code&&(App.hero.uid=e.uid,window.platform.token=e.token,e.pid&&Laya.LocalStorage.setItem("pid",e.pid),e.uid?i.sendRealmList():showToast(e.msg?e.msg:"serverlist error"),i.showChatNoticePanel(!1))})},i.prototype.sendRealmList=function(){var t,o=this,e=window.platform.pid;if(ExtConfig.isLocal)t={uid:App.hero.uid,platformId:e};else{var i=Math.floor((new Date).getTime()/1e3);t="data=";var n="pf_id="+e;n+="&user_name="+this.userinfo.userName,n+="&recent_login_srv=1",t+=encodeURIComponent(n),t+="&time="+i,t+="&sign="+hex_md5(n+i+ExtConfig.getplKey)}logNeed("请求服务器列表",App.hero.uid,e,window.platform.token),PLC.getInstance().sendServermsg(this,ExtConfig.server_host,t,"post",function(t){AudioMgr.playMusic("sound/bgm_login.mp3"),UIMgr.getInstance().hideWaiting();var e=JSON.parse(t[0]);if(logNeed("======请求服务器列表成功======",e),e&&1==e.status){var i=e.data;if(!i)return;if(!i.hasOwnProperty("srv_list"))return logerror(e.msg?e.msg:"get serverList error"),BingoSDK.reportError(e.msg?e.msg:"get serverList error"),void common.AlertBox.showAlertYes({text:LanMgr.getLan("",10534),confirmCb:function(){BingoSDK.gameRefresh()}});if(0==i.srv_list.length)return void common.AlertBox.showAlertYes({text:LanMgr.getLan("",10535),confirmCb:function(){}});window.platform.serverGroupList=i.group_list,window.platform.serverList=i.srv_list,window.platform.serverRecentList=i.hasOwnProperty("recent_login_srv")?isArrayFn(i.recent_login_srv)?{}:i.recent_login_srv:{},a.LoginModel.getInstance().initAreas();var n=a.LoginModel.getInstance().curServer;if(o.reloginState)return void dispatchEvt(new a.LoginEvent(a.LoginEvent.SEND_LOGIN_EVENT),n);UIMgr.showUI(UIConst.SelectListView,n,!1),UIMgr.getInstance().hideWaiting(),UIMgr.getInstance().clearUICache()}})},i.prototype.setGameFunc=function(){BingoSDK.setGameFunc("alert",function(t,e,i){common.AlertBox.showAlertYes({title:t&&0<t.length?t:LanMgr.getLan("",10536),text:e,confirmCb:function(){i&&i()}})}),BingoSDK.setGameFunc("confirm",function(t,e,i,n){common.AlertBox.showAlert({title:t&&0<t.length?t:LanMgr.getLan("",10536),text:e,confirmCb:function(){i&&i()},cancelCb:function(){n&&n()}})}),BingoSDK.setGameFunc("prompt",function(t,e,i,n){common.AlertBox.showAlertPrompt({title:t&&0<t.length?t:LanMgr.getLan("",10359),text:e,confirmCb:function(t){logyhj("输入的信息是：",t),i&&i(t)},cancelCb:function(){n&&n()}})})},i.prototype.getSign=function(){return BingoSDK.getSign(null)||hex_md5("gameId="+this.userinfo.gameId+"&time="+this.userinfo.time+"&uid="+encodeURIComponent(this.userinfo.uid)+"&userName="+encodeURIComponent(this.userinfo.userName)+"&key="+BingoSDK.loginKey)},i);function i(){var t=e.call(this)||this;return t.userinfo={userName:"",uid:"",sex:0,head:"",pid:1,gameId:1,robot:1,fcm:0,shiming:0,time:0,sign:"",userToken:""},t}a.LoginProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=tl3d.Module,__extends(i,t),i.prototype.getModuleName=function(){return"LoginModule"},i.prototype.listProcessors=function(){return[new o.LoginProcessor,new o.LoginLoadProcessor]},i.prototype.onRegister=function(){var t=Laya.LocalStorage.getItem("GameVolume");t&&0!=t.length||(t="45",Laya.LocalStorage.setItem("GameVolume",t));var e=Number(t)/100;SoundManager.setMusicVolume(e);var i=Laya.LocalStorage.getItem("GameSound");i&&0!=i.length||(i="80",Laya.LocalStorage.setItem("GameSound",i));var n=Number(i)/100;SoundManager.setSoundVolume(n),Laya.timer.frameOnce(1,this,function(){layapan.LayaScene2dInit.initData(),Laya.stage.setScreenSize(Browser.clientWidth*Browser.pixelRatio,Browser.clientHeight*Browser.pixelRatio)}),Laya.timer.frameOnce(2,this,function(){dispatchEvt(new o.LoginLoadEvent(o.LoginLoadEvent.LOADBASE_EVENT))})},i);function i(){return t.call(this)||this}o.LoginModule=e;var n,a=(n=tl3d.BaseEvent,__extends(r,n),r.LOGININIT_EVENT="LOGININIT_EVENT",r.SEND_SSO_EVENT="SEND_SSO_EVENT",r.SEND_LOGIN_EVENT="SEND_LOGIN_EVENT",r.SEND_RELOGIN_EVENT="SEND_RELOGIN_EVENT",r.SEND_SERVERLIST_EVENT="SEND_SERVERLIST_EVENT",r.SHOW_CHATNOTICE_PANEL="SHOW_CHATNOTICE_PANEL",r);function r(){return null!==n&&n.apply(this,arguments)||this}o.LoginEvent=a;var s,u=(s=tl3d.BaseEvent,__extends(h,s),h.LOADBASE_EVENT="LOADBASE_EVENT",h.LOADHUD_EVENT="LOADHUD_EVENT",h.LOADJUQING_EVENT="LOADJUQING_EVENT",h.ENTERHUD_EVENT="ENTERHUD_EVENT",h);function h(){return null!==s&&s.apply(this,arguments)||this}o.LoginLoadEvent=u}(game=game||{}),function(n){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.initAreas=function(){if(!this._isInit){this._isInit=!0;var t=window.platform.serverList||{},e=window.platform.serverRecentList,i=convertMapValueToArr(e=e||{});if(i&&0<i.length){i.sort(function(t,e){return e.login_time-t.login_time});for(var n=[],o=0;o<i.length;o++){var a=i[o];t.hasOwnProperty(a.srv_id)&&n.push(t[a.srv_id])}this.addServerInfo(LanMgr.getLan("",12192),n),this.lastServer=n[0]}var r={};for(var s in t)if((_=t[s]).hasOwnProperty("srv_type")){var u=_.srv_type;r.hasOwnProperty(u)||(r[u]={}),r[u][s]=_}var h=window.platform.serverGroupList||[];for(var s in isArrayFn(h)||(h=[h]),r){var l=convertMapValueToArr(r[s]),c=h.find(function(t){return String(t.srv_type)==String(s)}),p=this.createServerInfo(l,c?c.type_name:LanMgr.getLan("",12193));(!this.newServer||Number(this.newServer.open_time)<Number(p.open_time))&&(this.newServer=p)}if(ExtConfig.isLocal){var d=Laya.LocalStorage.getItem(App.hero.uid+"selectLineId");for(var s in t){var _;if((_=t[s]).srv_id==d){this.lastServer=_;break}}}}},e.prototype.createServerInfo=function(t,e){return t&&0<t.length&&t.sort(function(t,e){return e.open_time-t.open_time}),this.addServerInfo(e,t),t[0]},Object.defineProperty(e.prototype,"curServer",{get:function(){return this.lastServer||this.newServer},enumerable:!0,configurable:!0}),e.prototype.addServerInfo=function(t,e){var i=this._grops[t];i||(i=new n.ServerAreaInfo,this._grops[t]=i,this.areas.push(i)),i.areaName=t,e instanceof Array?i.servers=i.servers.concat(e):i.servers.push(e)},e);function e(){this._isInit=!1,this.areas=new Array,this._grops={}}n.LoginModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=tl3d.Processor,__extends(n,i),n.prototype.getName=function(){return"LoginLoadProcessor"},n.prototype.listenModuleEvents=function(){return[new e.LoginLoadEvent(e.LoginLoadEvent.LOADBASE_EVENT),new e.LoginLoadEvent(e.LoginLoadEvent.LOADJUQING_EVENT),new e.LoginLoadEvent(e.LoginLoadEvent.LOADHUD_EVENT),new e.LoginLoadEvent(e.LoginLoadEvent.ENTERHUD_EVENT)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.LoginLoadEvent)switch(t.type){case e.LoginLoadEvent.LOADBASE_EVENT:this.preloadBase();break;case e.LoginLoadEvent.LOADJUQING_EVENT:this._uiMgr.showLoading(LanMgr.getLan("",10539)),this.preloadJuqing(),UIMgr.hideUIByName(UIConst.SelectListView);break;case e.LoginLoadEvent.LOADHUD_EVENT:if(this._hudloading||this._hudloaded)return;t.data||this._uiMgr.showLoading(LanMgr.getLan("",10540)),this._hudloading=!0,this.preloadHud();break;case e.LoginLoadEvent.ENTERHUD_EVENT:this.enterHud(t.data)}},n.prototype.preloadBase=function(){this._uiMgr.loadingProcess((this._total0-this._preloads0.length)/this._total0*.4+.6),0<this._preloads0.length?Laya.loader.load(this._preloads0.pop(),Handler.create(this,this.preloadBase)):dispatchEvt(new e.LoginEvent(e.LoginEvent.LOGININIT_EVENT))},n.prototype.preloadJuqing=function(t){var e=this;void 0===t&&(t=!1),Laya.loader.load(this._preloads1,Handler.create(null,function(t){!1!==t?(e._uiMgr.hideLoading(),UIMgr.showUI(UIConst.FirstGuide,null,!1)):Laya.timer.once(1e3,e,e.preloadJuqing)}),Handler.create(null,function(t){e._uiMgr.loadingProcess(t)}))},n.prototype.preloadHud=function(){this._uiMgr.loadingProcess((this._total2-this._preloads2.length)/this._total2),0<this._preloads2.length?Laya.loader.load(this._preloads2.pop(),Handler.create(this,this.preloadHud)):(this._hudloaded=!0,this._enter&&this.showHud())},n.prototype.enterHud=function(t){t&&(this._state=t),this._enter=!0,this._hudloaded?this.showHud():dispatchEvt(new e.LoginLoadEvent(e.LoginLoadEvent.LOADHUD_EVENT))},n.prototype.showHud=function(){this._uiMgr.hideLoading(),dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.MAIN]),-1==this._state?e.GuideManager.startInit():dispatchEvt(new e.FirstGuideEvent(e.FirstGuideEvent.GUIDE_START),this._state),3<=App.hero.level&&Laya.timer.once(1e3,this,function(){if(App.isOpenSvrDay(2)){var t="AppUpdate_Notice_"+e.GameNoticeView.noticeVersion+"_"+App.hero.playerId;Laya.LocalStorage.getItem(t)?e.HuodongModel.getInstance().autoOpenLoginGift():(UIMgr.showUI(UIConst.GameNoticeView,{openFlag:!0}),Laya.LocalStorage.setItem(t,e.GameNoticeView.noticeVersion))}else e.HuodongModel.getInstance().autoOpenLoginGift()})},n);function n(){var t=i.call(this)||this;return t._total0=7,t._preloads0=["comp/bg.atlas","comp/button.atlas","comp/image.atlas","comp/progressbar.atlas","comp/shuzi.atlas","effects/ring.atlas"],t._preloads1=["kaichang/kaichang1.jpg","kaichang/kaichang2.jpg","kaichang/kaichang3.jpg"],t._total2=2,t._preloads2=["hud.atlas"],t._state=-1,t._hudScene="scene022",t._uiMgr=UIMgr.getInstance(),t}e.LoginLoadProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var r,e=(__extends(o,r=BaseFightVo),o.prototype.setSimpleInfo=function(t){if(this.svo&&t){for(var e in t)this.svo[e]=t[e];this.svo.playerId&&!t.playerId&&this.clearDetailInfo()}else this.svo=t;this.tbOre=t?tb.TB_island_level.getItemById(t.mineType):null},o.prototype.clearDetailInfo=function(){this.svo.playerId=null,this.svo.playerName=null,this.svo.force=0,this.svo.lineupInfo=[[],[]],this.svo.occupyTime=0,this.svo.profitInfo=[],this.svo.robCount=0,this.svo.startTime=0,this.svo.level=0,this.svo.head=0},o.prototype.setDetailInfo=function(t){for(var e in t)this.svo[e]=t[e];r.prototype.setLineupInfo.call(this,this.svo.lineupInfo),this._specialAward=[];for(var i=this.tbOre.reward,n=0,o=t.profitInfo;n<o.length;n++){var a=o[n];a[0]==Number(i[0])?this._award=[a[0],a[1]]:this._specialAward.push(new ItemVo(a[0],a[1]))}this._award||(this._award=[Number(i[0]),0])},o.prototype.getHeadVo=function(){return this.hasUser()?new UserHeadVo(this.svo.head,this.svo.level,this.svo.headFrame):null},o.prototype.getSpecialAward=function(){return this._specialAward},o.prototype.getAward=function(){return this._award},o.prototype.getRobAward=function(){var t=this._award;return[t[0],Math.floor(Number(t[1])*this.tbOre.plunder_loss/100)]},o.prototype.isExist=function(){return!(!this.svo||!this.svo.mineIndex)},o.prototype.hasUser=function(){return!(!this.svo||!this.svo.playerId)},o.prototype.isSelf=function(){return this.svo&&this.svo.playerId==App.hero.playerId},o.prototype.isOutTime=function(){return this.getAllOccupyTime()>=this.tbOre.max_time},o.prototype.getAllOccupyTime=function(){var t=0;return 0<this.svo.startTime&&(t=App.serverTimeSecond-this.svo.startTime),t+this.svo.occupyTime},o.prototype.getFightDesc=function(){return this.isOccupyFight?LanMgr.getLan("",12198):""},o.copy=function(t){var e=new o(t.pos,t.tbIsland),i={mineIndex:t.svo.mineIndex,mineId:t.svo.mineId,mineType:t.svo.mineType};e.setSimpleInfo(i);var n=JSON.parse(JSON.stringify(t.svo));return e.setDetailInfo(n),e},o);function o(t,e){var i=r.call(this)||this;return i.tbIsland=e,i.pos=t,i}t.OreSpotInfoVo=e}(game=game||{}),function(n){var t=(e.requestSelfInfo=function(){var i=this;return new Promise(function(e){i._requestSelf?e():PLC.request(Protocol.center_mine_getMyMineInfo,null,function(t){n.IslandModel.getInstance().myOreInfo=t&&t.myInfo?t.myInfo:null,i._requestSelf=!0,e()})})},e.setRequestFlag=function(t){this._requestSelf=t},e.resetInterval=function(){if(App.IsSysOpen(ModuleConst.Island)){var t=App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.mineRobNum),e=tb.TB_island_set.getSet().plunder_max;Laya.timer.clear(this,this.updateCount),t<e&&(Laya.timer.loop(1e3,this,this.updateCount),this.updateCount())}},e.updateCount=function(){var t=App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.mineRobNum),e=tb.TB_island_set.getSet().plunder_max,i=tb.TB_island_set.getSet().reply_time,n=App.serverTimeSecond-App.hero.mineRobReplyTime;if(e<=t)Laya.timer.clear(this,this.updateCount);else if(i<=n){var o=Math.floor(n/i),a=Math.min(t+o,e);App.hero.setOverplusValue(iface.tb_prop.overplusTypeKey.mineRobNum,a),App.hero.mineRobReplyTime=App.hero.mineRobReplyTime+n*o}},e.loopRequestRobbed=function(){this.stopRobLoop(),Laya.timer.loop(1e4,this,this.requestRobbed),this.requestRobbed(!1,!0)},e.stopRobLoop=function(){Laya.timer.clear(this,this.requestRobbed)},e.requestRobbed=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),UIMgr.hasStage(UIConst.OreSettlementView)||(e||n.IslandModel.getInstance().hasNewRecord)&&PLC.request(Protocol.game_mine_mineRobList,null,function(t){if(t){var e=t.grabList?t.grabList:[];if(0<e.length){var i=n.IslandQueueMgr.getInstance();i.pushRecords(e,!1),i.showNoticeView()}}},!1)},e.loopRequestIsland=function(t){this._curIslandId=t,Laya.timer.clear(this,this.requestAll),Laya.timer.loop(1e4,this,this.requestAll),this.requestRobbed(!1,!0);var e=n.IslandModel.getInstance().getNextRefreshTime();0<e&&Laya.timer.once(1e3*e,this,this.requestOreList)},e.stopIslandLoop=function(){this._curIslandId=0,this.stopRobLoop(),Laya.timer.clear(this,this.requestAll),Laya.timer.clear(this,this.requestOreList)},e.requestAll=function(){0!=this._curIslandId&&UIMgr.hasStage(UIConst.OreMapView)?(this.requestOreList(),this.requestRobbed(!1,!1)):this.stopIslandLoop()},e.requestOreList=function(){var i=this;if(0!=this._curIslandId&&(UIMgr.hasStage(UIConst.OreMapView)||UIMgr.hasStage(UIConst.IslandView))){var t={};t[Protocol.center_mine_getMineList.args.islandId]=this._curIslandId,PLC.request(Protocol.center_mine_getMineList,t,function(t){if(t){var e=n.IslandModel.getInstance().getIslandById(i._curIslandId);e&&(e.setServerVo(t.mineList),dispatchEvt(new n.IslandsEvent(n.IslandsEvent.UPDATE_ORE_LIST,i._curIslandId)))}},!1)}},e._requestSelf=!1,e);function e(){}n.IslandUtil=t}(game=game||{}),function(t){var e=(i.prototype.getTitle=function(){return this.svo.recordType==iface.tb_prop.mineRecordTypeKey.finish?LanMgr.getLan("",12199):LanMgr.getLan("",12200)},i.prototype.getContent=function(){return this.svo.recordType==iface.tb_prop.mineRecordTypeKey.finish?""+this.getTimePrev()+LanMgr.getLan("",12205,this.tbOre.name)+(this.isGoto?LanMgr.getLan("",12206):""):this.svo.recordType==iface.tb_prop.mineRecordTypeKey.occupyFail?this.isHasItemList()?""+this.getTimePrev()+LanMgr.getLan("",12207,this.tbOre.name,this.svo.name)+LanMgr.getLan("",12208)+(this.isGoto?LanMgr.getLan("",12206):""):""+this.getTimePrev()+LanMgr.getLan("",12207,this.tbOre.name,this.svo.name):this.svo.recordType==iface.tb_prop.mineRecordTypeKey.occupySuccess?""+this.getTimePrev()+LanMgr.getLan("",12203,this.svo.name):this.svo.recordType==iface.tb_prop.mineRecordTypeKey.robSuccess?""+this.getTimePrev()+LanMgr.getLan("",12204,this.svo.name):this.isHasItemList()?""+this.getTimePrev()+LanMgr.getLan("",12201,this.svo.name):""+this.getTimePrev()+LanMgr.getLan("",12202,this.svo.name)},i.prototype.getTimePrev=function(){var t=App.serverTimeSecond-this.svo.recordTime;return t<3600?Math.ceil(t/60)+LanMgr.getLan("",12097)+",":t<86800?Math.ceil(t/3600)+LanMgr.getLan("",12098)+",":Math.ceil(t/86800)+LanMgr.getLan("",12099)+","},i.prototype.getLossList=function(){if(this.svo.recordType==iface.tb_prop.mineRecordTypeKey.robSuccess)return[];if(!this._itemList){this._itemList=[];for(var t=0,e=this.svo.rewardInfo;t<e.length;t++){var i=e[t];this._itemList.push(new ItemVo(i[0],i[1]))}}return this._itemList},i.prototype.isHasItemList=function(){return 0<this.getLossList().length},i.prototype.isHasReward=function(){return this.isHasItemList()&&(this.svo.recordType==iface.tb_prop.mineRecordTypeKey.occupyFail||this.svo.recordType==iface.tb_prop.mineRecordTypeKey.finish)},i);function i(t){this.svo=t,this.tbOre=tb.TB_island_level.getItemById(t.mineType)}t.IslandRecordVo=e}(game=game||{}),function(s){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.requestRobbed=function(i,t){var n=this;void 0===t&&(t=!1),UIMgr.hasStage(UIConst.FightViews)||UIMgr.hasStage(UIConst.OreSettlementView)||(t||s.IslandModel.getInstance().hasNewRecord)&&PLC.request(Protocol.game_mine_mineRobList,null,function(t){if(t){var e=t.grabList?t.grabList:[];0<e.length&&(n.pushRecords(e,i),n.showNoticeView())}},!1)},e.prototype.showNoticeView=function(){if(UIMgr.hasStage(UIConst.FightViews)||0==this._recordList.length)this.clearRecords();else{var t=this._recordList.shift();t&&t.recordVo&&UIMgr.showUI(UIConst.OreSettlementView,t)}},e.prototype.pushRecords=function(t,e){for(var i=0,n=t;i<n.length;i++){var o=n[i];if(!this.isExistRcord(o.recordId)){var a=new s.IslandRecordVo(o);a.isGoto=e;var r={title:a.getTitle(),content:a.getContent(),itemArray:a.getLossList(),recordVo:a};this._recordList.push(r)}}this._recordList.sort(function(t,e){return e.recordVo.svo.recordTime-t.recordVo.svo.recordTime})},e.prototype.clearRecords=function(){this._recordList.length=0},e.prototype.getRecordVo=function(e){return this._recordList.find(function(t){return t.recordVo.svo.recordId==e})},e.prototype.isExistRcord=function(t){return!!this.getRecordVo(t)},e.prototype.isHasRcord=function(){return 0<this._recordList.length},e);function e(){this._recordList=[]}s.IslandQueueMgr=t}(game=game||{}),function(i){var t=(e.prototype.setServerVo=function(n){function t(t){var e=o.oreList[t],i=n.find(function(t){return t.mineId==e.pos});e.setSimpleInfo(i)}for(var o=this,e=0;e<this.oreList.length;e++)t(e)},e.prototype.getOreByPos=function(e){return this.oreList.find(function(t){return t.pos==e})},e.prototype.getOreByUuid=function(e){return this.oreList.find(function(t){return t.isExist()&&t.svo.mineIndex==e})},e);function e(t){this.scrollX=0,this.tbIsland=t,this.oreList=[];for(var e=1;e<=36;e++)this.oreList.push(new i.OreSpotInfoVo(e,this.tbIsland))}i.IslandInfoVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.island.SelfOreUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.lbGain.autoSize=!0,this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12210)}},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.itemList.array=null,this.btnExplain.off(Laya.Event.CLICK,this,this.onExplain)},n.prototype.initView=function(){var t=this.dataSource;this.bgPanel.updateTitle(t.tbOre.name);var e=Number(t.getAward()[1]);e<=0?(this.imgGain.visible=!1,this.lbGain.text=LanMgr.getLan("",10193,LanMgr.getLan("",12209))):(this.imgGain.visible=!0,this.lbGain.text=LanMgr.getLan("",10193,e),this.imgGain.skin=SkinUtil.getCostSkin(t.getAward()[0]),this.imgGain.x=this.lbGain.x+this.lbGain.width+5);var i=t.getSpecialAward();i&&0<i.length?(this.itemList.array=i,this.itemList.visible=!0,this.lab_empty.visible=!1):(this.itemList.visible=!1,this.lab_empty.visible=!0);var n=t.getAllOccupyTime();this.pgRes.value=(t.tbOre.max_time-n)/t.tbOre.max_time,this.lbPercent.text=Math.floor((t.tbOre.max_time-n)/t.tbOre.max_time*100)+"%";var o=Math.ceil((t.tbOre.max_time-n)/60);this.lbTime.text=LanMgr.getLan("",10192,o),this.btnExplain.on(Laya.Event.CLICK,this,this.onExplain)},n.prototype.onExplain=function(){var t=this.dataSource;dispatchEvt(new e.IslandsEvent(e.IslandsEvent.OPEN_ORE_EXPLAIN,t.tbOre))},n);function n(){return i.call(this)||this}e.SelfOreView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.island.PlayerOreUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.lbGain.autoSize=!0,this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12210)}},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btnExplain.off(Laya.Event.CLICK,this,this.onExplain),this.btnOccupy.off(Laya.Event.CLICK,this,this.onOccupy),this.btnRob.off(Laya.Event.CLICK,this,this.onRob)},n.prototype.initView=function(){var t=this.dataSource;this.bgPanel.updateTitle(t.tbOre.name),this.headBox.dataSource=t.getHeadVo(),this.lbName.text=t.svo.playerName,this.lbGuild.text=LanMgr.getLan("",12083)+(t.svo.guildName?t.svo.guildName:LanMgr.getLan("",12084));var e=t.getRobAward();this.lbGain.text=t.svo.robCount>=tb.TB_island_set.getSet().plunder_max_num?0:e[1].toString(),this.imgGain.skin=SkinUtil.getCostSkin(e[0]),this.imgGain.x=this.lbGain.x+this.lbGain.width+5,this.itemList.array=t.tbOre.getLossList();var i=t.getAllOccupyTime();this.pgRes.value=(t.tbOre.max_time-i)/t.tbOre.max_time,this.lbResPerc.text=Math.floor((t.tbOre.max_time-i)/t.tbOre.max_time*100)+"%",this.btnExplain.on(Laya.Event.CLICK,this,this.onExplain),this.btnOccupy.on(Laya.Event.CLICK,this,this.onOccupy),this.btnRob.on(Laya.Event.CLICK,this,this.onRob),this.lineupUI.dataSource={lineupGods:t.getLineupGods(),shenqiAry:t.getShenqiAry(),showShenli:!0,force:t.svo.force,userLevel:t.svo.level,title:""}},n.prototype.onExplain=function(){var t=this.dataSource;dispatchEvt(new e.IslandsEvent(e.IslandsEvent.OPEN_ORE_EXPLAIN,t.tbOre))},n.prototype.onOccupy=function(){dispatchEvt(new e.IslandsEvent(e.IslandsEvent.OCCUPY_ORE,this.dataSource))},n.prototype.onRob=function(){dispatchEvt(new e.IslandsEvent(e.IslandsEvent.ROB_ORE,this.dataSource))},n);function n(){return i.call(this)||this}e.PlayerOreView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var r,t=(r=ui.island.OreSettlementUI,__extends(e,r),e.prototype.createChildren=function(){r.prototype.createChildren.call(this),this.lbContent.autoSize=!0,this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12004)}},e.prototype.show=function(t,e){r.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){r.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(){this.onConfirm(!1)},e.prototype.onClosed=function(){r.prototype.onClosed.call(this),this.itemList.array=null,this.bgPanel.dataSource=null,this.btnConfirm.off(Laya.Event.CLICK,this,this.onConfirm)},e.prototype.initView=function(){var t=this.dataSource;if(t){var e=t.recordVo&&t.recordVo.isGoto?LanMgr.getLan("",12003):t.title?t.title:LanMgr.getLan("",12004);this.bgPanel.updateTitle(e),this.lbContent.text=t.content,this.btnConfirm.label=t.recordVo?t.recordVo.isGoto?LanMgr.getLan("",10042):t.recordVo.isHasReward()?LanMgr.getLan("",10041):LanMgr.getLan("",10038):LanMgr.getLan("",10038),this.itemList.array=t.itemArray,this.itemList.y=this.lbContent.y+this.lbContent.height+25,0<t.itemArray.length?(this.listBg.visible=!0,this.listBg.y=this.itemList.y-10,this.btnConfirm.y=this.itemList.y+this.itemList.height+30):(this.listBg.visible=!1,this.btnConfirm.y=this.itemList.y+30),this.btnConfirm.on(Laya.Event.CLICK,this,this.onConfirm,[!0]),this.bgPanel.height=this.height=this.btnConfirm.y+this.btnConfirm.height+50}},e.prototype.onConfirm=function(t){var e=this,i=this.dataSource;if(i.recordVo)if(i.recordVo.isGoto)if(t)if(this._mgr.clearRecords(),i.recordVo.isHasReward())r.prototype.close.call(this,"",!1),dispatchEvt(new a.IslandsEvent(a.IslandsEvent.SHOW_MAIN_VIEW));else{var n={};n[Protocol.game_mine_recordMineUpdateState.args.id]=i.recordVo.svo.recordId,PLC.request(Protocol.game_mine_recordMineUpdateState,n,function(t){t&&(r.prototype.close.call(e,"",!1),dispatchEvt(new a.IslandsEvent(a.IslandsEvent.SHOW_MAIN_VIEW)))})}else if(i.recordVo.isHasReward()){var o=!this._mgr.isHasRcord();r.prototype.close.call(this,"",o),this._mgr.showNoticeView()}else this.doReadOperate();else i.recordVo.isHasReward()?this.doRewardOpera():this.doReadOperate();else r.prototype.close.call(this)},e.prototype.doRewardOpera=function(){var e=this,t=this.dataSource,i=!this._mgr.isHasRcord(),n={};n[Protocol.game_mine_mineRecordGet.args.id]=t.recordVo.svo.recordId,PLC.request(Protocol.game_mine_mineRecordGet,n,function(t){t&&(UIUtil.showRewardView(t.commonData),r.prototype.close.call(e,"",i),e._mgr.showNoticeView())})},e.prototype.doReadOperate=function(){var e=this,t=this.dataSource,i=!this._mgr.isHasRcord(),n={};n[Protocol.game_mine_recordMineUpdateState.args.id]=t.recordVo.svo.recordId,PLC.request(Protocol.game_mine_recordMineUpdateState,n,function(t){t&&(r.prototype.close.call(e,"",i),e._mgr.showNoticeView())})},e);function e(){var t=r.call(this)||this;return t._mgr=a.IslandQueueMgr.getInstance(),t}a.OreSettlementView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.island.OreMapUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.itemList.cells.forEach(function(t,e){Math.floor(e/6)%2==1&&(t.x+=86)}),this.itemPanel.hScrollBarSkin="",this.itemPanel.hScrollBar.on(Laya.Event.CHANGE,this,this.onPanelScroll)},e.prototype.setSize=function(t,e){i.prototype.setSize.call(this,t,e),this.itemPanel.width=t,this.itemPanel.height=e},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),Laya.timer.clearAll(this),this.itemList.array=null,n.IslandUtil.stopIslandLoop(),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.onPanelScroll=function(){var t=this.dataSource;t&&(t.scrollX=this.itemPanel.hScrollBar.value)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_record,redpointName:"island_record",callback:this.onRecord.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onExit.bind(this)}),this.updateView(),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime();var i=this.dataSource;n.IslandUtil.loopRequestIsland(i.tbIsland.ID),this.callLater(this.scrollTo)},e.prototype.scrollTo=function(){var t=this.dataSource;if(t){var e=t.scrollX;if(0==e){var i=this.getSelfIsLandInfo();if(i){var n=this.itemList.getCell(i.pos-1);n&&(e=this.itemList.x+n.x+n.width/2-360)}else t.scrollX=230,e=t.scrollX}this.itemPanel.scrollTo(e)}},e.prototype.getSelfIsLandInfo=function(){var t=this.dataSource;if(t)for(var e=t.oreList,i=0;i<e.length;i++){var n=e[i];if(n&&n.isSelf())return n}return null},e.prototype.updateView=function(){var t=this.dataSource;this.itemList.array=t.oreList},e.prototype.updateTime=function(){var t=n.IslandModel.getInstance().getNextRefreshTime();this.lbRefreshTime.text=LanMgr.getLan("",10190,GameUtil.toCountdown(t,"hh:mm:ss"))},e.prototype.updateOreData=function(i){var t=this.itemList.cells.find(function(t){var e=t.dataSource;return e&&e.isExist()&&e.svo.mineIndex==i});t&&t.refreshView()},e.prototype.onRule=function(){dispatchEvt(new n.IslandsEvent(n.IslandsEvent.SHOW_RULE_VIEW))},e.prototype.onRecord=function(){dispatchEvt(new n.IslandsEvent(n.IslandsEvent.SHOW_RESCORD_VIEW))},e.prototype.onExit=function(){dispatchEvt(new n.IslandsEvent(n.IslandsEvent.SHOW_MAIN_VIEW))},e);function e(){var t=i.call(this)||this;return t.group=UIConst.hud_group,t}n.OreMapView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.island.OreExplainUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.lbGain.autoSize=!0,this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12210)}},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.itemList.array=null},n.prototype.initView=function(){var t=this.dataSource;this.bgPanel.updateTitle(t.name),this.lbGain.text=LanMgr.getLan("",10191,t.reward[1]),this.lbMinu.text="/"+Math.floor(t.interval/60)+LanMgr.getLan("",12090),this.lbGain.x=this.width/2-(this.lbGain.width+145)/2,this.imgGain.skin=SkinUtil.getCostSkin(t.reward[0]),this.imgGain.x=this.lbGain.x+this.lbGain.width+5,this.lbMinu.x=this.imgGain.x+this.imgGain.width+5,this.itemList.array=t.getRateList()},n);function n(){return i.call(this)||this}t.OreExplainView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var o,t=(o=ui.island.itemrender.OreSpotItemRenderUI,__extends(e,o),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),e.prototype.refreshView=function(){var t=this.dataSource,e=this.ui_flag;if(t){var i=t.isExist();i?(this.lbTbName.text=i?t.tbOre.name:"",this.lbTbName.color=n.IslandModel.ORE_COLORS[t.tbOre.ID],this.icon.skin=SkinUtil.getIslandOreUrl(t.tbOre.ID),this.icon.visible=this.lbTbName.visible=!0,t.hasUser()?(this.ImgForeBg.visible=this.lbName.visible=e.visible=!0,this.lbName.text=t.svo.playerName,t.isSelf()?(this.lbName.color="#008bff",e.img_di_0.skin=e.img_di_1.skin="shenmidaoyu/wofangzuobiaodian.png",e.img_flag.skin="shenmidaoyu/wofang.png",e.ani1.play(0,!0),e.imgGuang.visible=e.imgShifu.visible=!0,e.ani2.play(0,!0)):(this.lbName.color="#ff0000",e.img_di_0.skin=e.img_di_1.skin="shenmidaoyu/difangzuobiaodian.png",e.img_flag.skin="shenmidaoyu/difang.png",e.ani1.gotoAndStop(0),e.imgGuang.visible=e.imgShifu.visible=!1,e.ani2.gotoAndStop(0))):(this.ImgForeBg.visible=this.lbName.visible=e.visible=!1,e.ani1.gotoAndStop(0),e.imgGuang.visible=e.imgShifu.visible=!1,e.ani2.gotoAndStop(0))):(this.lbName.visible=this.lbTbName.visible=e.visible=!1,e.ani1.gotoAndStop(0),e.imgGuang.visible=e.imgShifu.visible=!1,e.ani2.gotoAndStop(0),this.ImgForeBg.visible=this.icon.visible=!1),this.on(Laya.Event.CLICK,this,this.onClick)}else this.off(Laya.Event.CLICK,this,this.onClick),e.ani1.gotoAndStop(0),e.imgGuang.visible=e.imgShifu.visible=!1,e.ani2.gotoAndStop(0)},e.prototype.onClick=function(){this.dataSource.tbOre&&dispatchEvt(new n.IslandsEvent(n.IslandsEvent.OPEN_ORE_INFO,this.dataSource))},e);function e(){var t=o.call(this)||this,e=new Laya.HitArea,i=new Laya.Graphics;return i.drawPoly(0,88,[40,0,110,0,146,58,110,106,40,106,0,58],"#ff9900"),e.hit=i,t.hitArea=e,t}n.OreSpotIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var i,t=(i=ui.island.IslandMainUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._model=a.IslandModel.getInstance(),this.itemPanel.hScrollBarSkin="",this._boxList=[];for(var t=0;t<7;t++){var e=this["item"+t];this._boxList.push(e)}this.imgBg1.skin=SkinUtil.getSysMapSkin(ModuleConst.Island,1),this.imgBg2.skin=SkinUtil.getSysMapSkin(ModuleConst.Island,2),this.imgBg3.skin=SkinUtil.getSysMapSkin(ModuleConst.Island,3),this.imgBg4.skin=SkinUtil.getSysMapSkin(ModuleConst.Island,4)},e.prototype.setSize=function(t,e){i.prototype.setSize.call(this,t,e),this.lbDesc.y=GameUtil.isFullScreen()?137+a.HudModel.TOP_ADD_HEIGHT:137,this.lbRefreshTime.y=GameUtil.isFullScreen()?168+a.HudModel.TOP_ADD_HEIGHT:168},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),Laya.timer.clearAll(this);for(var t=0;t<this._boxList.length;t++)this._boxList[t].on(Laya.Event.CLICK,this,this.onClickIsland),this._boxList[t].dataSource=null;this.imgArrow.x=0,this.imgArrow.visible=!1,a.IslandUtil.stopRobLoop(),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_record,redpointName:"island_record",callback:this.onRecord.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onFanHui.bind(this)});for(var i=0;i<this._boxList.length;i++)this._boxList[i].on(Laya.Event.CLICK,this,this.onClickIsland);var n=this._model,o=n.getList();for(i=0;i<this._boxList.length;i++)this._boxList[i].dataSource=o[i];this.updateView(),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime(),a.IslandUtil.loopRequestRobbed(),n.updateEndTime(!1),this.callLater(this.scrollTo)},e.prototype.scrollTo=function(){var t=this;this.imgArrow.visible?this.itemPanel.scrollTo(this.imgArrow.x-360):this._init||this.timer.frameOnce(5,this,function(){t._init=!0,t.itemPanel&&t.itemPanel.scrollTo(364)})},e.prototype.updateView=function(){var t=this._model,i=t.myOreInfo?t.myOreInfo.islandId:0,e=0<i?this._boxList.find(function(t){var e=t.dataSource;return e&&e.tbIsland.ID==i}):null;this.setIndexImage(e)},e.prototype.setIndexImage=function(t){if(t){var e=t.x+t.width/2;this.imgArrow.x!=e&&(this.imgArrow.x=e,this.imgArrow.y=t.y+t.height/2,this.imgArrow.visible=!0,this.imgArrow.ani1.play(0,!0),this.imgArrow.ani2.play(0,!0))}else this.imgArrow.visible=!1},e.prototype.updateTime=function(){var t=this._model.getNextRefreshTime();this.lbRefreshTime.text=LanMgr.getLan("",10190,GameUtil.toCountdown(t,"hh:mm:ss"))},e.prototype.onClickIsland=function(t){var e=t.target;e&&e.dataSource&&dispatchEvt(new a.IslandsEvent(a.IslandsEvent.SHOW_ORE_MAP,e.dataSource))},e.prototype.onRule=function(){dispatchEvt(new a.IslandsEvent(a.IslandsEvent.SHOW_RULE_VIEW))},e.prototype.onRecord=function(){dispatchEvt(new a.IslandsEvent(a.IslandsEvent.SHOW_RESCORD_VIEW))},e.prototype.onFanHui=function(){dispatchEvt(new a.HudEvent(a.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_JINGJI))},e);function e(){var t=i.call(this)||this;return t.group=UIConst.hud_group,t}a.IslandView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.island.EmptyOreUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.lbGain.autoSize=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12210)},this.btnNext.on(Laya.Event.CLICK,this,this.onScroll,[!0]),this.btnPrev.on(Laya.Event.CLICK,this,this.onScroll,[!1])},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.itemList.array=null,this.btnOccupy.off(Laya.Event.CLICK,this,this.onOccupy)},n.prototype.initView=function(){var t=this.dataSource;this.bgPanel.updateTitle(t.tbOre.name),this.lbGain.text=LanMgr.getLan("",10191,t.tbOre.reward[1]),this.lbMinu.text="/"+Math.floor(t.tbOre.interval/60)+LanMgr.getLan("",12090),this.lbGain.x=this.width/2-(this.lbGain.width+145)/2,this.imgGain.skin=SkinUtil.getCostSkin(t.tbOre.reward[0]),this.imgGain.x=this.lbGain.x+this.lbGain.width+5,this.lbMinu.x=this.imgGain.x+this.imgGain.width+5,this.itemList.array=t.tbOre.getRateList();var e=t.getAllOccupyTime();this.pgRes.value=(t.tbOre.max_time-e)/t.tbOre.max_time,this.lbPercent.text=Math.floor((t.tbOre.max_time-e)/t.tbOre.max_time*100)+"%",this.btnOccupy.on(Laya.Event.CLICK,this,this.onOccupy)},n.prototype.onOccupy=function(){dispatchEvt(new t.IslandsEvent(t.IslandsEvent.OCCUPY_ORE,this.dataSource))},n.prototype.onScroll=function(t){t?this.itemList.scrollBar.value+=300:this.itemList.scrollBar.value-=300},n);function n(){return i.call(this)||this}t.EmptyOreView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"IslandProcessor"},i.prototype.listenModuleEvents=function(){return[new s.IslandsEvent(s.IslandsEvent.SHOW_MAIN_VIEW),new s.IslandsEvent(s.IslandsEvent.SHOW_RULE_VIEW),new s.IslandsEvent(s.IslandsEvent.SHOW_RESCORD_VIEW),new s.IslandsEvent(s.IslandsEvent.SHOW_BUY_VIEW),new s.IslandsEvent(s.IslandsEvent.SHOW_ORE_MAP),new s.IslandsEvent(s.IslandsEvent.OPEN_ORE_INFO),new s.IslandsEvent(s.IslandsEvent.OPEN_ORE_EXPLAIN),new s.IslandsEvent(s.IslandsEvent.OCCUPY_ORE),new s.IslandsEvent(s.IslandsEvent.ROB_ORE),new s.IslandsEvent(s.IslandsEvent.UPDATE_ORE_LIST)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof s.IslandsEvent)switch(t.type){case s.IslandsEvent.SHOW_MAIN_VIEW:this.showMainView();break;case s.IslandsEvent.SHOW_RULE_VIEW:this.showRuleView();break;case s.IslandsEvent.SHOW_RESCORD_VIEW:this.showRecordView();break;case s.IslandsEvent.SHOW_BUY_VIEW:this.showBuyView();break;case s.IslandsEvent.SHOW_ORE_MAP:this.showOreMap(t.data);break;case s.IslandsEvent.OPEN_ORE_INFO:this.openOreInfoView(t.data);break;case s.IslandsEvent.OPEN_ORE_EXPLAIN:this.openOreExplain(t.data);break;case s.IslandsEvent.OCCUPY_ORE:this.occupyOre(t.data);break;case s.IslandsEvent.ROB_ORE:this.robOre(t.data);break;case s.IslandsEvent.UPDATE_ORE_LIST:this.renderOreMap(t.data)}},i.prototype.showMainView=function(){s.IslandUtil.requestSelfInfo().then(function(){UIMgr.showUI(UIConst.IslandView)})},i.prototype.showRuleView=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20012))},i.prototype.showRecordView=function(){var a=this;PLC.request(Protocol.game_mine_mineRecordList,null,function(t){if(t){for(var e=[],i=0,n=t.recordList;i<n.length;i++){var o=n[i];e.push(new s.IslandRecordVo(o))}e.length<=0?showToast(LanMgr.getLan("",10070)):(e.sort(function(t,e){return e.svo.recordTime-t.svo.recordTime}),a._model.updateNewRecord(!1),UIMgr.showUI(UIConst.RobbedRecordView,e))}})},i.prototype.showBuyView=function(){if(App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyMineRobNum)>=tb.TB_island_set.getSet().buy_max)showToast(LanMgr.getLan("",10146));else{var t=this._model.getBuyCost();UIUtil.checkNotEnough(iface.tb_prop.resTypeKey.diamond,t)||UIMgr.showUI(UIConst.BuyBattleCount,{type:common.BuyBattleCountView.TYPE_MINEROB,callback:function(t){var e={};e[Protocol.game_common_buyMineRobCnt.args.count]=t,PLC.request(Protocol.game_common_buyMineRobCnt,e,function(t){if(t){var e=UIMgr.getUIByName(UIConst.SysTopView);e&&e.box_island.visible&&e.updateIslandCount()}})}})}},i.prototype.showOreMap=function(e){if(e){var t={};t[Protocol.center_mine_getMineList.args.islandId]=e.tbIsland.ID,PLC.request(Protocol.center_mine_getMineList,t,function(t){t&&(e.setServerVo(t.mineList),UIMgr.showUI(UIConst.OreMapView,e))})}},i.prototype.openOreInfoView=function(e){var i=this,t={};t[Protocol.center_mine_getTargetMineInfo.args.mineIndex]=e.svo.mineIndex,PLC.request(Protocol.center_mine_getTargetMineInfo,t,function(t){t&&(e.setDetailInfo(t.mineInfo),i.renderOreItem(e.svo.mineIndex),e.isSelf()?UIMgr.showUI(UIConst.SelfOreView,e):e.hasUser()?UIMgr.showUI(UIConst.PlayerOreView,e):UIMgr.showUI(UIConst.EmptyOreView,e))})},i.prototype.renderOreItem=function(t){UIMgr.hasStage(UIConst.OreMapView)&&this.oreMapView.updateOreData(t)},i.prototype.openOreExplain=function(t){UIMgr.showUI(UIConst.OreExplainView,t)},i.prototype.updateOreInfo=function(t){var e=this;common.AlertBox.showAlert({text:LanMgr.getLan("",10530),confirmCb:function(){e.openOreInfoView(t)}})},i.prototype.renderOreMap=function(t){UIMgr.hasStage(UIConst.OreMapView)&&this.oreMapView.updateView(),UIMgr.hasStage(UIConst.IslandView)&&this.islandView.updateView()},i.prototype.robOre=function(n){var o=this;if(App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.mineRobNum)<=0)showToast(LanMgr.getMsgByCode("RobCountNotEnough"));else if(n.isOutTime())showToast(LanMgr.getLan("",10194));else{var t={};t[Protocol.game_mine_mineRobStart.args.mineIndex]=n.svo.mineIndex,t[Protocol.game_mine_mineRobStart.args.playerId]=n.svo.playerId,PLC.request(Protocol.game_mine_mineRobStart,t,function(t,e,i){t?(n.setDetailInfo(t.mineInfo),o.doRobFight(n)):i==Lans.OccupyInfoHasRefresh&&(o.updateOreInfo(n),UIMgr.hideUIByName(UIConst.PlayerOreView))})}},i.prototype.doRobFight=function(n){var o=this,a=new s.FightVo;a.copyType=CopyType.island,a.islandOreInfo=s.OreSpotInfoVo.copy(n),a.islandOreInfo.isOccupyFight=!1;var t=new battle.BattleScenePvp(a.copyType);t.init([a.getOwnTeam()],a.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.god,a.getAllRound(),a.getTeamHp()),t.start();var e=t.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",e,"战报：",t.battleReport);var i=new s.ServerPage;i.result=e?playState.VICTORY:playState.FAILURE,i.initPage(t.battleReport),a.fightPageControl=i,logdebug("神秘岛屿掠夺：",n.tbOre.ID,e,a);var r={};r[Protocol.game_mine_mineRobEnd.args.mineIndex]=n.svo.mineIndex,r[Protocol.game_mine_mineRobEnd.args.isWin]=e,PLC.request(Protocol.game_mine_mineRobEnd,r,function(t){if(t){var e=o._model.getIslandById(n.tbIsland.ID),i={vo:a,event:new s.IslandsEvent(s.IslandsEvent.SHOW_ORE_MAP),eventdata:e,responseData:t};dispatchEvt(new s.FightsEvent(s.FightsEvent.ENTER_FIGHT_EVENT),i)}})},i.prototype.occupyOre=function(n){var o=this,a=this._model;if(a.getOccupyCount()<=0)showToast(LanMgr.getLan("",10195));else{var r=n.svo.playerId?n.svo.playerId:null,t={};t[Protocol.center_mine_getTargetMineInfo.args.mineIndex]=n.svo.mineIndex,PLC.request(Protocol.center_mine_getTargetMineInfo,t,function(t){if(t){var e=t.mineInfo,i=e?e.playerId:null;r==i?a.getSelfOre()?common.AlertBox.showAlert({text:LanMgr.getLan("",10531),confirmCb:function(){o.doOccupyCheck(n)}}):o.doOccupyCheck(n):o.updateOreInfo(n)}})}},i.prototype.doOccupyCheck=function(a){var r=this;if(a.svo){if(!a.hasUser()){var t={};return t[Protocol.game_mine_mineOccupy.args.mineIndex]=a.svo.mineIndex,void PLC.request(Protocol.game_mine_mineOccupy,t,function(t,e,i){if(t){UIMgr.hideUIByName(UIConst.EmptyOreView),r._model.setMyOreInfo({mineId:a.svo.mineId,mineType:a.svo.mineType,islandId:a.tbIsland.ID}),a.svo.playerId=App.hero.playerId,a.svo.playerName=App.hero.name,a.svo.force=App.hero.force,a.svo.occupyTime=App.serverTimeSecond;var n=[];if(t.commonData&&UIUtil.getRewardItemVoList(n,t.commonData,!1,!1),t.firstData&&UIUtil.getRewardItemVoList(n,t.firstData,!0,!1),0<n.length){var o={content:LanMgr.getLan("",12197),itemArray:n};UIMgr.showUI(UIConst.OreSettlementView,o)}r.renderOreMap(a.tbIsland.ID)}else i==Lans.OccupyInfoHasRefresh&&(r.updateOreInfo(a),UIMgr.hideUIByName(UIConst.PlayerOreView))})}var e={};e[Protocol.game_mine_mineOccupyStart.args.mineIndex]=a.svo.mineIndex,e[Protocol.game_mine_mineOccupyStart.args.playerId]=a.svo.playerId,PLC.request(Protocol.game_mine_mineOccupyStart,e,function(t,e,i){t?(a.setDetailInfo(t.mineInfo),r.doOccupyFight(a)):i==Lans.OccupyInfoHasRefresh&&(r.updateOreInfo(a),UIMgr.hideUIByName(UIConst.PlayerOreView))})}else showToast(LanMgr.getLan("",10441))},i.prototype.doOccupyFight=function(n){var o=new s.FightVo;o.copyType=CopyType.island,o.islandOreInfo=s.OreSpotInfoVo.copy(n),o.islandOreInfo.isOccupyFight=!0;var t=new battle.BattleScenePvp(o.copyType);t.init([o.getOwnTeam()],o.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.god,o.getAllRound(),o.getTeamHp()),t.start();var e=t.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",e,"战报：",t.battleReport);var i=new s.ServerPage;i.result=e?playState.VICTORY:playState.FAILURE,i.initPage(t.battleReport),o.fightPageControl=i;var a=this._model;logdebug("神秘岛屿抢占：",n.tbOre.ID,e,o);var r={};r[Protocol.game_mine_mineOccupyEnd.args.mineIndex]=n.svo.mineIndex,r[Protocol.game_mine_mineOccupyEnd.args.isWin]=e,PLC.request(Protocol.game_mine_mineOccupyEnd,r,function(t){if(t){t.myInfo&&a.setMyOreInfo(t.myInfo);var e=a.getIslandById(n.tbIsland.ID),i={vo:o,event:new s.IslandsEvent(s.IslandsEvent.SHOW_ORE_MAP),eventdata:e,responseData:t};dispatchEvt(new s.FightsEvent(s.FightsEvent.ENTER_FIGHT_EVENT),i)}})},Object.defineProperty(i.prototype,"islandView",{get:function(){return UIMgr.getUIByName(UIConst.IslandView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"oreMapView",{get:function(){return UIMgr.getUIByName(UIConst.OreMapView)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=s.IslandModel.getInstance(),t}s.IslandProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"IslandModule"},n.prototype.listProcessors=function(){return[new t.IslandProcessor]},n.prototype.onRegister=function(){t.IslandModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.IslandModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_MAIN_VIEW="SHOW_MAIN_VIEW",r.SHOW_ORE_MAP="SHOW_ORE_MAP",r.SHOW_RULE_VIEW="SHOW_RULE_VIEW",r.SHOW_RESCORD_VIEW="SHOW_RESCORD_VIEW",r.SHOW_BUY_VIEW="SHOW_BUY_VIEW",r.OPEN_ORE_INFO="OPEN_ORE_INFO",r.OPEN_ORE_EXPLAIN="OPEN_ORE_EXPLAIN",r.OCCUPY_ORE="OCCUPY_ORE",r.ROB_ORE="ROB_ORE",r.UPDATE_ORE_LIST="UPDATE_ORE_LIST",r.UPDATE_RECORD_INFO="UPDATE_RECORD_INFO",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.IslandsEvent=a}(game=game||{}),function(i){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initModel=function(){this._islandsList=[];var t=TableData.getInstance().getTableByName(TableData.tb_island).data;for(var e in t)this._islandsList.push(new i.IslandInfoVo(t[e]));this._islandsList.sort(function(t,e){return e.tbIsland.type==t.tbIsland.type?e.tbIsland.type-t.tbIsland.type:e.tbIsland.ID-t.tbIsland.ID}),i.IslandUtil.resetInterval()},e.prototype.setMyOreInfo=function(t){t&&(this.clearMyInfo(),this.myOreInfo=t)},e.prototype.clearMyInfo=function(){var t=this.getSelfOre();t&&t.clearDetailInfo(),this.myOreInfo=null,i.IslandUtil.setRequestFlag(!1)},e.prototype.updateNewRecord=function(t){this.hasNewRecord=t,dispatchEvt(new i.IslandsEvent(i.IslandsEvent.UPDATE_RECORD_INFO))},e.prototype.updateEndTime=function(t){t!=this.hasEndTime&&(this.hasEndTime=t,dispatchEvt(new i.IslandsEvent(i.IslandsEvent.UPDATE_RECORD_INFO)))},e.prototype.getList=function(){return this._islandsList},e.prototype.getIslandById=function(e){return this._islandsList.find(function(t){return t.tbIsland.ID==e})},e.prototype.getSelfOre=function(){for(var t=0,e=this._islandsList;t<e.length;t++){var i=e[t].oreList.find(function(t){return t.hasUser()&&t.svo.playerId==App.hero.playerId});if(i)return i}return null},e.prototype.getBuyCost=function(){var t=tb.TB_island_set.getSet().buy_cost,e=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyMineRobNum);return e>=t.length?t[t.length-1]:t[e]},e.prototype.getOccupyCount=function(){return tb.TB_island_set.getSet().daily_num-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.mineOccupyNum)},e.prototype.getNextRefreshTime=function(){for(var t=new Date(App.serverTime),e=t.getHours(),i=t.getMinutes(),n=t.getSeconds(),o=tb.TB_island_set.getSet().refresh_time,a=3600*(24+Number(o[0])),r=0,s=o;r<s.length;r++){var u=s[r];if(e<Number(u)){a=3600*Number(u);break}}return a-3600*e-60*i-n},e.ORE_COLORS=["","#3cec55","#3cecd1","#af49cd","#ff6633","#ec3c51"],e);function e(){this.hasNewRecord=!1,this.hasEndTime=!1}i.IslandModel=t}(game=game||{}),(game||(game={})).HeadIconVo=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1),this.headId=0,this.headIcon="",this.isLock=!1,this.name="",isNaN(Number(t))||(t=Number(t)),this.headId=t,this.isLock=i,this.godTab=e,this.headIcon=SkinUtil.getHeroIcon(this.headId),this.name=this.godTab?this.godTab.getName():""},function(t){var e=(i.prototype.setChar=function(t){this.char=t,this.char.set2dPos(this.pos[0],this.pos[1]),this.char.y=.1},i.prototype.isOpen=function(){return App.hero.level>=this.openLev},i.prototype.hasGod=function(){return this.isOpen()&&null!=this.godItem},i.prototype.getStar=function(){return this.hasGod()?this.godItem.getStar():1},i.prototype.getLev=function(){return this.hasGod()?this.godItem.level:1},i.prototype.getTempId=function(){return this.isOpen()?this.hasGod()?this.godItem.getModel():100004:100003},i.prototype.getName=function(){return this.hasGod()?this.godItem.tab_god.name:""},i.prototype.getUuid=function(){return this.hasGod()?this.godItem.uuid:""},i.prototype.getTitle=function(){return this.isOpen()?this.hasGod()?"Lv."+this.getLev()+" "+this.getName():"":LanMgr.getLan("",11002,this.openLev)},i.prototype.getPosX=function(){return this.char.x},i.prototype.getPosY=function(){return this.char.y},i.prototype.getPosZ=function(){return this.char.z},i.prototype.destory=function(){this.char&&(this.char.destory(),this.char=null)},i);function i(t,e,i,n){this.idx=t,this.openLev=e,this.godItem=i,this.pos=n}t.CharItemVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var i,n=Laya.Event,t=(i=ui.hud.MainViewUI,__extends(e,i),e.prototype.onMouseWheel=function(t){this.gameScene.camDistance-=t.delta/Math.abs(t.delta)*this.factor*20,388<this.gameScene.camDistance&&(this.gameScene.camDistance=388),this.gameScene.camDistance<228&&(this.gameScene.camDistance=228)},e.prototype.setSize=function(t,e){i.prototype.setSize.call(this,t,e)},e.prototype.onTask=function(t){dispatchEvt(new r.TaskEvent(r.TaskEvent.SHOW_TASK_VIEW))},e.prototype.isBtnNotOpen=function(t){var e=t?tb.TB_sys_open.get_TB_sys_openById(t):null;return!(!e||App.IsSysOpen(t)||(showToast(e.prompt),0))},e.prototype.onModuleEvent=function(t){var e=parseInt(t.target.name);if(!this.isBtnNotOpen(e))switch(e){case ModuleConst.SUMMON:dispatchEvt(new r.SummonEvent(r.SummonEvent.SHOW_ZHAOHUAN_PANEL));break;case ModuleConst.GONGHUI:dispatchEvt(new r.GuildEvent(r.GuildEvent.SHOW_GUILD_PANEL));break;case ModuleConst.TUJIAN:dispatchEvt(new r.TujianEvent(r.TujianEvent.SHOW_TUJIAN_PANEL));break;case ModuleConst.SHENMEN:dispatchEvt(new r.GodDoorEvent(r.GodDoorEvent.OPEN_SHEN_MEN_VIEW));break;case ModuleConst.SHOP:dispatchEvt(new r.ShopEvent(r.ShopEvent.SHOW_SHOP_VIEW),ShopType.jishi);break;case ModuleConst.FRIEND:dispatchEvt(new r.FriendEvent(r.FriendEvent.SHOW_FRIEND_PANEL));break;case ModuleConst.PAIHBAN:PLC.request(Protocol.guild_guild_getRankTopList,null,function(t){t&&t.topRankList&&UIMgr.showUI(UIConst.RankTabView,t.topRankList)});break;case ModuleConst.MAIL:dispatchEvt(new r.MailEvent(r.MailEvent.SHOW_MAIL_PANEL))}},e.prototype.onChat=function(t){dispatchEvt(new r.ChatEvent(r.ChatEvent.SHOW_CHAT_PANEL),[r.OpenType.common,iface.tb_prop.chatChannelTypeKey.all])},e.prototype.updateChatList=function(){this.chatList.array=r.ChatModel.getInstance().getChatListByType(iface.tb_prop.chatChannelTypeKey.all,2)},e.prototype.chatRender=function(t,e){var i=t.getChildByName("lbChannel");i.autoSize=!0;var n=t.getChildByName("lbContent");n.style.fontSize=22,n.style.color="#ffeac2";var o=t.dataSource;o&&(i.color=o.getChannelColor(),i.text="【"+(o.channel==iface.tb_prop.chatChannelTypeKey.province?o.getCity():o.channelName)+"】",n.x=i.x+i.width,n.width=680-i.width-10,n.innerHTML=o.isSystem()?""+o.getSimpleCt(22):o.getName()+":"+o.getSimpleCt(18))},e.prototype.onOpened=function(){var e=this;i.prototype.onOpened.call(this),this.gameScene.camAotuMove=!1,this.updateBtnType(),r.FightView.chkCam&&Laya.stage.on(n.KEY_DOWN,this,this.onkeydown),this.initItems(),tl3d.ModuleEventManager.addEvent(r.GodEvent.BUZHEN_COMPLETE,this.updateRole,this),tl3d.ModuleEventManager.addEvent(r.ResEvent.ROLE_LEVEL_CHANGE,this.updateLev,this),this.updateChatList(),r.ChatThread.getInstance().startAutoRequest(iface.tb_prop.chatChannelTypeKey.all),this._initScene?this.sceneLoadComplete():(this._initScene=!0,this.gameScene.scene.loadScene(this.mapid,function(){},function(t){},this.sceneLoadComplete.bind(this))),this.btnbox.scale(1,1),this.btnbox.alpha=1,this.btnbox.right=12,this.showBtn=!0,this.btn_show.on(n.CLICK,this,this.onClickShow),this.btn_show.aniShou.gotoAndStop(0),this.timerOnce(utils.random(5e3,1e4),this,this.onCharPlay),this.timerOnce(200,this,function(){AudioMgr.playMusic("sound/bgmusic.mp3")}),UIUtil.boxUpDownTween(this.boxBottom,1009+this.boxBottom.height,1009,!0,310,.05);var t=this.height-this.boxBottom.height-100;UIUtil.boxUpDownTween(this.boxBottom,t+this.boxBottom.height,t,!0,310,.05),this.gameScene.addEffect(this,10000027,new tl3d.Vector3D(0,0,0),5,10,function(t){!e._eff1&&UIMgr.hasStage(UIConst.Main3DView)?e._eff1=t:e.gameScene.removeEffect(t)}),this.gameScene.addEffect(this,10000028,new tl3d.Vector3D(50,0,500),2,0,function(t){!e._eff2&&UIMgr.hasStage(UIConst.Main3DView)?e._eff2=t:e.gameScene.removeEffect(t)},100)},e.prototype.onCharPlay=function(){if(this._charItemList){var t=this.filterItems();if(0<t.length){var e=random(t.length),i=this._charItemList[t[e]];i&&i.char&&i.char.play(tl3d.CharAction.ATTACK_01,2)}}this.timerOnce(utils.random(5e3,1e4),this,this.onCharPlay)},e.prototype.filterItems=function(){for(var t=[],e=0;e<this._charItemList.length;e++){var i=this._charItemList[e];i.char&&i.char.visible&&t.push(e)}return t},e.prototype.updateLev=function(){for(var t=0;t<this._charItemList.length;t++){var e=this._charItemList[t];e&&e.char&&e.getTitle()!=e.char.charName&&""==e.getTitle()&&e.char.setRoleUrl(getRoleUrl(String(e.getTempId())))}},e.prototype.updateRole=function(){this.frameOnce(3,this,this.refreshRole)},e.prototype.refreshRole=function(){this.clearAllRole(),this.initItems(),this._loadId=0,this.addBaseRole()},e.prototype.clearAllRole=function(){if(this._charItemList)for(var t=0;t<this._charItemList.length;t++){var e=this._charItemList[t];e&&e.destory()}},e.prototype.initItems=function(){this._charItemList=[];for(var t=App.hero.getLineUpTeam(iface.tb_prop.lineupTypeKey.attack,!0),e=tb.TB_game_set.get_TB_game_setById(1).lineup,i=0;i<t.length;i++){var n=t[i],o=e[i],a=new r.CharItemVo(i,o,n,this._posList[i]);this._charItemList.push(a)}},e.prototype.sceneLoadComplete=function(){this.initCam(this._camMoveFlag?this.camParam[1]:this.camParam[0]),this._loadId=0,this._camMoveFlag?this.sceneComplete():(this.timerOnce(600,this,this.moveCam),this._camMoveFlag=!0)},e.prototype.moveCam=function(){var t=this,e=this.camParam[1];Laya.Tween.to(this.gameScene,{camRotationX:Number(e[0])},1e3,Laya.Ease.sineIn),Laya.Tween.to(this.gameScene,{camRotationY:Number(e[1])},1e3,Laya.Ease.sineIn),Laya.Tween.to(this.gameScene,{camDistance:Number(e[2])},1e3,Laya.Ease.sineIn),Laya.Tween.to(this.gameScene,{camPositionX:Number(e[3])},1e3,Laya.Ease.sineIn),Laya.Tween.to(this.gameScene,{camPositionY:Number(e[4])},1e3,Laya.Ease.sineIn),Laya.Tween.to(this.gameScene,{camPositionZ:Number(e[5])},1e3,Laya.Ease.sineIn,Handler.create(this,function(){t.sceneComplete()}))},e.prototype.sceneComplete=function(){this.addBaseRole(),this.gameScene.camAotuMove=!1,this.on(n.MOUSE_DOWN,this,this.onMouseDown),this.on(n.MOUSE_WHEEL,this,this.onMouseWheel),this.timerOnce(1e3,this,this.moveCamIng)},e.prototype.moveCamIng=function(){this.gameScene.camAotuMove=!0},e.prototype.camMove=function(){(this.gameScene.camRotationY<=-10||10<=this.gameScene.camRotationY)&&(this.toflag=!this.toflag),this.gameScene.camRotationY=this.toflag?this.gameScene.camRotationY+.025:this.gameScene.camRotationY-.025},e.prototype.onClosed=function(){this.clearTimer(this,this.moveCam),Laya.Tween.clearAll(this.gameScene),i.prototype.onClosed.call(this),this.clearTimer(this,this.onCharPlay),this.clearAllRole(),tl3d.ModuleEventManager.removeEvent(r.GodEvent.BUZHEN_COMPLETE,this.updateRole,this),tl3d.ModuleEventManager.removeEvent(r.ResEvent.ROLE_LEVEL_CHANGE,this.updateLev,this),this._charItemList=null,r.ChatThread.getInstance().stopRequest(),this.btn_show.off(n.CLICK,this,this.onClickShow),Laya.Tween.clearAll(this.btnbox),this._eff1&&(this.gameScene.removeEffect(this._eff1),this._eff1=null),this._eff2&&(this.gameScene.removeEffect(this._eff2),this._eff2=null),Laya.stage.off(n.KEY_DOWN,this,this.onkeydown),this.off(n.MOUSE_DOWN,this,this.onMouseDown),this.off(n.MOUSE_WHEEL,this,this.onMouseWheel)},e.prototype.onkeydown=function(t){r.FightView.chkCam&&this.char&&this.setPos(t.keyCode)},e.prototype.onMouseMove=function(t){var e=t.touches;if(e&&2==e.length){var i=this.getDistance(t.touches),n=(i-this.lastDistance)*this.factor;this.lastDistance=i,this.gameScene.camDistance-=n,388<this.gameScene.camDistance&&(this.gameScene.camDistance=388),this.gameScene.camDistance<228&&(this.gameScene.camDistance=228)}else{var o=(this.prevX-this.stage.mouseX)*this.factor,a=(this.prevY-this.stage.mouseY)*this.factor;this.prevX=this.stage.mouseX,this.prevY=this.stage.mouseY,this.gameScene.camRotationY+=o,33<this.gameScene.camRotationY&&(this.gameScene.camRotationY=33),this.gameScene.camRotationY<-20&&(this.gameScene.camRotationY=-20),this.gameScene.camRotationX+=a,10<this.gameScene.camRotationX&&(this.gameScene.camRotationX=10),this.gameScene.camRotationX<-10&&(this.gameScene.camRotationX=-10)}},e.prototype.onMouseUp=function(t){this.gameScene.camAotuMove=!0,this.off(n.MOUSE_MOVE,this,this.onMouseMove),this.downX==this.stage.mouseX&&this.downY==this.stage.mouseY&&this.onClick()},e.prototype.getDistance=function(t){var e=0;if(t&&2==t.length){var i=t[0].stageX-t[1].stageX,n=t[0].stageY-t[1].stageY;e=Math.sqrt(i*i+n*n)}return e},e.prototype.onMouseDown=function(t){this.gameScene.camAotuMove=!1,this.downX=this.prevX=this.stage.mouseX,this.downY=this.prevY=this.stage.mouseY,this.on(n.MOUSE_MOVE,this,this.onMouseMove);var e=t.touches;e&&2==e.length&&(this.lastDistance=this.getDistance(e))},e.prototype.setPos=function(t){if(t==Laya.Keyboard.UP)this.char.pz+=1;else if(t==Laya.Keyboard.DOWN)--this.char.pz;else if(t==Laya.Keyboard.LEFT)--this.char.px;else if(t==Laya.Keyboard.RIGHT)this.char.px+=1;else if(t==Laya.Keyboard.X)for(var e=0;e<this._charItemList.length;e++){var i=this._charItemList[e];logyhj("角色: %d  2d坐标： %o",i.idx,i.char.get2dPos())}},e.prototype.initCam=function(t){this.gameScene.camRotationX=t[0],this.gameScene.camRotationY=t[1],this.gameScene.camDistance=t[2],this.gameScene.camPositionX=t[3],this.gameScene.camPositionY=t[4],this.gameScene.camPositionZ=t[5],this.gameScene.camViewLH=t[6]},e.prototype.addBaseRole=function(){var e=this;if(this._charItemList){var i=this._charItemList[this._loadId];if(i){var t=i.getTempId(),n=getRoleUrl(String(t)),o=new MainChar;this.gameScene.scene.addMovieDisplay(o),o.forceRotationY=170,o.scale=.32,i.isOpen()&&i.hasGod()||(o.alpha=0),i.setChar(o),o.setRoleUrl(n,function(){if(i.isOpen()&&i.hasGod()){o.shadow=!0,o.setShadowSize(2),o.nameEnable=!0,o.setcharNameColor("#ffffff","#9b2e3c"),o.charName=i.getTitle(),o.roleStartEnable=!0;var t=i.getStar();o.setroleStart(5<t?t-5:t,5<t?1:0)}else i.isOpen()||(o.nameEnable=!0,o.setcharNameColor("#e41e1e"),o.charName=i.getTitle(),o.setNamePos(i.getPosX(),15,i.getPosZ()));e._loadId++,Laya.timer.frameOnce(10,e,e.addBaseRole.bind(e))})}}},e.prototype.onClick=function(){for(var t,e=0;this._charItemList&&e<this._charItemList.length;e++){var i=(t=this._charItemList[e]).char;if(i&&i.mouseClik(this.getCam3d(),this.downPointTo3d(Laya.stage.mouseX,Laya.stage.mouseY)))if(logfight("选中目标：",t),r.FightView.chkCam)this.char=i;else{if(!t.isOpen())return void showToast(t.getTitle());if(t.hasGod())return void dispatchEvt(new r.GodEvent(r.GodEvent.SHOW_SHENGLING_PANEL),[t.getUuid()]);dispatchEvt(new r.GodEvent(r.GodEvent.SHOW_BUZHEN_PANEL),iface.tb_prop.lineupTypeKey.attack)}}},e.prototype.getCam3d=function(){return new tl3d.Vector3D(this.gameScene.copyCam3d.x,this.gameScene.copyCam3d.y,this.gameScene.copyCam3d.z)},e.prototype.downPointTo3d=function(t,e){return this.gameScene.getGroundPos(t,e)},e.prototype.updateBtnTypeCache=function(){Laya.timer.frameOnce(5,this,this.updateBtnType)},e.prototype.updateBtnType=function(){this._hudmodel.isActivityBtnChange()&&this.callLater(this.updateActivityBtns)},e.prototype.onClickShow=function(){this.showBtn=!this._isShowBtn,this.showBtn?this.btn_show.aniFang.play(0,!1):this.btn_show.aniShou.play(0,!1)},Object.defineProperty(e.prototype,"showBtn",{get:function(){return this._isShowBtn},set:function(t){this._isShowBtn=t,Laya.Tween.clearAll(this.btnbox);var e=t?1:0,i=t?122:122-this.btnbox.height;this.btnbox.visible=!0,Laya.Tween.to(this.btnbox,{alpha:e,y:i},200,null,Handler.create(this,this.onBtnboxCOmplete))},enumerable:!0,configurable:!0}),e.prototype.onBtnboxCOmplete=function(){this._isShowBtn||(this.btnbox.visible=!1)},e.prototype.updateActivityBtns=function(){function t(e){n.some(function(t){return t==~~e})||(o._upperBtn[e].removeBtn(),delete o._upperBtn[e])}var e=this.btnbox,i=this._hudmodel.upperBtnVos.filter(function(t){return t.isOnActivityTime()}),n=i.map(function(t){return t.sysOpenId}),o=this;for(var a in this._upperBtn)t(a);for(var r=0;r<i.length;r++){var s=this.createUpperBtnIR(i[r]),u=Math.floor(r/7),h=r/7==u?0:r%7;s.y=s.height/2+99*u,s.x=e.width-100*h,s.redPoint.x=s.x-40,s.redPoint.y=s.y-40}},e.prototype.createUpperBtnIR=function(t){var e=t.sysOpenId,i=this.btnbox.getChildByName(e+"");if(this._upperBtn[e]||(this._upperBtn[e]=new r.ActivityBtnIR(t)),!i){var n=this._upperBtn[e];n.redPoint.removeSelf(),this.btnbox.addChild(n),this.btnbox.addChild(n.redPoint)}return this._upperBtn[e]},e.prototype.getActivityBtnIR=function(t){return this._upperBtn[t]},e);function e(){var t=i.call(this)||this;return t.lastDistance=0,t.factor=.15,t.sfactor=.005,t.mapid="scene021",t._camMoveFlag=!1,t._upperBtn={},t._hudmodel=r.HudModel.getInstance(),t.camParam=[[-7,-19,485,-33,117,5,1.1],[-1,1,300,-12,75,5,1.15],[4,2,250,-7,75,5,1.15]],t._posList=[[28,43.7],[-22,48],[70,.54],[28,-42.4],[-28,-45.2],[-62,6.16]],t.toflag=!1,t._isShowBtn=!1,t.group=UIConst.hud_group,t.gameScene=new Base3dSceneLayer,t.gameScene.scene.changeBloodManager(new BloodManagerExt),t.addChildAt(t.gameScene,0),t.gameScene.camMoveFun=function(){t.camMove()},t.on(n.MOUSE_UP,t,t.onMouseUp),t.on(n.MOUSE_OUT,t,t.onMouseUp),t.btn_friend.on(n.CLICK,t,t.onModuleEvent),t.btn_mail.on(n.CLICK,t,t.onModuleEvent),t.btn_rank.on(n.CLICK,t,t.onModuleEvent),t.btn_tujian.on(n.CLICK,t,t.onModuleEvent),t.btn_shop.on(n.CLICK,t,t.onModuleEvent),t.btn_shenjiezhimen.on(n.CLICK,t,t.onModuleEvent),t.btnZhaohuan.on(n.CLICK,t,t.onModuleEvent),t.btnGonghui.on(n.CLICK,t,t.onModuleEvent),t.img_chat.on(n.CLICK,t,t.onChat),t.btn_task.on(n.CLICK,t,t.onTask),tl3d.ModuleEventManager.addEvent(r.HudEvent.UPDATE_MAINVIEW_BUTTON,t.updateBtnTypeCache,t),t.chatList.renderHandler=new Handler(t,t.chatRender),t.gameScene.y=0,t}r.MainView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){function t(){}n.HudItemVo=t;var o,e=Laya.Event,i=(o=ui.hud.HudBoxUI,__extends(a,o),a.prototype.setSize=function(t,e){o.prototype.setSize.call(this,t,e),this.box_top.width=t,this.box_top.height=GameUtil.isFullScreen()?123+n.HudModel.TOP_ADD_HEIGHT:123;var i=Launch.offsetX>>1;this.vbox.space=25+i,this.vbox_funs.space=i<=60?20+i/2:50,this.img_bottom.width=t,this._chatPos=new Laya.Point(-1,-1),this._chatRect=new Laya.Rectangle(0,0,t-64,e-64)},a.prototype.setVisible=function(t){this.visible,(this.visible=t)?this.updatePrivateChat():this.box_top.visible=!1},a.prototype.updateExp=function(){var t=tb.TB_role.get_TB_rolenById(App.hero.level),e=App.hero.exp,i=1;0!=t.exp&&(i=e/t.exp),this.pro_exp.value=i},a.prototype.show=function(t,e){o.prototype.show.call(this,t,e),this.onStageResize(),this.setName(),this.setHead(),this.setHeadFrame(),this.initView(),this.updatePower(!0),App.enterGame=!0,this.updateShenjieRedpt(),UIMgr.hasStage(UIConst.SysTopView)||(this.visible=!0),this.startTopTween(),this.updatePrivateChat(),tl3d.ModuleEventManager.addEvent(n.ResEvent.RESOURCE_CHANGE,this.updateExp,this),this.updateExp()},a.prototype.close=function(){o.prototype.close.call(this),tl3d.ModuleEventManager.removeEvent(n.ResEvent.RESOURCE_CHANGE,this.updateExp,this)},a.prototype.getBtnPos=function(t){return t.localToGlobal(new Laya.Point(10,10))},a.prototype.setName=function(){this.lbl_name.text=12<App.hero.name.length?LanMgr.getLan("",12211):App.hero.name},a.prototype.setHead=function(){this.img_icon.skin=App.hero.headIcon},a.prototype.setHeadFrame=function(){this.imgHeadFrame.visible=0<App.hero.headFrame,this.imgHeadFrame.visible&&(this.imgHeadFrame.skin=SkinUtil.getHeadFrame(App.hero.headFrame))},a.prototype.recharge=function(){dispatchEvt(new n.TopUpEvent(n.TopUpEvent.SHOW_CHONGZHI_PANEL))},a.prototype.onVip=function(){dispatchEvt(new n.TopUpEvent(n.TopUpEvent.SHOW_CHONGZHI_PANEL),[1])},a.prototype.exchangeGold=function(){UIMgr.showUI(UIConst.ExchangeGoldView)},a.prototype.initView=function(){this.lab_money.text=Snums(App.hero.gold),this.lab_zuanshi.text=Snums(App.hero.diamond),this.lbl_level.text=App.hero.level.toString(),this.setVip()},a.prototype.updatePower=function(t){if(void 0===t&&(t=!1),t)this.clip_xp.dataSource=App.hero.force,this.clip_xp.value=String(App.hero.force);else{var e=App.hero.force,i=Number(this.clip_xp.dataSource);if(e==i)return;UIUtil.upPowerEff(i,e),this.clip_xp.value=String(e),this.clip_xp.dataSource=e}},a.prototype.onChat=function(){n.GuideManager.isExecuteGuide()||this.btn_chat.startDrag(this._chatRect),Laya.Tween.clearAll(this.btn_chat),Laya.Tween.to(this.btn_chat,{alpha:1},500)},a.prototype.onChatUp=function(){var t=this;setTimeout(function(){Laya.Tween.clearAll(t.btn_chat),Laya.Tween.to(t.btn_chat,{alpha:.65},500)},3e3),(-1==this._chatPos.x||this.btn_chat.x-this._chatPos.x==0&&this.btn_chat.y-this._chatPos.y==0)&&dispatchEvt(new n.ChatEvent(n.ChatEvent.SHOW_CHAT_PANEL),[n.OpenType.common,iface.tb_prop.chatChannelTypeKey.all]),this._chatPos.x=this.btn_chat.x,this._chatPos.y=this.btn_chat.y,this.btn_chat.stopDrag()},a.prototype.onDetails=function(t){this._ui.showUI(UIConst.PlayerDetailsView)},a.prototype.setVip=function(){this.lbl_vip.value=App.hero.vip?"V"+App.hero.vip.toString():"V0"},a.prototype.on3DMain=function(){var t=this;this.openAlert().then(function(){UIMgr.hasStage(UIConst.Main3DView)||UIMgr.showUI(UIConst.Main3DView),t.img_select.x=t.vbox_funs.x+t.img0.x+(t.img0.width-t.img_select.width>>1)})},a.prototype.openAlert=function(){return n.GodDmThread.getInstance().leaveViewAlert()},a.prototype.onFight=function(){var t=this;n.GodUtils.getGodsNum()<=0?showToast(LanMgr.getLan("",10017)):this.openAlert().then(function(){t.img_select.x=t.vbox_funs.x+t.img5.x+(t.img5.width-t.img_select.width>>1),dispatchEvt(new n.GuajiEvent(n.GuajiEvent.SHOW_GUAJI_PANEL))})},a.prototype.onShenling=function(t){var e=this;void 0===t&&(t=-1),n.GodUtils.getGodsNum()<=0?showToast(LanMgr.getLan("",10017)):this.openAlert().then(function(){e.img_select.x=e.vbox_funs.x+e.img1.x+(e.img1.width-e.img_select.width>>1),dispatchEvt(new n.GodEvent(n.GodEvent.SHOW_SHENGLING_PANEL),[-1,t])})},a.prototype.onEquip=function(t){var e=this;void 0===t&&(t=-1),n.GodUtils.getGodsNum()<=0?showToast(LanMgr.getLan("",10017)):this.openAlert().then(function(){e.img_select.x=e.vbox_funs.x+e.img2.x+(e.img2.width-e.img_select.width>>1),dispatchEvt(new n.EquipEvent(n.EquipEvent.SHOW_EQUIP_PANEL),[t])})},a.prototype.onBag=function(t){var e=this;void 0===t&&(t=-1),this.openAlert().then(function(){e.img_select.x=e.vbox_funs.x+e.img4.x+(e.img4.width-e.img_select.width>>1),dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.BEIBAO,t])})},a.prototype.onShenqi=function(t,e){var i=this;void 0===t&&(t=0),void 0===e&&(e=0),App.IsSysOpen(ModuleConst.ARTIFACT)?this.openAlert().then(function(){i.img_select.x=i.vbox_funs.x+i.img3.x+(i.img3.width-i.img_select.width>>1),dispatchEvt(new n.ArtifactEvent(n.ArtifactEvent.SHOW_ARTIFACT_PANEL),[t,e])}):showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.ARTIFACT).prompt)},a.prototype.updateShenjieRedpt=function(){this.rpMain.redpointName&&""!=this.rpMain.redpointName||!n.GuajiModel.getInstance().isPassCopy(common.GlobalData.GUAJI_COPY_2_10)||this.rpMain.setRedPointName("main_group")},a.prototype.onDialogOnClosed=function(t){-1!=this._returnUIlist.indexOf(t.name)?this._lastDialog=t.name:this._lastDialog=null},a.prototype.onDialogOnOpened=function(t){if(t.group==UIConst.hud_group){var e=this.box_top.visible,i=-1!=this._uiNameList.indexOf(t.name);this.box_top.visible=!i,e||i||this.startTopTween(),this.btn_chat.visible=-1!=[UIConst.Main3DView,UIConst.GuajiView].indexOf(t.name),this.updatePrivateChat()}},a.prototype.getLastDialog=function(){return this._lastDialog},a.prototype.startTopTween=function(){UIUtil.boxUpDownTween(this.box_top,-this.box_top.height,0,!1,310,.05)},a.prototype.updatePrivateChat=function(){var t=UIMgr.hasStage(UIConst.Main3DView)||UIMgr.hasStage(UIConst.GuajiView);this.btnPrivateChat.visible=!!t&&n.ChatModel.getInstance().hasNewPrivateChat()},a.prototype.onShowPriChat=function(){dispatchEvt(new n.ChatEvent(n.ChatEvent.SHOW_PRIVATE_CHAT_VIEW))},a);function a(){var t=o.call(this)||this;return t._ui=UIMgr.getInstance(),t._returnUIlist=[UIConst.GuajiView,UIConst.God_MainView,UIConst.Main3DView],t._uiNameList=[UIConst.God_MainView,UIConst.EquipView,UIConst.ArtifactView],t.mouseThrough=!0,t.btn_main.on(Laya.Event.CLICK,t,t.on3DMain),t.btn_shenqi.on(Laya.Event.CLICK,t,t.onShenqi,[0,0]),t.btn_fight.on(Laya.Event.CLICK,t,t.onFight),t.btn_god.on(Laya.Event.CLICK,t,t.onShenling,[-1]),t.btn_equip.on(Laya.Event.CLICK,t,t.onEquip,[-1]),t.btn_bag.on(Laya.Event.CLICK,t,t.onBag,[-1]),t.btn_add_zuanshi.on(Laya.Event.CLICK,t,t.recharge),t.btn_addgold.on(Laya.Event.CLICK,t,t.exchangeGold),t.img_icon.on(Laya.Event.CLICK,t,t.onDetails),t.box_vip.on(Laya.Event.CLICK,t,t.onVip),t.btn_chat.on(e.MOUSE_DOWN,t,t.onChat),t.btn_chat.on(e.MOUSE_UP,t,t.onChatUp),t.btnPrivateChat.on(Laya.Event.CLICK,t,t.onShowPriChat),tl3d.ModuleEventManager.addEvent(n.ChatEvent.UPDATE_PRIVATE_CHAT,t.updatePrivateChat,t),t._arrBtn=[t.btn_main,t.btn_god,t.btn_equip,t.btn_shenqi,t.btn_bag,t.btn_fight],UIUtil.createHeadMask(t.img_icon,t.img_icon.width/2),t.frameOnce(2,t,function(){t.img_select.x=t.vbox_funs.x+t.img0.x+(t.img0.width-t.img_select.width>>1)}),t}n.HudView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var i,t=(i=ui.hud.view.ExchangeGoldUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(){i.prototype.popup.call(this),this.initView(),this.isModelClose=!0},e.prototype.close=function(){i.prototype.close.call(this),Laya.timer.clearAll(this),this.removeEff()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.ani1.stop(),this.btn_Duihuan.off(Laya.Event.CLICK,this,this.onExchangeGold)},e.prototype.initView=function(){this.btn_Duihuan.on(Laya.Event.CLICK,this,this.onExchangeGold),this.updateData(),this.playEff(),this.img_bx.skin="jinbiduihuan/jinbiduihuan02.png",this.ani1.play(1,!0)},e.prototype.updateData=function(){var t=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.goldBuyNum),e=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.goldBuyFreeNum);this.lbCiShu.text=LanMgr.getLan("",12215)+"  :  "+(App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.goldBuyNum)-t-e);var i=tb.TB_gold_exchange.getDataById(t+1);i?(this.lbGold.text=LanMgr.getLan("",12214)+"  :  "+i.gold,e>=tb.TB_exchange_set.getSet().daily_free?(this.lab_consume.text="X"+i.diamond,this.box_consume.centerX=0,this.box_consume.visible=!0,this.btn_Duihuan.disabled=!1,this.btn_Duihuan.label=LanMgr.getLan("",12212)):(this.box_consume.visible=!1,this.btn_Duihuan.disabled=!1,this.btn_Duihuan.label=LanMgr.getLan("",10511))):(this.lbGold.text=LanMgr.getLan("",12214)+"  :   0",this.box_consume.visible=!1,this.btn_Duihuan.disabled=!0,this.btn_Duihuan.label=LanMgr.getLan("",12212))},e.prototype.playEff=function(){var e=this;this._particle||this.uiScene.addEffect(this,1000008,new tl3d.Vector3D(185,0,-480),4,30,function(t){e._particle=t})},e.prototype.removeEff=function(){this._particle&&(this.uiScene.removeEffect(this._particle),this._particle=null)},e.prototype.onExchangeGold=function(){var e=this,t=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.goldBuyNum),i=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.goldBuyNum),n=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.goldBuyFreeNum);if(t-i-n<=0)showToast(LanMgr.getLan("",10082));else{if(n>=tb.TB_exchange_set.getSet().daily_free){var o=tb.TB_gold_exchange.getDataById(i+1);if(App.hero.diamond<o.diamond)return showToast(LanMgr.getLan("",10005)),void dispatchEvt(new a.TopUpEvent(a.TopUpEvent.SHOW_CHONGZHI_PANEL))}this.btn_Duihuan.disabled=!0,this.btn_Duihuan.label=LanMgr.getLan("",12213),this.isModelClose=!1,PLC.request(Protocol.game_shop_goldBuy,{},function(t){t&&(e.img_bx.skin="jinbiduihuan/jinbiduihuan03.png",e.ani1.stop(),Laya.timer.once(500,e,e.showReward,[t]),dispatchEvt(new a.HudEvent(a.HudEvent.EXCHANGE_GOLD_CHANGE)))})}},e.prototype.showReward=function(t){var e=this;this.updateData(),this.isModelClose=!0,UIUtil.showRewardView(t.commonData,function(){e.img_bx.skin="jinbiduihuan/jinbiduihuan02.png",e.ani1.play(e.ani1.index,!0)},!1,UI_DEPATH.TOP)},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t.uiScene=new Base2dSceneLayer,t.addChild(t.uiScene),t}a.ExchangeGoldView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var t;(t=r.BtnFuncId||(r.BtnFuncId={}))[t.reviveHero=1]="reviveHero",t[t.recoverHero=2]="recoverHero";var i,e=(i=ui.hud.view.SysTopUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.btnClose.on(Laya.Event.CLICK,this,this.onClick),this.boxFogforest.visible=!1,this.box_island.visible=!1,this._resList=[]},n.prototype.setSize=function(t,e){i.prototype.setSize.call(this,t,e),this.boxTop.height=GameUtil.isFullScreen()?134+r.HudModel.TOP_ADD_HEIGHT:134},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.close=function(){i.prototype.close.call(this),this.btnList.array=null,this.imgSys.skin=null,Laya.timer.clear(this,this.updateIslandTime),tl3d.ModuleEventManager.removeEvent(r.ResEvent.RESOURCE_CHANGE,this.updateRes,this),tl3d.ModuleEventManager.removeEvent(r.HudEvent.UPDATE_SYS_TOP_BTN_INFO,this.updateBtnIr,this),tl3d.ModuleEventManager.removeEvent(r.ResEvent.LIMIT_VALUE_CHANGE,this.updateIslandCount,this),this.btnOneKey.off(Laya.Event.CLICK,this,this.onOnekey),this.clearResList();var t=UIMgr.getUIByName(UIConst.HudView);t&&t.setVisible(!0)},n.prototype.initView=function(){var t=UIMgr.getUIByName(UIConst.HudView);t&&t.setVisible(!1);var e=this.dataSource;this.btnList.array=e.funList;var i=SkinUtil.getSysTitle(e.viewName);i&&""!=i?(this.imgSys.skin=SkinUtil.getSysTitle(e.viewName),this.imgSys.visible=this.bgTitle.visible=!0):this.imgSys.visible=this.bgTitle.visible=!1,e.resAry=e.resAry||[];var n=e.resAry.length;this.clearResList();for(var o=0;o<n;o++){var a=new r.SysTopResIR;a.y=GameUtil.isFullScreen()?5+r.HudModel.TOP_ADD_HEIGHT:5,a.dataSource=e.resAry[o],this.boxTop.addChild(a),this._resList.push(a)}this.layoutList(),tl3d.ModuleEventManager.addEvent(r.ResEvent.RESOURCE_CHANGE,this.updateRes,this),tl3d.ModuleEventManager.addEvent(r.HudEvent.UPDATE_SYS_TOP_BTN_INFO,this.updateBtnIr,this),this.updateRes(),this.boxFogforest.visible=!1,this.box_island.visible=!1,e.viewName==UIConst.FogForestView?(this.boxFogforest.visible=!0,this.btnOneKey.on(Laya.Event.CLICK,this,this.onOnekey),this.updateFogforest()):e.viewName!=UIConst.IslandView&&e.viewName!=UIConst.OreMapView||(this.box_island.visible=!0,this.btn_island_add.on(Laya.Event.CLICK,this,this.onClickIslandBtn),tl3d.ModuleEventManager.addEvent(r.ResEvent.LIMIT_VALUE_CHANGE,this.updateIslandCount,this),Laya.timer.loop(1e3,this,this.updateIslandTime),this.updateIsland())},n.prototype.layoutList=function(){for(var t=0,e=this._resList.length,i=0,n=this._resList;i<n.length;i++)t+=(r=n[i]).width;t+=20*(e-1);for(var o=(this.width-t)/2,a=0;a<e;a++){var r;(r=this._resList[a]).x=o,o=r.x+r.width+20}},n.prototype.updateRes=function(){for(var t=0,e=this._resList;t<e.length;t++)e[t].refreshView()},n.prototype.updateBtnIr=function(t){for(var e=0,i=t.data||[];e<i.length;e++){var n=i[e],o=this.getSysTopBtnIR(n.btnId);if(o){var a=o.dataSource;for(var r in n)a[r]=n[r];o.refreshView()}}},n.prototype.getSysTopBtnIR=function(e){return e?(this.btnList.cells||[]).find(function(t){return t&&t.dataSource&&t.dataSource.btnId==e}):null},n.prototype.onClick=function(){var t=this.dataSource;t&&GameUtil.isFunction(t.closeCallback)&&t.closeCallback()},n.prototype.clearResList=function(){for(var t=0,e=this._resList;t<e.length;t++){var i=e[t];i.dataSource=null,i.removeSelf()}this._resList.length=0},n.prototype.updateFogforest=function(){this.lbGuanqia.text=LanMgr.getLan("",10184,App.hero.forestMaxFloor)},n.prototype.onOnekey=function(){dispatchEvt(new r.FogForestEvent(r.FogForestEvent.ONE_KEY_PASS))},n.prototype.updateIsland=function(){this.updateIslandCount(),this.updateIslandTime()},n.prototype.updateIslandTime=function(){var t=App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.mineRobNum);if(tb.TB_island_set.getSet().plunder_max<=t)this.lab_island_refresh.visible=!1;else{this.lab_island_refresh.visible=!0;var e=tb.TB_island_set.getSet().reply_time-(App.serverTimeSecond-App.hero.mineRobReplyTime);this.lab_island_refresh.text=LanMgr.getLan("",10186,GameUtil.toCountdown(e,"mm:ss",2))}this.lab_island_rob.text="可掠夺:"+t+"次"},n.prototype.updateIslandCount=function(){this.lab_island_rob.text="可掠夺:"+App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.mineRobNum)+"次",this.lab_island_occupy.text="可占领:"+r.IslandModel.getInstance().getOccupyCount()+"次"},n.prototype.onClickIslandBtn=function(){dispatchEvt(new r.IslandsEvent(r.IslandsEvent.SHOW_BUY_VIEW))},n);function n(){var t=i.call(this)||this;return t.isModelClose=!1,t.mouseThrough=!0,t}r.SysTopView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.hud.render.SysTopResIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this._dataSource;if(t){this.imgRes.skin=SkinUtil.getCostSkin(t),this.lbNum.text=Snums(App.getResNum(t)),this.btnAdd.on(Laya.Event.CLICK,this,this.onClick);var e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond];this.btnAdd.visible=-1!=e.indexOf(t),this.width=-1!=e.indexOf(t)?130:110}else this.imgRes.skin=null,this.lbNum.text="",this.btnAdd.off(Laya.Event.CLICK,this,this.onClick)},n.prototype.onClick=function(){switch(this._dataSource){case iface.tb_prop.resTypeKey.gold:UIMgr.showUI(UIConst.ExchangeGoldView);break;case iface.tb_prop.resTypeKey.diamond:dispatchEvt(new t.TopUpEvent(t.TopUpEvent.SHOW_CHONGZHI_PANEL))}},n);function n(){return e.call(this)||this}t.SysTopResIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.hud.render.SysTopBtnIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this._dataSource;t?(this.lbText.visible=!!t.text,this.lbText.text=t.text,this.btnFunc.skin=t.btnSkin,this.btnFunc.on(Laya.Event.CLICK,this,this.onClick),this.redpoint.setRedPointName(t.redpointName)):(this.lbText.visible=!1,this.btnFunc.skin=null,this.btnFunc.on(Laya.Event.CLICK,this,this.onClick),this.redpoint.onDispose())},n.prototype.onClick=function(){var t=this._dataSource;t&&t.callback&&t.callback()},n);function n(){return e.call(this)||this}t.SysTopBtnIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,o=Laya.Event,t=(n=ui.hud.render.ActivityBtnIRUI,__extends(e,n),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)&&this.init()},enumerable:!0,configurable:!0}),e.prototype.updateState=function(){this.dataSource&&this.dataSource.sysOpenId==iface.tb_prop.sysOpenTypeKey.onlineAward&&this.loopOnline()},e.prototype.init=function(){var t=this.dataSource,e=t.sysOpenId;this.redPoint.setRedPointName(t.redpointName),this.btn.skin=SkinUtil.getTabBtnSkin(t.tabHud.icon),i.HudModel.getInstance().isPlayEffect(e)?this.ani.play():this.ani.destroy(),e==iface.tb_prop.sysOpenTypeKey.onlineAward?(this._img_time||(this._img_time=new Laya.Image("comp/bg/pic_shenlizhi.png"),this._img_time.x=-3,this._img_time.y=94,this._img_time.width=100,this._img_time.height=25,this.btn.addChild(this._img_time)),this._lab_time||(this._lab_time=new Laya.Label,this._lab_time.color="#fff0a0",this._lab_time.fontSize=19,this._lab_time.stroke=2,this._lab_time.strokeColor="#000000",this._lab_time.anchorX=.5,this._lab_time.x=47,this._lab_time.y=98,this.btn.addChild(this._lab_time)),this.loopOnline()):(this._img_time&&(this._img_time.removeSelf(),this._img_time=null),this._lab_time&&(this._lab_time.removeSelf(),this._lab_time=null))},e.prototype.loopOnline=function(){if(this._lab_time){var t=i.OnlineModel.getInstance().lastItemState();if(null==t||!t.istime)return void this.clearloop(t);this.timerLoop(1e3,this,this.onLoop,[t]),this.onLoop(t)}else this.clearTimer(this,this.onLoop)},e.prototype.onLoop=function(t){t.vo.canReceive()?this.clearloop(t):this._lab_time?this._lab_time.text=t.vo.onTime():this.clearloop(t)},e.prototype.clearloop=function(t){this._lab_time&&(this._lab_time.text=null==t||t.vo.isReceive()?"已领取":"领取"),this.clearTimer(this,this.onLoop)},e.prototype.removeBtn=function(){this.removeSelf(),this.redPoint.removeSelf()},e);function e(t){var e=n.call(this)||this;return e.dataSource=t,tl3d.ModuleEventManager.addEvent(i.HudEvent.UPDATE_ONLINEREWARD,e.updateState,e),e.name=t.sysOpenId+"",e.on(o.CLICK,e,function(){i.HudModel.ActivityBtnEvent(t.sysOpenId)}),e}i.ActivityBtnIR=t;var a=(r.prototype.isOnActivityTime=function(){return i.HudModel.IsOnActivatyTime(this.sysOpenId)},r.prototype.isHaveChange=function(){var t=this.isOnActivityTime();return this._isOpen!=t&&(this._isOpen=t,!0)},r);function r(t){this.sysOpenId=t.system_id,this.tabHud=t,this.redpointName="sys"+this.sysOpenId+"_group",393==this.sysOpenId&&(this.redpointName="timeActivity"+i.TimelimitModel.ACTIVITY_JIJIN_ID)}i.ActivityBtnVo=a}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.hud.player.TabSysSettingUI,__extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.slider_Music.changeHandler=new Handler(this,this.setMusicVolume),this.slider_Sound.changeHandler=new Handler(this,this.setSoundVolume),this.img_yinyueon.on(Laya.Event.CLICK,this,this.onYinyue),this.img_yinyueoff.on(Laya.Event.CLICK,this,this.onYinyue),this.img_yinxiaoon.on(Laya.Event.CLICK,this,this.onYinxiao),this.img_yinxiaooff.on(Laya.Event.CLICK,this,this.onYinxiao),this.btnExitGame.on(Laya.Event.CLICK,this,this.onExitGame),this.btnSwitchAcc.on(Laya.Event.CLICK,this,this.onSwitchAcc)},n.prototype.close=function(){},n.prototype.show=function(){this.initView()},n.prototype.initView=function(){var t=Laya.LocalStorage.getItem("GameVolume");t&&0!=t.length||(t="45",Laya.LocalStorage.setItem("GameVolume",t)),this.slider_Music.value=Number(t);var e=Laya.LocalStorage.getItem("GameSound");e&&0!=e.length||(e="80",Laya.LocalStorage.setItem("GameSound",e)),this.slider_Sound.value=Number(e),this.lab_resVersion.text="resVersion："+BingoSDK.resVersion,this.lab_clientVersion.text="clientVersion："+BingoSDK.clientVersion,Laya.Slider.label.fontSize=22},n.prototype.onYinxiao=function(){var t=0;switch(t=this.img_yinxiaoon.visible?1:0){case 0:this.img_yinxiaooff.visible=!1,this.img_yinxiaoon.visible=!0,AudioMgr.SOUNDSTOP=!1,AudioMgr.playSound();break;case 1:this.img_yinxiaooff.visible=!0,this.img_yinxiaoon.visible=!1,AudioMgr.pauseSound()}this.slider_Sound.value=0==t?1:0},n.prototype.onYinyue=function(){var t=0;switch(t=this.img_yinyueon.visible?1:0){case 0:this.img_yinyueoff.visible=!1,this.img_yinyueon.visible=!0,AudioMgr.MUSICPAUSE=!1,AudioMgr.resumeMusic();break;case 1:this.img_yinyueoff.visible=!0,this.img_yinyueon.visible=!1,AudioMgr.pauseMusic()}this.slider_Music.value=0==t?1:0},n.prototype.setMusicVolume=function(t){dispatchEvt(new e.HudEvent(e.HudEvent.SET_VOLUME),t),Laya.LocalStorage.setItem("GameVolume",String(t)),this.img_yinyueoff.visible&&0<t&&(this.img_yinyueoff.visible=!1,this.img_yinyueon.visible=!0),this.img_yinyueon.visible&&0==t&&(this.img_yinyueoff.visible=!0,this.img_yinyueon.visible=!1)},n.prototype.setSoundVolume=function(t){dispatchEvt(new e.HudEvent(e.HudEvent.SET_SOUND),t),Laya.LocalStorage.setItem("GameSound",String(t)),this.img_yinxiaooff.visible&&0<t&&(this.img_yinxiaooff.visible=!1,this.img_yinxiaoon.visible=!0),this.img_yinxiaoon.visible&&0==t&&(this.img_yinxiaooff.visible=!0,this.img_yinxiaoon.visible=!1)},n.prototype.onExitGame=function(){common.AlertBox.showAlert({text:LanMgr.getLan("",10528),confirmCb:function(){BingoSDK.exitGame()}})},n.prototype.onSwitchAcc=function(){common.AlertBox.showAlert({text:LanMgr.getLan("",10529),confirmCb:function(){BingoSDK.loginout()}})},n);function n(){return t.call(this)||this}e.TabSysSettingView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.hud.player.TabPlayerInfoUI,__extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.btnChangeName.on(Laya.Event.CLICK,this,this.onChangename),this.btnChangeModel.on(Laya.Event.CLICK,this,this.onChangeModel),this.btnNotice.on(Laya.Event.CLICK,this,this.onGonggao)},n.prototype.close=function(){this.headBox.dataSource=null,tl3d.ModuleEventManager.removeEvent(t.ResEvent.RESOURCE_CHANGE,this.updateExp,this),tl3d.ModuleEventManager.removeEvent(t.HudEvent.SET_NAME,this.updateName,this),tl3d.ModuleEventManager.removeEvent(t.HudEvent.SET_HEAD_ICON,this.updateHead,this)},n.prototype.show=function(){this.initView()},n.prototype.initView=function(){this.updateExp(),this.updateName(),this.updateHead(),this.labAccout.text=App.hero.uid,this.lbQufu.text=window.platform.serverInfo.srv_name,this.lbGuild.text=App.hero.guildName?App.hero.guildName:"无",this.lbLv.text=App.hero.level+"",this.lbForce.value=String(App.hero.force),tl3d.ModuleEventManager.addEvent(t.ResEvent.RESOURCE_CHANGE,this.updateExp,this),tl3d.ModuleEventManager.addEvent(t.HudEvent.SET_NAME,this.updateName,this),tl3d.ModuleEventManager.addEvent(t.HudEvent.SET_HEAD_ICON,this.updateHead,this),tl3d.ModuleEventManager.addEvent(t.HudEvent.SET_HEAD_FRAME,this.updateHead,this)},n.prototype.updateExp=function(){var t=tb.TB_role.get_TB_rolenById(App.hero.level),e=App.hero.exp,i=1;0!=t.exp&&(i=e/t.exp),this.pbExp.value=i,this.lbExp.text=1<=i?LanMgr.getLan("已满级",-1):App.hero.exp+"/"+t.exp},n.prototype.updateName=function(){this.lbName.text=App.hero.name},n.prototype.updateHead=function(){this.headBox.dataSource=new UserHeadVo(App.hero.getHeadId(),App.hero.level,App.hero.headFrame),this.headBox.box_lev.visible=!1},n.prototype.onChangename=function(){UIMgr.showUI(UIConst.Hud_ChangeNameView)},n.prototype.onChangeModel=function(){UIMgr.showUI(UIConst.HeroicModelView)},n.prototype.onGonggao=function(){App.isOpenSvrDay(2)&&!t.GuideManager.isExecuteGuide()?UIMgr.showUI(UIConst.GameNoticeView,{openFlag:!1}):showToast(LanMgr.getLan("",10440))},n);function n(){return e.call(this)||this}t.TabPlayerInfoView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.hud.player.TabCustomerServiceUI,__extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.cbBug.selected=!0,this.cbTips.selected=!1,this.cbBug.on(Laya.Event.CLICK,this,this.onBugSelc),this.cbTips.on(Laya.Event.CLICK,this,this.onTipSelc),this.lbFankui.on(Laya.Event.INPUT,this,this.onLabelChg),this.btn_sure.on(Laya.Event.CLICK,this,this.onFankuiSure)},n.prototype.close=function(){},n.prototype.show=function(){this.initView()},n.prototype.initView=function(){},n.prototype.onBugSelc=function(t){this.cbBug.selected=!0,this.cbTips.selected=!1},n.prototype.onTipSelc=function(t){this.cbBug.selected=!1,this.cbTips.selected=!0},n.prototype.onLabelChg=function(){200<this.lbFankui.text.length&&(showToast(LanMgr.getLan("",10436)),this.lbFankui.text=this.lbFankui.text.slice(0,200))},n.prototype.onFankuiSure=function(){var o=this,t=this.lbFankui.text.trim();if(t&&""!=t)if(3-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.userQuestionNum)<=0)showToast(LanMgr.getLan("",10438));else{var e={};e[Protocol.game_api_userQuestion.args.content]=t,e[Protocol.game_api_userQuestion.args.type]=this.cbBug.selected?1:2,PLC.request(Protocol.game_api_userQuestion,e,function(t,e){if(t){showToast(LanMgr.getLan("",10484)),o.lbFankui.text="";var i=App.hero,n=window.platform.serverInfo;BingoSDK.gameReport("kf",i.playerId,i.accountName,n.serverId,n.srv_name,{level:i.level,vip:i.vip,charge:i.welfare.rechargeSum})}else showToast(LanMgr.getLan("",10439))})}else showToast(LanMgr.getLan("",10437))},n);function n(){return e.call(this)||this}t.TabCustomerServiceView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){function t(){}s.IGodModelVo=t;var e,i=(e=ui.hud.player.TabChangeHeroicModelUI,__extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.listBtn.selectedIndex=-1,this.listBtn.selectHandler=new Handler(this,this.onSelectTab),this.listBtn.renderHandler=new Handler(this,this.onRenderTab),this.listBtn.array=["初始","觉醒","时装"],this.listGod.array=null,this.listGod.selectedIndex=-1,this.listGod.selectHandler=new Handler(this,this.onSelectGod),this.listGod.renderHandler=new Handler(this,this.onRenderGod),this._uiScene=new Base2dSceneLayer,this.boxRole.addChild(this._uiScene),this._uiScene.setModelBox(this,this.lbName,this.boxRole),this.btnSure.on(Laya.Event.CLICK,this,this.onSure)},n.prototype.close=function(){this.listBtn.selectedIndex=-1,this.listGod.selectedIndex=-1,this.listGod.array=null,this._curSelectVo=null,Laya.timer.clearAll(this),this._uiScene.onExit()},n.prototype.show=function(){this.initView()},n.prototype.initView=function(){if(!this._isInit){this._isInit=!0,this._originList=[],this._awakenList=[],this._skinList=[];for(var t=0,e=tb.TB_god.get_TB_god();t<e.length;t++)for(var i=e[t],n=0,o=i.getSkinList();n<o.length;n++){var a=o[n];a.skinId==s.GodSkinType.origin?this._originList.push({tbGod:i,skinVo:a}):a.skinId==s.GodSkinType.awaken?i.isCanAwaken()&&this._awakenList.push({tbGod:i,skinVo:a}):a.isSpecialSkin()&&this._skinList.push({tbGod:i,skinVo:a})}}this._originList.forEach(function(t,e){t.sortNum=s.GodUtils.isActiveGod(t.tbGod.ID)?t.tbGod.ID-1e6:t.tbGod.ID}),this._originList.sort(function(t,e){return t.sortNum-e.sortNum}),this._awakenList.forEach(function(t,e){var i=-1!=App.hero.godAwakens.indexOf(t.tbGod.ID);t.sortNum=i?t.tbGod.ID-1e6:t.tbGod.ID}),this._awakenList.sort(function(t,e){return t.sortNum-e.sortNum}),this._skinList.forEach(function(t,e){var i=t.skinVo.isActivity(0,!1)||t.skinVo.isCanActivity();t.sortNum=i?t.tbGod.ID-1e6:t.tbGod.ID}),this._skinList.sort(function(t,e){return t.sortNum-e.sortNum}),this._uiScene.onShow();var r=App.hero.showSkinId==s.GodSkinType.origin?0:App.hero.showSkinId==s.GodSkinType.awaken?1:2;this.listBtn.selectedIndex=r},n.prototype.onSelectTab=function(t){if(!(t<0)){var e=0==t?this._originList:1==t?this._awakenList:this._skinList;if(this.listGod.array=e,this.listGod.selectedIndex=-1,!this._curSelectVo){var i=e.findIndex(function(t){return t.tbGod.ID==App.hero.showGodId&&t.skinVo.skinId==App.hero.showSkinId});i=i<0?0:i,this._curSelectVo=e[i],this.listGod.selectedIndex=i}}},n.prototype.onRenderTab=function(t,e){t.dataSource&&(t.label=t.dataSource,t.skin=this.listBtn.selectedIndex==e?SkinUtil.fenye_down:SkinUtil.fenye_up,t.labelSize=this.listBtn.selectedIndex==e?24:22,t.labelColors=this.listBtn.selectedIndex==e?"#7e5336,#7e5336,#7e5336":"#e6ca91,#e6ca91,#e6ca91",t.labelBold=!0)},n.prototype.onSelectGod=function(t){if(!(t<0)){var e=this.listGod.array[t];if(e){var i=(this._curSelectVo=e).tbGod,n=e.skinVo;this.lbName.text=n.getTitle(),this.lbUnlock.text=n.getCondition(!1);var o=-1!=App.hero.godAwakens.indexOf(i.ID),a=n.isActivity(o?tb.TB_god_set.get_TB_god_set().awake_section:0,!1);this.lbUnlock.color=a?ColorConst.GREEN:ColorConst.RED,this.btnSure.gray=!a,this.btnSure.label=a?"更 换":"未获得",this._uiScene.onShow(),Laya.timer.once(300,this,this.delayShow,[n.getModelId()])}}},n.prototype.onRenderGod=function(t,e){var i=t.dataSource;if(i){var n=i.tbGod,o=i.skinVo,a=t.getChildByName("imgSelected"),r=t.getChildByName("imgIcon"),s=t.getChildByName("imgZhezhao"),u=t.getChildByName("imgDi"),h=t.getChildByName("imgGou"),l=t.getChildByName("lbDi"),c=t.getChildByName("lbName");a.visible=i==this._curSelectVo,s.visible=h.visible=n.ID==App.hero.showGodId&&o.skinId==App.hero.showSkinId,r.skin=SkinUtil.getHeroIcon(n.ID),c.text=o.getName2();var p=-1!=App.hero.godAwakens.indexOf(n.ID),d=o.isActivity(p?tb.TB_god_set.get_TB_god_set().awake_section:0,!1);u.gray=r.gray=l.gray=c.gray=!d,r.mask||UIUtil.createHeadMask(r,r.width/2),s.mask||UIUtil.createHeadMask(s,s.width/2)}},n.prototype.onSure=function(){var i=this;if(this._curSelectVo){var t=this._curSelectVo.tbGod,e=this._curSelectVo.skinVo,n=-1!=App.hero.godAwakens.indexOf(t.ID),o=e.isActivity(n?tb.TB_god_set.get_TB_god_set().awake_section:0,!1);if(App.hero.showGodId!=t.ID||e.skinId!=App.hero.showSkinId)if(o){var a={};a[Protocol.game_common_setPlayerShow.args.godId]=t.ID,a[Protocol.game_common_setPlayerShow.args.skinId]=e.skinId,PLC.request(Protocol.game_common_setPlayerShow,a,function(t,e){t&&(showToast(LanMgr.getLan("",10435)),App.hero.showGodId=Number(t.showGodId),App.hero.showSkinId=Number(t.showSkinId),i.listGod.refresh(),dispatchEvt(new s.HudEvent(s.HudEvent.SET_SHOW_GOD_MODEL)))})}else showToast(LanMgr.getLan("",10434));else showToast(LanMgr.getLan("",10433))}},n.prototype.delayShow=function(t){var e=this.boxRole.localToGlobal(new Laya.Point(0,0));this._uiScene.addModelChar(t,e.x+this.boxRole.width/2-Launch.offsetX,e.y-Launch.offsetY,180,2.7)},n);function n(){return e.call(this)||this}s.TabChangeModelView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var e,t=(e=ui.hud.player.TabChangeHeadUI,__extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.listIcon.mouseHandler=new Handler(this,this.onSelect),this.listIcon.renderHandler=new Handler(this,this.onRender),this.btnChange.on(Laya.Event.CLICK,this,this.sure)},i.prototype.close=function(){this.listIcon.array=null},i.prototype.show=function(){this.initView()},i.prototype.initView=function(){var i,n=[],o=[],t=TableData.getInstance().getTableByName(TableData.tb_god).data;for(var e in t)t[e]&&o.push(t[e]);function a(e){var t=!(App.hero.godAlbum.some(function(t){return t==o[e].ID})||o[e].ID==common.GlobalData.DEFAULT_HEAD);i=new s.HeadIconVo(o[e].ID,o[e],t),n.push(i)}for(var r=0;r<o.length;r++)a(r);n.sort(function(t,e){return t.isLock&&e.isLock?t.headId-e.headId:t.isLock?1:e.isLock?-1:t.headId-e.headId}),this._selectIndex=n.findIndex(function(t){return t.headId==App.hero.getHeadId()}),this._selectIndex=this._selectIndex<0?0:this._selectIndex,this.listIcon.array=n,this.listIcon.selectedIndex=this._selectIndex},i.prototype.onSelect=function(t,e){if(!(e<0)&&t.type==Laya.Event.CLICK){if(this.listIcon.array[e].isLock)return showToast(LanMgr.getLan("",10430,this.listIcon.array[e].name)),void(this.listIcon.selectedIndex=this._selectIndex);this._selectIndex=this.listIcon.selectedIndex}},i.prototype.sure=function(){var i=this,t=this.listIcon.array[this.listIcon.selectedIndex];if(!t.isLock){var e=t.headId;if(e!=App.hero.getHeadId()){var n={};n[Protocol.game_common_setPlayerHead.args.headId]=e,PLC.request(Protocol.game_common_setPlayerHead,n,function(t,e){t&&(showToast(LanMgr.getLan("",10432)),App.hero.setHeadId(t.head),dispatchEvt(new s.HudEvent(s.HudEvent.SET_HEAD_ICON)),i.listIcon.refresh())})}else showToast(LanMgr.getLan("",10431))}},i.prototype.onRender=function(t,e){var i=t.dataSource;if(i){t.img_selected.visible=e==this.listIcon.selectedIndex;var n=t.box_icon,o=t.img_icon;t.img_zz.visible=i.headId==App.hero.getHeadId(),t.img_gou.visible=i.headId==App.hero.getHeadId(),i&&(o.skin=i.headIcon,t.gray=i.isLock),n.mask||UIUtil.createHeadMask(n,n.width/2)}},i);function i(){var t=e.call(this)||this;return t._selectIndex=0,t}s.TabChangeHeadView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.hud.player.TabChangeHeadBoxUI,__extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.listIcon.mouseHandler=new Handler(this,this.onSelect),this.listIcon.renderHandler=new Handler(this,this.onRender),this.btnChange.on(Laya.Event.CLICK,this,this.sure)},i.prototype.close=function(){this.listIcon.array=null},i.prototype.show=function(){this.initView()},i.prototype.initView=function(){this.listIcon.array=null;var t=tb.TB_picture_frame.getList();this._selectIndex=t.findIndex(function(t){return t.ID==App.hero.headFrame}),t.sort(function(t,e){var i=t.isLock(),n=e.isLock();return i&&n?t.rank-e.rank:i?1:n?-1:t.rank-e.rank}),this.listIcon.array=t,this.listIcon.selectedIndex=this._selectIndex},i.prototype.onSelect=function(t,e){if(!(e<0)&&t.type==Laya.Event.CLICK){var i=this.listIcon.array[e];if(i.isLock())return showToast(i.desc),void(this.listIcon.selectedIndex=this._selectIndex);this._selectIndex=this.listIcon.selectedIndex}},i.prototype.sure=function(){var i=this,t=this.listIcon.array[this.listIcon.selectedIndex];if(t&&!t.isLock()){var e=t.ID;if(e!=App.hero.headFrame){var n={};n[Protocol.game_common_setPlayerHeadFrame.args.id]=e,PLC.request(Protocol.game_common_setPlayerHeadFrame,n,function(t,e){t&&(showToast(LanMgr.getLan("",10429)),App.hero.headFrame=t.headFrame||0,i.listIcon.refresh(),dispatchEvt(new o.HudEvent(o.HudEvent.SET_HEAD_FRAME)))})}else showToast(LanMgr.getLan("",10428))}},i.prototype.onRender=function(t,e){var i=t.dataSource;if(i){var n=t.getChildByName("imgFrame"),o=t.getChildByName("imgSelected"),a=t.getChildByName("imgGou");t.getChildByName("lbName").text=i.name,n.visible=0<i.ID,n.skin=0<i.ID?SkinUtil.getHeadFrame(i.ID):"",o.visible=e==this.listIcon.selectedIndex,a.visible=i.ID==App.hero.headFrame,t.gray=i.isLock()}},i);function i(){return t.call(this)||this}o.TabChangeHeadBoxView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.hud.player.PlayerDetailsUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.PlayerDetailsView,closeOnSide:this.isModelClose,title:"玩家信息"},this._curIndex=-1,this.tabBar.selectedIndex=-1,this.tabBar.selectHandler=new Handler(this,this.onSelect),this.btn_gm.on(Laya.Event.CLICK,this,this.onGm),this.btn_vconsole.on(Laya.Event.CLICK,this,this.onConsole),this.btn_stats.on(Laya.Event.CLICK,this,this.onStats),this.btn_debug.on(Laya.Event.CLICK,this,this.onDebugPanel),this.btn_loglevel.on(Laya.Event.CLICK,this,this.onLogLve),Laya.Browser.onMiniGame||(this.btn_vconsole.visible=!0)},e.prototype.onClosed=function(){n.prototype.onClosed.call(this);var t=this.getView(this._curIndex);t&&(t.close(),t.visible=!1),this._curIndex=-1,this.tabBar.selectedIndex=-1},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){this.setLogBtn();var t=!1;ExtConfig.RELEASE&&"1"!=BingoSDK.platparam.pid||(t=this.btn_gm.visible=!0),ExtConfig.RELEASE?e.debugLock||(this.btn_stats.visible=!0,this.btn_debug.visible=!0,t=this.btn_loglevel.visible=!0):(this.btn_gm.visible=!0,this.btn_stats.visible=!0,this.btn_debug.visible=!0,t=this.btn_loglevel.visible=!0),this.height=t?640:580,this.tabBar.selectedIndex=0},e.prototype.onSelect=function(t){if(-1!=t){var e=this.getView(this._curIndex);e&&(e.close(),e.visible=!1),this._curIndex=t;var i=this.getView(this._curIndex);i&&(i.show(),i.visible=!0)}},e.prototype.getView=function(t){var e;switch(t){case 0:this._tabPlayerView||(this._tabPlayerView=new i.TabPlayerInfoView,this._tabPlayerView.centerX=0,this.boxContent.addChild(this._tabPlayerView)),e=this._tabPlayerView;break;case 1:this._tabSysView||(this._tabSysView=new i.TabSysSettingView,this._tabSysView.centerX=0,this.boxContent.addChild(this._tabSysView)),e=this._tabSysView;break;case 2:this._tabKefuView||(this._tabKefuView=new i.TabCustomerServiceView,this._tabKefuView.centerX=0,this.boxContent.addChild(this._tabKefuView)),e=this._tabKefuView}return e},e.prototype.onGm=function(t){dispatchEvt(new i.HudEvent(i.HudEvent.SHOW_GM_PANEL))},e.prototype.onLogLve=function(t){var e=this.KeyLog.indexOf(ExtConfig.LOG_LEVEL);ExtConfig.LOG_LEVEL=this.KeyLog[++e%this.KeyLog.length],this.setLogBtn()},e.prototype.setLogBtn=function(){this.btn_loglevel.label="loglev("+ExtConfig.LOG_LEVEL+")"},e.prototype.onDebugPanel=function(){laya.debug.DebugTool.init()},e.prototype.onConsole=function(){this._cstats?this._console.hideSwitch():(this._console||(this._console=new VConsole),this._console.showSwitch(),logdebug("Browser:",Browser.width,Browser.height,Browser.clientWidth,Browser.clientHeight,Browser.pixelRatio),logdebug("window:",window.innerWidth,window.innerHeight,window.outerWidth,window.outerHeight,window.devicePixelRatio),logdebug("screen:",screen.width,screen.height,screen.availWidth,screen.availHeight,screen.pixelDepth),logdebug("real scene_height",Browser.clientHeight*Browser.pixelRatio)),this._cstats=!this._cstats},e.prototype.onStats=function(){this._stats?Laya.Stat.hide():Laya.Stat.show(0,0),this._stats=!this._stats},e.gmLock=!0,e.debugLock=!0,e);function e(){var t=n.call(this)||this;return t._curIndex=-1,t.KeyLog=[1,2,3,5,6,123,998,999],t}i.PlayerDetailsView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.hud.player.ChangeNameUI,__extends(i,e),i.prototype.popup=function(){e.prototype.popup.call(this)},i.prototype.onChange=function(){var i=this;if(this.textInput.text&&""!=this.textInput.text)if(App.hero.diamond<tb.TB_game_set.get_TB_game_setById(1).modify_name_cost[1])showToast(LanMgr.getLan("",10130));else if(this.lengthCount())showToast(LanMgr.getLan("",10068));else if(this.haveBlockWord())showToast(LanMgr.getLan("",10132));else{var t={};t[Protocol.game_common_changePlayerName.args.newName]=this.textInput.text,PLC.request(Protocol.game_common_changePlayerName,t,function(t,e){t&&(App.hero.name=t.name,dispatchEvt(new n.HudEvent(n.HudEvent.SET_NAME)),i.close())})}else showToast(LanMgr.getLan("",10129))},i.prototype.lengthCount=function(){for(var t=0,e=this.textInput.text,i=0;i<e.length;i++){var n=e.charCodeAt(i);1<=n&&n<=126||65376<=n&&n<=65439?t++:t+=2}return 12<t},i.prototype.haveBlockWord=function(){return!1},i.prototype.close=function(){e.prototype.close.call(this),this.textInput.text=""},i);function i(){var t=e.call(this)||this;return t.isModelClose=!0,t.btn_queding.on(Laya.Event.CLICK,t,t.onChange),t.lab_diamonds.text=tb.TB_game_set.get_TB_game_setById(1).modify_name_cost[1].toString(),t.bgPanel.dataSource={uiName:UIConst.Hud_ChangeNameView,closeOnSide:t.isModelClose,title:"修改昵称"},t}n.HudChangeNameView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.hud.player.HeroicModelMainUI,__extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.HeroicModelView,closeOnSide:this.isModelClose,title:"英雄形象"},this._curIndex=-1,this.tabBar.selectedIndex=-1,this.tabBar.selectHandler=new Handler(this,this.onSelect),this.addChild(this.bgPanel.btnClose)},n.prototype.close=function(){e.prototype.close.call(this);var t=this.getView(this._curIndex);t&&(t.close(),t.visible=!1),this._curIndex=-1,this.tabBar.selectedIndex=-1},n.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},n.prototype.initView=function(){this.tabBar.selectedIndex=0},n.prototype.onSelect=function(t){if(-1!=t){var e=this.getView(this._curIndex);e&&(e.close(),e.visible=!1),this._curIndex=t;var i=this.getView(this._curIndex);i&&(i.show(),i.visible=!0);var n=0==t?"英雄形象设置":1==t?"头像设置":"头像框设置";this.bgPanel.updateTitle(n)}},n.prototype.getView=function(t){var e;switch(t){case 0:this._tabModelView||(this._tabModelView=new i.TabChangeModelView,this._tabModelView.centerX=0,this.boxContent.addChild(this._tabModelView)),e=this._tabModelView;break;case 1:this._tabHeadView||(this._tabHeadView=new i.TabChangeHeadView,this._tabHeadView.centerX=0,this.boxContent.addChild(this._tabHeadView)),e=this._tabHeadView;break;case 2:this._tabHeadBoxView||(this._tabHeadBoxView=new i.TabChangeHeadBoxView,this._tabHeadBoxView.centerX=0,this.boxContent.addChild(this._tabHeadBoxView)),e=this._tabHeadBoxView}return e},n);function n(){return e.call(this)||this}i.HeroicModelView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.hud.view.LoginNoticeUI,__extends(n,e),n.prototype.init=function(){this._chatNotice=new common.Accordion(600,800),this._chatNotice.itemRender=t.LoginNoticeIR,this.addChild(this._chatNotice),this._chatNotice.spaceY=10,this._chatNotice.x=25,this._chatNotice.y=125,this.btnKnow.on(Laya.Event.CLICK,this,this.close),this.bgPanel.dataSource={uiName:UIConst.LoginNoticeView,closeOnSide:this.isModelClose,closeOnButton:!0,title:"公 告"},this.checkbox.on(Laya.Event.CHANGE,this,this.onChange)},n.prototype.popup=function(){e.prototype.popup.call(this),this._chatNotice.dataSource=this.dataSource,this.checkbox.selected="1"==Laya.LocalStorage.getItem(App.LOGIN_NOTICE_CHECKBOX)},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this._chatNotice.dataSource=[]},n.prototype.onChange=function(){var t=this.checkbox.selected;Laya.LocalStorage.setItem(App.LOGIN_NOTICE_CHECKBOX,t?"1":"0")},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t.init(),t}t.LoginNoticeView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.hud.render.LoginNoticeIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){t&&((this._dataSource=t).isfirst?this.onShow():this.onHide(),this.refresh())},enumerable:!0,configurable:!0}),n.prototype.refresh=function(t){this.dataSource&&(this.lab_title.text=this.dataSource.title)},n.prototype.onShow=function(){var t=this.dataSource;this.btnArrow.scaleY=.8,this.boxContent.visible=!0,this.lab_content.text=t?t.content:"",this.lab_content.event(Laya.Event.RESIZE),this.boxContent.height=this.lab_content.y+this.lab_content.height+30,this.height=this.boxContent.y+this.boxContent.height},n.prototype.onHide=function(){this.btnArrow.scaleY=-.8,this.boxContent.visible=!1,this.height=60},n.prototype.isShow=function(){return.8==this.btnArrow.scaleY},n.prototype.onClick=function(){dispatchEvt(new common.TreeEvent(common.TreeEvent.SELECT_TAB,this))},n);function n(){var t=e.call(this)||this;return t.boxContent.visible=!1,t.lab_content.autoSize=!0,t.img_bg.on(Laya.Event.CLICK,t,t.onClick),t}t.LoginNoticeIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(t){var n=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.addNoticeToPush=function(t){var e=0==this._noticeAry.length;this._noticeAry.push(t),e&&this.showNotice()},e.prototype.addCustomNotice=function(t){var e=new r([-1,t]);this.addNoticeToPush(e)},e.prototype.startNext=function(){this._noticeAry.shift(),this.showNotice()},e.prototype.showNotice=function(){if(0!=this._noticeAry.length){var t=this._noticeAry[0].getText();t&&(UIMgr.hasStage(UIConst.ChatNoticeEffect)?UIMgr.getUIByName(UIConst.ChatNoticeEffect).startAction(t):UIMgr.showUI(UIConst.ChatNoticeEffect,t))}else UIMgr.getUIByName(UIConst.ChatNoticeEffect).removeSelf()},e.prototype.getNoticeText=function(t,e){void 0===e&&(e=!1);var i=t.shift(),n=t,o=tb.TB_notice.get_TB_notice_ById(i);if(o&&o.par_click){var a=void 0,r=void 0,s=void 0,u=void 0;for(var h in n){var l=o.getType(Number(h));switch(l){case NoticeParamType.god:case NoticeParamType.rarityGod:u=n[h],s=(r=tb.TB_god.get_TB_godById(parseInt(u)))?r.name:"",r&&e?(a={type:l,id:u,num:n[o.getIndex(NoticeParamType.godStar)]||1},n[h]="<span href='"+JSON.stringify(a)+"'>"+s+"</span>"):n[h]=s;break;case NoticeParamType.item:var c=n[h],p=tb.TB_item.get_TB_itemById(parseInt(c)),d=p?p.name:"";if(p&&e){var _=n[o.getIndex(NoticeParamType.itemCnt)];a={type:l,id:c,num:_||1},n[h]="<span href='"+JSON.stringify(a)+"'>"+d+"</span>"}else n[h]=d;break;case NoticeParamType.guildHelpItem:for(var f=n[h],g="",y=0,m=f.length;y<m;y++){var v=f[y][0],b=tb.TB_guild_help.getItemnById(parseInt(v));b&&(g+=b.desc+"x"+f[y][1]+(y<m-1?"，":""))}n[h]=g;break;case NoticeParamType.gloryId:var I=n[h],T=tb.TB_honour_reward.getItemById(parseInt(I));n[h]=T?T.desc:"未知";break;case NoticeParamType.joinGuildState:var w=Number(n[h])==iface.tb_prop.guildAutoJoinTypeKey.yes;n[h]=w?"加入":"申请";break;case NoticeParamType.joinGuild:a={type:l,guildId:n[h],guildName:n[1]||""},n[h]=e?'<span style="color:#f66227;" href=\''+JSON.stringify(a)+"'>我要加入</span>":'<span style="color:#f66227;">我要加入</span>';break;case NoticeParamType.joinTeamGroup:a={type:l,teamGroupId:n[h]},n[h]=e?'<span style="color:#f66227;" href=\''+JSON.stringify(a)+"'>点击加入</span>":'<span style="color:#f66227;">点击加入</span>'}}}return o?FormatStr(o.content,n).replace(/[\\]/gi,""):""},e);function e(){this._noticeAry=new Array}t.ChatNoticeMgr=n;var i,o=(__extends(a,i=DialogExt),a.prototype.isHideBg=function(){this._imgBg.skin&&(this._imgBg.skin=null)},a.prototype.isShowbg=function(){this._imgBg.skin||(this._imgBg.skin=SkinUtil.chatnotice)},a.prototype.startAction=function(t){this._htmlText.y=this._imgBg.y-12,this._htmlText.innerHTML=t,this._htmlText.x=this._imgBg.x+this._initPosX;var e=this._htmlText.width+this._imgBg.width;this._endPosX=this._initPosX-e,0!=t.length?this.isShowbg():this.isHideBg();var i=e/110;Laya.Tween.to(this._htmlText,{x:this._endPosX},1e3*i,null,Handler.create(this,function(){n.getInstance().startNext()}))},a.prototype.show=function(){i.prototype.show.call(this,!1,!1),this.startAction(this.dataSource)},a);function a(){var t=i.call(this)||this;return t._htmlText=new Laya.HTMLDivElement,t._imgBg=new Laya.Image(SkinUtil.chatnotice),t.close=null,t.isIgnore=!0,t._imgBg.width=Laya.stage.width,t._imgBg.height=50,t._imgBg.anchorX=.5,t._imgBg.anchorY=.5,t.addChild(t._imgBg),t._imgBg.x=Laya.stage.width/2,t._imgBg.top=80,t._imgBg.alpha=.5,t._htmlText.style.fontSize=27,t.addChild(t._htmlText),t._htmlText.style.color="#ffffff",t._htmlText.style.align="center",t._htmlText.style.wordWrap=!1,t._htmlText.style.valign="center",t._initPosX=t._imgBg.x+t._imgBg.width/2,t._endPosX=t._initPosX-t._imgBg.width-1.2*t._htmlText.width,t.popupCenter=!1,t.mouseEnabled=!1,t._imgBg.sizeGrid="5,5,5,5",t}t.ChatNoticeEffect=o;var r=(s.prototype.getText=function(){return-1==this.ID?this.data[0]:n.getInstance().getNoticeText(__spreadArrays([this.ID],this.data),!1)},s);function s(t){this.ID=t.shift(),this.data=t}t.NoticeVo=r}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(d){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"HudProcessor"},i.prototype.listenModuleEvents=function(){return[new d.HudEvent(d.HudEvent.UPDATE_CHATNOTICE_TEXT),new d.HudEvent(d.HudEvent.SHOW_CHATNOTICE_PANEL),new d.HudEvent(d.HudEvent.UPDATE_EXP_AND_MONEY),new d.HudEvent(d.HudEvent.SHOW_MODULE_VIEW),new d.HudEvent(d.HudEvent.SHOW_GM_PANEL),new d.HudEvent(d.HudEvent.SET_NAME),new d.HudEvent(d.HudEvent.SET_HEAD_ICON),new d.HudEvent(d.HudEvent.SET_HEAD_FRAME),new d.HudEvent(d.HudEvent.SHOW_PLAYER_INFO_VIEW),new d.HudEvent(d.HudEvent.QIECUO_BACK),new d.HudEvent(d.HudEvent.SHOW_PLAYER_LINEUP_VIEW),new d.HudEvent(d.HudEvent.SET_VOLUME),new d.HudEvent(d.HudEvent.SET_SOUND),new d.HudEvent(d.HudEvent.UPDATE_POWER),new d.HudEvent(d.HudEvent.RETURN_LASTVIEW),new d.HudEvent(d.HudEvent.SHOW_ENTRANCE_VIEW),new d.GuajiEvent(d.GuajiEvent.LINGQU_GUAJI_JIANGLI),new d.GuajiEvent(d.GuajiEvent.UPDATE_FUWEN_COPY_INFO),new common.GlobalEvent(common.GlobalEvent.DIALOG_OPENED),new common.GlobalEvent(common.GlobalEvent.DIALOG_CLOSED),new d.ResEvent(d.ResEvent.RESOURCE_CHANGE),new d.ResEvent(d.ResEvent.ROLE_LEVEL_CHANGE),new d.HuodongEvent(d.TopUpEvent.CHONGZHI_SUCCESS)]},i.prototype.receivedModuleEvent=function(t){var e=this;if(t instanceof d.HudEvent)switch(t.type){case d.HudEvent.UPDATE_CHATNOTICE_TEXT:this.updateChatNoticeText();break;case d.HudEvent.SHOW_MODULE_VIEW:this.showModuleView(t.data);break;case d.HudEvent.SHOW_GM_PANEL:this.showGmPanel();break;case d.HudEvent.UPDATE_EXP_AND_MONEY:this.update_exp_and_money();break;case d.HudEvent.SET_NAME:this.setNewName();break;case d.HudEvent.SET_HEAD_ICON:this.setNewHeadIcon();break;case d.HudEvent.SET_HEAD_FRAME:this.setHeadFrame();break;case d.HudEvent.SHOW_PLAYER_INFO_VIEW:this.showPlayerInfo(t.data);break;case d.HudEvent.QIECUO_BACK:this.qiecuoBack(t.data);break;case d.HudEvent.SHOW_PLAYER_LINEUP_VIEW:this.showPlayerLineup(t.data);break;case d.HudEvent.UPDATE_POWER:Laya.timer.frameOnce(3,this,function(){e.updatePower()});break;case d.HudEvent.SET_VOLUME:SoundManager.setMusicVolume(t.data/100);break;case d.HudEvent.SET_SOUND:SoundManager.setSoundVolume(t.data/100);break;case d.HudEvent.RETURN_LASTVIEW:this.returnLastView(t.data);break;case d.HudEvent.SHOW_ENTRANCE_VIEW:this.showEntranceView(t.data)}else if(t instanceof d.ResEvent)switch(t.type){case d.ResEvent.RESOURCE_CHANGE:logdebug("hud中收到货币变化"),this.changeRes();break;case d.ResEvent.ROLE_LEVEL_CHANGE:UIMgr.hasStage(UIConst.Main3DView)&&UIMgr.getUIByName(UIConst.Main3DView).updateBtnType()}else if(t instanceof common.GlobalEvent)switch(t.type){case common.GlobalEvent.DIALOG_OPENED:this.dialogOnOpened(t);break;case common.GlobalEvent.DIALOG_CLOSED:this.dialogOnClosed(t.data)}else if(t instanceof d.GuajiEvent)switch(t.type){case d.GuajiEvent.LINGQU_GUAJI_JIANGLI:this.showReardEffect();break;case d.GuajiEvent.UPDATE_FUWEN_COPY_INFO:this.updateCopyInfo()}else if(t instanceof d.HuodongEvent)switch(t.type){case d.TopUpEvent.CHONGZHI_SUCCESS:UIMgr.hasStage(UIConst.Main3DView)&&UIMgr.getUIByName(UIConst.Main3DView).updateBtnType()}},i.prototype.dialogOnOpened=function(t){var e=t.data;e&&UIMgr.hasStage(UIConst.HudView)&&UIMgr.getUIByName(UIConst.HudView).onDialogOnOpened(e)},i.prototype.dialogOnClosed=function(t){t&&UIMgr.hasStage(UIConst.HudView)&&UIMgr.getUIByName(UIConst.HudView).onDialogOnClosed(t)},i.prototype.updatePower=function(){this.hudView&&this.hudView.updatePower()},i.prototype.showReardEffect=function(){var o=this;App.hero.getEqusNum()>=tb.TB_game_set.get_TB_game_setById(1).limit_equip?showToast(LanMgr.getLan("",10426)):PLC.request(Protocol.game_copy_getMainAfkAward,{},function(t){if(t){var e=App.hero.lastGetAfkTime,i=App.serverTimeSecond-e;if(Laya.timer.once(i<300?200:800,o,function(){UIMgr.showUI(UIConst.Guaji_ShouyiView,{lastTime:e,data:t})}),App.hero.updateGuajiData(t),UIMgr.hasStage(UIConst.GuajiView)){var n=UIMgr.getUIByName(UIConst.GuajiView);n.bottomUI.afterRewardSucc(),n.bottomUI.updateInterval()}dispatchEvt(new d.GuajiEvent(d.GuajiEvent.LINGQU_GUAJI_JIANGLI_SUCC))}})},i.prototype.updateCopyInfo=function(){var t=UIMgr.getUIByName(UIConst.HudView);t&&t.updateShenjieRedpt()},i.prototype.updateChatNoticeText=function(){PLC.request(Protocol.chat_notice_getNewslist,null,function(t,e){if(t&&t.newsList)for(var i=t.newsList.length-1;0<=i;i--)d.ChatNoticeMgr.getInstance().addNoticeToPush(new d.NoticeVo(t.newsList[i]))},!1)},i.prototype.changeRes=function(){this.hudView&&this.hudView.initView()},i.prototype.setNewName=function(){UIMgr.hasStage(UIConst.HudView)&&this.hudView.setName()},i.prototype.setNewHeadIcon=function(){UIMgr.hasStage(UIConst.HudView)&&this.hudView.setHead()},i.prototype.setHeadFrame=function(){UIMgr.hasStage(UIConst.HudView)&&this.hudView.setHeadFrame()},i.prototype.showEntranceView=function(t){switch(t){case tb.TB_function.TYPE_LILIAN:UIMgr.showUI(UIConst.EntranceList,t);break;case tb.TB_function.TYPE_MAOXIAN:UIMgr.showUI(UIConst.EntranceList_lilian,t);break;case tb.TB_function.TYPE_JINGJI:UIMgr.showUI(UIConst.EntranceList_jingji,t);break;case tb.TB_function.TYPE_KUAFU:UIMgr.showUI(UIConst.EntranceList_kaufu,t)}},i.prototype.update_exp_and_money=function(){this.changeRes()},i.prototype.showModuleView=function(t){if(t&&Array.isArray(t)&&!(t.length<1)){var e=t[0],i=t[1],n=t[2],o=tb.TB_sys_open.get_TB_sys_openById(parseInt(e));if(!o||App.IsSysOpen(o.ID)){if(UIMgr.hasStage(UIConst.TaskView)){if(e==ModuleConst.DAILY)return void UIMgr.getUIByName(UIConst.TaskView).onSelectTab(d.TaskTabType.daily);UIMgr.hideUIByName(UIConst.TaskView)}switch(parseInt(e)!=ModuleConst.MAIN&&UIMgr.hasStage(UIConst.TimeLimitView)&&UIMgr.hideUIByName(UIConst.TimeLimitView),UIMgr.hasStage(UIConst.BianQiangView)&&UIMgr.hideUIByName(UIConst.BianQiangView),UIMgr.hasStage(UIConst.UpRoadView)&&UIMgr.hideUIByName(UIConst.UpRoadView),UIMgr.hasStage(UIConst.SevendaysView)&&UIMgr.hideUIByName(UIConst.SevendaysView),parseInt(e)){case ModuleConst.MAIN:this.showHudMenuView(ModuleConst.MAIN);break;case ModuleConst.FIGHT:this.showHudMenuView(ModuleConst.FIGHT);break;case ModuleConst.SHENLING:this.showHudMenuView(ModuleConst.SHENLING,[ShenlingTabType.info]),isNaN(i)||1!=Number(i)||dispatchEvt(new d.GodEvent(d.GodEvent.SHOW_BUZHEN_PANEL),iface.tb_prop.lineupTypeKey.attack);break;case ModuleConst.RONGHUN:this.showHudMenuView(ModuleConst.SHENLING,[ShenlingTabType.ronghun]);break;case ModuleConst.JUEXING:this.showHudMenuView(ModuleConst.SHENLING,[ShenlingTabType.awaken]);break;case ModuleConst.SHENGXING:this.showHudMenuView(ModuleConst.SHENLING,[ShenlingTabType.shengxin]);break;case ModuleConst.EQUIPMENT:case ModuleConst.EQUIP_STRENGTH:this.showHudMenuView(ModuleConst.EQUIPMENT,[EquipTabType.strength]);break;case ModuleConst.EQUIP_JINGLIAN:this.showHudMenuView(ModuleConst.EQUIPMENT,[EquipTabType.refine]);break;case ModuleConst.EQUIP_BAOSHI:this.showHudMenuView(ModuleConst.EQUIPMENT,[EquipTabType.baoshi]),1==n&&UIMgr.showUI(UIConst.GemstoneCompoundView);break;case ModuleConst.FUWEN:this.showHudMenuView(ModuleConst.FIGHT);var a=UIMgr.getUIByName(UIConst.GuajiView);if(a&&!d.GuideManager.isExecuteGuide()&&a.showBossTips(),i){var r=d.GuajiModel.getInstance(),s=tb.TB_copy_info.get_TB_copy_infoById(i)?tb.TB_copy_info.get_TB_copy_infoById(i).area:0;if(!r.isUnlockCapter(s))return void showToast(LanMgr.getLan("",10427));var u=Number(i);if(r.isCanChallenge(u))UIMgr.showUI(UIConst.GuanqiaView,r.getGuanqiaById(u));else{var h=r.getCanChallengeMaxCopy();h&&UIMgr.showUI(UIConst.GuanqiaView,r.getGuanqiaById(h.ID))}}break;case ModuleConst.ARTIFACT:case ModuleConst.ARTIFACT_BAPTIZE:case ModuleConst.ARTIFACT_ENCHANT:var l=[];i&&(l[0]=parseInt(i)),n&&(l[1]=parseInt(n)),this.showHudMenuView(parseInt(e),l);break;case ModuleConst.BEIBAO:i=isNaN(i)?1:Number(i),dispatchEvt(new d.BagEvent(d.BagEvent.SHOW_BAG_PANEL),i);break;case ModuleConst.EQUIP_FENJIE:this.showHudMenuView(ModuleConst.BEIBAO,[4]),dispatchEvt(new d.BagEvent(d.BagEvent.OPEN_SELL_VIEW));break;case ModuleConst.JINGJI:dispatchEvt(new d.ArenaEvent(d.ArenaEvent.SHOW_ARENA_PANEL));break;case ModuleConst.MATCH_FIGHT:dispatchEvt(new d.ArenaEvent(d.ArenaEvent.SHOW_MATCH_PANEL));break;case ModuleConst.FAST_FIGHT:dispatchEvt(new d.GuajiEvent(d.GuajiEvent.SHOW_FAST_BATTLE));break;case ModuleConst.FRIEND:dispatchEvt(new d.FriendEvent(d.FriendEvent.SHOW_FRIEND_PANEL));break;case ModuleConst.HONOR:dispatchEvt(new d.TaskEvent(d.TaskEvent.SHOW_TASK_VIEW,i));break;case ModuleConst.SHOUCHONG:UIMgr.showUI(UIConst.Main3DView),dispatchEvt(new d.TopUpEvent(d.TopUpEvent.SHOW_SHOUCHONG_PANEL));break;case ModuleConst.JISHI:dispatchEvt(new d.ShopEvent(d.ShopEvent.SHOW_SHOP_VIEW),-1);break;case ModuleConst.ACTIVITY:dispatchEvt(new d.TimelimitEvent(d.TimelimitEvent.SHOW_TIMELIMIT_ACTIVITY));break;case ModuleConst.FULI:var c=isNaN(i)?0:i-1;dispatchEvt(new d.HuodongEvent(d.HuodongEvent.SHOW_HUODONG_PANEL),[UIConst.WelfareView,c]);break;case ModuleConst.PAY_ACTIVITY:var p=isNaN(i)?0:i-1;dispatchEvt(new d.HuodongEvent(d.HuodongEvent.SHOW_HUODONG_PANEL),[UIConst.PayActivityView,p]);break;case ModuleConst.SHOP:dispatchEvt(new d.ShopEvent(d.ShopEvent.SHOW_SHOP_VIEW),ShopType.shangcheng);break;case ModuleConst.MAIL:dispatchEvt(new d.MailEvent(d.MailEvent.SHOW_MAIL_PANEL,i));break;case ModuleConst.GONGHUI:dispatchEvt(new d.GuildEvent(d.GuildEvent.SHOW_GUILD_PANEL));break;case ModuleConst.GONGHUICOPY:dispatchEvt(new d.GuildEvent(d.GuildEvent.SHOW_GUILD_COPY_VIEW));break;case ModuleConst.SUMMON:dispatchEvt(new d.SummonEvent(d.SummonEvent.SHOW_ZHAOHUAN_PANEL));break;case ModuleConst.SHILIANTA:dispatchEvt(new d.TowerEvent(d.TowerEvent.SHOW_SHILIANTA_PANEL));break;case ModuleConst.CHONGZHI:dispatchEvt(new d.TopUpEvent(d.TopUpEvent.SHOW_CHONGZHI_PANEL));break;case ModuleConst.CHAT:dispatchEvt(new d.ChatEvent(d.ChatEvent.SHOW_CHAT_PANEL),[d.OpenType.common,iface.tb_prop.chatChannelTypeKey.all]);break;case ModuleConst.TUJIAN:dispatchEvt(new d.TujianEvent(d.TujianEvent.SHOW_TUJIAN_PANEL));break;case ModuleConst.DAILY_COPY:dispatchEvt(new d.DailyEvent(d.DailyEvent.SHOW_DAILY_COPY_VIEW));break;case ModuleConst.WORLD_BOSS:dispatchEvt(new d.BossEvent(d.BossEvent.SHOW_BOSS_VIEW));break;case ModuleConst.EXPEDITION:dispatchEvt(new d.YuanzhengEvent(d.YuanzhengEvent.SHOW_MAIN_VIEW));break;case ModuleConst.Island:dispatchEvt(new d.IslandsEvent(d.IslandsEvent.SHOW_MAIN_VIEW));break;case ModuleConst.PAIHBAN:dispatchEvt(new d.RankingListEvent(d.RankingListEvent.SHOW_RANKINGLIST_PANEL),1);break;case ModuleConst.QIRIKH:dispatchEvt(new d.SevendaysEvent(d.SevendaysEvent.SHOW_SEVENDAYS_PANEL));break;case ModuleConst.SHENMEN:UIMgr.showUI(UIConst.GodDoorView);break;case ModuleConst.FENJIE:dispatchEvt(new d.FenjieEvent(d.FenjieEvent.SHOW_FENJIE_VIEW));break;case ModuleConst.ADVENTURE:UIMgr.showUI(UIConst.DafuwengView);break;case ModuleConst.CARAVAN_ESCORT:dispatchEvt(new d.EscortEvent(d.EscortEvent.SHOW_MAIN_VIEW));break;case ModuleConst.FOG_FOREST:dispatchEvt(new d.FogForestEvent(d.FogForestEvent.SHOW_MAIN_VIEW));break;case ModuleConst.GOD_DOMAIN:dispatchEvt(new d.GodDomainEvent(d.GodDomainEvent.SHOW_GODDOMAIN_VIEW));break;case ModuleConst.GLORY_FIGHT:dispatchEvt(new d.GloryEvent(d.GloryEvent.SHOW_MAIN_VIEW));break;case ModuleConst.TEAM_COPY:dispatchEvt(new d.CopyTeamEvent(d.CopyTeamEvent.SHOW_MAIN_PANEL))}}else showToast(o.prompt)}},i.prototype.showHudMenuView=function(t,e){void 0===e&&(e=[]),UIMgr.hasStage(UIConst.HudView)||UIMgr.showUI(UIConst.HudView);var i=UIMgr.getUIByName(UIConst.HudView);if(i)switch(t){case ModuleConst.MAIN:i.on3DMain();break;case ModuleConst.FIGHT:i.onFight();break;case ModuleConst.SHENLING:i.onShenling(e[0]);break;case ModuleConst.EQUIPMENT:i.onEquip(e[0]);break;case ModuleConst.ARTIFACT:var n=0<e.length?e[0]:0,o=1<e.length?e[1]:0;i.onShenqi(n,o);break;case ModuleConst.ARTIFACT_BAPTIZE:i.onShenqi(2);break;case ModuleConst.ARTIFACT_ENCHANT:i.onShenqi(3)}},i.prototype.showGmPanel=function(){UIMgr.showUI(UIConst.CheatView)},i.prototype.returnLastView=function(t){t=t||UIConst.GuajiView;var e=UIMgr.getUIByName(UIConst.HudView);e&&(t=e.getLastDialog()||t),UIMgr.showUI(t)},i.prototype.showPlayerInfo=function(i){var t;i&&i.playerId&&i.playerId!=App.hero.playerId&&(i.isCrossSvr?((t={})[Protocol.center_query_queryWorldPlayer.args.playerId]=i.playerId,PLC.request(Protocol.center_query_queryWorldPlayer,t,function(t){if(t){var e=new common.PlayerInfoVo;e.setData(t,i.playerId,i.event,i.eventData,i.hideAllBtn,i.isCrossSvr),e.clientVo=i.clientVo,UIMgr.showUI(UIConst.PlayerInfoView,e)}})):((t={})[Protocol.center_query_queryPlayer.args.playerId]=i.playerId,PLC.request(Protocol.center_query_queryPlayer,t,function(t){if(t){var e=new common.PlayerInfoVo;e.setData(t,i.playerId,i.event,i.eventData,i.hideAllBtn,i.isCrossSvr),e.clientVo=i.clientVo,UIMgr.showUI(UIConst.PlayerInfoView,e)}})))},i.prototype.qiecuoBack=function(t){this.showPlayerInfo(t)},i.prototype.showPlayerLineup=function(t){t&&UIMgr.showUI(UIConst.PlayerLineupInfoView,t)},Object.defineProperty(i.prototype,"hudView",{get:function(){return UIMgr.getUIByName(UIConst.HudView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}d.HudProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"HudModule"},n.prototype.listProcessors=function(){return[new t.HudProcessor]},n.prototype.onRegister=function(){t.HudModel.getInstance().initModel(),t.PlayerDetailsView.gmLock="http://192.168.1.108"!=ExtConfig.net_host,t.PlayerDetailsView.debugLock="http://192.168.1.108"!=ExtConfig.net_host},n);function n(){return e.call(this)||this}t.HudModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_CHATNOTICE_PANEL="SHOW_CHATNOTICE_PANEL",r.UPDATE_CHATNOTICE_TEXT="UPDATE_CHATNOTICE_TEXT",r.GET_SYSOPEN_REWARD="GET_SYSOPEN_REWARD",r.SHOW_MODULE_VIEW="SHOW_MODULE_VIEW",r.SHOW_RANK_MODULE="SHOW_RANK_MODULE",r.SHOW_GM_PANEL="SHOW_GM_PANEL",r.SHOW_PLAYER_INFO_VIEW="SHOW_PLAYER_INFO_VIEW",r.QIECUO_BACK="QIECUO_BACK",r.SHOW_PLAYER_LINEUP_VIEW="SHOW_PLAYER_LINEUP_VIEW",r.UPDATE_EXP_AND_MONEY="UPDATE_EXP_AND_MONEY",r.SET_NAME="SET_NAME",r.SET_HEAD_ICON="SET_HEAD_ICON",r.SET_HEAD_FRAME="SET_HEAD_BOX_ICON",r.SET_SHOW_GOD_MODEL="SET_SHOW_GOD_MODEL",r.EXCHANGE_GOLD_CHANGE="EXCHANGE_GOLD_CHANGE",r.UPDATE_MAINVIEW_BUTTON="UPDATE_MAINVIEW_BUTTON",r.UPDATE_POWER="UPDATE_POWER",r.UPDATE_ONLINEREWARD="UPDATE_ONLINEREWARD",r.RETURN_LASTVIEW="RETURN_LASTVIEW",r.SHOW_ENTRANCE_VIEW="SHOW_ENTRANCE_VIEW",r.UPDATE_CROSS_DAY_INFO="UPDATE_CROSS_DAY_INFO",r.SET_VOLUME="SET_VOLUME",r.SET_SOUND="SET_SOUND",r.SCREEN_SIZE_CHNAGE="SCREEN_SIZE_CHNAGE",r.UPDATE_SYS_TOP_BTN_INFO="UPDATE_SYS_TOP_BTN",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.HudEvent=a}(game=game||{});var Hudpos;__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(i){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initModel=function(){this.upperBtnVos=this.getHudDatas(Hudpos.Upper).map(function(t){return new i.ActivityBtnVo(t)})},e.prototype.isActivityBtnChange=function(){var e=!1;return this.upperBtnVos.forEach(function(t){t.isHaveChange()&&(e=!0)}),e},e.prototype.getHudDatas=function(t){return tb.TB_hud.get_TB_hud("pos",t).sort(function(t,e){return t.rank-e.rank})},e.prototype.getTbs=function(){return __spreadArrays(tb.TB_sys_open.get_TB_sys_open()).filter(function(t){return 0!=t.is_show})},e.isHudShow=function(t){if(!GameUtil.isIosNative())return!0;var e=tb.TB_hud.get_TB_hudBySysId(t);return!e||0!=e.is_show},e.IsOnActivatyTime=function(t){if(!App.IsSysOpen(t))return!1;if(!e.isHudShow(t))return!1;switch(t){case iface.tb_prop.sysOpenTypeKey.activity:return i.TimelimitModel.getInstance().hasActivity();case iface.tb_prop.sysOpenTypeKey.openGift:return i.OpenserverModel.getInstance().visiableView();case iface.tb_prop.sysOpenTypeKey.luckTurnTable:return i.HuodongModel.isOnActivatyTime();case iface.tb_prop.sysOpenTypeKey.halfMonth:return i.SevendaysModel.getInstance().isOnActivityTime(2);case iface.tb_prop.sysOpenTypeKey.sevenDay:return i.SevendaysModel.getInstance().isOnActivityTime(1);case iface.tb_prop.sysOpenTypeKey.onlineAward:return i.OnlineModel.getInstance().visiableView();case iface.tb_prop.sysOpenTypeKey.godRank:return i.PowerrankModel.getInstance().visiableView();case iface.tb_prop.sysOpenTypeKey.timeLimitBuy:return i.LimiteBuyModel.getInstance().isOpen();case iface.tb_prop.sysOpenTypeKey.realNameAuth:return!(-1==App.hero.realNameVisable||0!=App.hero.welfare.autonymAwardNum);case iface.tb_prop.sysOpenTypeKey.firstCharge:return!i.ChongzhiModel.getInstance().isAllReward();case iface.tb_prop.sysOpenTypeKey.bindGift:return!(-1==App.hero.bindPhone||0!=App.hero.bindMobileAward);case iface.tb_prop.sysOpenTypeKey.microClient:return!(-1==App.hero.downClient||App.hero.isReceiveWDXZ);case iface.tb_prop.sysOpenTypeKey.share:return-1!=App.hero.shareVisable;case iface.tb_prop.sysOpenTypeKey.superVip:return 500<=App.hero.welfare.rechargeSum;case iface.tb_prop.sysOpenTypeKey.openSvrGift:return i.OpenserverModel.getInstance().hasOsGiftActivity();case iface.tb_prop.sysOpenTypeKey.openSvrFund:return i.TimelimitModel.getInstance().isShowWeekFundActivity();case ModuleConst.LOGIN_QIRI:return i.HuodongModel.getInstance().isShowLoginGift(i.LoginGiftView.TYPE_ONE);case ModuleConst.LOGIN_SHISIRI:return i.HuodongModel.getInstance().isShowLoginGift(i.LoginGiftView.TYPE_TWO);case ModuleConst.TEST_REBATE:return i.HuodongModel.getInstance().canRewardTestRebate();case ModuleConst.WARRIOR_PROVE:return i.WarriorProveModel.getInstance().isOpen();default:return!0}},e.ActivityBtnEvent=function(t){var e=UIMgr.getInstance();t==iface.tb_prop.sysOpenTypeKey.welfare?dispatchEvt(new i.HuodongEvent(i.HuodongEvent.SHOW_HUODONG_PANEL),[UIConst.WelfareView]):t==iface.tb_prop.sysOpenTypeKey.payActivity?dispatchEvt(new i.HuodongEvent(i.HuodongEvent.SHOW_HUODONG_PANEL),[UIConst.PayActivityView]):t==iface.tb_prop.sysOpenTypeKey.recharge?dispatchEvt(new i.TopUpEvent(i.TopUpEvent.SHOW_CHONGZHI_PANEL)):t==iface.tb_prop.sysOpenTypeKey.activity?dispatchEvt(new i.TimelimitEvent(i.TimelimitEvent.SHOW_TIMELIMIT_ACTIVITY)):t==iface.tb_prop.sysOpenTypeKey.sevenDay||711==t?dispatchEvt(new i.SevendaysEvent(i.SevendaysEvent.SHOW_SEVENDAYS_PANEL)):t==iface.tb_prop.sysOpenTypeKey.luckTurnTable?dispatchEvt(new i.HuodongEvent(i.HuodongEvent.SHOW_HUODONG_PANEL),[UIConst.LuckyTurnView]):t==iface.tb_prop.sysOpenTypeKey.realNameAuth?dispatchEvt(new i.HuodongEvent(i.HuodongEvent.SHOW_HUODONG_PANEL),[UIConst.RealNameView]):t==iface.tb_prop.sysOpenTypeKey.godRank?dispatchEvt(new i.PowerrankEvent(i.PowerrankEvent.SHOW_VIEW_EVENT)):t==iface.tb_prop.sysOpenTypeKey.openGift?e.showUI(UIConst.OpenReward):t==iface.tb_prop.sysOpenTypeKey.onlineAward?e.showUI(UIConst.OnLineReward):t==iface.tb_prop.sysOpenTypeKey.firstCharge?dispatchEvt(new i.TopUpEvent(i.TopUpEvent.SHOW_SHOUCHONG_PANEL)):t==iface.tb_prop.sysOpenTypeKey.share?i.ShareModel.isReceiveFirst()?e.showUI(UIConst.MainShare):e.showUI(UIConst.FirstShare):t==iface.tb_prop.sysOpenTypeKey.timeLimitBuy?dispatchEvt(new i.LimiteBuyEvent(i.LimiteBuyEvent.SHOW_LIMITEBUY_VIEW)):t==iface.tb_prop.sysOpenTypeKey.microClient?dispatchEvt(new i.DownloadeEvent(i.DownloadeEvent.SHOW_WDXZ_VIEW)):t==iface.tb_prop.sysOpenTypeKey.superVip?e.showUI(UIConst.SuperVipView):t==iface.tb_prop.sysOpenTypeKey.bindGift?e.showUI(UIConst.BindPhone):t==iface.tb_prop.sysOpenTypeKey.beStrong?e.showUI(UIConst.BianQiangView):t==iface.tb_prop.sysOpenTypeKey.openSvrGift?e.showUI(UIConst.OpenServerGift):t==iface.tb_prop.sysOpenTypeKey.openSvrFund?e.showUI(UIConst.WeekFundView):t==ModuleConst.LOGIN_QIRI?e.showUI(UIConst.LoginGiftView,i.LoginGiftView.TYPE_ONE):t==ModuleConst.LOGIN_SHISIRI?e.showUI(UIConst.LoginGiftView,i.LoginGiftView.TYPE_TWO):t==ModuleConst.TEST_REBATE?e.showUI(UIConst.TestRebateView):t==ModuleConst.WARRIOR_PROVE&&dispatchEvt(new i.TaskEvent(i.TaskEvent.SHOW_TASK_VIEW,i.TaskTabType.warrior))},e.prototype.isPlayEffect=function(e){return this._playEffSyss||(this._playEffSyss=[iface.tb_prop.sysOpenTypeKey.activity,iface.tb_prop.sysOpenTypeKey.firstCharge]),this._playEffSyss.some(function(t){return t==e})},e.getTbVipByScore=function(t){for(var e=tb.TB_vip.get_TB_vip(),i=e.length-1;0<=i;i--)if(t>=10*e[i].recharge)return e[i];return null},e.TOP_ADD_HEIGHT=50,e);function e(){this.oldUserLv=0}i.HudModel=t;var n=(o.prototype.isOpen=function(){return App.IsSysOpen(this.tb.ID)},o.prototype.getReward=function(){return this.tb.open_reward.map(function(t){return new ItemVo(t[0],t[1])})},o);function o(t){this.tb=tb.TB_sys_open.get_TB_sys_openById(t)}i.SysOpenData=n}(game=game||{}),function(t){t[t.Upper=1]="Upper",t[t.Middle=2]="Middle",t[t.Bottom=3]="Bottom"}(Hudpos=Hudpos||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.hud.entrance.EntranceListUI,__extends(a,i),a.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},a.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},a.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._mainFunction=null,this._functionList=null,this.btnlist.array=null,UIMgr.hideUIByName(UIConst.SysTopView),Laya.timer.clearAll(this),this.btnlist.scrollBar.touchScrollEnable=!0},a.prototype.initView=function(){var t=this,e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond],i=this.dialogInfo.uiname;UIUtil.showSysTopView({viewName:i,resAry:e,funList:null,closeCallback:this.toClose.bind(this)});var n=this.dataSource?this.dataSource:a.LastType;a.LastType=n,this._mainFunction=tb.TB_function.getSet(n),this._functionList=tb.TB_function.getFunctionListByType(n),this.img_bg.skin=SkinUtil.getSysMapSkin(ModuleConst.WANFA,0,this._mainFunction.icon),this.btnlist.array=this._functionList,this.btnlist.visible=!1,Laya.timer.frameOnce(1,this,function(){t.btnlist.visible=!0,UIUtil.listTween(t.btnlist,function(){o.GuideWeakManager.isExcuting()&&(t.btnlist.scrollBar.touchScrollEnable=!1)})})},a.prototype.getIRBySysid=function(t){var e=this.getIRIndex(t);return this.btnlist.getCell(e)},a.prototype.getIRIndex=function(e){return this._functionList.findIndex(function(t){return t.system_id==e})},a.prototype.toClose=function(){UIMgr.showUI(UIConst.GuajiView)},a.LastType=100,a);function a(){var t=i.call(this)||this;return t.group=UIConst.hud_group,t}o.EntranceListView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.hud.entrance.EntranceListIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this._dataSource;if(t){this.icon.skin="shenjie/"+t.icon+".png",this.redpoint.setRedPointName(tb.TB_function.FUNCTION_REDPOINT[t.ID]),this.on(Laya.Event.CLICK,this,this.onClick);var e=tb.TB_sys_open.get_TB_sys_openById(t.system_id);this.icon.gray=e&&!App.IsSysOpen(t.system_id),this.box_condition.visible=this.icon.gray,this.box_condition.visible&&(this.lab_condition.text=LanMgr.getLan(e.prompt,-1))}else this.icon.skin="",this.redpoint.setRedPointName(""),this.off(Laya.Event.CLICK,this,this.onClick),Laya.Tween.clearTween(this)},n.prototype.isBtnOpen=function(t,e){void 0===e&&(e=!1);var i=tb.TB_sys_open.get_TB_sys_openById(t);return!(!i||App.IsSysOpen(t)||(e&&showToast(i.prompt),0))},n.prototype.onClick=function(){var t=this._dataSource;if(t.system_id!=ModuleConst.DIXIACHENG&&!this.isBtnOpen(t.system_id,!0))switch(t.system_id){case ModuleConst.SUMMON:dispatchEvt(new e.SummonEvent(e.SummonEvent.SHOW_ZHAOHUAN_PANEL));break;case ModuleConst.GONGHUI:dispatchEvt(new e.GuildEvent(e.GuildEvent.SHOW_GUILD_PANEL));break;case ModuleConst.SHILIANTA:dispatchEvt(new e.TowerEvent(e.TowerEvent.SHOW_SHILIANTA_PANEL));break;case ModuleConst.TUJIAN:dispatchEvt(new e.TujianEvent(e.TujianEvent.SHOW_TUJIAN_PANEL));break;case ModuleConst.JINGJI:dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.JINGJI]);break;case ModuleConst.MATCH_FIGHT:dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.MATCH_FIGHT]);break;case ModuleConst.DAILY_COPY:dispatchEvt(new e.DailyEvent(e.DailyEvent.SHOW_DAILY_COPY_VIEW));break;case ModuleConst.WORLD_BOSS:dispatchEvt(new e.BossEvent(e.BossEvent.SHOW_BOSS_VIEW));break;case ModuleConst.EXPEDITION:dispatchEvt(new e.YuanzhengEvent(e.YuanzhengEvent.SHOW_MAIN_VIEW));break;case ModuleConst.Island:dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.Island]);break;case ModuleConst.QIRIKH:dispatchEvt(new e.SevendaysEvent(e.SevendaysEvent.SHOW_SEVENDAYS_PANEL));break;case ModuleConst.SHENMEN:dispatchEvt(new e.GodDoorEvent(e.GodDoorEvent.OPEN_SHEN_MEN_VIEW));break;case ModuleConst.SHOP:dispatchEvt(new e.ShopEvent(e.ShopEvent.SHOW_SHOP_VIEW),ShopType.shangcheng);break;case ModuleConst.CARAVAN_ESCORT:dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.CARAVAN_ESCORT]);break;case ModuleConst.FOG_FOREST:dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.FOG_FOREST]);break;case ModuleConst.GOD_DOMAIN:dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.GOD_DOMAIN]);break;case ModuleConst.GLORY_FIGHT:dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.GLORY_FIGHT]);break;case ModuleConst.TEAM_COPY:dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.TEAM_COPY])}},n);function n(){return t.call(this)||this}e.EntranceIR=i}(game=game||{}),function(t){var e=(i.prototype.updateData=function(){this.lv=t.GuildSkillModel.getInstance().getSkillLv(this.godType,this.attrType),this.tbSkill=tb.TB_guild_skill.getTbByParam(this.godType,this.attrType,this.lv)},i.prototype.getXiaoguo=function(){return this.tbSkill.attr[0]<=4&&0==this.tbSkill.attr[1]?this.tbSkill.attr[2]+"":Math.floor(1e4*this.tbSkill.attr[2])/100+"%"},i.prototype.getMaxLv=function(){for(var t=0,e=1e3*this.godType+100*this.attrType;0!=tb.TB_guild_skill.get_TB_guild_skillById(e).cost;e++)t++;return t},i.prototype.isCanLvup=function(){return 0!=this.tbSkill.cost&&this.tbSkill.cost<=App.hero.guildDonate},i);function i(t,e){this.godType=t,this.attrType=e,this.updateData()}t.GuildSkillVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var o,t=(o=ui.guild.skill.GuildSkillUI,__extends(e,o),e.prototype.createChildren=function(){o.prototype.createChildren.call(this),this._typeList=[GodType.shuchu,GodType.zhiliao,GodType.fuzhu,GodType.kongzhi,GodType.fangyu],this.tab_zhenying.labels="输出,治疗,辅助,控制,坦克",this._model=n.GuildSkillModel.getInstance(),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:"公会技能"},this._shuxingqiuList=[];for(var t=0,e=this._model.skillAttrs;t<e.length;t++){var i=this["item"+e[t]];i.on(Laya.Event.CLICK,this,this.onClickSkill),this._shuxingqiuList.push(i)}this.btn_reset.on(Laya.Event.CLICK,this,this.reset),this.btn_shengji.on(Laya.Event.CLICK,this,this.levelUp),this.tab_zhenying.selectedIndex=-1,this.tab_zhenying.selectHandler=new Handler(this,this.onTab)},e.prototype.show=function(t,e){o.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){o.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){o.prototype.onClosed.call(this),this.tab_zhenying.selectedIndex=-1;for(var t=this._curAttr=0,e=this._shuxingqiuList;t<e.length;t++)e[t].dataSource=null},e.prototype.initView=function(){this.tab_zhenying.selectedIndex=0},e.prototype.onTab=function(t){if(-1!=t){var e=this._typeList[this.tab_zhenying.selectedIndex];this._curAttr=this._model.getCanLvupAttr(e),this.updateView()}},e.prototype.onClickSkill=function(t){var e=t.target;e&&e.dataSource&&(this._curAttr=e.dataSource.attrType,this.updateView())},e.prototype.updateView=function(){if(!(this._curAttr<=0)){for(var t,e=this._typeList[this.tab_zhenying.selectedIndex],i=this._model.getSkillList(e),n=0,o=this._shuxingqiuList.length;n<o;n++){var a=this._shuxingqiuList[n],r=i[n];a.dataSource=r,this._curAttr==r.attrType&&(t=r),a.img_shuxingqiu.skin=SkinUtil.getGuildSkillIcon(r.attrType,e),a.ani_select.visible=this._curAttr==r.attrType}if(t){if(0==t.tbSkill.cost)return this.btn_shengji.disabled=!0,this.lb_shuxing.text=t.tbSkill.name,this.lb_name.text=t.tbSkill.name.substr(0,t.tbSkill.name.indexOf("L")),this.lb_name.align="center",this.lb_xiaoguo.text="+"+t.getXiaoguo(),this.lb_xiaoguo.align="center",this.box_xiaohao.visible=!1,this.lb_max.visible=!0,void this.box_xiaoguo.refresh();this.btn_shengji.disabled=!1,this.lb_shuxing.text=t.tbSkill.name;var s=tb.TB_guild_skill.getTbByParam(t.godType,t.attrType,t.lv+1);s.attr[0]<=4&&0==s.attr[1]?(this.lb_name.text=t.tbSkill.name.substr(0,t.tbSkill.name.indexOf("L")),this.lb_xiaoguo.text="+"+t.getXiaoguo()+"   >>   +"+s.attr[2]):(this.lb_name.text=t.tbSkill.name.substr(0,t.tbSkill.name.indexOf("L")),this.lb_xiaoguo.text="+"+t.getXiaoguo()+"   >>   +"+Math.floor(1e4*s.attr[2])/100+"%"),this.lb_name.align="right",this.lb_xiaoguo.align="left",this.box_xiaohao.visible=!0,this.lb_max.visible=!1,this.lb_xiaohao.text=""+Snums(App.hero.guildDonate),this.lb_xiaohao2.text="/"+Snums(t.tbSkill.cost),this.box_xiaohao.refresh(),this.box_xiaoguo.refresh(),this.box_xiaoguo.event(Laya.Event.RESIZE),App.hero.guildDonate<t.tbSkill.cost?this.lb_xiaohao.color=ColorConst.RED:this.lb_xiaohao.color=ColorConst.normalFont}}},e.prototype.levelUp=function(){var t=this._typeList[this.tab_zhenying.selectedIndex],e=this._model.getSkillVo(t,this._curAttr);e&&dispatchEvt(new n.GuildEvent(n.GuildEvent.GUILD_SKILL_LEVELUP),e)},e.prototype.reset=function(){if(0!==Object.keys(App.hero.guildSkillInfo).length){var t=tb.TB_guild_set.getSet().resetskill_cost,e=tb.TB_item.get_TB_itemById(parseInt(t[0][0])).name,i=LanMgr.getLan("",10425,t[0][1],e);common.AlertBox.showAlert({text:i,confirmCb:function(){dispatchEvt(new n.GuildEvent(n.GuildEvent.GUILD_SKILL_RESET))}})}else showToast(LanMgr.getLan("",10424))},e);function e(){var t=o.call(this)||this;return t._curAttr=0,t}n.GuildSkillView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.skill.GuildSkillRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.lb_dengji.text=t.lv+"/"+t.getMaxLv(),this.ani_select.loadAnimation(ResConst.anim_circle_select,Handler.create(this,function(){this.ani_select.play()}),ResConst.atlas_circle_select)):this.ani_select.gotoAndStop(0)},n);function n(){return e.call(this)||this}t.GuildSkillRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"GuildSkillProcessor"},i.prototype.listenModuleEvents=function(){return[new n.GuildEvent(n.GuildEvent.GUILD_SKILL_LEVELUP),new n.GuildEvent(n.GuildEvent.GUILD_SKILL_RESET)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof n.GuildEvent)switch(t.type){case n.GuildEvent.GUILD_SKILL_LEVELUP:this.skillLevelUp(t.data);break;case n.GuildEvent.GUILD_SKILL_RESET:this.skillReset()}},i.prototype.skillLevelUp=function(t){if(0!=t.tbSkill.cost){if(!UIUtil.checkNotEnough(iface.tb_prop.resTypeKey.guildDonate,t.tbSkill.cost)){var e={};e[Protocol.game_guild_upgradeSkill.args.id]=""+t.godType+t.attrType,PLC.request(Protocol.game_guild_upgradeSkill,e,function(t,e){if(t){for(var i in t.modifyGuildSkillInfo)App.hero.guildSkillInfo[i]=t.modifyGuildSkillInfo[i];n.GuildSkillModel.getInstance().updateSkillData(),UIMgr.getUIByName(UIConst.GuildSkillView)&&UIMgr.getUIByName(UIConst.GuildSkillView).updateView()}else showToast(e)})}}else showToast(LanMgr.getLan("",10423))},i.prototype.skillReset=function(){var t=tb.TB_guild_set.getSet().resetskill_cost;UIUtil.checkNotEnough(t[0][0],t[0][1])||PLC.request(Protocol.game_guild_resetSkill,{},function(t,e){t&&(App.hero.guildSkillInfo={},n.GuildSkillModel.getInstance().updateSkillData(),UIMgr.getUIByName(UIConst.GuildSkillView)&&UIMgr.getUIByName(UIConst.GuildSkillView).updateView())})},i);function i(){return t.call(this)||this}n.GuildSkillProcessor=e}(game=game||{}),function(s){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.initModel=function(){this.godTypes=[GodType.shuchu,GodType.zhiliao,GodType.fuzhu,GodType.kongzhi,GodType.fangyu];var t=iface.tb_prop.attrTypeKey;this.skillAttrs=[t.hpMax,t.atk,t.def,t.crit,t.critDmg];for(var e=0,i=this.godTypes;e<i.length;e++)for(var n=i[e],o=0,a=this.skillAttrs;o<a.length;o++){var r=a[o];this._skillList.push(new s.GuildSkillVo(n,r))}},e.prototype.getSkillList=function(e){return 0==e?this._skillList:this._skillList.filter(function(t){return t.godType==e})},e.prototype.getCanLvupAttr=function(t){var e=this.getSkillList(t).find(function(t){return t.isCanLvup()});return e?e.attrType:1},Object.defineProperty(e.prototype,"check",{get:function(){return this._check},set:function(t){this._check=t},enumerable:!0,configurable:!0}),e.prototype.isHasDonateLevelUp=function(){return!!(App.IsSysOpen(ModuleConst.GONGHUI)&&s.GuildModel.getInstance().isHasGuild()&&1==App.hero.loginCount&&this._check)&&this._skillList.some(function(t){return t.isCanLvup()})},e.prototype.getCurSkillAttr=function(t){for(var e=[{},{}],i=0,n=this.getSkillList(t);i<n.length;i++){var o=n[i].tbSkill.attr;o[1]==ValueType.percent?e[1][o[0]]=e[1][o[0]]?e[1][o[0]]+o[2]:o[2]:e[0][o[0]]=e[0][o[0]]?e[0][o[0]]+o[2]:o[2]}return e},e.prototype.getSkillLv=function(t,e){var i=""+t+e;return App.hero.guildSkillInfo[i]||0},e.prototype.getSkillVo=function(e,i){return this._skillList.find(function(t){return t.godType==e&&t.attrType==i})},e.prototype.updateSkillData=function(){for(var t=0,e=this._skillList;t<e.length;t++)e[t].updateData()},e);function e(){this._skillList=[],this.skillNum=5,this.godTypes=[],this.skillAttrs=[],this._check=!0}s.GuildSkillModel=t}(game=game||{}),(game||(game={})).IconVo=function(t){this.tbHead=t};__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.guild.init.IconRenderUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t&&t instanceof e.IconVo&&(this.img_icon.skin=SkinUtil.getGuildHeadIcon(t.tbHead.icon))},n);function n(){return t.call(this)||this}e.IconRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.guild.init.IconChangeUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.list_icon.array=null,this.btn_sure.off(Laya.Event.CLICK,this,this.sure)},n.prototype.initView=function(){var e=this;this.btn_sure.on(Laya.Event.CLICK,this,this.sure);var t=this.dataSource.list_icon;this.list_icon.array=t,this.list_icon.mouseHandler=new Handler(this,this.onSelect),this.list_icon.renderHandler=new Handler(this,this.onRender);var i=0;this.dataSource.iconId&&(i=t.findIndex(function(t){return t.tbHead.ID==e.dataSource.iconId})),this.list_icon.selectedIndex=i},n.prototype.sure=function(){this.dataSource.type==t.GuildIconChangeType.createChange?dispatchEvt(new t.GuildEvent(t.GuildEvent.CREATE_GUILD_CHANGEICON),this.list_icon.selectedItem):this.dataSource.type==t.GuildIconChangeType.infoChange&&dispatchEvt(new t.GuildEvent(t.GuildEvent.GUILD_HALL_VIEW_CHANGEICON),this.list_icon.selectedItem)},n.prototype.onSelect=function(t,e){t.type,Laya.Event.CLICK},n.prototype.onRender=function(t,e){e>this.list_icon.length||(t.img_selected.visible=e==this.list_icon.selectedIndex)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.IconChangeView,closeOnSide:t.isModelClose,title:"头像设置"},t}t.IconChangeView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.guild.init.GuildinitUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.initView=function(){this.btn_lookup.on(Laya.Event.CLICK,this,this.lookUp),this.btn_create.on(Laya.Event.CLICK,this,this.createGuild),this.btn_update.on(Laya.Event.CLICK,this,this.onRefresh),this.list_guild.array=this._model.getGuildList(),this.requestGuildList()},n.prototype.requestGuildList=function(){var t=this;this._model.requestGuildList().then(function(){t.refreshList()})},n.prototype.refreshList=function(){var t=this._model.getGuildList();this.list_guild.array=t,this.img_side.visible=7<=t.length},n.prototype.onRefresh=function(){var t=this;this._model.requestGuildList().then(function(){t.refreshList()})},n.prototype.lookUp=function(){var i=this;if(""!=this.are_putin.text){var t={};t[Protocol.guild_guild_find.args.name]=this.are_putin.text,PLC.request(Protocol.guild_guild_find,t,function(t,e){t&&(i.list_guild.array=t.findList)})}else showToast(LanMgr.getLan("",10160))},n.prototype.createGuild=function(){UIMgr.showUI(UIConst.CreateGuildView)},n.prototype.close=function(){i.prototype.close.call(this),this.list_guild.array=null,this.btn_lookup.off(Laya.Event.CLICK,this,this.lookUp),this.btn_create.off(Laya.Event.CLICK,this,this.createGuild),this.btn_update.off(Laya.Event.CLICK,this,this.onRefresh)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.GuildinitView,closeOnSide:t.isModelClose,title:"创建公会"},t._model=e.GuildModel.getInstance(),t}e.GuildinitView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.guild.init.GuildinitRenderUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;t?(this.lab_name.text=t.name,this.btn_apply.visible=0==t.isApplay,this.btn_cancel.visible=0!=t.isApplay,this.lab_level.text=t.level+LanMgr.getLan("级",-1),this.lab_limit.text=t.limitLevel+LanMgr.getLan("级",-1),this.lab_people.text=t.num+"/"+tb.TB_guild.get_TB_guildById(t.level).limit_num,this.btn_apply.label=t.autoJoin==iface.tb_prop.guildAutoJoinTypeKey.yes?LanMgr.getLan("加入",-1):LanMgr.getLan("申请",-1),this.btn_apply.on(Laya.Event.CLICK,this,this.applyJoin),this.btn_cancel.on(Laya.Event.CLICK,this,this.applyJoin)):(this.lab_name.text="",this.lab_level.text="",this.lab_people.text="",this.btn_apply.off(Laya.Event.CLICK,this,this.applyJoin),this.btn_cancel.off(Laya.Event.CLICK,this,this.applyJoin))},i.prototype.applyJoin=function(){var n=this,t=this.dataSource;if(App.hero.level<t.limitLevel)showToast(LanMgr.getLan("",10159));else{var e={};e[Protocol.guild_guild_apply.args.guildId]=t.guildId,PLC.request(this.btn_apply.visible?Protocol.guild_guild_apply:Protocol.guild_guild_apply_cancel,e,function(t,e){if(t){if(t.addMember)return UIMgr.hideUIByName(UIConst.GuildinitView),void dispatchEvt(new o.GuildEvent(o.GuildEvent.SHOW_GUILD_PANEL));n.btn_apply.visible=!n.btn_apply.visible,n.btn_cancel.visible=!n.btn_apply.visible,n.btn_apply.selected=n.btn_cancel.selected=!1}else{var i=UIMgr.getUIByName(UIConst.GuildinitView);i&&i.requestGuildList()}})}},i);function i(){return t.call(this)||this}o.GuildinitRender=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"GuildInitProcessor"},i.prototype.listenModuleEvents=function(){return[new u.GuildEvent(u.GuildEvent.CREATE_GUILD),new u.GuildEvent(u.GuildEvent.CHANGE_GUILD_ICON),new u.GuildEvent(u.GuildEvent.CREATE_GUILD_CHANGEICON)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof u.GuildEvent)switch(t.type){case u.GuildEvent.CREATE_GUILD:this.createGuild(t.data);break;case u.GuildEvent.CHANGE_GUILD_ICON:this.showChangeIconView(t.data);break;case u.GuildEvent.CREATE_GUILD_CHANGEICON:this.createGuildChangeIcon(t.data)}},i.prototype.createGuild=function(t){var e=t.name,i=t.level,n=t.auto,o=t.head;if(App.hero.guildId)showToast(LanMgr.getLan("",10421));else{var a=tb.TB_guild_set.getSet().create_viplevel;if(App.hero.vip<a)showToast(LanMgr.getLan("",10422,a));else if(e&&""!=e){var r=tb.TB_guild_set.getSet().create_cost;if(!UIUtil.checkNotEnough(r[0],r[1])){var s={};s[Protocol.guild_guild_create.args.name]=e,s[Protocol.guild_guild_create.args.level]=i,s[Protocol.guild_guild_create.args.auto]=n?iface.tb_prop.guildAutoJoinTypeKey.yes:iface.tb_prop.guildAutoJoinTypeKey.no,s[Protocol.guild_guild_create.args.head]=o,PLC.request(Protocol.guild_guild_create,s,function(t,e){e&&showToast(e),t&&(UIMgr.hideUIByName(UIConst.GuildinitView),UIMgr.hideUIByName(UIConst.CreateGuildView),dispatchEvt(new u.GuildEvent(u.GuildEvent.SHOW_GUILD_PANEL)))})}}else showToast(LanMgr.getLan("",10160))}},i.prototype.showChangeIconView=function(t){UIMgr.showUI(UIConst.IconChangeView,t)},i.prototype.createGuildChangeIcon=function(t){UIMgr.hideUIByName(UIConst.IconChangeView),UIMgr.getUIByName(UIConst.CreateGuildView)&&UIMgr.getUIByName(UIConst.CreateGuildView).changeIconSuccess(t)},Object.defineProperty(i.prototype,"initView",{get:function(){return UIMgr.getUIByName(UIConst.GuildinitView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}u.GuildInitProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.guild.init.CreateGuildUI,__extends(e,n),e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.btn_red.off(Laya.Event.CLICK,this,this.redlevel),this.btn_add.off(Laya.Event.CLICK,this,this.addlevel),this.btn_create.off(Laya.Event.CLICK,this,this.create),this.lab_level.off(Laya.Event.INPUT,this,this.onput),this.img_icon.off(Laya.Event.CLICK,this,this.changeIcon),this.btn_seticon.off(Laya.Event.CLICK,this,this.changeIcon)},e.prototype.initView=function(){this.btn_red.on(Laya.Event.CLICK,this,this.redlevel),this.btn_add.on(Laya.Event.CLICK,this,this.addlevel),this.btn_create.on(Laya.Event.CLICK,this,this.create),this.lab_level.on(Laya.Event.INPUT,this,this.onput),this.img_icon.on(Laya.Event.CLICK,this,this.changeIcon),this.btn_seticon.on(Laya.Event.CLICK,this,this.changeIcon);var t=this._model;this.img_icon.skin=t.createInitIconID?SkinUtil.getGuildHeadIconById(t.createInitIconID):SkinUtil.getGuildHeadIconById(1),this.lab_diamonds.text="x"+tb.TB_guild_set.getSet().create_cost[1],this.bgPanel.dataSource={uiName:UIConst.CreateGuildView,closeOnSide:this.isModelClose,title:"创建公会"};var e=tb.TB_guild_set.getSet().create_viplevel;this.lbVip.text="VIP"+e+"可创建公会",this.lbVip.color=App.hero.vip>=e?ColorConst.GREEN:ColorConst.RED},e.prototype.onput=function(){this.btn_red.disabled=1==Number(this.lab_level.text),this.btn_add.disabled=50==Number(this.lab_level.text),this.lab_level.text=Math.min(50,Number(this.lab_level.text)).toString(),this.lab_level.text=Math.max(1,Number(this.lab_level.text)).toString()},e.prototype.redlevel=function(){this.lab_level.text=Math.max(1,Number(this.lab_level.text)-1).toString()},e.prototype.addlevel=function(){this.lab_level.text=Math.min(50,Number(this.lab_level.text)+1).toString()},e.prototype.create=function(){var t={name:this.are_putin.text,level:parseInt(this.lab_level.text),auto:this.chk_auto.selected,head:this._model.createInitIconID};dispatchEvt(new i.GuildEvent(i.GuildEvent.CREATE_GUILD,t))},e.prototype.changeIcon=function(){var t=this._model,e={type:i.GuildIconChangeType.createChange,iconId:t.createInitIconID,list_icon:t.getIconList()};dispatchEvt(new i.GuildEvent(i.GuildEvent.CHANGE_GUILD_ICON),e)},e.prototype.changeIconSuccess=function(t){this.img_icon.skin=SkinUtil.getGuildHeadIcon(t.tbHead.icon),this._model.createInitIconID=t.tbHead.ID},e);function e(){var t=n.call(this)||this;return t.isModelClose=!0,t._model=i.GuildModel.getInstance(),t}i.CreateGuildView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=ui.guild.help.OthersHelpIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t){this.itemBox.dataSource=t.getItemVo(),this.lbName.text=t.svo.name,this.lbTitle.text=t.tbHelp.desc,this.lbNum.text=t.svo.helpNum+"/"+t.tbHelp.help_num,this.pbNum.value=t.svo.helpNum/t.tbHelp.help_num;var e=n.GuildHelpModel.getInstance().isFreeHelp();if(this.imgCost.visible=this.lbCost.visible=!e,e)this.btnHelp.label="免费援助";else{this.btnHelp.label="        援助";var i=t.getCost();this.imgCost.skin=SkinUtil.getCostSkin(i[0]),this.lbCost.text=i[1]+""}this.btnHelp.on(Laya.Event.CLICK,this,this.onHelp)}else this.btnHelp.off(Laya.Event.CLICK,this,this.onHelp)},i.prototype.onHelp=function(){var t=this.dataSource;t&&dispatchEvt(new n.GuildEvent(n.GuildEvent.HELP_OTHERS,t))},i);function i(){return t.call(this)||this}n.GuildOthersHelpIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.guild.help.MyHelpIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=t.isExist(),i=t.isRewardFinish(),n=t.isCanReward();if(this.lbQiuyuan.visible=this.btnAdd.visible=!e,this.itemBox.visible=this.lbTitle.visible=this.lbNum.visible=this.lbDesc.visible=this.lbNum.visible=this.lbPbNum.visible=this.pb.visible=e,this.imgFinish.visible=this.btnLingqu.visible=this.imgRedpoint.visible=this.lbState.visible=e,e){this.imgFinish.visible=i,this.btnLingqu.visible=this.lbState.visible=!i,this.btnLingqu.gray=!n,this.imgRedpoint.visible=n,this.lbState.text=n?"可领取："+t.getCanRewardNum():"求援中",this.itemBox.dataSource=t.getItemVo();var o=t.svo.helpNum,a=t.tbHelp.help_num;this.lbPbNum.text=this.lbNum.text=o+"/"+a,this.pb.value=o/a,this.lbTitle.text=t.tbHelp.desc}else this.itemBox.dataSource=null;this.on(Laya.Event.CLICK,this,this.onAdd),this.btnLingqu.on(Laya.Event.CLICK,this,this.onLingqu)}else this.itemBox.dataSource=null,this.off(Laya.Event.CLICK,this,this.onAdd),this.btnLingqu.off(Laya.Event.CLICK,this,this.onLingqu)},n.prototype.onAdd=function(){var t=this.dataSource;t&&!t.isExist()&&dispatchEvt(new e.GuildEvent(e.GuildEvent.SHOW_ASK_HELP_VIEW,t))},n.prototype.onLingqu=function(){var t=this.dataSource;t&&dispatchEvt(new e.GuildEvent(e.GuildEvent.REWARD_HELPED_ITEM,t))},n);function n(){return t.call(this)||this}e.GuildMyHelpIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.guild.help.HelpMainViewUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._model=t.GuildHelpModel.getInstance(),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:"公会救援"},this.tabbar.selectedIndex=-1,this.tabbar.selectHandler=new Handler(this,this.onSelect),this.tabbar.onSelectBefore=this.onSelectBefore.bind(this),this.myHelpUI.btnAskHelp.on(Laya.Event.CLICK,this,this.onAskHelp),this.myHelpUI.imgBaoxiang.on(Laya.Event.CLICK,this,this.onBaoxiang),this.myHelpUI.listHelp.array=null,this.othersHelpUI.listHelp.array=null},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.tabbar.selectedIndex=-1,this.clearOthersUI(),this.clearMyUI(),Laya.timer.clearAll(this)},n.prototype.initView=function(){var t=this.dataSource||0;this.tabbar.selectedIndex=t},n.prototype.onSelectBefore=function(t,e){0==t?this._model.requestMyHelpList().then(function(){e()}):1==t?this._model.requestOthersHelpList().then(function(){e()}):e()},n.prototype.onSelect=function(t){-1!=t&&(0==(this.viewStack.selectedIndex=t)?this.initMyHelpUI():this.initOthersHelpUI())},n.prototype.initMyHelpUI=function(){this.clearOthersUI(),this.updateMyListSimple(),this.updateBaoxiangState(),this.updateInterval()},n.prototype.updateInterval=function(){var t=this._model;Laya.timer.clear(this,this.intervalReuqestMy),0<t.getAskHelpNum()&&!t.isAllFinish()&&Laya.timer.loop(1e4,this,this.intervalReuqestMy)},n.prototype.intervalReuqestMy=function(){var t=this;this._model.requestMyHelpList().then(function(){t.updateMyListSimple()})},n.prototype.updateBaoxiangState=function(){var t=this._model,e=this.myHelpUI;t.isCanRewardBX()?(e.animBX.play(0,!0),e.animGuang.visible=!0,e.animGuang.play(0,!0)):(e.animGuang.visible=!1,e.animGuang.gotoAndStop(0),e.animBX.gotoAndStop(0)),e.imgBaoxiang.skin=t.isReawrdBX()?SkinUtil.help_bx_open:SkinUtil.help_bx_noopen},n.prototype.updateMyListSimple=function(){var t=this._model,e=this.myHelpUI;e.lbNum.text="今日求援完成次数（"+t.getRewardFinishNum()+"/"+tb.TB_guild_set.getSet().daily_help_num+"）",e.listHelp.array=t.getMyHelps()},n.prototype.onAskHelp=function(){dispatchEvt(new t.GuildEvent(t.GuildEvent.SEND_CHAT_HELP))},n.prototype.onBaoxiang=function(){dispatchEvt(new t.GuildEvent(t.GuildEvent.HELP_CLICK_BAOXIANG))},n.prototype.clearMyUI=function(){var t=this.myHelpUI;t.listHelp.array=null,t.animGuang.visible=!1,t.animGuang.gotoAndStop(0),t.animBX.gotoAndStop(0),Laya.timer.clear(this,this.intervalReuqestMy)},n.prototype.initOthersHelpUI=function(){this.clearMyUI(),this.updateOtherHelpUI(),Laya.timer.clear(this,this.intervalRequestOthers),Laya.timer.loop(1e4,this,this.intervalRequestOthers)},n.prototype.intervalRequestOthers=function(){var t=this;this._model.requestOthersHelpList().then(function(){t.updateOtherHelpUI()})},n.prototype.updateOtherHelpUI=function(){var t=this._model,e=this.othersHelpUI;e.lbNum.text=t.isFreeHelp()?"免费援助次数："+t.getFreeHelpNum():"钻石援助次数："+t.getCostNum();var i=t.getOthersHelp();e.listHelp.array=i,e.boxEmpty.visible=0==i.length,e.listHelp.visible=0<i.length},n.prototype.clearOthersUI=function(){this.othersHelpUI.listHelp.array=null,Laya.timer.clear(this,this.intervalRequestOthers)},n);function n(){return i.call(this)||this}t.GuildHelpView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var i,t=(i=ui.guild.help.AskHelpViewUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._model=r.GuildHelpModel.getInstance(),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:"求 援"},this.listItem.selectedIndex=-1,this.listItem.mouseHandler=new Handler(this,this.onMouse),this.listItem.renderHandler=new Handler(this,this.onRender),this.checkBox.selected=!0,this.btnSure.on(Laya.Event.CLICK,this,this.onSure)},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView(),this.listItem.array=tb.TB_guild_help.getList()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.listItem.cells.forEach(function(t,e){t.getChildByName("imgGouxuan").visible=!1}),this.listItem.array=null,this._selectInfo=null},e.prototype.initView=function(){this.listItem.selectedIndex=-1},e.prototype.onMouse=function(t,i){var n=this;if(-1!=i&&t.type==Laya.Event.CLICK){var e=this.listItem.getCell(i);if(e.gray)return void showToast(LanMgr.getLan("",10417));var o=e.getChildByName("imgGouxuan");o.visible?(o.visible=!1,this._selectInfo=null):this.listItem.cells.forEach(function(t,e){t.getChildByName("imgGouxuan").visible=e==i,e==i&&(n._selectInfo=t.dataSource)})}},e.prototype.onRender=function(t,e){var i=t.getChildByName("itemBox"),n=t.getChildByName("imgGouxuan"),o=t.dataSource;if(o){var a=r.GuildHelpModel.getInstance().isExistHelp(o.ID);t.gray=a,i.dataSource=o.getRewardList()[0]}else i.dataSource=null,n.visible=!1},e.prototype.onSure=function(){if(this._selectInfo){var t=this.dataSource;t&&dispatchEvt(new r.GuildEvent(r.GuildEvent.SEND_ASK_HELP),[t.pos,this._selectInfo,this.checkBox.selected])}else showToast(LanMgr.getLan("",10420))},e);function e(){return i.call(this)||this}r.GuildAskHelpView=t}(game=game||{}),function(t){var e=(i.prototype.updateSvo=function(t){if(this.svo=t){this.tbHelp=tb.TB_guild_help.getItemnById(t.helpType),this.tbHelp||logerror("数据错误,",t);var e=this.tbHelp.getRewardList()[0];this._itemVo||(this._itemVo=new ItemVo(0,0),this._itemVo.show=!0),this._itemVo.id=e.id,this._itemVo.count=e.count}else this.tbHelp=null},i.prototype.getItemVo=function(){return this._itemVo&&this._itemVo.id?this._itemVo:null},i.prototype.getCanRewardNum=function(){return this.svo?this.svo.helpNum-this.svo.getNum:0},i.prototype.isExist=function(){return!!this.svo},i.prototype.isCanReward=function(){return 0<this.getCanRewardNum()},i.prototype.isRewardFinish=function(){return this.svo&&this.svo.getNum>=this.tbHelp.help_num},i.prototype.isFinish=function(){return this.svo&&this.svo.helpNum>=this.tbHelp.help_num},i.prototype.isFree=function(){return t.GuildHelpModel.getInstance().isFreeHelp()},i.prototype.getCost=function(){return tb.TB_guild_set.getSet().help_cost[0]},i.prototype.clear=function(){this.svo=null,this.tbHelp=null},i);function i(){this.pos=-1}t.GuildHelpVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"GuildHelpProcessor"},i.prototype.listenModuleEvents=function(){return[new r.GuildEvent(r.GuildEvent.SHOW_ASK_HELP_VIEW),new r.GuildEvent(r.GuildEvent.REWARD_HELPED_ITEM),new r.GuildEvent(r.GuildEvent.HELP_CLICK_BAOXIANG),new r.GuildEvent(r.GuildEvent.SEND_CHAT_HELP),new r.GuildEvent(r.GuildEvent.SEND_ASK_HELP),new r.GuildEvent(r.GuildEvent.HELP_OTHERS)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof r.GuildEvent)switch(t.type){case r.GuildEvent.SHOW_ASK_HELP_VIEW:this.showAskHelpView(t.data);break;case r.GuildEvent.REWARD_HELPED_ITEM:this.rewardHelpedItem(t.data);break;case r.GuildEvent.HELP_CLICK_BAOXIANG:this.onClickBX();break;case r.GuildEvent.SEND_CHAT_HELP:this.sendChatHelp();break;case r.GuildEvent.SEND_ASK_HELP:this.sendAskHelp(t.data);break;case r.GuildEvent.HELP_OTHERS:this.helpOthers(t.data)}},i.prototype.showAskHelpView=function(t){UIMgr.showUI(UIConst.GuildAskHelpView,t)},i.prototype.rewardHelpedItem=function(i){var n=this;if(i.isCanReward()){var t={};t[Protocol.guild_guildHelp_getGuildHelpNum.args.id]=i.svo.helpId,PLC.request(Protocol.guild_guildHelp_getGuildHelpNum,t,function(t){if(t){n._model.updateHelpAwardNum(i,t.guildHelpInfo);var e=UIMgr.getUIByName(UIConst.GuildHelpView);e.updateMyListSimple(),e.updateBaoxiangState(),UIUtil.showRewardView(t.commonData),dispatchEvt(new r.GuildEvent(r.GuildEvent.REWARD_HELPED_ITEM_SUCC))}})}else showToast(LanMgr.getLan("",10413))},i.prototype.onClickBX=function(){if(this._model.isCanRewardBX())PLC.request(Protocol.guild_guildHelp_getGuildHelpAward,null,function(t){t&&(UIMgr.getUIByName(UIConst.GuildHelpView).updateBaoxiangState(),UIUtil.showRewardView(t.commonData))});else{var t=tb.TB_guild_set.getSet().help_box.map(function(t){return new ItemVo(t[0],t[1])});UIMgr.showUI(UIConst.ManyItemsTip,{data:t})}},i.prototype.sendChatHelp=function(){this._model.getAskHelpNum()<=0||this._model.isAllFinish()?showToast(LanMgr.getLan("",10414)):App.serverTimeSecond<App.hero.guildHelpEndTime?showToast(LanMgr.getLan("",10415)):PLC.request(Protocol.game_guild_sendGuildHelpNotice,null,function(t){t&&(showToast(LanMgr.getLan("",10416)),App.hero.guildHelpEndTime=t.guildHelpEndTime||0)})},i.prototype.sendAskHelp=function(t){var i=this,e=t[0],n=t[1],o=t[2]?1:0;if(this._model.isExistHelp(n.ID))showToast(LanMgr.getLan("",10417));else{var a={};a[Protocol.guild_guildHelp_createGuildHelp.args.type]=n.ID,a[Protocol.guild_guildHelp_createGuildHelp.args.notice]=o,a[Protocol.guild_guildHelp_createGuildHelp.args.pos]=e,PLC.request(Protocol.guild_guildHelp_createGuildHelp,a,function(t){if(t){i._model.addHelp(t.addGuildHelp),UIMgr.hideUIByName(UIConst.GuildAskHelpView);var e=UIMgr.getUIByName(UIConst.GuildHelpView);e.updateMyListSimple(),e.updateInterval(),dispatchEvt(new r.GuildEvent(r.GuildEvent.SEND_ASK_HELP_SUCC))}})}},i.prototype.helpOthers=function(t){var e=this._model;if(t.isFinish())showToast(LanMgr.getLan("",10418));else{if(!e.isFreeHelp()){if(e.isCostMax())return void showToast(LanMgr.getLan("",10419));for(var i=0,n=tb.TB_guild_set.getSet().help_cost;i<n.length;i++){var o=n[i];if(UIUtil.checkNotEnough(o[0],o[1]))return}}var a={};a[Protocol.game_guild_addGuildHelpNum.args.id]=t.svo.helpId,PLC.request(Protocol.game_guild_addGuildHelpNum,a,function(t){t&&(UIUtil.showRewardView(t.commonData),e.updateOthersNum(t.guildHelpInfo),UIMgr.getUIByName(UIConst.GuildHelpView).updateOtherHelpUI(),dispatchEvt(new r.GuildEvent(r.GuildEvent.HELP_OTHERS_SUCC)))})}},i);function i(){var t=e.call(this)||this;return t._model=r.GuildHelpModel.getInstance(),t}r.GuildHelpProcessor=t}(game=game||{}),function(u){var t=(h.getInstance=function(){return h._instance||(h._instance=new h),h._instance},h.prototype.initModel=function(){this._myHelpList=[],this._isAllFinish=!1,this._isAllRewardFinish=!1;for(var t=tb.TB_guild_set.getSet().daily_help_num,e=0;e<t;e++){var i=new u.GuildHelpVo;i.pos=e,this._myHelpList.push(i)}},h.prototype.clearCrossDayData=function(){UIMgr.hideUIByName(UIConst.GuildHelpView),UIMgr.hideUIByName(UIConst.GuildAskHelpView);for(var t=0,e=this._myHelpList;t<e.length;t++){var i=e[t];i.isRewardFinish()&&i.clear()}this.updateFinishState(),this._hasRequestMy=!1,App.hero.guildHelpNum=this._myHelpIds.length},h.prototype.updateHelpList=function(n){function t(t){var e=o._myHelpList[t],i=n.find(function(t){return t.helpPos==e.pos});e.updateSvo(i)}for(var o=this,e=0;e<this._myHelpList.length;e++)t(e);this.updateFinishState()},h.prototype.updateHelpAwardNum=function(t,e){t&&t.svo&&(t.svo.getNum=e.getNum,t.svo.helpNum=e.helpNum,this.updateFinishState())},h.prototype.updateFinishState=function(){this._myHelpIds.length=0,this._isAllFinish=!0,this._isAllRewardFinish=!0;for(var t=0,e=this._myHelpList;t<e.length;t++){var i=e[t];i.isExist()&&this._myHelpIds.push(i.tbHelp.ID),i.isFinish()||(this._isAllFinish=!1),i.isRewardFinish()||(this._isAllRewardFinish=!1)}},h.prototype.addHelp=function(e){if(e){var t=this._myHelpList.find(function(t){return t.pos==e.helpPos});t||logerror("获取不到改槽位的vo：",e),t.updateSvo(e),this.updateFinishState()}},h.prototype.getMyHelps=function(){return this._myHelpList},h.prototype.isExistHelp=function(t){return-1!=this._myHelpIds.indexOf(t)},h.prototype.isAllFinish=function(){return this._isAllFinish},h.prototype.isAllRewardFinish=function(){return this._isAllRewardFinish},h.prototype.getAskHelpNum=function(){return this._myHelpIds.length},h.prototype.getRewardFinishNum=function(){var e=0;return this._myHelpList.forEach(function(t){t.isRewardFinish()&&e++}),e},h.prototype.updateOthersHelp=function(t){for(var e=0,i=this._othersHelps;e<i.length;e++){var n=i[e];n.clear(),Laya.Pool.recover(h.VO_SIGN,n)}for(var o=this._othersHelps.length=0,a=t;o<a.length;o++){var r=a[o],s=Laya.Pool.getItemByClass(h.VO_SIGN,u.GuildHelpVo);s.updateSvo(r),this._othersHelps.push(s)}},h.prototype.getOthersHelp=function(){return this._othersHelps},h.prototype.updateOthersNum=function(t){var e=this.getOthersInfoById(t.helpId);e&&e.svo&&(e.svo.getNum=t.getNum,e.svo.helpNum=t.helpNum,e.isFinish()&&this.removeOthersById(t.helpId))},h.prototype.getOthersInfoById=function(e){return this._othersHelps.find(function(t){return t.svo.helpId==e})},h.prototype.removeOthersById=function(e){var t=this._othersHelps.find(function(t){return t.svo.helpId==e}),i=this._othersHelps.indexOf(t);-1!=i&&(this._othersHelps.splice(i,1),t.clear(),Laya.Pool.recover(h.VO_SIGN,t))},h.prototype.getFreeHelpNum=function(){return tb.TB_guild_set.getSet().free_help_num-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.dailyFreeHelpNum)},h.prototype.isFreeHelp=function(){return 0<this.getFreeHelpNum()},h.prototype.getCostNum=function(){return tb.TB_guild_set.getSet().cost_help_max-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.guildHelpBuyNum)},h.prototype.isCostMax=function(){return this.getCostNum()<=0},h.prototype.isReawrdBX=function(){return 0<App.hero.getlimitValue(iface.tb_prop.limitTypeKey.guildHelpAwardNum)},h.prototype.isCanRewardBX=function(){return u.GuildModel.getInstance().isHasGuild()&&!this.isReawrdBX()&&this.isAllRewardFinish()},h.prototype.isCanAskHelp=function(){if(!u.GuildModel.getInstance().isHasGuild())return!1;var t=tb.TB_guild_set.getSet().daily_help_num;return this._hasRequestMy?this.getAskHelpNum()<t:App.hero.guildHelpNum<t},h.prototype.isCanRewardSuipian=function(){return u.GuildModel.getInstance().isHasGuild()&&this._myHelpList.some(function(t){return t.isCanReward()})},h.prototype.isCanHelpOthers=function(){return u.GuildModel.getInstance().isHasGuild()&&this.isFreeHelp()&&0<this._othersHelps.length},h.prototype.requestMyHelpList=function(){var n=this;return new Promise(function(i){!n._hasRequestMy||0!=n.getAskHelpNum()&&!n.isAllFinish()?PLC.request(Protocol.guild_guildHelp_getMyGuildHelpList,null,function(t){if(t){n.updateHelpList(t.guildHelpList);var e=!n._hasRequestMy;n._hasRequestMy=!0,dispatchEvt(new u.GuildEvent(u.GuildEvent.UPDATE_MY_HELP_LIST),e),i()}else i()}):i()})},h.prototype.requestOthersHelpList=function(){var i=this;return new Promise(function(e){PLC.request(Protocol.guild_guildHelp_getGuildHelpList,null,function(t){t&&(i.updateOthersHelp(t.guildHelpList),dispatchEvt(new u.GuildEvent(u.GuildEvent.UPDATE_OTHERS_HELP_LIST))),e()})})},h.VO_SIGN="guild_help_vo",h);function h(){this._isAllFinish=!1,this._isAllRewardFinish=!1,this._hasRequestMy=!1,this._myHelpList=[],this._othersHelps=[],this._myHelpIds=[]}u.GuildHelpModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var t,e=(t=ui.guild.hall.MemberInfoRenderUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=iface.tb_prop.guildJobTypeKey;this.lbName.text=t.name,this.lbTime.text=1==t.online?"在线":GameUtil.getTimePrev(t.logoutTime),this.lbTime.color=1==t.online?ColorConst.TASK_GREEN:ColorConst.GRAY,this.headBox.dataSource=new UserHeadVo(t.head,t.level,t.headFrame),this.lbJob.text=t.job==e.president?"会长":t.job==e.vicePresident?" 副会长":"成员",this.lbJob.color=t.job==e.president?ColorConst.LIGHT_STH:t.job==e.vicePresident?ColorConst.PURPLE:ColorConst.normalFont,this.lbForce.text="神力:"+t.force;var i=t.playerId==App.hero.playerId;if(this.btnSetup.visible=!i,!i){var n=s.GuildModel.getInstance().guildInfo,o=n.job==e.president,a=n.job==e.vicePresident;if(o||a)this.btnSetup.visible=o||t.job!=e.vicePresident;else{var r=1!=t.online&&App.serverTimeSecond-t.logoutTime>=TimeConst.ONE_DAY_SEC*tb.TB_guild_set.getSet().usurper_time[0];this.btnSetup.visible=t.job==e.president&&r}}this.headBox.on(Laya.Event.CLICK,this,this.showMemberInfo),this.btnSetup.on(Laya.Event.CLICK,this,this.onSetup)}else this.headBox.dataSource=null,this.headBox.off(Laya.Event.CLICK,this,this.showMemberInfo),this.btnSetup.off(Laya.Event.CLICK,this,this.onSetup)},i.prototype.showMemberInfo=function(){var t=this.dataSource;if(t&&t.playerId!=App.hero.playerId){var e=new s.GuildEvent(s.GuildEvent.SHOW_GUILD_PANEL);dispatchEvt(new s.HudEvent(s.HudEvent.SHOW_PLAYER_INFO_VIEW),{playerId:t.playerId,event:e})}},i.prototype.onSetup=function(){var t=this.dataSource;t&&UIMgr.showUI(UIConst.GuildMemberSetView,t)},i);function i(){return t.call(this)||this}s.MemberInfoRender=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.guild.hall.GuildSetUpUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.GuildSetUpView,closeOnSide:this.isModelClose,title:"设置"},this._counterBar=new common.CounterBar,this._counterBar.setComponent(this.btnAddOne,this.btnAddTen,this.btnRedOne,this.btnRedTen,this.inputLv),this.btn_sure.on(Laya.Event.CLICK,this,this.sure),this.btn_zhaomu.on(Laya.Event.CLICK,this,this.zhaomu),this.btnLeft.on(Laya.Event.CLICK,this,this.onLeft),this.btnRight.on(Laya.Event.CLICK,this,this.onRight)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this)},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.initView=function(){var t=e.GuildModel.getInstance().guildInfo;this._curLv=t.limitLevel,this._maxLv=100,this._counterBar.setInitData(this._curLv,this._maxLv,this.setLv.bind(this)),this.setLv(),this._needYZ=t.autoJoin==iface.tb_prop.guildAutoJoinTypeKey.no,this.updateBtn()},n.prototype.setLv=function(){this._curLv=this._counterBar.getCurNum(),this.inputLv.text=this._curLv.toString()},n.prototype.updateBtn=function(){this.lbYanzheng.text=this._needYZ?"需要验证":"直接加入",this.btnLeft.gray=this._needYZ,this.btnRight.gray=!this._needYZ},n.prototype.sure=function(){var t=this._needYZ?iface.tb_prop.guildAutoJoinTypeKey.no:iface.tb_prop.guildAutoJoinTypeKey.yes;dispatchEvt(new e.GuildEvent(e.GuildEvent.CHANGE_GUILD_SETTING,[Number(this.inputLv.text),t]))},n.prototype.zhaomu=function(){var t=this._needYZ?iface.tb_prop.guildAutoJoinTypeKey.no:iface.tb_prop.guildAutoJoinTypeKey.yes;dispatchEvt(new e.GuildEvent(e.GuildEvent.GUILD_ZHAOMU,[Number(this.inputLv.text),t]))},n.prototype.onLeft=function(){this.btnLeft.gray||(this._needYZ=!this._needYZ,this.updateBtn())},n.prototype.onRight=function(){this.btnRight.gray||(this._needYZ=!this._needYZ,this.updateBtn())},n);function n(){var t=i.call(this)||this;return t._curLv=1,t._maxLv=0,t._needYZ=!1,t}e.GuildSetUpView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.guild.hall.GuildNoticeUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.initView=function(){this.bgPanel.dataSource={uiName:UIConst.GuildNoticeView,closeOnSide:this.isModelClose,title:"公告"},this.btn_sure.on(Laya.Event.CLICK,this,this.onSure),this.btn_cancel.on(Laya.Event.CLICK,this,this.onExit),this.are_putin.on(Laya.Event.INPUT,this,this.onPutText),this.are_putin.text=this.dataSource||""},n.prototype.onPutText=function(){this.label_residuetext.text=LanMgr.getLan("可输入文字：{0}",-1,Math.max(0,60-this.are_putin.text.length))},n.prototype.onSure=function(){var t=this.are_putin.text;t&&""!=t&&dispatchEvt(new e.GuildEvent(e.GuildEvent.CHANGE_GUILD_NOTICE,t))},n.prototype.onExit=function(){UIMgr.hideUIByName(UIConst.GuildNoticeView)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.btn_sure.off(Laya.Event.CLICK,this,this.onSure),this.btn_cancel.off(Laya.Event.CLICK,this,this.onExit),this.are_putin.off(Laya.Event.INPUT,this,this.onPutText)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}e.GuildNoticeView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var i,t=(i=ui.guild.hall.MemberSetupUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this._model=r.GuildModel.getInstance(),this.btnOpt1.on(Laya.Event.CLICK,this,this.onOpt),this.btnOpt2.on(Laya.Event.CLICK,this,this.onOpt),this.btnOpt3.on(Laya.Event.CLICK,this,this.onOpt),this.bgPanel.dataSource={uiName:UIConst.GuildMemberSetView,closeOnSide:this.isModelClose,title:"xx"}},e.prototype.onClosed=function(){i.prototype.onClosed.call(this)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){var t=this.dataSource,e=this._model.guildInfo,i=e.job==iface.tb_prop.guildJobTypeKey.president,n=e.job==iface.tb_prop.guildJobTypeKey.vicePresident;this.btnOpt1.visible=this.btnOpt2.visible=this.btnOpt3.visible=!0,i?(this.btnOpt1.label=LanMgr.getLan("",10522),this.btnOpt1.dataSource={type:r.GuildMemberOptType.zhuanrang_hz},this.btnOpt2.label=t.job==iface.tb_prop.guildJobTypeKey.vicePresident?LanMgr.getLan("",10523):LanMgr.getLan("",10524),this.btnOpt2.dataSource={type:t.job==iface.tb_prop.guildJobTypeKey.vicePresident?r.GuildMemberOptType.bamian_fhz:r.GuildMemberOptType.renming_fhz},this.btnOpt3.label=LanMgr.getLan("",10525),this.btnOpt3.dataSource={type:r.GuildMemberOptType.zhuchu_gh}):n?(this.btnOpt1.visible=this.btnOpt2.visible=!1,this.btnOpt3.label=t.job==iface.tb_prop.guildJobTypeKey.president?LanMgr.getLan("",10526):LanMgr.getLan("",10525),this.btnOpt3.dataSource={type:t.job==iface.tb_prop.guildJobTypeKey.president?r.GuildMemberOptType.cuanwei:r.GuildMemberOptType.zhuchu_gh}):(this.btnOpt1.visible=this.btnOpt2.visible=!1,this.btnOpt3.label=LanMgr.getLan("",10526),this.btnOpt3.dataSource={type:r.GuildMemberOptType.cuanwei}),this.lbContent.text=LanMgr.getLan("",10527,t.name),this.bgPanel.updateTitle(t.name)},e.prototype.onOpt=function(t){var e=this.dataSource,i=t.currentTarget.dataSource,n=i?i.type:0;if(e&&0!=n)switch(n){case r.GuildMemberOptType.zhuanrang_hz:case r.GuildMemberOptType.bamian_fhz:case r.GuildMemberOptType.renming_fhz:case r.GuildMemberOptType.zhuchu_gh:var o="";n==r.GuildMemberOptType.zhuanrang_hz?o=LanMgr.getLan("",10517,e.name):n==r.GuildMemberOptType.bamian_fhz?o=LanMgr.getLan("",10518,e.name):n==r.GuildMemberOptType.renming_fhz?o=LanMgr.getLan("",10519,e.name):n==r.GuildMemberOptType.zhuchu_gh&&(o=e.job==iface.tb_prop.guildJobTypeKey.vicePresident?LanMgr.getLan("",10520,e.name):LanMgr.getLan("",10521));var a={text:o,confirmCb:function(){dispatchEvt(new r.GuildEvent(r.GuildEvent.MEMBER_SETUP_OPERATE),[n,e])},confirmNotClose:!0};common.AlertBox.showAlert(a);break;case r.GuildMemberOptType.cuanwei:dispatchEvt(new r.GuildEvent(r.GuildEvent.MEMBER_SETUP_OPERATE),[n,e])}},e);function e(){return i.call(this)||this}r.GuildMemberSetView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.guild.hall.GuildInfoUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.btn_setup.on(Laya.Event.CLICK,this,this.setup),this.btn_input.on(Laya.Event.CLICK,this,this.input),this.btn_applyList.on(Laya.Event.CLICK,this,this.onApply),this.btn_exitGuild.on(Laya.Event.CLICK,this,this.exitGuild),this.img_icon.on(Laya.Event.CLICK,this,this.changeIcon),this.btn_seticon.on(Laya.Event.CLICK,this,this.changeIcon),this.bgPanel.dataSource={uiName:UIConst.GuildInfoView,closeOnSide:this.isModelClose,title:"公会大厅"},this.list_Member.array=null,this.lbName.text=""},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.list_Member.array=null},e.prototype.initView=function(){var t=this._model;this.list_Member.array=t.getMemberList(!1),this.renderView(),this.updateMemberList()},e.prototype.renderView=function(){var t=this._model.guildInfo;this.lbGuildName.text=t.name;var e=-1!=[iface.tb_prop.guildJobTypeKey.president,iface.tb_prop.guildJobTypeKey.vicePresident].indexOf(t.job);this.btn_seticon.visible=this.btn_input.visible=e,this.btn_setup.gray=this.btn_applyList.gray=!e,this.lab_level.text=t.level+"级";var i=tb.TB_guild.get_TB_guildById(t.level);this.lab_exp.text=t.exp+"/"+i.need_exp;var n=LanMgr.getLan("",iface.tb_prop.guildAutoJoinTypeKey.yes?10153:10154);this.lab_auto.text=t.limitLevel+n,this.lab_people.text=t.num+"/"+tb.TB_guild.get_TB_guildById(t.level).limit_num,this.are_putin.text=t.notice?t.notice:LanMgr.getLan("",10152),this.updateIcon()},e.prototype.updateIcon=function(){var t=this._model.guildInfo;this.img_icon.skin=SkinUtil.getGuildHeadIconById(t.head)},e.prototype.updateMemberList=function(){var r=this;PLC.request(Protocol.guild_guild_member_list,null,function(t,e){if(t){var i=r._model;i.setMemberList(t.memberList);var n=i.getMemberList(!0);r.list_Member.array=n;var o=i.guildInfo;r.btn_exitGuild.label=LanMgr.getLan("",o.job==iface.tb_prop.guildJobTypeKey.president?10151:10150);var a=n.find(function(t){return t.job==iface.tb_prop.guildJobTypeKey.president});r.lbName.text=a?a.name:"无"}})},e.prototype.exitGuild=function(){var t=this,e=this._model.guildInfo,i=e.job==iface.tb_prop.guildJobTypeKey.president,n={text:i?LanMgr.getLan("",10514,e.name):LanMgr.getLan("",10515,e.name),confirmCb:function(){i?t.dissolveGuild():t.quitGuild()}};common.AlertBox.showAlert(n)},e.prototype.quitGuild=function(){var i=this,t={};t[Protocol.guild_guild_quit.args.playerId]=null,PLC.request(Protocol.guild_guild_quit,t,function(t,e){t&&(i._model.updateGuildInfo(null),guildMemberChatSend(LanMgr.getLan("",10516,App.hero.name)),dispatchEvt(new n.GuildEvent(n.GuildEvent.SHOW_GUILD_INIT_VIEW)),UIMgr.hideUIByName(UIConst.GuildInfoView))})},e.prototype.dissolveGuild=function(){var i=this;PLC.request(Protocol.guild_guild_dissolve,null,function(t,e){t&&(i._model.updateGuildInfo(null),dispatchEvt(new n.GuildEvent(n.GuildEvent.SHOW_GUILD_INIT_VIEW)),UIMgr.hideUIByName(UIConst.GuildInfoView))})},e.prototype.input=function(){this._model.isController()?UIMgr.showUI(UIConst.GuildNoticeView,this._model.guildInfo.notice):showToast(LanMgr.getLan("",10412))},e.prototype.changeIcon=function(){if(this._model.isController()){var t=this._model,e={type:n.GuildIconChangeType.infoChange,iconId:t.guildInfo.head,list_icon:t.getIconList()};dispatchEvt(new n.GuildEvent(n.GuildEvent.CHANGE_GUILD_ICON),e)}else showToast(LanMgr.getLan("",10412))},e.prototype.setup=function(){this._model.isController()?UIMgr.showUI(UIConst.GuildSetUpView):showToast(LanMgr.getLan("",10412))},e.prototype.onApply=function(){this._model.isController()?dispatchEvt(new n.GuildEvent(n.GuildEvent.SHOW_APPLY_VIEW)):showToast(LanMgr.getLan("",10412))},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t._model=n.GuildModel.getInstance(),t}n.GuildInfoView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"GuildHallProcessor"},i.prototype.listenModuleEvents=function(){return[new r.GuildEvent(r.GuildEvent.UPDATE_MEMBER_LIST),new r.GuildEvent(r.GuildEvent.UPDATE_APPLY_LIST),new r.GuildEvent(r.GuildEvent.SHOW_APPLY_VIEW),new r.GuildEvent(r.GuildEvent.CHANGE_GUILD_NOTICE),new r.GuildEvent(r.GuildEvent.CHANGE_GUILD_SETTING),new r.GuildEvent(r.GuildEvent.MEMBER_SETUP_OPERATE),new r.GuildEvent(r.GuildEvent.GUILD_ZHAOMU),new r.GuildEvent(r.GuildEvent.GUILD_HALL_VIEW_CHANGEICON)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof r.GuildEvent)switch(t.type){case r.GuildEvent.SHOW_APPLY_VIEW:this.showApplyView();break;case r.GuildEvent.UPDATE_MEMBER_LIST:this.updateMemberList();break;case r.GuildEvent.UPDATE_APPLY_LIST:this.updateApplyList();break;case r.GuildEvent.CHANGE_GUILD_NOTICE:this.sendNotice(t.data);break;case r.GuildEvent.CHANGE_GUILD_SETTING:this.changeSet(t.data);break;case r.GuildEvent.MEMBER_SETUP_OPERATE:this.memberOperate(t.data);break;case r.GuildEvent.GUILD_ZHAOMU:this.onZhaomo(t.data);break;case r.GuildEvent.GUILD_HALL_VIEW_CHANGEICON:this.changeGuildIcon(t.data)}},i.prototype.showApplyView=function(){var n=this;PLC.request(Protocol.guild_guild_apply_list,null,function(t,e){if(t){var i=n._model;i.setApplyList(t.applyList),i.getApplyList().length<=0?showToast(LanMgr.getLan("",10155)):UIMgr.showUI(UIConst.GuildApplyListView)}})},i.prototype.updateMemberList=function(){this.guildInfoView&&this.guildInfoView.updateMemberList()},i.prototype.updateApplyList=function(){var i=this;PLC.request(Protocol.guild_guild_apply_list,null,function(t,e){t&&(i._model.setApplyList(t.applyList),UIMgr.hasStage(UIConst.GuildApplyListView)&&i.guildApplyListView.updateApplyList())})},i.prototype.sendNotice=function(n){var o=this,t={};t[Protocol.guild_guild_notice_modify.args.notice]=n,PLC.request(Protocol.guild_guild_notice_modify,t,function(t,e){if(t){var i=o._model.guildInfo;i&&(i.notice=n),guildMemberChatSend(n),UIMgr.hideUIByName(UIConst.GuildNoticeView),o.guildInfoView&&o.guildInfoView.renderView()}})},i.prototype.changeSet=function(t){var o=this,e=t[0],i=t[1],n={};n[Protocol.guild_guild_set.args.level]=e,n[Protocol.guild_guild_set.args.auto]=i,PLC.request(Protocol.guild_guild_set,n,function(t,e){if(t){var i=o._model.guildInfo,n=t.guildInfo?t.guildInfo:{};n.hasOwnProperty("autoJoin")&&(i.autoJoin=n.autoJoin),n.hasOwnProperty("limitLevel")&&(i.limitLevel=n.limitLevel),UIMgr.hideUIByName(UIConst.GuildSetUpView),o.guildInfoView&&o.guildInfoView.renderView()}})},i.prototype.memberOperate=function(t){var e=t[0],i=t[1];switch(e){case r.GuildMemberOptType.zhuanrang_hz:case r.GuildMemberOptType.bamian_fhz:case r.GuildMemberOptType.renming_fhz:this.appointMember(e,i);break;case r.GuildMemberOptType.zhuchu_gh:this.kickMember(i);break;case r.GuildMemberOptType.cuanwei:this.cuanwei(i)}},i.prototype.appointMember=function(i,n){var o=this,t=iface.tb_prop.guildJobTypeKey;if(i==r.GuildMemberOptType.renming_fhz&&this._model.getMemberNum(t.vicePresident)>=tb.TB_guild_set.getSet().vice_chairman_num)showToast(LanMgr.getLan("",10406,tb.TB_guild_set.getSet().vice_chairman_num));else{var a=i==r.GuildMemberOptType.zhuanrang_hz?t.president:i==r.GuildMemberOptType.renming_fhz?t.vicePresident:t.member,e={};e[Protocol.guild_guild_appoint.args.playerId]=n.playerId,e[Protocol.guild_guild_appoint.args.job]=a,PLC.request(Protocol.guild_guild_appoint,e,function(t,e){t&&(n.job=a,i==r.GuildMemberOptType.zhuanrang_hz&&(o._model.guildInfo.job=iface.tb_prop.guildJobTypeKey.member,guildMemberChatSend("会长"+App.hero.name+"退位让贤，将会长职位传给了"+n.name)),o.updateMemberList(),common.AlertBox.close(),UIMgr.hideUIByName(UIConst.GuildMemberSetView))})}},i.prototype.kickMember=function(i){var n=this;if(i){var t={};t[Protocol.guild_guild_quit.args.playerId]=i.playerId,PLC.request(Protocol.guild_guild_quit,t,function(t,e){t&&(guildMemberChatSend("道不同不相为谋，会长将"+i.name+"踢出了公会。"),n.updateMemberList(),common.AlertBox.close(),UIMgr.hideUIByName(UIConst.GuildMemberSetView))})}},i.prototype.cuanwei=function(t){var i=this,e=this._model.guildInfo.job==iface.tb_prop.guildJobTypeKey.vicePresident,n=e?tb.TB_guild_set.getSet().usurper_time[0]:tb.TB_guild_set.getSet().usurper_time[1];1!=t.online&&App.serverTimeSecond-t.logoutTime>=TimeConst.ONE_DAY_SEC*n?PLC.request(Protocol.guild_guild_guildUsurp,null,function(t,e){t&&(i.updateMemberList(),common.AlertBox.close(),UIMgr.hideUIByName(UIConst.GuildMemberSetView))}):showToast(LanMgr.getLan("",e?10407:10408,n))},i.prototype.changeGuildIcon=function(t){var i=this,e={};e[Protocol.guild_guild_setHead.args.head]=t.tbHead.ID,PLC.request(Protocol.guild_guild_setHead,e,function(t,e){t?(UIMgr.hideUIByName(UIConst.IconChangeView),i._model.guildInfo.head=t.guildInfo.head,UIMgr.getUIByName(UIConst.GuildInfoView)&&UIMgr.getUIByName(UIConst.GuildInfoView).updateIcon()):UIMgr.hideUIByName(UIConst.IconChangeView)})},i.prototype.onZhaomo=function(t){var o=this,e=t[0],i=t[1],n=tb.TB_guild_set.getSet().daily_recruit_num,a=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.guildRecruitNum);if(n<=a)showToast(LanMgr.getLan("",10409));else{var r=tb.TB_guild_set.getSet().recruit_cost[a]||0,s=r<=0?LanMgr.getLan("",10511):LanMgr.getLan("",10512,r),u=LanMgr.getLan("",10513,s,n-a);common.AlertBox.showAlert({text:u,confirmCb:function(){if(0<r&&App.hero.diamond<r)showToast(LanMgr.getLan("",10005));else{var t={};t[Protocol.guild_guild_sendGuildRecruitNotice.args.level]=e,t[Protocol.guild_guild_sendGuildRecruitNotice.args.auto]=i,PLC.request(Protocol.guild_guild_sendGuildRecruitNotice,t,function(t,e){if(t){showToast(LanMgr.getLan("",10411));var i=o._model.guildInfo,n=t.guildInfo?t.guildInfo:{};n.hasOwnProperty("autoJoin")&&(i.autoJoin=n.autoJoin),n.hasOwnProperty("limitLevel")&&(i.limitLevel=n.limitLevel),o.guildInfoView&&o.guildInfoView.renderView()}})}}})}},Object.defineProperty(i.prototype,"guildInfoView",{get:function(){return UIMgr.getUIByName(UIConst.GuildInfoView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"guildApplyListView",{get:function(){return UIMgr.getUIByName(UIConst.GuildApplyListView)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=r.GuildModel.getInstance(),t}r.GuildHallProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var t,e=(t=ui.guild.hall.GuildApplyRenderUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;t?(this.lab_name.text=t.name,this.lab_level.text=t.level+LanMgr.getLan("级",-1),this.lab_power.text=String(Math.round(t.force)),this.btn_yes.on(Laya.Event.CLICK,this,this.apply,[0]),this.btn_no.on(Laya.Event.CLICK,this,this.apply,[1])):(this.lab_name.text="",this.lab_level.text="",this.btn_yes.off(Laya.Event.CLICK,this,this.apply),this.btn_no.off(Laya.Event.CLICK,this,this.apply))},i.prototype.apply=function(t){var a=this.dataSource,e={};e[Protocol.guild_guild_apply_opt.args.type]=t,e[Protocol.guild_guild_apply_opt.args.playerId]=a.playerId,PLC.request(Protocol.guild_guild_apply_opt,e,function(e,t){if(e&&(e.addMember&&(guildMemberChatSend("欢迎"+a.name+"加入了大家庭，一同求道！"),dispatchEvt(new r.GuildEvent(r.GuildEvent.UPDATE_MEMBER_LIST))),e.delApply)){var i=r.GuildModel.getInstance(),n=i.getApplyList();i.setApplyList(n.filter(function(t){return t.playerId!=e.delApply}));var o=UIMgr.getUIByName(UIConst.GuildApplyListView);o&&o.updateApplyList()}})},i);function i(){return t.call(this)||this}r.GuildApplyRender=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var i,t=(i=ui.guild.hall.GuildApplyListUI,__extends(e,i),e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.list_apply.array=null,this.bgPanel.dataSource=null,this.btn_allyes.off(Laya.Event.CLICK,this,this.oneKey),this.btn_allno.off(Laya.Event.CLICK,this,this.oneKey)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){this.list_apply.array=null,this.btn_allyes.on(Laya.Event.CLICK,this,this.oneKey,[0]),this.btn_allno.on(Laya.Event.CLICK,this,this.oneKey,[1]),this.updateApplyList(),this.bgPanel.dataSource={uiName:UIConst.GuildApplyListView,closeOnSide:this.isModelClose,title:"申请列表"}},e.prototype.updateApplyList=function(){var t=this._model.getApplyList();t.sort(function(t,e){return e.applyTime-t.applyTime}),this.list_apply.array=t,this.img_side.visible=6<=t.length},e.prototype.oneKey=function(u){var h=this._model;if(0!=h.getApplyList().length){var t={};t[Protocol.guild_guild_apply_opt.args.type]=u,t[Protocol.guild_guild_apply_opt.args.playerId]=null,PLC.request(Protocol.guild_guild_apply_opt,t,function(i,t){if(i&&(i.delApplyList||1==u)){if(1==u)h.setApplyList([]);else{var n=h.getApplyList();if(i.addMemberList&&0<i.addMemberList.length){for(var e=0;e<i.addMemberList.length;e++)guildMemberChatSend("欢迎"+i.addMemberList[e].name+"加入了大家庭，一同求道！");dispatchEvt(new l.GuildEvent(l.GuildEvent.UPDATE_MEMBER_LIST))}function o(e){if(!i.addMemberList||!i.addMemberList.some(function(t){return t.playerId==i.delApplyList[e]})){var t=n.find(function(t){return t.playerId==i.delApplyList[e]});t&&(a+=t.name+",")}}var a="";for(e=0;e<i.delApplyList.length;e++)o(e);function r(e){n=n.filter(function(t){t.playerId,i.delApplyList[e]})}for(""!=a&&showToast((a=a.substr(0,a.length-1))+LanMgr.getLan("",10405)),e=0;e<i.delApplyList.length;e++)r(e);h.setApplyList(n)}var s=UIMgr.getUIByName(UIConst.GuildApplyListView);s&&s.updateApplyList()}})}},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t._model=l.GuildModel.getInstance(),t}l.GuildApplyListView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"GuildProcessor"},i.prototype.listenModuleEvents=function(){return[new n.GuildEvent(n.GuildEvent.SHOW_GUILD_PANEL),new n.GuildEvent(n.GuildEvent.SHOW_GUILD_HALL_VIEW),new n.GuildEvent(n.GuildEvent.SHOW_GUILD_BATTLE_VIEW),new n.GuildEvent(n.GuildEvent.SHOW_GUILD_COPY_VIEW),new n.GuildEvent(n.GuildEvent.SHOW_GUILD_SKILL_VIEW),new n.GuildEvent(n.GuildEvent.SHOW_GUILD_DONATION_VIEW),new n.GuildEvent(n.GuildEvent.SHOW_GUILD_SHOP_VIEW),new n.GuildEvent(n.GuildEvent.SHOW_GUILD_INIT_VIEW),new n.GuildEvent(n.GuildEvent.SHOW_GUILD_HELP_VIEW)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof n.GuildEvent)switch(t.type){case n.GuildEvent.SHOW_GUILD_PANEL:this.showGuildPanel();break;case n.GuildEvent.SHOW_GUILD_HALL_VIEW:this.showHallView();break;case n.GuildEvent.SHOW_GUILD_SKILL_VIEW:this.showSkillView();break;case n.GuildEvent.SHOW_GUILD_COPY_VIEW:this.showCopyView();break;case n.GuildEvent.SHOW_GUILD_DONATION_VIEW:this.showDonationView();break;case n.GuildEvent.SHOW_GUILD_BATTLE_VIEW:this.showBattleView();break;case n.GuildEvent.SHOW_GUILD_SHOP_VIEW:this.showShopView();break;case n.GuildEvent.SHOW_GUILD_INIT_VIEW:this.showInitView();break;case n.GuildEvent.SHOW_GUILD_HELP_VIEW:this.showHelpView(t.data)}},i.prototype.showGuildPanel=function(t){var e=this,i=this._model;i.checkGuildExist(!0).then(function(){i.guildInfo?UIMgr.showUI(UIConst.GuildMainView):e.showInitView(),t&&t(!!i.guildInfo)})},i.prototype.showHallView=function(){UIMgr.showUI(UIConst.GuildInfoView)},i.prototype.showSkillView=function(){UIMgr.showUI(UIConst.GuildSkillView),n.GuildSkillModel.getInstance().check=!1,dispatchEvt(new n.GuildEvent(n.GuildEvent.GUILD_SKILL_SUCCESS))},i.prototype.showCopyView=function(){var t=this._model;t.checkGuildExist(!0).then(function(){t.guildInfo?UIMgr.showUI(UIConst.GuildCopyView):UIMgr.showUI(UIConst.GuildinitView)})},i.prototype.showDonationView=function(){UIMgr.showUI(UIConst.GuildDonationView)},i.prototype.showHelpView=function(e){UIMgr.hasStage(UIConst.GuildMainView)?UIMgr.showUI(UIConst.GuildHelpView,e):this.showGuildPanel(function(t){t&&UIMgr.showUI(UIConst.GuildHelpView,e)})},i.prototype.showBattleView=function(){var t=n.GuildFightModel.getInstance();if(t.openTime>App.serverTimeSecond){var e=t.openTime-App.serverTimeSecond,i=void 0;return i=86400<e?Math.ceil(e/86400)+"天":3600<e?Math.ceil(e/3600)+"小时":Math.ceil(e/86400)+"分钟",void showToast(LanMgr.getLan("",10404,i))}t.fightThreadVo.requestSeason().then(function(){t.isStart()?t.fightThreadVo.requestMatchInfo().then(function(){0==t.matchType?UIMgr.showUI(UIConst.FightMainView):UIMgr.showUI(UIConst.FightWaitView)}):UIMgr.showUI(UIConst.FightWaitView)})},i.prototype.showShopView=function(){dispatchEvt(new n.ShopEvent(n.ShopEvent.SHOW_SHOP_VIEW),ShopType.guild)},i.prototype.showInitView=function(){UIMgr.showUI(UIConst.GuildinitView),UIMgr.hideUIByName(UIConst.GuildMainView),UIMgr.hideUIByName(UIConst.GuildInfoView),UIMgr.hideUIByName(UIConst.GuildCopyView),UIMgr.hideUIByName(UIConst.GuildDonationView),UIMgr.hideUIByName(UIConst.FightMainView),UIMgr.hideUIByName(UIConst.GuildSkillView)},i);function i(){var t=e.call(this)||this;return t._model=n.GuildModel.getInstance(),t}n.GuildProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"GuildModule"},n.prototype.listProcessors=function(){return[new t.GuildProcessor,new t.GuildInitProcessor,new t.GuildHallProcessor,new t.GuildDonationProcessor,new t.GuildCopyProcessor,new t.GuildSkillProcessor,new t.GuildFightProcessor,new t.GuildHelpProcessor]},n.prototype.onRegister=function(){t.GuildModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.GuildModule=i;var o,a,r,s,u,h=(o=tl3d.BaseEvent,__extends(l,o),l.SHOW_GUILD_PANEL="SHOW_GUILD_PANEL",l.UPDATE_MEMBER_LIST="UPDATE_MEMBER_LIST",l.UPDATE_APPLY_LIST="UPDATE_APPLY_LIST",l.UPDATE_APPLY_INFO="UPDATE_APPLY_INFO",l.SHOW_GUILD_HALL_VIEW="SHOW_GUILD_HALL_VIEW",l.SHOW_GUILD_SKILL_VIEW="SHOW_GUILD_SKILL_VIEW",l.SHOW_GUILD_COPY_VIEW="SHOW_GUILD_COPY_VIEW",l.SHOW_GUILD_DONATION_VIEW="SHOW_GUILD_DONATION_VIEW",l.SHOW_GUILD_BATTLE_VIEW="SHOW_GUILD_BATTLE_VIEW",l.SHOW_GUILD_SHOP_VIEW="SHOW_GUILD_SHOP_VIEW",l.SHOW_GUILD_INIT_VIEW="SHOW_GUILD_INIT_VIEW",l.SHOW_GUILD_HELP_VIEW="SHOW_GUILD_HELP_VIEW",l.CREATE_GUILD="CREATE_GUILD",l.CHANGE_GUILD_ICON="CHANGE_GUILD_ICON",l.CREATE_GUILD_CHANGEICON="CREATE_GUILD_CHANGEICON",l.GUILD_HALL_VIEW_CHANGEICON="GUILD_HALL_VIEW_CHANGEICON",l.SHOW_APPLY_VIEW="SHOW_APPLY_VIEW",l.UPDATE_GUILD_INFO="UPDATE_GUILD_INFO",l.CHANGE_GUILD_NOTICE="CHANGE_GUILD_NOTICE",l.CHANGE_GUILD_SETTING="CHANGE_GUILD_SETTING",l.MEMBER_SETUP_OPERATE="MEMBER_SETUP_OPERATE",l.GUILD_ZHAOMU="GUILD_ZHAOMU",l.GUILD_DONATE="GUILD_DONATE",l.UPDATE_GUILD_DONATE="UPDATE_GUILD_DONATE",l.GUILD_DONATE_SUCCESS="GUILD_DONATE_SUCCESS",l.SHOW_COPY_RULE="SHOW_COPY_RULE",l.SHOW_COPY_RANK="SHOW_COPY_RANK",l.SHOW_ATKEND_RANK="SHOW_ATKEND_RANK",l.SHOW_COPY_TONGGUAN_REWARD="SHOW_COPY_TONGGUAN_REWARD",l.SHOW_COPY_JISHA_REWARD="SHOW_COPY_JISHA_REWARD",l.SHOW_CHALLENGE_NUM_BUY="SHOW_CHALLENGE_NUM_BUY",l.GUANQIA_FIGHT="GUANQIA_FIGHT",l.GUILD_COPY_SWEEP="GUILD_COPY_SWEEP",l.RECEIVE_TONGGUAN_JIANGLI="RECEIVE_TONGGUAN_JIANGLI",l.RECEIVE_JIANGLI_SUCCESS="RECEIVE_JIANGLI_SUCCESS",l.UPDATE_JIANGLI_INFO="UPDATE_JIANGLI_INFO",l.GUILD_SKILL_LEVELUP="GUILD_SKILL_LEVELUP",l.GUILD_SKILL_RESET="GUILD_SKILL_RESET",l.GUILD_SKILL_SUCCESS="GUILD_SKILL_SUCCESS",l.SHOW_FIGHT_RULE_VIEW="SHOW_FIGHT_RULE_VIEW",l.SHOW_GRADE_CHEST_VIEW="SHOW_GRADE_CHEST_VIEW",l.SHOW_SEASON_AWARD_VIEW="SHOW_SEASON_AWARD_VIEW",l.SHOW_HONOR_HALL_VIEW="SHOW_HONOR_HALL_VIEW",l.SHOW_PERSON_RANK_VIEW="SHOW_PERSON_RANK_VIEW",l.SHOW_GROUP_RANK_VIEW="SHOW_GROUP_RANK_VIEW",l.JOIN_FIGHT="JOIN_FIGHT",l.CHECK_PREV_GAME="CHECK_PREV_GAME",l.CHALLENGE_ENEMY="CHALLENGE_ENEMY",l.UPDATE_MATCH_INFO="UPDATE_MATCH_INFO",l.JOIN_FIGHT_SUCCESS="JOIN_FIGHT_SUCCESS",l.REWARD_CHEST_SUCCESS="REWARD_CHEST_SUCCESS",l.UPDATE_WAR_REDPOINT="UPDATE_WAR_REDPOINT",l.SHOW_ASK_HELP_VIEW="SHOW_ASK_HELP_VIEW",l.REWARD_HELPED_ITEM="REWARD_HELPED_ITEM",l.REWARD_HELPED_ITEM_SUCC="REWARD_HELPED_ITEM_SUCC",l.HELP_CLICK_BAOXIANG="HELP_CLICK_BAOXIANG",l.HELP_CLICK_BAOXIANG_SUCC="HELP_CLICK_BAOXIANG_SUCC",l.SEND_CHAT_HELP="GH_SEND_CHAT_HELP",l.SEND_ASK_HELP="SEND_ASK_HELP",l.SEND_ASK_HELP_SUCC="SEND_ASK_HELP_SUCC",l.HELP_OTHERS="GH_HELP_OTHERS",l.HELP_OTHERS_SUCC="HELP_OTHERS_SUCC",l.UPDATE_MY_HELP_LIST="UPDATE_MY_HELP_LIST",l.UPDATE_OTHERS_HELP_LIST="UPDATE_OTHERS_HELP_LIST",l);function l(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.GuildEvent=h,(a=t.GuildIconChangeType||(t.GuildIconChangeType={}))[a.createChange=0]="createChange",a[a.infoChange=1]="infoChange",(r=t.GuildSkillType||(t.GuildSkillType={}))[r.shengming=1]="shengming",r[r.gongji=2]="gongji",r[r.fangyu=3]="fangyu",r[r.sudu=4]="sudu",(s=t.GuildGrade||(t.GuildGrade={}))[s.qingtong=1]="qingtong",s[s.baiyin=2]="baiyin",s[s.bojin=3]="bojin",s[s.wangzhe=4]="wangzhe",(u=t.GuildMemberOptType||(t.GuildMemberOptType={}))[u.zhuanrang_hz=1]="zhuanrang_hz",u[u.bamian_fhz=2]="bamian_fhz",u[u.renming_fhz=3]="renming_fhz",u[u.zhuchu_gh=4]="zhuchu_gh",u[u.cuanwei=5]="cuanwei"}(game=game||{}),function(a){var t=(n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.prototype.initModel=function(){App.IsSysOpen(ModuleConst.GONGHUI)&&this.checkGuildExist(!0)},n.prototype.initData=function(){if(this.isHasGuild()&&!this._isInited){this._isInited=!0,this._donationList=[];var t=TableData.getInstance().getTableByName(TableData.tb_guild_donate).data;for(var e in t)this._donationList.push(new a.GuildDonationVo(t[e]));a.GuildCopyModel.getInstance().initModel(),a.GuildSkillModel.getInstance().initModel(),a.GuildFightModel.getInstance().initModel(),a.GuildHelpModel.getInstance().initModel()}},Object.defineProperty(n.prototype,"createInitIconID",{get:function(){return this._createInitIconID},set:function(t){this._createInitIconID=t},enumerable:!0,configurable:!0}),n.prototype.getIconList=function(){if(!this._iconList){this._iconList=[];for(var t=tb.TB_guild_icon.get_TB_guild_icon(),e=0;e<t.length;e++)this._iconList.push(new a.IconVo(t[e]))}return this._iconList},n.prototype.getIcon=function(t){for(var e=tb.TB_guild_icon.get_TB_guild_icon(),i=0,n=e;i<n.length;i++){var o=n[i];if(o.ID==t)return new a.IconVo(o)}return new a.IconVo(e[0])},n.prototype.updateGuildInfo=function(t){this.guildInfo=t,App.hero.guildName=t?t.name:"",App.hero.guildId=t?t.guildId:"",App.hero.guildExp=t?t.exp:0,this.initData(),dispatchEvt(new a.GuildEvent(a.GuildEvent.UPDATE_GUILD_INFO))},n.prototype.updateGuildExp=function(t){this.guildInfo&&(this.guildInfo.exp=t)},n.prototype.checkGuildExist=function(t){return new Promise(function(i){t?PLC.request(Protocol.guild_guild_info,null,function(t,e){n.getInstance().updateGuildInfo(t?t.guildInfo:null),i()}):i()})},n.prototype.isHasGuild=function(){return App.hero.guildId&&""!=App.hero.guildId},n.prototype.setMemberList=function(t){this._memberList=t;var e=this._memberList.find(function(t){return t.playerId==App.hero.playerId});e&&(this.guildInfo.job=e.job)},n.prototype.getMemberList=function(t){void 0===t&&(t=!1);var e=this._memberList||[];return t&&e.sort(function(t,e){if(1!=t.online||1!=e.online)return 1==t.online?-1:1==e.online?1:e.logoutTime-t.logoutTime;var i=t.job==iface.tb_prop.guildJobTypeKey.president?0:t.job==iface.tb_prop.guildJobTypeKey.vicePresident?1:2,n=e.job==iface.tb_prop.guildJobTypeKey.president?0:e.job==iface.tb_prop.guildJobTypeKey.vicePresident?1:2;return i!=n?i-n:e.force-t.force}),e},n.prototype.getMemberNum=function(e){return 0==e?this._memberList.length:this._memberList.filter(function(t){return t.job==e}).length},n.prototype.updateNewApply=function(t){this.hasNewApply=t,dispatchEvt(new a.GuildEvent(a.GuildEvent.UPDATE_APPLY_INFO))},n.prototype.setApplyList=function(t){this.hasNewApply=!1,this._applyList=t,dispatchEvt(new a.GuildEvent(a.GuildEvent.UPDATE_APPLY_INFO))},n.prototype.getApplyList=function(){return this._applyList?this._applyList:[]},n.prototype.isHasNewApply=function(){return this.hasNewApply||0<this.getApplyList().length},n.prototype.requestGuildList=function(){var i=this;return new Promise(function(e){PLC.request(Protocol.guild_guild_list,null,function(t){t&&i.setGuildList(t.guildList),e()})})},n.prototype.setGuildList=function(t){this._guildList=t},n.prototype.getGuildList=function(){return this._guildList?this._guildList:[]},n.prototype.getDonationList=function(){return this._donationList},n.prototype.isCanDonate=function(){return this.isHasGuild()&&0==App.hero.getlimitValue(iface.tb_prop.limitTypeKey.guildDonate)},n.prototype.isController=function(){return!!this.guildInfo&&-1!=[iface.tb_prop.guildJobTypeKey.president,iface.tb_prop.guildJobTypeKey.vicePresident].indexOf(this.guildInfo.job)},n);function n(){this._isInited=!1,this._createInitIconID=1,this.hasNewApply=!1,this._donationList=[]}a.GuildModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.guild.GuildMainUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.close=function(t,e){i.prototype.close.call(this,t,e),Laya.timer.clearAll(this),this.removeEff(),this.boxHall.off(Laya.Event.CLICK,this,this.onBtnClick),this.boxSkill.off(Laya.Event.CLICK,this,this.onBtnClick),this.boxCopy.off(Laya.Event.CLICK,this,this.onBtnClick),this.boxDonate.off(Laya.Event.CLICK,this,this.onBtnClick),this.boxFight.off(Laya.Event.CLICK,this,this.onBtnClick),this.boxShop.off(Laya.Event.CLICK,this,this.onBtnClick),this.boxHelp.off(Laya.Event.CLICK,this,this.onBtnClick)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),UIMgr.hideUIByName(UIConst.SysTopView),this.anil_help.gotoAndStop(0)},n.prototype.initView=function(){var t=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.guildDonate];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:t,funList:null,closeCallback:this.onFanhui.bind(this)}),this.playEff(),this.boxHall.on(Laya.Event.CLICK,this,this.onBtnClick),this.boxSkill.on(Laya.Event.CLICK,this,this.onBtnClick),this.boxCopy.on(Laya.Event.CLICK,this,this.onBtnClick),this.boxDonate.on(Laya.Event.CLICK,this,this.onBtnClick),this.boxFight.on(Laya.Event.CLICK,this,this.onBtnClick),this.boxShop.on(Laya.Event.CLICK,this,this.onBtnClick),this.boxHelp.on(Laya.Event.CLICK,this,this.onBtnClick),this.anil_help.play(0,!0)},n.prototype.playEff=function(){var e=this;this._particle||this.uiScene.addEffect(this,10000019,new tl3d.Vector3D(175,0,-450),7,30,function(t){e._particle=t}),this._particle2||this.uiScene.addEffect(this,10000018,new tl3d.Vector3D(180,0,-460),6.8,30,function(t){e._particle2=t})},n.prototype.removeEff=function(){this._particle&&(this.uiScene.removeEffect(this._particle),this._particle=null),this._particle2&&(this.uiScene.removeEffect(this._particle2),this._particle2=null)},n.prototype.onBtnClick=function(t){switch(t.target){case this.boxHall:dispatchEvt(new e.GuildEvent(e.GuildEvent.SHOW_GUILD_HALL_VIEW));break;case this.boxSkill:dispatchEvt(new e.GuildEvent(e.GuildEvent.SHOW_GUILD_SKILL_VIEW));break;case this.boxCopy:dispatchEvt(new e.GuildEvent(e.GuildEvent.SHOW_GUILD_COPY_VIEW));break;case this.boxDonate:dispatchEvt(new e.GuildEvent(e.GuildEvent.SHOW_GUILD_DONATION_VIEW));break;case this.boxFight:dispatchEvt(new e.GuildEvent(e.GuildEvent.SHOW_GUILD_BATTLE_VIEW));break;case this.boxShop:dispatchEvt(new e.GuildEvent(e.GuildEvent.SHOW_GUILD_SHOP_VIEW));break;case this.boxHelp:dispatchEvt(new e.GuildEvent(e.GuildEvent.SHOW_GUILD_HELP_VIEW))}},n.prototype.onFanhui=function(){dispatchEvt(new e.HudEvent(e.HudEvent.RETURN_LASTVIEW,UIConst.Main3DView))},n);function n(){var t=i.call(this)||this;return t.group=UIConst.hud_group,t.uiScene=new Base2dSceneLayer,t.addChild(t.uiScene),t.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.GONGHUI),t}e.GuildMainView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.guild.copy.TongguanJiangliUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.rewardList.array=null,this.bgPanel.dataSource=null,this.tabbar.selectedIndex=-1,this.guanquaUI.onExit()},n.prototype.initView=function(){this.bgPanel.dataSource={uiName:UIConst.TongguanJiangliView,closeOnSide:this.isModelClose,closeOnButton:!1,title:"奖励"},this.tabbar.selectHandler=new Handler(this,this.onTabSelect),this.tabbar.selectedIndex=0},n.prototype.onTabSelect=function(t){-1!=t&&(0==(this.viewStack.selectedIndex=t)?this.rewardList.array=e.GuildCopyModel.getInstance().getRewardList():1==t&&this.guanquaUI.onEnter(this.dataSource))},n.prototype.refreshView=function(){this.rewardList.array=e.GuildCopyModel.getInstance().getRewardList()},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}e.TongguanJiangliView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.copy.TongguanJiangliItemRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.lbTitle.text=t.getName(),this.lbNum.text=t.getResetNumStr(),this.lbNum.visible=t.isPass(),this.rewardList.array=t.getRewardList(),this.imgReward.visible=t.isReceive(),this.btnReward.visible=!t.isReceive(),this.btnReward.label=t.isPass()?LanMgr.getLan("",10041):LanMgr.getLan("",10090),this.btnReward.gray=!t.isCanReward(),this.btnReward.on(Laya.Event.CLICK,this,this.onReward)):(this.btnReward.off(Laya.Event.CLICK,this,this.onReward),this.rewardList.array=null)},n.prototype.onReward=function(){dispatchEvt(new t.GuildEvent(t.GuildEvent.RECEIVE_TONGGUAN_JIANGLI,this.dataSource))},n);function n(){return e.call(this)||this}t.TongguanJiangliItemRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.guild.copy.JishaJiangliUI,__extends(i,e),i.prototype.onEnter=function(t){var e=this;if(t&&!this._copyVo)if(this._copyVo)this.renderView();else{this._copyVo=new n.GuildChallengeVo,this._copyVo.setGuanqiaVo(t);var i={};i[Protocol.guild_guildCopy_copyInfo.args.id]=t.tbCopy.ID,PLC.request(Protocol.guild_guildCopy_copyInfo,i,function(t){t&&(e._copyVo.setSvo(t),e.renderView())})}},i.prototype.renderView=function(){if(this._copyVo){var t=this._copyVo.guanqiaVo.getRewardList();if(this.rewardList.array=t,this.rewardList.width=t.length*(90+this.rewardList.spaceX),this.rankList.array=this._copyVo.guanqiaVo.getRankList(),this._copyVo.svo){var e=0==this._copyVo.getSelfRank()?LanMgr.getLan("",10028):LanMgr.getLan("",10029,this._copyVo.getSelfRank());this.lbDesc.text=LanMgr.getLan("",10080,this._copyVo.svo.totalDamage)+"     "+e}}},i.prototype.onExit=function(){this._copyVo=null,this.rewardList.array=null,this.rankList.array=null},i);function i(){var t=e.call(this)||this;return t.rewardList.array=null,t.rankList.array=null,t}n.JishaJiangliView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.copy.JishaJiangliItemRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(3<t.rank?(this.imgRank.visible=!1,this.lbRank.visible=!0,this.lbRank.text=t.rankStr.toString()):(this.imgRank.visible=!0,this.lbRank.visible=!1,this.imgRank.skin=SkinUtil.getRankSkin(t.rank)),this.rewardList.array=t.rewardList):this.rewardList.array=null},n);function n(){return e.call(this)||this}t.JishaJiangliItemRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.RankIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){if(this.ui_view.dataSource={rank:t.rank},"DamageRank"==t.type)this.headBox.dataSource=new UserHeadVo(t.head,t.level,t.headFrame),this.lbName.text=t.name,this.boxMid.visible=!1,this.lbBottomDesc.text="神力: ",this.lbBottom.text=t.force,this.lbValueDesc.text="伤害",this.lbValue.text=String(Math.round(t.value));else if("GuildRank"==t.type){this.lbName.text=t.name,this.boxMid.visible=!1,this.lbBottomDesc.text="会长: ",this.lbBottom.text=t.leaderName,this.lbValueDesc.text="最高关卡",this.lbValue.text=t.desc;var e=new UserHeadVo(t.head,t.level,t.headFrame,!0);this.headBox.dataSource=e}}else this.headBox.dataSource=null},n);function n(){return e.call(this)||this}t.GuildRankItemRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.copy.GuildGuanqiaUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.lab_title.text=t.getName(),this.img_icon.skin=SkinUtil.getHeadIcon(t.monster.icon);var e=!t.isPass()&&!t.isCurrent();this.box_icon.gray=e,this.imgSuo.visible=e}else this.ani_select.gotoAndStop(0),this.ani1.gotoAndStop(0)},n.prototype.setSelected=function(t){(this.ani_select.visible=t)?this.ani_select.loadAnimation(ResConst.anim_circle_select,Handler.create(this,function(){this.ani_select.play(),this.ani1.play(0,!0)}),ResConst.atlas_circle_select):(this.ani_select.gotoAndStop(0),this.ani1.gotoAndStop(0))},n);function n(){return e.call(this)||this}t.GuildGuanqiaItemRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var n,t=(n=ui.guild.copy.GuildCopyUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.GuildCopyView,closeOnSide:this.isModelClose,title:"公会副本"},this._model=s.GuildCopyModel.getInstance(),this._itemList=[];for(var t=1;t<=3;t++)this._itemList.push(this["item"+t]);for(this.uiScene=new Base2dSceneLayer,this.topBox.addChild(this.uiScene),this.uiScene.setModelBox(this,this.topBox,this.lab_name),this.bgPanel.box_Content.addChild(this.img_bg),this.btnPrev.on(Laya.Event.CLICK,this,this.onClick),this.btnNext.on(Laya.Event.CLICK,this,this.onClick),this.btnRank.on(Laya.Event.CLICK,this,this.onClick),this.btnRule.on(Laya.Event.CLICK,this,this.onClick),this.btnReward.on(Laya.Event.CLICK,this,this.onClick),this.btnChallenge.on(Laya.Event.CLICK,this,this.onClick),this.btn_sweep.on(Laya.Event.CLICK,this,this.onClick),this.btnBuy.on(Laya.Event.CLICK,this,this.onClick),t=0;t<this._itemList.length;t++)this._itemList[t].on(Laya.Event.CLICK,this,this.onClickGuanqia)},e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this,t,e,i),this.uiScene.onExit(),Laya.timer.clear(this,this.delayShow),this._curGuanqia=null,this._startIdx=0,this._modeid=0},e.prototype.initView=function(){this.uiScene.onShow(),this._startIdx=this._model.getCurCopyIdx(),this.updateChapterData(this._startIdx),this.updateCount()},e.prototype.updateChapterData=function(t){var e=this._model.getCopyList(),i=e.length;if(this.btnPrev.disabled=0==t,this.btnNext.disabled=i-3<=t,!(t<0||i-3<t)){this._startIdx=t;var n=e.slice(t,t+3);this._curGuanqia||(this._curGuanqia=n.find(function(t){return t.isCurrent()})||n[n.length-1]);for(var o=0;o<this._itemList.length;o++)this._itemList[o].dataSource=n[o];this._curGuanqia&&this.renderGuanqia(this._curGuanqia)}},e.prototype.renderGuanqia=function(t){var n=this;this._curGuanqia=t;for(var e=0;e<this._itemList.length;e++){var i=this._itemList[e].dataSource;this._itemList[e].setSelected(i==t)}if(this._curGuanqia&&this._curGuanqia.isCurrent()?(this.btnChallenge.label=LanMgr.getLan("",10093),this.btn_sweep.visible=!0,this.btnChallenge.x=378):(this.btnChallenge.label=LanMgr.getLan("",10094),this.btn_sweep.visible=!1,this.btnChallenge.x=258),this._curGuanqia){var o=tb.TB_monster.get_TB_monsterById(this._curGuanqia.tbCopy.getMonterId());this.lab_name.text=LanMgr.getLan("{0}Lv{1}",-1,o.name,o.level)}else this.lab_name.text="";if(this.btn_sweep.removeChild(this.ui_red_sweep),this._curGuanqia&&this._curGuanqia.isCurrent()?this.btnChallenge.addChild(this.btn_red):this.btnChallenge.removeChild(this.btn_red),Laya.timer.once(200,this,this.delayShow.bind(this)),this._curGuanqia.isCurrent()){var a=s.GuildCopyModel.getInstance().copyChallengeVo;a.setGuanqiaVo(t);var r={};r[Protocol.guild_guildCopy_copyInfo.args.id]=t.tbCopy.ID,PLC.request(Protocol.guild_guildCopy_copyInfo,r,function(t){if(t){a.setSvo(t);var e=a.getMonstersRestBlood();n.lbBlood.text=e+"/"+a.getMonstersBlood(),n.pbBlood.value=e/a.getMonstersBlood();var i=s.GuildModel.getInstance().guildInfo;i&&t.hasOwnProperty("copyId")&&t.copyId&&(i.copyId=t.copyId),n._curGuanqia&&n._curGuanqia.isCurrent()?(n.btnChallenge.label=LanMgr.getLan("",10093),n.btn_sweep.visible=!0,n.btnChallenge.x=378,n.btnChallenge.addChild(n.btn_red),a.isKillMonsters(App.hero.playerId)?n.btn_sweep.addChild(n.ui_red_sweep):n.btn_sweep.removeChild(n.ui_red_sweep)):(n.btnChallenge.label=LanMgr.getLan("",10094),n.btn_sweep.visible=!1,n.btnChallenge.x=258,n.btnChallenge.removeChild(n.btn_red),n.btn_sweep.removeChild(n.ui_red_sweep))}else n.grayGuanqia(),s.GuildModel.getInstance().checkGuildExist(!0)})}else this.grayGuanqia()},e.prototype.updateGuanQiaInfo=function(t){if(t&&this._curGuanqia&&t.tbCopy.ID==this._curGuanqia.tbCopy.ID){for(var e=0,i=this._itemList;e<i.length;e++)i[e].refreshData();this.renderGuanqia(t),this.updateCount()}},e.prototype.onClickGuanqia=function(t){var e=t.currentTarget.dataSource;e.isPass()||e.isCurrent()?this.renderGuanqia(e):showToast(LanMgr.getLan("",10014))},e.prototype.onClick=function(t){var e=t.target,i=s.GuildCopyModel.getInstance();switch(e){case this.btnNext:var n=this._model.getCopyList();this._startIdx<n.length-3&&this.updateChapterData(this._startIdx+1);break;case this.btnPrev:0<this._startIdx&&this.updateChapterData(this._startIdx-1);break;case this.btnRank:dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_COPY_RANK,this._curGuanqia));break;case this.btnRule:dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_COPY_RULE));break;case this.btnReward:dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_COPY_TONGGUAN_REWARD,this._curGuanqia));break;case this.btnBuy:dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_CHALLENGE_NUM_BUY));break;case this.btnChallenge:if(!this._curGuanqia)return;this._curGuanqia.isCurrent()?(o=i.copyChallengeVo).svo&&dispatchEvt(new s.GuildEvent(s.GuildEvent.GUANQIA_FIGHT,i.copyChallengeVo)):dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_ATKEND_RANK,this._curGuanqia));break;case this.btn_sweep:if(!this._curGuanqia)return;var o;this._curGuanqia.isCurrent()&&(o=i.copyChallengeVo).svo&&dispatchEvt(new s.GuildEvent(s.GuildEvent.GUILD_COPY_SWEEP,o))}},e.prototype.updateCount=function(){this.lbNum.text=LanMgr.getLan("",10081," "+App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.guildCopyNum))},e.prototype.grayGuanqia=function(){this.lbBlood.text="0/"+(this._curGuanqia?this._curGuanqia.monster.getPropValByType(1):0),this.pbBlood.value=0,this.btnChallenge.label=LanMgr.getLan("",10094),this.btnChallenge.removeChild(this.btn_red),this.btn_sweep.removeChild(this.ui_red_sweep)},e.prototype.delayShow=function(){if(this._curGuanqia&&this._curGuanqia.tbCopy.model!=this._modeid){var t=this.lab_name.localToGlobal(new Laya.Point(0,0));this._modeid=this._curGuanqia.tbCopy.model,this.uiScene.addModelChar(this._modeid+"",t.x+this.lab_name.width/2-Launch.offsetX,t.y-50-Launch.offsetY,180,1.8),this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_02,2)}},e);function e(){var t=n.call(this)||this;return t._startIdx=0,t}s.GuildCopyView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.copy.GuildCopySweepResultUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this,!1,!1),this.initView()},n.prototype.initView=function(){this.bgPanel.showTitle(!0,"comp/title/saodangchenggong.png",!0,!0,!0,Handler.create(this,this.showTitleComplete),this),AudioMgr.playSound("sound/victory.mp3");var t=this.dataSource,e=t.battleEndData;this.lbRank.text=LanMgr.getLan("",10029,t.getRank()),this.lbDamage.text=LanMgr.getLan("",10086,t.getCurDamage()),this.lbTotalDamage.text=LanMgr.getLan("",10087,t.getTotalDamage()),this.updateCount();var i=new Array;e.commonData&&UIUtil.getRewardItemVoList(i,e.commonData),e.firstData&&UIUtil.getRewardItemVoList(i,e.firstData,!0),this._listVo=new ListVo(this.rewardList);var n=(Laya.stage.height-this.height>>1)+this.rewardList.y;this.rewardList.AutoLayout(this.width,i),this._listVo.setHeight(100),this._listVo.setPosition(this.rewardList.x+Launch.offsetX,n),this._listVo._dataSource=i,this.btn_again.visible=this.lab_count.visible=t.getMonstersBlood()>t.getTotalDamage(),this.btn_close.x=this.btn_again.visible?172:(this.width-this.btn_close.width)/2,this.btn_again.on(Laya.Event.CLICK,this,this.onClickAgain)},n.prototype.updateCount=function(){this.lab_count.text=LanMgr.getLan("",10081,App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.guildCopyNum))},n.prototype.showTitleComplete=function(){this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),this._efflist=common.EffectList.showEffectList(this._listVo)},n.prototype.close=function(){this.dataSource&&dispatchEvt(new t.FightsEvent(t.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource.copyVo),e.prototype.close.call(this)},n.prototype.onClickAgain=function(){if(App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.guildCopyNum)<=0)return App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyGuildCopyNum)>=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.guildCopyBuyNum)?void showToast(LanMgr.getLan("",10084)):void dispatchEvt(new t.GuildEvent(t.GuildEvent.SHOW_CHALLENGE_NUM_BUY));dispatchEvt(new t.GuildEvent(t.GuildEvent.GUILD_COPY_SWEEP,this.dataSource))},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.bgPanel.closeTitle(),this.btn_again.off(Laya.Event.CLICK,this,this.onClickAgain),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),this.rewardList.array=null},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t.closeEffect=null,t.btn_close.on(Laya.Event.CLICK,t,t.close),t}t.GuildCopySweepResultView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var i,t=(i=ui.guild.copy.DamageRankUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.tab.selectedIndex=-1,this._damageRankList=null,this._guildRankList=null},e.prototype.initView=function(){this.resetText(),this.tab.selectedIndex=0},e.prototype.updateView=function(){var o=this;if(this._curGuanqia&&this.dataSource&&this.dataSource.tbCopy.ID==this._curGuanqia.tbCopy.ID&&this._damageRankList)this.renderDamaList();else{this.lbRank.text=this.damagerankinfo,this._curGuanqia=this.dataSource;var t=this._curGuanqia,e={};e[Protocol.guild_guildCopy_copyInfo.args.id]=t.tbCopy.ID,PLC.request(Protocol.guild_guildCopy_copyInfo,e,function(t){if(t){var e=t.rankInfo?t.rankInfo:{};for(var i in o._damageRankList=[],o.lbRank.text="",e){var n={type:"DamageRank"};n.rank=parseInt(i),n.playerId=e[i][0],n.name=e[i][1],n.head=e[i][2],n.level=e[i][3],n.force=Math.ceil(e[i][4]),n.headFrame=e[i][5],n.value=e[i][6],o._damageRankList.push(n),n.playerId==App.hero.playerId&&(o.damagerankinfo="我的排名:"+parseInt(i)+"    我的伤害:"+Math.round(n.value))}o.renderDamaList()}})}},e.prototype.renderDamaList=function(){var t=this._damageRankList?this._damageRankList:[];this.rankList.array=t,this.lbRank.text=this.damagerankinfo,this.lab_empty.visible=!t||0==t.length},e.prototype.onTabSelect=function(t){0==(this.viewstack.selectedIndex=t)?this.updateView():this.updateGuild()},e.prototype.updateGuild=function(){var r=this;this._guildRankList||(this.lbRank.text=this.guildrankinfo,PLC.request(Protocol.guild_guild_copyRankList,null,function(t){if(t){r._guildRankList=[];for(var e=t.copyRankList?t.copyRankList:[],i=0;i<e.length;i++){var n=e[i];n.type="GuildRank",n.rank=i+1;var o=tb.TB_guild_copy.getItemnById(n.copyId);n.desc=o?o.getName():"无",r._guildRankList.push(n)}var a=s.GuildCopyModel.getInstance().getGuanqiaById(t.rankValue);a&&(r.guildrankinfo="我的排名:"+(t.myRank||0)+"    最高关卡:"+a.getName()),r.renderGuildList()}})),this.renderGuildList()},e.prototype.renderGuildList=function(){var t=this._guildRankList?this._guildRankList:[];this.rewardList.array=t,this.lbRank.text=this.guildrankinfo,this.lab_empty.visible=!t||0==t.length},e.prototype.resetText=function(){this.damagerankinfo="我的排名:无    我的伤害:0",this.guildrankinfo="我的排名:无    最高关卡:无"},e);function e(){var t=i.call(this)||this;return t.damagerankinfo="",t.guildrankinfo="",t.isModelClose=!0,t.rewardList.array=tb.TB_arena_new.get_TB_arena_new(),t.tab.selectHandler=new Handler(t,t.onTabSelect),t.bgPanel.dataSource={uiName:UIConst.DamageRankView,closeOnSide:!0,closeOnButton:!0,title:"公会副本排行"},t}s.DamageRankView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.guild.copy.atkEndRankUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this)},n.prototype.initView=function(){this.rankList.array=null,this.updateView()},n.prototype.updateView=function(){var o=this;if(this._curGuanqia&&this.dataSource&&this.dataSource.tbCopy.ID==this._curGuanqia.tbCopy.ID&&this._damageRankList)this.renderDamaList();else{this._curGuanqia=this.dataSource;var t=this._curGuanqia,e={};e[Protocol.guild_guildCopy_copyInfo.args.id]=t.tbCopy.ID,PLC.request(Protocol.guild_guildCopy_copyInfo,e,function(t){if(t){var e=t.rankInfo?t.rankInfo:{};for(var i in o._damageRankList=[],o.lbRank.text="",e){var n={type:"DamageRank"};n.rank=parseInt(i),n.playerId=e[i][0],n.name=e[i][1],n.head=e[i][2],n.level=e[i][3],n.force=Math.ceil(e[i][4]),n.headFrame=e[i][5],n.value=e[i][6],o._damageRankList.push(n),e[i][0]==App.hero.playerId&&(o.lbRank.text="我的排名:"+parseInt(i)+"    我的伤害:"+Math.round(n.value))}o.renderDamaList()}})}},n.prototype.renderDamaList=function(){var t=this._damageRankList?this._damageRankList:[];this.rankList.array=t},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.AtkEndRankView,closeOnSide:!0,closeOnButton:!0,title:"击杀排行"},t}t.AtkEndRankView=e}(game=game||{}),function(t){var e=(i.prototype.getRewardList=function(){if(!this._rewardList){this._rewardList=[];for(var t=0;t<this.tbReward.reward.length;t++)this._rewardList.push(new ItemVo(this.tbReward.reward[t][0],this.tbReward.reward[t][1]))}return this._rewardList},i.prototype.getName=function(){return"通关第"+3*this.tbReward.ID+"关"},i.prototype.getSortNum=function(){var t=this.tbReward.ID;return this.isCanReward()?t:this.isReceive()?1e4+t:1e3+t},i.prototype.getResetNumStr=function(){return LanMgr.getLan("",10089,this.awardCount)},i.prototype.isReceive=function(){return 0<App.hero.guildCopyAwardInfo[this.tbReward.ID]},i.prototype.isPass=function(){return t.GuildCopyModel.getInstance().isPass(this.tbGuanqia.ID)},i.prototype.isCanReward=function(){return this.isPass()&&!this.isReceive()&&0<this.awardCount},i);function i(t){this.awardCount=0,this.tbReward=t,this.tbGuanqia=tb.TB_guild_copy.getItemnById(10*t.ID+3),this.tbGuanqia||logerror("不存在该关卡")}t.GuildRewardVo=e}(game=game||{}),function(o){var t=(e.prototype.getRewardList=function(){if(!this._rewardList){this._rewardList=[];for(var t=0;t<this.tbCopy.attack_reward.length;t++)this._rewardList.push(new ItemVo(this.tbCopy.attack_reward[t][0],this.tbCopy.attack_reward[t][1]))}return this._rewardList},e.prototype.getRankList=function(){return this._rankList||(this._rankList=[],this._rankList.push(this.getRankVo(1,this.tbCopy.rank_1)),this._rankList.push(this.getRankVo(2,this.tbCopy.rank_2)),this._rankList.push(this.getRankVo(3,this.tbCopy.rank_3)),this._rankList.push(this.getRankVo(4,this.tbCopy.rank_4))),this._rankList},e.prototype.getRankVo=function(t,e){for(var i=[],n=0;n<e.length;n++)i.push(new ItemVo(e[n][0],e[n][1]));return{rank:t,rewardList:i,rankStr:t<=3?t:"4-10"}},e.prototype.getName=function(){return this.tbCopy.getName()},e.prototype.isPass=function(){return o.GuildCopyModel.getInstance().isPass(this.tbCopy.ID)},e.prototype.isCurrent=function(){var t=o.GuildModel.getInstance().guildInfo,e=t?t.copyId:0,i=o.GuildCopyModel.getInstance().getGuanqiaIds(),n=i.indexOf(e);return i[n+1]==this.tbCopy.ID},e.prototype.isFirst=function(){return o.GuildCopyModel.getInstance().getGuanqiaIds()[0]==this.tbCopy.ID},e.prototype.isLast=function(){var t=o.GuildCopyModel.getInstance().getGuanqiaIds();return t[t.length-1]==this.tbCopy.ID},e);function e(t,e){this.tbCopy=t,this.index=e,t.index=e;var i=this.tbCopy.getMonterId();this.monster=tb.TB_monster.get_TB_monsterById(i)}o.GuildGuanqiaVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"GuildCopyProcessor"},i.prototype.listenModuleEvents=function(){return[new r.GuildEvent(r.GuildEvent.SHOW_COPY_RULE),new r.GuildEvent(r.GuildEvent.SHOW_COPY_RANK),new r.GuildEvent(r.GuildEvent.SHOW_ATKEND_RANK),new r.GuildEvent(r.GuildEvent.SHOW_COPY_TONGGUAN_REWARD),new r.GuildEvent(r.GuildEvent.SHOW_COPY_JISHA_REWARD),new r.GuildEvent(r.GuildEvent.SHOW_CHALLENGE_NUM_BUY),new r.GuildEvent(r.GuildEvent.GUANQIA_FIGHT),new r.GuildEvent(r.GuildEvent.RECEIVE_TONGGUAN_JIANGLI),new r.GuildEvent(r.GuildEvent.GUILD_COPY_SWEEP)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof r.GuildEvent)switch(t.type){case r.GuildEvent.SHOW_COPY_RULE:this.showRule();break;case r.GuildEvent.SHOW_COPY_RANK:this.showRank(t.data);break;case r.GuildEvent.SHOW_ATKEND_RANK:this.showAtkEndRank(t.data);break;case r.GuildEvent.SHOW_COPY_TONGGUAN_REWARD:this.showTongguanReward(t.data);break;case r.GuildEvent.SHOW_COPY_JISHA_REWARD:this.showJishaReward(t.data);break;case r.GuildEvent.SHOW_CHALLENGE_NUM_BUY:this.showBuyNum();break;case r.GuildEvent.GUANQIA_FIGHT:this.guanqiaFight(t.data);break;case r.GuildEvent.RECEIVE_TONGGUAN_JIANGLI:this.receiveJiangli(t.data);break;case r.GuildEvent.GUILD_COPY_SWEEP:this.guanqiaSweep(t.data)}},i.prototype.showRule=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20002))},i.prototype.showRank=function(t){UIMgr.showUI(UIConst.DamageRankView,t)},i.prototype.showAtkEndRank=function(t){UIMgr.showUI(UIConst.AtkEndRankView,t)},i.prototype.showTongguanReward=function(t){var e=this;UIMgr.hasStage(UIConst.TongguanJiangliView)?this.jiangliView.refreshView():UIMgr.showUI(UIConst.TongguanJiangliView,t),PLC.request(Protocol.guild_guildCopy_rewardInfo,null,function(t){t&&(r.GuildCopyModel.getInstance().setAwardCount(t.awardCount),UIMgr.hasStage(UIConst.TongguanJiangliView)&&e.jiangliView.refreshView())})},i.prototype.showJishaReward=function(t){UIMgr.showUI(UIConst.JishaJiangliView,t)},i.prototype.showBuyNum=function(){var i=this;App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyGuildCopyNum)>=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.guildCopyBuyNum)?App.hero.vip<tb.TB_vip.getMaxVip()?showToast(LanMgr.getLan("",10082)):showToast(LanMgr.getLan("",10401)):UIMgr.showUI(UIConst.BuyBattleCount,{type:common.BuyBattleCountView.TYPE_GUILDCOPY,callback:function(t){var e={};e[Protocol.game_common_buyGuildCopyBattleCnt.args.count]=t,PLC.request(Protocol.game_common_buyGuildCopyBattleCnt,e,function(t){if(t&&(i.copyView.updateCount(),UIMgr.hasStage(UIConst.GuildCopySweepResultView))){var e=UIMgr.getUIByName(UIConst.GuildCopySweepResultView);e&&e.updateCount()}})}})},i.prototype.guanqiaSweep=function(n){var o=this;if(!UIUtil.checkUnableToEnterFight())if(n.isPass())showToast(LanMgr.getLan("",10083));else{if(App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.guildCopyNum)<=0)return App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyGuildCopyNum)>=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.guildCopyBuyNum)?void showToast(LanMgr.getLan("",10084)):void this.showBuyNum();n.isKillMonsters(App.hero.playerId)?common.AlertBox.showAlert({text:LanMgr.getLan("",10510,App.hero.guildCopyMaxDmg[n.tbCopy.ID]),confirmCb:function(t){var e={};e[Protocol.game_guildCopy_sweepGuildCopy.args.id]=t.tbCopy.ID,PLC.request(Protocol.game_guildCopy_sweepGuildCopy,e,function(t){if(t){var e=r.GuildModel.getInstance().guildInfo;if(e&&t.hasOwnProperty("copyId")&&t.copyId&&(e.copyId=t.copyId),o.copyView.updateGuanQiaInfo(n.guanqiaVo),n.battleEndData=t||{},n.enemyLossHp={1:n.getTotalDamage()-n.svo.totalDamage},n.svo.totalDamage=n.getTotalDamage(),UIMgr.hasStage(UIConst.GuildCopySweepResultView)){var i=UIMgr.getUIByName(UIConst.GuildCopySweepResultView);i&&(i.dataSource=n,i.initView())}else UIMgr.showUI(UIConst.GuildCopySweepResultView,n)}})},parm:n}):showToast(LanMgr.getLan("",10402))}},i.prototype.guanqiaFight=function(e){var i=this;if(!UIUtil.checkUnableToEnterFight())if(e.isPass())showToast(LanMgr.getLan("",10083));else{if(App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.guildCopyNum)<=0)return App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyGuildCopyNum)>=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.guildCopyBuyNum)?void showToast(LanMgr.getLan("",10084)):void this.showBuyNum();var t={};t[Protocol.guild_guildCopy_copyBattleStart.args.id]=e.tbCopy.ID,PLC.request(Protocol.guild_guildCopy_copyBattleStart,t,function(t){if(!t)return i.copyView.grayGuanqia(),void r.GuildModel.getInstance().checkGuildExist(!0).then(function(){showToast(LanMgr.getLan("",10403))});e.svo.mosterInfo=t.mosterInfo,i.doFight(e)})}},i.prototype.doFight=function(i){var n=new r.FightVo;n.copyType=CopyType.guildCopy,n.guildGuanqiaVo=i;var t=new battle.BattleScenePve(n.copyType);t.init([n.getOwnTeam()],n.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.monster,n.getAllRound(),n.getTeamHp()),t.start();var e=t.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",e,"战报：",t.battleReport);var o=new r.ServerPage;o.result=e?playState.VICTORY:playState.FAILURE,o.initPage(t.battleReport),n.fightPageControl=o,i.enemyLossHp=n.turnTemplatID(t.getLossHpObj(battle.BatteConsts.BATTLE_CAMPDEF));var a={};a[Protocol.guild_guildCopy_copyBattleEnd.args.id]=i.tbCopy.ID,a[Protocol.guild_guildCopy_copyBattleEnd.args.damageInfo]=i.enemyLossHp,PLC.request(Protocol.guild_guildCopy_copyBattleEnd,a,function(t){if(t){i.battleEndData=t||{};var e={vo:n,event:new r.GuildEvent(r.GuildEvent.SHOW_GUILD_COPY_VIEW)};dispatchEvt(new r.FightsEvent(r.FightsEvent.ENTER_FIGHT_EVENT),e)}})},i.prototype.receiveJiangli=function(t){var e=this;if(t.isPass())if(t.awardCount<=0)showToast(LanMgr.getLan("",10091));else{var i={};i[Protocol.game_guild_getCopyReward.args.id]=t.tbReward.ID,PLC.request(Protocol.game_guild_getCopyReward,i,function(t){t?(App.hero.modifyCopyAwardCount(t),r.GuildCopyModel.getInstance().setAwardCount(t.modifyAwardCount),UIUtil.showRewardView(t.commonData),e.jiangliView.refreshView(),dispatchEvt(new r.GuildEvent(r.GuildEvent.RECEIVE_JIANGLI_SUCCESS))):e.showTongguanReward(null)})}else showToast(LanMgr.getLan("",10090))},Object.defineProperty(i.prototype,"jiangliView",{get:function(){return UIMgr.getUIByName(UIConst.TongguanJiangliView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"copyView",{get:function(){return UIMgr.getUIByName(UIConst.GuildCopyView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}r.GuildCopyProcessor=e}(game=game||{}),function(r){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.initModel=function(){this._guanqiaIds=[],this._guanqias=[];for(var t=tb.TB_guild_copy.getList(),e=0,i=t.length;e<i;e++){var n=new r.GuildGuanqiaVo(t[e],e);this._guanqias.push(n),this._guanqiaIds.push(t[e].ID)}this._guanqias.sort(function(t,e){return t.tbCopy.ID-e.tbCopy.ID}),this._guanqiaIds.sort(function(t,e){return t-e}),this._rewardList=[];var o=TableData.getInstance().getTableByName(TableData.tb_copy_reward).data;for(var a in o)this._rewardList.push(new r.GuildRewardVo(o[a]));this._rewardList.sort(function(t,e){return t.tbReward.ID-e.tbReward.ID}),this.copyChallengeVo=new r.GuildChallengeVo},e.prototype.getCopyList=function(){return this._guanqias},e.prototype.getCurCopyId=function(){var t=r.GuildModel.getInstance().guildInfo;return t?t.copyId:0},e.prototype.getCurCopyIdx=function(){var e=this.getCurCopyId(),t=0,i=this._guanqias,n=i.length;if(0<e)if(this.isAllFinish())t=n-3;else{var o=i.findIndex(function(t){return t.tbCopy.ID==e});t=n-3<=o?n-3:o}return t},e.prototype.getGuanqiaIds=function(){return this._guanqiaIds},e.prototype.getGuanqiaById=function(e){return this._guanqias.find(function(t){return t.tbCopy.ID==e})},e.prototype.isAllFinish=function(){var t=this._guanqiaIds[this._guanqiaIds.length-1];return this.getCurCopyId()==t},e.prototype.isCanChallenge=function(){return r.GuildModel.getInstance().isHasGuild()&&0<App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.guildCopyNum)&&!this.isAllFinish()},e.prototype.isPass=function(t){var e=r.GuildModel.getInstance().guildInfo;return e&&e.copyId>=t},e.prototype.updateNewAward=function(t){this.hasNewAward=t,dispatchEvt(new r.GuildEvent(r.GuildEvent.UPDATE_JIANGLI_INFO))},e.prototype.getRewardList=function(){return this._rewardList},e.prototype.setAwardCount=function(t){if(t){for(var e in t)this.getRewardById(Number(e)).awardCount=t[e];this.hasNewAward=!1,this._rewardList.sort(function(t,e){return t.getSortNum()-e.getSortNum()}),dispatchEvt(new r.GuildEvent(r.GuildEvent.UPDATE_JIANGLI_INFO))}},e.prototype.getRewardById=function(e){return this._rewardList.find(function(t){return t.tbReward.ID==e})},e.prototype.isCanReward=function(){return!!r.GuildModel.getInstance().isHasGuild()&&(this.hasNewAward||this._rewardList.some(function(t){return t.isCanReward()}))},e.prototype.getBuyCost=function(){var t=tb.TB_guild_set.getSet().buy_cost,e=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyGuildCopyNum);return e>=t.length?t[t.length-1]:t[e]},e);function e(){this._guanqiaIds=[],this._guanqias=[],this.hasNewAward=!1,this._rewardList=[]}r.GuildCopyModel=t}(game=game||{}),function(t){var e=(i.prototype.setSvo=function(t){this.svo=t},i.prototype.setGuanqiaVo=function(t){this.guanqiaVo=t,this.tbCopy=tb.TB_guild_copy.getItemnById(t.tbCopy.ID);var e=this.tbCopy.getMonterId();this.monster=tb.TB_monster.get_TB_monsterById(e)},i.prototype.getName=function(){return LanMgr.getLan("",10030,this.tbCopy.ID%10)},i.prototype.getRankList=function(){if(!this._rankList)for(var t in this._rankList=[],this.svo.rankInfo)this._rankList.push(new n(this.tbCopy,this.svo.rankInfo[t],parseInt(t)));return this._rankList},i.prototype.isKillMonsters=function(t){if(this.svo&&this.svo.rankInfo)for(var e in this.svo.rankInfo){var i=this.svo.rankInfo[e];if(i&&i[0]==t)return!0}return!1},i.prototype.getMonstersBlood=function(){return this.monster.getPropValByType(1)},i.prototype.getMonstersRestBlood=function(){var t=0;for(var e in this.svo.mosterInfo)t+=Math.ceil(this.svo.mosterInfo[e]);return t},i.prototype.getSelfRank=function(){var t=this.getRankList().find(function(t){return t.playerId==App.hero.playerId});return t?t.rank:0},i.prototype.isPass=function(){return this.getMonstersRestBlood()<=0},i.prototype.getMonstersHp=function(){for(var t=[],e=this.tbCopy.moster,i=0;i<e.length;i++){var n=e[i];if(0!=Number(n)){var o=tb.TB_monster.get_TB_monsterById(n),a=this.svo.mosterInfo[n]?this.svo.mosterInfo[n]:o.getPropValByType(1);t.push(a)}else t.push(0)}return t},i.prototype.getCurDamage=function(){var t=0;for(var e in this.enemyLossHp)t+=this.enemyLossHp[e];return Math.floor(t)},i.prototype.getTotalDamage=function(){var t=this.battleEndData.totalDamage?this.battleEndData.totalDamage:0;return Math.floor(t)},i.prototype.getRank=function(){return this.battleEndData.rank?this.battleEndData.rank:0},i);function i(){}t.GuildChallengeVo=e;var n=(o.prototype.getRewardList=function(){if(!this._rewardList){this._rewardList=[];var t=void 0;t=1==this.rank?this.tbCopy.rank_1:2==this.rank?this.tbCopy.rank_2:3==this.rank?this.tbCopy.rank_3:this.tbCopy.rank_4;for(var e=0;e<t.length;e++)this._rewardList.push(new ItemVo(t[e][0],t[e][1]))}return this._rewardList},o);function o(t,e,i){this.tbCopy=t,this.rank=i,this.playerId=e[0],this.playerName=e[1],this.head=e[2],this.level=e[3],this.damage=e[4],this.headFrame=e[5],this.headVo=new UserHeadVo(this.head,this.level,this.headFrame)}t.GuildChallengeItemVo=n}(game=game||{}),function(t){var e;(e=t.GuildUpGradeType||(t.GuildUpGradeType={}))[e.none=0]="none",e[e.up=1]="up",e[e.keep=2]="keep",e[e.down=3]="down"}(game=game||{}),function(t){var e=(i.prototype.requestSeason=function(){var n=this;return new Promise(function(e,t){var i=n._model;n.requestFlag||!i.isOpenGuildWar()?e():PLC.request(Protocol.guild_guildWar_getGuildWarSession,null,function(t){t&&(i.updateSeason(t),e())})})},i.prototype.loopRequestMatchInfo=function(){this.stopMatchLoop(),this._model.myTeamVo.getMember(App.hero.playerId)&&Laya.timer.loop(3e4,this,this.requestMatchInfo)},i.prototype.stopMatchLoop=function(){Laya.timer.clear(this,this.requestMatchInfo)},i.prototype.requestMatchInfo=function(){var n=this;return new Promise(function(e,t){var i=n._model;if(!i.isInGameTime())return n.stopMatchLoop(),e();PLC.request(Protocol.guild_guildWar_getGuildWarMatchInfo,null,function(t){i.setMatchInfo(t),e()})})},i);function i(){this.requestFlag=!1,this._model=t.GuildFightModel.getInstance()}t.GuildFightThread=e}(game=game||{}),function(o){var t=(e.prototype.setTeamInfo=function(t){if(!t)return this.teamSvo=t,this._teamList.length=0,void(this.headVo=null);if(this.teamSvo){for(var e in t)this.teamSvo[e]=t[e];for(var i in t.memberInfo)(n=this.getMember(i))&&n.setServerInfo(t.memberInfo[i])}else{for(var i in this.teamSvo=t,this._teamList.length=0,t.memberInfo){var n;(n=new o.GuildFightMemberVo(this.isMyTeam)).setServerInfo(t.memberInfo[i]),n.svo.playerId=i,this._teamList.push(n)}this.headVo=new GuildHeadVo(t.guildHead,t.guildLevel)}this._teamList.sort(function(t,e){return e.sortNum-t.sortNum})},e.prototype.getTeamList=function(){return this._teamList},e.prototype.getMember=function(e){return this._teamList.find(function(t){return t.svo.playerId==e})},e);function e(t){this.isMyTeam=t,this._teamList=[]}o.GuildFightTeamVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(__extends(n,i=BaseFightVo),n.prototype.setServerInfo=function(t){if(this.svo)for(var e in t)this.svo[e]=t[e];else this.svo=t,this.headVo=new UserHeadVo(this.svo.head,this.svo.level,this.svo.headFrame);this.lineupInfo||i.prototype.setLineupInfo.call(this,this.svo.lineupInfo),this.sortNum=t.integral+1e7*t.lifeNum},n.prototype.isDead=function(){return this.svo.lifeNum<=0},n.prototype.getLineupCurHp=function(){var t=0,e=this.svo.hpInfo;for(var i in e)isNaN(e[i])||(t+=e[i]);return t},n.prototype.getLineupGodIds=function(){for(var t=[],e=0;e<this.lineupGods.length;e++){var i=this.lineupGods[e];i&&0<this.getGodCurHp(i.templateId)?t.push(i.templateId):t.push(0)}return t},n.prototype.getEnemyGodsHpAry=function(){for(var t=[],e=this.getLineupGodIds(),i=0;i<e.length;i++){var n=e[i];0!=n?t.push(this.getGodCurHp(n)):t.push(0)}return t},n.prototype.getGodCurHp=function(t){return this.svo.hpInfo[t]?this.svo.hpInfo[t]:0},n.prototype.getEnemyHpInfo=function(t){var e={};for(var i in t){var n=this.getGodTotalHp(Number(i)),o=this.getGodCurHp(Number(i))-(t[i]?t[i]:0);o=n<(o=o<=0?0:o)?n:o,e[i]=Math.round(o)}return e},n.copy=function(t){var e=new n(t.isMyTeam),i=JSON.parse(JSON.stringify(t.svo));return e.setServerInfo(i),e},n);function n(t){var e=i.call(this)||this;return e.isMyTeam=t,e}t.GuildFightMemberVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.guild.fight.SeasonAwardUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.tabbar.selectedIndex=-1,this.awardList.array=null,this.rankList.array=null,this._rankList=null},n.prototype.initView=function(){this.awardList.array=null,this.rankList.array=null,this.lbDesc.text="暂无公会达到王者段位",this.tabbar.selectHandler=new Handler(this,this.selectTab),this.tabbar.selectedIndex=0,this.requestRank(),this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:"赛季排名"}},n.prototype.selectTab=function(t){if(-1!=t)if(0==(this.viewStack.selectedIndex=t)){for(var e=[],i=tb.TB_guild_season.get_TB_guild_season(),n=0;n<i.length;n++)e.push({rank:n+1,tbSeason:i[n]});this.awardList.array=e}else this.rankList.array=this._rankList},n.prototype.requestRank=function(){var a=this;PLC.request(Protocol.guild_guildWar_getGradeList,null,function(t){if(t){a._rankList=[];for(var e=0,i=t.gradeList;e<i.length;e++){var n=i[e];a._rankList.push(n)}a._rankList.sort(function(t,e){return e.score-t.score});for(var o=0;o<a._rankList.length;o++)a._rankList[o].rank=o+1;1==a.tabbar.selectedIndex&&(a.rankList.array=a._rankList),0<t.myRank?a.lbDesc.text="我的赛季积分:"+t.rankValue+"  我的排名:"+t.myRank:a.lbDesc.text="我的赛季积分:"+t.rankValue+"  我的排名:未入王者"}else a.lbDesc.text="暂无公会达到王者段位"})},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}t.SeasonAwardView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.guild.fight.PersonRankUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.awardList.array=null,this.rankList.array=null,this.lbDesc.text="",this._rankList=null,this.combo.selectedIndex=-1,this.tabBar.selectedIndex=-1},e.prototype.initView=function(){this.awardList.array=null,this.rankList.array=null,this.tabBar.selectHandler=new Handler(this,this.selectTab),this.combo.selectHandler=new Handler(this,this.selectTCombo),this.tabBar.selectedIndex=0,this.lbDesc.visible=!1,this.empty.visible=!1,this.requestRank(),this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:"会员排名"}},e.prototype.selectTab=function(t){if(-1!=t)if(0==(this.viewStack.selectedIndex=t)){if(-1==this.combo.selectedIndex){var e=n.GuildFightModel.getInstance().myTeamVo.teamSvo,i=e?e.guildGrade:n.GuildGrade.wangzhe;this.combo.selectedIndex=i-1}}else this.rankList.array=this._rankList},e.prototype.selectTCombo=function(t){if(-1!=t){for(var e=[],i=tb.TB_person_season.get_TB_person_season("dan",t+1),n=0;n<i.length;n++)e.push(i[n]);this.awardList.array=e}},e.prototype.requestRank=function(){var a=this;if(!n.GuildFightModel.getInstance().isJoin())return this.empty.visible=!0,void(this.lbDesc.visible=!1);PLC.request(Protocol.guild_guildWar_getMemberRankList,null,function(t){if(!t)return a.empty.visible=!0,void(a.lbDesc.visible=!1);a._rankList=[];for(var e=0,i=t.memberRankList;e<i.length;e++){var n=i[e];a._rankList.push(n)}a._rankList.sort(function(t,e){return e.score-t.score});for(var o=0;o<a._rankList.length;o++)a._rankList[o].rank=o+1;1==a.tabBar.selectedIndex&&(a.rankList.array=a._rankList),a.empty.visible=!1,a.lbDesc.visible=!0,0<t.myRank?a.lbDesc.text="我的赛季积分:"+t.rankValue+"  我的排名:"+t.myRank:a.lbDesc.text="我的赛季积分:"+t.rankValue+"  我的排名:未上榜"})},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t}n.PersonRankView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.fight.render.GuildSaiQuRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.headBox.dataSource=new UserHeadVo(t.head,t.level,t.headFrame),this.lbForce.text=LanMgr.getLan("",10117,t.force),this.lbName.text=t.name,this.lbScore.text=t.score.toString(),this.lbJifen.visible=!0,this.imgtype.visible=!1,this.ui_view.dataSource={rank:t.rank}):this.headBox.dataSource=null},n);function n(){return e.call(this)||this}t.PersonRankIRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.fight.render.GuildFightRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.lbName.text=t.svo.name,this.boxUser.dataSource=t.headVo,this.godList.array=t.getExistGods(),this.lbForce.text=LanMgr.getLan("",10117,t.svo.force),this.lbScore.text=t.svo.integral.toString();for(var e=[],i=1;i<=tb.TB_guild_war_set.getSet().atk_num;i++){var n=t.svo.atkCount>=i?SkinUtil.jian_liang:SkinUtil.jian_an;e.push(n)}for(this.atkList.array=e,e=[],i=1;i<=tb.TB_guild_war_set.getSet().life_num;i++)n=t.svo.lifeNum>=i?SkinUtil.aixin_liang:SkinUtil.aixin_an,e.push(n);this.lifeList.array=e;var o=t.getLineupCurHp(),a=t.getLineupTotalHp();this.lbBlood.text=a<=0?"0%":Math.ceil(o/a*100)+"%",this.pgBlood.value=a<=0?0:o/a,t.isMyTeam?this.btnChallenge.visible=!1:(this.btnChallenge.visible=!0,this.btnChallenge.label=t.isDead()?"已击败":"挑战",this.btnChallenge.disabled=t.isDead()),this.btnChallenge.on(Laya.Event.CLICK,this,this.onChallenge)}else this.godList.array=null,this.lifeList.array=null,this.atkList.array=null,this.btnChallenge.off(Laya.Event.CLICK,this,this.onChallenge)},n.prototype.onChallenge=function(){dispatchEvt(new t.GuildEvent(t.GuildEvent.CHALLENGE_ENEMY,this.dataSource))},n);function n(){return e.call(this)||this}t.MemberItemRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.fight.render.GuildRongyuRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.imgBg.skin=SkinUtil.getGuildQizhi(t.guildRank),this.imgEmpty.skin=SkinUtil.getGuildXuwei(t.guildRank),this.lbSvrName.fontSize=this.lbGuildName.fontSize=this.lbLeader.fontSize=this.lbForce.fontSize=1==t.guildRank?20:18,t.presidentName?(this.headBox.dataSource=new GuildHeadVo(t.guildHead,t.guildLevel),this.lbSvrName.text="区服"+t.serverName,this.lbGuildName.text="公会："+t.guildName,this.lbLeader.text="会长："+t.presidentName,this.lbForce.text=LanMgr.getLan("",10117,t.totalForce),this.imgEmpty.visible=!1,this.headBox.visible=this.lbSvrName.visible=this.lbGuildName.visible=this.lbLeader.visible=this.lbForce.visible=!0):(this.headBox.visible=this.lbSvrName.visible=this.lbGuildName.visible=this.lbLeader.visible=this.lbForce.visible=!1,this.imgEmpty.visible=!0,this.headBox.dataSource=null)):this.headBox.dataSource=null},n);function n(){return e.call(this)||this}t.HonorGuildIRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.guild.fight.render.GuildSaiQuRenderUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.headBox.dataSource=new GuildHeadVo(t.guildHead,t.guildLevel),this.lbForce.text=LanMgr.getLan("",10117,t.force),this.lbName.text=t.guildName,this.lbScore.text="积分："+t.score.toString(),this.ui_view.dataSource={rank:t.rank},t.hasOwnProperty("upType")&&t.upType!=e.GuildUpGradeType.none?(this.imgtype.visible=!0,this.lbJifen.visible=!1,this.imgtype.skin=SkinUtil.getGuildUpGradeUrl(t.upType)):(this.imgtype.visible=!1,this.lbJifen.visible=!0)):this.headBox.dataSource=null},n);function n(){return t.call(this)||this}e.GuildRankIRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.guild.fight.render.ChestItemRenderUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t){if(this.bg.skin=SkinUtil.getGuildGradeBg(t.grade),t.name){var e=new ItemVo(iface.tb_prop.resTypeKey.guildDonate,t.num);this.itemBox.dataSource=e,this.lbItemName.stroke=this.lbName.stroke=2,t.grade==o.GuildGrade.bojin?this.lbItemName.strokeColor=this.lbName.strokeColor="#bc5305":t.grade==o.GuildGrade.wangzhe?this.lbItemName.strokeColor=this.lbName.strokeColor="#d34d24":this.lbItemName.strokeColor=this.lbName.strokeColor="#374873",this.lbItemName.text=e.getName(),this.lbName.text=t.name,this.itemBox.visible=this.lbName.visible=this.lbItemName.visible=!0,this.icon.visible=!1}else this.itemBox.visible=this.lbName.visible=this.lbItemName.visible=!1,this.icon.visible=!0;this.on(Laya.Event.CLICK,this,this.onClick)}else this.off(Laya.Event.CLICK,this,this.onClick)},i.prototype.onClick=function(){var i=this,n=this.dataSource;if(n&&!n.name){var t=o.GuildFightModel.getInstance();if(t.maxGuildGrade<n.grade)return void showToast(LanMgr.getLan("",10399,o.GuildFightModel.GRADE_NAME[n.grade]));if(t.isRewardByGrade(n.grade))return void showToast(LanMgr.getLan("",10400));var e={};e[Protocol.game_guild_getGuildWarBoxReward.args.grade]=n.grade,e[Protocol.game_guild_getGuildWarBoxReward.args.pos]=n.index,PLC.request(Protocol.game_guild_getGuildWarBoxReward,e,function(t){if(t){t.hasOwnProperty("modifyBoxAwardCount")&&(App.hero.guildWarAwardCount=t.modifyBoxAwardCount),UIUtil.showRewardView(t.commonData);var e=t.modifyBoxList[n.index];e&&(n.name=e.name,n.num=e.num),i.refreshData(),dispatchEvt(new o.GuildEvent(o.GuildEvent.REWARD_CHEST_SUCCESS))}})}},i);function i(){return t.call(this)||this}o.ChestItemRender=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.fight.render.SeasonAwardIRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=t.rank;this.imgRank.visible=e<=3,this.lbName.visible=3<e,e<=3&&(this.imgRank.skin=SkinUtil.getRankingSkin(e-1));var i=t.tbSeason;this.lbName.text=i.desc,this.itemList.array=i.getRewardList()}else this.itemList.array=null},n);function n(){return e.call(this)||this}t.AwardIRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var i,t=(i=ui.guild.fight.HonorHallUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._itemList=[];for(var t=0;t<3;t++)this._itemList.push(this["item"+t]);this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.GLORY_FIGHT)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this);for(var t=0,e=this._itemList;t<e.length;t++)e[t].dataSource=null;this._requestFlag=!1,this.btnPrev.off(Laya.Event.CLICK,this,this.onPrev),this.btnNext.off(Laya.Event.CLICK,this,this.onNext),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_jiangli,redpointName:"guild_war_award",callback:this.onBaoxiang.bind(this)},{btnSkin:SkinUtil.btn_saiji,callback:this.onSaiji.bind(this)},{btnSkin:SkinUtil.btn_huiyuan,callback:this.onHuiyuan.bind(this)},{btnSkin:SkinUtil.btn_glory_hall,callback:this.onHall.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.guildDonate];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onReturn.bind(this)});var i=a.GuildFightModel.getInstance();this._curSeason=i.season-1,this._curSeason=this._curSeason<=0?1:this._curSeason;for(var n=0;n<3;n++){var o={guildRank:n+1};this._itemList[n].dataSource=o}this.btnPrev.on(Laya.Event.CLICK,this,this.onPrev),this.btnNext.on(Laya.Event.CLICK,this,this.onNext),this.updateBtn(),this._curSeason!=i.season&&this.requestList()},e.prototype.requestList=function(){var i=this;if(this._requestFlag=!0,a.GuildFightModel.getInstance().season>this._curSeason){var t={};t[Protocol.guild_guildWar_getSessionRankList.args.session]=this._curSeason,PLC.request(Protocol.guild_guildWar_getSessionRankList,t,function(t){if(t){i._requestFlag=!1;var e=t.sessionRankList;e.sort(function(t,e){return t.guildRank-e.guildRank}),i.renderList(e)}else i.renderList(null)})}else this.renderList(null)},e.prototype.renderList=function(t){for(var e=0;e<3;e++)this._itemList[e].dataSource=t&&t.length>e?t[e]:{guildRank:e+1};this._requestFlag=!1},e.prototype.onPrev=function(){this._requestFlag||(this._curSeason--,this.updateBtn(),this.requestList())},e.prototype.onNext=function(){this._requestFlag||(this._curSeason++,this.updateBtn(),this.requestList())},e.prototype.updateBtn=function(){this.lbName.text=LanMgr.getLan("S{0}赛季",-1,this._curSeason),this.btnNext.disabled=this._curSeason>=a.GuildFightModel.getInstance().season,this.btnPrev.disabled=this._curSeason<=1},e.prototype.onReturn=function(){dispatchEvt(new a.GuildEvent(a.GuildEvent.SHOW_GUILD_BATTLE_VIEW))},e.prototype.onBaoxiang=function(){dispatchEvt(new a.GuildEvent(a.GuildEvent.SHOW_GRADE_CHEST_VIEW))},e.prototype.onHall=function(){dispatchEvt(new a.GuildEvent(a.GuildEvent.SHOW_HONOR_HALL_VIEW))},e.prototype.onSaiji=function(){dispatchEvt(new a.GuildEvent(a.GuildEvent.SHOW_SEASON_AWARD_VIEW))},e.prototype.onRule=function(){dispatchEvt(new a.GuildEvent(a.GuildEvent.SHOW_FIGHT_RULE_VIEW))},e.prototype.onHuiyuan=function(){dispatchEvt(new a.GuildEvent(a.GuildEvent.SHOW_PERSON_RANK_VIEW))},e);function e(){var t=i.call(this)||this;return t._requestFlag=!1,t.group=UIConst.hud_group,t}a.HonorHallView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var i,t=(i=ui.guild.fight.GroupRankUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.rankList.array=null},e.prototype.initView=function(){this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:"赛区排名"},this.rankList.array=null,this.requestRank()},e.prototype.requestRank=function(){var s=this;PLC.request(Protocol.guild_guildWar_getGroupList,null,function(t){if(t){var e=u.GuildFightModel.getInstance();e.updateSeason(t);for(var i=t.guildGrade,n=[],o=0;o<t.groupList.length;o++)(r=t.groupList[o]).guildGrade=i,n.push(r);n.sort(function(t,e){return e.score-t.score});var a=tb.TB_dan.get_TB_danById(i);for(o=0;o<n.length;o++){var r;(r=n[o]).rank=o+1,r.upType=e.getUpgradeType(a,r.rank)}s.bgPanel.updateTitle(u.GuildFightModel.GRADE_NAME[i]+"组排名"),s.rankList.array=n}})},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t}u.GroupRankView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var i,t=(i=ui.guild.fight.GradeChestUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.itemList.array=null,this.tabbar.selectedIndex=-1},e.prototype.initView=function(){this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:"段位宝箱"},this.itemList.array=null,this.tabbar.selectHandler=new Handler(this,this.selectTab),this.tabbar.selectedIndex=0},e.prototype.selectTab=function(t){var n=this;if(-1!=t){var o=0==t?u.GuildGrade.baiyin:1==t?u.GuildGrade.bojin:u.GuildGrade.wangzhe;if(u.GuildFightModel.getInstance().maxGuildGrade>=o){var e={};e[Protocol.guild_guildWar_getBoxList.args.grade]=o,PLC.request(Protocol.guild_guildWar_getBoxList,e,function(t){if(t){for(var e=0;e<t.boxList.length;e++){var i=t.boxList[e];i.index=e,i.grade=o}n.itemList.array=t.boxList}else n.itemList.array=null})}else{for(var i=tb.TB_guild.get_TB_guildById(u.GuildModel.getInstance().guildInfo.level),a=i?i.limit_num:10,r=[],s=0;s<a;s++)r.push({index:s,grade:o});this.itemList.array=r}}},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t}u.GradeChestView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var i,t=(i=ui.guild.fight.GuildFightWaitUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._rankVo=null,Laya.timer.clear(this,this.updateTime),this.btnJoin.off(Laya.Event.CLICK,this,this.onClick),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_jiangli,redpointName:"guild_war_award",callback:this.onBaoxiang.bind(this)},{btnSkin:SkinUtil.btn_saiji,callback:this.onSaiji.bind(this)},{btnSkin:SkinUtil.btn_huiyuan,callback:this.onHuiyuan.bind(this)},{btnSkin:SkinUtil.btn_glory_hall,callback:this.onHall.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.guildDonate];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onReturn.bind(this)}),this.lbDesc.text="",this.lbNote.text="",this.imgWangzhe.visible=this.lbWangzhe.visible=!1,this.menuView.updateView();var i=s.GuildFightModel.getInstance();if(Laya.timer.clear(this,this.updateTime),i.isJoin()){if(i.isRestTime())this.btnJoin.label="查看上轮排名",this.requestRank();else if(this.btnJoin.label="已报名",1==i.matchType){var n=tb.TB_guild_war_set.getSet();this.lbNote.text=LanMgr.getLan("由于{0}级人数小于{1}人，不能参与本轮比赛",-1,n.role_level,n.guild_player_num)}else 2==i.matchType&&(this.lbNote.text=LanMgr.getLan("由于本轮轮空，直接获得积分，请静候下轮比赛",-1));var o=new Date(App.serverTime),a=o.getDay(),r=o.getHours();a==WeekNum.Sat&&r>=tb.TB_guild_war_set.getSet().end_time?(this.lbDesc.text="",Laya.timer.loop(1e3,this,this.updateTime)):(this._endTime=i.getNextStartTime(),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime())}else this.btnJoin.label="报名",this.lbDesc.text="等待会长报名中";this.btnJoin.on(Laya.Event.CLICK,this,this.onClick)},e.prototype.requestRank=function(){var i=this;PLC.request(Protocol.guild_guildWar_getGroupList,null,function(t){if(t){s.GuildFightModel.getInstance().updateSeason(t);var e=t.myRank?t.myRank:0;i._rankVo={groupList:[],upGradeType:0,guildGrade:0,myRank:e},i.imgWangzhe.visible=i.lbWangzhe.visible=0<e,i.lbWangzhe.text="王者"+e+"名"}})},e.prototype.updateTime=function(){var t=this._endTime-App.serverTimeSecond;0<t?this.lbDesc.text="下轮比赛倒计时："+GameUtil.toCountdown(t,"hh:mm:ss",1):(Laya.timer.clear(this,this.updateTime),dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_GUILD_BATTLE_VIEW)))},e.prototype.onClick=function(){var t=s.GuildFightModel.getInstance();t.isJoin()?t.isRestTime()&&(this._rankVo?dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_GROUP_RANK_VIEW)):showToast(LanMgr.getLan("",10398))):dispatchEvt(new s.GuildEvent(s.GuildEvent.JOIN_FIGHT))},e.prototype.onReturn=function(){dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_GUILD_PANEL))},e.prototype.onBaoxiang=function(){dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_GRADE_CHEST_VIEW))},e.prototype.onHall=function(){dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_HONOR_HALL_VIEW))},e.prototype.onSaiji=function(){dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_SEASON_AWARD_VIEW))},e.prototype.onRule=function(){dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_FIGHT_RULE_VIEW))},e.prototype.onHuiyuan=function(){dispatchEvt(new s.GuildEvent(s.GuildEvent.SHOW_PERSON_RANK_VIEW))},e);function e(){var t=i.call(this)||this;return t.group=UIConst.hud_group,t.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.GONGHUI_FIGHT),t}s.FightWaitView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=ui.guild.fight.GuildFightMenuUI,__extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.updateView()},i.prototype.updateView=function(){var t=n.GuildFightModel.getInstance(),e=new Date(App.serverTime).getDay();if(t.isJoin()){var i=t.myTeamVo.teamSvo;this.lbDesc.text=i?n.GuildFightModel.GRADE_NAME[i.guildGrade]+"赛 "+e+"/6":"已报名"}else this.lbDesc.text="未报名";this.lbTitle.text=LanMgr.getLan("S{0}赛季",-1,t.season)},i);function i(){return t.call(this)||this}n.FightMenuPanel=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(c){var i,t=(i=ui.guild.fight.GuildFightUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.teamList.array=null,this.atkList.array=null,Laya.timer.clear(this,this.updateTime),this.myGuildBox.off(Laya.Event.CLICK,this,this.onSelect),this.enemyGuildBox.off(Laya.Event.CLICK,this,this.onSelect),this.btnRank.off(Laya.Event.CLICK,this,this.onRank),this._model.fightThreadVo.stopMatchLoop(),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_jiangli,redpointName:"guild_war_award",callback:this.onBaoxiang.bind(this)},{btnSkin:SkinUtil.btn_saiji,callback:this.onSaiji.bind(this)},{btnSkin:SkinUtil.btn_huiyuan,callback:this.onHuiyuan.bind(this)},{btnSkin:SkinUtil.btn_glory_hall,callback:this.onHall.bind(this)}],e=this._model,i=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.guildDonate];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:i,funList:t,closeCallback:this.onReturn.bind(this)});var n=e.myTeamVo;this.lbName1.text=n.teamSvo.guildName,this.lbJifen1.text="积分："+n.teamSvo.dailyScore,this.lbForce1.text="总战斗力："+n.teamSvo.totalForce,this.myGuildBox.dataSource=n.headVo;for(var o=n.getMember(App.hero.playerId),a=o?o.svo.atkCount:0,r=[],s=1;s<=tb.TB_guild_war_set.getSet().atk_num;s++){var u=s<=a?SkinUtil.jian_liang:SkinUtil.jian_an;r.push(u)}this.atkList.array=r,this.lbGrade.text=c.GuildFightModel.GRADE_NAME[n.teamSvo.guildGrade];var h=e.enemyTeamVo;this.lbName2.text=h.teamSvo.guildName,this.lbJifen2.text="积分："+h.teamSvo.dailyScore,this.lbForce2.text="总战斗力："+h.teamSvo.totalForce,this.enemyGuildBox.dataSource=h.headVo,this.onSelect(!1),this.myGuildBox.on(Laya.Event.CLICK,this,this.onSelect,[!0]),this.enemyGuildBox.on(Laya.Event.CLICK,this,this.onSelect,[!1]),this.btnRank.on(Laya.Event.CLICK,this,this.onRank),e.fightThreadVo.loopRequestMatchInfo();var l=new Date;l.setTime(App.serverTime),l.setHours(22,0,0,0),this._endTime=Math.ceil(l.getTime()/1e3),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime()},e.prototype.updateTime=function(){var t=this._endTime-App.serverTimeSecond;0<t?this.lbTime.text=GameUtil.toCountdown(t,"hh:mm:ss"):(Laya.timer.clear(this,this.updateTime),dispatchEvt(new c.GuildEvent(c.GuildEvent.SHOW_GUILD_BATTLE_VIEW)))},e.prototype.updateView=function(){var t=this._model,e=this.imgArrow1.visible;this.teamList.array=e?t.myTeamVo.getTeamList():t.enemyTeamVo.getTeamList()},e.prototype.onSelect=function(t){this.imgArrow1.visible=t;var e=this._model.myTeamVo.getMember(App.hero.playerId);this.atkList.visible=e&&!t,this.imgArrow2.visible=!t,this.updateView()},e.prototype.onReturn=function(){dispatchEvt(new c.GuildEvent(c.GuildEvent.SHOW_GUILD_PANEL))},e.prototype.onRank=function(){dispatchEvt(new c.GuildEvent(c.GuildEvent.SHOW_GROUP_RANK_VIEW))},e.prototype.onBaoxiang=function(){dispatchEvt(new c.GuildEvent(c.GuildEvent.SHOW_GRADE_CHEST_VIEW))},e.prototype.onHall=function(){dispatchEvt(new c.GuildEvent(c.GuildEvent.SHOW_HONOR_HALL_VIEW))},e.prototype.onSaiji=function(){dispatchEvt(new c.GuildEvent(c.GuildEvent.SHOW_SEASON_AWARD_VIEW))},e.prototype.onRule=function(){dispatchEvt(new c.GuildEvent(c.GuildEvent.SHOW_FIGHT_RULE_VIEW))},e.prototype.onHuiyuan=function(){dispatchEvt(new c.GuildEvent(c.GuildEvent.SHOW_PERSON_RANK_VIEW))},e);function e(){var t=i.call(this)||this;return t.group=UIConst.hud_group,t._model=c.GuildFightModel.getInstance(),t}c.FightMainView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"GuildFightProcessor"},i.prototype.listenModuleEvents=function(){return[new u.GuildEvent(u.GuildEvent.SHOW_FIGHT_RULE_VIEW),new u.GuildEvent(u.GuildEvent.SHOW_GRADE_CHEST_VIEW),new u.GuildEvent(u.GuildEvent.SHOW_HONOR_HALL_VIEW),new u.GuildEvent(u.GuildEvent.SHOW_PERSON_RANK_VIEW),new u.GuildEvent(u.GuildEvent.SHOW_SEASON_AWARD_VIEW),new u.GuildEvent(u.GuildEvent.SHOW_GROUP_RANK_VIEW),new u.GuildEvent(u.GuildEvent.JOIN_FIGHT),new u.GuildEvent(u.GuildEvent.CHALLENGE_ENEMY),new u.GuildEvent(u.GuildEvent.UPDATE_MATCH_INFO)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof u.GuildEvent)switch(t.type){case u.GuildEvent.SHOW_FIGHT_RULE_VIEW:this.showRuleView();break;case u.GuildEvent.SHOW_GRADE_CHEST_VIEW:this.showChestView();break;case u.GuildEvent.SHOW_SEASON_AWARD_VIEW:this.showSeasonAward();break;case u.GuildEvent.SHOW_HONOR_HALL_VIEW:this.showHonorView();break;case u.GuildEvent.SHOW_PERSON_RANK_VIEW:this.showPersonRank();break;case u.GuildEvent.SHOW_GROUP_RANK_VIEW:this.showGroupRank();break;case u.GuildEvent.JOIN_FIGHT:this.join();break;case u.GuildEvent.CHALLENGE_ENEMY:this.challengeEnemy(t.data);break;case u.GuildEvent.UPDATE_MATCH_INFO:this.updateView()}},i.prototype.showRuleView=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20013))},i.prototype.showChestView=function(){UIMgr.showUI(UIConst.GradeChestView)},i.prototype.showSeasonAward=function(){UIMgr.showUI(UIConst.SeasonAwardView)},i.prototype.showHonorView=function(){UIMgr.showUI(UIConst.HonorHallView)},i.prototype.showPersonRank=function(){UIMgr.showUI(UIConst.PersonRankView)},i.prototype.showGroupRank=function(){UIMgr.showUI(UIConst.GroupRankView)},i.prototype.join=function(){var e=this;u.GuildModel.getInstance().guildInfo.job==iface.tb_prop.guildJobTypeKey.president?new Date(App.serverTime).getDay()!=WeekNum.Sat?PLC.request(Protocol.guild_guildWar_guildWarReg,null,function(t){t&&(u.GuildFightModel.getInstance().updateSeason(t),UIMgr.hasStage(UIConst.FightWaitView)&&e.fightWaitView.initView(),dispatchEvt(new u.GuildEvent(u.GuildEvent.JOIN_FIGHT_SUCCESS)))}):showToast(LanMgr.getLan("",10394)):showToast(LanMgr.getLan("",10393))},i.prototype.challengeEnemy=function(i){var n=this,t=u.GuildFightModel.getInstance().myTeamVo.getMember(App.hero.playerId);if(t)if(t.svo.atkCount<=0)showToast(LanMgr.getLan("",10396));else if(i.isDead())showToast(LanMgr.getLan("",10397));else{var e={};e[Protocol.guild_guildWar_guildWarBattleStart.args.playerId]=i.svo.playerId,PLC.request(Protocol.guild_guildWar_guildWarBattleStart,e,function(t){var e=u.GuildFightModel.getInstance();t?(e.setMatchInfo(t),n.doFight(i)):e.setMatchInfo(t)})}else showToast(LanMgr.getLan("",10395))},i.prototype.doFight=function(t){var e=u.GuildFightMemberVo.copy(t),i=new u.FightVo;i.copyType=CopyType.guildFight,i.guildMemberVo=e;var n=new battle.BattleScenePvp(i.copyType);n.init([i.getOwnTeam()],i.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.god,i.getAllRound(),i.getTeamHp()),n.start();var o=n.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",o,"战报：",n.battleReport);var a=new u.ServerPage;a.result=o?playState.VICTORY:playState.FAILURE,a.initPage(n.battleReport),i.fightPageControl=a;var r=i.turnTemplatID(n.getLossHpObj(battle.BatteConsts.BATTLE_CAMPDEF)),s={};s[Protocol.guild_guildWar_guildWarBattleEnd.args.hpInfo]=o?null:e.getEnemyHpInfo(r),s[Protocol.guild_guildWar_guildWarBattleEnd.args.playerId]=e.svo.playerId,loghgy("工会战战果：",i.guildMemberVo,r,s),PLC.request(Protocol.guild_guildWar_guildWarBattleEnd,s,function(t){if(t){var e={vo:i,event:new u.GuildEvent(u.GuildEvent.SHOW_GUILD_BATTLE_VIEW),responseData:t};dispatchEvt(new u.FightsEvent(u.FightsEvent.ENTER_FIGHT_EVENT),e)}})},i.prototype.updateView=function(){UIMgr.hasStage(UIConst.FightMainView)&&this.fightMainView.updateView()},Object.defineProperty(i.prototype,"fightMainView",{get:function(){return UIMgr.getUIByName(UIConst.FightMainView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fightWaitView",{get:function(){return UIMgr.getUIByName(UIConst.FightWaitView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}u.GuildFightProcessor=e}(game=game||{}),function(n){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.initModel=function(){var t=new Date(1e3*App.hero.openSvrTime);t.setHours(0,0,0,0);var e=t.getTime()/1e3,i=t.getDay();this.openTime=i==WeekNum.Sun?604800+e:e+86400*(7-i+7),this.myTeamVo=new n.GuildFightTeamVo(!0),this.enemyTeamVo=new n.GuildFightTeamVo(!1),this.fightThreadVo=new n.GuildFightThread,this.fightThreadVo.requestSeason().then(function(){dispatchEvt(new n.GuildEvent(n.GuildEvent.UPDATE_WAR_REDPOINT))})},e.prototype.updateSeason=function(t){t.hasOwnProperty("session")&&(this.season=t.session),t.hasOwnProperty("regTime")&&(this.joinTime=t.regTime,this.joinRound=new Date(1e3*this.joinTime).getDay(),this.joinRound=this.joinRound==WeekNum.Sat?WeekNum.Mon:this.joinRound,this.endTime=this.getEndTime(this.joinTime)),t.hasOwnProperty("maxGuildGrade")&&(this.maxGuildGrade=t.maxGuildGrade)},e.prototype.setMatchInfo=function(t){t&&(t.hasOwnProperty("myInfo")&&this.myTeamVo.setTeamInfo(t.myInfo),t.hasOwnProperty("targetInfo")&&this.enemyTeamVo.setTeamInfo(t.targetInfo),t.hasOwnProperty("matchType")&&(this.matchType=t.matchType),dispatchEvt(new n.GuildEvent(n.GuildEvent.UPDATE_MATCH_INFO)))},e.prototype.clearMatchInfo=function(){},e.prototype.isJoin=function(){return App.serverTimeSecond<this.endTime},e.prototype.getCurRound=function(){return new Date(App.serverTime).getDay()},e.prototype.isStart=function(){if(!this.isInGameTime()||!this.isJoin())return!1;var t=new Date(this.joinTime),e=t.getHours(),i=t.getMinutes(),n=new Date(App.serverTime).getDay();return!(330<=60*e+i)||0<n-this.joinRound},e.prototype.getNextStartTime=function(){var t=new Date(this.joinTime),e=t.getHours(),i=t.getMinutes(),n=new Date(App.serverTime);return n.setHours(6,0,0,0),60*e+i<330?n.getTime()/1e3:n.getTime()/1e3+86400},e.prototype.isInGameTime=function(){var t=new Date(App.serverTime),e=t.getDay(),i=t.getHours();return e>WeekNum.Sun&&i>=tb.TB_guild_war_set.getSet().star_time&&i<tb.TB_guild_war_set.getSet().end_time},e.prototype.isRestTime=function(){var t=new Date(App.serverTime),e=t.getDay(),i=t.getHours();return e==WeekNum.Mon?i>=tb.TB_guild_war_set.getSet().end_time:e>WeekNum.Sun&&(i<tb.TB_guild_war_set.getSet().star_time||i>=tb.TB_guild_war_set.getSet().end_time)},e.prototype.isEndTime=function(){var t=new Date(App.serverTime),e=t.getDay(),i=t.getHours();return e==WeekNum.Sun||e==WeekNum.Mon&&i<tb.TB_guild_war_set.getSet().star_time},e.prototype.getUpgradeType=function(t,e){if(!t)return n.GuildUpGradeType.none;var i=t.result;return!i||i.length<=0?n.GuildUpGradeType.none:t.ID==n.GuildGrade.qingtong?e>=i[0][0]&&e<=i[0][1]?n.GuildUpGradeType.up:n.GuildUpGradeType.keep:t.ID==n.GuildGrade.wangzhe?n.GuildUpGradeType.none:e>=i[0][0]&&e<=i[0][1]?n.GuildUpGradeType.up:e>=i[1][0]&&e<=i[1][1]?n.GuildUpGradeType.keep:n.GuildUpGradeType.down},e.prototype.getEndTime=function(t){if(t<=0)return 0;var e=new Date;e.setTime(1e3*t),e.setHours(0,0,0,0);var i=e.getDay();return i==WeekNum.Sat?e.getTime()/1e3+691200:e.getTime()/1e3+86400*(7-i)},e.prototype.isRewardByGrade=function(t){var e=App.hero.guildWarAwardCount[t];return!isNaN(e)&&0<e},e.prototype.isHasChallengeCount=function(){if(!this.isOpenGuildWar())return!1;if(!this.isStart())return!1;var t=this.myTeamVo.getMember(App.hero.playerId);return!!t&&0<t.svo.atkCount},e.prototype.isCanReward=function(){if(!this.isOpenGuildWar())return!1;if(this.canRewardRp)return!0;for(var t=0,e=[n.GuildGrade.baiyin,n.GuildGrade.bojin,n.GuildGrade.wangzhe];t<e.length;t++){var i=e[t];if(this.maxGuildGrade>=i&&!this.isRewardByGrade(i))return!0}return!1},e.prototype.isCanJoin=function(){if(!this.isOpenGuildWar())return!1;if(new Date(App.serverTime).getDay()==WeekNum.Sat)return!1;var t=n.GuildModel.getInstance().guildInfo;if(!t)return!1;var e=tb.TB_guild_war_set.getSet();return t.job==iface.tb_prop.guildJobTypeKey.president&&t.level>=e.role_level&&t.num>=e.guild_player_num&&!this.isJoin()},e.prototype.isOpenGuildWar=function(){return n.GuildModel.getInstance().isHasGuild()&&App.serverTimeSecond>=this.openTime},e.GRADE_NAME={1:"青铜",2:"白银",3:"铂金",4:"王者"},e.BLOOD_BASE=1e4,e);function e(){this.openTime=0,this.joinTime=0,this.endTime=0,this.joinRound=0,this.season=0,this.maxGuildGrade=0,this.matchType=-1,this.canRewardRp=!1}n.GuildFightModel=t}(game=game||{}),function(t){var e=(i.prototype.isDonate=function(){return App.hero.getlimitValue(iface.tb_prop.limitTypeKey.guildDonate)==this.tbDonate.ID},i.prototype.getDonate=function(){for(var t=0,e=0,i=this.tbDonate.reward;e<i.length;e++){var n=i[e];if(Number(n[0])==iface.tb_prop.resTypeKey.guildDonate){t=Number(n[1]);break}}return t},i);function i(t){this.tbDonate=t}t.GuildDonationVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.guild.donation.GuildDonationUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.list.array=null,this.bgPanel.dataSource=null},n.prototype.initView=function(){this.bgPanel.dataSource={uiName:UIConst.GuildDonationView,closeOnSide:this.isModelClose,title:"公会贡献"},this.list.itemRender=e.GuildDonationItemRender,this.renderView()},n.prototype.renderView=function(){var t=e.GuildModel.getInstance().guildInfo;this.lbTitle.text=t.name+" Lv："+t.level,this.lbExp.text=t.exp+"/"+tb.TB_guild.get_TB_guildById(t.level).need_exp,this.expProg.value=t.exp/tb.TB_guild.get_TB_guildById(t.level).need_exp,this.lbGongxian.text="X"+App.hero.guildDonate,this.list.array=e.GuildModel.getInstance().getDonationList()},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}e.GuildDonationView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"GuildDonationProcessor"},i.prototype.listenModuleEvents=function(){return[new n.GuildEvent(n.GuildEvent.GUILD_DONATE),new n.GuildEvent(n.GuildEvent.UPDATE_GUILD_DONATE)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof n.GuildEvent)switch(t.type){case n.GuildEvent.GUILD_DONATE:this.guildDonate(t.data);break;case n.GuildEvent.UPDATE_GUILD_DONATE:this.updateDonate()}},i.prototype.guildDonate=function(t){var i=this;if(!UIUtil.checkNotEnough(t.tbDonate.cost[0],t.tbDonate.cost[1]))if(0==App.hero.getlimitValue(iface.tb_prop.limitTypeKey.guildDonate)){var e={};e[Protocol.guild_guild_donate.args.id]=t.tbDonate.ID,PLC.request(Protocol.guild_guild_donate,e,function(t){if(t){if(t.hasOwnProperty("modifyGuildExp")){App.hero.guildExp=t.modifyGuildExp;var e=n.GuildModel.getInstance().guildInfo;e&&(e.exp=t.modifyGuildExp,e.level=t.modifyGuildLevel)}UIUtil.showRewardView(t.commonData),i.donateView.renderView(),dispatchEvt(new n.GuildEvent(n.GuildEvent.GUILD_DONATE_SUCCESS))}})}else showToast(LanMgr.getLan("",10392))},i.prototype.updateDonate=function(){this.donateView&&this.donateView.renderView()},Object.defineProperty(i.prototype,"donateView",{get:function(){return UIMgr.getUIByName(UIConst.GuildDonationView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}n.GuildDonationProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guild.donation.GuildDonationItemRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.lbName.text=t.tbDonate.desc,this.lbGet.text="公会贡献+"+t.getDonate(),this.imgBg.skin=SkinUtil.getDonationImgUrl(t.tbDonate.ID),this.imgCost.skin=SkinUtil.getCostSkin(t.tbDonate.cost[0]),this.imgCost.scaleX=1,this.imgCost.scaleY=1,t.tbDonate.cost[0]==iface.tb_prop.resTypeKey.gold&&(this.imgCost.scaleX=.8,this.imgCost.scaleY=.8),this.lbCost.text="X"+Snums(t.tbDonate.cost[1]),this.btnDonation.disabled=t.isDonate(),this.btnDonation.disabled||(this.btnDonation.gray=0!=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.guildDonate)),this.btnDonation.label=t.isDonate()?"已捐献":"捐 献",this.btnDonation.on(Laya.Event.CLICK,this,this.onDonate)):this.btnDonation.off(Laya.Event.CLICK,this,this.onDonate)},n.prototype.onDonate=function(){dispatchEvt(new t.GuildEvent(t.GuildEvent.GUILD_DONATE,this.dataSource))},n);function n(){return e.call(this)||this}t.GuildDonationItemRender=i}(game=game||{}),function(u){var a,t;(t=a=u.WeakGuideStep||(u.WeakGuideStep={}))[t.guideShouchong=1001]="guideShouchong",t[t.guideAdventure=1100]="guideAdventure",t[t.advt_open=1101]="advt_open",t[t.advt_do=1102]="advt_do",t[t.guideJingjichang=1110]="guideJingjichang",t[t.jjc_open=1111]="jjc_open",t[t.jjc_fight=1112]="jjc_fight",t[t.guideDailyCopy=1120]="guideDailyCopy",t[t.daily_open=1121]="daily_open",t[t.daily_challenge=1122]="daily_challenge",t[t.guideShenqi=1130]="guideShenqi",t[t.sq_unlock=1131]="sq_unlock",t[t.sq_shangzhen=1132]="sq_shangzhen",t[t.guideWorldboss=1140]="guideWorldboss",t[t.boss_open=1141]="boss_open",t[t.boss_do=1142]="boss_do",t[t.guideJinglian=1150]="guideJinglian",t[t.jl_open=1151]="jl_open",t[t.jl_wearEquip=1152]="jl_wearEquip",t[t.jl_jinglianEquip=1153]="jl_jinglianEquip",t[t.guideShenjiemen=1160]="guideShenjiemen",t[t.sm_open=1161]="sm_open",t[t.sm_do=1162]="sm_do",t[t.guideGuild=1170]="guideGuild",t[t.guild_open=1171]="guild_open",t[t.guild_do=1172]="guild_do",t[t.guideJoinGuild=1180]="guideJoinGuild",t[t.guideIsland=1190]="guideIsland",t[t.island_open=1191]="island_open",t[t.island_do=1192]="island_do",t[t.guideYuanzheng=1200]="guideYuanzheng",t[t.yuanzheng_open=1201]="yuanzheng_open",t[t.yuanzheng_do=1202]="yuanzheng_do",t[t.guideFogForest=1210]="guideFogForest",t[t.forest_open=1211]="forest_open",t[t.forest_challenge=1212]="forest_challenge",t[t.guideRonghun=1220]="guideRonghun",t[t.ronghun_open=1221]="ronghun_open",t[t.ronghun_do=1222]="ronghun_do",t[t.guideEscort=1230]="guideEscort",t[t.escort_open=1231]="escort_open",t[t.escort_refresh=1232]="escort_refresh",t[t.escort_go=1233]="escort_go",t[t.guideSqXilian=1240]="guideSqXilian",t[t.sqxl_open=1241]="sqxl_open",t[t.sqxl_do=1242]="sqxl_do",t[t.guideBaoshi=1250]="guideBaoshi",t[t.bs_open=1251]="bs_open",t[t.bs_equip=1252]="bs_equip",t[t.bs_lvup=1253]="bs_lvup",t[t.guideTower=1270]="guideTower",t[t.tower_open=1271]="tower_open",t[t.tower_fight=1272]="tower_fight",t[t.guideGodAwaken=1280]="guideGodAwaken",t[t.awaken_open=1281]="awaken_open",t[t.awaken_do=1282]="awaken_do",t[t.guideTreasure=1290]="guideTreasure",t[t.treasure_open=1291]="treasure_open",t[t.treasure_wear=1292]="treasure_wear",t[t.treasure_streng=1293]="treasure_streng",t[t.guideShenqiStr=1300]="guideShenqiStr",t[t.sqSt_unlock=1301]="sqSt_unlock",t[t.sqSt_do=1302]="sqSt_do",t[t.guideChat=1310]="guideChat",t[t.chat_open=1311]="chat_open",t[t.chat_send=1312]="chat_send",t[t.endAllGuide=99999]="endAllGuide";var e=(h.startRun=function(){if(!h._isInit&&(h._isInit=!0,h.setCurExcutingStep(-1),!h.isFinishStep(a.endAllGuide))){function t(t){if(-1==n.indexOf(parseInt(t))){var e=o._guideList[t];i.push(e.execute().then(function(){e.dispose()}))}}u.GuideQueueManager.startRun(),this._stepNames={},this._guideList={},this._guideList[a.guideShenqi]=new u.ShenqiOpenGuide,this._stepNames[a.guideShenqi]="神器开启引导  进阶之路1阶全部完成",this._guideList[a.guideShenqiStr]=new u.ShenqiStrengthOpenGuide,this._stepNames[a.guideShenqiStr]="神器强化开启引导  进阶之路2阶全部完成",this._guideList[a.guideJoinGuild]=new u.JoinGuildGuide,this._stepNames[a.guideJoinGuild]="创建或加入公会后的大厅引导",loghgy("开启无序弱引导");var i=[],n=h.getWeakGuideSteps(),o=this;for(var e in this._guideList)t(e);0<i.length&&Promise.all(i).then(function(){loghgy("完成所有无序弱引导")})}},h.listenSysOpen=function(n,o){return new Promise(function(t,e){if(loghgy("监听系统开启,系统ID：",n),n==ModuleConst.SHOUCHONG)return App.hero.level>=common.GlobalData.SHOUCHONG_OPEN_LV?void t():void u.GuideManager.listenNotification(u.ResEvent.ROLE_LEVEL_CHANGE,function(){return App.hero.level>=common.GlobalData.SHOUCHONG_OPEN_LV},o).then(function(){t()});if(App.IsSysOpen(n))t();else{var i=App.getOpenType(n);i==SysConditionType.level?u.GuideManager.listenNotification(u.ResEvent.ROLE_LEVEL_CHANGE,function(){return App.IsSysOpen(n)},o).then(function(){t()}):i==SysConditionType.copy?u.GuideManager.listenNotification(u.GuajiEvent.UPDATE_FUWEN_COPY_INFO,function(){return App.IsSysOpen(n)},o).then(function(){t()}):t()}})},h.guideSysOpenToScene=function(i,n){return new Promise(function(t,e){(new u.ListenFightClosedWaitStatus).execute().then(function(){return new u.ListenDialogQueueWaitStatus(!0,n).execute()}).then(function(){return h.listenToMain(i,n)}).then(function(){u.GuideMask.hide(),t()})})},h.listenToMain=function(i,n){var o=this;return new Promise(function(t,e){Promise.resolve().then(function(){return!!UIMgr.getInstance().hasStageByGroup(UIConst.hud_group)||u.GuideManager.listenDialogGroup(common.GlobalEvent.DIALOG_OPENED,UIConst.hud_group,n)}).then(function(){return u.GuideManager.timeout(100)}).then(function(){return Laya.timer.callLater(o,function(){UIMgr.getInstance().hideUIByDepth([UI_DEPATH_VALUE.TOP,UI_DEPATH_VALUE.LOADING])}),h.listenSysTopViewClose(null)}).then(function(){return!(0<=i)||u.GuideManager.guideToMainView(i,"",n)}).then(function(){t()})})},h.listenSysTopViewClose=function(i){var n=this;return new Promise(function(e,t){u.GuideManager.timeout(100).then(function(){if(UIMgr.hasStage(UIConst.SysTopView)){var t=UIMgr.getUIByName(UIConst.SysTopView);return u.GuideMask.show(t.btnClose,u.DirectionType.top),u.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.SysTopView,n).then(function(){h.listenSysTopViewClose(i||e)})}(i||e)()})})},h.runGuideList=function(t,e,i){var n=[],o=h.getWeakGuideSteps();for(var a in t){var r=parseInt(a);-1==o.indexOf(r)&&n.push(t[a])}0<n.length?(h.setCurExcutingStep(e),loghgy("runGuideList: "+(h._stepNames[e]||u.GuideQueueManager.getStepName(e))),function t(){0<n.length?n.shift()(t):0<e?u.GuideManager.guideRequest(0,e).then(function(){i()}):i()}()):0<e?u.GuideManager.guideRequest(0,e).then(function(){i()}):i()},h.listenRewardClose=function(t,e){var i=this;return void 0===e&&(e=200),new Promise(function(t){u.GuideManager.timeout(e).then(function(){return u.GuideMask.hide(),!UIMgr.hasStage(UIConst.CommonRewardView)||u.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.CommonRewardView,i)}).then(function(){t()})})},h.waitSysOpenAnim=function(t,a,r){var s=this;return new Promise(function(o){h.listenToMain(5,s).then(function(){return!(0<t)||u.GuideManager.guideRequest(0,t)}).then(function(){return u.GuideManager.timeout(100)}).then(function(){u.GuideMask.showWithTransparent(),u.GuideMask.setMaskAlpha(1);var t=new u.GuaJiSysOpenView;t.setGuideView(a);var e,i=UIMgr.getUIByName(UIConst.GuajiView);t.anchorX=t.anchorY=.5,t.scale(.5,.5),t.alpha=0,t.x=Laya.stage.width/2,t.y=Laya.stage.height/2,Laya.stage.addChild(t);var n=UIMgr.getUIByName(UIConst.HudView);switch(a){case ModuleConst.SHENMEN:case ModuleConst.GONGHUI:e=n.btn_main.localToGlobal(new Laya.Point(0,0));break;case ModuleConst.ADVENTURE:e=i.bottomUI.btn_adventure.localToGlobal(new Laya.Point(0,0));break;case ModuleConst.CHAT:e=n.btn_chat.localToGlobal(new Laya.Point(0,0));break;case ModuleConst.RONGHUN:case ModuleConst.SHENGJIE:case ModuleConst.SHENGXING:case ModuleConst.JUEXING:e=n.btn_god.localToGlobal(new Laya.Point(0,0));break;case ModuleConst.EQUIPMENT:case ModuleConst.EQUIP_JINGLIAN:case ModuleConst.EQUIP_BAOSHI:case ModuleConst.EQUIP_STRENGTH:e=n.btn_equip.localToGlobal(new Laya.Point(0,0));break;case ModuleConst.ARTIFACT:case ModuleConst.ARTIFACT_BAPTIZE:case ModuleConst.ARTIFACT_ENCHANT:e=n.btn_shenqi.localToGlobal(new Laya.Point(0,0));break;case ModuleConst.DAILY_COPY:case ModuleConst.EXPEDITION:case ModuleConst.CARAVAN_ESCORT:e=i.btn_lilian.localToGlobal(new Laya.Point(0,0));break;case ModuleConst.WORLD_BOSS:case ModuleConst.FOG_FOREST:case ModuleConst.SHILIANTA:e=i.btn_maoxian.localToGlobal(new Laya.Point(0,0));break;case ModuleConst.JINGJI:case ModuleConst.Island:case ModuleConst.MATCH_FIGHT:case ModuleConst.GOD_DOMAIN:case ModuleConst.GLORY_FIGHT:e=i.btn_jingji.localToGlobal(new Laya.Point(0,0));break;default:e=n.btn_fight.localToGlobal(new Laya.Point(0,0))}Laya.Tween.to(t,{alpha:1,scaleX:1.5,scaleY:1.5,x:Laya.stage.width/2,y:Laya.stage.height/2},500,Laya.Ease.sineIn,new Handler(s,function(){t.setGuideStatus(!0),Laya.Tween.clearTween(t),u.GuideManager.listenNotification(u.GuajiEvent.CONFIRM_SYS_OPEN_BUTTON,null,r).then(function(){t.setGuideStatus(!1),Laya.Tween.to(t,{scaleX:1,scaleY:1,x:e.x+50,y:e.y+50},800,Laya.Ease.sineIn,new Handler(s,function(){Laya.Tween.clearTween(t),Laya.stage.removeChild(t),u.GuideMask.hide(),o()}))})}))})})},h.listenGoToSys=function(o,e,a){return new Promise(function(t){var i=0;switch(o){case ModuleConst.SHILIANTA:case ModuleConst.WORLD_BOSS:case ModuleConst.FOG_FOREST:i=1;break;case ModuleConst.JINGJI:case ModuleConst.Island:i=2;break;case ModuleConst.GLORY_FIGHT:case ModuleConst.MATCH_FIGHT:case ModuleConst.GOD_DOMAIN:i=3}var n=1==i?UIConst.EntranceList_lilian:2==i?UIConst.EntranceList_jingji:3==i?UIConst.EntranceList_kaufu:UIConst.EntranceList;h.listenToMain(5,a).then(function(){var t=UIMgr.getUIByName(UIConst.GuajiView),e=1==i?t.btn_maoxian:2==i?t.btn_jingji:3==i?t.btn_kf:t.btn_lilian;return u.GuideMask.show(e,u.DirectionType.bottom),u.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,n,a)}).then(function(){return u.GuideManager.timeout(1e3)}).then(function(){var t=UIMgr.getUIByName(n);t.btnlist.scrollBar.touchScrollEnable=!1;var e=t.getIRIndex(o);return!(3<=e)||(t.btnlist.scrollTo(e-2),u.GuideManager.timeout(300))}).then(function(){var t=UIMgr.getUIByName(n);return u.GuideMask.show(t.getIRBySysid(o),u.DirectionType.bottom),UIMgr.getInstance().getUIInfo(e).popEffect?u.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CREATED,e,a).then(function(){return u.GuideMask.showWithTransparent(),u.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,e,a)}):u.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,e,a)}).then(function(){UIMgr.getUIByName(n).btnlist.scrollBar.touchScrollEnable=!0,t()})})},h.getWeakGuideSteps=function(){return App.hero.tasks.guideWeakStep},h.setCurExcutingStep=function(t){var e=this._stepNames[t]||u.GuideQueueManager.getStepName(t);loghgy(-1==t?"移除正在执行的弱引导":"设置正在执行的弱引导：",e),h.curExcutingGuideStep=t,dispatchEvt(new u.GuideEvent(u.GuideEvent.UPDATE_GUIDE_STATUS))},h.isHasStep=function(){var t=!1,e=h.getWeakGuideSteps();for(var i in this._guideList)if(-1==e.indexOf(parseInt(i))){t=!0;break}return t},h.isFinishStep=function(t){return-1!=h.getWeakGuideSteps().indexOf(t)},h.isExcuting=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0==t.length?-1!=h.curExcutingGuideStep:t.some(function(t){return h.curExcutingGuideStep==t})},h.allPass=function(){this.passCurGuide(),u.GuideManager.guideRequest(0,a.endAllGuide).then(function(){u.GuideMask.dispose(),UIMgr.hideUIByName(UIConst.GuideTalkView)})},h.passCurGuide=function(){loghgy("跳过触发性引导",h.curExcutingGuideStep);var t=this._guideList[h.curExcutingGuideStep],e=!t;if(t=t||u.GuideQueueManager.getGuideStatus(h.curExcutingGuideStep)){var i=t.getCurChildStep();0<i&&!h.isFinishStep(i)&&u.GuideManager.recordJumpGuide(i),loghgy("跳过触发性引导：",h.curExcutingGuideStep),tl3d.ModuleEventManager.removeEventByTarget(t),u.GuideManager.guideRequest(0,h.curExcutingGuideStep).then(function(){loghgy("成功跳过触发性引导",h.curExcutingGuideStep),t.dispose(),e&&u.GuideQueueManager.runGuide()})}},h._guideList={},h._isInit=!1,h.curExcutingGuideStep=-1,h._stepNames={},h);function h(){}u.GuideWeakManager=e}(game=game||{});var __awaiter=this&&this.__awaiter||function(t,r,s,u){return new(s=s||Promise)(function(i,e){function n(t){try{a(u.next(t))}catch(t){e(t)}}function o(t){try{a(u.throw(t))}catch(t){e(t)}}function a(t){var e;t.done?i(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(n,o)}a((u=u.apply(t,r||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,a,r,t,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(r=2&e[0]?a.return:e[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,e[1])).done)return r;switch(a=0,r&&(e=[2&e[0],r.value]),e[0]){case 0:case 1:r=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,a=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!r||e[1]>r[0]&&e[1]<r[3])){s.label=e[1];break}if(6===e[0]&&s.label<r[1]){s.label=r[1],r=e;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(e);break}r[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(i,s)}catch(t){e=[6,t],a=0}finally{o=r=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};!function(h){var t=(e.prototype.getGuideStep=function(){return 0},e.prototype.getCurChildStep=function(){return 0},e.prototype.execute=function(){var o=this;return new Promise(function(n,t){Promise.resolve().then(function(){return!!UIMgr.hasStage(UIConst.FightViews)||h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightViews,o._context)}).then(function(){UIMgr.getUIByName(UIConst.FightViews),h.GuideManager.listenDialogs(common.GlobalEvent.DIALOG_OPENED,[UIConst.FightVictory,UIConst.FightFailure],o._context).then(function(t){var e=t.name==UIConst.FightVictory;if(UIMgr.hideUIByName(UIConst.CommonRuleView),UIMgr.getUIByName(UIConst.FightViews),e)(i=UIMgr.getUIByName(UIConst.FightVictory)).chk_next.selected=!1,i.onChkChange(),h.GuideMask.show(i.btn_close,h.DirectionType.bottom),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightViews,o._context).then(function(){n()});else{var i=UIMgr.getUIByName(UIConst.FightFailure);h.GuideMask.show(i.btn_close,h.DirectionType.bottom),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightViews,o._context).then(function(){n()})}})})})},e.prototype.dispose=function(){tl3d.ModuleEventManager.removeEventByTarget(this._context)},e);function e(t,e){this._close=t,this._context=e}h.FightEndWaitStatus=t;var i=(n.prototype.getGuideStep=function(){return 0},n.prototype.getCurChildStep=function(){return 0},n.prototype.checkStart=function(t){if(!t.tab_copyinfo)return!1;var e=t.tab_copyinfo.ID;return!!this._copyDic[e]&&(t.copyType==iface.tb_prop.copyTypeKey.rune?!this._model.isPassCopy(e):t.copyType==iface.tb_prop.copyTypeKey.tower&&!h.TowerModel.getInstance().isPassCopy(e))},n.prototype.execute=function(){var e=this;tl3d.ModuleEventManager.removeEventByTarget(this),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightViews,this).then(function(){var t=UIMgr.getUIByName(UIConst.FightViews).dataSource;e.checkStart(t.vo)?e.startGuide(2,t.vo.tab_copyinfo,e.execute.bind(e)):e.execute()}),h.GuideManager.listenNotification(h.GuajiEvent.ENTER_FIGHT,function(t){return e._model.startTalkGuide=!1,e.checkStart(t.data)&&e.startGuide(1,t.data.tab_copyinfo,null),!1},this)},n.prototype.startGuide=function(i,n,t){var o=this;loghgy("战斗对话引导");var a=this._model,e=n.before_plot&&0<n.before_plot.length,r=n.after_plot&&0<n.after_plot.length,s=!1,u=UIMgr.getUIByName(UIConst.FightViews);Promise.resolve().then(function(){if(e){if(2==i)return u.talkStart=!0,h.GuideManager.listenNotification(h.FightsEvent.SCENE_COMPLETE_EVENT,null,o).then(function(){var t=[].concat.apply([],n.before_plot);return o.talk(t)}).then(function(){var e=UIMgr.getUIByName(UIConst.FightViews);return e.startTalkEnd(),h.GuideManager.listenNotification(h.FightsEvent.FIGHT_END,function(t){return s=!(!t.data||t.data!=playState.VICTORY),e.stopFightEnd=r&&s,!0},o)});if(1==i)return a.startTalkGuide=!0,h.GuideManager.listenNotification(h.GuajiEvent.CREATE_ROLE_SUCC,null,o).then(function(){var t=[].concat.apply([],n.before_plot);return o.talk(t)}).then(function(){a.startTalkGuide=!1;var t=UIMgr.getUIByName(UIConst.GuajiView);return t&&t.guajiScene&&t.guajiScene.startTalkGuideEnd()&&t.guajiScene.startTalkGuideEnd(),h.GuideManager.listenNotification(h.GuajiEvent.GUAJI_FIGHT_END,function(t){return s=!(!t.data||t.data!=playState.VICTORY),a.hasEndTalkGuide=r,!0},o)})}else{if(2==i)return h.GuideManager.listenNotification(h.FightsEvent.FIGHT_END,function(t){return s=!(!t.data||t.data!=playState.VICTORY),u.stopFightEnd=r&&s,!0},o);if(1==i)return h.GuideManager.listenNotification(h.GuajiEvent.GUAJI_FIGHT_END,function(t){return s=!(!t.data||t.data!=playState.VICTORY),a.hasEndTalkGuide=r,!0},o)}}).then(function(){if(r&&s){var t=[].concat.apply([],n.after_plot);return o.talk(t).then(function(){if(1==i){var t=UIMgr.getUIByName(UIConst.GuajiView);t&&t.guajiScene&&t.guajiScene.endFight(),a.hasEndTalkGuide=!1}else 2==i&&UIMgr.getUIByName(UIConst.FightViews).doFigthEnd(!1);return!0})}if(1==i){var e=UIMgr.getUIByName(UIConst.GuajiView);e&&e.guajiScene&&e.guajiScene.endFight(),a.hasEndTalkGuide=!1}return!0}).then(function(){dispatchEvt(new h.GuajiEvent(h.GuajiEvent.GUAJI_TALK_END)),t&&t()})},n.prototype.talk=function(a){return __awaiter(this,void 0,void 0,function(){var e,i,n,o;return __generator(this,function(t){switch(t.label){case 0:e=a.length,i=0,t.label=1;case 1:return i<e?(n=tb.TB_plot.getItemById(a[i]),o=e-1==i,[4,h.GuideManager.talk(n.plot,o,n.model,n.name,n.model_multiple,n.location,!0)]):[3,7];case 2:return t.sent(),o?[4,h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,this)]:[3,4];case 3:return t.sent(),[3,6];case 4:return[4,h.GuideManager.listenNotification(h.GuideEvent.Guide_Talk_End,null,this)];case 5:t.sent(),t.label=6;case 6:return i++,[3,1];case 7:return[2]}})})},n.prototype.dispose=function(){},n);function n(){this._model=h.GuajiModel.getInstance(),this._copyDic={};var t=TableData.getInstance().getTableByName(TableData.tb_copy_info).data;for(var e in t){var i=t[e];(i.before_plot&&0<i.before_plot.length||i.after_plot&&0<i.after_plot.length)&&(this._copyDic[i.ID]=i)}}h.FightTalkGuide=i;var o=(a.prototype.getGuideStep=function(){return 0},a.prototype.getCurChildStep=function(){return 0},a.prototype.execute=function(){var n=this;return new Promise(function(t,e){if(UIMgr.hasStage(UIConst.FightViews))if(UIMgr.hasStage(UIConst.FightVictory)){var i=UIMgr.getUIByName(UIConst.FightVictory);h.GuideMask.show(i.btn_close,h.DirectionType.bottom),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightVictory).then(function(){h.GuideMask.hide(),n.dispose(),t()})}else UIMgr.hasStage(UIConst.FightFailure)?(i=UIMgr.getUIByName(UIConst.FightFailure),h.GuideMask.show(i.btn_close,h.DirectionType.bottom),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightFailure).then(function(){h.GuideMask.hide(),n.dispose(),t()})):(h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightVictory,n).then(function(){var t=UIMgr.getUIByName(UIConst.FightVictory);return h.GuideMask.show(t.btn_close,h.DirectionType.bottom),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightVictory)}).then(function(){h.GuideMask.hide(),n.dispose(),t()}),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightFailure,n).then(function(){var t=UIMgr.getUIByName(UIConst.FightFailure);return h.GuideMask.show(t.btn_close,h.DirectionType.bottom),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightFailure)}).then(function(){h.GuideMask.hide(),n.dispose(),t()}));else t()})},a.prototype.dispose=function(){tl3d.ModuleEventManager.removeEventByTarget(this)},a);function a(){}h.ListenFightClosedWaitStatus=o;var r=(s.prototype.getGuideStep=function(){return 0},s.prototype.getCurChildStep=function(){return 0},s.prototype.execute=function(){var i=this;return new Promise(function(t,e){h.GuideManager.timeout(300).then(function(){i.checkDialog(t)})})},s.prototype.checkDialog=function(t){var e=this;DialogQueueMgr.getInstance().hasDialog()?(h.GuideMask.hide(),Promise.resolve().then(function(){if(UIMgr.hasStage(UIConst.FightVictory))return h.GuideManager.timeout(common.GlobalData.DIALOG_EFFECT_TIME).then(function(){var t=UIMgr.getUIByName(UIConst.FightVictory);return h.GuideMask.show(t.btn_close,h.DirectionType.bottom),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightVictory,e._context)});var t=DialogQueueMgr.getInstance().getCudDialogName();return h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,t,e._context)}).then(function(){return h.GuideManager.timeout(100)}).then(function(){e.checkDialog(t)})):(h.GuideMask.hide(),this.dispose(),t())},s.prototype.dispose=function(){tl3d.ModuleEventManager.removeEventByTarget(this._context),tl3d.ModuleEventManager.removeEventByTarget(this),this._context=null,this._close=!1},s);function s(t,e){this._close=t,this._context=e}h.ListenDialogQueueWaitStatus=r;var u=(l.prototype.getGuideStep=function(){return h.WeakGuideStep.guideJoinGuild},l.prototype.getCurChildStep=function(){return this._curStep},l.prototype.execute=function(){var e=this;return new Promise(function(t){h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.GuildMainView,e).then(function(){return e._curStep=h.WeakGuideStep.guideJoinGuild,h.GuideWeakManager.setCurExcutingStep(h.WeakGuideStep.guideJoinGuild),h.GuideManager.timeout(300)}).then(function(){return loghgy("加入公会引导"),h.GuideWeakManager.setCurExcutingStep(h.WeakGuideStep.guideJoinGuild),h.GuideMask.hide(),h.GuideManager.talk(LanMgr.getLan("",12073))}).then(function(){return h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuildMainView);return h.GuideMask.show(t.boxHall,h.DirectionType.bottom,LanMgr.getLan("",12074),!1),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideMask,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuildMainView);return h.GuideMask.show(t.boxDonate,h.DirectionType.left,LanMgr.getLan("",12075),!1),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideMask,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuildMainView);return h.GuideMask.show(t.boxShop,h.DirectionType.top,LanMgr.getLan("",12076),!1),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideMask,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuildMainView);return h.GuideMask.show(t.boxSkill,h.DirectionType.top,LanMgr.getLan("",12077),!1),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideMask,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuildMainView);return h.GuideMask.show(t.boxCopy,h.DirectionType.right),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.GuildCopyView,e)}).then(function(){return h.GuideMask.showWithTransparent(),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.GuildCopyView,e)}).then(function(){return h.GuideManager.guideRequest(0,h.WeakGuideStep.guideJoinGuild)}).then(function(){if(e._curStep=0,h.GuildCopyModel.getInstance().isAllFinish())return!0;var t=UIMgr.getUIByName(UIConst.GuildCopyView);return h.GuideMask.show(t.btnChallenge,h.DirectionType.top),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightViews,e)}).then(function(){h.GuideMask.hide(),t()})})},l.prototype.dispose=function(){tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),h.GuideMask.hide(),h.GuideWeakManager.setCurExcutingStep(-1))},l);function l(){this._isPass=!1,this._curStep=0}h.JoinGuildGuide=u;var c=(p.prototype.getGuideStep=function(){return h.WeakGuideStep.guideShouchong},p.prototype.getCurChildStep=function(){return h.WeakGuideStep.guideShouchong},p.prototype.execute=function(){var e=this;return new Promise(function(t){if(6<=App.hero.welfare.rechargeSum)return loghgy("兼容：已经首充过，直接完成该弱引导步骤"+h.WeakGuideStep.guideShouchong),void h.GuideManager.guideRequest(0,h.WeakGuideStep.guideShouchong).then(function(){e._isPass=!0,t()});h.GuideWeakManager.listenSysOpen(ModuleConst.SHOUCHONG,e).then(function(){return h.GuideWeakManager.guideSysOpenToScene(0,e)}).then(function(){return h.GuideWeakManager.setCurExcutingStep(h.WeakGuideStep.guideShouchong),h.GuideMask.hide(),h.GuideManager.talk(LanMgr.getLan("",12078))}).then(function(){return h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return h.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.Main3DView);return h.GuideMask.show(t.getActivityBtnIR(ModuleConst.SHOUCHONG),h.DirectionType.bottom),h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.TupUp_FirstView,e)}).then(function(){return h.GuideManager.guideRequest(0,h.WeakGuideStep.guideShouchong)}).then(function(){return h.GuideMask.hide(),h.GuideManager.talk(LanMgr.getLan("",12079))}).then(function(){return h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return h.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.TupUp_FirstView,e)}).then(function(){h.GuideMask.hide(),t()})})},p.prototype.dispose=function(){tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),h.GuideMask.hide(),h.GuideWeakManager.setCurExcutingStep(-1))},p);function p(){this._isPass=!1}h.ShouchongGuide=c}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){function t(){}var o,e;n.IGuideTalkOpt=t,(e=o=n.LocationType||(n.LocationType={}))[e.center=0]="center",e[e.left=1]="left",e[e.right=2]="right";var i,a=(i=ui.guide.GuideTalkUI,__extends(r,i),r.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._htmlText=new Laya.HTMLDivElement,this._htmlText.x=31,this._htmlText.y=399,this._htmlText.width=555,this._htmlText.color="#72462b",this._htmlText.style.fontSize=25,this._htmlText.style.leading=6,this._htmlText.style.color="#72462b",this._htmlText.style.wordWrap=!0,this.box.addChildAt(this._htmlText,this.box.numChildren-2),this.uiScene=new Base2dSceneLayer,this.addChildAt(this.uiScene,0)},r.prototype.setSize=function(t,e){i.prototype.setSize.call(this,t,e),this.btnPass.y=GameUtil.isFullScreen()?n.HudModel.TOP_ADD_HEIGHT+54:54},r.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},r.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},r.prototype.initView=function(){this._opt=this.dataSource,this.dataSource.hasOwnProperty("remove")||(this._opt.remove=!0),this._htmlText.innerHTML=this._opt.text,this.on(Laya.Event.CLICK,this,this.onCloseComp),this.btnPass.on(Laya.Event.CLICK,this,this.onPass),this._opt.hidePass?this.btnPass.visible=!1:this.btnPass.visible=n.GuideManager.canShowPassBtn(),this.lab_name.text=this._opt.modelName;var t=0,e=Laya.stage.height-160,i=this._opt.modelScale;this._opt.location==o.left?(t=(Laya.stage.width>>1)-170,this.bgName.x=37):this._opt.location==o.right?(t=170+(Laya.stage.width>>1),this.bgName.x=387):(t=Laya.stage.width>>1,this.bgName.x=217,e=Laya.stage.height-210),t-=Launch.offsetX,e-=Launch.offsetY,this.lab_name.x=this.bgName.x+(this.bgName.width>>1),this.uiScene.addModelChar(String(this._opt.model),t,e,180,i)},r.prototype.onCloseComp=function(t){t.stopPropagation(),this._opt.remove&&UIMgr.hideUIByName(UIConst.GuideTalkView),dispatchEvt(new n.GuideEvent(n.GuideEvent.Guide_Talk_End))},r.prototype.onPass=function(t){t.stopPropagation(),Laya.timer.frameOnce(5,this,function(){n.GuideManager.passGuide()})},r.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.uiScene.onExit(),this.off(Laya.Event.CLICK,this,this.onCloseComp),this.btnPass.off(Laya.Event.CLICK,this,this.onPass)},r);function r(){return i.call(this)||this}n.GuideTalkView=a}(game=game||{}),function(a){var t=(e.prototype.getGuideStep=function(){return a.WeakGuideStep.guideShenqi},e.prototype.getCurChildStep=function(){return this._curStep},e.prototype.execute=function(){var o=this;return new Promise(function(t){var e=1<=App.hero.tasks.advanceLevel,i=a.ArtifactModel.getInstance().getUnlockArtifactNum(),n=a.GuideWeakManager.isFinishStep(a.WeakGuideStep.guideShenqi);!e||0!=i&&n?a.GuideManager.listenNotification(a.UpRoadEvent.REWARD_SUCCESS,function(){return 1<=App.hero.tasks.advanceLevel},o).then(function(){a.GuideWeakManager.runGuideList(o.guideList,a.WeakGuideStep.guideShenqi,t)}):a.GuideWeakManager.runGuideList(o.guideList,a.WeakGuideStep.guideShenqi,t)})},e.prototype.unlock=function(t){var e=this;if(loghgy("解锁第一把神器引导"),1<=a.ArtifactModel.getInstance().getUnlockArtifactNum())return loghgy("兼容：已解锁第一把神器，直接完成该引导步骤",a.WeakGuideStep.sq_unlock),void a.GuideManager.guideRequest(0,a.WeakGuideStep.sq_unlock).then(function(){a.GuideMask.hide(),t()});Promise.resolve().then(function(){return!UIMgr.hasStage(UIConst.UpRoadView)||a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.ShowRewardItem,e).then(function(){var t=UIMgr.getUIByName(UIConst.UpRoadView);return a.GuideMask.show(t.btn_close,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.UpRoadView,e)})}).then(function(){return a.GuideWeakManager.listenToMain(3,e)}).then(function(){return e._curStep=a.WeakGuideStep.sq_unlock,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12036))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.timeout(100)}).then(function(){var t=UIMgr.getUIByName(UIConst.ArtifactView);return a.GuideMask.show(t.btn_unlock,a.DirectionType.bottom),a.GuideManager.listenNotification(a.ArtifactEvent.ARTIFACT_UNLOCK_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.sq_unlock)}).then(function(){return e._curStep=a.WeakGuideStep.sq_shangzhen,UIMgr.hasStage(UIConst.Artifact_UnLockView)?a.GuideManager.timeout(common.GlobalData.DIALOG_EFFECT_TIME):a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.Artifact_UnLockView,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.Artifact_UnLockView,e)}).then(function(){a.GuideMask.hide(),t()})},e.prototype.shangzhen=function(t){var e=this;loghgy("上阵神器引导");var i=iface.tb_prop.lineupTypeKey.attack;if(App.hero.lineupArtifactInfo.hasOwnProperty(i)&&0<App.hero.lineupArtifactInfo[i])return loghgy("兼容：已上阵过神器，直接完成该引导步骤",a.WeakGuideStep.sq_shangzhen),void a.GuideManager.guideRequest(0,a.WeakGuideStep.sq_shangzhen).then(function(){t()});this._curStep=a.WeakGuideStep.sq_shangzhen,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12037)).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return!!UIMgr.hasStage(UIConst.ArtifactView)||a.GuideManager.guideToMainView(3,"",e)}).then(function(){var t=UIMgr.getUIByName(UIConst.ArtifactView);return a.GuideMask.show(t.btn_artifact,a.DirectionType.left),a.GuideManager.listenNotification(a.ArtifactEvent.ADJUST_LINEUP_ARTIFACT_SUCCESS,function(){return App.hero.lineupArtifactInfo.hasOwnProperty(i)&&0<App.hero.lineupArtifactInfo[i]},e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.sq_shangzhen)}).then(function(){return e._curStep=0,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12038))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){a.GuideMask.hide(),t()})},e.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},e);function e(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.sq_unlock]=this.unlock.bind(this),this.guideList[a.WeakGuideStep.sq_shangzhen]=this.shangzhen.bind(this)}a.ShenqiOpenGuide=t;var i=(n.prototype.getGuideStep=function(){return a.WeakGuideStep.guideShenqiStr},n.prototype.getCurChildStep=function(){return this._curStep},n.prototype.execute=function(){var o=this;return new Promise(function(t){var e=2<=App.hero.tasks.advanceLevel,i=a.ArtifactModel.getInstance().getUnlockArtifactNum(),n=a.GuideWeakManager.isFinishStep(a.WeakGuideStep.guideShenqiStr);e&&(i<2||!n)?a.GuideWeakManager.runGuideList(o.guideList,a.WeakGuideStep.guideShenqiStr,t):a.GuideManager.listenNotification(a.UpRoadEvent.REWARD_SUCCESS,function(){return 2<=App.hero.tasks.advanceLevel},o).then(function(){a.GuideWeakManager.runGuideList(o.guideList,a.WeakGuideStep.guideShenqiStr,t)})})},n.prototype.unlock=function(t){var e=this;if(2<=a.ArtifactModel.getInstance().getUnlockArtifactNum())return loghgy("兼容：已解锁两把神器，直接完成该引导步骤",a.WeakGuideStep.sqSt_unlock),void a.GuideManager.guideRequest(0,a.WeakGuideStep.sqSt_unlock).then(function(){a.GuideMask.hide(),t()});Promise.resolve().then(function(){return!UIMgr.hasStage(UIConst.UpRoadView)||a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.ShowRewardItem,e).then(function(){var t=UIMgr.getUIByName(UIConst.UpRoadView);return a.GuideMask.show(t.btn_close,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.UpRoadView,e)})}).then(function(){return e._curStep=a.WeakGuideStep.sqSt_unlock,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12039))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideWeakManager.listenToMain(3,e)}).then(function(){return a.GuideManager.timeout(100)}).then(function(){var t=UIMgr.getUIByName(UIConst.ArtifactView),e=t.list_shenqi.array.findIndex(function(t){return a.ArtifactModel.getInstance().isCanActivit(t.ID)});return t.list_shenqi.selectedIndex=e,a.GuideManager.timeout(100)}).then(function(){var t=UIMgr.getUIByName(UIConst.ArtifactView);return a.GuideMask.show(t.btn_unlock,a.DirectionType.bottom),a.GuideManager.listenNotification(a.ArtifactEvent.ARTIFACT_UNLOCK_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.sqSt_unlock)}).then(function(){return e._curStep=a.WeakGuideStep.sqSt_do,UIMgr.hasStage(UIConst.Artifact_UnLockView)?a.GuideManager.timeout(common.GlobalData.DIALOG_EFFECT_TIME):a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.Artifact_UnLockView,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.Artifact_UnLockView,e)}).then(function(){a.GuideMask.hide(),t()})},n.prototype.strength=function(t){var e=this;if(a.ArtifactModel.getInstance().getUnlockArtifactNum()<2)return loghgy("兼容：没有解锁两把神器不能进行强化，直接完成该引导步骤",a.WeakGuideStep.sqSt_do),void a.GuideManager.guideRequest(0,a.WeakGuideStep.sqSt_do).then(function(){a.GuideMask.hide(),t()});this._curStep=a.WeakGuideStep.sqSt_do,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12040),!1).then(function(){return a.GuideManager.listenNotification(a.GuideEvent.Guide_Talk_End,null,e)}).then(function(){return a.GuideManager.talk(LanMgr.getLan("",12041))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return!!UIMgr.hasStage(UIConst.ArtifactView)||a.GuideWeakManager.listenToMain(3,e)}).then(function(){return a.GuideManager.timeout(100)}).then(function(){return UIMgr.getUIByName(UIConst.ArtifactView).tab.selectedIndex=0,a.GuideManager.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.ArtifactView);return a.GuideMask.show(t.btn_strength,a.DirectionType.bottom),a.GuideManager.listenNotification(a.ArtifactEvent.ARTIFACT_STRENGTH_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.sqSt_do)}).then(function(){a.GuideMask.hide(),t()})},n.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},n);function n(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.sqSt_unlock]=this.unlock.bind(this),this.guideList[a.WeakGuideStep.sqSt_do]=this.strength.bind(this)}a.ShenqiStrengthOpenGuide=i;var o=(r.prototype.getGuideStep=function(){return a.WeakGuideStep.guideJingjichang},r.prototype.getCurChildStep=function(){return this._curStep},r.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.JINGJI,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideJingjichang,t)})})},r.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.jjc_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.jjc_open,ModuleConst.JINGJI,e)}).then(function(){t()})},r.prototype.fight=function(t){var n=this;this._curStep=a.WeakGuideStep.jjc_fight,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12042)).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,n)}).then(function(){return a.GuideWeakManager.listenGoToSys(ModuleConst.JINGJI,UIConst.ArenaView,n)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.ArenaView);t.rankList.scrollBar.touchScrollEnable=!1;var e=t.rankList.array.findIndex(function(t){return t.isMySelf()});--e;var i=t.rankList.getCell(e);return a.GuideMask.show(i,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.PlayerLineupInfoView,n)}).then(function(){return a.GuideMask.showWithTransparent(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.PlayerLineupInfoView,n)}).then(function(){return UIMgr.getUIByName(UIConst.ArenaView).rankList.scrollBar.touchScrollEnable=!0,a.GuideManager.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.PlayerLineupInfoView);return a.GuideMask.show(t.btnChallenge,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightViews,n)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.jjc_fight)}).then(function(){return n._curStep=0,a.GuideMask.hide(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightViews,n)}).then(function(){a.GuideMask.hide(),t()})},r.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},r);function r(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.jjc_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.jjc_fight]=this.fight.bind(this)}a.JingjichangOpenGuide=o;var s=(u.prototype.getGuideStep=function(){return a.WeakGuideStep.guideWorldboss},u.prototype.getCurChildStep=function(){return this._curStep},u.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.WORLD_BOSS,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideWorldboss,t)})})},u.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.boss_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.boss_open,ModuleConst.WORLD_BOSS,e)}).then(function(){t()})},u.prototype.challenge=function(t){var e=this;this._curStep=a.WeakGuideStep.boss_do,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12043))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideWeakManager.listenGoToSys(ModuleConst.WORLD_BOSS,UIConst.WorldBoss_BossView,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.boss_do)}).then(function(){e._curStep=0;var t=UIMgr.getUIByName(UIConst.WorldBoss_BossView);return a.GuideMask.show(t.btnChallege,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightViews,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.WorldBoss_BossView);return t&&(t.bossList.scrollBar.touchScrollEnable=!0),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightViews,e)}).then(function(){t()})},u.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},u);function u(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.boss_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.boss_do]=this.challenge.bind(this)}a.WorldBossOpenGuide=s;var h=(l.prototype.getGuideStep=function(){return a.WeakGuideStep.guideShenjiemen},l.prototype.getCurChildStep=function(){return this._curStep},l.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.SHENMEN,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideShenjiemen,t)})})},l.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.sm_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.sm_open,ModuleConst.SHENMEN,e)}).then(function(){t()})},l.prototype.startGuide=function(t){var e=this;this._curStep=a.WeakGuideStep.sm_do,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12044)).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.guideToMainView(0,"",e)}).then(function(){return a.GuideManager.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.Main3DView);return a.GuideMask.show(t.btn_shenjiezhimen,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.GodDoorView,e)}).then(function(){return a.GuideMask.showWithTransparent(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.GodDoorView,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.sm_do)}).then(function(){return e._curStep=0,a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.GodDoorView);return a.GuideMask.show(t.vs_item0.boxLeft,a.DirectionType.right,LanMgr.getLan("",12045),!0),a.GuideManager.listenNotification(a.GodDoorEvent.TURN_BUILD_OK,function(){return 3==UIMgr.getUIByName(UIConst.GodDoorView).vs_item0.getLastType()},e)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.GodDoorView);return a.GuideMask.show(t.vs_item0.btn_kaiqi,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.CommonRewardView,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.CommonRewardView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.GodDoorView);return a.GuideMask.show(t.bgPanel.btnClose,a.DirectionType.left),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GodDoorView,e)}).then(function(){a.GuideMask.hide(),t()})},l.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},l);function l(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.sm_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.sm_do]=this.startGuide.bind(this)}a.ShenjiemenOpenGuide=h;var c=(p.prototype.getGuideStep=function(){return a.WeakGuideStep.guideDailyCopy},p.prototype.getCurChildStep=function(){return this._curStep},p.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.DAILY_COPY,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideDailyCopy,t)})})},p.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.daily_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.daily_open,ModuleConst.DAILY_COPY,e)}).then(function(){t()})},p.prototype.challenge=function(t){var i=this;if(a.DailyCopyModel.getInstance().isHasChallenge(iface.tb_prop.dailyCopyTypeKey.gold))return loghgy("兼容：已挑战过每日副本，直接完成该引导步骤",a.WeakGuideStep.daily_challenge),void a.GuideManager.guideRequest(0,a.WeakGuideStep.daily_challenge).then(function(){a.GuideMask.hide(),t()});this._curStep=a.WeakGuideStep.daily_challenge,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12046))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,i)}).then(function(){return a.GuideWeakManager.listenGoToSys(ModuleConst.DAILY_COPY,UIConst.Copy_DailyMainView,i)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.Copy_DailyMainView);return a.GuideMask.show(t.img_box_0,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.Copy_DailyView,i)}).then(function(){return a.GuideMask.showWithTransparent(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.Copy_DailyView,i)}).then(function(){var t=UIMgr.getUIByName(UIConst.Copy_DailyView);t.list.scrollBar.touchScrollEnable=!1;var e=t.list.getCell(0);return a.GuideMask.show(e.btn_fight,a.DirectionType.bottom),new a.FightEndWaitStatus(!0,i).execute()}).then(function(){return UIMgr.getUIByName(UIConst.Copy_DailyView).list.scrollBar.touchScrollEnable=!0,a.GuideManager.guideRequest(0,a.WeakGuideStep.daily_challenge)}).then(function(){i._curStep=0,UIMgr.hideUIByName(UIConst.Copy_DailyView);var t=UIMgr.getUIByName(UIConst.SysTopView);return a.GuideMask.show(t.btnClose,a.DirectionType.top),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.Copy_DailyMainView,i)}).then(function(){a.GuideMask.hide(),t()})},p.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},p);function p(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.daily_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.daily_challenge]=this.challenge.bind(this)}a.DailyCopyOpenGuide=c;var d=(_.prototype.getGuideStep=function(){return a.WeakGuideStep.guideJinglian},_.prototype.getCurChildStep=function(){return this._curStep},_.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.EQUIP_JINGLIAN,e).then(function(){if(App.hero.getLineUpTeam(iface.tb_prop.lineupTypeKey.attack).every(function(t){return t.equipKeys.length<=0&&!t.isCanOneKeyEquip()}))return loghgy("兼容：所有上阵英雄都没有装备且背包无装备的前提下，直接完成该弱引导步骤"+a.WeakGuideStep.guideJinglian),void a.GuideManager.guideRequest(0,a.WeakGuideStep.guideJinglian).then(function(){e._isPass=!0,t()});a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideJinglian,t)})})},_.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.jl_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.setCurExcutingStep(a.WeakGuideStep.guideJinglian),a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.jl_open,ModuleConst.EQUIP_JINGLIAN,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12047))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){t()})},_.prototype.wearEquip=function(t){var e=this;if(0<App.hero.getGodAry()[0].equipKeys.length)return loghgy("兼容：第1只英雄已穿戴了装备，直接完成该引导步骤"+a.WeakGuideStep.jl_wearEquip),void a.GuideManager.guideRequest(0,a.WeakGuideStep.jl_wearEquip).then(function(){t()});this._curStep=a.WeakGuideStep.jl_wearEquip,a.GuideWeakManager.listenToMain(2,this).then(function(){return a.GuideManager.timeout(300)}).then(function(){return UIMgr.getUIByName(UIConst.EquipView).onMouseIndex(null,EquipTabType.strength),a.GuideManager.timeout(100)}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return a.GuideMask.show(t.viewEquip.btn_wear,a.DirectionType.bottom),a.GuideManager.listenNotification(a.EquipEvent.ONEKE_WEAR_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.jl_wearEquip)}).then(function(){a.GuideMask.hide(),t()})},_.prototype.jinglianEquip1=function(t){var i=this;this._curStep=a.WeakGuideStep.jl_jinglianEquip,loghgy("开始引导精炼装备1"),Promise.resolve().then(function(){return!!UIMgr.hasStage(UIConst.EquipView)||a.GuideWeakManager.listenToMain(2,i)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var e=UIMgr.getUIByName(UIConst.EquipView),t=e.view_list.selection;return t instanceof a.TabEquip&&t.curType==EquipTabType.refine||(a.GuideMask.show(e.list_tab.getCell(EquipTabType.refine),a.DirectionType.left),a.GuideManager.listenNotification(a.EquipEvent.SWITCH_TAB_SUCCESS,function(){var t=e.view_list.selection;return t instanceof a.TabEquip&&t.curType==EquipTabType.refine},i))}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return a.GuideMask.show(t.viewEquip.btn_rootRefine,a.DirectionType.bottom),a.GuideManager.listenNotification(a.EquipEvent.ONEKE_REFINE_SUCCESS,null,i)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.jl_jinglianEquip)}).then(function(){i._curStep=0,a.GuideMask.hide(),t()})},_.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},_);function _(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.jl_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.jl_wearEquip]=this.wearEquip.bind(this),this.guideList[a.WeakGuideStep.jl_jinglianEquip]=this.jinglianEquip1.bind(this)}a.JinglianOpenGuide=d;var f=(g.prototype.getGuideStep=function(){return a.WeakGuideStep.guideGuild},g.prototype.getCurChildStep=function(){return this._curStep},g.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.GONGHUI,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideGuild,t)})})},g.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.guild_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.guild_open,ModuleConst.GONGHUI,e)}).then(function(){t()})},g.prototype.startGuide=function(t){var e=this;this._curStep=a.WeakGuideStep.guild_do,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12048))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.guideToMainView(0,"",e)}).then(function(){return a.GuideManager.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.Main3DView);return a.GuideMask.show(t.btnGonghui,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.GuildinitView,e)}).then(function(){return a.GuideMask.showWithTransparent(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.GuildinitView,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.guild_do)}).then(function(){return e._curStep=0,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12049))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){a.GuideMask.hide(),t()})},g.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},g);function g(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.guild_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.guild_do]=this.startGuide.bind(this)}a.GuildOpenGuide=f;var y=(m.prototype.getGuideStep=function(){return a.WeakGuideStep.guideIsland},m.prototype.getCurChildStep=function(){return this._curStep},m.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.Island,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideIsland,t)})})},m.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.island_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.island_open,ModuleConst.Island,e)}).then(function(){t()})},m.prototype.startGuide=function(t){var e=this;this._curStep=a.WeakGuideStep.island_do,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12050)).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideWeakManager.listenGoToSys(ModuleConst.Island,UIConst.IslandView,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12051))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.IslandView);return t.itemPanel.hScrollBar.touchScrollEnable=!1,a.GuideMask.show(t.item0,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.OreMapView,e)}).then(function(){return UIMgr.getUIByName(UIConst.IslandView).itemPanel.hScrollBar.touchScrollEnable=!0,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12052),!1)}).then(function(){return a.GuideManager.listenNotification(a.GuideEvent.Guide_Talk_End,null,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12053))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.island_do)}).then(function(){e._curStep=0,a.GuideMask.hide(),t()})},m.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},m);function m(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.island_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.island_do]=this.startGuide.bind(this)}a.IslandOpenGuide=y;var v=(b.prototype.getGuideStep=function(){return a.WeakGuideStep.guideYuanzheng},b.prototype.getCurChildStep=function(){return this._curStep},b.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.EXPEDITION,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideYuanzheng,t)})})},b.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.yuanzheng_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.yuanzheng_open,ModuleConst.EXPEDITION,e)}).then(function(){t()})},b.prototype.startGuide=function(t){var e=this;this._curStep=a.WeakGuideStep.yuanzheng_do,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12054))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideWeakManager.listenGoToSys(ModuleConst.EXPEDITION,UIConst.YuanzhengView,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12055))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.YuanzhengView);return t.itemPanel.hScrollBar.touchScrollEnable=!1,a.GuideMask.show(t.item1,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.Yuanzheng_ChallengeView,e)}).then(function(){return a.GuideMask.showWithTransparent(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.Yuanzheng_ChallengeView,e)}).then(function(){UIMgr.getUIByName(UIConst.YuanzhengView).itemPanel.hScrollBar.touchScrollEnable=!0;var t=UIMgr.getUIByName(UIConst.Yuanzheng_ChallengeView);return a.GuideMask.show(t.btnChallenge,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.BuzhenView,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.yuanzheng_do)}).then(function(){return e._curStep=0,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12056))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){a.GuideMask.hide(),t()})},b.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},b);function b(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.yuanzheng_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.yuanzheng_do]=this.startGuide.bind(this)}a.YuanzhengOpenGuide=v;var I=(T.prototype.getGuideStep=function(){return a.WeakGuideStep.guideFogForest},T.prototype.getCurChildStep=function(){return this._curStep},T.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.FOG_FOREST,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideFogForest,t)})})},T.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.forest_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.forest_open,ModuleConst.FOG_FOREST,e)}).then(function(){t()})},T.prototype.challenge=function(t){var e=this;if(0<App.hero.forestMaxFloor)return loghgy("兼容：已引导过迷雾森林，直接完成该引导步骤"+a.WeakGuideStep.forest_challenge),void a.GuideManager.guideRequest(0,a.WeakGuideStep.forest_challenge).then(function(){t()});this._curStep=a.WeakGuideStep.forest_challenge,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12057))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideWeakManager.listenGoToSys(ModuleConst.FOG_FOREST,UIConst.FogForestView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.FogForestView);return a.GuideMask.show(t.awardUI,a.DirectionType.bottom,LanMgr.getLan("",12058),!1),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideMask,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.FogForestView);return a.GuideMask.show(t.guanqia1.boxChallenge,a.DirectionType.bottom),new a.FightEndWaitStatus(!0,e).execute()}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.forest_challenge)}).then(function(){return e._curStep=0,a.GuideMask.showWithTransparent(),UIMgr.hasStage(UIConst.FogForestView)?a.GuideManager.timeout(common.GlobalData.DIALOG_EFFECT_TIME):a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FogForestView,e)}).then(function(){return!!UIMgr.hasStage(UIConst.SysTopView)||a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.SysTopView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.SysTopView);return a.GuideMask.show(t.btnClose,a.DirectionType.top),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FogForestView,e)}).then(function(){a.GuideMask.hide(),t()})},T.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},T);function T(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.forest_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.forest_challenge]=this.challenge.bind(this)}a.ForestOpenGuide=I;var w=(E.prototype.getGuideStep=function(){return a.WeakGuideStep.guideRonghun},E.prototype.getCurChildStep=function(){return this._curStep},E.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.RONGHUN,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideRonghun,t)})})},E.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.ronghun_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.ronghun_open,ModuleConst.RONGHUN,e)}).then(function(){t()})},E.prototype.startGuide=function(t){var e=this;this._curStep=a.WeakGuideStep.ronghun_do,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12059)).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideWeakManager.listenToMain(1,e)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return t.list_tab.selectedIndex==ShenlingTabType.ronghun||(a.GuideMask.show(t.list_tab.getCell(ShenlingTabType.ronghun),a.DirectionType.left),a.GuideManager.listenNotification(a.GodEvent.SWITCH_TAB_SUCCESS,function(){return t.list_tab.selectedIndex=ShenlingTabType.ronghun,!0},e))}).then(function(){return a.GuideManager.timeout(100)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return a.GuideMask.show(t.viewRonghun.jindubox2,a.DirectionType.bottom),a.GuideManager.listenNotification(a.GodEvent.SELECT_RONGHUN_ITEM,null,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return a.GuideMask.show(t.viewRonghun.btn_one,a.DirectionType.bottom),a.GuideManager.listenNotification(a.GodEvent.RONGHUN_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.ronghun_do)}).then(function(){e._curStep=0,t()})},E.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},E);function E(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.ronghun_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.ronghun_do]=this.startGuide.bind(this)}a.RonghunOpenGuide=w;var C=(S.prototype.getGuideStep=function(){return a.WeakGuideStep.guideAdventure},S.prototype.getCurChildStep=function(){return this._curStep},S.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.ADVENTURE,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideAdventure,t)})})},S.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.advt_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.advt_open,ModuleConst.ADVENTURE,e)}).then(function(){t()})},S.prototype.startGuide=function(t){var e=this;this._curStep=a.WeakGuideStep.advt_do,loghgy("探险开启"),a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12060)).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.guideToMainView(5,"",e)}).then(function(){return a.GuideManager.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuajiView);return a.GuideMask.show(t.bottomUI.btn_adventure,a.DirectionType.top),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.DafuwengView,e)}).then(function(){return a.GuideManager.timeout(500)}).then(function(){var t=UIMgr.getUIByName(UIConst.DafuwengView);return a.GuideMask.show(t.btn_play,a.DirectionType.top),a.GuideManager.listenNotification(a.DafuwengEvent.PLAY_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.advt_do)}).then(function(){return e._curStep=0,a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.DafuwengView,e)}).then(function(){a.GuideMask.hide(),t()})},S.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},S);function S(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.advt_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.advt_do]=this.startGuide.bind(this)}a.AdventureOpenGuide=C;var L=(x.prototype.getGuideStep=function(){return a.WeakGuideStep.guideBaoshi},x.prototype.getCurChildStep=function(){return this._curStep},x.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.EQUIP_BAOSHI,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideBaoshi,t)})})},x.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.bs_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.bs_open,ModuleConst.EQUIP_BAOSHI,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12061))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){t()})},x.prototype.equip=function(t){var e=this;if(0<App.hero.getGodAry()[0].equipKeys.length)return loghgy("兼容：第1只英雄已穿戴了装备，直接完成该引导步骤"+a.WeakGuideStep.bs_equip),void a.GuideManager.guideRequest(0,a.WeakGuideStep.bs_equip).then(function(){t()});this._curStep=a.WeakGuideStep.bs_equip,a.GuideWeakManager.listenToMain(2,this).then(function(){return a.GuideManager.timeout(300)}).then(function(){return UIMgr.getUIByName(UIConst.EquipView).onMouseIndex(null,EquipTabType.strength),a.GuideManager.timeout(100)}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return a.GuideMask.show(t.viewEquip.btn_wear,a.DirectionType.bottom),a.GuideManager.listenNotification(a.EquipEvent.ONEKE_WEAR_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.bs_equip)}).then(function(){a.GuideMask.hide(),t()})},x.prototype.gemLvup=function(t){var i=this;this._curStep=a.WeakGuideStep.bs_lvup,Promise.resolve().then(function(){return!!UIMgr.hasStage(UIConst.God_MainView)||a.GuideWeakManager.listenToMain(2,i)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView),e=t.view_list.selection;return e instanceof a.TabBaoshiNew||(a.GuideMask.show(t.list_tab.getCell(EquipTabType.baoshi),a.DirectionType.left),a.GuideManager.listenNotification(a.EquipEvent.SWITCH_TAB_SUCCESS,function(){return(e=t.view_list.selection)instanceof a.TabBaoshiNew},i))}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return a.GuideMask.show(t.viewBaoshi.btnOnekeyWear,a.DirectionType.bottom),a.GuideManager.listenNotification(a.GemstoneEvent.ONE_KEY_WEAR_SUCCESS,null,i)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.bs_lvup)}).then(function(){return i._curStep=0,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12062))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,i)}).then(function(){a.GuideMask.hide(),t()})},x.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},x);function x(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.bs_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.bs_equip]=this.equip.bind(this),this.guideList[a.WeakGuideStep.bs_lvup]=this.gemLvup.bind(this)}a.BaoshiOpenGuide=L;var A=(M.prototype.getGuideStep=function(){return a.WeakGuideStep.guideEscort},M.prototype.getCurChildStep=function(){return this._curStep},M.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.CARAVAN_ESCORT,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideEscort,t)})})},M.prototype.open=function(t){var e=this;UIMgr.hideUIByName(UIConst.BuzhenView),this._curStep=a.WeakGuideStep.escort_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.escort_open,ModuleConst.CARAVAN_ESCORT,e)}).then(function(){t()})},M.prototype.refresh=function(t){var e=this;this._curStep=a.WeakGuideStep.escort_refresh,Promise.resolve().then(function(){return a.GuideMask.hide(),LanMgr.getLan("",12064),a.GuideManager.talk(LanMgr.getLan("",12063),!1)}).then(function(){return a.GuideManager.listenNotification(a.GuideEvent.Guide_Talk_End,null,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12064))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideWeakManager.listenGoToSys(ModuleConst.CARAVAN_ESCORT,UIConst.EscortMainView,e)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.EscortMainView);return a.GuideMask.show(t.btn_refresh,a.DirectionType.bottom),a.GuideManager.listenNotification(a.EscortEvent.REFRESH_GOODS_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.escort_refresh)}).then(function(){return e._curStep=a.WeakGuideStep.escort_go,a.GuideMask.showWithTransparent(),a.GuideManager.listenNotification(a.EscortEvent.ANIMATION_END,null,e)}).then(function(){a.GuideMask.hide(),t()})},M.prototype.escort=function(t){var e=this;this._curStep=a.WeakGuideStep.escort_go,Promise.resolve().then(function(){return!!UIMgr.hasStage(UIConst.EscortMainView)||a.GuideWeakManager.listenGoToSys(ModuleConst.CARAVAN_ESCORT,UIConst.EscortMainView,e)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.EscortMainView);return a.GuideMask.show(t.btnEscort,a.DirectionType.bottom),a.GuideManager.listenNotification(a.EscortEvent.ESCORT_GOODS_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.escort_go)}).then(function(){return e._curStep=0,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12065))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.SysTopView);return a.GuideMask.show(t.btnClose,a.DirectionType.top),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.EscortMainView,e)}).then(function(){a.GuideMask.hide(),t()})},M.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},M);function M(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.escort_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.escort_refresh]=this.refresh.bind(this),this.guideList[a.WeakGuideStep.escort_go]=this.escort.bind(this)}a.EscortOpenGuide=A;var D=(O.prototype.getGuideStep=function(){return a.WeakGuideStep.guideTower},O.prototype.getCurChildStep=function(){return this._curStep},O.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.SHILIANTA,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideTower,t)})})},O.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.tower_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.tower_open,ModuleConst.SHILIANTA,e)}).then(function(){a.GuideMask.hide(),t()})},O.prototype.startGuide=function(t){var e=this;this._curStep=a.WeakGuideStep.tower_fight,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12066))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideWeakManager.listenGoToSys(ModuleConst.SHILIANTA,UIConst.ShiliantaView,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12067))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.ShiliantaView);return a.GuideMask.show(t.gkitem_0,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.SLT_GuanqiaView,e)}).then(function(){return a.GuideMask.showWithTransparent(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.SLT_GuanqiaView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.SLT_GuanqiaView);return a.GuideMask.show(t.btnChallenge,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightViews,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.tower_fight)}).then(function(){return new a.FightEndWaitStatus(!0,e).execute()}).then(function(){a.GuideMask.hide(),t()})},O.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},O);function O(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.tower_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.tower_fight]=this.startGuide.bind(this)}a.TowerOpenGuide=D;var R=(P.prototype.getGuideStep=function(){return a.WeakGuideStep.guideGodAwaken},P.prototype.getCurChildStep=function(){return this._curStep},P.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.JUEXING,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideGodAwaken,t)})})},P.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.awaken_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.awaken_open,ModuleConst.JUEXING,e)}).then(function(){a.GuideMask.hide(),t()})},P.prototype.startGuide=function(t){var e=this;this._curStep=a.WeakGuideStep.awaken_do,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12068))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.guideToMainView(1)}).then(function(){return UIMgr.getUIByName(UIConst.God_MainView).list_tab.selectedIndex=ShenlingTabType.awaken,a.GuideManager.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return a.GuideMask.show(t.viewJuexing.btn_juexing,a.DirectionType.bottom),a.GuideManager.listenNotification(a.GodEvent.GOD_AWAKEN_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.awaken_do)}).then(function(){return e._curStep=0,a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12069))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return a.GuideMask.show(t.viewJuexing.btnLook,a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.GodSkinView,e)}).then(function(){return a.GuideMask.hide(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GodSkinView,e)}).then(function(){a.GuideMask.hide(),t()})},P.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},P);function P(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.awaken_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.awaken_do]=this.startGuide.bind(this)}a.GodAwakenOpenGuide=R;var U=(k.prototype.getGuideStep=function(){return a.WeakGuideStep.guideTreasure},k.prototype.getCurChildStep=function(){return this._curStep},k.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.TREASURE,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideTreasure,t)})})},k.prototype.open=function(t){this._curStep=a.WeakGuideStep.treasure_open,a.GuideWeakManager.guideSysOpenToScene(-1,this).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.treasure_open)}).then(function(){a.GuideMask.hide(),t()})},k.prototype.wear=function(t){var e=this;this._curStep=a.WeakGuideStep.treasure_wear,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12070))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.guideToMainView(1)}).then(function(){return UIMgr.getUIByName(UIConst.God_MainView).list_tab.selectedIndex=ShenlingTabType.info,a.GuideManager.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return a.GuideMask.show(t.godView.treasureUI,a.DirectionType.left),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.ChooseTreasureView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.ChooseTreasureView);return a.GuideMask.show(t.itemList.getCell(0),a.DirectionType.bottom),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.TreasureTipsView,e)}).then(function(){return a.GuideMask.showWithTransparent(),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.TreasureTipsView,e)}).then(function(){var t=a.TreasureTipsView.getTipsUI();return a.GuideMask.show(t.getBtnWear(),a.DirectionType.bottom),a.GuideManager.listenNotification(a.TreasureEvent.WEAR_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.treasure_wear)}).then(function(){a.GuideMask.hide(),t()})},k.prototype.strength=function(t){var e=this;this._curStep=a.WeakGuideStep.treasure_streng,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12071))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,e)}).then(function(){return a.GuideManager.guideToMainView(1)}).then(function(){return UIMgr.getUIByName(UIConst.God_MainView).list_tab.selectedIndex=ShenlingTabType.info,a.GuideManager.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return a.GuideMask.show(t.godView.treasureUI,a.DirectionType.left),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.TreasureTipsView,e)}).then(function(){var t=a.TreasureTipsView.getTipsUI();return a.GuideMask.show(t.getBtnStreng(),a.DirectionType.left),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.TreasureStrengthView,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.TreasureStrengthView);return a.GuideMask.show(t.itemList.getCell(0),a.DirectionType.bottom),a.GuideManager.listenNotification(a.TreasureEvent.SELECT_STRENGTH_TREASURE,null,e)}).then(function(){var t=UIMgr.getUIByName(UIConst.TreasureStrengthView);return a.GuideMask.show(t.btnStrength,a.DirectionType.bottom),a.GuideManager.listenNotification(a.TreasureEvent.STRENGTH_SUCCESS,null,e)}).then(function(){return a.GuideManager.guideRequest(0,a.WeakGuideStep.treasure_streng)}).then(function(){e._curStep=0,a.GuideMask.hide(),t()})},k.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},k);function k(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.treasure_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.treasure_wear]=this.wear.bind(this),this.guideList[a.WeakGuideStep.treasure_streng]=this.strength.bind(this)}a.TreasureOpenGuide=U;var B=(V.prototype.getGuideStep=function(){return a.WeakGuideStep.guideChat},V.prototype.getCurChildStep=function(){return this._curStep},V.prototype.execute=function(){var e=this;return new Promise(function(t){a.GuideWeakManager.listenSysOpen(ModuleConst.CHAT,e).then(function(){a.GuideWeakManager.runGuideList(e.guideList,a.WeakGuideStep.guideChat,t)})})},V.prototype.open=function(t){var e=this;this._curStep=a.WeakGuideStep.chat_open,a.GuideWeakManager.guideSysOpenToScene(5,this).then(function(){return a.GuideWeakManager.waitSysOpenAnim(a.WeakGuideStep.chat_open,ModuleConst.CHAT,e)}).then(function(){a.GuideMask.hide(),t()})},V.prototype.startGuide=function(t){var i=this;this._curStep=a.WeakGuideStep.chat_send,Promise.resolve().then(function(){return a.GuideMask.hide(),a.GuideManager.talk(LanMgr.getLan("",12072))}).then(function(){return a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView,i)}).then(function(){return a.GuideManager.guideToMainView(5)}).then(function(){var t=UIMgr.getUIByName(UIConst.HudView),e=t.btn_chat.x>=t.width/2?a.DirectionType.left:a.DirectionType.right;return a.GuideMask.show(t.btn_chat,e),a.GuideManager.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.ChatView,i)}).then(function(){var t=UIMgr.getUIByName(UIConst.ChatView);return a.GuideMask.show(t.btnQuick,a.DirectionType.right),a.GuideManager.listenNotification(a.ChatEvent.SHORTCUTS_OPEN_OR_HIDE,function(){var t=UIMgr.getUIByName(UIConst.ChatView);return t.quickUI.visible||(t.quickUI.visible=!0),!0},i)}).then(function(){var t=UIMgr.getUIByName(UIConst.ChatView);return t.quickUI.forbitHide=!0,a.GuideMask.show(t.quickUI.lanList.getCell(0),a.DirectionType.top,""),a.GuideManager.listenNotification(a.ChatEvent.CHAT_SEND_SUCCESS,null,i)}).then(function(){var t=UIMgr.getUIByName(UIConst.ChatView);return t.quickUI.forbitHide=!1,t.quickUI.onOpenOrHide(),a.GuideManager.guideRequest(0,a.WeakGuideStep.chat_send)}).then(function(){a.GuideMask.hide(),t()})},V.prototype.dispose=function(){this._curStep=0,tl3d.ModuleEventManager.removeEventByTarget(this),this._isPass||(loghgy("执行dispose方法：触发引导完成后释放",this),UIMgr.hideUIByName(UIConst.GuideTalkView),a.GuideMask.hide(),a.GuideWeakManager.setCurExcutingStep(-1))},V);function V(){this._isPass=!1,this._curStep=0,this.guideList={},this.guideList[a.WeakGuideStep.chat_open]=this.open.bind(this),this.guideList[a.WeakGuideStep.chat_send]=this.startGuide.bind(this)}a.ChatOpenGuide=B}(game=game||{}),function(a){var t=(r.startRun=function(){if(!r._isInit){var t;r._isInit=!0,this._stepNames={},this._guideList=[],t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.SHOUCHONG),this._stepNames[a.WeakGuideStep.guideShouchong]="首冲引导  "+t.prompt+"  开启参数：固定"+common.GlobalData.SHOUCHONG_OPEN_LV+"级开启",this._guideList.push({level:common.GlobalData.SHOUCHONG_OPEN_LV,clzVo:new a.ShouchongGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.CHAT),this._stepNames[a.WeakGuideStep.guideChat]="聊天开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.ChatOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.SHILIANTA),this._stepNames[a.WeakGuideStep.guideTower]="试练塔开启引开导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.TowerOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.ADVENTURE),this._stepNames[a.WeakGuideStep.guideAdventure]="探险大富翁开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.AdventureOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.JINGJI),this._stepNames[a.WeakGuideStep.guideJingjichang]="竞技场开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.JingjichangOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.WORLD_BOSS),this._stepNames[a.WeakGuideStep.guideWorldboss]="世界boss开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.WorldBossOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.DAILY_COPY),this._stepNames[a.WeakGuideStep.guideDailyCopy]="每日副本开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.DailyCopyOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIP_JINGLIAN),this._stepNames[a.WeakGuideStep.guideJinglian]="装备精炼开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.JinglianOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.JUEXING),this._stepNames[a.WeakGuideStep.guideGodAwaken]="英雄觉醒开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.GodAwakenOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.GONGHUI),this._stepNames[a.WeakGuideStep.guideGuild]="公会开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.GuildOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.SHENMEN),this._stepNames[a.WeakGuideStep.guideShenjiemen]="神界之门开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.ShenjiemenOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.RONGHUN),this._stepNames[a.WeakGuideStep.guideRonghun]="融魂开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.RonghunOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.FOG_FOREST),this._stepNames[a.WeakGuideStep.guideFogForest]="迷雾森林开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.ForestOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EXPEDITION),this._stepNames[a.WeakGuideStep.guideYuanzheng]="远征开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.YuanzhengOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.CARAVAN_ESCORT),this._stepNames[a.WeakGuideStep.guideEscort]="护送开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.EscortOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.Island),this._stepNames[a.WeakGuideStep.guideIsland]="神秘岛屿开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.IslandOpenGuide}),t=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.TREASURE),this._stepNames[a.WeakGuideStep.guideTreasure]="英雄圣物开启引导  "+t.prompt+"  开启参数："+t.open_parameter,this._guideList.push({level:t.open_parameter,clzVo:new a.TreasureOpenGuide}),this._guideList.sort(function(t,e){return t.level-e.level}),this._curList=[];for(var e=a.GuideWeakManager.getWeakGuideSteps(),i=0;i<this._guideList.length;i++){var n=this._guideList[i].clzVo,o=n.getGuideStep?n.getGuideStep():0;0<o&&-1==e.indexOf(o)&&this._curList.push(n)}r.runGuide()}},r.runGuide=function(){if(0<this._curList.length){loghgy("开启有序弱引导");var t=this._curList.shift();t.execute().then(function(){return t.dispose()}).then(function(){r.runGuide()})}else loghgy("完成所有有序弱引导")},r.getGuideStatus=function(e){return this._guideList.find(function(t){return t.clzVo.getGuideStep()==e}).clzVo},r.getStepName=function(t){return this._stepNames[t]},r._guideList=[],r._stepNames={},r._isInit=!1,r._curList=[],r);function r(){}a.GuideQueueManager=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(I){var i,T,t,e=(i=ui.guide.GuideMaskUI,__extends(n,i),n.prototype.setSize=function(t,e){i.prototype.setSize.call(this,t,e),this.btnPass.y=GameUtil.isFullScreen()?I.HudModel.TOP_ADD_HEIGHT+54:54,this.bg.width=t,this.bg.height=e},n.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.dataSource?this.showGuide(this.dataSource):this.showTransparent()},n.prototype.showGuide=function(t){this.bg.alpha=t.maskAlpha;var e=(this._maskOpt=t).target,i=t.arrowDir,n=t.text,o=t.textDir,a=t.mouseThrough,r=n&&0<n.length,s=e.getBounds(),u=e.localToGlobal(new Laya.Point(0,0)),h=e.width||s.width||50;h=Math.floor(h*e.scaleX);var l=e.height||s.height||50;l=Math.floor(l*e.scaleY);var c=Math.floor(u.x),p=Math.floor(u.y);if(this.hitArea.unHit.clear(),a&&this.hitArea.unHit.drawRect(c,p,h,l,ColorConst.normalFont),this._maskOpt.showJianbianMask){this.maskMid.visible=!0;var d=Math.round(c+h/2),_=Math.round(p+l/2),f=this.maskMid.width,g=this.maskMid.height;this.maskMid.x=d;var y=(this.maskMid.y=_)-g/2;this.maskTop.visible=0<y,this.maskTop.visible&&(this.maskTop.width=this.width,this.maskTop.height=y,this.maskTop.x=this.width/2,this.maskTop.y=y);var m=d-f/2;this.maskLf.visible=0<m,this.maskLf.visible&&(this.maskLf.width=m,this.maskLf.height=g,this.maskLf.x=m,this.maskLf.y=_);var v=this.width-d-f/2;this.maskRg.visible=0<v,this.maskRg.visible&&(this.maskRg.width=v,this.maskRg.height=g,this.maskRg.x=d+f/2,this.maskRg.y=_);var b=this.height-_-g/2;this.maskBottom.visible=0<b,this.maskBottom.visible&&(this.maskBottom.width=this.width,this.maskBottom.height=b,this.maskBottom.x=this.width/2,this.maskBottom.y=_+g/2)}else this.maskTop.visible=this.maskBottom.visible=this.maskLf.visible=this.maskRg.visible=this.maskMid.visible=!1;this.ani1.play(0,!0),this.aniBox.visible=i!=T.none,this.aniBox.x=c+h/2,this.aniBox.y=p+l/2,this.aniBox.scaleX=this.aniBox.scaleY=1,this.aniBox.rotation=0,i==T.bottom?this.aniBox.scaleY=-1:i==T.left?(this.aniBox.rotation=-90,this.aniBox.scaleX=-1):i==T.right&&(this.aniBox.rotation=90),this.aniBox.x=c+h/2,this.aniBox.y=p+l/2,(this.lbBox.visible=r)?(this._htmlText.style.wordWrap=!1,this._htmlText.innerHTML=n,this.resizeHtmlText(i,o,n)):this._htmlText.innerHTML="",!a||this._maskOpt.cbFun?this.on(Laya.Event.CLICK,this,this.onClick):this.off(Laya.Event.CLICK,this,this.onClick),this.btnPass.visible=I.GuideManager.canShowPassBtn()&&!0,this.btnPass.on(Laya.Event.CLICK,this,this.onPass)},n.prototype.resizeHtmlText=function(t,e,i){var n=this._htmlText.contextWidth;300<n?(this._htmlText.style.wordWrap=!0,this._htmlText.width=300):(this._htmlText.style.wordWrap=!1,this._htmlText.width=n),this.lbBox.height=this.lbImg.height=this._htmlText.y+this._htmlText.contextHeight+20,this.lbBox.width=this.lbImg.width=this._htmlText.x+this._htmlText.contextWidth+20,e==T.top?(this.lbBox.x=this.aniBox.x-this.lbBox.width/2,this.lbBox.y=t==e?this.aniBox.y-150-this.lbBox.height:this.aniBox.y-70-this.lbBox.height):e==T.bottom?(this.lbBox.x=this.aniBox.x-this.lbBox.width/2,this.lbBox.y=t==e?this.aniBox.y+150:this.aniBox.y+70):e==T.right?(this.lbBox.y=this.aniBox.y-this.lbBox.height/2,this.lbBox.x=t==e?this.aniBox.x+150:this.aniBox.x+70):(this.lbBox.y=this.aniBox.y-this.lbBox.height/2,this.lbBox.x=t==e?this.aniBox.x-150-this.lbBox.width:this.aniBox.x-70-this.lbBox.width),this.lbBox.x=this.lbBox.x<0?0:this.lbBox.x,this.lbBox.x=this.lbBox.x>this.width-this.lbBox.width?this.width-this.lbBox.width:this.lbBox.x,this.lbBox.y=this.lbBox.y<0?0:this.lbBox.y,this.lbBox.y=this.lbBox.y>this.height-this.lbBox.height?this.height-this.lbBox.height:this.lbBox.y},n.prototype.showTransparent=function(){this.hide(),this.bg.alpha=0,this.aniBox.visible=!1,this.lbBox.visible=!1,this.btnPass.visible=!1,this.hitArea.unHit.clear(),this.maskTop.visible=this.maskBottom.visible=this.maskLf.visible=this.maskRg.visible=this.maskMid.visible=!1},n.prototype.hide=function(){this.ani1.stop(),this.off(Laya.Event.CLICK,this,this.onClick),this.btnPass.off(Laya.Event.CLICK,this,this.onPass)},n.prototype.onClick=function(t){t.stopPropagation(),this._maskOpt.cbFun?this._maskOpt.cbFun():n.hide()},n.show=function(t,e,i,n,o,a,r){void 0===e&&(e=1),void 0===i&&(i=""),void 0===n&&(n=!0),void 0===o&&(o=null),void 0===a&&(a=0),void 0===r&&(r=!0);var s={target:t,arrowDir:e,text:i,mouseThrough:n,textDir:e,cbFun:o,maskAlpha:a,showJianbianMask:r};if(UIMgr.hasStage(UIConst.GuideMask)){var u=UIMgr.getUIByName(UIConst.GuideMask);u.dataSource=s,u.onOpened()}else UIMgr.showUI(UIConst.GuideMask,s)},n.hide=function(){var t=UIMgr.getUIByName(UIConst.GuideMask);t&&t.hide(),UIMgr.hideUIByName(UIConst.GuideMask)},n.showWithTransparent=function(){if(UIMgr.hasStage(UIConst.GuideMask)){var t=UIMgr.getUIByName(UIConst.GuideMask);t.dataSource=null,t.onOpened()}else UIMgr.showUI(UIConst.GuideMask)},n.setMaskAlpha=function(t){UIMgr.hasStage(UIConst.GuideMask)&&(UIMgr.getUIByName(UIConst.GuideMask).bg.alpha=t)},n.dispose=function(){n.hide()},n.prototype.onPass=function(t){t.stopPropagation(),Laya.timer.frameOnce(5,this,function(){I.GuideManager.passGuide()})},n);function n(){var t=i.call(this)||this;t.isIgnore=!0,t.cacheAs="bitmap",t.mouseEnabled=!0;var e=new Laya.HitArea;return e.hit.drawRect(0,0,Laya.stage.width,Laya.stage.height,ColorConst.normalFont),t.hitArea=e,t._htmlText=new Laya.HTMLDivElement,t._htmlText.x=20,t._htmlText.y=20,t._htmlText.autoSize=!0,t._htmlText.color="#72462b",t._htmlText.style.leading=6,t._htmlText.style.fontSize=25,t._htmlText.style.color="#72462b",t._htmlText.style.wordWrap=!1,t._htmlText.style.stroke=2,t._htmlText.style.strokeColor=ColorConst.WHITE,t.lbBox.addChild(t._htmlText),t}I.GuideMask=e,(t=T=I.DirectionType||(I.DirectionType={}))[t.none=0]="none",t[t.top=1]="top",t[t.bottom=2]="bottom",t[t.left=3]="left",t[t.right=4]="right"}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(c){var t,e;(e=t=c.GuideStep||(c.GuideStep={}))[e.zhaohuan1=1]="zhaohuan1",e[e.buzhen1=2]="buzhen1",e[e.battleExperienceCopy1=3]="battleExperienceCopy1",e[e.godHeCheng=4]="godHeCheng",e[e.buzhen2=5]="buzhen2",e[e.battleExperienceCopy2=6]="battleExperienceCopy2",e[e.rewardGuajiBaoxiang=7]="rewardGuajiBaoxiang",e[e.fastFight=8]="fastFight",e[e.god1LvupTo5=9]="god1LvupTo5",e[e.battleExperienceCopy3=10]="battleExperienceCopy3",e[e.wearEquipment1=11]="wearEquipment1",e[e.battleExperienceCopy4=12]="battleExperienceCopy4",e[e.zhaohuan2=13]="zhaohuan2",e[e.buzhen3=14]="buzhen3",e[e.rewardUploadJL1=15]="rewardUploadJL1",e[e.battleExperienceCopy5=16]="battleExperienceCopy5",e[e.receiveTongguanReward=17]="receiveTongguanReward",e[e.god1LvupTo10=18]="god1LvupTo10",e[e.battleExperienceCopy6=19]="battleExperienceCopy6",e[e.strengthEquipmentLv1=20]="strengthEquipmentLv1",e[e.battleExperienceCopy7=21]="battleExperienceCopy7",e[e.god1LvupTo20=22]="god1LvupTo20",e[e.god1Dgup=23]="god1Dgup",e[e.lingquQiriJL=24]="lingquQiriJL",e[e.endGuide=999]="endGuide";var n,s=(n=tl3d.BaseEvent,__extends(i,n),i.Guide_Start="Guide_Start",i.GUIDE_END="GUIDE_END",i.Guide_Talk_End="Guide_Talk_End",i.START_SHIPIN_GUIDE="START_SHIPIN_GUIDE",i.UPDATE_GUIDE_STATUS="UPDATE_GUIDE_STATUS",i);function i(t,e){void 0===e&&(e=null);var i=n.call(this,t)||this;return i.data=e,i}c.GuideEvent=s;var o=(p.startInit=function(){c.GuideMask.showWithTransparent(),Laya.timer.once(500,null,function(){c.GuideMask.hide(),p.init()})},p.init=function(){if(!p._isInit){p._isInit=!0,(new c.FightTalkGuide).execute();for(var i=[],t=p.getGuideStep(),e=0,n=p.GuideList;e<n.length;e++){var o=n[e];t<o.step&&i.push(o)}if(0==i.length)return c.GuideMask.hide(),loghgy("强引导已全部完成"),UIMgr.hideUIByName(UIConst.GuideTalkView),c.GuideWeakManager.startRun(),void dispatchEvt(new s(s.GUIDE_END));i.sort(function(t,e){return t.step-e.step}),loghgy("进入强引导");var a=null;!function t(){if(a&&(a.dispose(),a=null),0<i.length){var e=i.shift();a=e.execute.apply(e,__spreadArrays([t,e.step],e.args))}else c.GuideMask.hide(),UIMgr.hideUIByName(UIConst.GuideTalkView),loghgy("强制引导全部结束,dispose"),c.GuideWeakManager.startRun(),dispatchEvt(new s(s.GUIDE_END))}()}},p.listenNotification=function(n,o,a){return void 0===o&&(o=null),new Promise(function(e,t){var i=a||p._instance;tl3d.ModuleEventManager.addEvent(n,function(t){o?o(t)&&(tl3d.ModuleEventManager.removeEventByNameAndTarget(n,i),e(t)):(tl3d.ModuleEventManager.removeEventByNameAndTarget(n,i),e(t))},i)})},p.guideRequest=function(o,a){return void 0===a&&(a=0),new Promise(function(e,i){var t=p.getGuideStep();if(0==a&&o<=t)return loghgy("已完成过该强引导步骤"),void e();if(0==o&&c.GuideWeakManager.isFinishStep(a))return loghgy("已完成过该触发性引导步骤"),void e();if(0!=o&&0!=a)return logerror("不能同时完成两种引导"),void i();c.GuideMask.showWithTransparent(),0<o?loghgy("请求完成强引导步骤：",o):loghgy("请求完成触发下引导步骤：",a);var n={};n[Protocol.game_guide_getGuideAward.args.guideStep]=o,n[Protocol.game_guide_getGuideAward.args.guideWeakStep]=a,PLC.request(Protocol.game_guide_getGuideAward,n,function(t){t||i("引导响应数据为空"),t&&(t.hasOwnProperty("guideStep")&&(App.hero.tasks.guideStep=t.guideStep),t.hasOwnProperty("guideWeakStep")&&-1==App.hero.tasks.guideWeakStep.indexOf(t.guideWeakStep)&&App.hero.tasks.guideWeakStep.push(t.guideWeakStep),loghgy("确定完成强引导步骤：",o," 弱引导步骤：",a),c.GuideMask.hide(),e(t))})})},p.timeout=function(n){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];return new Promise(function(t,e){c.GuideMask.showWithTransparent();var i=setTimeout(function(){clearTimeout(i),t.apply(void 0,o)},n)})},p.talk=function(t,e,i,n,o,a,r){void 0===e&&(e=!0),void 0===i&&(i=100007),void 0===n&&(n=null),void 0===o&&(o=4),void 0===a&&(a=2),void 0===r&&(r=!1);var s={text:t,remove:e,model:i,location:a,modelScale:o,modelName:n=n&&""!=n?n:LanMgr.getLan("",12080),hidePass:r};if(UIMgr.hasStage(UIConst.GuideTalkView)){var u=UIMgr.getUIByName(UIConst.GuideTalkView);u.dataSource=s,u.initView()}else UIMgr.showUI(UIConst.GuideTalkView,s);return Promise.resolve()},p.listenDialog=function(a,r,e){return new Promise(function(n,t){var o=e||p._instance;tl3d.ModuleEventManager.addEvent(a,function(t){var e=t.data,i=e.dialogInfo?e.dialogInfo.uiname:e.name;e&&r==i&&(tl3d.ModuleEventManager.removeEventByNameAndTarget(a,o),n(t.data))},o)})},p.listenDialogs=function(a,r,e){return new Promise(function(n,t){var o=e||p._instance;tl3d.ModuleEventManager.addEvent(a,function(t){var e=t.data,i=e.dialogInfo?e.dialogInfo.uiname:e.name;e&&-1!=r.indexOf(i)&&(tl3d.ModuleEventManager.removeEventByNameAndTarget(a,o),n(t.data))},o)})},p.listenDialogGroup=function(o,a,e){return new Promise(function(i,t){var n=e||p._instance;tl3d.ModuleEventManager.addEvent(o,function(t){var e=t.data;e&&a==e.group&&(tl3d.ModuleEventManager.removeEventByNameAndTarget(o,n),i(t.data))},n)})},p.startFightGuide=function(){p.firstFightGuide()},p.firstFightGuide=function(){var t=this,e=UIMgr.getUIByName(UIConst.FirstGuide);return p.talk("<span style='color:#4a1b0c;'>"+LanMgr.getLan("",12006)+"</span>",!1,4103,LanMgr.getLan("",12007)).then(function(){return p.listenNotification(s.Guide_Talk_End)}).then(function(){return p.talk("<span style='color:#4a1b0c;'>"+LanMgr.getLan("",12008)+"</span>",!0,20012,LanMgr.getLan("",12009),2,c.LocationType.center)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return dispatchEvt(new c.FirstGuideEvent(c.FirstGuideEvent.FIRST_GUIDE_STEP_SUCC),e.scene.curVo.id),!0}).then(function(){return p.listenNotification(c.FirstGuideEvent.GUIDE_START)}).then(function(){return p.talk("<span style='color:#4a1b0c;'>"+LanMgr.getLan("",12010)+"</span>",!0,3106,LanMgr.getLan("",12011))}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return dispatchEvt(new c.FirstGuideEvent(c.FirstGuideEvent.FIRST_GUIDE_STEP_SUCC),e.scene.curVo.id),!0}).then(function(){return p.listenNotification(c.FirstGuideEvent.GUIDE_START,function(t){return!!t.data&&9==t.data})}).then(function(){return p.talk("<span style='color:#4a1b0c;'>"+LanMgr.getLan("",12012)+"</span>",!1,4103,LanMgr.getLan("",12007))}).then(function(){return p.listenNotification(s.Guide_Talk_End)}).then(function(){return p.talk("<span style='color:#4a1b0c;'>"+LanMgr.getLan("",12013)+"</span>",!0,3106,LanMgr.getLan("",12011))}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return Laya.timer.frameOnce(3,t,function(){dispatchEvt(new c.FirstGuideEvent(c.FirstGuideEvent.FIRST_GUIDE_STEP_SUCC),e.scene.curVo.id)}),p.listenNotification(c.FirstGuideEvent.GUIDE_START)}).then(function(){return p.talk("<span style='color:#4a1b0c;'>"+LanMgr.getLan("",12014)+"</span>",!1)}).then(function(){return p.listenNotification(s.Guide_Talk_End)}).then(function(){return p.talk("<span style='color:#4a1b0c;'>"+LanMgr.getLan("",12015)+"</span>",!0)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){UIMgr.showUI(UIConst.CreateRoleView,null,!1)}),{dispose:function(){}}},p.commonBattleExperienceCopy=function(t,e,i){loghgy("引导"+e+"：挑战历练副本"+i);var n=tb.TB_copy_info.get_TB_copy_infoById(i);n||logerror("不存在副本无法进行引导,副本ID：",i);var o=c.GuajiModel.getInstance();return o.isPassCopy(i)?(loghgy("兼容：已完成挑战历练副本"+i+"，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()})):(p.guideToMainView(5).then(function(){return p.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuajiView);return c.GuideMask.show(t.bottomUI.btn_onplay,c.DirectionType.top),1==n.is_enter?p.listenDialogOpened(UIConst.Lilian_RewardView).then(function(){var t=UIMgr.getUIByName(UIConst.Lilian_RewardView);return c.GuideMask.show(t.btn_receive,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightViews)}).then(function(){return p.listenNotification(c.FightsEvent.SHOW_RESULT_EVENT,function(){var t=o.isPassCopy(i);return loghgy("检测条件：副本id为"+i+"是否完成："+t),t}).then(function(){return p.guideRequest(e)}).then(function(){return UIMgr.hasStage(UIConst.FightVictory)?p.timeout(common.GlobalData.DIALOG_EFFECT_TIME):p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.FightVictory)}).then(function(){return p.timeout(100)}).then(function(){UIMgr.hideUIByName(UIConst.CommonRuleView);var t=UIMgr.getUIByName(UIConst.FightVictory);return c.GuideMask.show(t.btn_close,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.FightViews)})}):p.listenNotification(c.GuajiEvent.ENTER_FIGHT).then(function(){return c.GuideMask.showWithTransparent(),p.listenNotification(c.GuajiEvent.BATTLE_COPY_SUCCESS,function(){var t=o.isPassCopy(i);return loghgy("检测条件：副本id为"+i+"是否完成："+t),t})}).then(function(){return p.guideRequest(e)}).then(function(){return new c.ListenDialogQueueWaitStatus(!0,null).execute()})}).then(function(){UIMgr.hideUIByName(UIConst.LevelUpView),c.GuideMask.hide(),t()}),{dispose:function(){}})},p.commonGodLvup=function(t,e,i,n,o){var a=c.GodModel.getInstance().getViewGods(),r=a.findIndex(function(t){return t.godVo&&t.godVo.level<o}),s=c.TaskModel.getInstance(),u=a[r=r<0?0:r].godVo,h=u.uuid;return loghgy("引导"+e+"：主线任务id"+i+",英雄"+u.tab_god.name+"("+h+")升级到"+o+"级"),s.isFinish(i)?(loghgy("兼容：已完成主线任务,id为"+i+"，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()})):(Promise.resolve().then(function(){return!!UIMgr.hasStage(UIConst.God_MainView)||p.guideToMainView(5)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return t.roleList.selectedIndex==r||(c.GuideMask.show(t.roleList.getCell(r),c.DirectionType.top),p.listenNotification(c.GodEvent.SELECT_GOD_EVENT,function(){return App.hero.getGodVoById(h).uuid==t.curVo.uuid}))}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return t.godView.tabList.selectedIndex==ShenlingTabType.info||p.listenNotification(c.GodEvent.SWITCH_TAB_SUCCESS,function(){return t.godView.tabList.selectedIndex==ShenlingTabType.info})}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return c.GuideMask.show(t.viewInfo.btn_upGrade,c.DirectionType.bottom),p.listenNotification(c.GodEvent.USE_EXPPOOL_SUCCESS,function(){var t=App.hero.getGodVoById(h),e=s.isFinish(i);return loghgy("检测条件:英雄"+t.tab_god.name+"("+h+")升级 "+t.level+"/"+o+",主线任务id为"+i+"是否完成:"+e),t.level>=o||e})}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}})},p.commonWearEquipment=function(t,e,i,n){void 0===n&&(n=1);var o=App.hero.getGodAry(-1,-1),a=o.findIndex(function(t){return 0<t.equipKeys.length}),r=o[a=a<0?0:a],s=r.uuid,u=c.TaskModel.getInstance();return loghgy("引导"+e+"：主线任务id:"+i+",英雄"+r.tab_god.name+"("+s+")一键装备穿戴"+n+"件装备"),u.isFinish(i)?(loghgy("兼容：已完成主线任务,id为"+i+",直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()})):(p.guideToMainView(5).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.EquipView)}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return t.list_roles.selectedIndex==a||(c.GuideMask.show(t.list_roles.getCell(a),c.DirectionType.top),p.listenNotification(c.GodEvent.SELECT_GOD_EVENT,function(){return App.hero.getGodVoById(s).uuid==t.curVo.uuid}))}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return t.view_list.selectedIndex==EquipTabType.strength||p.listenNotification(c.EquipEvent.SWITCH_TAB_SUCCESS,function(){return t.view_list.selectedIndex==EquipTabType.strength})}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return c.GuideMask.show(t.viewEquip.btn_wear,c.DirectionType.bottom),p.listenNotification(c.EquipEvent.ONEKE_WEAR_SUCCESS,function(){var t=App.hero.getGodVoById(s),e=u.isFinish(i);return loghgy("检测条件:英雄"+t.tab_god.name+"("+s+")穿戴装备 "+t.equipKeys.length+"件,主线任务id"+i+"是否完成："+e),e})}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}})},p.commonStrengthEquipment=function(t,e,i,n,o,a){var r=App.hero.getGodAry(-1,-1),s=r.findIndex(function(t){return 0<t.equipKeys.length}),u=r[s=s<0?0:s],h=u.uuid;loghgy(1==n?"引导"+e+"：主线任务id:"+i+",英雄"+u.tab_god.name+"("+h+")强化装备"+o+"次":"引导"+e+"：主线任务id:"+i+",英雄"+u.tab_god.name+"("+h+")的"+o+"件装备都强化到"+a);var l=c.TaskModel.getInstance();return l.isFinish(i)?(loghgy("兼容：已完成主线任务,id为"+i+",直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()})):(Promise.resolve().then(function(){return!!UIMgr.hasStage(UIConst.EquipView)||p.guideToMainView(5).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.EquipView)})}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return t.list_roles.selectedIndex==s||(c.GuideMask.show(t.list_roles.getCell(s),c.DirectionType.top),p.listenNotification(c.GodEvent.SELECT_GOD_EVENT,function(){return App.hero.getGodVoById(h).uuid==t.curVo.uuid}))}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return t.view_list.selectedIndex==EquipTabType.strength||p.listenNotification(c.EquipEvent.SWITCH_TAB_SUCCESS,function(){return t.view_list.selectedIndex==EquipTabType.strength})}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return c.GuideMask.show(t.viewEquip.btn_strength,c.DirectionType.top),p.listenNotification(c.EquipEvent.ONEKE_STRENGTH_SUCCESS,function(){var t=App.hero.getGodVoById(h),e=l.isFinish(i);return loghgy(1==n?"检测条件:强化次数 "+t.getStrengthNum()+"/"+o+",主线任务id"+i+"是否完成:"+e:"检测条件:几件装备强化到几级 "+t.isStrengthToLv(o,a)+",主线任务id"+i+"是否完成:"+e),e})}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}})},p.zhaohuan1=function(t,e){return loghgy("引导"+e+"：召唤第一只英雄"),0<App.hero.getGodAry().length?(loghgy("兼容：已有英雄，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()})):(p.talk(LanMgr.getLan("",12016)).then(function(){return p.listenNotification(s.Guide_Talk_End,null)}).then(function(){return p.guideToMainView(0)}).then(function(){var t=UIMgr.getUIByName(UIConst.Main3DView);return c.GuideMask.show(t.btnZhaohuan,c.DirectionType.top),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.ZH_MainView)}).then(function(){return p.timeout(800)}).then(function(){return c.GuideMask.hide(),p.talk(LanMgr.getLan("",12017))}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){var t=UIMgr.getUIByName(UIConst.ZH_MainView).list_zhaohuan.getCell(2);return c.GuideMask.show(t.btn_one,c.DirectionType.top),p.listenNotification(c.SummonEvent.ZHAOHUAN_SUCCESS,function(){return 0<App.hero.getGodAry().length})}).then(function(){return p.guideRequest(e)}).then(function(){return UIMgr.hasStage(UIConst.ZH_ResultView)?p.timeout(common.GlobalData.DIALOG_EFFECT_TIME):p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.ZH_ResultView)}).then(function(){return c.GuideMask.showWithTransparent(),!!UIMgr.getUIByName(UIConst.ZH_ResultView).isCanClose()||p.listenNotification(c.SummonEvent.SHOW_BTN_VISIBLE_TRUE)}).then(function(){var t=UIMgr.getUIByName(UIConst.ZH_ResultView);return c.GuideMask.show(t.btn_sure,c.DirectionType.top),p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.ZH_ResultView)}).then(function(){var t=UIMgr.getUIByName(UIConst.SysTopView);return c.GuideMask.show(t.btnClose,c.DirectionType.top),p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.ZH_MainView)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}})},p.buzhen1=function(t,e){var i=c.GodModel.getInstance();if(loghgy("引导"+e+"：布阵第一只英雄"),1<=i.getLineupGodCount(iface.tb_prop.lineupTypeKey.attack))return loghgy("兼容：已上阵第一只英雄，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()});var n=tb.TB_god_employ_set.get_TB_god_employ_setnById(1).first_employ[0],o=tb.TB_god.get_TB_godById(n);return p.talk(LanMgr.getLan("",12018,o.name),!1).then(function(){return p.listenNotification(s.Guide_Talk_End)}).then(function(){return p.talk(LanMgr.getLan("",12019),!0,o.model,o.name)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(1)}).then(function(){return!!UIMgr.hasStage(UIConst.BuzhenView)||p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.BuzhenView)}).then(function(){var t=UIMgr.getUIByName(UIConst.BuzhenView);return c.GuideMask.show(t.list_buzhenrole.getCell(0),c.DirectionType.bottom,LanMgr.getLan("",12020),!0),p.listenNotification(c.GodEvent.BUZHEN_SELECT_ROLE,function(){return UIMgr.getUIByName(UIConst.BuzhenView).isExistLineupByIdx(0)})}).then(function(){var t=UIMgr.getUIByName(UIConst.BuzhenView);return c.GuideMask.show(t.btn_return,c.DirectionType.bottom),p.listenNotification(c.GodEvent.BUZHEN_COMPLETE,function(){return 1<=i.getLineupGodCount(iface.tb_prop.lineupTypeKey.attack)})}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.godHecheng=function(t,e){var n=c.GodModel.getInstance();if(n.isHasGod(common.GlobalData.HOUYI_GOD_ID))return loghgy("兼容：已有德古拉，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()});loghgy("引导"+e+"：英雄碎片合成英雄");var o=common.GlobalData.getHechengChipId(),i=tb.TB_god.get_TB_godById(common.GlobalData.HOUYI_GOD_ID);return p.talk(LanMgr.getLan("",12021,i.name),!0).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(4)}).then(function(){return p.timeout(100)}).then(function(){return UIMgr.getUIByName(UIConst.BagView).list_buttons.selectedIndex=c.TABTYPE.SUIPIAN,p.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.BagView),e=t.bagItemList.dataSource.findIndex(function(t){return t.some(function(t){return t.id==o})}),i=t.bagItemList.getCell(e),n=i.list_lineitem.array.findIndex(function(t){return t.id==o});return i.showDetail(i.list_lineitem.array[n]),p.timeout(100)}).then(function(){var t=UIMgr.getUIByName(UIConst.BagView),e=t.bagItemList.dataSource.findIndex(function(t){return t.some(function(t){return t.id==o})}),i=t.bagItemList.getCell(e);return c.GuideMask.show(i.ui_detail.btn_hecheng,c.DirectionType.left),p.listenNotification(c.BagEvent.USE_ITEM_SUCCESS,function(){return n.isHasGod(common.GlobalData.HOUYI_GOD_ID)})}).then(function(){return p.guideRequest(e)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.CommonRewardView)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.buzhen2=function(t,e){var i=this,n=c.GodModel.getInstance();if(loghgy("引导"+e+"：布阵第二只英雄"),2<=n.getLineupGodCount(iface.tb_prop.lineupTypeKey.attack))return loghgy("兼容：已上阵第二只英雄，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()});var o=tb.TB_god.get_TB_godById(common.GlobalData.HOUYI_GOD_ID);return p.talk(LanMgr.getLan("",12022,o.name),!1).then(function(){return p.listenNotification(s.Guide_Talk_End)}).then(function(){var t=tb.TB_god.get_TB_godById(common.GlobalData.HOUYI_GOD_ID);return p.talk(LanMgr.getLan("",12023),!0,t.model,t.name)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(1)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView).getCanShangzhenIR();return c.GuideMask.show(t,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.God_ReplaceGodView,i)}).then(function(){return c.GuideMask.showWithTransparent(),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.God_ReplaceGodView,i)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_ReplaceGodView).godList.getCell(0);return c.GuideMask.show(t.btnShangzhen,c.DirectionType.bottom),p.listenNotification(c.GodEvent.BUZHEN_COMPLETE,function(){return 2<=n.getLineupGodCount(iface.tb_prop.lineupTypeKey.attack)})}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.rewardGuajiBaoxiang=function(t,e){return loghgy("引导步骤：领取挂机宝箱奖励",e),p.talk(LanMgr.getLan("",12024)).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(5)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuajiView);return c.GuideMask.show(t.bottomUI.box_bxeff,c.DirectionType.top),p.listenNotification(c.GuajiEvent.REWARD_BAOXIANG_SUCC)}).then(function(){return p.guideRequest(e)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.Guaji_ShouyiView)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.fastFight=function(t,e){return loghgy("引导步骤：快速战斗",e),p.talk(LanMgr.getLan("",12025)).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(5)}).then(function(){return p.timeout(300)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuajiView);return c.GuideMask.show(t.bottomUI.btn_fast,c.DirectionType.top),p.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.Guaji_FastView)}).then(function(){return c.GuideMask.showWithTransparent(),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.Guaji_FastView)}).then(function(){var t=UIMgr.getUIByName(UIConst.Guaji_FastView);return c.GuideMask.show(t.btnFast,c.DirectionType.top),p.listenNotification(c.GuajiEvent.FAST_BATTLE_SUCCESS)}).then(function(){return p.guideRequest(e)}).then(function(){return new c.ListenDialogQueueWaitStatus(!0,null).execute()}).then(function(){UIMgr.hideUIByName(UIConst.LevelUpView);var t=UIMgr.getUIByName(UIConst.Guaji_FastView);return c.GuideMask.show(t.bgPanel.btnClose,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.Guaji_FastView)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.wearEquipment1=function(t,e){return loghgy("引导"+e+"：第1只英雄一键穿戴装备"),App.hero.getGodAry(-1,-1)[0].uuid,p.talk(LanMgr.getLan("",12026)).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(2)}).then(function(){return UIMgr.getUIByName(UIConst.EquipView).view_list.selectedIndex=EquipTabType.strength,p.timeout(100)}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return c.GuideMask.show(t.viewEquip.btn_wear,c.DirectionType.bottom),p.listenNotification(c.EquipEvent.ONEKE_WEAR_SUCCESS)}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.zhaohuan2=function(t,e,i,n){return loghgy("引导"+e+"：召唤第英雄"),3<=App.hero.getGodAry().length?(loghgy("兼容：已有3只英雄，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()})):(p.talk(LanMgr.getLan("",12027)).then(function(){return p.listenNotification(s.Guide_Talk_End)}).then(function(){return p.guideToMainView(5)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuajiView);return c.GuideMask.show(t.btn_uproad,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.UpRoadView)}).then(function(){return p.timeout(600)}).then(function(){var t=UIMgr.getUIByName(UIConst.UpRoadView).list_URTask.getCell(0);return c.GuideMask.show(t.btn_receive,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.ZH_MainView)}).then(function(){return p.timeout(800)}).then(function(){var t=UIMgr.getUIByName(UIConst.ZH_MainView).list_zhaohuan.getCell(2);return c.GuideMask.show(t.btn_one,c.DirectionType.top),p.listenNotification(c.SummonEvent.ZHAOHUAN_SUCCESS,function(){return 3<=App.hero.getGodAry().length})}).then(function(){return p.guideRequest(e)}).then(function(){return UIMgr.hasStage(UIConst.ZH_ResultView)?p.timeout(common.GlobalData.DIALOG_EFFECT_TIME):p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.ZH_ResultView)}).then(function(){return c.GuideMask.showWithTransparent(),!!UIMgr.getUIByName(UIConst.ZH_ResultView).isCanClose()||p.listenNotification(c.SummonEvent.SHOW_BTN_VISIBLE_TRUE)}).then(function(){var t=UIMgr.getUIByName(UIConst.ZH_ResultView);return c.GuideMask.show(t.btn_sure,c.DirectionType.top),p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.ZH_ResultView)}).then(function(){var t=UIMgr.getUIByName(UIConst.SysTopView);return c.GuideMask.show(t.btnClose,c.DirectionType.top),p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.ZH_MainView)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}})},p.buzhen3=function(t,e){var i=this;loghgy("引导"+e+"：布阵第三只英雄");var n=c.GodModel.getInstance();if(3<=n.getLineupGodCount(iface.tb_prop.lineupTypeKey.attack))return loghgy("兼容：已上阵第三只英雄，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()});var o=tb.TB_god_employ_set.get_TB_god_employ_setnById(1).second_employ[0],a=tb.TB_god.get_TB_godById(o);return p.talk(LanMgr.getLan("",12028,a.name),!1).then(function(){return p.listenNotification(s.Guide_Talk_End)}).then(function(){return p.talk(LanMgr.getLan("",12029),!0,a.model,a.name)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(1)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView).getCanShangzhenIR();return c.GuideMask.show(t,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.God_ReplaceGodView,i)}).then(function(){return c.GuideMask.showWithTransparent(),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.God_ReplaceGodView,i)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_ReplaceGodView).godList.getCell(0);return c.GuideMask.show(t.btnShangzhen,c.DirectionType.bottom),p.listenNotification(c.GodEvent.BUZHEN_COMPLETE,function(){return 3<=n.getLineupGodCount(iface.tb_prop.lineupTypeKey.attack)})}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.rewardUploadJL1=function(t,e){return loghgy("引导"+e+"：领取进阶奖励"),p.guideToMainView(5).then(function(){var t=UIMgr.getUIByName(UIConst.GuajiView);return c.GuideMask.show(t.btn_uproad,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.UpRoadView)}).then(function(){return p.timeout(600)}).then(function(){var t=UIMgr.getUIByName(UIConst.UpRoadView).list_URTask.getCell(0);return c.GuideMask.show(t.btn_receive,c.DirectionType.bottom),p.listenNotification(c.UpRoadEvent.REWARD_SUCCESS)}).then(function(){return p.guideRequest(e)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.CommonRewardView)}).then(function(){var t=UIMgr.getUIByName(UIConst.UpRoadView).list_URTask.getCell(1);return c.GuideMask.show(t.btn_receive,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.UpRoadView)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.receiveTongguanReward=function(t,e){var i=this;return loghgy("引导"+e+"：领取挂机通关奖励"),p.talk(LanMgr.getLan("",12030),!1).then(function(){return p.listenNotification(s.Guide_Talk_End)}).then(function(){return p.talk(LanMgr.getLan("",12031),!0)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(5)}).then(function(){return p.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.GuajiView);return c.GuideMask.show(t.img_baoxiang,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.Lilian_RewardView,i)}).then(function(){var t=UIMgr.getUIByName(UIConst.Lilian_RewardView);return c.GuideMask.show(t.btn_receive,c.DirectionType.bottom),p.listenNotification(c.TaskEvent.REWARD_TASK_SUCCESS)}).then(function(){return p.guideRequest(e)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.CommonRewardView)}).then(function(){var t=UIMgr.getUIByName(UIConst.Lilian_RewardView);return c.GuideMask.show(t.uiPanel.btnClose,c.DirectionType.left),p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.Lilian_RewardView)}).then(function(){UIMgr.hideUIByName(UIConst.Lilian_RewardView),c.GuideMask.hide(),t()}),{dispose:function(){}}},p.god1LvupTo=function(t,e,i,n,o){var a;1==o&&(a=LanMgr.getLan("",12005));var r=c.GodModel.getInstance().getViewGods()[i-1].godVo,s=r.uuid;return loghgy("引导"+e+"：英雄"+r.tab_god.name+"("+s+")升级到"+n),r.level>=n?(loghgy("兼容：已升级英雄"+r.tab_god.name+"("+s+")到"+n+"，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()})):(Promise.resolve().then(function(){return!a||""==a||(c.GuideMask.hide(),p.talk(a).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}))}).then(function(){return p.guideToMainView(1)}).then(function(){return p.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return c.GuideMask.show(t.viewInfo.btn_upGrade,c.DirectionType.bottom),p.listenNotification(c.GodEvent.USE_EXPPOOL_SUCCESS,function(){var t=App.hero.getGodVoById(s);return loghgy("检测条件:升级英雄"+t.tab_god.name+"("+s+") "+t.level+"/"+n),t.level>=n})}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}})},p.strengthEquipment1=function(t,e,i){var n=App.hero.getGodAry(),o=n.findIndex(function(t){return 0<t.equipKeys.length}),a=n[o=o<0?0:o],r=a.uuid,s=a.equipKeys.some(function(t){return t.strengthLv>=i});return loghgy("引导"+e+"：英雄"+a.tab_god.name+"("+a.uuid+")一键强化装备"),s?(loghgy("兼容：已强化过3次装备，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()})):(p.talk(LanMgr.getLan("",12032)).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(2)}).then(function(){return UIMgr.getUIByName(UIConst.EquipView).list_roles.selectedIndex=o,p.timeout(200)}).then(function(){return UIMgr.getUIByName(UIConst.EquipView).view_list.selectedIndex=EquipTabType.strength,p.timeout(100)}).then(function(){var t=UIMgr.getUIByName(UIConst.EquipView);return c.GuideMask.show(t.viewEquip.btn_strength,c.DirectionType.top),p.listenNotification(c.EquipEvent.ONEKE_STRENGTH_SUCCESS,function(){return App.hero.getGodVoById(r).equipKeys.some(function(t){return t.strengthLv>=i})})}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}})},p.godDgup1=function(t,e){var i=this,n=c.GodModel.getInstance().getViewGods()[0].godVo;return n.uuid,loghgy("引导"+e+"：英雄升阶"),1<=n.degree?(loghgy("兼容：英雄已升阶，直接完成该引导步骤"+e),void p.guideRequest(e).then(function(){t()})):(p.talk(LanMgr.getLan("",12033)).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideToMainView(1)}).then(function(){return p.timeout(200)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_MainView);return c.GuideMask.show(t.viewInfo.btn_shengjie,c.DirectionType.bottom),p.listenDialog(common.GlobalEvent.DIALOG_CREATED,UIConst.God_DgUpView,i)}).then(function(){return c.GuideMask.showWithTransparent(),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.God_DgUpView,i)}).then(function(){var t=UIMgr.getUIByName(UIConst.God_DgUpView);return c.GuideMask.show(t.btn_shengjie,c.DirectionType.bottom),p.listenNotification(c.GodEvent.GOD_SHENGJIE_SUCCESS)}).then(function(){return p.guideRequest(e)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.God_DgUp_SUCCView,i)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}})},p.lingquQiriJL=function(t,e){return loghgy("引导"+e+"：领取七日登录奖励"),p.guideToMainView(0).then(function(){var t=UIMgr.getUIByName(UIConst.Main3DView);return c.GuideMask.show(t.getActivityBtnIR(ModuleConst.LOGIN_QIRI),c.DirectionType.bottom),p.listenDialogOpened(UIConst.LoginGiftView)}).then(function(){var t=UIMgr.getUIByName(UIConst.LoginGiftView);return c.GuideMask.show(t.btn_receive,c.DirectionType.bottom),p.listenNotification(c.HuodongEvent.LOGIN_GIFT_RECEIVE)}).then(function(){return p.guideRequest(e)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.CommonRewardView)}).then(function(){return p.talk(LanMgr.getLan("",12034))}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.LoginGiftView)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.endGuide=function(t,e){return loghgy("引导"+e+"：总结引导"),p.guideToMainView(5).then(function(){return p.talk(LanMgr.getLan("",12035))}).then(function(){return p.listenDialog(common.GlobalEvent.DIALOG_CLOSED,UIConst.GuideTalkView)}).then(function(){return p.guideRequest(e)}).then(function(){c.GuideMask.hide(),t()}),{dispose:function(){}}},p.guideToMainView=function(o,a,r){return void 0===a&&(a=""),void 0===r&&(r=null),new Promise(function(t,e){var i=r||p._instance,n=UIMgr.getUIByName(UIConst.HudView);0!=o||UIMgr.hasStage(UIConst.Main3DView)?1!=o||UIMgr.hasStage(UIConst.God_MainView)?2!=o||UIMgr.hasStage(UIConst.EquipView)?3!=o||UIMgr.hasStage(UIConst.ArtifactView)?4!=o||UIMgr.hasStage(UIConst.BagView)?5!=o||UIMgr.hasStage(UIConst.GuajiView)?t():(c.GuideMask.show(n.btn_fight,c.DirectionType.top,a,!0),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.GuajiView,i).then(function(){return p.timeout(350)}).then(function(){dispatchEvt(new s(s.UPDATE_GUIDE_STATUS)),c.GuideMask.hide(),t()})):(c.GuideMask.show(n.btn_bag,c.DirectionType.top,a,!0),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.BagView,i).then(function(){return p.timeout(350)}).then(function(){c.GuideMask.hide(),t()})):(c.GuideMask.show(n.btn_shenqi,c.DirectionType.top,a,!0),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.ArtifactView,i).then(function(){return p.timeout(350)}).then(function(){c.GuideMask.hide(),t()})):(c.GuideMask.show(n.btn_equip,c.DirectionType.top,a,!0),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.EquipView,i).then(function(){return p.timeout(350)}).then(function(){c.GuideMask.hide(),t()})):(c.GuideMask.show(n.btn_god,c.DirectionType.top,a,!0),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.God_MainView,i).then(function(){return p.timeout(350)}).then(function(){c.GuideMask.hide(),t()})):(c.GuideMask.show(n.btn_main,c.DirectionType.top,a,!0),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,UIConst.Main3DView,i).then(function(){return p.timeout(350)}).then(function(){c.GuideMask.hide(),t()}))})},p.listenDialogOpened=function(e,i){return void 0===i&&(i=null),new Promise(function(t){return UIMgr.getInstance().getUIInfo(e).popEffect?p.listenDialog(common.GlobalEvent.DIALOG_CREATED,e,i).then(function(){return c.GuideMask.showWithTransparent(),p.listenDialog(common.GlobalEvent.DIALOG_OPENED,e,i)}).then(function(){t()}):p.listenDialog(common.GlobalEvent.DIALOG_OPENED,e,i).then(function(){t()})})},p.getGuideStep=function(){return App.hero.tasks.guideStep},p.isInGuide=function(){return p.getGuideStep()<t.endGuide},p.isExecuteGuide=function(){return p.isInGuide()||c.GuideWeakManager.isExcuting()},p.allPass=function(){tl3d.ModuleEventManager.removeEventByTarget(p._instance),p.guideRequest(t.endGuide).then(function(){c.GuideMask.hide(),UIMgr.hideUIByName(UIConst.GuideTalkView)})},p.canShowPassBtn=function(){return!(0==Number(App.hero.isNewPlayer)||!p.isInGuide()&&!c.GuideWeakManager.isExcuting())},p.passGuide=function(){if(p.isInGuide()){var e=p.getGuideStep()+1;return p.GuideList.some(function(t){return t.step==e})&&p.recordJumpGuide(e),loghgy("跳过强制引导"),tl3d.ModuleEventManager.removeEventByTarget(p._instance),void p.guideRequest(t.endGuide).then(function(){tl3d.ModuleEventManager.removeEventByTarget(p._instance),c.GuideWeakManager.startRun(),UIMgr.hideUIByName(UIConst.GuideTalkView),c.GuideMask.hide(),dispatchEvt(new s(s.GUIDE_END))})}-1==c.GuideWeakManager.curExcutingGuideStep||c.GuideWeakManager.passCurGuide()},p.recordJumpGuide=function(t){if(!(t<=0)){loghgy("记录跳过引导步骤:",t);var e={};e[Protocol.game_guide_jumpGuide.args.guideStep]=t,PLC.request(Protocol.game_guide_jumpGuide,e,function(t){})}},p._instance=new p,p.GuideList=[{step:t.zhaohuan1,args:[],execute:p.zhaohuan1},{step:t.buzhen1,args:[],execute:p.buzhen1},{step:t.battleExperienceCopy1,args:[common.GlobalData.GUAJI_COPY_1_1],execute:p.commonBattleExperienceCopy},{step:t.godHeCheng,args:[],execute:p.godHecheng},{step:t.buzhen2,args:[],execute:p.buzhen2},{step:t.battleExperienceCopy2,args:[common.GlobalData.GUAJI_COPY_1_2],execute:p.commonBattleExperienceCopy},{step:t.rewardGuajiBaoxiang,args:[],execute:p.rewardGuajiBaoxiang},{step:t.fastFight,args:[],execute:p.fastFight},{step:t.god1LvupTo5,args:[1,5,1],execute:p.god1LvupTo},{step:t.battleExperienceCopy3,args:[common.GlobalData.GUAJI_COPY_1_3],execute:p.commonBattleExperienceCopy},{step:t.wearEquipment1,args:[],execute:p.wearEquipment1},{step:t.battleExperienceCopy4,args:[common.GlobalData.GUAJI_COPY_1_4],execute:p.commonBattleExperienceCopy},{step:t.zhaohuan2,args:[],execute:p.zhaohuan2},{step:t.buzhen3,args:[],execute:p.buzhen3},{step:t.rewardUploadJL1,args:[],execute:p.rewardUploadJL1},{step:t.battleExperienceCopy5,args:[common.GlobalData.GUAJI_COPY_1_5],execute:p.commonBattleExperienceCopy},{step:t.receiveTongguanReward,args:[],execute:p.receiveTongguanReward},{step:t.god1LvupTo10,args:[1,10],execute:p.god1LvupTo},{step:t.battleExperienceCopy6,args:[common.GlobalData.GUAJI_COPY_1_6],execute:p.commonBattleExperienceCopy},{step:t.strengthEquipmentLv1,args:[3],execute:p.strengthEquipment1},{step:t.battleExperienceCopy7,args:[common.GlobalData.GUAJI_COPY_1_7],execute:p.commonBattleExperienceCopy},{step:t.god1LvupTo20,args:[1,20],execute:p.god1LvupTo},{step:t.god1Dgup,args:[],execute:p.godDgup1},{step:t.lingquQiriJL,args:[],execute:p.lingquQiriJL},{step:t.endGuide,execute:p.endGuide}],p._isInit=!1,p);function p(){}c.GuideManager=o}(game=game||{}),function(o){var t=(e.prototype.updateGuaqiaState=function(t){if(this.guankaMap.hasOwnProperty(t)){var e=this.guankaMap[t];this.updateState(e)}},e.prototype.updateNextGuaqiaState=function(t){if(this.guankaMap.hasOwnProperty(t)){var e=this.guankaMap[t].tbCopyInfo.next;if(this.guankaMap.hasOwnProperty(e)){var i=this.guankaMap[e];return this.updateState(i),-1}return e}},e.prototype.updateState=function(t){t.updateState(),t.isPass&&(!this.maxGuanka||this.maxGuanka.tbCopyInfo.ID<t.tbCopyInfo.ID)&&(this.maxGuanka=t)},e.prototype.finish=function(){for(var t in this.guankaMap)if(this.guankaMap.hasOwnProperty(t)&&!this.guankaMap[t].isPass)return!1;return!0},e.prototype.isNew=function(){var t=!1;for(var e in this.guankaMap)if(this.guankaMap.hasOwnProperty(e)){var i=this.guankaMap[e];if(i.isPass)return!1;i.isNext()&&(t=!0)}return t&&1e3!=this.tbCopy.ID},e.prototype.getOpenLev=function(){for(var t in this.guankaMap)if(this.guankaMap.hasOwnProperty(t)){var e=this.guankaMap[t];if(1==e.tbCopyInfo.area_number)return e.needLev()}return 0},e.prototype.isOpen=function(){for(var t in this.guankaMap)if(this.guankaMap.hasOwnProperty(t)){var e=this.guankaMap[t];if(e.isPass)return!0;if(e.isNext()&&e.levPass())return!0}return!1},e.prototype.getGuanqiaById=function(t){return this.guankaMap.hasOwnProperty(t)?this.guankaMap[t]:null},e.prototype.getNext=function(){for(var t in this.guankaMap)if(this.guankaMap.hasOwnProperty(t)){var e=this.guankaMap[t];if(e.isNext())return e}return null},e.prototype.getMaxPassVo=function(){var t=null;for(var e in this.guankaMap)if(this.guankaMap.hasOwnProperty(e)){var i=this.guankaMap[e];if(!t&&i.isPass){t=i;continue}if(!t&&i.isNext()){t=i;continue}i.isPass&&t.tbCopyInfo.ID<i.tbCopyInfo.ID&&(t=i)}return t},e.prototype.getCurGuanqia=function(){return this.finish()?this.maxGuanka:this.getNext()},e.prototype.getCurPassGuanqia=function(){var t;if(this.maxGuanka)t=this.maxGuanka;else{var e=Object.keys(this.guankaMap);t=this.guankaMap[e[0]]}return t},e);function e(t){this.maxGuanka=null,this.tbCopy=t,this.id=t.ID,this.guankaMap=[];for(var e=tb.TB_copy_info.get_TB_copy_info("area",t.ID.toString()),i=0;i<e.length;i++){var n=new o.GuaJiGuanqiaVo;n.index=i+1,n.chapterId=t.ID,n.chapter=t.chapter,n.tbCopyInfo=e[i],n.difflev=t.sub_type,this.guankaMap[n.tbCopyInfo.ID]=n,this.updateGuaqiaState(n.tbCopyInfo.ID)}}o.ZhangjieVo=t}(game=game||{}),function(e){var t=(i.prototype.isboss=function(){return!(!this.tbCopyInfo||!this.tbCopyInfo.boss_icon)},i.prototype.updateState=function(){if(!this.isPass)if(App.hero.runeCopyInfo.hasOwnProperty(this.chapter)){var t=Number(App.hero.runeCopyInfo[this.chapter]);this.isPass=t>=this.tbCopyInfo.ID,dispatchEvt(new e.GuajiEvent(e.GuajiEvent.RED_CHANGE))}else this.isPass=!1},i.prototype.isNext=function(){var t=this.preId();return!(0!=t||!isEmptyObject(App.hero.runeCopyInfo))||this._model.getMaxLev()==t},i.prototype.preId=function(){for(var t=0;this.tbCopyInfo.precondition&&t<this.tbCopyInfo.precondition.length;t++){var e=this.tbCopyInfo.precondition[t];if(e[0]==CopyConditionType.id)return e[1]}return 0},i.prototype.levPass=function(){return this.needLev()<=App.hero.level},i.prototype.needLev=function(){for(var t=0;this.tbCopyInfo.precondition&&t<this.tbCopyInfo.precondition.length;t++){var e=this.tbCopyInfo.precondition[t];if(e[0]==CopyConditionType.level)return e[1]}return 0},i.prototype.hasNotReceive=function(){return-1==App.hero.mapBoxAwardIds.indexOf(this.tbCopyInfo.ID)},i);function i(){this._model=e.GuajiModel.getInstance()}e.GuaJiGuanqiaVo=t}(game=game||{}),function(t){var e=(i.prototype.getFirstSkill=function(){for(var t in this.skillMap)if(1==tb.TB_skill.get_TB_skillById(Number(t)).type)return this.skillMap[t];return null},i.prototype.deleteBuff=function(t){var e=this.buffAry.indexOf(t);-1!=e&&this.buffAry.splice(e,1)},i.prototype.deathFun=function(){for(this._deathtickflag=!1;0<this.delayList.length;){var t=this.delayList.shift();this.scene.onPlay(t.step,t.skillId)}this.deadIng=!1,this.scene.removeStep("dead"+this.objId)},i.prototype.deathTimeOut=function(){this._model.isFight&&this.char&&this.hpr<=0&&this.char.visible&&this.setCharVisable(!1)},Object.defineProperty(i.prototype,"hpr",{get:function(){return this._hpr},set:function(t){if(this._hpr=t,this.char){if(t<=0){if(t=0,!this.char.visible)return;if(clearTimeout(this._deathTick1),clearTimeout(this._deathTick2),this.char.play(tl3d.CharAction.DEATH,1,!1),this._deathtickflag){var e=this.getresultTime(frame2time(this.tab.death_frame));return this._deathTick1=setTimeout(this.deathFun.bind(this),e),void(this._deathTick2=setTimeout(this.deathTimeOut.bind(this),e))}this.deadIng=!0,this.scene.tagStep("dead"+this.objId),this.scene&&this.scene.roleDeathClearBuff(this.objId);var i=this.getresultTime(frame2time(this.tab.death_frame));this._deathTick1=setTimeout(this.deathFun.bind(this),i),this._deathTick2=setTimeout(this.deathTimeOut.bind(this),i),this._deathtickflag=!0}else tl3d.TimeUtil.hasTimeOut(this.deathTimeOut.bind(this))&&tl3d.TimeUtil.removeTimeOut(this.deathTimeOut.bind(this)),tl3d.TimeUtil.hasTimeOut(this.deathFun.bind(this))&&tl3d.TimeUtil.removeTimeOut(this.deathFun.bind(this)),this.char.visible?this.char.curentAction==tl3d.CharAction.DEATH&&this.char.play(tl3d.CharAction.STANAD,2,!1):(this.setCharVisable(!0),this.char.play(tl3d.CharAction.STANAD,2,!1));var n=0;0<t&&(n=t<5?5:t),this.char.lifenumExt=n,logfight("角色：",this.objId,this.tab.name,"当前血量：",this._hp,"百分比:",t)}},enumerable:!0,configurable:!0}),i.prototype.setCharVisable=function(t){this.char&&(this.char.alpha=1,this.char.visible=t,this.char.bloodEnableExt=!1,this.char.buffEnable=!1,this.char.roleLevEnable=!1,t&&this.isFight&&(this.char.bloodEnableExt=t,this.char.setbloodColor(this.team==battle.BatteConsts.BATTLE_CAMPATK),this.char.buffEnable=t,this.char.roleLevEnable=t,this.char.setBloodExtOffsetX(10),this.char.setBloodExtOffsetY(-18),this.char.setLevOffsetY(-18),this.char.setBuffOffsetY(18),this.char.setroleLev(this.lev,this.tab.race_type)))},Object.defineProperty(i.prototype,"hp",{get:function(){return this._hp},set:function(t){this._hp=t,this._hp=Math.min(this._hp,this.hpMax),this._hp=Math.max(this._hp,0);var e=Math.ceil(this._hp/this.hpMax*100);e!=this.hpr&&(this.hpr=e)},enumerable:!0,configurable:!0}),i.prototype.showJumpText=function(t){this.flyTextList||(this.flyTextList=new Array,this.flying=!1),this.flyTextList.push(t),this.flying||this.startShow()},i.prototype.startShow=function(){if(this.flyTextList&&0<this.flyTextList.length){this.flying=!0;var t=this.flyTextList.shift();this.JumpPiecewiseOpt(t,tl3d.TimeUtil.getTimer(tl3d.TimeUtil.START_TIME)),Laya.timer.once(100,this,this.startShow)}else this.flying=!1},i.prototype.JumpPiecewiseOpt=function(t,e){void 0===t.skillid||t.type!=tl3d.TextJumpType.N_NORMALDAMAGE&&t.type!=tl3d.TextJumpType.N_CRIT&&t.type!=tl3d.TextJumpType.N_UPHP?this.playJumpText(t.value,t.type,e):this.onPiecewise(t,e)},i.prototype.onPiecewise=function(n,t){var o=this,e=tb.TB_skill.get_TB_skillById(n.skillid);if(0<e.effect){var a=tb.TB_skill_effect.get_TB_skill_effectById(e.effect),r=a.damage_section&&a.damage_section.length==a.frame.length-1,s=a.frame.length-1;if(2<a.frame.length){function i(){var t=0;if(r){var e=perc2num(a.damage_section[d-1]);t=d==s?c-l:e*c}else t=d==s?c-l:(u=utils.random(90,110)/100,c/s*u);t=Math.floor(t),l+=t;var i=frame2time(a.frame[d]-h);if(!p._model.isEnable)return p.hp+=t,logfight("不在前台分段同步血量：",t),1;setTimeout(function(){o.hp+=t,logfight("分段同步血量：",t),o.playJumpText(t,n.type,tl3d.TimeUtil.getTimer(tl3d.TimeUtil.START_TIME))},p.getresultTime(i))}for(var u,h=a.frame[1],l=0,c=n.value,p=this,d=1;d<a.frame.length;d++)i()}else this.playJumpText(n.value,n.type,t)}else this.playJumpText(n.value,n.type,t)},i.prototype.getresultTime=function(t){return t/(this.scene.uiScene.timespeed1+1)},i.prototype.playJumpText=function(t,e,i){if(this._model.isEnable&&this.char){var n=new tl3d.TextJumpUiVo;n.pos=new tl3d.Vector3D(this.char.px,30,this.char.pz),n.type=Number(e),n.str=String(t),n.type!=tl3d.TextJumpType.N_PASSIVE&&n.type!=tl3d.TextJumpType.N_UPHP||(n.str="+"+n.str),n.starttime=i,n.endtime=i+900,this.scene.uiScene.scene.bloodMgr.setJumpNum(n),this.playInjured(e)}},i.prototype.playInjured=function(t){t!=tl3d.TextJumpType.N_NORMALDAMAGE&&t!=tl3d.TextJumpType.N_CRIT||this.char&&this.scene&&this.scene.uiScene&&(this.beatWitheFilter(),this.scene.uiScene.addEffect(this,1029,new tl3d.Vector3D(this.char.px,this.char.py+50,this.char.pz),2,30,null,0,0,!0),this.char.curentAction!=tl3d.CharAction.STANAD&&this.char.play(tl3d.CharAction.STANAD,2,!1),0<this.hpr?this.char.play(tl3d.CharAction.INJURED,2,!1):this.char.play(tl3d.CharAction.DEATH,1,!1))},i.prototype.beatWitheFilter=function(){var t=this;clearTimeout(this._tickw),this.char.changeColor=[100,10,10,.7],this._tickw=setTimeout(function(){t.char.changeColor=[1,1,1,t.char.alpha]},150)},i.prototype.beatRedFilter=function(){var t=this;clearTimeout(this._tickr),this.char.changeColor=[100,0,0,.7],this._tickr=setTimeout(function(){t.char.changeColor=[1,1,1,t.char.alpha]},150)},i.prototype.onDispose=function(){clearTimeout(this._tickw),clearTimeout(this._tickr),this.buffAry=[],this.char.buffary=[],this.char.destory(),this.char=null},Object.defineProperty(i.prototype,"guajihp",{get:function(){return this._guajihp},set:function(t){this.char&&(0<t&&(this.dealthComplete=!1,this.char.visible||(this.setCharVisable(!0),this.char.curentAction==tl3d.CharAction.DEATH&&this.char.play(tl3d.CharAction.STANAD,2,!1))),this._guajihp=t)},enumerable:!0,configurable:!0}),i.prototype.setHp=function(t,e){this.char&&(this.team==battle.BatteConsts.BATTLE_CAMPDEF&&(this.guajihp-=t,this.guajihp<0&&(this.guajihp=0)),this.char.play(this.guajihp<=0?tl3d.CharAction.DEATH:tl3d.CharAction.INJURED,this.guajihp<=0?1:2,!1),this.guajihp<=0&&Laya.Tween.to(this.char,{alpha:.3},500),e&&e(new tl3d.Vector3D(this.char.px,this.char.py+50,this.char.pz)),this.guajihp<=0&&this.onDie())},i.prototype.clearGuajiTick=function(){clearTimeout(this.dietick)},i.prototype.onDie=function(){var t=this;clearTimeout(this.dietick),this.dietick=setTimeout(function(){t.setCharVisable(!1)},1500),this.dealthComplete=!0,this.onDead&&this.onDead.call(null,[this.uuid,this.skinId])},i.prototype.setAnger=function(t){this.char&&this.char.setAnger(t)},i);function i(){this._guajihp=0,this.guajiMaxHp=0,this._hp=0,this.movesucc=!1,this._deathtickflag=!1,this.deadIng=!1,this.delayList=[],this._model=t.GuajiModel.getInstance()}t.GuajiCharVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.guaji.WorldMapUI,__extends(i,e),i.prototype.mouseDown=function(t){this._model.isInMapGuide()||(this.moveFlag=!1,this.downX=this.mLastMouseX=this.bg.mouseX,this.downY=this.mLastMouseY=this.bg.mouseY,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove))},i.prototype.mouseMove=function(t){var e=this.bg.mouseX-this.mLastMouseX;this.bg.x+=e;var i=this.img_viewport.scrollRect.width;if(this.bg.x<i-this.bg.width&&(this.bg.x=i-this.bg.width),0<this.bg.x&&(this.bg.x=0),!this.moveFlag){var n=Math.abs(this.downX-this.bg.mouseX),o=Math.abs(this.downY-this.bg.mouseY);this.moveFlag=3<n||3<o,this.stopAni(this.ani_move)}},i.prototype.mouseUp=function(){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.mouseMove)},i.prototype.moveMap=function(t){a.GuideMask.showWithTransparent();var e=this.img_viewport.scrollRect,i=e.width,n=this._curCenter[0];(n=-(n-i/2))<e.width-this.bg.width&&(n=e.width-this.bg.width),0<n&&(n=0),Laya.Tween.to(this.bg,{x:n},500,null,Handler.create(this,function(){t?t():a.GuideMask.hide()}))},i.prototype.setBtnGary=function(){this.btn_lev0.gray=Number(this.btn_lev0.name)>this._maxLv,this.btn_lev1.gray=Number(this.btn_lev1.name)>this._maxLv,this.btn_lev2.gray=Number(this.btn_lev2.name)>this._maxLv},i.prototype.onSelectLev=function(t){var e=Number(t.target.name);e>this._maxLv?showToast(LanMgr.getLan("",10085)):(this._curlev=e,this.refreshData(),this.showtip())},i.prototype.setLev=function(){this.btn_select.x=1==this._curlev?10:2==this._curlev?118:225},i.prototype.popup=function(){e.prototype.popup.call(this),isNaN(this.bg.x)&&(this.bg.x=0),this.bg.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.bg.on(Laya.Event.MOUSE_UP,this,this.mouseUp),this.bg.on(Laya.Event.MOUSE_OUT,this,this.mouseUp),this.ani_suo.visible=!1,this._zjlist=this._model.zhangjieList,this._curlev=this._model.currentZhangjie.tbCopy.sub_type,this.getMaxLvOpt(),this.refreshData(),this.setBtnGary(),this.showtip()},i.prototype.showtip=function(){var t=this,e=this._model.newOpen;if(this.aniArrow.visible=!1,0!=e){var i=this.getZjVoById(e);if(i.tbCopy.sub_type==this._curlev){var n=this["box"+(i.tbCopy.chapter-1)];this._curCenter=[n.x,n.y],this.moveMap(function(){t.ani_suo.visible=!0,t.ani_suo.x=n.x,t.ani_suo.y=n.y,t.ani_suo.play(0,!1),setTimeout(function(){t.ani_suo.visible=!1,a.GuideWeakManager.isExcuting()||(t.aniArrow.visible=!0),t.aniArrow.x=n.x+t.bg.x,t.aniArrow.y=n.y,t.aniArrow.rotation=180,a.GuideMask.hide()},1e3)})}else{a.GuideWeakManager.isExcuting()||(this.aniArrow.visible=!0);var o=this["btn_lev"+(i.tbCopy.sub_type-1)];this.aniArrow.x=o.x,this.aniArrow.y=o.y,this.aniArrow.rotation=0,this.moveMap()}this.aniArrow.play()}else this.aniArrow.stop(),this.moveMap(),this.ani_move.visible||this.moveAni||(this.moveAni=!0,this.ani_move.visible=!0,this.ani_move.play())},i.prototype.getZjVoById=function(t){for(var e=0;e<this._zjlist.length;e++)if(this._zjlist[e].id==t)return this._zjlist[e];return null},i.prototype.getMaxLvOpt=function(){for(var t=0;t<this._zjlist.length;){var e=this._zjlist[t];if(!e.isOpen())break;t+=tb.TB_copy_set.getCopySet().max_chapter,this._maxLv=e.tbCopy.sub_type}},i.prototype.onClick=function(t){var e=this;if(this._model.isFight)showToast(LanMgr.getLan("",10391));else{var i=t.target.dataSource,n=this["img_chapter"+(i.tbCopy.chapter-1)];AudioMgr.playSound(),Laya.Tween.to(n,{scaleX:1.2,scaleY:1.2},120,null,Laya.Handler.create(this,function(){Laya.Tween.to(n,{scaleX:1,scaleY:1},120,null,Laya.Handler.create(e,function(){if(n.gray)showToast(n.dataSource.info);else if(App.hero.copyUnlockId<i.id){var t={};t[Protocol.game_copy_copyUnlock.args.id]=i.id,PLC.request(Protocol.game_copy_copyUnlock,t,function(t){t&&(App.hero.copyUnlockId=t.copyUnlockId,e._model.newOpen=0,e.onClickBtn(i,!0))})}else e.onClickBtn(i)}))}))}},i.prototype.onClickBtn=function(t,e){void 0===e&&(e=!1),e&&this._model.currentZhangjie.id!=t.id?(this._model.currentZhangjie=t,dispatchEvt(new a.GuajiEvent(a.GuajiEvent.UPDATE_ZHANGJIE_EVENT)),UIMgr.showUI(UIConst.OpenChapterView,{type:a.OpenChapterView.TYPE_GUAJI,isnew:!0,infovo:t})):UIMgr.showUI(UIConst.GuanQiaNewView,t),this.close()},i.prototype.stopAni=function(t){t&&t.visible&&(t.gotoAndStop(0),t.visible=!1)},i.prototype.refreshData=function(){this.stopAni(this.ani_fight),this.setLev();for(var t=0;t<this._zjlist.length;t++){var e=this._zjlist[t],i=e.tbCopy;if(i.sub_type==this._curlev){var n=i.chapter-1;i.sub_type,i.chapter,this["img_chapter"+n].dataSource=i;var o=t%10;this["box_chapter"+o].dataSource=e,this["lab_chapter"+o].text=i.name;var a=e.isOpen();if(this["img_chapter"+o].gray=!a,this["img_chapter"+o].dataSource={info:LanMgr.getLan("",11003)},this["lab_open"+o].visible=!1,!a&&e.isNew()){var r=e.getOpenLev();0!=r&&r>App.hero.level&&(this["lab_open"+o].visible=!0,this["lab_open"+o].text=r+"级开启",this["img_chapter"+o].dataSource={info:r+"级开启"})}e.id==this._model.currentZhangjie.id&&(this.ani_fight.visible=!0,this.ani_fight.x=this["box"+o].x,this.ani_fight.y=this["box"+o].y,this.ani_fight.play(0,!0),this._curCenter=[this.ani_fight.x,this.ani_fight.y])}}},i.prototype.close=function(){e.prototype.close.call(this,"",!1),this.bg.off(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.bg.off(Laya.Event.MOUSE_UP,this,this.mouseUp),this.bg.off(Laya.Event.MOUSE_OUT,this,this.mouseUp),Laya.Tween.clearAll(this.bg),a.GuideMask.hide(),this.stopAni(this.ani_move)},i);function i(){var t=e.call(this)||this;return t._maxLv=1,t.moveAni=!1,t._curCenter=[1e3,1e3],t.isModelClose=!0,t.box_chapter0.on(Laya.Event.CLICK,t,t.onClick),t.box_chapter1.on(Laya.Event.CLICK,t,t.onClick),t.box_chapter2.on(Laya.Event.CLICK,t,t.onClick),t.box_chapter3.on(Laya.Event.CLICK,t,t.onClick),t.box_chapter4.on(Laya.Event.CLICK,t,t.onClick),t.box_chapter5.on(Laya.Event.CLICK,t,t.onClick),t.box_chapter6.on(Laya.Event.CLICK,t,t.onClick),t.box_chapter7.on(Laya.Event.CLICK,t,t.onClick),t.box_chapter8.on(Laya.Event.CLICK,t,t.onClick),t.box_chapter9.on(Laya.Event.CLICK,t,t.onClick),t.btn_lev0.on(Laya.Event.CLICK,t,t.onSelectLev),t.btn_lev1.on(Laya.Event.CLICK,t,t.onSelectLev),t.btn_lev2.on(Laya.Event.CLICK,t,t.onSelectLev),t.btn_close.on(Laya.Event.CLICK,t,t.close),t.img_viewport.scrollRect=new laya.maths.Rectangle(0,0,600,1006),t._model=a.GuajiModel.getInstance(),t}a.WorldMapView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guaji.SysOpenUI,__extends(n,e),n.prototype.setGuideView=function(t){var e=tb.TB_sys_open.get_TB_sys_openById(t);this.imgIcon.skin=e?SkinUtil.getSysOpenSkin(e.ID):null},n.prototype.setGuideStatus=function(t){var e=this;t?(this.stage.on(Laya.Event.CLICK,this,this.onConfirm),Laya.timer.once(1500,this,function(){e.stage.off(Laya.Event.CLICK,e,e.onConfirm),Laya.timer.clearAll(e),e.onConfirm()})):(this.stage.off(Laya.Event.CLICK,this,this.onConfirm),Laya.timer.clearAll(this))},n.prototype.onConfirm=function(){dispatchEvt(new t.GuajiEvent(t.GuajiEvent.CONFIRM_SYS_OPEN_BUTTON))},n);function n(){return e.call(this)||this}t.GuaJiSysOpenView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.guaji.ShouYiXiangQingUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this)},n.prototype.initView=function(){var t=this.dataSource;this.lab_exp.text=t.role_exp_speed+"/分钟",this.lab_gold.text=t.gold_speed+"/分钟",this.lab_hunshi.text=t.exp_speed+"/分钟",this.lab_name.text=t.name,this.list_reward.dataSource=t.getRewardShowItems()},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.ShouYiXiangQingView,closeOnSide:t.isModelClose,title:"奖励详情"},t}t.ShouYiXiangQingView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(d){var i,t=(i=ui.guaji.ShouyiUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,!1),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,!1),this.initView()},e.prototype.initView=function(){var t=this.dataSource;if(t){this.bgPanel.dataSource={title:"comp/title/guajishouyi.png"};var e=d.GuajiModel.getInstance().getMaxLev(),i=tb.TB_copy_info.get_TB_copy_infoById(e);this.lbExp.text=i?"+"+i.role_exp_speed+"/m":"+0/m",this.lbGold.text=i?"+"+i.gold_speed+"/m":"+0/m",this.lbHunshi.text=i?"+"+i.exp_speed+"/m":"+0/m";var n=[];if(t.data.commonData.addBagItems){var o=t.data.commonData.addBagItems;for(var a in o){var r=o[a],s=Number(a);n.push(new ItemVo(s,r))}}if(t.data.commonData.addResource){var u=t.data.commonData.addResource;for(var a in u)r=u[a],s=Number(a),n.push(new ItemVo(s,r))}if(t.data.commonData.addEquips){var h=t.data.commonData.addEquips,l={};for(var a in h)l[s=Number(h[a].templateId)]=l[s]?l[s]+1:1;for(var a in l)n.push(new ItemVo(parseInt(a),l[a]))}var c=App.getServerTime()-t.lastTime,p=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.offlineIncomeTime);c=Math.min(p,c),this.lab_time.text=tl3d.TimeUtil.getDiffTime2(c),this.list_reward.array=n}},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.list_reward.array=null},e);function e(){var t=i.call(this)||this;return t.mouseEnabled=!0,t.isModelClose=!0,t.list_reward.array=null,t}d.ShouyiView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.guaji.ShouyiUpUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.anchorX=this.anchorY=.5,this.visible=!1,this.itemList.renderHandler=new Handler(this,this.itemRender)},e.prototype.onOpened=function(){n.prototype.onOpened.call(this);var t=i.GuajiModel.getInstance();t.lastCopyId=t.getMaxLev(),this.visible=!1;var e=this.dataSource;this.itemList.array=e,this.itemList.height=36*e.length+(e.length-1)*this.itemList.spaceY,this.listBg.height=this.itemList.height+20,this.height=this.bgPanel.height=this.listBg.y+this.listBg.height+50,this.x=Laya.stage.width>>1,this.y=Laya.stage.height>>1,this.visible=!0,this.alpha=1,Laya.timer.once(1500,this,this.startTween)},e.prototype.startTween=function(){var t=this;Laya.Tween.clearTween(this),Laya.Tween.to(this,{alpha:0,y:this.y-300},500,null,Handler.create(this,function(){t.close()}))},e.prototype.itemRender=function(t,e){var i=t.dataSource,n=t.getChildByName("imgRes"),o=t.getChildByName("lbLast"),a=(t.getChildByName("imgArrow"),t.getChildByName("lbCur"));i&&(n.skin=SkinUtil.getCostSkin(i.type),o.text=i.last+"/m",a.text=i.cur+"/m")},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.visible=!1,this.itemList.array=null,Laya.Tween.clearTween(this),Laya.timer.clearAll(this)},e);function e(){var t=n.call(this)||this;return t.mouseEnabled=!1,t.isModelClose=!1,t.bgPanel.dataSource={uiName:UIConst.Guaji_ShouyiUpView,closeOnSide:t.isModelClose,closeOnButton:!1,title:"收益提升"},t.bgPanel.addChildAt(t.listBg,3),t}i.ShouyiUpView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.guaji.OpenChapterViewUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,!1,!1),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,!1,!1),this.initView()},n.prototype.close=function(){i.prototype.close.call(this,null,!1,!1)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.ani_hide.gotoAndStop(0),this.ani_show.gotoAndStop(0),this.ani_guang.gotoAndStop(0),Laya.timer.clearAll(this),this._zhangjievo=null},n.prototype.initView=function(){switch(this.ani_show.on(Laya.Event.COMPLETE,this,this.onAniShowComplete),this.ani_hide.on(Laya.Event.COMPLETE,this,this.onAniHideComplete),this._type=this.dataSource.type,this._type){case n.TYPE_GUAJI:this._isOpenNew=this.dataSource.isnew,this._zhangjievo=this.dataSource.infovo,this.lab_name.text=this._zhangjievo.tbCopy.name,this.lab_title.text=this._isOpenNew?"开启新章节":"挂机";break;case n.TYPE_SHILIANTA:this._isOpenNew=!0,this.lab_name.text="下一层",this.lab_title.text=""}this.isModal=this._isOpenNew,this.ani_hide.gotoAndStop(0),this.ani_hide.visible=!1,this.ani_show.play(0,!1),this.ani_show.visible=!0,this.ani2.gotoAndStop(0),this.ani1.play(0,!1),this.ani_guang.play(0,!0)},n.prototype.onAniShowComplete=function(){var t=this;Laya.timer.once(1e3,this,function(){t.ani_show.visible=!1,t.ani_hide.visible=!0,t.ani_hide.play(0,!1),t.ani2.play(0,!1)})},n.prototype.onAniHideComplete=function(){this.close()},n.TYPE_GUAJI=0,n.TYPE_SHILIANTA=1,n);function n(){var t=i.call(this)||this;return t._type=0,t.isModelClose=!1,t}t.OpenChapterView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var n,t=(n=ui.guaji.GuanQiaNewUI,__extends(i,n),i.prototype.popup=function(){n.prototype.popup.call(this),this.img_bg.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.img_bg.on(Laya.Event.MOUSE_UP,this,this.mouseUp),this.img_bg.on(Laya.Event.MOUSE_OUT,this,this.mouseUp);for(var t=0;t<this._uiGuanQiaList.length;t++)this._uiGuanQiaList[t].on(Laya.Event.CLICK,this,this.onClickGuanQia,[t]);this.btn_close.on(Laya.Event.CLICK,this,this.close),this.img_worldmap.on(Laya.Event.CLICK,this,this.onClickWorldMap),tl3d.ModuleEventManager.addEvent(e.GuajiEvent.UPDATE_FUWEN_COPY_INFO,this.onGuanQiaChange,this),this.onZhangJieChange(),this.onGuanQiaChange()},i.prototype.onZhangJieChange=function(){for(var t in this._curZhangJieVo=this.dataSource,this._curGuanQiaPos=i.GUANQIA_POS_INFO[this._curZhangJieVo.tbCopy.chapter-1],this._allGuanQiaVo=[],this._curZhangJieVo.guankaMap){var e=this._curZhangJieVo.guankaMap[t];this._allGuanQiaVo[e.index-1]=e}this.updateZhangJie()},i.prototype.onGuanQiaChange=function(){this._curGuanQiaVo=this._curZhangJieVo.getCurGuanqia(),this.updateGuanQia();var t=this._curGuanQiaVo.index-1,e=this._curGuanQiaPos[2*t];this.scrollMap(-51-e)},i.prototype.updateZhangJie=function(){if(this._curZhangJieVo){this.img_guanqia.skin=LanMgr.getLan("guaji/sjdt/{0}.jpg",-1,this._curZhangJieVo.tbCopy.chapter);var t=this._curZhangJieVo.tbCopy.sub_type,e=1==t?"普通":2==t?"困难":"地狱";this.lab_title.text=LanMgr.getLan("{0}({1})",-1,this._curZhangJieVo.tbCopy.name,e),this.img_title.width=this.lab_title.width+70;for(var i=0;i<this._uiGuanQiaList.length;i++){var n=this._uiGuanQiaList[i];i<this._allGuanQiaVo.length?(n.visible=!0,n.dataSource=this._allGuanQiaVo[i],n.x=this._curGuanQiaPos[2*i],n.y=this._curGuanQiaPos[2*i+1]):(n.visible=!1,n.dataSource=null)}}},i.prototype.updateGuanQia=function(){for(var t=!1,e=0;e<this._allGuanQiaVo.length;e++){var i=this._uiGuanQiaList[e];if(i){var n=this._allGuanQiaVo[e];n.updateState(),n.isPass||n.isNext()?i.setSelect(!0):i.setSelect(!1),this._curGuanQiaVo.isPass||n.index!=this._curGuanQiaVo.index||(t=!0,this.ani_select.x=i.x+28,this.ani_select.y=i.y-20)}}t?(this.ani_select.visible=!0,this.ani_select.play()):(this.ani_select.visible=!1,this.ani_select.stop())},i.prototype.scrollMap=function(t){t<this._leftRange&&(t=this._leftRange),t>this._rightRange&&(t=this._rightRange),this.img_bg.x!=t&&(this.img_bg.x=t)},i.prototype.onClickGuanQia=function(t){this._allGuanQiaVo&&this._allGuanQiaVo[t]&&UIMgr.showUI(UIConst.GuanQiaInfoView,this._allGuanQiaVo[t])},i.prototype.onClickWorldMap=function(){UIMgr.showUI(UIConst.WordMap),this.close()},i.prototype.mouseDown=function(t){this.downX=this.mLastMouseX=this.img_bg.mouseX,this.downY=this.mLastMouseY=this.img_bg.mouseY,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove)},i.prototype.mouseMove=function(t){var e=this.img_bg.mouseX-this.mLastMouseX;this.scrollMap(this.img_bg.x+e)},i.prototype.mouseUp=function(){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.mouseMove)},i.prototype.close=function(){n.prototype.close.call(this,"",!1),this.img_bg.off(Laya.Event.MOUSE_DOWN,this,this.mouseDown),this.img_bg.off(Laya.Event.MOUSE_UP,this,this.mouseUp),this.img_bg.off(Laya.Event.MOUSE_OUT,this,this.mouseUp);for(var t=0;t<this._uiGuanQiaList.length;t++)this._uiGuanQiaList[t].off(Laya.Event.CLICK,this,this.onClickGuanQia);this.btn_close.off(Laya.Event.CLICK,this,this.close),this.img_worldmap.off(Laya.Event.CLICK,this,this.onClickWorldMap),tl3d.ModuleEventManager.removeEvent(e.GuajiEvent.UPDATE_FUWEN_COPY_INFO,this.onGuanQiaChange,this),this._curZhangJieVo=null,this._curGuanQiaVo=null,this._curGuanQiaPos=null,this._allGuanQiaVo=null},i.GUANQIA_POS_INFO=[[209,158,152,258,83,376,292,373,519,374,696,459,740,362,638,167,808,207,824,96],[178,155,213,332,189,425,423,409,648,512,766,432,649,341,417,255,681,193,534,122],[612,172,415,90,254,162,118,259,239,290,454,236,419,367,253,412,545,425,750,377],[168,147,269,226,189,332,314,414,400,364,554,459,715,393,682,280,506,239,456,116],[135,93,169,187,248,358,427,300,596,325,756,458,714,223,580,189,372,214,495,138],[198,310,337,343,308,460,446,494,461,400,578,373,738,379,608,271,482,294,442,208],[229,319,270,423,470,401,617,442,833,411,781,273,686,127,547,151,432,196,314,119],[252,444,705,488,828,298,694,113,503,123,224,85,127,173,272,311,604,251,420,338],[105,220,168,326,386,462,648,487,566,387,728,348,672,259,519,213,285,241,492,111],[548,483,434,417,266,382,397,332,596,366,704,271,556,196,358,225,233,194,439,70]],i);function i(){var t=n.call(this)||this;t._leftRange=0,t._rightRange=0,t.isModelClose=!0,t.img_viewport.scrollRect=new laya.maths.Rectangle(0,0,600,1006);var e=t.img_viewport.scrollRect.width-t.img_guanqia.width;0<e?(t._leftRange=-321,t._rightRange=t._leftRange+e):(t._rightRange=-321,t._leftRange=t._rightRange+e),t._uiGuanQiaList=[];for(var i=0;i<10;i++)t._uiGuanQiaList[i]=t["ui_level_"+i];return t}e.GuanQiaNewView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.guaji.GuanQiaNewIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;t&&10==t.tbCopyInfo.area_number?this.img_boss.visible=!0:this.img_boss.visible=!1},n.prototype.setSelect=function(t,e){void 0===e&&(e=!1),this._isSelect==t&&!e||(this._isSelect=t,this.img_icon.skin=t?"comp/image/gq_zuobiao2.png":"comp/image/gq_zuobiao.png",this.img_boss.gray=!t)},n);function n(){var t=e.call(this)||this;return t._isSelect=!1,t.setSelect(!1,!0),t}t.GuanQiaNewIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.guaji.GuanQiaInfoUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this),this.btn_guaji.on(Laya.Event.CLICK,this,this.onClickBtn),this._curGuanQiaVo=this.dataSource,this.bgPanel.dataSource={uiName:UIConst.GuanQiaInfoView,closeOnSide:this.isModelClose,title:this._curGuanQiaVo.tbCopyInfo.name},this.updateInfo()},n.prototype.updateInfo=function(){if(this._curGuanQiaVo){var t=this._curGuanQiaVo.tbCopyInfo.getMonsters();this.list_enemy.array=t,this.list_enemy.repeatX=t.length,this.list_enemy.x=(this.width-this.list_enemy.width)/2;var e=this._curGuanQiaVo.tbCopyInfo.getRewardShowItems();5<(this.list_reward.array=e).length?this.list_reward.width=552:this.list_reward.width=102*e.length-12,this.list_reward.x=(this.width-this.list_reward.width)/2,this._curGuanQiaVo.isPass||this._curGuanQiaVo.isNext()?(this.btn_guaji.gray=!1,this.btn_guaji.label="挂机"):(this.btn_guaji.gray=!0,this.btn_guaji.label="未通关")}},n.prototype.onClickBtn=function(){if(this._curGuanQiaVo.isPass||this._curGuanQiaVo.isNext()){var t=i.GuajiModel.getInstance(),e=t.getZhangjie(this._curGuanQiaVo.chapterId);t.currentZhangjie=e,UIMgr.showUI(UIConst.GuajiView),dispatchEvt(new i.GuajiEvent(i.GuajiEvent.UPDATE_ZHANGJIE_EVENT)),UIMgr.hideUIByName(UIConst.GuanQiaNewView),UIMgr.showUI(UIConst.OpenChapterView,{type:i.OpenChapterView.TYPE_GUAJI,isnew:!1,infovo:e}),this.close()}},n.prototype.close=function(){e.prototype.close.call(this,"",!1),this.btn_guaji.off(Laya.Event.CLICK,this,this.onClickBtn),this.bgPanel.dataSource=null,this.list_enemy.array=null,this.list_reward.array=null,this._curGuanQiaVo=null},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t}i.GuanQiaInfoView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var i,e=Laya.Event,t=(i=ui.guaji.GuajiUI,__extends(o,i),o.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._model=u.GuajiModel.getInstance(),this.roadMap=new Laya.Box,this.roadMap.x=0,this.addChildAt(this.roadMap,0);var t=Laya.stage.width;this.roadMap.scrollRect=new laya.maths.Rectangle(0,0,t,635),this.tile=new Laya.Image,this.tile2=new Laya.Image,this.tile.autoSize=!0,this.tile2.autoSize=!0,this.tile.width=720,this.tile2.width=720,this.tile2.x=720,this.roadMap.addChild(this.tile),this.roadMap.addChild(this.tile2),this.roadMap.width=1440,this.roadMap.height=this.roadMap.scrollRect.height,this.isLoad=!1,this.guajiScene=new u.GuajiScene,this.addChildAt(this.img_startbg,2),this.img_startbg.size(Laya.stage.width,Laya.stage.height).pos(0,0),this.addChildAt(this.guajiScene,3),this.addChildAt(this.guajiScene.uiScene,4),this.btn_task.on(e.CLICK,this,this.onTask),this.img_baoxiang.on(e.CLICK,this,this.onReward),this.bgMap=new Laya.Box,this.bgMap.x=0,this.bgMap.y=60,this.addChildAt(this.bgMap,0),this.bgMap.scrollRect=new laya.maths.Rectangle(0,0,t,900),this.bgtile=new Laya.Image,this.bgtile2=new Laya.Image,this.bgtile.autoSize=!0,this.bgtile2.autoSize=!0,this.bgtile.width=1020,this.bgtile2.width=1020,this.bgtile2.x=1020,this.bgMap.addChild(this.bgtile),this.bgMap.addChild(this.bgtile2),this.bgMap.width=2040,this.bgMap.height=this.bgMap.scrollRect.height,this.on(e.MOUSE_WHEEL,this,this.onMouseWheel),this.bottomUI.btn_onplay.on(e.CLICK,this,this.onFight),this.bottomUI.btn_fast.on(e.CLICK,this,this.onFast),this.btn_map.on(e.CLICK,this,this.onClickMap),this.bottomUI.btn_adventure.on(e.CLICK,this,this.onAdventure),this.btn_lilian.on(e.CLICK,this,this.onClickFunction,[tb.TB_function.TYPE_LILIAN]),this.btn_maoxian.on(e.CLICK,this,this.onClickFunction,[tb.TB_function.TYPE_MAOXIAN]),this.btn_jingji.on(e.CLICK,this,this.onClickFunction,[tb.TB_function.TYPE_JINGJI]),this.btn_kf.on(e.CLICK,this,this.onClickFunction,[tb.TB_function.TYPE_KUAFU])},o.prototype.setSize=function(t,e){i.prototype.setSize.call(this,t,e),this.ani_bosstips.x=t/2,this.ani_bosstips.y=e-177,this.bottomUI.y=e-130,this.roadMap.y=e-70-this.roadMap.scrollRect.height,this.box_top.y=GameUtil.isFullScreen()?125+u.HudModel.TOP_ADD_HEIGHT:125,this.box_right.y=GameUtil.isFullScreen()?73+u.HudModel.TOP_ADD_HEIGHT:73,o.OffY=.5*(this.roadMap.y-361),this.guajiScene&&this.guajiScene.uiScene.setPos(Launch.offsetX,Launch.offsetY+o.OffY),this.bottomUI&&this.bottomUI.setScenePos(),this.fightTitle&&(this.fightTitle.x=t/2-this.fightTitle.width/2)},o.prototype.changeStartBg=function(t){this.img_startbg.visible=t},o.prototype.onFight=function(){if(this._model.isFight)showToast(LanMgr.getLan("",10389));else{var t=null;if(this._model.currentZhangjie.finish()){if(0==this._model.currentZhangjie.maxGuanka.tbCopyInfo.next)return void this.onClickMap();var e=this._model.getGuanqiaById(this._model.currentZhangjie.maxGuanka.tbCopyInfo.next);return(t=copymodule.CopyUtils.copyOpen(e.tbCopyInfo.precondition,this._model.getMaxLev()))&&t.isopen?void this.onClickMap():void showToast(t.info)}var i=this._model.currentZhangjie.getNext();if((t=copymodule.CopyUtils.copyOpen(i.tbCopyInfo.precondition,this._model.getMaxLev()))&&t.isopen){if(App.getServerTime()<App.hero.lastProgressTime)return void showToast(LanMgr.getLan("",10390,App.hero.lastProgressTime-App.getServerTime()));this.battleBoss(),this.closeBossTips()}else showToast(t.info)}},o.prototype.battleBoss=function(){var r=this;if(!UIUtil.checkUnableToEnterFight()){var s=this.getGuanKa();if(s&&s.isPass)logerror("数据异常",s);else if(1==s.tbCopyInfo.is_enter)dispatchEvt(new u.GuajiEvent(u.GuajiEvent.SHOW_JINAGLI_PANEL),s.tbCopyInfo.ID);else{var t={};t[Protocol.game_copy_clgCopy.args.copyId]=s.tbCopyInfo.ID,PLC.request(Protocol.game_copy_clgCopy,t,function(t,e){r.clearArtifact();var i=new u.FightVo;i.copyType=iface.tb_prop.copyTypeKey.rune,i.tab_copyinfo=s.tbCopyInfo,i.tab_copy=tb.TB_copy.get_TB_copyById(i.tab_copyinfo.area);var n=new battle.BattleScenePve(i.copyType);n.init([i.getOwnTeam()],i.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.monster,i.getAllRound(),i.getTeamHp()),n.start();var o=n.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",o,"战报：",n.battleReport);var a=new u.NewClientPage;a.result=o?playState.VICTORY:playState.FAILURE,a.initPage(n.battleReport),a.defType=iface.tb_prop.battleObjTypeKey.monster,i.fightPageControl=a,i.fightPageControl.getPreloadIds(),dispatchEvt(new u.GuajiEvent(u.GuajiEvent.ENTER_FIGHT),i),r.clearAllRewardEff(),r.guajiScene.enterFightScene(i,function(){}),r._fightvo=i,r.fightTitle.setVsVis(!1),r.setRound(-1),r._model.isFight=!0,r.changeBtnState()})}}},o.prototype.refreshTitle=function(){this._fightvo&&(this.fightTitle.dataSource=this._fightvo.getHeadData(),this.fightTitle.setData(),this.fightTitle.showEff())},o.prototype.onMouseWheel=function(t){u.FightView.chkCam},o.prototype.setBossData=function(){this.updateMap(),this.setShouyi()},o.prototype.onGuanqia=function(){UIMgr.showUI(UIConst.GuanqiaView,this.getGuanKa())},o.prototype.onTask=function(t){dispatchEvt(new u.TaskEvent(u.TaskEvent.SHOW_TASK_VIEW))},o.prototype.onShouchong=function(t){dispatchEvt(new u.TopUpEvent(u.TopUpEvent.SHOW_SHOUCHONG_PANEL))},o.prototype.updateShouchongTishi=function(){if(!this._model.isFight&&!(App.hero.level<7||u.GuideManager.isInGuide()||this.ui_tishi&&this.ui_tishi.parent)){var t=u.ChongzhiModel.getInstance();t.hasShouChongTip()&&(t.lastCloseTime?1800<App.serverTimeSecond-t.lastCloseTime&&Laya.timer.once(3e3,this,this.showShouchongTishi):Laya.timer.once(3e3,this,this.showShouchongTishi))}},o.prototype.hideShouchongTishi=function(){this.ui_tishi&&this.ui_tishi.removeSelf(),Laya.timer.clear(this,this.showShouchongTishi)},o.prototype.showShouchongTishi=function(){var t=u.ChongzhiModel.getInstance().getCurData();this.ui_tishi||(this.ui_tishi=new u.ShouchongtishiView,this.ui_tishi.pos(80,950)),this.ui_tishi.dataSource=t.tb.ID,this.addChild(this.ui_tishi),this.ui_tishi.updateModulePos()},o.prototype.onOpened=function(){var t=this;i.prototype.onOpened.call(this),this.guajiScene.sceneEabled=!0,this._model.isEnable=!0,this.isLoad=!1,this.btn_uproad.show(),this._model.isFight||(this._model.inited?this.moveToTargetGuan(this.getGuanKa(),!1,!1):(this.resetTick(),this.initZhangjie(!1))),this.showtip(),this.updateShouchongTishi(),LoadeQueue.getInstance().addQueueExcute(Laya.Handler.create(this.bottomUI,this.bottomUI.onEnter)),tl3d.ModuleEventManager.addEvent(u.GuajiEvent.FUBEN_REWARD_CHANGE,this.updateFuBenReward,this),tl3d.ModuleEventManager.addEvent(u.GuajiEvent.UPDATE_FUWEN_COPY_INFO,this.setEff,this),this.clearAllRewardEff(),this.setBossData(),this.updateFuBenReward(),this.delayShowBossTips(),dispatchEvt(new u.GuajiEvent(u.GuajiEvent.SHOW_SHOUYI_UP_VIEW));var e=this.height-this.bottomUI.height-130;UIUtil.boxUpDownTween(this.bottomUI,e+this.bottomUI.height,e,!0,310,.1,function(){t.changeBtnState()}),u.ChatThread.getInstance().startAutoRequest(iface.tb_prop.chatChannelTypeKey.all),this.updateWanfaBtnState()},o.prototype.initArtifact=function(t,e,i){this._fightvo&&(t==this._fightvo.getCamp()?(this._artiface1||(this._artiface1=new u.ArtifactRender,this._artiface1.x=158,this._artiface1.y=373,this._artiface1.scale(.7,.7),this.addChildAt(this._artiface1,this._childs.length-2)),this._artiface1.initArtifact(e,i)):(this._artiface2||(this._artiface2=new u.ArtifactRender,this._artiface2.right=158,this._artiface2.y=373,this._artiface2.scale(.7,.7),this.addChildAt(this._artiface2,this._childs.length-2)),this._artiface2.initArtifact(e,i)))},o.prototype.updateWanfaBtnState=function(){var t=GameUtil.getMinOpenLv(tb.TB_function.getSysids(tb.TB_function.TYPE_LILIAN));this.lbOpenLL.visible=App.hero.level<t,this.lbOpenLL.text=t+"级开启",t=GameUtil.getMinOpenLv(tb.TB_function.getSysids(tb.TB_function.TYPE_MAOXIAN)),this.lbOpenMX.visible=App.hero.level<t,this.lbOpenMX.text=t+"级开启",t=GameUtil.getMinOpenLv(tb.TB_function.getSysids(tb.TB_function.TYPE_JINGJI)),this.lbOpenJJ.visible=App.hero.level<t,this.lbOpenJJ.text=t+"级开启",t=GameUtil.getMinOpenLv(tb.TB_function.getSysids(tb.TB_function.TYPE_KUAFU)),this.lbOpenKF.visible=App.hero.level<t,this.lbOpenKF.text=t+"级开启"},o.prototype.setAnger=function(t,e){this._fightvo&&(t==this._fightvo.getCamp()?this._artiface1.setAnger(e):this._artiface2.setAnger(e))},o.prototype.clearArtifact=function(){this._artiface1&&this._artiface1.clearArtifact(),this._artiface2&&this._artiface2.clearArtifact()},o.prototype.setShouyi=function(){},o.prototype.setFightHead=function(t){this.fightTitle.visible=t,this.btn_uproad.visible=!t,this.box_right.visible=!t,t||this.fightTitle.hide()},o.prototype.setRound=function(t){if(this._fightvo){var e=this._fightvo.getAllRound();this.fightTitle&&this.fightTitle.setRound("回合 "+(-1==t?0:t)+"/"+e)}},o.prototype.changeBtnState=function(){this.setFightHead(this._model.isFight),Laya.timer.clear(this,this.changeBtnState);var t=this.bottomUI;if(t.lab_info.visible=t.img_timeicon.visible=!1,t.stopBattleEff(),this._model.isFight)t.btn_onplay.skin=SkinUtil.guajiBtn(u.GuajiBtnState.FIGHTING);else{var e=this._fightvo=null;if(this._model.currentZhangjie.finish()){if(0==this._model.currentZhangjie.maxGuanka.tbCopyInfo.next)return void(t.btn_onplay.skin=SkinUtil.guajiBtn(u.GuajiBtnState.MAP));var i=this._model.getGuanqiaById(this._model.currentZhangjie.maxGuanka.tbCopyInfo.next);(e=copymodule.CopyUtils.copyOpen(i.tbCopyInfo.precondition,this._model.getMaxLev()))&&e.isopen?t.btn_onplay.skin=SkinUtil.guajiBtn(u.GuajiBtnState.MAP):(t.lab_info.visible=!0,t.lab_info.text=e.info,t.lab_info.x=105,t.btn_onplay.skin=SkinUtil.guajiBtn(u.GuajiBtnState.OPEN))}else{var n=this._model.currentZhangjie.getNext();if(n=n||this._model.currentZhangjie.getMaxPassVo(),(e=copymodule.CopyUtils.copyOpen(n.tbCopyInfo.precondition,this._model.getMaxLev()))&&e.isopen)if(App.getServerTime()<App.hero.lastProgressTime)t.btn_onplay.skin=SkinUtil.guajiBtn(u.GuajiBtnState.TIME),t.img_timeicon.visible=t.lab_info.visible=!0,t.lab_info.x=115,t.lab_info.text=StringToTime(App.hero.lastProgressTime-App.getServerTime()),Laya.timer.once(1e3,this,this.changeBtnState);else{var o=0==n.tbCopyInfo.boss_icon;t.btn_onplay.skin=SkinUtil.guajiBtn(o?u.GuajiBtnState.JINGYING:u.GuajiBtnState.CANBOSS),t.playBattleEff()}else t.lab_info.visible=!0,t.lab_info.text=e.info,t.lab_info.x=105,t.btn_onplay.skin=SkinUtil.guajiBtn(u.GuajiBtnState.OPEN)}}},o.prototype.loopMove=function(){this._model.moveState&&(this.roadMap.scrollRect.x+=this._moveSpeed,720<=this.roadMap.scrollRect.x&&(this.roadMap.scrollRect.x=0),this.bgMap.scrollRect.x+=this._bgMoveSpeed,1020<=this.bgMap.scrollRect.x&&(this.bgMap.scrollRect.x=0))},o.prototype.playerRewardEff=function(t){var e=this;if(this.guajiScene.sceneEabled){var i={6:4,1:5};5<=(o.KILL_MONSTER_NUM+=1)&&(o.KILL_MONSTER_NUM-=5,i[999999]=1);var n=a.getDropItemEffPool();n.dropCb=function(){e.bottomUI.bxOpenJTEff(),n.playAniEnd(e.bottomUI,e.bottomUI.x+e.bottomUI.box_bxeff.x,e.bottomUI.y+e.bottomUI.box_bxeff.y)},n.init(i,t.x+20,t.y),this.addChild(n),this._dropItemEff.push(n)}},o.prototype.clearAllRewardEff=function(){for(var t=0;t<this._dropItemEff.length;t++)a.toDropItemEffPool(this._dropItemEff[t]);this._dropItemEff.length=0,this._hasDropItem=!1},o.prototype.delayShowBossTips=function(){this.closeBossTips(),App.hero.level<=10&&!u.GuideManager.isExecuteGuide()&&Laya.timer.once(5e3,this,this.showBossTips)},o.prototype.showBossTips=function(){this._model.isFight||(this.ani_bosstips.play(),this.ani_bosstips.visible=!0,Laya.timer.clear(this,this.showBossTips))},o.prototype.closeBossTips=function(){this.ani_bosstips.stop(),this.ani_bosstips.visible=!1,Laya.timer.clear(this,this.closeBossTips),Laya.timer.clear(this,this.showBossTips)},o.prototype.onClosed=function(){i.prototype.onClosed.call(this),u.ChatThread.getInstance().stopRequest(),Laya.timer.clear(this,this.changeBtnState),this.closeBossTips(),this.boxEffStop(),this.playerTalkHide(),this.clearTimer(this,this.playerTalkHide),Laya.Tween.clearAll(this),this.clearAllRewardEff(),this.aniArrow.stop(),this.bottomUI.onExit(),this.guajiScene.sceneEabled=!1,this._model.isEnable=!1,this.sceneExit(),UIMgr.hideUIByName(UIConst.ChatView),this.btn_uproad.close(),tl3d.ModuleEventManager.removeEvent(u.GuajiEvent.FUBEN_REWARD_CHANGE,this.updateFuBenReward,this),tl3d.ModuleEventManager.removeEvent(u.GuajiEvent.UPDATE_FUWEN_COPY_INFO,this.setEff,this),this._curFuBenRewardT=null},o.prototype.sceneExit=function(){this.guajiScene&&this.guajiScene.onExit()},o.prototype.onClickMap=function(){var t=this._model;if(t.currentZhangjie.finish()){var e=t.getNextZj();e&&!t.isUnlockCapter(e.id)?UIMgr.showUI(UIConst.WordMap):UIMgr.showUI(UIConst.GuanQiaNewView,t.currentZhangjie)}else UIMgr.showUI(UIConst.GuanQiaNewView,t.currentZhangjie)},o.prototype.onAdventure=function(t){dispatchEvt(new u.HudEvent(u.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.ADVENTURE])},o.prototype.showtip=function(){u.GuideManager.isInGuide()||u.GuideWeakManager.isExcuting()?this.aniArrow.visible=!1:this._model.newOpen==this._model.currentZhangjie.id&&(this._model.newOpen=0),this.aniArrow.visible?this.aniArrow.play():this.aniArrow.stop()},o.prototype.resetTick=function(){this.onGuajiLoop(),Laya.timer.frameLoop(1,this,this.onGuajiLoop)},o.prototype.stopTick=function(){Laya.timer.clear(this,this.onGuajiLoop)},o.prototype.onGuajiLoop=function(){this.guajiScene&&this.guajiScene.updataTick(),this.loopMove()},o.prototype.initZhangjie=function(t){this.createGuanqia(this._model.currentZhangjie,t)},o.prototype.moveToTargetGuan=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this._model.isFight||(this.guajiScene.clearGuajiAll(),this.guajiScene.createGods(),this.guajiScene.nextGuanqia(t),this.isLoad=!0,AudioMgr.playMusic(),dispatchEvt(new u.GuajiEvent(u.GuajiEvent.MOVE_TO_TARGET_GK)))},o.prototype.createGuanqia=function(t,e){this.setBossData();var i=this.getGuanKa();null!=i&&(this.lbl_title.text=t.tbCopy.name,this.img_map.skin=this.getMapBlockSkin(t.tbCopy.chapter),this.guajiScene.uiScene&&this.initScene(t,i,e))},o.prototype.updateMap=function(){var t=this._model.currentZhangjie.getCurPassGuanqia();if(null!=t){var e=tb.TB_copy.get_TB_copyById(t.tbCopyInfo.area);if(this.lab_mapstatus.text=this.getMapBlockLevelDesc(e.sub_type)+" "+t.chapter+"-"+t.tbCopyInfo.area_number,this.lab_sceneInfo.visible){var i=tb.TB_monster.get_TB_monsterById(t.tbCopyInfo.checkpoint_icon);this.lab_sceneInfo.text=t.tbCopyInfo.scene_desc+"  "+LanMgr.getLan(t.tbCopyInfo.monster_desc,-1,i.name,i.level)}}else this.lab_sceneInfo.visible=!1},o.prototype.getMapBlockSkin=function(t){return t<10?"guaji/sjdt/sjdt_0"+t+".png":"guaji/sjdt/sjdt_"+t+".png"},o.prototype.getMapBlockLevelDesc=function(t){switch(t){case 1:return"普通";case 2:return"困难";case 3:return"地狱";default:return"普通"}},o.prototype.initScene=function(t,e,i){this.guajiScene.initScene(),this.moveToTargetGuan(e,!1,i),this.bgtile.skin=this.bgtile2.skin=SkinUtil.getSysMapSkin(ModuleConst.FIGHT,0,t.tbCopy.background_id),this.tile.skin=this.tile2.skin=SkinUtil.getSysMapSkin(ModuleConst.FIGHT,1,t.tbCopy.road_id),this._model.inited=!0},o.prototype.onClickFunction=function(t){for(var e=App.hero.level,i=!0,n=[tb.TB_function.TYPE_MAOXIAN,tb.TB_function.TYPE_LILIAN,tb.TB_function.TYPE_JINGJI,tb.TB_function.TYPE_KUAFU],o=0;o<n.length;o++)if(n[o]==t&&e<GameUtil.getMinOpenLv(tb.TB_function.getSysids(t))){i=!1;break}i?dispatchEvt(new u.HudEvent(u.HudEvent.SHOW_ENTRANCE_VIEW,t)):showToast(LanMgr.getLan("",10229))},o.prototype.isBtnOpen=function(t,e){void 0===e&&(e=!1);var i=tb.TB_sys_open.get_TB_sys_openById(t);return!(!i||App.IsSysOpen(t)||(e&&showToast(i.prompt),0))},o.prototype.updateFuBenReward=function(){var t=TableData.getInstance().getTableByName(TableData.tb_checkpoint_pass).data;for(var e in this._curFuBenRewardT=null,t){var i=t[e].ID;if(-1==App.hero.mapBoxAwardIds.indexOf(i)){this._curFuBenRewardT=t[e];break}}this.setEff()},o.prototype.setEff=function(){if(this.boxEffStop(),this.box_boss.visible&&this._curFuBenRewardT&&-1==App.hero.mapBoxAwardIds.indexOf(this._curFuBenRewardT.ID)){var t=tb.TB_copy_info.get_TB_copy_infoById(this._curFuBenRewardT.para);App.hero.isPassRuneCopyInfo(t.ID,t.getChapter())&&this.boxEffPlay()}},o.prototype.boxEffPlay=function(){var t=this;this.ani_baoxiang.visible=!0,this.ani_baoxiang.loadAnimation(ResConst.anim_baoxiang,Handler.create(null,function(){t.ani_baoxiang.play(0,!0)}),ResConst.atlas_baoxiang),Laya.Tween.to(this.img_baoxiang,{rotation:-20},150,null,Laya.Handler.create(this,function(){Laya.Tween.to(t.img_baoxiang,{rotation:20},300,null,Laya.Handler.create(t,function(){Laya.Tween.to(t.img_baoxiang,{rotation:0},150,null,Laya.Handler.create(t,function(){t.setEff()}))}))}))},o.prototype.boxEffStop=function(){this.ani_baoxiang.gotoAndStop(0),this.ani_baoxiang.visible=!1,Laya.Tween.clearAll(this.img_baoxiang),this.img_baoxiang.rotation=0},o.prototype.onFast=function(t){dispatchEvt(new u.GuajiEvent(u.GuajiEvent.SHOW_FAST_BATTLE))},o.prototype.onReward=function(){dispatchEvt(new u.GuajiEvent(u.GuajiEvent.SHOW_JINAGLI_PANEL),null)},o.prototype.playerTalkShow=function(t){this.box_talk.visible=!0,this.lab_talk.text=t.str,this.box_talk.height=this.lab_talk.height+20,this.box_talk.x=t.pos.x+Launch.offsetX,this.box_talk.y=t.pos.y+Launch.offsetY-120,this.timerOnce(1500,this,this.playerTalkHide)},o.prototype.playerTalkHide=function(){this.box_talk.visible=!1},o.prototype.getGuanKa=function(){return this._model.currentZhangjie.finish()?this._model.currentZhangjie.maxGuanka:this._model.currentZhangjie.getNext()},o.prototype.playSkillName=function(t,e,i){this._skillBox||(this._skillBox=new u.playSkillRender,this.addChild(this._skillBox)),this._skillBox.x=i==battle.BatteConsts.BATTLE_CAMPATK?20:Laya.stage.width-476,this._skillBox.bottom=i==battle.BatteConsts.BATTLE_CAMPATK?550:600,this._skillBox.setData(i,e,t)},o.KILL_MONSTER_NUM=0,o);function o(){var t=i.call(this)||this;return t._num=0,t._maxNum=4,t._hasDropItem=!1,t._moveSpeed=2.5,t._bgMoveSpeed=.6,t._dropItemEff=[],t.group=UIConst.hud_group,t.fightTitle||(t.fightTitle=new u.FightHeadRender,t.fightTitle.x=0,t.fightTitle.y=270,t.fightTitle.setScale(.9),t.addChildAt(t.fightTitle,t._childs.length-1)),t}u.GuajiView=t;var n,a=(n=Laya.View,__extends(r,n),r.prototype.init=function(t,e,i,n){void 0===n&&(n=40),this._itemsData=t,this.x=e,i>=Laya.stage.height-380&&(i=Laya.stage.height-380),this.y=i,this.initItem(),this.dropEff()},r.prototype.initItem=function(){if(!(this._itemImgArr&&0<this._itemImgArr.length))for(var t in this._itemImgArr=[],this._itemsData)for(var e=this._itemsData[t],i=0;i<e;i++)this.addItemImg(parseInt(t))},r.prototype.addItemImg=function(t){var e=new Laya.Animation;e.source=this.getItemIcon(t),e.visible=!0,this.addChild(e),this._itemImgArr.push(e)},r.prototype.getItemIcon=function(t){return 1==t?"eff/GuajiCoin.ani":6==t?"eff/GuajIHunEff.ani":999999==t?"eff/GuajiBoxEff.ani":""},r.prototype.dropEff=function(){for(var t=this,e=0;e<this._itemImgArr.length;e++){var i=this._itemImgArr[e];i.visible=!0;var n=80*Math.random(),o=30*Math.random();i.x=n,i.y=o,i.scale(this._initScale,this._initScale),i.play(0,!1)}var a=1e3+100*(this._itemImgArr.length-1);Laya.timer.once(a,this,function(){t.dropCb&&t.dropCb()})},r.prototype.playAniEnd=function(i,t,e){if(this._itemImgArr){function n(t){r=200+200*t;var e=s._itemImgArr[t];e.stop(),BezierTween.clear(e),BezierTween.to(e,500,[{x:e.x,y:e.y},{x:o,y:a}],{scaleX:.7,scaleY:.7},null,new Handler(s,function(){e.visible=!1,i.bxOpenDTEff()}))}for(var o=t-this.x-135,a=e-this.y-20,r=0,s=this,u=0;u<this._itemImgArr.length;u++)n(u);Laya.timer.once(r+700,this,this.onIntoBXComplete)}},r.prototype.onIntoBXComplete=function(){r.toDropItemEffPool(this)},r.prototype.clear=function(){Laya.timer.clearAll(this)},r.getBlackImgPool=function(){var t;return 0<this._IMG_BLACK_POOL.length?t=this._IMG_BLACK_POOL.shift():((t=new Laya.Image).anchorX=.5,t.anchorY=.5),t.alpha=1,t.scaleX=1,t.scaleY=1,t},r.toBlackImgPool=function(t){t&&(Laya.Tween.clearAll(t),t.removeSelf(),this._IMG_BLACK_POOL.push(t))},r.getImgPool=function(){var t;return 0<this._IMG_POOL.length?t=this._IMG_POOL.shift():((t=new Laya.Image).anchorX=.5,t.anchorY=.5),t.alpha=0,t.scaleX=1,t.scaleY=1,t},r.toImgPool=function(t){t&&(Laya.Tween.clearAll(t),t.removeSelf(),this._IMG_POOL.push(t))},r.getDropItemEffPool=function(){return 0<this._DROP_ITEM_EFF.length?this._DROP_ITEM_EFF.shift():new r},r.toDropItemEffPool=function(t){t&&(t.clear(),t.removeSelf(),this._DROP_ITEM_EFF.push(t))},r._IMG_BLACK_POOL=[],r._IMG_POOL=[],r._DROP_ITEM_EFF=[],r);function r(){var t=n.call(this)||this;return t._initScale=.8,t}u.EffectDropItem=a}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fight.shengliUI,__extends(n,e),n.prototype.timeTick=function(){this.time--,this.time<=0&&this.close(),this.lab_time.text=String(this.time)},n.prototype.popup=function(){e.prototype.popup.call(this,!1,!1),this.bgPanel.showTitle(!0,"zhandoubiaoxian/shengli.png",!0,!0,!0,Handler.create(this,this.showTitleComplete),this),this.lbDesc.visible=this.chk_next.visible=this.btn_again.visible=!1;var t=this.dataSource.vo;t&&t.commonData&&UIUtil.getRewardItemVoList(this.ary,t.commonData),t&&t.firstData&&UIUtil.getRewardItemVoList(this.ary,t.firstData,!0),this.listVo._dataSource=this.list_item.array=this.ary,this.list_item.AutoLayout(this.width),this.listVo.setHeight(200),this.listVo.setPosition(this.list_item.x+(Laya.stage.width-this.width)/2,(Laya.stage.height-this.height)/2+this.list_item.y),this.listVo._height=this.list_item.height,this.time=6,this.lab_empty.visible=this.ary.length<=0,this.box_title.visible=!this.lab_empty.visible,this.btn_close.x=282},n.prototype.showTitleComplete=function(){this._efflist=common.EffectList.showEffectList(this.listVo),this._tickFun(),Laya.timer.loop(1e3,this,this._tickFun),AudioMgr.playSound("sound/victory.mp3")},n.prototype.onOpened=function(){e.prototype.onOpened.call(this)},n.prototype.close=function(){e.prototype.close.call(this),this.bgPanel.closeTitle(),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),this.list_item.array=null,this.listVo._dataSource&&(this.listVo._dataSource.length=0),Laya.timer.clear(this,this._tickFun)},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),UIMgr.hasStage(UIConst.GuajiView)&&UIMgr.getUIByName(UIConst.GuajiView).delayShowBossTips()},n);function n(){var t=e.call(this)||this;return t.ary=new Array,t.isModelClose=!0,t.btn_close.on(Laya.Event.CLICK,t,t.close),t.list_item.array=[],t.listVo=new ListVo(t.list_item),t.listVo.setPosition(t.list_item.x+Launch.offsetX,500+Launch.offsetY),t._tickFun=function(){t.timeTick()},t}t.guajiVictory=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var e,t=(e=Laya.Sprite,__extends(i,e),i.prototype.initScene=function(){this._inited||(this._inited=!0)},i.prototype.refreshRole=function(){this.createGods()},i.prototype.playEff=function(e,t,i,n){var o=this;this._particleObj||(this._particleObj={}),this._particleObj.hasOwnProperty(e)||this.uiScene.addEffect(this,e,new tl3d.Vector3D(t,0,i),n,30,function(t){o._particleObj.hasOwnProperty(e)?o.uiScene.removeEffect(t):o._particleObj[e]=t})},i.prototype.removeEff=function(t){this._particleObj&&this._particleObj.hasOwnProperty(t)&&(this.uiScene.removeEffect(this._particleObj[t]),delete this._particleObj[t])},i.prototype.tickGuaji=function(){this.sceneEabled&&(h.FightView.chkCam||this.loopAttack())},i.prototype.createGods=function(){this.uiScene.timespeed1=this._guajispeed;for(var t=App.hero.getLineUpTeam(iface.tb_prop.lineupTypeKey.attack,!0),e=null,i=0,n=t.length;i<n;i++){var o=t[i];if(o){e=this.myInfo[i];var a={objId:i+11,atkSpd:100,level:o.level,hpMax:300,hp:300,objType:battle.BatteConsts.BATTLE_CAMPATK},r=this._cachePlayerGuid[String(o.uuid+"_"+o.skinId)];r=r||this.addBaseRole(o.uuid,o.templateId,o.skinId,a.objType,6,10),this.setRoleAttr(a,r,e),r.isFight=!1,this.resetSkill(r.tab.skill,a.objType,6,10,r),r.char.scale=.9,r.char.shadow=!0,r.char.setShadowSize(6),r.onDead=this.removeMonster.bind(this),r.guajiMaxHp=a.hpMax,r.guajihp=a.hp,r.setCharVisable(!0)}}this.clearModel(t,this._cachePlayerGuid),this.changeState(tl3d.CharAction.WALK,tl3d.CharAction.ATTACK_01)},i.prototype.setRoleAttr=function(t,e,i){e.objId=t.objId,e.locad=t.objId%10-1,e.team=Math.floor(t.objId/10),i&&i.pr||logfight("ss"),e.rotation=i.pr,e.atkSpd=t.atkSpd,e.lev=t.level,e.atkBar=-1,e.char.set2dPos(i.px,i.py),e.pos2d=new tl3d.Vector2D(i.px,i.py),e.pos=new tl3d.Vector3D(e.char.px,e.char.py,e.char.pz),e.buffAry=[],e.char.rotationY=e.rotation},i.prototype.nextGuanqia=function(t){this._model.moveState=!0,this.attacksucc=!1,this.creatGuanqiaData(t)},i.prototype.getMonsterIds=function(t){var e=[],i=App.hero.lineupInfo[iface.tb_prop.lineupTypeKey.attack];for(var n in i)i[n]&&e.push(n);var o=[];for(var a in t){var r=t[a];r&&0==r.type&&o.push(r)}for(var s=getRandomNumAssgin(utils.random(1,2),0,e.length),u=getRandomNumAssgin(s.length,0,o.length),h=[],l=0;l<u.length;l++)h.push({idx:Number(e[s[l]]),tag:o[u[l]]});return h},i.prototype.creatGuanqiaData=function(t){var h=this;if(!this._model.isFight){var e=t.tbCopyInfo.getAllMonsters();if(!(e.length<=0)){function i(t){var e=l[t].idx,i=l[t].tag;if(null==i)return 1;var n=c.enimyInfo[e],o={objId:21+e,atkSpd:100,level:i.level,hpMax:300,hp:300,objType:battle.BatteConsts.BATTLE_CAMPDEF},a=i.ID+"_0",r=c._cacheMonsterGuid[String(a)];r=r||c.addBaseRole(String(i.ID),i.ID,0,o.objType,6,10),c.setRoleAttr(o,r,n),r.isFight=!1,c.resetSkill(r.tab.skill,o.objType,6,10,r),r.char.scale=.9*i.model_multiple,r.char.shadow=!0,r.char.setShadowSize(6*i.model_multiple),r.guajiMaxHp=0!=r.tab.type?200:100,r.guajihp=0!=r.tab.type?200:100,r.onDead=c.removeMonster.bind(c),r.setCharVisable(!0);var s=c.myInfo[e],u=c.getAtkHero(e);r.actiontag=!1,c.charMove(r,new tl3d.Vector2D(n.stapx,n.py),new tl3d.Vector2D(s.px+100,n.py),3,null),r.char.play(tl3d.CharAction.WALK),r.char.movetocb=function(t){if(!r.actiontag&&t.x<s.px+200){r.actiontag=!0;var e=u.tab.fight_skill?u.tab.fight_skill:333;h.charPlaySkill(u,String(e),"skill_04",null,null,0,function(){u.char.play(tl3d.CharAction.WALK)}),setTimeout(function(){h._model.isFight||h.atkPlayTag(r)},300)}},r.char.moveokcb=function(){r.movesucc=!0}}for(var l=this.getMonsterIds(e),c=this,n=0;n<l.length;n++)i(n);function o(){var i=a._cacheMonsterGuid[r];l.find(function(t,e){return t&&t.tag&&i.uuid==String(t.tag.ID)})||a.removePlayer(a._cacheMonsterGuid[r])}var a=this;for(var r in this._cacheMonsterGuid)o()}}},i.prototype.atkPlay=function(t,e){t&&t.char&&t.char.curentAction!=e&&t.char.play(e)},i.prototype.getAtkHero=function(t){var e=null;for(var i in this._cachePlayerGuid)if((e=this._cachePlayerGuid[i])&&e.objId==t+11)return e;return null},i.prototype.atkPlayTag=function(t){this.setTagHp(t,100)},i.prototype.charMove=function(t,e,i,n,o){void 0===o&&(o=tl3d.CharAction.STANAD),t.char.runspeed=n,t.char.set2dPos(e.x,e.y),t.char.moveEndAction=o,t.char.moveTopos(i)},i.prototype.attackTarget=function(t){var e=this;if(!t||!t.char||t.guajihp<=0)this.attacksucc=!0;else{var i=t.team==battle.BatteConsts.BATTLE_CAMPATK?this.randomMonsters():this.randomPlayer(),n=t.getFirstSkill();if(n&&i&&0<i.guajihp){var o=tb.TB_skill.get_TB_skillById(n.skillid);if(!o)return;var a=tb.TB_skill_effect.get_TB_skill_effectById(o.effect),r=frame2time(a.frame[1]);a&&1==a.att_type?(r+=this.ATTACK_DELAY,this.jinzhan(t,i,function(){e.playFight(t,i,a,0)})):(r+=this.REMOTE_DELAY,this.playFight(t,i,a,this.REMOTE_DELAY)),this.setHp(100,this.getresultTime(r),i,a)}else this.attacksucc=!0}},i.prototype.setHp=function(s,t,u,h){var l=this;clearTimeout(this._setHpTick),this._setHpTick=setTimeout(function(){if(2<h.frame.length)for(var t=h.damage_section&&h.damage_section.length==h.frame.length-1,e=h.frame.length-1,i=h.frame[1],n=0,o=0,a=1;a<h.frame.length;a++){o=0,o=a==e?s-n:t?perc2num(h.damage_section[a-1])*s:s/e*utils.random(90,110)/100,n+=o=Math.floor(o);var r=l.getresultTime(frame2time(h.frame[a]-i));setTimeout(function(){l.setTagHp(u,o)},r)}else l.setTagHp(u,s)},t)},i.prototype.setTagHp=function(t,e){var i=this;t.setHp(e,function(t){i.uiScene.addEffect(i,1029,t,1.5,0,null,0,0,!0),setTimeout(function(){i.uiScene.addEffect(i,1029,t,1.5,0,null,0,0,!0)},300)})},i.prototype.resetRolePos=function(t){for(var e in t){var i=t[e];i.char.px=i.pos.x,i.char.py=i.pos.y,i.char.pz=i.pos.z,i.char.forceRotationY=i.rotation,i.char.play(tl3d.CharAction.STANAD,2,!1)}},i.prototype.randomPlayer=function(){var t=Object.keys(this._cachePlayerGuid),e=t[random(t.length)];return this._cachePlayerGuid[e]},i.prototype.randomMonsters=function(){var t=new Array;for(var e in this._cacheMonsterGuid){var i=this._cacheMonsterGuid[e];i.movesucc&&0<i.guajihp&&t.push(i)}return t[random(t.length)]},i.prototype.playFight=function(t,e,i,n){var o=this;this.charPlaySkill(t,String(i.effect_id),i.action,i,e,n,function(){t.actiontag&&t.skilltag&&(o._guajiskill=null,o._sceneEabled?o.skillcb(i,t):o.attacksucc=!0)})},Object.defineProperty(i.prototype,"attacksucc",{get:function(){return this._attacksucc},set:function(t){this._attacksucc=t},enumerable:!0,configurable:!0}),i.prototype.skillcb=function(t,e){e&&e.char&&e.char.visible&&(this.attacksucc=!0)},i.prototype.getRandomSkill=function(t){return t[random(t.length)]},i.prototype.charPlaySkill=function(t,e,i,n,o,a,r){var s=this;void 0===r&&(r=null),this._sceneEabled&&t.char&&t.char._scene.ready&&(this._guajiskill=this.uiScene.scene.skillMgr.getSkill(getSkillUrl(e),i,function(){s.charPlaySkill(t,e,i,n,o,a,r)}),this._guajiskill.keyAry&&(this._guajiskill&&(this._guajiskill.reset(),this._guajiskill.isDeath=!1),t&&t.char.visible&&(this._guajiskill.configFixEffect(t.char,function(){r&&r()},null),this._guajiskill.needShock=!1,this.uiScene.scene.skillMgr.playSkill(this._guajiskill))))},i.prototype.backMove=function(t){if(t&&t.char){t.char.rotationY=t.rotation+180,t.char.play(tl3d.CharAction.WALK,2,!1);var e=this.getresultTime(this.ATTACK_DELAY);Laya.Tween.to(t.char,{px:t.pos.x,pz:t.pos.z},e,null,Laya.Handler.create(this,function(){t&&t.char&&(t.char.curentAction!=tl3d.CharAction.STANAD&&t.char.play(tl3d.CharAction.STANAD),t.char.rotationY=t.rotation)}))}},i.prototype.jinzhan=function(t,e,i){t.char.watch(e.char),t.char.play(tl3d.CharAction.WALK,2,!1);var n=tl3d.Vector3D.distance(e.pos,t.pos),o=e.pos.subtract(t.pos);o.normalize(),o.scaleBy(.7*n);var a=t.pos.add(o);Laya.Tween.to(t.char,{px:a.x,pz:a.z},this.getresultTime(300),null,Laya.Handler.create(this,function(t,e){i&&i()}))},i.prototype.removeMonster=function(t){if(this._cacheMonsterGuid[t[0]+"_"+t[1]]&&this.sceneEabled){var e=this._cacheMonsterGuid[t[0]+"_"+t[1]].char.get2dPos();e.y+=h.GuajiView.OffY/.5-150,dispatchEvt(new h.GuajiEvent(h.GuajiEvent.GUAJI_DROP_ITEM,e))}this.hasMonster()||(this._talkEnd=!1,this.guanqiaStep=setTimeout(function(){dispatchEvt(new h.GuajiEvent(h.GuajiEvent.GUANQIA_STEP_COMPLETE))},900))},i.prototype.hasMonster=function(){for(var t in this._cacheMonsterGuid)if(!this._cacheMonsterGuid[t].dealthComplete)return!0;return!1},i.prototype.removePlayer=function(t){if(t){logyhj("移除：",t.uuid);var e=String(t.uuid+"_"+t.skinId);this._cacheMonsterGuid[e]&&delete this._cacheMonsterGuid[e],this._cachePlayerGuid[e]&&delete this._cachePlayerGuid[e],t.char.shadow=!1,Laya.Pool.recover("guajicharvo",t)}},i.prototype.clearGuajiAll=function(){this.stopGuajiSkill(),this.stopMoveTags(this._cacheMonsterGuid),this.stopMoveTags(this._cachePlayerGuid),this._model.moveState=!1,this.stopTween(this._cacheMonsterGuid),this.stopTween(this._cachePlayerGuid),clearTimeout(this.guanqiaStep),this.attacksucc=!0},i.prototype.stopFightSkill=function(){this._curskill&&(clearTimeout(this._actiontick),this._curskill.removeSkillForce())},i.prototype.stopGuajiSkill=function(){clearTimeout(this.backMoveTick),this._guajiskill&&(this._guajiskill.removeSkillForce(),this._guajiskill=null),clearTimeout(this.timetick)},i.prototype.stopTween=function(t){for(var e in t){var i=t[e];Laya.Tween.clearAll(i.char),i.clearGuajiTick(),i.setCharVisable(!1)}},i.prototype.stopMoveTags=function(t){for(var e in t){var i=t[e];i.char.stopMove(i.pos2d),i.movesucc=!0}},i.prototype.startMove=function(t){},i.prototype.changeState=function(t,e){if(void 0===t&&(t=tl3d.CharAction.WALK),this._cachePlayerGuid&&!isEmptyObject(this._cachePlayerGuid))for(var i in this._cachePlayerGuid){var n=this._cachePlayerGuid[i];n&&n.char&&n.char.curentAction!=t&&n.char.curentAction!=e&&n.char.play(t)}},i.prototype.stopMove=function(){this.uiScene.timespeed1=this._fightspeed,this.changeState(tl3d.CharAction.STANAD),Date.now(),this.lastTalkTime,this.setSortList()},i.prototype.onTalk=function(){var t=this,e=[];for(var i in this._cacheMonsterGuid)this._cacheMonsterGuid[i].movesucc&&e.push(this._cacheMonsterGuid[i]);var n=e[random(e.length)];if(n){var o=tb.TB_monster.get_TB_monsterById(n.templatId),a=tb.TB_model_dialogue.getRandomTalk(o.model);""==a?logerror("随机对话出错",n.templatId):dispatchEvt(new h.GuajiEvent(h.GuajiEvent.PLAYER_TALK_SHOW),{str:a,pos:n.char.get2dPos()}),clearTimeout(this._talkTick),this._talkTick=setTimeout(function(){t.setSortList()},1500)}},i.prototype.loopAttack=function(){this._talkEnd&&this.attacksucc&&(this.attacksucc=!1,this.attackTarget(this._sortList[this._attackIndex]),this._attackIndex++,this._attackIndex>=this._sortList.length&&(this._attackIndex=0))},i.prototype.setSortList=function(){for(var t in this.attacksucc=!0,this._talkEnd=!0,this._attackIndex=0,this._sortList=[],this._cachePlayerGuid)this._sortList.push(this._cachePlayerGuid[t]);for(var e in this._cacheMonsterGuid)this._sortList.push(this._cacheMonsterGuid[e])},i.prototype.moveSuccFun=function(){for(var t in this._cacheMonsterGuid)if(!this._cacheMonsterGuid[t].movesucc)return;this.stopMove()},Object.defineProperty(i.prototype,"sceneEabled",{get:function(){return this._sceneEabled},set:function(t){this._sceneEabled=t,this.attacksucc=!1},enumerable:!0,configurable:!0}),i.prototype.enterFightScene=function(t,e){DialogExt.manager.mouseEnabled=!1,this.playerInfo=[],this.monsterInfo=[],this._model.moveState=!1,this._endFlag=!1,this.clearGuajiAll(),this._showOpenEff=!1,this._copyVo=t,this.sceneComplete=e,this.stepOverAry=new Array,this.roundAry=[],this.curRound=null},i.prototype.endFight=function(){var t=this;this._endFlag=!0,setTimeout(function(){t.uiScene.timespeed1=t._guajispeed,t.removeAllBuff(),t.removeRole(),dispatchEvt(new h.GuajiEvent(h.GuajiEvent.CLEAR_ARTIFACE)),t._model.isFight=!1,t.doFigthEnd(function(){dispatchEvt(new h.GuajiEvent(h.GuajiEvent.CHANGE_GUAJI_BTN)),dispatchEvt(new h.GuajiEvent(h.GuajiEvent.GUANQIA_STEP_COMPLETE))})},1e3)},i.prototype.exitBattleBoss=function(){this._copyVo=null},i.prototype.doFigthEnd=function(t){this._copyVo&&(this._copyVo.fightPageControl.getResult()==playState.VICTORY?this.victoryFun(t):this.defeatedFun(t))},i.prototype.defeatedFun=function(t){this.exitBattleBoss(),UIMgr.showUI(UIConst.GuajiDefeated),t&&t()},i.prototype.victoryFun=function(i){var n=this,o=App.hero.level,t={};t[Protocol.game_copy_settleRuneCopy.args.copyId]=this._copyVo.getCopyId(),PLC.request(Protocol.game_copy_settleRuneCopy,t,function(t){if(t){App.hero.updateGuajiData(t),n._model.updatePassGuanqia(n._copyVo.tab_copy.ID,n._copyVo.tab_copyinfo.ID),n.exitBattleBoss();var e=App.hero.level;h.GuideWeakManager.isExcuting()&&e<=o||UIMgr.showUI(UIConst.GuajiVictory,{vo:t}),i&&i(),dispatchEvt(new h.GuajiEvent(h.GuajiEvent.SHOW_SHOUYI_UP_VIEW)),dispatchEvt(new h.GuajiEvent(h.GuajiEvent.BATTLE_COPY_SUCCESS))}})},i.prototype.checkTimeOutTag=function(){if(!this.stepOverAry)return!1;for(var t=Date.now()-15e3,e=0;e<this.stepOverAry.length;e++)if(this.stepOverAry[e].time<t)return!0;return!1},i.prototype.TickUpdate=function(){if(!this._model.startTalkGuide&&this.checkTimeOutTag())for(var t=Date.now()-15e3,e=0;e<this.stepOverAry.length;e++){var i=this.stepOverAry[e];if(i.time<t){var n=String(i.name);this.removeStep(n),BingoSDK.reportError("挂机战斗异常："+JSON.stringify(n))}}if(this._copyVo&&(this.stepOverAry||(this.stepOverAry=new Array),0==this.stepOverAry.length)){if(null===this.roundAry){if(this._endFlag)return;if(this._model.hasEndTalkGuide)return;return logfight("战斗结束"),dispatchEvt(new h.GuajiEvent(h.GuajiEvent.GUAJI_FIGHT_END),this._copyVo.fightPageControl.getResult()),void(this._model.hasEndTalkGuide||this.endFight())}if(this.curRound&&this.curRound.roundary&&0<this.curRound.roundary.length)for(var o=this.curRound.roundary.shift(),a=0;a<o.length;a++){var r=o[a];this.onPlayBefore(r)}else this.roundAry&&0<this.roundAry.length?this.curRound=this.roundAry.shift():this.roundAry=this._copyVo.getNextRound()}},i.prototype.onPlayBefore=function(t,e){if(t.hasOwnProperty("objId")||t.type==iface.tb_prop.battleOpTypeKey.rmBuff){var i=this.getRoleById(t.objId);if(!i){var n=this.getWorldBuff(t.buffInstId);n&&(i=this.getRoleById(n.targetId))}i&&i.deadIng?i.delayList.push(new h.sStep(t,e)):this.onPlay(t,e)}else this.onPlay(t,e)},i.prototype.getWorldBuff=function(t){return this.buffMap&&this.buffMap.has(t)?this.buffMap.get(t):null},i.prototype.getRoleById=function(t){return this.roleMap&&this.roleMap.has(t)?this.roleMap.get(t):null},i.prototype.onPlay=function(t,e){t.type==iface.tb_prop.battleOpTypeKey.useSkill?(this.tagStep(t.type+"_"+t.skillId),this.fight(t)):t.type==iface.tb_prop.battleOpTypeKey.atftInit?(this.tagStep(String(t.type)),this.artifactInfo(t)):t.type==iface.tb_prop.battleOpTypeKey.atftUseSkill?(this.tagStep(t.type+"_"+t.skillId),this.artifactFight(t)):t.type==iface.tb_prop.battleOpTypeKey.atkSpdChange?this.roleAtkSpdChange(t):t.type==iface.tb_prop.battleOpTypeKey.atkBarMax?this._atkMax=t.atkBarMax:t.type==iface.tb_prop.battleOpTypeKey.hpChange?this.hpchange(t,e):t.type==iface.tb_prop.battleOpTypeKey.flyText?this.flytest(t,e):t.type==iface.tb_prop.battleOpTypeKey.atkBar?this.changeActionBar(t):t.type==iface.tb_prop.battleOpTypeKey.objInit?(this.tagStep(String(t.type)),this.roleInfo(t)):t.type==iface.tb_prop.battleOpTypeKey.buffChange?this.updataBuff(t):t.type==iface.tb_prop.battleOpTypeKey.addBuff?this.addBuff(t):t.type==iface.tb_prop.battleOpTypeKey.rmBuff?this.removeBuff(t):t.type==iface.tb_prop.battleOpTypeKey.angerChange?dispatchEvt(new h.GuajiEvent(h.GuajiEvent.SET_ANGER),t):t.type==iface.tb_prop.battleOpTypeKey.trigPasvSkill?this.trigPasvSkill(t):t.type==iface.tb_prop.battleOpTypeKey.hpMaxChange?this.hpMaxChange(t):t.type==iface.tb_prop.battleOpTypeKey.roleAngerChange?this.roleAngerChange(t):t.type==iface.tb_prop.battleOpTypeKey.nextRound&&(t.round&&(logfight("回合：",t.round),dispatchEvt(new h.GuajiEvent(h.GuajiEvent.CHANGE_ROUND),t.round)),this._curRoleId=t.objId)},i.prototype.tagStep=function(t){this.hasTag(t)||(this.stepOverAry.push({name:t,time:Date.now()}),t==String(iface.tb_prop.battleOpTypeKey.objInit)&&(this.buffMap?this.removeAllBuff():this.buffMap=new Map,this.roleMap?this.removeRole():this.roleMap=new Map),t==String(iface.tb_prop.battleOpTypeKey.atftInit)&&(this.artifactMap?this.removeArtifact():this.artifactMap=new Map))},i.prototype.hasTag=function(e){return this.stepOverAry?-1!=this.stepOverAry.findIndex(function(t){return t.name==e}):!(this.stepOverAry=[])},i.prototype.removeStep=function(e){if(this.stepOverAry){var t=this.stepOverAry.findIndex(function(t){return t.name==e});-1!=t&&this.stepOverAry.splice(t,1)}else this.stepOverAry=[]},i.prototype.removeRole=function(){this.roleMap.forEach(function(t,e,i){t&&(t.buffAry=[],t.char&&(t.char.buffary=t.buffAry),t.setCharVisable(!1))}),this.roleMap.clear()},i.prototype.removeArtifact=function(){this.artifactMap.forEach(function(t,e,i){t&&(t.buffAry=[],t.char&&(t.char.buffary=t.buffAry),t.onDispose())}),this.artifactMap.clear()},i.prototype.removeAllBuff=function(){var n=this;this.buffMap.forEach(function(t,e,i){n.removeBuffByOne(e)})},i.prototype.removeBuffByOne=function(t){var e=this.getWorldBuff(t);if(e){var i=this.getRoleById(e.targetId);i&&i.deleteBuff(t),e.particle&&(logfight("移除特效：",e.targetId,"的"+tb.TB_buff_effect.get_TB_buff_effectById(e.tb_buff.index).name),this.uiScene.removeEffect(e.particle)),this.buffMap.delete(t),logfight("删除buff：",e.uuid,this.buffMap.has(t)),Laya.timer.frameOnce(3,this,this.showBuff)}},i.prototype.fight=function(t){var e=this;logfight("当前释放技能：",t.skillId,"施法者 =>"+t.objId,"受击者 =>"+t.targetIds);var i={speednum:0},n=tb.TB_skill.get_TB_skillById(t.skillId),o=0,a=tb.TB_skill_effect.get_TB_skill_effectById(n.effect);if(!a)return logerror("efftab null"),this.triggerEffect(t),void this.removeStep(t.type+"_"+t.skillId);a.frame&&0<a.frame.length&&(logfight("打击帧数：",a.frame[1]),o=frame2time(a.frame[1]));var r=this.getRoleById(t.objId);r&&(1==n.skill_feature&&(dispatchEvt(new h.GuajiEvent(h.GuajiEvent.SET_FIGHT_BLACK_BG),!0),dispatchEvt(new h.GuajiEvent(h.GuajiEvent.PLAY_SKILL_EFF),{name:n.name,icon:r.tab.icon,team:r.team})),r.actiontag=!1,r.skilltag=!1,1==a.att_type?(o+=this.ATTACK_DELAY,this.jinzhans(t,r,n)):a&&2==a.att_type&&this.yuancheng(a,t,r,n,frame2time(a.frame[0]),i),logfight("播放被击打效果:",o+=Number(i.speednum),t),setTimeout(function(){e.triggerEffect(t)},this.getresultTime(o)))},i.prototype.yuancheng=function(t,e,i,n,o,a){var r=this;if(1==t.ballistic){if(!e.targetIds)return void logerror("目标不存在");var s=e.targetIds.length;if(this.sceneEabled)for(var u=0;u<s;u++){var h=this.getRoleById(e.targetIds[u]);if(h){var l=u+1;this.charDandaoPlaySkill(i,n,h,l==s?e:null,a)}}else clearTimeout(this._actiontick),setTimeout(function(){i.actiontag=!0,i.skilltag=!0,r.skillComplete(i,n,e)},this.getresultTime(o+a.speednum));0<s&&(this._actiontick=setTimeout(function(){i.actiontag=!0,r.skillComplete(i,n,e)},this.getresultTime(o+a.speednum)))}else if(0==t.ballistic){if(this.charPlaySkills(i,n,e),!e.targetIds)return void logerror("目标不存在")}else{var c=90==i.rotation?this.skillPoint_def:this.skillPoint_atk,p=3==t.ballistic||0==t.ballistic?null:[c];3==t.ballistic&&i.char.watch(c),this.charPlaySkills(i,n,e,p)}},i.prototype.playEffSkill=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],o=this.getRoleById(n);this.addEffect(e,o,0)}},i.prototype.addEffect=function(t,e,i,n){var o=1,a=1;e.tab instanceof tb.TB_monster&&0<e.tab.type&&(a=1==e.tab.type?e.tab.model_multiple:4,o=e.tab.model_multiple);var r=e.char.getCharHeight();r*=o,r+=37,e.tab instanceof tb.TB_monster&&2==e.tab.type&&(r+=60);var s=1==i?r:e.char.py;this.uiScene.addEffect(this,t,new tl3d.Vector3D(e.char.px,s,e.char.pz),a,10,function(t){t.x=e.char.px,t.z=e.char.pz,n&&n(t)})},i.prototype.jinzhans=function(t,e,i){var n=this.getRoleById(t.targetIds[0]);if(n){var o=n.char;e.char.watch(o),e.char.play(tl3d.CharAction.WALK,2,!1);var a=tl3d.Vector3D.distance(n.pos,e.pos),r=n.pos.subtract(e.pos);r.normalize(),r.scaleBy(.7*a);var s=e.pos.add(r),u=this.getresultTime(this.ATTACK_DELAY);Laya.timer.callLater(this,this.moveChar,[e,s,u,t,i])}},i.prototype.moveChar=function(t,e,i,n,o){var a=this;this.moveUnvisable(t,!1),this._movecharTween=Laya.Tween.to(t.char,{px:e.x,pz:e.z},i,null,Laya.Handler.create(this,function(t,e){clearTimeout(a._movecharTick),a.charPlaySkills(t,e,n)},[t,o])),this._movecharTick=setTimeout(function(){Laya.Tween.clear(a._movecharTween),t.char.px=e.x,t.char.pz=e.z,a.charPlaySkills(t,o,n)},i+200)},i.prototype.moveUnvisable=function(t,e){for(var i=0;t&&i<t.buffAry.length;i++){var n=this.getWorldBuff(t.buffAry[i]);n&&n.particle&&(n.particle.sceneVisible=e)&&(n.particle.x=t.char.px,n.particle.z=t.char.pz)}},i.prototype.triggerEffect=function(t){var e=this;if(logfight("触发被击打效果:",t),-1==this.curRound.succOpt.indexOf(Number(t.skillId))&&this.curRound.roundmap.hasOwnProperty(String(t.skillId))){this.curRound.succOpt.push(Number(t.skillId));for(var i=this.curRound.roundmap[String(t.skillId)],n=0;i&&n<i.length;n++){var o=i[n];if(o.type==iface.tb_prop.battleOpTypeKey.trigPasvSkill){var a=tb.TB_skill.get_TB_skillById(t.skillId);if(a&&0<a.effect){var r=tb.TB_skill_effect.get_TB_skill_effectById(a.effect);if(2<r.frame.length){var s=frame2time(r.frame[0]-r.frame[1]);setTimeout(function(){e.onPlayBefore(o,t.skillId)},this.getresultTime(s))}else this.onPlayBefore(o,t.skillId)}else this.onPlayBefore(o,t.skillId)}else this.onPlayBefore(o,t.skillId)}}},i.prototype.artifactInfo=function(t){this.addArtifact(t),dispatchEvt(new h.GuajiEvent(h.GuajiEvent.INIT_ARTIFACE),t),Laya.timer.frameOnce(2,this,this.artifactInfoCom,[t])},i.prototype.artifactInfoCom=function(t){this.removeStep(String(t.type))},i.prototype.addArtifact=function(t){var e=new h.GuajiCharVo;e.scene=this,e.objId=1e3+t.camp,e.locad=6,e.team=t.camp,e.rotation=t.camp==this._copyVo.getCamp()?90:250,e.skillMap=new Object;var i=tb.TB_skill.get_TB_skillById(t.skillId),n=new GodSkillVo;if(n.skillid=t.skillId,0<i.effect){var o=tb.TB_skill_effect.get_TB_skill_effectById(i.effect);n.skillfile=String(o.effect_id),n.effectName=o.action}e.skillMap[i.ID]=n,e.templatId=t.templateId,e.tab=tb.TB_artifact.get_TB_artifactById(e.templatId);var a=new FightChar;a.setRoleUrl(getRoleUrl(String(e.tab.model))),a.rotationY=e.rotation,e.char=a,this.artifactMap.set(t.camp,e)},i.prototype.artifactFight=function(t){var e=this;logfight("神器释放技能：",t.skillId,"施法阵营 =>"+t.camp,"受击者 =>"+t.targetIds);var i=tb.TB_skill.get_TB_skillById(t.skillId),n=0,o=tb.TB_skill_effect.get_TB_skill_effectById(i.effect);if(o){o.frame&&0<o.frame.length&&(logfight("打击帧数：",o.frame[1]),n=frame2time(o.frame[1]));var a=this.getArtifactById(t.camp);a&&(1==i.skill_feature&&dispatchEvt(new h.GuajiEvent(h.GuajiEvent.SET_FIGHT_BLACK_BG),!0),a.actiontag=!0,a.skilltag=!0,t.camp==battle.BatteConsts.BATTLE_CAMPATK&&this.sceneEabled?UIMgr.showUI(UIConst.ShowSkill,{text:i.name,model:a.tab.model,scale:a.tab.location[3]+2,charx:180,chary:1250,effz:-490,cb:function(){e.onArtifactFight(a,o,n,t,i)}}):this.onArtifactFight(a,o,n,t,i))}else logerror("efftab null")},i.prototype.onArtifactFight=function(t,e,i,n,o){var a=this,r=90==t.rotation?this.shenqiInfo[0]:this.shenqiInfo[1];t.char.set2dPos(r.px,r.py),this.uiScene.scene.addMovieDisplay(t.char);var s={speednum:0};1==e.att_type?(i+=this.ATTACK_DELAY,this.jinzhans(n,t,o)):e&&2==e.att_type&&this.yuancheng(e,n,t,o,frame2time(e.frame[0]),s),i+=Number(s.speednum),setTimeout(function(){a.triggerEffect(n)},this.getresultTime(i))},i.prototype.getArtifactById=function(t){return this.artifactMap&&this.artifactMap.has(t)?this.artifactMap.get(t):null},i.prototype.roleAtkSpdChange=function(t){var e=this.getRoleById(t.objId);e&&(e.atkSpd=t.atkSpd)},i.prototype.hpchange=function(t,e){if(void 0!==e){var i=tb.TB_skill.get_TB_skillById(e);if(0<i.effect&&2<tb.TB_skill_effect.get_TB_skill_effectById(i.effect).frame.length)return}var n=this.getRoleById(t.objId);n&&(logfight("血量变化：",t.hp),n.hp=t.hp)},i.prototype.flytest=function(t,e){var i=this.getRoleById(t.objId);if(i){iface.tb_prop.flyTextTypeKey.reborn==t.flyTextType&&(this.playEffSkill([t.objId],1017),i.char.set2dPos(i.pos2d.x,i.pos2d.y)),t.hasOwnProperty("showeff")&&this.playEffSkill([t.objId],1024);var n=new h.FlyText;n.type=this.getFlyType(t.flyTextType,t.value),n.value=t.value||0,n.skillid=e,i.showJumpText(n),logfight("飘字：",t.objId,t.flyTextType,t.value)}},i.prototype.changeActionBar=function(t){var e=this.getRoleById(t.objId);e&&(e.atkBar=t.atkBar)},i.prototype.roleInfo=function(t){var e=this,i=null;i=(i=t.objType==battle.BatteConsts.BATTLE_CAMPATK?this._cachePlayerGuid[String(t.uuid+"_"+t.skinId)]:this._cacheMonsterGuid[String(t.uuid+"_"+t.skinId)])||this.addBaseRole(t.uuid,t.templateId,t.skinId,t.objType,t.degree,t.starLev),this.resetSkill(i.tab.skill,t.objType,t.degree,t.starLev,i),i.isFight=!0,i.char.scale=i.tab.model_multiple?.9*i.tab.model_multiple:.9,i.char.shadow=!0,i.char.setShadowSize(6*i.char.scale);var n=t.objId%10-1,o=null;o=i.objType==battle.BatteConsts.BATTLE_CAMPATK?this.myInfo[n]:this._copyVo&&0!=this._copyVo.tab_copyinfo.boss_icon?this.bossenimyInfo[n]:this.enimyInfo[n],this.setRoleAttr(t,i,o),i.onDead=this.roleDeath.bind(this),i.hpMax=t.hpMax,i.hp=t.hp,i.setCharVisable(!0),i.setAnger(t.anger),i.char.moveokcb=function(){i.movesucc=!0,e.fightMoveSuccFun()},i.char.play(tl3d.CharAction.WALK),this.charMove(i,new tl3d.Vector2D(o.stapx,o.py),new tl3d.Vector2D(o.px,o.py),8),this.roleMap.set(i.objId,i),t.objType==battle.BatteConsts.BATTLE_CAMPATK?this.playerInfo.push(i):this.monsterInfo.push(i),Laya.timer.frameOnce(2,this,this.resetRoleInfo)},i.prototype.resetRoleInfo=function(){this.clearModel(this.playerInfo,this._cachePlayerGuid),this.clearModel(this.monsterInfo,this._cacheMonsterGuid),this.playerInfo=[],this.monsterInfo=[]},i.prototype.clearModel=function(t,i){function e(){var e=i[o];t.find(function(t){return t&&t.uuid==e.uuid&&t.skinId==e.skinId})||n.removePlayer(i[o])}var n=this;for(var o in i)e()},i.prototype.roleInfoCom=function(){this.mainSceneComplete(),this.startFight()},i.prototype.startTalkGuideEnd=function(){this.uiScene.timespeed1=this._fightspeed,this.removeStep(String(iface.tb_prop.battleOpTypeKey.objInit))},i.prototype.startFight=function(){var t=this;dispatchEvt(new h.GuajiEvent(h.GuajiEvent.REFRESH_TITLE_EVENT)),this._copyVo.fightStart(startOptState.START,function(){DialogExt.manager.mouseEnabled=!0,t._model.startTalkGuide?dispatchEvt(new h.GuajiEvent(h.GuajiEvent.CREATE_ROLE_SUCC)):t.startTalkGuideEnd()})},i.prototype.mainSceneComplete=function(){this.sceneComplete&&Laya.timer.frameOnce(2,this,this.sceneComplete.bind(this))},i.prototype.createCharFun=function(){var t=new h.GuajiCharVo,e=new FightChar;return e.is2d=!0,t.char=e,this.uiScene.scene.addMovieDisplay(t.char),t},i.prototype.addBaseRole=function(t,e,i,n,o,a){var r=Laya.Pool.getItemByCreateFun("guajicharvo",this.createCharFun.bind(this));r.scene=this,r.uuid=t,r.templatId=e,r.objType=n,r.skinId=i;var s=n==battle.BatteConsts.BATTLE_CAMPATK?tb.TB_god.get_TB_godById(e):tb.TB_monster.get_TB_monsterById(e);r.tab=s;var u=h.GodUtils.getGodModel(i,r.tab);return r.char.setRoleUrl(getRoleUrl(String(u))),n==battle.BatteConsts.BATTLE_CAMPATK?this._cachePlayerGuid[String(r.uuid+"_"+r.skinId)]=r:this._cacheMonsterGuid[String(r.uuid+"_"+r.skinId)]=r,r},i.prototype.resetSkill=function(t,e,i,n,o){var a=[];if(e==battle.BatteConsts.BATTLE_CAMPATK)for(var r=getSkillList(t,i,n),s=0;s<r.length;s++)r[s][1]<=i&&a.push(r[s][0]);else a=t;replaceSkill(a),o.skillMap=new Object;for(var u=0;u<a.length;u++){var h=tb.TB_skill.get_TB_skillById(a[u]);if(h){var l=new GodSkillVo;if(l.skillid=h.ID,0<h.effect){var c=tb.TB_skill_effect.get_TB_skill_effectById(h.effect);l.skillfile=String(c.effect_id),l.effectName=c.action}o.skillMap[h.ID]=l}}},i.prototype.fightMoveSuccFun=function(){Laya.timer.frameOnce(10,this,this.godMoveSuccFun)},i.prototype.getRoleMoveResult=function(){return this.roleMap.forEach(function(t,e,i){if(!t.movesucc)return!1}),!0},i.prototype.godMoveSuccFun=function(){this._showOpenEff||this.getRoleMoveResult()&&(this._showOpenEff=!0,this.roleInfoCom())},i.prototype.roleDeathClearBuff=function(t){var e=this.getRoleById(t);if(e)for(;e.buffAry&&0<e.buffAry.length;){var i=e.buffAry.shift();this.removeBuffByOne(i)}},i.prototype.roleDeath=function(t){var e=this.getRoleById(t);if(e)for(;e.buffAry&&0<e.buffAry.length;){var i=e.buffAry.shift();this.removeBuffByOne(i)}},i.prototype.updataBuff=function(t){if(this.buffMap.has(t.buffInstId)){var e=this.buffMap.get(t.buffInstId);e.round=t.round,e.stackCnt=t.stackCnt,this.showBuffFlyText(e,t.hasOwnProperty("showeff")),Laya.timer.frameOnce(3,this,this.showBuff)}else this.addBuff(t)},i.prototype.addBuff=function(t){var e=new h.GodBuffVo;e.casterId=t.casterId,e.round=t.round,e.skillId=t.skillId,e.targetId=t.objId,e.stackCnt=t.stackCnt,e.uuid=t.buffInstId,e.tb_buff=tb.TB_buff.get_TB_buffById(t.buffId),this.buffMap.set(e.uuid,e),this.showBuffFlyText(e,t.hasOwnProperty("showeff")),this.addBuffByOne(e),Laya.timer.frameOnce(3,this,this.showBuff)},i.prototype.showBuffFlyText=function(t,e){var i=this.getRoleById(t.targetId);i&&e&&this.buffJumpText(t,i)},i.prototype.showBuff=function(){var s=this;this.roleMap.forEach(function(t,e,i){for(var n=new Array,o=0;t&&o<t.buffAry.length;o++){var a=t.buffAry[o],r=s.getWorldBuff(a);r&&r.tb_buff.is_show&&9999!=r.tb_buff.round&&n.push(JSON.parse(JSON.stringify(r)))}t.char.buffary=n})},i.prototype.addBuffByOne=function(e){var i=this,t=this.getRoleById(e.targetId);if(t){if(0!=e.tb_buff.index){var n=tb.TB_buff_effect.get_TB_buff_effectById(e.tb_buff.index);this.addEffect(n.effect_id,t,n.location,function(t){1==n.is_cycle&&(e.particle=t,i.buffMap.has(e.uuid)||i.uiScene.removeEffect(t))})}t.buffAry.push(e.uuid)}},i.prototype.removeBuff=function(t){var e=t.buffInstId;this.removeBuffByOne(e)},i.prototype.trigPasvSkill=function(t){var e=String(t.skillId),i=tb.TB_skill.get_TB_skillById(Number(e));if(i&&0<i.effect)logfight("被动存在技能表现"),this.tagStep(t.type+"_"+t.skillId),this.fight(t);else if(-1==this.curRound.succOpt.indexOf(Number(e))&&this.curRound.roundmap.hasOwnProperty(e)){this.curRound.succOpt.push(Number(e));for(var n=this.curRound.roundmap[e],o=0;n&&o<n.length;o++){var a=n[o];this.onPlayBefore(a,t.skillId)}}},i.prototype.hpMaxChange=function(t){var e=this.getRoleById(t.objId);e&&(logfight("血量变化：",t.hp),e.hpMax=t.hpMax,e.hp=t.hp)},i.prototype.roleAngerChange=function(t){var e=this.getRoleById(t.objId);e&&e.setAnger(t.anger)},i.prototype.getresultTime=function(t){return t/(this._fightspeed+1)},i.prototype.skillCompleteForce=function(t,e,i){t.skilltag=!0,this.skillComplete(t,e,i)},i.prototype.charPlaySkills=function(t,e,i,n){var o=this;void 0===n&&(n=null);var a=tb.TB_skill_effect.get_TB_skill_effectById(e.effect);if(this._actiontick=setTimeout(function(){t.actiontag=!0,o.skillComplete(t,e,i)},this.getresultTime(frame2time(a.frame[0]))),this.sceneEabled){if(!t.char._scene.ready)return void this.skillCompleteForce(t,e,i);var r=t.skillMap[e.ID];if(!r||"0"==r.skillfile)return void this.skillCompleteForce(t,e,i);if(this._curskill=this.uiScene.scene.skillMgr.getSkill(getSkillUrl(r.skillfile),r.effectName,function(){logfight("技能加载完成"),o.charPlaySkills(t,e,i,n)}),!this._curskill||!this._curskill.keyAry)return;this._curskill&&(this._curskill.reset(),this._curskill.isDeath=!1),this._curskill.needShock=!1,this._curskill.configFixEffect(t.char,function(){o.skillCompleteForce(t,e,i)},n),this.uiScene.scene.skillMgr.playSkill(this._curskill),1==a.att_type&&setTimeout(function(){o.roleMove(t)},this.getresultTime(frame2time(a.action_frame)))}else clearTimeout(this._actiontick),setTimeout(function(){console.log("切换到后台技能释放完成"),t.actiontag=!0,t.skilltag=!0,t&&t.char&&t.pos&&(t.char.px=t.pos.x,t.char.pz=t.pos.z,t.char.forceRotationY=t.rotation,o.moveUnvisable(t,!0)),o.skillComplete(t,e,i)},this.getresultTime(frame2time(a.frame[0])))},i.prototype.skillComplete=function(t,e,i){if(1==e.skill_feature&&dispatchEvt(new h.GuajiEvent(h.GuajiEvent.SET_FIGHT_BLACK_BG),!1),(!this.sceneEabled||t.skilltag&&t.actiontag)&&this.roleMap&&t&&t.char){if(logfight("战斗技能结束",i.skillId),i.type==iface.tb_prop.battleOpTypeKey.atftUseSkill)return this.uiScene.scene.removeMovieDisplay(t.char),void this.removeStep(i.type+"_"+i.skillId);this.removeStep(i.type+"_"+i.skillId),this._curskill=null}},i.prototype.roleMove=function(t){var e=this;if(t&&t.char){t.char.forceRotationY=t.char.rotationY+180,t.char.play(tl3d.CharAction.WALK,2,!1);var i=this.getresultTime(this.ATTACK_DELAY);this.moveUnvisable(t,!1),this._skillcbTween=Laya.Tween.to(t.char,{px:t.pos.x,pz:t.pos.z},i,null,Laya.Handler.create(this,function(){clearTimeout(e._tweenskillCbTick),t&&t.char&&(t.char.curentAction!=tl3d.CharAction.STANAD&&t.char.play(tl3d.CharAction.STANAD),t.char.forceRotationY=t.rotation,e.moveUnvisable(t,!0))})),this._tweenskillCbTick=setTimeout(function(){Laya.Tween.clear(e._skillcbTween),t&&t.char&&(t.char.px=t.pos.x,t.char.pz=t.pos.z,t.char.forceRotationY=t.rotation,e.moveUnvisable(t,!0))},i)}},i.prototype.charDandaoPlaySkill=function(t,e,i,n,o){var a=this;if(t.char._scene.ready){var r=t.skillMap[e.ID];if(r&&"0"!=r.skillfile&&(this._curskill=this.uiScene.scene.skillMgr.getSkill(getSkillUrl(r.skillfile),r.effectName,function(){logfight("技能加载完成"),a.charDandaoPlaySkill(t,e,i,n,o)}),this._curskill&&this._curskill.keyAry)){var s=this._curskill.keyAry[0];s&&s instanceof tl3d.SkillTrajectory&&(logfight("弹道速度:",s.data.speed),s.data.speed<10&&(o.speednum=this.REMOTE_DELAY)),this._curskill&&(this._curskill.reset(),this._curskill.isDeath=!1),tl3d.PathManager.init(),this._curskill.needShock=!1,this._curskill.configTrajectory(t.char,i.char,null==n?null:function(){t.skilltag=!0,logfight("技能回调skilltag:true"),a.skillComplete(t,e,n)}),t.char.watch(i.char),this.uiScene.scene.skillMgr.playSkill(this._curskill)}}},i.prototype.getFlyType=function(t,e){switch(t){case iface.tb_prop.flyTextTypeKey.hpChange:return 0<e?tl3d.TextJumpType.N_UPHP:tl3d.TextJumpType.N_NORMALDAMAGE;case iface.tb_prop.flyTextTypeKey.crit:return tl3d.TextJumpType.N_CRIT;case iface.tb_prop.flyTextTypeKey.resist:return tl3d.TextJumpType.N_RESISTANCES;case iface.tb_prop.flyTextTypeKey.rampage:return tl3d.TextJumpType.N_ONCEATTACK;case iface.tb_prop.flyTextTypeKey.passive:return tl3d.TextJumpType.N_PASSIVE;case iface.tb_prop.flyTextTypeKey.reborn:return tl3d.TextJumpType.N_RESURGENCE;case iface.tb_prop.flyTextTypeKey.strikeBack:return tl3d.TextJumpType.N_BEATBACK;case iface.tb_prop.flyTextTypeKey.banRecover:return tl3d.TextJumpType.N_DOWNHP;case iface.tb_prop.flyTextTypeKey.shield:return tl3d.TextJumpType.N_SHIELD;case iface.tb_prop.flyTextTypeKey.god:return tl3d.TextJumpType.N_INVINCIBLE;case iface.tb_prop.flyTextTypeKey.immune:return tl3d.TextJumpType.N_IMMUNE;case iface.tb_prop.flyTextTypeKey.share:return tl3d.TextJumpType.N_SHARE;case iface.tb_prop.flyTextTypeKey.reboundDmg:return tl3d.TextJumpType.N_FANTAN;case iface.tb_prop.flyTextTypeKey.angerDown:return tl3d.TextJumpType.N_ANGER_DOWN}},i.prototype.buffJumpText=function(t,e){var i=-1;if(1==t.tb_buff.type)2==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_ATTACK_UP:tl3d.TextJumpType.N_ATTACK_DOWN:3==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_DEFENSE_UP:tl3d.TextJumpType.N_DEFENSE_DOWN:4==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_SPEED_UP:tl3d.TextJumpType.N_SPEED_DOWN:5==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_CRIT_RATE_UP:tl3d.TextJumpType.N_CRIT_RATE_DOWN:7==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_HIT_UP:tl3d.TextJumpType.N_HIT_DOWN:8==t.tb_buff.type_param&&(i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_RESIST_RATE_UP:tl3d.TextJumpType.N_RESIST_RATE_DOWN);else if(2==t.tb_buff.type)i=tl3d.TextJumpType.N_IMMUNE;else if(3==t.tb_buff.type)i=tl3d.TextJumpType.N_INVINCIBLE;else if(7==t.tb_buff.type){var n=t.tb_buff.type_param%10;i=tl3d.TextJumpType.N_BLEED,1==n?i=tl3d.TextJumpType.N_ZHONGDU:2==n&&(i=tl3d.TextJumpType.N_ZHUOSHAO)}else 8==t.tb_buff.type?(i=tl3d.TextJumpType.N_DIZZY,1==t.tb_buff.type_param?i=tl3d.TextJumpType.N_BINGFENG:2==t.tb_buff.type_param?i=tl3d.TextJumpType.N_SHUFU:3==t.tb_buff.type_param?i=tl3d.TextJumpType.N_MEIHUO:4==t.tb_buff.type_param?i=tl3d.TextJumpType.N_SHIHUA:5==t.tb_buff.type_param?i=tl3d.TextJumpType.N_MABI:6==t.tb_buff.type_param&&(i=tl3d.TextJumpType.N_FENNU)):9==t.tb_buff.type?i=tl3d.TextJumpType.N_DOWNHP:10==t.tb_buff.type?i=tl3d.TextJumpType.N_SILENCE:13==t.tb_buff.type?i=tl3d.TextJumpType.N_SARCASM:17==t.tb_buff.type?i=tl3d.TextJumpType.N_SLEEP:18==t.tb_buff.type?i=tl3d.TextJumpType.N_SHIELD:20==t.tb_buff.type?(i=tl3d.TextJumpType.N_TARGET,1==t.tb_buff.type_param?i=tl3d.TextJumpType.N_LEIDIAN:2==t.tb_buff.type_param&&(i=tl3d.TextJumpType.N_WANGLING)):24==t.tb_buff.type&&(i=tl3d.TextJumpType.N_SHARE);if(-1!=i){var o=new h.FlyText;o.type=i,o.value=0,e.showJumpText(o)}},i.prototype.onExit=function(){clearTimeout(this.guanqiaStep),this._model.isFight?this.stopFightSkill():this.clearGuajiAll(),clearTimeout(this._talkTick)},i.prototype.updataTick=function(){if(this._model.isFight)return this._loginindex=0,void this.TickUpdate();2<this._loginindex&&(this.tickGuaji(),this._loginindex=0),this._loginindex++},i);function i(){var t=e.call(this)||this;return t._sceneEabled=!1,t._model=h.GuajiModel.getInstance(),t.myInfo=[{stapx:-50,px:250,py:650,pr:90,showBar:!1},{stapx:-50,px:250,py:850,pr:90,showBar:!1},{stapx:-200,px:100,py:600,pr:90,showBar:!1},{stapx:-200,px:100,py:700,pr:90,showBar:!1},{stapx:-200,px:100,py:800,pr:90,showBar:!1},{stapx:-200,px:100,py:900,pr:90,showBar:!1}],t.enimyInfo=[{stapx:762,px:462,py:650,pr:250,showBar:!0},{stapx:762,px:462,py:850,pr:250,showBar:!0},{stapx:912,px:612,py:600,pr:250,showBar:!0},{stapx:912,px:612,py:700,pr:250,showBar:!0},{stapx:912,px:612,py:800,pr:250,showBar:!0},{stapx:912,px:612,py:900,pr:250,showBar:!0}],t.bossenimyInfo=[{stapx:740,px:440,py:650,pr:250,showBar:!0},{stapx:740,px:440,py:935,pr:250,showBar:!0},{stapx:740,px:440,py:850,pr:250,showBar:!0},{stapx:740,px:612,py:980,pr:250,showBar:!0},{stapx:912,px:612,py:800,pr:250,showBar:!0},{stapx:912,px:612,py:1020,pr:250,showBar:!0}],t.shenqiInfo=[{px:175,py:840},{px:537,py:840}],t.skillPoint_atk=new tl3d.Vector3D(88,0,-594),t.skillPoint_def=new tl3d.Vector3D(268,0,-594),t._inited=!1,t._attacksucc=!1,t.rewardobj={1:10,6:10},t.lastTalkTime=0,t._attackIndex=0,t._fightspeed=.6,t._guajispeed=.25,t.ATTACK_DELAY=300,t.REMOTE_DELAY=500,t._loginindex=0,t.x=0,t.y=784,t.uiScene=new Base2dSceneLayer,t.uiScene.scene.changeBloodManager(new BloodManagerExt),t._cachePlayerGuid={},t._cacheMonsterGuid={},t.uiScene.setPos(Launch.offsetX,Launch.offsetY+h.GuajiView.OffY),t}h.GuajiScene=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.guaji.GuaJiRewardUI,__extends(e,i),e.prototype.close=function(){i.prototype.close.call(this),tl3d.ModuleEventManager.removeEvent(n.GuajiEvent.FUBEN_REWARD_CHANGE,this.updateView,this),tl3d.ModuleEventManager.removeEvent(n.GuajiEvent.UPDATE_FUWEN_COPY_INFO,this.updateBtn,this),this.btn_receive.off(Laya.Event.CLICK,this,this.onClickReceive),this.list.array=null,this._curTask=null,this._uiScene.onExit()},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){tl3d.ModuleEventManager.addEvent(n.GuajiEvent.FUBEN_REWARD_CHANGE,this.updateView,this),tl3d.ModuleEventManager.addEvent(n.GuajiEvent.UPDATE_FUWEN_COPY_INFO,this.updateBtn,this),this.btn_receive.on(Laya.Event.CLICK,this,this.onClickReceive),this._uiScene.onShow(),this.updateView()},e.prototype.updateView=function(){var t=null;!(t=this.dataSource?tb.TB_checkpoint_pass.getTabByTaskId(this.dataSource):this.getCurTaskVo())||this._curTask==t&&60!=t.ID||(this._curTask=t,this._curCopyInfo=tb.TB_copy_info.get_TB_copy_infoById(t.para),this._curBossTemp=this.getBoss(this._curCopyInfo),this.lab_desc.text=this._curTask.desc,this.updateReward(),this.updateBtn(),this.updateBoss())},e.prototype.getCurTaskVo=function(){var t,e=TableData.getInstance().getTableByName(TableData.tb_checkpoint_pass).data;for(var i in e){var n=e[i].ID;if(-1==App.hero.mapBoxAwardIds.indexOf(n))return e[i];t=i}return e[t]},e.prototype.getBoss=function(t){if(!t)return null;var e=t.getMonsters();if(e)for(var i=0;i<e.length;i++)if(1==e[i].type||2==e[i].type)return e[i];return null},e.prototype.updateReward=function(){if(this._curTask){this.list.array=ary2prop(this._curTask.reward);var t=this.list.array?this.list.array.length:0;this.list.width=100*t+10.5;var e=(this.width-this.list.width)/2;this.list.x=e}else this.list.array=null},e.prototype.updateBtn=function(){if(this.btn_receive.visible=!1,this.img_hasReceive.visible=!1,this.lab_title.text="",this.lab_cha.text="",this._curTask)if(this.lab_title.text=""+this._curTask.name,-1!=App.hero.mapBoxAwardIds.indexOf(this._curTask.ID))this.img_hasReceive.visible=!0;else if(App.hero.isPassRuneCopyInfo(this._curCopyInfo.ID,this._curCopyInfo.getChapter()))this.btn_receive.visible=!0,this.btn_receive.label=LanMgr.getLan("",10041),this.btn_receive.disabled=!1,this.btn_receive.skin=SkinUtil.buttonGreen,this.btn_receive.labelStrokeColor=ColorConst.GREEN_FILTER;else{var t=n.GuajiModel.getInstance().getZhangjie(App.hero.copyUnlockId).getCurGuanqia(),e=tb.TB_copy_info.get_TB_copy_infoById(this._curTask.para);if(t.tbCopyInfo.area_number==e.area_number)this.btn_receive.visible=!0,this.btn_receive.label=LanMgr.getLan("击杀",-1),this.btn_receive.disabled=!1,this.btn_receive.skin=SkinUtil.buttonNormal,this.btn_receive.labelStrokeColor=ColorConst.ORANGE_FILTER;else{var i=e.area_number-t.tbCopyInfo.area_number;i<0&&(i+=10),this.lab_cha.text=LanMgr.getLan("{0}关后可击杀",-1,i),this.btn_receive.label=LanMgr.getLan("",10045),this.btn_receive.disabled=!0,this.btn_receive.skin=SkinUtil.buttonNormal,this.btn_receive.labelStrokeColor=ColorConst.ORANGE_FILTER}}},e.prototype.updateBoss=function(){var t=this;if(this._curBossTemp){this.lab_boss_lv.text=LanMgr.getLan("LV.{0}",-1,this._curBossTemp.level),this.lab_boss_name.text=this._curBossTemp.name;var e=this.lab_boss_lv.width+this.lab_boss_name.width+5,i=(this.width-e)/2;this.lab_boss_name.x=i,this.lab_boss_lv.x=i+this.lab_boss_name.width+5;var n=this._curBossTemp.model.toString(),o=.7*this._curBossTemp.model_multiple,a=370,r=650,s=300;if(this._BossModelInfo[n]){var u=this._BossModelInfo[n];a=u[0],r=u[1],o=u[2]*this._curBossTemp.model_multiple,s=u[3]}this.img_mask.width=s,this.img_mask.centerX="20036"==n?-50:0,this._uiScene.addModelChar(n,a,r+80,180,o),this.timer.once(500,this,function(){t._uiScene&&t._uiScene.sceneChar&&t._uiScene.sceneChar.play(tl3d.CharAction.ATTACK_01,2)})}else this.lab_boss_lv.text="",this.lab_boss_name.text=""},e.prototype.onClickReceive=function(){if(this._curTask){if("击杀"==this.btn_receive.label){var t=n.GuajiModel.getInstance(),e=t.getZhangjie(this._curCopyInfo.area);return t.currentZhangjie=e,this._curCopyInfo.is_enter?dispatchEvt(new n.GuajiEvent(n.GuajiEvent.ENTER_FIGHT_EVENT),this._curCopyInfo.ID):(UIMgr.showUI(UIConst.GuajiView),dispatchEvt(new n.GuajiEvent(n.GuajiEvent.UPDATE_ZHANGJIE_EVENT))),void this.close()}var i={};i[Protocol.game_copy_getMapBoxAward.args.id]=this._curTask.ID,PLC.request(Protocol.game_copy_getMapBoxAward,i,function(t){t&&(t&&t.commonData&&UIUtil.showRewardView(t.commonData),dispatchEvt(new n.TaskEvent(n.TaskEvent.REWARD_TASK_SUCCESS)))})}},e);function e(){var t=i.call(this)||this;return t._BossModelInfo={20004:[370,650,1.4,500],20028:[370,600,.7,500],20024:[370,700,1.5,300],20027:[370,650,.7,400],20002:[370,650,1.4,400],20011:[370,600,.6,400],20005:[370,750,1.4,400],20026:[370,650,.7,400],20036:[370,800,1.4,340],20035:[370,800,1.4,260],20006:[370,800,1.2,500],20029:[370,650,1.2,500],20034:[370,800,1.4,300],20030:[370,650,.7,570],20025:[370,900,1.2,240],20033:[370,600,.7,500]},t.isModelClose=!0,t.uiPanel.dataSource={uiName:UIConst.Lilian_RewardView,closeOnSide:t.isModelClose,title:"通关奖励"},t._uiScene=new Base2dSceneLayer,t.box_scene.addChild(t._uiScene),t}n.GuaJiRewardView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fight.shibaiUI,__extends(n,e),n.prototype.timeTick=function(){this.time--,this.time<=0&&this.close(),this.lab_time.text=String(this.time)},n.prototype.popup=function(){var t=this;e.prototype.popup.call(this,!1,!1),this.time=6,this._tickFun(),this.bgPanel.showTitle(!1,"zhandoubiaoxian/shibai.png",!1,!0,!1,null,this),this.btn_again.visible=!1,Laya.timer.loop(1e3,this,this._tickFun),this.btn_close.x=282,this.channel.callback=function(){t.close()}},n.prototype.onOpened=function(){e.prototype.onOpened.call(this),AudioMgr.playSound("sound/defeated.mp3")},n.prototype.close=function(){e.prototype.close.call(this),Laya.timer.clear(this,this._tickFun),this.bgPanel.closeTitle()},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),UIMgr.hasStage(UIConst.GuajiView)&&UIMgr.getUIByName(UIConst.GuajiView).delayShowBossTips()},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t.btn_close.on(Laya.Event.CLICK,t,t.close),t._tickFun=function(){t.timeTick()},t}t.guajiDefeated=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.guaji.GuajiBottomUI,__extends(o,e),o.prototype.setScenePos=function(){this.uiScene.setPos(Launch.offsetX,Launch.offsetY+i.GuajiView.OffY)},o.prototype.onExit=function(){this._enter=!1,this._isOpenJT=!1,this.lbTime.visible=!1,this.pgTime.visible=!1,this.box_effGuang.stop(),this.anim_bomb.stop(),this.anim_bomb.visible=!1,Laya.timer.clearAll(this),this._coinEff&&(this.uiScene.removeEffect(this._coinEff),this._coinEff=null),this.removeLeftEff(),this.stopBattleEff(),this.uiScene.onExit()},o.prototype.onEnter=function(){this._enter=!0,this._isOpenJT=!1,this._curCoinEffLv=0,this.ani1.gotoAndStop(0),this.coinEff.gotoAndStop(0),this.box_coineff.visible=!1,Laya.timer.loop(5e3,this,this.updateCoinEff),this.updateCoinEff(),this.box_effGuang.play(0,!0,"normal"),this.uiScene.onShow(),this.updateInterval()},o.prototype.updateInterval=function(){Laya.timer.clear(this,this.updateTime),0<App.hero.lastGetAfkTime?(this.lbTime.visible=!0,this.pgTime.visible=!0,Laya.timer.loop(61e3,this,this.updateTime),this.updateTime()):(this.lbTime.visible=!1,this.pgTime.visible=!1)},o.prototype.updateTime=function(){var t=App.serverTimeSecond-App.hero.lastGetAfkTime;t=0<t?t:0;var e=i.GuajiModel.getInstance().getMaxOfflineTime();e<=t?(this.lbTime.text=GameUtil.toCountdown(e,"hh:mm"),this.pgTime.value=1,Laya.timer.clear(this,this.updateTime)):(this.lbTime.text=GameUtil.toCountdown(t,"hh:mm"),this.pgTime.value=60<=t?t/e:0)},o.prototype.bxOpenJTEff=function(){this._isOpenJT||(this._isOpenJT=!0,this.box_effGuang.play(0,!0,"openJT"))},o.prototype.bxOpenDTEff=function(){this._isOpenJT=!1,this.box_effGuang.play(0,!1,"openDT"),this.anim_bomb.visible=!0,this.anim_bomb.play(0,!1),Laya.timer.frameOnce(10,this,this.openDTEnd)},o.prototype.openDTEnd=function(){this.box_effGuang.play(0,!0,"normal")},o.prototype.updateCoinEff=function(t){var e=this;if(void 0===t&&(t=!1),!this.box_coineff.visible||!this.coinEff.isPlaying){var i=this.getCoinEffLv();if(this.box_coineff1.visible=!1,t||this._curCoinEffLv!=i){this._curCoinEffLv=i,this.box_coineff.visible=0<i,this.ani1.gotoAndStop(0),this.img_coinblock.skin=o.CoinEffSkinArr[i];var n=o.SizeAry[i]||[0,0];this.boxCoinClick.width=n[0],this.boxCoinClick.height=n[1]-30,Laya.timer.once(400,this,function(){e.playCoinGuangEff(e.box_coineff.visible,i)})}}},o.prototype.getCoinEffLv=function(){if(0==App.hero.lastGetAfkTime)return 0;var t=App.serverTimeSecond-App.hero.lastGetAfkTime;return t<300?0:t<600?1:t<1800?2:3},o.prototype.onClickBX=function(){i.GuajiModel.getInstance().isCanReceiveBX()?dispatchEvt(new i.GuajiEvent(i.GuajiEvent.LINGQU_GUAJI_JIANGLI)):showToast(LanMgr.getLan("",10047))},o.prototype.afterRewardSucc=function(){var t=this;this.box_coineff.visible&&(this.parent&&(this.parent.addChild(this.box_coineff1),this.box_coineff1.y=107+this.y),this.box_coineff1.visible=!0,this.coinEff.play(1,!1),this.coinEff.once(Laya.Event.COMPLETE,this,this.updateCoinEff),Laya.timer.once(300,this,function(){AudioMgr.playSound("sound/ui_gold.mp3")}),this.ani1.play(1,!1),this.addLeftEff(),Laya.timer.once(1e3,this,function(){t.removeLeftEff()}),this.bxOpenDTEff())},o.prototype.playCoinGuangEff=function(t,e){var i=this;if(3<=e){var n=this.uiScene.get3dPos(360,930);this.uiScene.addEffect(this,1000008,n,4,30,function(t){i._coinEff&&i.uiScene.removeEffect(i._coinEff),i._coinEff=t})}else!this._coinEff&&this._enter||(this.uiScene.removeEffect(this._coinEff),this._coinEff=null)},o.prototype.addLeftEff=function(){var e=this;if(!this._hasLeftEff){this._hasLeftEff=!0;var t=this.uiScene.get3dPos(360,990);this.uiScene.addEffect(this,10000025,t,4,0,function(t){e._leftEff=t,e._hasLeftEff||e.removeLeftEff()})}},o.prototype.removeLeftEff=function(){this._hasLeftEff=!1,this._leftEff&&(this.uiScene.removeEffect(this._leftEff),this._leftEff=null)},o.prototype.playBattleEff=function(){var e=this,t=this.uiScene.get3dPos(360,990);this.uiScene.addEffect(this,10000026,t,5,0,function(t){e._battleEff?e.uiScene.removeEffect(t):e._battleEff=t})},o.prototype.stopBattleEff=function(){this._battleEff&&(this.uiScene.removeEffect(this._battleEff),this._battleEff=null)},o.CoinEffSkinArr=["","guaji/jinbi1.png","guaji/jinbi2.png","guaji/jinbi3.png"],o.SizeAry=[[0,0],[313,115],[549,164],[689,194]],o);function o(){var t=e.call(this)||this;return t._curCoinEffLv=0,t._hasLeftEff=!1,t.img_coinblock.mouseEnabled=!1,t.box_bxeff.on(Laya.Event.CLICK,t,t.onClickBX),t.boxCoinClick.on(Laya.Event.CLICK,t,t.onClickBX),t.uiScene=new Base2dSceneLayer,t.addChild(t.uiScene),t.setScenePos(),t}i.GuajiBottomView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var i,t=(i=ui.guaji.FastFightUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onOpened=function(){i.prototype.onOpened.call(this),tl3d.ModuleEventManager.addEvent(u.ResEvent.LIMIT_VALUE_CHANGE,this.setFreeNum,this),tl3d.ModuleEventManager.addEvent(u.TopUpEvent.SHOW_CHONGZHISUCC_PANEL,this.setFreeNum,this)},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btnFast.off(Laya.Event.CLICK,this,this.onFast),tl3d.ModuleEventManager.removeEvent(u.ResEvent.LIMIT_VALUE_CHANGE,this.setFreeNum,this),tl3d.ModuleEventManager.removeEvent(u.TopUpEvent.SHOW_CHONGZHISUCC_PANEL,this.setFreeNum,this)},e.prototype.initView=function(){this.btnFast.on(Laya.Event.CLICK,this,this.onFast),tb.TB_copy_set.getCopySet();var t=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.quickMainNum),e=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.quickBattleNum);this.lbCount.text=LanMgr.getLan("",10007,e-t,e);var i=u.GuajiModel.getInstance().getMaxLev(),n=tb.TB_copy_info.get_TB_copy_infoById(i),o=[];if(n){var a=new ItemVo(iface.tb_prop.resTypeKey.gold,120*n.gold_speed),r=new ItemVo(iface.tb_prop.resTypeKey.godExp,120*n.exp_speed),s=new ItemVo(CostTypeKey.exp,120*n.role_exp_speed);o.push(a),o.push(r),o.push(s)}(this.list_items.array=o)&&o.length<3?this.list_items.x=235+(310-(110*o.length-20))/2:this.list_items.x=235,this.setFreeNum()},e.prototype.setFreeNum=function(){var t=App.hero.totalFreeCount(iface.tb_prop.limitTypeKey.fastFrightFreeNum)-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.fastFrightFreeNum);if(this.img_zuanshi.visible=t<=0,0<t)this.lb_cost.text="每日免费"+t+"次",this.lb_cost.x=321;else{this.lb_cost.x=392;var e=tb.TB_copy_set.getCopySet(),i=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.quickMainNum);this.lb_cost.text="X"+(i>=e.fighting_cost.length?e.fighting_cost[e.fighting_cost.length-1]:e.fighting_cost[i])}},e.prototype.onFast=function(){var e=this,t=tb.TB_copy_set.getCopySet(),i=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.quickMainNum);if(i>=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.quickBattleNum))App.hero.vip<App.getMaxVipLv()?showToast(LanMgr.getLan("",10388)):showToast(LanMgr.getLan("",10011));else{var n=App.hero.totalFreeCount(iface.tb_prop.limitTypeKey.fastFrightFreeNum)-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.fastFrightFreeNum),o=parseInt(t.fighting_cost[i]);n<=0&&App.hero.diamond<o?showToast(LanMgr.getLan("",10005)):PLC.request(Protocol.game_copy_quickMainBattle,{},function(t){t&&(e.initView(),UIUtil.showRewardView(t.commonData),dispatchEvt(new u.GuajiEvent(u.GuajiEvent.FAST_BATTLE_SUCCESS)))})}},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.Guaji_FastView,closeOnSide:t.isModelClose,title:"快速战斗"},t}u.FastFightView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"GuajiProcessor"},i.prototype.listenModuleEvents=function(){return[new h.GuajiEvent(h.GuajiEvent.SHOW_GUAJI_PANEL),new h.GuajiEvent(h.GuajiEvent.GUANQIA_STEP_COMPLETE),new h.GuajiEvent(h.GuajiEvent.SHOW_GUAJISHOUYI),new h.GuajiEvent(h.GuajiEvent.SHOW_SHOUYI_UP_VIEW),new h.GuajiEvent(h.GuajiEvent.SHOW_FAST_BATTLE),new h.GuajiEvent(h.GuajiEvent.UPDATE_ZHANGJIE_EVENT),new h.GuajiEvent(h.GuajiEvent.UPDATE_LASTGET_AFKTIME),new h.GuajiEvent(h.GuajiEvent.ENTER_FIGHT_EVENT),new h.GuajiEvent(h.GuajiEvent.SHOW_JINAGLI_PANEL),new h.GuajiEvent(h.GuajiEvent.GUAJI_DROP_ITEM),new h.GuajiEvent(h.GuajiEvent.PLAYER_TALK_SHOW),new h.GuajiEvent(h.GuajiEvent.CHANGE_GUAJI_BTN),new h.GuajiEvent(h.GuajiEvent.SET_ANGER),new h.GuajiEvent(h.GuajiEvent.UPDATE_FUWEN_COPY_INFO),new h.GuajiEvent(h.GuajiEvent.CHANGE_ROUND),new h.GuajiEvent(h.GuajiEvent.REFRESH_TITLE_EVENT),new h.GuajiEvent(h.GuajiEvent.CLEAR_ARTIFACE),new h.GuajiEvent(h.GuajiEvent.SET_FIGHT_BLACK_BG),new h.GuajiEvent(h.GuajiEvent.PLAY_SKILL_EFF),new h.GuajiEvent(h.GuajiEvent.INIT_ARTIFACE),new h.GodEvent(h.GodEvent.BUZHEN_COMPLETE),new h.GodEvent(h.GodEvent.WEAR_SUCCESS),new h.GuideEvent(h.GuideEvent.GUIDE_END),new h.GuideEvent(h.GuideEvent.UPDATE_GUIDE_STATUS),new h.GuideEvent(h.GuajiEvent.CLOSE_SHOUCHONG_TIPS),new h.ResEvent(h.ResEvent.ROLE_LEVEL_CHANGE)]},i.prototype.receivedModuleEvent=function(t){var e=this;if(t instanceof h.GuajiEvent)switch(t.type){case h.GuajiEvent.SHOW_GUAJI_PANEL:this.showGuaji(t.data);break;case h.GuajiEvent.GUANQIA_STEP_COMPLETE:this.guankaStepComplete();break;case h.GuajiEvent.SHOW_FAST_BATTLE:UIMgr.showUI(UIConst.Guaji_FastView);break;case h.GuajiEvent.UPDATE_LASTGET_AFKTIME:this.updateLastAfkTime();break;case h.GuajiEvent.ENTER_FIGHT_EVENT:this.enterGame(t.data);break;case h.GuajiEvent.CLEAR_ARTIFACE:this.clearArtiface();break;case h.GuajiEvent.UPDATE_ZHANGJIE_EVENT:this.updataZhangjie();break;case h.GuajiEvent.SHOW_JINAGLI_PANEL:this.showjiangli(t.data);break;case h.GuajiEvent.GUAJI_DROP_ITEM:this.showDropItem(t.data);break;case h.GuajiEvent.CHANGE_GUAJI_BTN:this.changeGuajiBtn();break;case h.GuajiEvent.UPDATE_FUWEN_COPY_INFO:this.updateGuajiShouyi();break;case h.GuajiEvent.SET_ANGER:this.setanger(t.data);break;case h.GuajiEvent.SHOW_SHOUYI_UP_VIEW:this.updataJindu(),Laya.timer.frameOnce(10,this,function(){e.showShouyiUpView()});break;case h.GuajiEvent.PLAYER_TALK_SHOW:this.playerTalkShow(t.data);break;case h.GuajiEvent.CHANGE_ROUND:this.setRoundText(t.data);break;case h.GuajiEvent.REFRESH_TITLE_EVENT:this.refreshTitle();break;case h.GuajiEvent.SET_FIGHT_BLACK_BG:this.setFightBg(t.data);break;case h.GuajiEvent.CLOSE_SHOUCHONG_TIPS:this.closeShouchongTip();break;case h.GuajiEvent.INIT_ARTIFACE:this.initartiface(t.data);break;case h.GuajiEvent.PLAY_SKILL_EFF:this.playSkillEff(t.data)}else if(t instanceof h.GuideEvent)switch(t.type){case h.GuideEvent.GUIDE_END:this.viewHasStage&&this.guajiView.showtip();break;case h.GuideEvent.UPDATE_GUIDE_STATUS:this.viewHasStage&&(this.guajiView.showtip(),h.GuideWeakManager.isExcuting()&&this.guajiView.closeBossTips())}else if(t instanceof h.GodEvent)switch(t.type){case h.GodEvent.BUZHEN_COMPLETE:case h.GodEvent.WEAR_SUCCESS:this.guajiView&&this.guajiView.guajiScene&&Laya.timer.frameOnce(5,this,this.buzhenComplete)}t.type==h.ResEvent.ROLE_LEVEL_CHANGE&&(this.changeGuajiBtn(),this.changeWanfaBtn())},i.prototype.playSkillEff=function(t){this.guajiView&&this.guajiView.playSkillName(t.name,t.icon,t.team)},i.prototype.setFightBg=function(t){this.guajiView&&this.guajiView.changeStartBg(t)},i.prototype.clearArtiface=function(){this.guajiView&&this.guajiView.clearArtifact()},i.prototype.setanger=function(t){this.guajiView&&this.guajiView.setAnger(t.camp,t.anger)},i.prototype.initartiface=function(t){this.guajiView&&this.guajiView.initArtifact(t.camp,t.templateId,t.anger)},i.prototype.refreshTitle=function(){this.guajiView&&this.guajiView.refreshTitle()},i.prototype.setRoundText=function(t){this.guajiView&&this.guajiView.setRound(t)},i.prototype.updateGuajiShouyi=function(){this.viewHasStage&&this.guajiView.setBossData()},i.prototype.playerTalkShow=function(t){this.viewHasStage&&this.guajiView.playerTalkShow(t)},i.prototype.showjiangli=function(t){UIMgr.showUI(UIConst.Lilian_RewardView,t)},i.prototype.showShouyiUpView=function(){if(UIMgr.hasStage(UIConst.GuajiView)&&!h.GuideManager.isExecuteGuide()){var t=this._model.getShouyiSpeedList();0<t.length&&UIMgr.showUI(UIConst.Guaji_ShouyiUpView,t)}},i.prototype.changeGuajiBtn=function(){this.guajiView&&this.guajiView.changeBtnState()},i.prototype.changeWanfaBtn=function(){UIMgr.hasStage(UIConst.GuajiView)&&this.guajiView.updateWanfaBtnState()},i.prototype.showDropItem=function(t){this.guajiView.playerRewardEff(t)},i.prototype.updataZhangjie=function(){this.viewHasStage&&(this.guajiView.changeBtnState(),this.guajiView.initZhangjie(!0),this.guajiView.showtip())},i.prototype.updataJindu=function(){this.viewHasStage&&this.guajiView.setBossData()},i.prototype.buzhenComplete=function(){},i.prototype.showGuaji=function(t){t?UIMgr.hideUIByName(UIConst.GuajiView):this.viewHasStage||UIMgr.showUI(UIConst.GuajiView)},i.prototype.guankaStepComplete=function(){if(this.guajiView){var t=this.guajiView.getGuanKa();t&&this.viewHasStage&&this.guajiView.moveToTargetGuan(t,!0,!0)}},i.prototype.updateLastAfkTime=function(){UIMgr.hasStage(UIConst.GuajiView)&&UIMgr.getUIByName(UIConst.GuajiView).bottomUI.updateInterval()},i.prototype.enterGame=function(u){var t={};t[Protocol.game_copy_clgCopy.args.copyId]=u,PLC.request(Protocol.game_copy_clgCopy,t,function(t,e){if(!(0<e.length)&&t){var i=new h.FightVo;i.copyType=iface.tb_prop.copyTypeKey.rune,i.tab_copyinfo=tb.TB_copy_info.get_TB_copy_infoById(u),i.tab_copy=tb.TB_copy.get_TB_copyById(i.tab_copyinfo.area);var n=new battle.BattleScenePve(i.copyType);n.init([i.getOwnTeam()],i.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.monster,i.getAllRound(),i.getTeamHp()),n.start();var o=n.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",o,"战报：",n.battleReport);var a=new h.NewClientPage;a.result=o?playState.VICTORY:playState.FAILURE,a.initPage(n.battleReport),a.defType=iface.tb_prop.battleObjTypeKey.monster,i.fightPageControl=a;var r=App.hero.level<15?[ModuleConst.FIGHT]:[ModuleConst.FUWEN,u],s={vo:i,event:new h.HudEvent(h.HudEvent.SHOW_MODULE_VIEW),eventdata:r};dispatchEvt(new h.FightsEvent(h.FightsEvent.ENTER_FIGHT_EVENT),s)}})},i.prototype.closeShouchongTip=function(){var t=UIMgr.getUIByName(UIConst.GuajiView);t&&t.hideShouchongTishi(),h.ChongzhiModel.getInstance().lastCloseTime=App.serverTimeSecond},Object.defineProperty(i.prototype,"guajiView",{get:function(){return UIMgr.getUIByName(UIConst.GuajiView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewHasStage",{get:function(){return UIMgr.hasStage(UIConst.GuajiView)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=h.GuajiModel.getInstance(),t}h.GuajiProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"GuajiModule"},n.prototype.listProcessors=function(){return[new t.GuajiProcessor]},n.prototype.onRegister=function(){tb.TB_copy.initAllCopy(),t.GuajiModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.GuajiModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_GUAJI_PANEL="SHOW_GUAJI_PANEL",r.GUANQIA_STEP_COMPLETE="GUANQIA_STEP_COMPLETE",r.SHOW_GUAJISHOUYI="SHOW_GUAJISHOUYI",r.SHOW_SHOUYI_UP_VIEW="SHOW_SHOUYI_UP_VIEW",r.SHOW_FAST_BATTLE="SHOW_FAST_BATTLE",r.FAST_BATTLE_SUCCESS="FAST_BATTLE_SUCCESS",r.LINGQU_GUAJI_JIANGLI="LINGQU_GUAJI_JIANGLI",r.LINGQU_GUAJI_JIANGLI_SUCC="LINGQU_GUAJI_JIANGLI_SUCC",r.UPDATE_LASTGET_AFKTIME="UPDATE_LASTGET_AFKTIME",r.REWARD_BAOXIANG_SUCC="UPDATE_LASTGET_AFKTIME",r.CLICK_SAODANG="CLICK_SAODANG",r.ENTER_FIGHT_EVENT="ENTER_FIGHT_EVENT",r.UPDATE_ZHANGJIE_EVENT="UPDATE_ZHANGJIE_EVENT",r.SHOW_JINAGLI_PANEL="SHOW_JINAGLI_PANEL",r.FUBEN_REWARD_CHANGE="FUBEN_REWARD_CHANGE",r.GUAJI_DROP_ITEM="GUAJI_DROP_ITEM",r.UPDATE_FUWEN_COPY_INFO="UPDATE_FUWEN_COPY_INFO",r.RED_CHANGE="RED_CHANGE",r.MOVE_TO_TARGET_GK="MOVE_TO_TARGET_GK",r.PLAYER_TALK_SHOW="PLAYER_TALK_SHOW",r.CONFIRM_SYS_OPEN_BUTTON="CONFIRM_SYS_OPEN_BUTTON",r.CLOSE_SHOUCHONG_TIPS="CLOSE_SHOUCHONG_TIPS",r.CHANGE_GUAJI_BTN="CHANGE_GUAJI_BTN",r.ENTER_FIGHT="ENTER_FIGHT",r.CREATE_ROLE_SUCC="CREATE_ROLE_SUCC",r.GUAJI_FIGHT_END="GUAJI_FIGHT_END",r.GUAJI_TALK_END="GUAJI_TALK_END",r.BATTLE_COPY_SUCCESS="BATTLE_COPY_SUCCESS",r.CHANGE_ROUND="CHANGE_ROUND",r.REFRESH_TITLE_EVENT="REFRESH_TITLE_EVENT",r.INIT_ARTIFACE="INIT_ARTIFACE",r.SET_ANGER="SET_ANGER",r.CLEAR_ARTIFACE="CLEAR_ARTIFACE",r.GET_PROP_EFF="GET_PROP_EFF",r.SET_FIGHT_BLACK_BG="SET_FIGHT_BLACK_BG",r.PLAY_SKILL_EFF="PLAY_SKILL_EFF",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.GuajiEvent=a}(game=game||{}),function(o){var t;(t=o.GuajiBtnState||(o.GuajiBtnState={}))[t.CANBOSS=0]="CANBOSS",t[t.TIME=1]="TIME",t[t.FIGHTING=2]="FIGHTING",t[t.MAP=3]="MAP",t[t.OPEN=4]="OPEN",t[t.JINGYING=5]="JINGYING";var e=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.initModel=function(){this.newOpen=0,this.zhangjieList=new Array,this._copyList=tb.TB_copy.fuwenFuben;for(var t=this._copyList.length,e=0;e<t;e++){var i=this._copyList[e],n=new o.ZhangjieVo(i);this.currentZhangjie?n.finish()?this.maxZhangjie=this.currentZhangjie=n:n.isOpen()&&(n.isNew()&&App.hero.copyUnlockId<n.id?this.newOpen=n.id:this.currentZhangjie=n):this.maxZhangjie=this.currentZhangjie=n,this.zhangjieList.push(n)}this.lastCopyId=this.getMaxLev()},i.prototype.updatePassGuanqia=function(t,e){for(var i=-1,n=-1,o=this.zhangjieList.length,a=0;a<o;a++){var r=this.zhangjieList[a];if(r.id==t){r.updateGuaqiaState(e),r.getGuanqiaById(e),r.id>this.maxZhangjie.id&&(this.maxZhangjie=r),-1!=(n=r.updateNextGuaqiaState(e))&&a<o-1&&(i=a+1);break}}if(-1!=i){var s=this.zhangjieList[i];s.updateGuaqiaState(n),this.currentZhangjie&&this.currentZhangjie.id!=s.id&&s.isOpen()&&s.isNew()&&(this.newOpen=s.id)}},i.prototype.isInMapGuide=function(){return 0!=this.newOpen},i.prototype.isUnlockCapter=function(t){return t<=(1==App.hero.copyUnlockId?1e3:App.hero.copyUnlockId)},i.prototype.getGuanqiaById=function(t){for(var e=0;e<this.zhangjieList.length;e++){var i=this.zhangjieList[e];for(var n in i.guankaMap)if(i.guankaMap.hasOwnProperty(n)){var o=i.guankaMap[n];if(o.tbCopyInfo.ID==t)return o}}return null},i.prototype.getZhangjie=function(t){for(var e=0;e<this.zhangjieList.length;e++){var i=this.zhangjieList[e];if(i.id==t)return i}return null},i.prototype.getNextZj=function(){var t=this.zhangjieList.indexOf(this.currentZhangjie);if(-1==t)return null;var e=t+1;return e>this.zhangjieList.length?null:this.zhangjieList[e]},i.prototype.getCopyInfoByChapter=function(t){var e=-1;return App.hero.runeCopyInfo.hasOwnProperty(t)&&(e=Number(App.hero.runeCopyInfo[t])),e},i.prototype.getCopyNumById=function(t){var e=0;return App.hero.copyChallengeInfo.hasOwnProperty(t)&&(e=Number(App.hero.copyChallengeInfo[t])),e},i.prototype.isPassCopy=function(t){var e=tb.TB_copy_info.get_TB_copy_infoById(t),i=tb.TB_copy.get_TB_copyById(e.area);return t<=this.getCopyInfoByChapter(i.chapter)},i.prototype.getMaxLev=function(){var t=0;for(var e in App.hero.runeCopyInfo)App.hero.runeCopyInfo.hasOwnProperty(e)&&(t=Math.max(t,Number(App.hero.runeCopyInfo[e])));return t},i.prototype.getMaxChapter=function(){var t=this.getMaxLev(),e=tb.TB_copy_info.get_TB_copy_infoById(t);return e?e.area:1e3},i.prototype.getCopyRankDesc=function(t){var e=tb.TB_copy_info.get_TB_copy_infoById(t);if(e){var i=t.toString().split("");return LanMgr.getLan(""+this.arrSubType[i[1]]+(Number(i[2])+1)+"-"+e.area_number,-1)}return"无"},i.prototype.getCopyDesc=function(t){if(tb.TB_copy_info.get_TB_copy_infoById(t)){var e=t.toString().split("");return LanMgr.getLan(""+this.arrSubType[e[1]],-1)}return"无"},i.prototype.getSelfRankDesc=function(){return this.getCopyRankDesc(this.getMaxLev())},i.prototype.isPassTime=function(){return 30<=(App.getServerTime()-App.hero.lastGetAfkTime)/60},i.prototype.isCanChallenge=function(t){var e=tb.TB_copy_info.get_TB_copy_infoById(t);if(!e)return!1;if(App.hero.level<e.getConditionVal(CopyConditionType.level))return!1;var i=this.getMaxLev();return!(e.getConditionVal(CopyConditionType.id)>i)},i.prototype.getCanChallengeMaxCopy=function(){var t=this.getMaxLev(),e=tb.TB_copy_info.get_TB_copy_infoById(t);return e?tb.TB_copy_info.get_TB_copy_infoById(e.next):null},i.prototype.getShouyiSpeedList=function(){var t=tb.TB_copy_info.get_TB_copy_infoById(this.lastCopyId),e=tb.TB_copy_info.get_TB_copy_infoById(this.getMaxLev());if(!e)return[];var i=[],n=t?t.exp_speed:0,o=t?t.gold_speed:0,a=t?t.role_exp_speed:0;return(e.exp_speed>n||e.gold_speed>o||e.role_exp_speed>a)&&(i.push({type:iface.tb_prop.resTypeKey.roleExp,last:Math.floor(a),cur:Math.floor(e.role_exp_speed)}),i.push({type:iface.tb_prop.resTypeKey.gold,last:Math.floor(o),cur:Math.floor(e.gold_speed)}),i.push({type:iface.tb_prop.resTypeKey.godExp,last:Math.floor(n),cur:Math.floor(e.exp_speed)})),i},i.prototype.getRandomMonster=function(t){var e=[],i=this.zhangjieList[t];for(var n in i.guankaMap){var o=i.guankaMap[n];10!=o.tbCopyInfo.area_number&&(o.isPass||o.isNext())&&e.push(o)}var a=random(e.length);return e[a]?e[a].tbCopyInfo:null},i.prototype.getMaxOfflineTime=function(){var t=tb.TB_copy_set.getCopySet().offline_time;return App.serverTimeSecond<=App.hero.welfare.monthCardEndTime&&(t+=tb.TB_month_card.getTbMonthCardById(1).offline_time),1==App.hero.welfare.lifelongCard&&(t+=tb.TB_month_card.getTbMonthCardById(2).offline_time),t},i.prototype.isCanReceiveBX=function(){if(0==App.hero.lastGetAfkTime)return!1;var t=App.serverTimeSecond-App.hero.lastGetAfkTime;return tb.TB_copy_set.getCopySet().short_time<=t},i);function i(){this.inited=!1,this.isEnable=!1,this.isFight=!1,this.maxZhangjie=null,this.newOpen=0,this.moveState=!1,this.copyName=["","普通","困难","地狱"],this.arrSubType=["简单","困难","地狱"]}o.GuajiModel=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.goddoor.render.TabTurnUI,__extends(i,e),i.prototype.init=function(){this.onstage=!0,this.removeMask(),this.list_god.mouseHandler=Handler.create(this,this.onGodMouse,null,!1),this.list_god.renderHandler=Handler.create(this,this.onGodRender,null,!1),this.list_race.selectHandler=Handler.create(this,this.onRaceSelect,null,!1),this.list_race.renderHandler=Handler.create(this,this.onRaceRender,null,!1),this.btn_cancel.on(Laya.Event.CLICK,this,this.onCancel),this.btn_save.on(Laya.Event.CLICK,this,this.onSave),this.btn_zhuanhuan.on(Laya.Event.CLICK,this,this.onTurn),this.btn_xiangxi.on(Laya.Event.CLICK,this,this.onDetailed),this.curRaceIdx=0,this.list_race.dataSource=[0,1,2,3],this.list_race.selectedIndex=0,this.setBtn(!0),this.selectGod=null,a.GodModel.getInstance().showItemsByView=ChooseOpenType.TURN_VIEW},i.prototype.close=function(){this.onstage=!1,Laya.timer.clearAll(this),this.list_god.renderHandler&&(this.list_god.renderHandler.recover(),this.list_god.renderHandler=null),this.list_god.mouseHandler&&(this.list_god.mouseHandler.recover(),this.list_god.mouseHandler=null),this.list_race.renderHandler&&(this.list_race.renderHandler.recover(),this.list_race.renderHandler=null),this.list_race.selectHandler&&(this.list_race.selectHandler.recover(),this.list_race.selectHandler=null),this.list_race.dataSource=[],this.list_god.dataSource=[],this.btn_cancel.off(Laya.Event.CLICK,this,this.onCancel),this.btn_save.off(Laya.Event.CLICK,this,this.onSave),this.btn_zhuanhuan.off(Laya.Event.CLICK,this,this.onTurn),this.btn_xiangxi.off(Laya.Event.CLICK,this,this.onDetailed),this.removeLeftEff(),this.removeRightEff(),this.uiScene.onExit(),this.mainChar=null,this.resultChar=null,this.ani1.stop(),this.removeMask(),this._godDoorMain=null,this.removeRewardEff()},i.prototype.onRaceRender=function(t,e){t.img_selected.visible=e==this.curRaceIdx},i.prototype.onRaceSelect=function(t){if(-1!=t){this.curRaceIdx=t;var e=a.GodDoorModel.getInstance().getGodList(t);this.list_god.dataSource=e}},i.prototype.onGodRender=function(t,e){var i=t.dataSource;t.img_gouxuan.visible=t.dataSource.selected=this._selectGod==i},i.prototype.onGodMouse=function(t,e){var i=this;if(t.type==Laya.Event.CLICK)if(-1==e||this._selectGod==this.list_god.dataSource[e])this.selectGod=null,this.list_god.selectedIndex=-1;else{var n=this.list_god.array[e];n.isInLinuep()?common.AlertBox.showAlert({text:LanMgr.getLan("",10501),confirmCb:function(){a.GodUtils.downGods(n).then(function(){i.list_god.refresh()})}}):(this.selectGod=n,this.list_god.selectedIndex=e)}},Object.defineProperty(i.prototype,"selectGod",{get:function(){return this._selectGod},set:function(t){this._selectGod=t,this.showLeftInfo(this._selectGod),this.drawCost(),this.showRightInfo(this.selectGod)},enumerable:!0,configurable:!0}),i.prototype.drawCost=function(){if(this.selectGod){this.img_cost1.visible=!1,this.img_cost2.visible=!1;for(var t=100*this.selectGod.tab_god.race_type+10*this.selectGod.starLevel+this.selectGod.tab_god.quality,e=tb.TB_divinity_replace.get_TB_divinity_replaceById(t),i=0;i<e.cost.length;i++){var n=i+1,o=this["img_cost"+n];o.visible=!0,o.skin=SkinUtil.getCostSkin(e.cost[i][0]),this["lab_cost"+n].text="x "+Snums(e.cost[i][1])}this.img_cost_bg.visible=!0}else this.img_cost_bg.visible=!1,this.img_cost1.visible=!1,this.img_cost2.visible=!1},i.prototype.onDetailed=function(){this.removeMask();var t=tb.TB_god.get_TB_godById(this._resultId),e=tb.TB_god_evolution.get_TB_god_evolutionById(this.selectGod.starLevel),i=this.selectGod.starLevel<=5?this.selectGod.starLevel:5,n={templateId:t.ID,starLevel:this.selectGod.starLevel,level:e.level,skill:t.skill,degree:i},o=new GodItemVo(n);o.tab_god=t,dispatchEvt(new a.TujianEvent(a.TujianEvent.SHOW_GUAIWUXINXI_PANEL),o)},i.prototype.onCancel=function(){this.setResult()},i.prototype.onSave=function(){dispatchEvt(new a.GodDoorEvent(a.GodDoorEvent.TURN_GOD_OK),this.selectGod)},i.prototype.refreshResult=function(t){for(var e in t)this.selectGod.uuid==e&&(this.selectGod.templateId=t[e].templateId,this.selectGod.tab_god=tb.TB_god.get_TB_godById(this.selectGod.templateId),this.showLeftInfo(this.selectGod),this.list_god.refresh());this.setResult()},i.prototype.setResult=function(){this.removeMask(),this.setBtn(!0),this.drawCost(),this.showRightInfo(this.selectGod)},i.prototype.removeMask=function(){var t=this.getGodDoorMain();t&&t.removeBoxMask()},i.prototype.getGodDoorMain=function(){return this._godDoorMain||(this._godDoorMain=UIMgr.getUIByName(UIConst.GodDoorView)),this._godDoorMain},i.prototype.addMask=function(){var t=this.getGodDoorMain();t&&(t.addBoxMask(Laya.Handler.create(this,this.onClickMask,null,!1)),t.addBoxMaskUnit(this.btn_cancel),t.addBoxMaskUnit(this.btn_save),t.addBoxMaskUnit(this.btn_xiangxi))},i.prototype.onClickMask=function(){showToast(LanMgr.getLan("",10108))},i.prototype.onTurn=function(){this._hasRewardEff||(this.selectGod?this.turnGodEvent(this.selectGod):showToast(LanMgr.getLan("",10109)))},i.prototype.turnGodEvent=function(t){for(var e=this,i=100*t.tab_god.race_type+10*t.starLevel+t.tab_god.quality,n=tb.TB_divinity_replace.get_TB_divinity_replaceById(i),o=!0,a=0;a<n.cost.length;a++)if(n.cost[a][0]==iface.tb_prop.resTypeKey.convertDust){if(n.cost[a][1]>App.hero.convertDust){o=!1,showToast(LanMgr.getLan("",10120));break}}else{if(n.cost[a][0]!=iface.tb_prop.resTypeKey.gold){logdebug("新增道具没加判断！"),o=!1;break}if(n.cost[a][1]>App.hero.gold){o=!1,showToast(LanMgr.getLan("",10120));break}}if(o){var r={};r[Protocol.game_god_doorConvert.args.godId]=t.uuid,PLC.request(Protocol.game_god_doorConvert,r,function(t){t&&t.convertTpltId&&e.onstage&&(e.addRewardEff(),Laya.timer.once(600,e,function(){e.removeRewardEff(),e.turnResult(t.convertTpltId)}))})}},i.prototype.turnResult=function(t){if(this.onstage){this._resultId=t;var e=tb.TB_god.get_TB_godById(this._resultId);this.showRightInfo(this.selectGod,e),this.setBtn(!1),this.addMask()}},i.prototype.setBtn=function(t){this.img_cost1.visible=this.img_cost2.visible=this.img_cost_bg.visible=t,this.btn_xiangxi.visible=this.btn_cancel.visible=this.btn_save.visible=!t,this.btn_zhuanhuan.visible=t},i.prototype.showRightInfo=function(t,e){void 0===e&&(e=null),t?(this.box_new.visible=!0,this.img_new_flag.skin=SkinUtil.getGodRaceSkin(t.tab_god.race_type),this.star_new.setStarNum(t.starLevel),this.addRightEff(),e?(this.lab_new_name.text=LanMgr.getLan("Lv.{0} {1}",-1,t.level,e.name),this.resultChar=this.uiScene.addModelChar(String(e.model),530,630,190,2.2),this.img_wh.visible=!1,this.ani1.stop()):(this.lab_new_name.text=LanMgr.getLan("Lv.{0} {1}",-1,t.level,"??"),this.resultChar&&this.uiScene.removeModelChar(this.resultChar),this.img_wh.visible=!0,this.ani1.play())):(this.box_new.visible=!1,this.removeRightEff(),this.resultChar&&this.uiScene.removeModelChar(this.resultChar),this.img_wh.visible=!1,this.ani1.stop())},i.prototype.showLeftInfo=function(t){if(void 0===t&&(t=null),t){this.removeLeftEff(),this.box_old.visible=!0,this.setMainChar(t),this.img_old_flag.skin=SkinUtil.getGodRaceSkin(t.tab_god.race_type),this.star_old.setStarNum(this.selectGod.starLevel),this.lab_old_name.text=LanMgr.getLan("Lv.{0} {1}",-1,this.selectGod.level,this.selectGod.tab_god.name);for(var e=100*this.selectGod.tab_god.race_type+10*this.selectGod.starLevel+this.selectGod.tab_god.quality,i=tb.TB_divinity_replace.get_TB_divinity_replaceById(e),n=0;n<i.cost.length;n++){var o=n+1,a=this["img_cost"+o];a.visible=!0,a.skin=SkinUtil.getCostSkin(i.cost[n][0]),this["lab_cost"+o].text="x "+Snums(i.cost[n][1])}this.img_cost_bg.visible=!0}else this.addLeftEff(),this.box_old.visible=!1,this.mainChar&&this.uiScene.removeModelChar(this.mainChar)},i.prototype.setMainChar=function(t){this.mainChar&&this.uiScene.removeModelChar(this.mainChar),t&&(this.mainChar=this.uiScene.addModelChar(String(t.tab_god.model),170,630,170,2.2))},i.prototype.addLeftEff=function(){var e=this;this._hasLeftEff||(this._hasLeftEff=!0,this.uiScene.addEffect(this,10000023,new tl3d.Vector3D(85,0,-450),2,10,function(t){e._leftEff=t,e._hasLeftEff||e.removeLeftEff()}))},i.prototype.removeLeftEff=function(){this._hasLeftEff=!1,this._leftEff&&(this.uiScene.removeEffect(this._leftEff),this._leftEff=null)},i.prototype.addRightEff=function(){var e=this;this._hasRightEff||(this._hasRightEff=!0,this.uiScene.addEffect(this,10000022,new tl3d.Vector3D(270,0,-450),2,30,function(t){e._rightEff=t,e._hasRightEff||e.removeRightEff()}))},i.prototype.removeRightEff=function(){this._hasRightEff=!1,this._rightEff&&(this.uiScene.removeEffect(this._rightEff),this._rightEff=null)},i.prototype.addRewardEff=function(){var e=this;this._hasRewardEff||(this._hasRewardEff=!0,this.uiScene.addEffect(this,10000021,new tl3d.Vector3D(270,0,-450),2,30,function(t){e._rewardEff=t,e._hasRewardEff||e.removeRewardEff()}))},i.prototype.removeRewardEff=function(){this._hasRewardEff=!1,this._rewardEff&&(this.uiScene.removeEffect(this._rewardEff),this._rewardEff=null)},i);function i(){var t=e.call(this)||this;return t.curRaceIdx=0,t._hasLeftEff=!1,t._hasRightEff=!1,t._hasRewardEff=!1,t.uiScene=new Base2dSceneLayerExt,t.addChildAt(t.uiScene,2),t}a.GodDoorTabTurn=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=ui.goddoor.render.TabDoorUI,__extends(i,e),i.prototype.init=function(){this._clicktype=!0,this.buildState(),this.addBgEff()},i.prototype.onOpen=function(){this._clicktype&&(this._isClickZH||this._hasRewardEff||(dispatchEvt(new u.GodDoorEvent(u.GodDoorEvent.OPEN_DOOR_EVENT),this["img_"+this._lastType].dataSource),this.openDoorEvent(this["img_"+this._lastType].dataSource)))},i.prototype.openDoorEvent=function(t){var e=this;if(t.cost[1]>App.hero.getBagItemNum(CostTypeKey.shenjiemiyao))showToast(LanMgr.getLan("",Lans.cost,CostTypeKey.shenjiemiyao));else{this._isClickZH=!0;var i={};i[Protocol.game_god_doorEmploy.args.race]=t.ID,PLC.request(Protocol.game_god_doorEmploy,i,function(t){e._isClickZH=!1,t&&(e.addRewardEff(),Laya.timer.once(600,e,function(){e.removeRewardEff(),UIUtil.showRewardView(t.commonData)}),dispatchEvt(new u.GodDoorEvent(u.GodDoorEvent.KAIQI_SUCCESS)))})}},i.prototype.close=function(){Laya.timer.clearAll(this),this.removeBgEff(),this.removeRewardEff(),this.uiBottomScene.onExit(),this.uiTopScene.onExit(),Laya.Tween.clearAll(this.img_1),Laya.Tween.clearAll(this.img_2),Laya.Tween.clearAll(this.img_3),Laya.Tween.clearAll(this.img_4),clearTimeout(this._timeout)},i.prototype.addBgEff=function(){var e=this;this._hasbgEff||(this._hasbgEff=!0,this.uiBottomScene.addEffect(this,10000020,new tl3d.Vector3D(180,0,-480),2.5,0,function(t){e._bgEff=t,e._hasbgEff||e.removeBgEff()}))},i.prototype.removeBgEff=function(){this._hasbgEff=!1,this._bgEff&&(this.uiBottomScene.removeEffect(this._bgEff),this._bgEff=null)},i.prototype.addRewardEff=function(){var e=this;this._hasRewardEff||(this._hasRewardEff=!0,this.uiTopScene.addEffect(this,10000021,new tl3d.Vector3D(180,0,-480),2.5,0,function(t){e._rewardEff=t,e._hasRewardEff||e.removeRewardEff()}))},i.prototype.removeRewardEff=function(){this._hasRewardEff=!1,this._rewardEff&&(this.uiTopScene.removeEffect(this._rewardEff),this._rewardEff=null)},i.prototype.onTop=function(){var t=this;this._clicktype&&(clearTimeout(this._timeout),this.turnBuild(this._lastType+1),this._timeout=setTimeout(function(){t.turnBuild(t._lastType+1)},500))},i.prototype.onShop=function(){dispatchEvt(new u.ShopEvent(u.ShopEvent.SHOW_SHOP_VIEW),ShopType.shenjie)},i.prototype.onLeft=function(){this._clicktype&&(clearTimeout(this._timeout),this.turnBuild(this._lastType-1))},i.prototype.onRight=function(){this._clicktype&&(clearTimeout(this._timeout),this.turnBuild(this._lastType+1))},i.prototype.turnBuild=function(t){this.removeBgEff(),this._clicktype=!1;var e=t%this.posMap.length;this._lastType=0==e?4:e,this.buildState(!0)},i.prototype.buildState=function(i){var n=this;function t(){var t=(o+a[s].ID-r._lastType)%o,e=r["img_"+a[s].ID];0==t&&(r.img_teamtag.skin=SkinUtil.getGodRaceSkin2(r._lastType),r.lab_cost.text="X"+a[s].cost[1]),Laya.Tween.clearTween(e),i?Laya.Tween.to(e,{alpha:r.posMap[t].alpha,x:r.posMap[t].pos[0],y:r.posMap[t].pos[1],scaleX:r.posMap[t].scale,scaleY:r.posMap[t].scale},500,null,Handler.create(r,function(){e.zOrder=n.posMap[t].zoder})):(e.dataSource=a[s],e.pos(r.posMap[t].pos[0],r.posMap[t].pos[1]),e.scale(r.posMap[t].scale,r.posMap[t].scale),e.alpha=r.posMap[t].alpha,e.zOrder=r.posMap[t].zoder)}void 0===i&&(i=!1);for(var o=this.posMap.length,a=tb.TB_divinity_door.get_TB_divinity_door(),r=this,s=0;s<a.length;s++)t();dispatchEvt(new u.GodDoorEvent(u.GodDoorEvent.TURN_BUILD_OK)),i&&setTimeout(function(){n._clicktype=!0,n.addBgEff()},500)},i.prototype.getLastType=function(){return this._lastType},i.prototype.onYulan=function(){UIMgr.showUI(UIConst.GodDoor_JiangliView,this._lastType)},i);function i(){var t=e.call(this)||this;return t._isClickZH=!1,t._hasbgEff=!1,t._hasRewardEff=!1,t._lastType=1,t.posMap=[{pos:[289,376],scale:1,alpha:1,zoder:3},{pos:[494,213],scale:.7,alpha:.7,zoder:2},{pos:[285,112],scale:.7,alpha:.5,zoder:0},{pos:[82,213],scale:.7,alpha:.7,zoder:1}],t.uiBottomScene=new Base2dSceneLayerExt,t.addChildAt(t.uiBottomScene,1),t.uiTopScene=new Base2dSceneLayerExt,t.addChildAt(t.uiTopScene,3),t.btn_left.on(Laya.Event.CLICK,t,t.onLeft),t.btn_right.on(Laya.Event.CLICK,t,t.onRight),t.boxbtn_right.on(Laya.Event.CLICK,t,t.onRight),t.boxbtn_left.on(Laya.Event.CLICK,t,t.onLeft),t.boxbtn_top.on(Laya.Event.CLICK,t,t.onTop),t.btn_shop.on(Laya.Event.CLICK,t,t.onShop),t.btn_kaiqi.on(Laya.Event.CLICK,t,t.onOpen),t.lbXiangqing.on(Laya.Event.CLICK,t,t.onYulan),t}u.GodDoorTabDoor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.goddoor.render.JiangliIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){if(this.dataSource){this.scale(.97,.97);var t=0==this.dataSource.id?4:5;this.lab_miaoshu.text=LanMgr.getLan("{0}星英雄掉落(整卡掉落概率{1}%，碎片掉落概率{2}%)",-1,t,this.dataSource.rato[0],this.dataSource.rato[1]),this.onShow(this.dataSource.list)}},n.prototype.onShow=function(t){var e=new Array;this.img_di.visible=!0;for(var i=0;i<t.length;i++){var n=App.hero.createItemVo(t[i][1],t[i][0]);n.show=!0,n.bag=!0,e.push(n)}this.list_head.dataSource=e;var o=Math.ceil(e.length/5);this.list_head.height=100*o,this.img_di.height=1==o?120*o+20:120*o,this.height=1==o?140*o+50:140*o},n.prototype.onHide=function(){this.img_di.visible=!1,this.img_di.dataSource=null,this.height=100},n.prototype.isShow=function(){return this.img_di.visible},n);function n(){return e.call(this)||this}t.GodDoorJiangliIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.goddoor.JiangliUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this),this.refreshData(),this.bgPanel.dataSource={uiName:UIConst.GodDoor_JiangliView,closeOnSide:this.isModelClose}},n.prototype.initUi=function(){this.JiangliItemList=new common.BagRenderList(530,570),this.JiangliItemList.itemRender=t.GodDoorJiangliIR,this.JiangliItemList.spaceY=3,this.JiangliItemList.x=45,this.JiangliItemList.y=70,this.JiangliItemList.max=100,this.addChild(this.JiangliItemList)},n.prototype.refreshData=function(){var t=tb.TB_divinity_door.get_TB_divinity_doorById(this.dataSource),e=new Array;e.push(t.show_god4),e.push(t.show_god5);for(var i=new Array,n=0;n<e.length;n++)i.push({id:n,list:e[n],rato:t.god_percent.slice(2*n,2*n+2)});this.JiangliItemList.dataSource=i},n.prototype.close=function(){e.prototype.close.call(this),this.bgPanel.dataSource=null,this.JiangliItemList.dataSource=null},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t.initUi(),t}t.GodDoorJiangliView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.goddoor.CurMainUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},n.prototype.init=function(){this.list_tab.selectHandler=Handler.create(this,this.onTab,null,!1),this.onTab(0),this.drawMoney(),this.btn_tishi.on(Laya.Event.CLICK,this,this.tishi),tl3d.ModuleEventManager.addEvent(t.ResEvent.PROP_CHANGE,this.drawMoney,this)},n.prototype.drawMoney=function(){this.lab_jiejingnum.text=Snums(App.hero.godCrystal),this.lab_xingchennum.text=Snums(App.hero.convertDust),this.lab_miyaonum.text=Snums(App.hero.getBagItemNum(CostTypeKey.shenjiemiyao))},n.prototype.close=function(){i.prototype.close.call(this),this.onTab(-1),this.list_tab.selectHandler&&(this.list_tab.selectHandler.recover(),this.list_tab.selectHandler=null),tl3d.ModuleEventManager.removeEvent(t.ResEvent.PROP_CHANGE,this.drawMoney,this)},n.prototype.onTab=function(t){this.list_tab.selectedIndex=t,this.viewStack.selectedIndex=t,common.TabIR3.onSelectCell(this.list_tab.cells,t),0==t?(this.vs_item0.init(),this.vs_item1.close()):1==t?(this.vs_item0.close(),this.vs_item1.init()):(this.vs_item0.close(),this.vs_item1.close())},n.prototype.tishi=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20021))},n.prototype.addBoxMask=function(t){if(void 0===t&&(t=null),!this._hitBoxArea){this._hitBoxArea=this.box_mask.hitArea=new Laya.HitArea;var e=(this.width-Laya.stage.width)/2,i=(this.height-Laya.stage.height)/2;this.box_mask.x=e,this.box_mask.y=i,this.box_mask.width=Laya.stage.width,this.box_mask.height=Laya.stage.height,this._hitBoxArea.hit.drawRect(0,0,this.box_mask.width,this.box_mask.height,"#000000")}this.box_mask.visible=!0,this._hitBoxArea.unHit.clear(),this.box_mask.on(Laya.Event.CLICK,this,this.onClickBoxMask),this._hitBoxMaskCB&&this._hitBoxMaskCB.recover(),this._hitBoxMaskCB=t},n.prototype.onClickBoxMask=function(){this._hitBoxMaskCB&&this._hitBoxMaskCB.run()},n.prototype.addBoxMaskUnit=function(t){t&&this._hitBoxArea&&(this._helpPoint.setTo(0,0),this._helpPoint=t.localToGlobal(this._helpPoint),this._helpPoint=this.box_mask.globalToLocal(this._helpPoint),this._hitBoxArea.unHit.drawRect(this._helpPoint.x,this._helpPoint.y,t.width,t.height,"#000000"))},n.prototype.removeBoxMask=function(){this.box_mask.visible=!1,this._hitBoxArea&&this._hitBoxArea.unHit.clear(),this.box_mask.off(Laya.Event.CLICK,this,this.onClickBoxMask),this._hitBoxMaskCB&&this._hitBoxMaskCB.recover(),this._hitBoxMaskCB=null},n);function n(){var t=i.call(this)||this;return t._helpPoint=new Laya.Point,t.isModelClose=!0,t.group=UIConst.two_group,t.bgPanel.dataSource={uiName:UIConst.GodDoorView,closeOnSide:!1,title:"神界之门"},t.bgPanel.box_Content.addChild(t.viewStack),t.list_tab.dataSource=[{label:"神界之门"},{label:"英雄转换"}],t}t.CurMainView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=tl3d.Processor,__extends(n,t),n.prototype.getName=function(){return"GodDoorProcessor"},n.prototype.listenModuleEvents=function(){return[new e.GodDoorEvent(e.GodDoorEvent.OPEN_SHEN_MEN_VIEW),new e.GodDoorEvent(e.GodDoorEvent.OPEN_DOOR_EVENT),new e.GodDoorEvent(e.GodDoorEvent.TURN_GOD_EVENT),new e.GodDoorEvent(e.GodDoorEvent.TURN_GOD_OK),new common.GlobalEvent(common.GlobalEvent.DIALOG_CLOSED),new e.ResEvent(e.ResEvent.RESOURCE_CHANGE),new e.ResEvent(e.ResEvent.PROP_CHANGE)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.GodDoorEvent)switch(t.type){case e.GodDoorEvent.OPEN_SHEN_MEN_VIEW:this.openView();break;case e.GodDoorEvent.OPEN_DOOR_EVENT:break;case e.GodDoorEvent.TURN_GOD_EVENT:this.turnGodEvent(t.data);break;case e.GodDoorEvent.TURN_GOD_OK:this.turnGodOkEvent(t.data)}if(t instanceof common.GlobalEvent)switch(t.type){case common.GlobalEvent.DIALOG_CLOSED:t.data.name==UIConst.GuaiwuxinxiView&&UIMgr.hasStage(UIConst.GodDoorView)&&this.shenjiezhimen.vs_item1.addMask()}if(t instanceof e.ResEvent)switch(t.type){case e.ResEvent.RESOURCE_CHANGE:case e.ResEvent.PROP_CHANGE:this.coinsChange()}},n.prototype.openView=function(){UIMgr.showUI(UIConst.GodDoorView)},n.prototype.turnGodOkEvent=function(t){var e=this,i={};i[Protocol.game_god_doorConvertSave.args.godId]=t.uuid,PLC.request(Protocol.game_god_doorConvertSave,i,function(t){t&&t.targetGod&&e.shenjiezhimen&&e.shenjiezhimen.vs_item1.refreshResult(t.targetGod)})},n.prototype.turnGodEvent=function(t){for(var e=this,i=100*t.tab_god.race_type+10*t.starLevel+t.tab_god.quality,n=tb.TB_divinity_replace.get_TB_divinity_replaceById(i),o=!0,a=0;a<n.cost.length;a++)if(n.cost[a][0]==iface.tb_prop.resTypeKey.convertDust){if(n.cost[a][1]>App.hero.convertDust){o=!1,showToast(LanMgr.getLan("",10120));break}}else{if(n.cost[a][0]!=iface.tb_prop.resTypeKey.gold){logdebug("新增道具没加判断！"),o=!1;break}if(n.cost[a][1]>App.hero.gold){o=!1,showToast(LanMgr.getLan("",10120));break}}if(o){var r={};r[Protocol.game_god_doorConvert.args.godId]=t.uuid,PLC.request(Protocol.game_god_doorConvert,r,function(t){t&&t.convertTpltId&&e.shenjiezhimen&&e.shenjiezhimen.vs_item1.turnResult(t.convertTpltId)})}},n.prototype.coinsChange=function(){this.shenjiezhimen&&this.shenjiezhimen.drawMoney()},Object.defineProperty(n.prototype,"shenjiezhimen",{get:function(){return UIMgr.getUIByName(UIConst.GodDoorView)},enumerable:!0,configurable:!0}),n);function n(){return t.call(this)||this}e.GodDoorProcessor=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"ShenjiezhimenModule"},n.prototype.listProcessors=function(){return[new t.GodDoorProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.GodDoorModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.OPEN_SHEN_MEN_VIEW="OPEN_SHEN_MEN_VIEW",r.OPEN_DOOR_EVENT="OPEN_DOOR_EVENT",r.TURN_GOD_EVENT="TURN_GOD_EVENT",r.TURN_GOD_OK="TURN_GOD_OK",r.TURN_BUILD_OK="TURN_BUILD_OK",r.KAIQI_SUCCESS="KAIQI_SUCCESS",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.GodDoorEvent=a}(game=game||{}),function(t){var e=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.getGodList=function(t){for(var e=tb.TB_divinity_set.get_TB_divinity_set(),i=App.hero.getGodAry(),n=new Array,o=0;o<i.length;o++){var a=i[o];if(-1!=e.star.indexOf(Number(a.starLevel))){var r=a.tab_god.race_type;(0==t&&r!=iface.tb_prop.godRaceTypeKey.light&&r!=iface.tb_prop.godRaceTypeKey.dark||r==t)&&n.push(a)}}return n},i);function i(){}t.GodDoorModel=e}(game=game||{}),function(t){var e=(i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.requestMyTeamInfo=function(i){var n=this;return void 0===i&&(i=!0),new Promise(function(e,t){App.IsSysOpen(ModuleConst.GOD_DOMAIN)?PLC.request(Protocol.friend_group_getGroupInfo,null,function(t){t&&(n._model.updateTeamInfo(t.myGroup,t.memberList),e())},i):e()})},i.prototype.createTeam=function(){var n=this;return new Promise(function(i,t){PLC.request(Protocol.friend_group_groupCreate,null,function(t){if(t){var e=n._model;e.updateTeamInfo(t.myGroup,t.memberList),e.oneKeyInviteCd=0,i()}})})},i.prototype.leaveTeam=function(){var i=this;return new Promise(function(e,t){PLC.request(Protocol.friend_group_groupExit,null,function(t){t&&(i._model.updateTeamInfo(t.myGroup,t.memberList),e())})})},i.prototype.changePrepareState=function(n,o){return new Promise(function(e,t){var i={};i[Protocol.friend_group_setState.args.state]=o,PLC.request(Protocol.friend_group_setState,i,function(t){t&&(n.isExist()&&(n.svo.readyTime=t.readyTime,n.svo.state=t.setState),e())})})},i.prototype.changeJoinState=function(n){var o=this;return new Promise(function(e,t){var i={};i[Protocol.friend_group_setJoin.args.autoJoin]=n,PLC.request(Protocol.friend_group_setJoin,i,function(t){t&&(o._model.myTeam.autoJoin=t.autoJoin,e())})})},i.prototype.appointCaptain=function(n){var o=this;return new Promise(function(i,t){var e={};e[Protocol.friend_group_groupAppoint.args.playerId]=n.svo.playerId,PLC.request(Protocol.friend_group_groupAppoint,e,function(t){if(t){o._model.myTeam.appointMember(t.appointId);var e=UIMgr.getUIByName(UIConst.GodDm_TeamView);e.updateView(),e.checkState(),i()}})})},i.prototype.kickoutMember=function(n){var o=this;return new Promise(function(e,t){var i={};i[Protocol.friend_group_groupKick.args.playerId]=n.svo.playerId,PLC.request(Protocol.friend_group_groupKick,i,function(t){t&&(o._model.myTeam.removeMember(t.delMemberId),UIMgr.getUIByName(UIConst.GodDm_TeamView).updateView(),e())})})},i.prototype.swapMember=function(n,o){var a=this;return new Promise(function(e,t){var i={};i[Protocol.friend_group_setPos.args.src_pos]=n.pos,i[Protocol.friend_group_setPos.args.dst_pos]=o.pos,PLC.request(Protocol.friend_group_setPos,i,function(t){t&&a._model.myTeam.swapMember(n,o),e()})})},i.prototype.oneKeyInvite=function(){var n=this;return new Promise(function(i,t){PLC.request(Protocol.friend_group_oneKeyInvite,null,function(t){if(t){var e=n._model;e.myTeam.updateData(t.memberList),e.oneKeyInviteCd=t.oneKeyInviteCd,i()}})})},i.prototype.requestTeamList=function(i){var n=this;return void 0===i&&(i=!1),new Promise(function(e,t){i&&0<n._teamRefreshTime&&App.serverTime-n._teamRefreshTime<1e3?showToast(LanMgr.getLan("",11015)):PLC.request(Protocol.friend_group_groupList,null,function(t){t&&(i&&(n._teamRefreshTime=App.serverTime),n._model.setTeamList(t.groupList),e())})})},i.prototype.joinTeam=function(n){var o=this;return new Promise(function(i,t){var e={};e[Protocol.friend_group_groupJoin.args.groupId]=n.svo.groupId,PLC.request(Protocol.friend_group_groupJoin,e,function(t){if(t){var e=o._model;e.updateTeamInfo(t.myGroup,t.memberList),e.hasTeam()?i(!0):i(!1)}else i(!1)})})},i.prototype.requestInviteList=function(i){var n=this;return void 0===i&&(i=!1),new Promise(function(e,t){i&&0<n._inviteRefreshTime&&App.serverTime-n._inviteRefreshTime<1e3?showToast(LanMgr.getLan("",11015)):PLC.request(Protocol.friend_group_inviteList,null,function(t){t&&(i&&(n._inviteRefreshTime=App.serverTime),n._model.setInviteList(t.inviteList),e())})})},i.prototype.inviteFriend=function(o){var a=this;return new Promise(function(e,t){var i=a._model;if(i.myTeam.getMemberByUId(o.svo.playerId))return showToast(LanMgr.getLan("",10383)),void e();if(3<=i.myTeam.getMemberCount())return showToast(LanMgr.getLan("",10384)),void e();var n={};n[Protocol.friend_group_inviteFriend.args.playerId]=o.svo.playerId,PLC.request(Protocol.friend_group_inviteFriend,n,function(t){t&&(o.svo.inviteTime=App.serverTimeSecond,e())})})},i.prototype.showTeamMatchView=function(){var t=this._model.myTeam;t.getMemberCount()<3?showToast(LanMgr.getLan("",10385)):t.isAllReady()?this.startMatch().then(function(){UIMgr.showUI(UIConst.GodDm_TeamMatchView),UIMgr.hasStage(UIConst.GodDm_TeamView)&&UIMgr.getUIByName(UIConst.GodDm_TeamView).stopTimeTick()}):showToast(LanMgr.getLan("",10386))},i.prototype.startMatch=function(){var i=this;return new Promise(function(e,t){PLC.request(Protocol.friend_group_startBattle,null,function(t){t&&(i._model.myTeam.regTime=t.regTime,e())})})},i.prototype.cancelMatch=function(o){var a=this;return new Promise(function(e,t){var i=a._model,n={};n[Protocol.friend_group_cancelReg.args.regTime]=i.myTeam.regTime,PLC.request(Protocol.friend_group_cancelReg,n,function(t){t&&(t.battleReport||(i.myTeam.regTime=0,o.isCaptain()||(o.svo.readyTime=t.readyTime,o.svo.state=t.setState)),e(t))})})},i.prototype.leaveViewAlert=function(){var i=this;return new Promise(function(t,e){UIMgr.hasStage(UIConst.GodDm_TeamView)?common.AlertBox.showAlert({text:LanMgr.getLan("",10481),confirmCb:function(){i.leaveTeam().then(function(){UIMgr.hideUIByName(UIConst.GodDm_TeamView),t()})},parm:null}):t()})},i.prototype.autoMatch=function(){var i=this;return new Promise(function(e,t){PLC.request(Protocol.friend_group_autoJoin,null,function(t){t&&(i._model.matchTime=t.matchTime,e())})})},i.prototype.cancelAutoMatch=function(){var n=this;return new Promise(function(i,t){PLC.request(Protocol.friend_group_cancelJoin,null,function(t){if(t){var e=n._model;e.matchTime=0,t.hasOwnProperty("myGroup")&&e.updateTeamInfo(t.myGroup,t.memberList),i()}})})},i.prototype.showInviteJoinView=function(){PLC.request(Protocol.friend_group_getInviteList,null,function(t){if(t&&!UIMgr.hasStage(UIConst.FightViews)){var e=t.inviteInfo?t.inviteInfo:[];if(0!=e.length){var i=e[e.length-1];if(UIMgr.hasStage(UIConst.GodDm_InviteJoinView)){var n=UIMgr.getUIByName(UIConst.GodDm_InviteJoinView);n.dataSource=i,n.initView()}else UIMgr.showUI(UIConst.GodDm_InviteJoinView,i)}}})},i.prototype.joinInvite=function(n){return new Promise(function(e,t){var i={};i[Protocol.friend_group_acceptInvite.args.playerId]=n,PLC.request(Protocol.friend_group_acceptInvite,i,function(t){t&&e()})})},i.prototype.refuseInvite=function(n){return new Promise(function(e,t){var i={};i[Protocol.friend_group_refuseInvite.args.playerId]=n,PLC.request(Protocol.friend_group_refuseInvite,i,function(t){t&&e()})})},i.prototype.todayRefuseJoin=function(n,o){return new Promise(function(i,t){var e={};e[Protocol.friend_group_setInvite.args.playerId]=n,e[Protocol.friend_group_setInvite.args.state]=o,PLC.request(Protocol.friend_group_setInvite,e,function(t){if(t){var e=t.setInvite[n];i(e)}})})},i.prototype.noticeRefuse=function(){PLC.request(Protocol.friend_group_getRefuseInviteList,null,function(t){if(t)for(var e=0,i=t.refuseInviteList?t.refuseInviteList:[];e<i.length;e++){var n=i[e];showToast(LanMgr.getLan("",10276,n))}})},i);function i(){this._teamRefreshTime=0,this._inviteRefreshTime=0,this._model=t.GodDomainModel.getInstance()}t.GodDmThread=e}(game=game||{}),function(t){var e=(i.prototype.setSvo=function(t){this.svo=t},i);function i(){}t.GodDmTeamListVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=common.RankVo,__extends(n,e),n.prototype.getValueDesc=function(){return"积分"},n.prototype.isShowMid=function(){return!1},n.prototype.getBottom=function(){return this.force},n.prototype.getBottomDesc=function(){return"神力："},n.prototype.isShowBottom=function(){return!0},n);function n(){return null!==e&&e.apply(this,arguments)||this}t.GodDmRankVo=i}(game=game||{}),function(e){var t=(i.prototype.updateData=function(i){function t(e){var t=i.find(function(t){return t.pos==e});r.getMemberByPos(e).updateData(t),t&&t.job==iface.tb_prop.groupJobTypeKey.captain&&(n=t.playerId)}for(var n,e=this.isAllReady(),o=this.getCaptain(),a=o?o.svo.playerId:"",r=this,s=1;s<=3;s++)t(s);this.isChange=a!=n;var u=this.isAllReady();!e&&u?this.autoStartTime=Math.floor(App.serverTimeSecond)+30:e&&!u&&(this.autoStartTime=0),e&&u&&this.isChange&&(this.autoStartTime=Math.floor(App.serverTimeSecond)+30)},i.prototype.clearTeamData=function(){this.rewardAdd=0,this.regTime=0,this.autoStartTime=0,this.autoJoin=iface.tb_prop.groupJoinTypeKey.no;for(var t=0,e=this._memberList;t<e.length;t++)e[t].clearVo()},i.prototype.addMember=function(t){this.getMemberByPos(t.pos).updateData(t)},i.prototype.removeMember=function(e){var t=this._memberList.find(function(t){return t.isExist()&&t.svo.playerId==e});t&&t.clearVo()},i.prototype.swapMember=function(t,e){var i=JSON.parse(JSON.stringify(t.svo)),n=e.isExist()?JSON.parse(JSON.stringify(e.svo)):null;e.updateData(i),t.updateData(n)},i.prototype.appointMember=function(t){var e=this.getCaptain(),i=this.getMemberByUId(t);e&&i&&(e.svo.job=iface.tb_prop.groupJobTypeKey.member,i.svo.job=iface.tb_prop.groupJobTypeKey.captain)},i.prototype.getMemberList=function(){return this._memberList},i.prototype.getMemberByPos=function(e){return this._memberList.find(function(t){return t.pos==e})},i.prototype.getMemberByUId=function(e){return this._memberList.find(function(t){return t.isExist()&&t.svo.playerId==e})},i.prototype.getCaptain=function(){return this._memberList.find(function(t){return t.isCaptain()})},i.prototype.getSelfInfo=function(){return this._memberList.find(function(t){return t.isSelf()})},i.prototype.getMemberCount=function(){for(var t=0,e=0,i=this._memberList;e<i.length;e++)i[e].isExist()&&t++;return t},i.prototype.getMaxReadyTime=function(){for(var t=0,e=0,i=this._memberList;e<i.length;e++){var n=i[e];n.isExist()&&n.svo.readyTime>t&&(t=n.svo.readyTime)}return t},i.prototype.isAllReady=function(){return this._memberList.every(function(t){return t.isReady()})},i.prototype.isAllRealPerson=function(){return this._memberList.every(function(t){return t.isExist()&&!t.isRobot()})},i.prototype.isCaptain=function(){return this.getSelfInfo().isCaptain()},i.prototype.isAutoJoin=function(){return this.autoJoin==iface.tb_prop.groupJoinTypeKey.yes},i.prototype.setBattleMemberInfo=function(t,e,i,n){this.leftInfo=t.map(function(t){return{playerId:t[0],name:t[1],head:t[2]||0,level:t[3]||1,force:t[4]||0,godId:t[5]||0,awakenlv:t[6],skinId:t[7],headFrame:t[8]}}),this.rightInfo=e.map(function(t){return{playerId:t[0],name:t[1],head:t[2]||0,level:t[3]||1,force:t[4]||0,godId:t[5]||0,awakenlv:t[6],skinId:t[7],headFrame:t[8]}}),this.waveResults=i,this.winCamp=n,this._selfcamp=-1,this._fightTeamList=null},i.prototype.getFightTeams=function(t){if(!this._fightTeamList){for(var e=0,i=0,n=0,o=0,a=0,r=this.waveResults[battle.BatteConsts.BATTLE_CAMPATK],s=[[0,0]];o<4&&a<4;)r[e]>n?(n++,o++,i++):(n=0,a++,e++),s.push([e,i]);this._fightTeamList=s}return this._fightTeamList[t]},i.prototype.getSelfCamp=function(){if(-1!=this._selfcamp)return this._selfcamp;var t=this.leftInfo.find(function(t){return t.playerId==App.hero.playerId});return this._selfcamp=battle.BatteConsts.BATTLE_CAMPATK,t||(this._selfcamp=battle.BatteConsts.BATTLE_CAMPDEF),this._selfcamp},i);function i(){this.isChange=!1,this.autoStartTime=0,this._selfcamp=-1,this._memberList=[];for(var t=1;t<=3;t++)this._memberList.push(new e.GodDmMemberVo(t));this.clearTeamData()}e.GodDmMyTeamVo=t}(game=game||{}),function(t){var e=(i.prototype.clearVo=function(){this.svo=null,this.tbgod=null},i.prototype.updateData=function(t){if(t){if(!this.svo)return this.svo=t,void(this.tbgod=tb.TB_god.get_TB_godById(t.godId));for(var e in t)this.svo[e]=t[e];t.hasOwnProperty("guildName")||(this.svo.guildName=null),this.tbgod=tb.TB_god.get_TB_godById(t.godId)}else this.clearVo()},i.prototype.getRewardCnt=function(){return this.isSelf()?App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.godDmRewardNum):this.svo.rewardCount},i.prototype.isExist=function(){return!!this.svo},i.prototype.isRobot=function(){return this.isExist()&&1==this.svo.isRobot},i.prototype.isCaptain=function(){return this.isExist()&&this.svo.job==iface.tb_prop.groupJobTypeKey.captain},i.prototype.isSelf=function(){return this.isExist()&&this.svo.playerId==App.hero.playerId},i.prototype.isReady=function(){return this.isExist()&&(this.isCaptain()||this.svo.state==iface.tb_prop.groupStateTypeKey.yes)},i.prototype.getModel=function(){return t.GodUtils.getShowGodModel(this.tbgod?this.tbgod.ID:0,this.svo.skinId)},i);function i(t){this.pos=t}t.GodDmMemberVo=e}(game=game||{}),function(t){var e=(i.prototype.setSvo=function(t){this.svo=t},i.prototype.isInvite=function(){return this.svo.inviteTime>=App.serverTimeSecond},i);function i(){}t.GodDmInviteVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var i,t=(i=ui.goddomain.TeamMatchUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._model=a.GodDomainModel.getInstance(),this.memberList.renderHandler=new Handler(this,this.itemRender)},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btnCancel.disabled=!1,this.memberList.array=null,this.btnCancel.off(Laya.Event.CLICK,this,this.onCancel),Laya.timer.clearAll(this)},e.prototype.initView=function(){this.memberList.array=this._model.myTeam.getMemberList(),this.btnCancel.on(Laya.Event.CLICK,this,this.onCancel),Laya.timer.loop(2e3,this,this.requestBattle),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime()},e.prototype.requestBattle=function(){var n=this,t={};t[Protocol.friend_group_getBattleInfo.args.regTime]=this._model.myTeam.regTime,PLC.request(Protocol.friend_group_getBattleInfo,t,function(t,e,i){if(!t)return loghgy("获取战报报错 ----",i),void(i==Lans.GroupNotRegTime&&n.toClose());n.doBattle(t)},!1)},e.prototype.doBattle=function(t){Laya.timer.clearAll(this);var e=this._model.myTeam;e.setBattleMemberInfo(t.leftInfo,t.rightInfo,t.waveResults,t.winCamp),e.regTime=0,e.autoStartTime=0,this.btnCancel.disabled=!0;var i=new a.FightVo;i.copyType=CopyType.godDomain,i.godDomainVo=e;var n=new a.ServerPage;n.initPage(t.battleReport.reportData),n.result=1==t.winCamp?playState.VICTORY:playState.FAILURE,i.fightPageControl=n;var o={vo:i,event:new a.GodDomainEvent(a.GodDomainEvent.SHOW_GODDOMAIN_VIEW),responseData:t};dispatchEvt(new a.FightsEvent(a.FightsEvent.ENTER_FIGHT_EVENT),o)},e.prototype.updateTime=function(){var t=this._model.myTeam.regTime,e=Math.ceil(App.serverTimeSecond-t);this.lbTime.text=LanMgr.getLan("",10507,e)},e.prototype.onCancel=function(){var e=this;common.AlertBox.showAlert({text:LanMgr.getLan("",10506),confirmCb:function(){var t=e._model.myTeam.getSelfInfo();a.GodDmThread.getInstance().cancelMatch(t).then(function(t){t.battleReport?e.doBattle(t):e.toClose()})},parm:null,yes:LanMgr.getLan("",10508),no:LanMgr.getLan("",10509)})},e.prototype.toClose=function(){if(this._model.myTeam.autoStartTime=Math.floor(App.serverTimeSecond)+30,UIMgr.hasStage(UIConst.GodDm_TeamView)){var t=UIMgr.getUIByName(UIConst.GodDm_TeamView);t.updateListTick(),t.checkState(),t.updateView()}this.close()},e.prototype.itemRender=function(t,e){var i=t.getChildByName("lbName"),n=t.getChildByName("lbCount"),o=t.dataSource;i.text=o.svo.name,n.text=o.getRewardCnt()+""},e);function e(){var t=i.call(this)||this;return t.isModelClose=!1,t}a.TeamMatchView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.goddomain.TeamListUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.GodDm_TeamListView,closeOnSide:this.isModelClose,closeOnButton:!0,title:"组队信息"},this.btnRefresh.on(Laya.Event.CLICK,this,this.onRefresh),this.btnCreate.on(Laya.Event.CLICK,this,this.onCreate)},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.teamList.array=null,Laya.timer.clearAll(this)},n.prototype.initView=function(){this.updateView(),Laya.timer.loop(1e4,this,this.onRefresh)},n.prototype.updateView=function(){var t=e.GodDomainModel.getInstance().getTeamList();this.teamList.array=t,this.lbEmpty.visible=t.length<=0},n.prototype.onRefresh=function(){var t=this;e.GodDmThread.getInstance().requestTeamList(!0).then(function(){t.updateView()})},n.prototype.onCreate=function(){dispatchEvt(new e.GodDomainEvent(e.GodDomainEvent.CREATE_TEAM_VIEW))},n);function n(){return i.call(this)||this}e.TeamListView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.goddomain.render.TeamIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.lbTeam.text=t.svo.name,this.lbGuild.text=t.svo.guildName?t.svo.guildName:LanMgr.getLan("",12084),this.lbCount.text=t.svo.memberNum+"",this.lbForce.text=t.svo.force+"",this.headBox.dataSource=new UserHeadVo(t.svo.head,t.svo.level,t.svo.headFrame),this.btnJoin.on(Laya.Event.CLICK,this,this.onJoin)):(this.headBox.dataSource=null,this.btnJoin.off(Laya.Event.CLICK,this,this.onJoin))},n.prototype.onJoin=function(){dispatchEvt(new t.GodDomainEvent(t.GodDomainEvent.JOIN_TEAM),this.dataSource)},n);function n(){return e.call(this)||this}t.GodDmTeamIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.goddomain.render.MemberIRUI,__extends(n,i),n.prototype.initData=function(){this.parent.addChild(this.imgChat),this.imgChat.visible=!1},Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.lbPos.text=t.pos+"",this.uiScene.onShow(),t.isExist()?(this.imgDi.visible=this.imgDesc.visible=this.boxForce.visible=this.lbGuild.visible=this.lbName.visible=!0,this.btnInvite.visible=!1,this.lbName.text=t.svo.name,this.lbGuild.text=LanMgr.getLan("",12560,t.svo.guildName?t.svo.guildName:LanMgr.getLan("",12084)),this.lbForce.text=t.svo.force+"",this.lbForce.event(Laya.Event.RESIZE),this.imgDesc.skin=t.isCaptain()?SkinUtil.izsy_di13:SkinUtil.izsy_di14,this.imgDesc.width=t.isCaptain()?80:t.isReady()?120:100,this.lbDesc.text=t.isCaptain()?LanMgr.getLan("",12329):t.isReady()?LanMgr.getLan("",12327):LanMgr.getLan("",12328),this._modelId!=t.getModel()&&(this._modelId=t.getModel(),Laya.timer.clear(this,this.delayShow),Laya.timer.once(200,this,this.delayShow,[this._modelId]))):(this.imgDi.visible=this.imgDesc.visible=this.boxForce.visible=this.lbGuild.visible=this.lbName.visible=!1,this.btnInvite.visible=!0,Laya.timer.clearAll(this),this.uiScene.onExit(),this._modelId=0,this.imgChat.visible=!1),this.btnInvite.on(Laya.Event.CLICK,this,this.onInvite)):(Laya.timer.clearAll(this),this.uiScene.onExit(),this._modelId=0,this.imgChat.visible=!1,this.btnInvite.off(Laya.Event.CLICK,this,this.onInvite))},n.prototype.addChat=function(t){this.htmlText.innerHTML=t.getContent(),this.imgChat.height=this.htmlText.y+this.htmlText.contextHeight+50,this.imgChat.x=this.uiPos.x+(this.width>>1)-25,this.imgChat.y=this.uiPos.y-this.imgChat.height,this.parent.setChildIndex(this.imgChat,this.parent.numChildren-1),this.imgChat.visible=!0,Laya.timer.clear(this,this.clearChat),Laya.timer.once(1e4,this,this.clearChat)},n.prototype.clearChat=function(){Laya.timer.clear(this,this.clearChat),this.imgChat.visible=!1,this.htmlText.innerHTML=""},n.prototype.startMove=function(){Laya.timer.clear(this,this.updatePosition),Laya.timer.frameLoop(2,this,this.updatePosition)},n.prototype.updatePosition=function(){if(this.uiScene.sceneChar){var t=this.lbName.localToGlobal(new Laya.Point(0,0));this.uiScene.sceneChar.set2dPos(t.x+this.lbName.width/2-Launch.offsetX,t.y+10-Launch.offsetY)}},n.prototype.stopMove=function(){Laya.timer.clear(this,this.updatePosition),this.pos(this.uiPos.x,this.uiPos.y),this.updatePosition()},n.prototype.onInvite=function(){var t=this.dataSource;t&&!t.isExist()&&dispatchEvt(new e.GodDomainEvent(e.GodDomainEvent.SHOW_INVITE_VIEW),this.dataSource)},n.prototype.delayShow=function(t){var e=this.lbName.localToGlobal(new Laya.Point(0,0));this.uiScene.addModelChar(t,e.x+this.lbName.width/2-Launch.offsetX,e.y+10-Launch.offsetY,180,2),this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_02,2)},n.prototype.isInInitArea=function(t,e){return t>=this.uiPos.x&&t<=this.uiPos.x+this.width&&e>=this.uiPos.y&&e<=this.uiPos.y+this.height},n);function n(){var t=i.call(this)||this;return t._modelId=0,t.uiScene=new Base2dSceneLayer,t.boxRole.addChild(t.uiScene),t.htmlText.style.fontSize=22,t.htmlText.style.wordWrap=!0,t.htmlText.style.color="#7e5336",t}e.GodDmMemberIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.goddomain.render.InviteIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.lbName.text=t.svo.name,this.lbGuild.text=t.svo.guildName?t.svo.guildName:LanMgr.getLan("",12084),this.lbForce.text=t.svo.force+"";var e=t.isInvite();this.btnInvite.label=e?LanMgr.getLan("",12330):LanMgr.getLan("",12331),this.btnInvite.disabled=e,this.btnInvite.on(Laya.Event.CLICK,this,this.onInvite),this.headBox.dataSource=new UserHeadVo(t.svo.head,t.svo.level,t.svo.headFrame)}else this.headBox.dataSource=null,this.btnInvite.off(Laya.Event.CLICK,this,this.onInvite)},n.prototype.onInvite=function(){var t=this;e.GodDmThread.getInstance().inviteFriend(this.dataSource).then(function(){t.refreshData()})},n);function n(){return t.call(this)||this}e.GodDmInviteIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.goddomain.render.DuizhanIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.ui_head.dataSource=new UserHeadVo(t.head,t.level,t.headFrame),this.ui_head.gray=0==t.state,this.img_bg.visible=2!=t.state,this.lab_name.text=t.name,this.img_bg.visible&&(this.img_bg.skin=SkinUtil.getChuzhanIcon(t.state),this.lab_info.text=0==t.state?LanMgr.getLan("",12332):LanMgr.getLan("",12333))):this.ui_head.dataSource=null},n);function n(){return e.call(this)||this}t.GodDmDuizhanIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.goddomain.MemberMenuUI,__extends(i,e),i.prototype.show=function(t){this.dataSource=t,this.x=t.point.x,this.y=t.point.y,this.visible=!0,this.parent.setChildIndex(this,this.parent.numChildren-1),this.btnChange.on(Laya.Event.CLICK,this,this.onClick),this.btnOut.on(Laya.Event.CLICK,this,this.onClick),this.btnShow.on(Laya.Event.CLICK,this,this.onClick)},i.prototype.onClosed=function(){this.visible=!1,this.btnChange.off(Laya.Event.CLICK,this,this.onClick),this.btnOut.off(Laya.Event.CLICK,this,this.onClick),this.btnShow.off(Laya.Event.CLICK,this,this.onClick)},i.prototype.onClick=function(t){var e=this,i=t.target,n=this.dataSource.info;if(n&&n.isExist()){var o=a.GodDmThread.getInstance();i==this.btnChange?o.appointCaptain(n).then(function(){e.onClosed()}):i==this.btnOut?o.kickoutMember(n).then(function(){e.onClosed()}):i==this.btnShow&&(dispatchEvt(new a.GodDomainEvent(a.GodDomainEvent.SHOW_PLAYER_INFO),n),this.onClosed())}else showToast(LanMgr.getLan("",10382))},i.prototype.checkExist=function(){var t=this.dataSource;t&&t.info&&t.info.isExist()||this.onClosed()},i);function i(){var t=e.call(this)||this;return t.visible=!1,t}a.MemberMenuView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.goddomain.InviteJoinUI,__extends(e,n),e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),Laya.timer.clearAll(this),this.btnYes.off(Laya.Event.CLICK,this,this.onYes),this.btnNo.off(Laya.Event.CLICK,this,this.onNot),this.checkBox.off(Laya.Event.CHANGE,this,this.onChange)},e.prototype.initView=function(){this.checkBox.selected=!1,this._cd=tb.TB_fight_goddomain_set.getSet().invite_time;var t=this.dataSource;this.lab_title.text="激战神域邀请",this.lbContent.text="你的好友"+t.name+"邀请你组队，一起激战神域，是否要加入？",Laya.timer.loop(1e3,this,this.updateTime),this.updateTime(),this.btnYes.on(Laya.Event.CLICK,this,this.onYes),this.btnNo.on(Laya.Event.CLICK,this,this.onNot),this.checkBox.on(Laya.Event.CHANGE,this,this.onChange)},e.prototype.updateTime=function(){if(this._cd<=0)return Laya.timer.clear(this,this.updateTime),void this.close();this.lbTime.text="倒计时："+this._cd+"秒",this._cd--},e.prototype.onYes=function(){var t=this,e=this.dataSource;this._thread.joinInvite(e.playerId).then(function(){t.close(),dispatchEvt(new i.GodDomainEvent(i.GodDomainEvent.SHOW_GODDOMAIN_VIEW))})},e.prototype.onNot=function(){var t=this,e=this.dataSource;this._thread.refuseInvite(e.playerId).then(function(){t.close()})},e.prototype.onChange=function(){var e=this,t=this.dataSource,i=this.checkBox.selected?iface.tb_prop.groupInviteTypeKey.no:iface.tb_prop.groupInviteTypeKey.yes;this._thread.todayRefuseJoin(t.playerId,i).then(function(t){e.checkBox.selected=t==iface.tb_prop.groupInviteTypeKey.no})},e);function e(){var t=n.call(this)||this;return t.isModelClose=!1,t._thread=i.GodDmThread.getInstance(),t}i.InviteJoinView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.goddomain.GodDomainUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.group=UIConst.hud_group,this._model=n.GodDomainModel.getInstance(),this.uiScene=new Base2dSceneLayer,this.boxContent.addChild(this.uiScene),this.uiScene.setModelBox(this.roleBox,this.lbCoin,this.lbName),this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.GOD_DOMAIN),this.btnAdd.on(Laya.Event.CLICK,this,this.onAdd),this.btnCreate.on(Laya.Event.CLICK,this,this.onTeam),this.btnMatch.on(Laya.Event.CLICK,this,this.onMatch)},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.uiScene.onExit(),Laya.timer.clear(this,this.delayShow),this.rewardList.array=null,tl3d.ModuleEventManager.removeEvent(n.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateRewardCount,this),tl3d.ModuleEventManager.removeEvent(n.GodEvent.BUZHEN_COMPLETE,this.delayShow,this),tl3d.ModuleEventManager.removeEvent(n.ResEvent.RESOURCE_CHANGE,this.updateCoin,this),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_shop,callback:this.onShop.bind(this)},{btnSkin:SkinUtil.btn_buzhen,callback:this.onBuzhen.bind(this)},{btnSkin:SkinUtil.btn_rank,callback:this.onRank.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.godDomain];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onFanHui.bind(this)}),this.updateName(),this.updateForce(),this.lbTime.text=this._model.doubleTimeStr;var i=tb.TB_fight_goddomain_set.getSet().getWinReward();this.rewardList.array=i,this.rewardList.width=90*i.length+(i.length-1)*this.rewardList.spaceX,this.uiScene.onShow(),Laya.timer.once(200,this,this.delayShow),tl3d.ModuleEventManager.addEvent(n.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateRewardCount,this),tl3d.ModuleEventManager.addEvent(n.GodEvent.BUZHEN_COMPLETE,this.delayShow,this),this.updateRewardCount(),tl3d.ModuleEventManager.addEvent(n.ResEvent.RESOURCE_CHANGE,this.updateCoin,this),this.updateCoin()},e.prototype.updateName=function(){this.lbName.text=App.hero.name},e.prototype.updateForce=function(){this.lbForce.value=App.hero.force+"",this.lbForce.event(Laya.Event.RESIZE)},e.prototype.updateCoin=function(){this.lbScore.text="神域积分："+n.GodDomainModel.getInstance().score,this.lbCoin.text="神域币："+App.hero.godDomain},e.prototype.updateRewardCount=function(){this.lbCount.text="奖励次数："+App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.godDmRewardNum)+"次"},e.prototype.onAdd=function(){dispatchEvt(new n.GodDomainEvent(n.GodDomainEvent.SHOW_BUY_VIEW))},e.prototype.onMatch=function(){dispatchEvt(new n.GodDomainEvent(n.GodDomainEvent.SHOW_AUTO_MATCH_VIEW))},e.prototype.onRule=function(t){dispatchEvt(new n.GodDomainEvent(n.GodDomainEvent.SHOW_RULE_VIEW))},e.prototype.onFanHui=function(){dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_KUAFU))},e.prototype.delayShow=function(){var t=n.GodUtils.getShowGodModel(App.hero.showGodId,App.hero.showSkinId),e=this.lbName.localToGlobal(new Laya.Point(0,0));this.uiScene.addModelChar(t,e.x+this.lbName.width/2-Launch.offsetX,e.y-20-Launch.offsetY,180,2.5),this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_02,2)},e.prototype.onRank=function(t){dispatchEvt(new n.GodDomainEvent(n.GodDomainEvent.SHOW_RANK_VIEW))},e.prototype.onShop=function(){dispatchEvt(new n.GodDomainEvent(n.GodDomainEvent.SHOW_SHOP_VIEW))},e.prototype.onBuzhen=function(){dispatchEvt(new n.GodEvent(n.GodEvent.SHOW_BUZHEN_PANEL),iface.tb_prop.lineupTypeKey.attack)},e.prototype.onTeam=function(){dispatchEvt(new n.GodDomainEvent(n.GodDomainEvent.SHOW_TEAM_LIST))},e);function e(){return i.call(this)||this}n.GodDomainView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var a,t=(a=ui.goddomain.TeamUI,__extends(e,a),e.prototype.createChildren=function(){a.prototype.createChildren.call(this),this._thread=s.GodDmThread.getInstance(),this._model=s.GodDomainModel.getInstance(),this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.GOD_DOMAIN)},e.prototype.setSize=function(t,e){a.prototype.setSize.call(this,t,e),this.item_0.y=this.item_1.y=this.item_2.y=(e-this.item_0.height)/2+40,this._memberItems=[this.item_0,this.item_1,this.item_2];for(var i=0,n=this._memberItems;i<n.length;i++){var o=n[i];o.uiPos=new Laya.Point(o.x,o.y),o.initData()}},e.prototype.show=function(t,e){a.prototype.show.call(this,t,e),this.initView()},e.prototype.onClosed=function(){a.prototype.onClosed.call(this),Laya.timer.clearAll(this),this.menuUI.onClosed(),tl3d.ModuleEventManager.removeEvent(s.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateRewardCount,this),tl3d.ModuleEventManager.removeEvent(s.ResEvent.RESOURCE_CHANGE,this.updateCoin,this),this.btnAdd.off(Laya.Event.CLICK,this,this.onClick),this.btnBonus.off(Laya.Event.CLICK,this,this.onClick),this.btnChat.off(Laya.Event.CLICK,this,this.onClick),this.btnFight.off(Laya.Event.CLICK,this,this.onOperation),this.btnInvite.off(Laya.Event.CLICK,this,this.onClick),this.btnLeave.off(Laya.Event.CLICK,this,this.onClick),this.checkBox.off(Laya.Event.CHANGE,this,this.onChange),this.clearMemberList(),s.ChatThread.getInstance().stopRequest(),UIMgr.hideUIByName(UIConst.ChatView),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_shop,callback:this.onShop.bind(this)},{btnSkin:SkinUtil.btn_buzhen,callback:this.onBuzhen.bind(this)},{btnSkin:SkinUtil.btn_rank,callback:this.onRank.bind(this)},{btnSkin:SkinUtil.btn_team,callback:this.onTeam.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.godDomain];if(UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onLeave.bind(this)}),this.clearMemberList(),this._model.myTeam.isCaptain())for(var i=0,n=this._memberItems;i<n.length;i++)(r=n[i]).on(Laya.Event.CLICK,this,this.onItemClick),r.on(Laya.Event.MOUSE_UP,this,this.onItemClick),r.on(Laya.Event.MOUSE_DOWN,this,this.onItemClick),r.on(Laya.Event.MOUSE_OUT,this,this.onItemClick),r.on(Laya.Event.MOUSE_MOVE,this,this.onItemClick);else for(var o=0,a=this._memberItems;o<a.length;o++){var r;(r=a[o]).on(Laya.Event.CLICK,this,this.onItemClick)}this.menuUI.onClosed(),this.updateView(),this.checkState(),this.updateRewardCount(),this.updateListTick(),this.btnAdd.on(Laya.Event.CLICK,this,this.onClick),this.btnBonus.on(Laya.Event.CLICK,this,this.onClick),this.btnChat.on(Laya.Event.CLICK,this,this.onClick),this.btnFight.on(Laya.Event.CLICK,this,this.onOperation),this.btnInvite.on(Laya.Event.CLICK,this,this.onClick),this.btnLeave.on(Laya.Event.CLICK,this,this.onClick),this.checkBox.on(Laya.Event.CHANGE,this,this.onChange),tl3d.ModuleEventManager.addEvent(s.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateRewardCount,this),s.ChatThread.getInstance().startAutoRequest(iface.tb_prop.chatChannelTypeKey.all),tl3d.ModuleEventManager.addEvent(s.ResEvent.RESOURCE_CHANGE,this.updateCoin,this),this.updateCoin()},e.prototype.updateView=function(){for(var t=this._model.myTeam,e=t.getMemberList(),i=0;i<3;i++)this._memberItems[i].dataSource=e[i];var n=t.isCaptain();this.lbBonus.text=LanMgr.getLan("",12323,t.rewardAdd-100),this.checkBox.visible=n,this.checkBox.selected=t.isAutoJoin(),this.btnInvite.visible=n},e.prototype.checkState=function(){var t=this._model.myTeam.getSelfInfo(),e=t.isCaptain();this.btnFight.label=e?LanMgr.getLan("",12320):t.isReady()?LanMgr.getLan("",12321):LanMgr.getLan("",12322),this.updateTimeTick()},e.prototype.updateCoin=function(){this.lbScore.text="神域积分："+this._model.score,this.lbCoin.text="神域币："+App.hero.godDomain},e.prototype.updateListTick=function(t){void 0===t&&(t=3e3),Laya.timer.clear(this,this.intervalRefresh),Laya.timer.loop(t,this,this.intervalRefresh)},e.prototype.intervalRefresh=function(){var e=this;this._thread.requestMyTeamInfo(!1).then(function(){if(UIMgr.hasStage(UIConst.GodDm_TeamView))if(e._model.hasTeam()){var t=e._model.myTeam;0<t.regTime?(Laya.timer.clear(e,e.intervalRefresh),UIMgr.showUI(UIConst.GodDm_TeamMatchView)):(e.updateView(),(t.isChange||0<t.autoStartTime)&&e.checkState(),e.menuUI.checkExist())}else showToast(LanMgr.getLan("",10381)),UIMgr.showUI(UIConst.GodDomainView)})},e.prototype.updateTimeTick=function(){Laya.timer.clear(this,this.updateAutoTime),Laya.timer.loop(1e3,this,this.updateAutoTime),this.updateAutoTime()},e.prototype.stopTimeTick=function(){this.lbPrompt.text=LanMgr.getLan("",10483),Laya.timer.clear(this,this.updateAutoTime)},e.prototype.updateAutoTime=function(){var t,e=this,i=this._model.myTeam,n=i.getSelfInfo();n.isCaptain()?(this.lbPrompt.visible=!0,i.isAllReady()&&0<i.autoStartTime?0<(t=Math.ceil(i.autoStartTime-App.serverTimeSecond))?this.lbPrompt.text=LanMgr.getLan("",12319,t):(Laya.timer.clear(this,this.updateAutoTime),this.lbPrompt.text=LanMgr.getLan("",12318),dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.START_BATTLE),!0)):(Laya.timer.clear(this,this.updateAutoTime),this.lbPrompt.text=LanMgr.getLan("",12318))):n.isReady()?(Laya.timer.clear(this,this.updateAutoTime),this.lbPrompt.visible=!1):(this.lbPrompt.visible=!0,0<(t=Math.ceil(n.svo.readyTime-App.serverTimeSecond))?this.lbPrompt.text=LanMgr.getLan("",12317,t):(Laya.timer.clear(this,this.updateAutoTime),this.lbPrompt.text=LanMgr.getLan("",12317,0),this._thread.changePrepareState(n,iface.tb_prop.groupStateTypeKey.yes).then(function(){e.checkState(),e.lbPrompt.visible=!n.isReady()})))},e.prototype.onItemClick=function(t){var e=this,i=t.currentTarget,n=i.dataSource;if(n&&n.isExist())if(t.type==Laya.Event.MOUSE_DOWN)this._clickPoint=new Laya.Point(t.stageX,t.stageY),this.setChildIndex(i,this.numChildren-1),i.startDrag(new Laya.Rectangle(0,0,Laya.stage.width-200,Laya.stage.height-470)),i.startMove();else if(t.type==Laya.Event.MOUSE_UP){if(i.stopDrag(),this._clickPoint&&this._clickPoint.x==t.stageX&&this._clickPoint.y==t.stageY)return;var o=this._memberItems.find(function(t){return t.isInInitArea(i.x+100,i.y+195)});o&&o!=i?this._thread.swapMember(n,o.dataSource).then(function(t){i.stopMove(),e.updateView()}):i.stopMove()}else if(t.type==Laya.Event.MOUSE_OUT)i.stopDrag(),i.stopMove();else if(t.type==Laya.Event.MOUSE_MOVE)this.menuUI.onClosed(),i.clearChat();else if(t.type==Laya.Event.CLICK){if(n.isSelf())return void this.menuUI.onClosed();if(this._clickPoint&&(this._clickPoint.x!=t.stageX||this._clickPoint.y!=t.stageY))return void this.menuUI.onClosed();this._model.myTeam.getSelfInfo().isCaptain()?this.menuUI.show({point:new Laya.Point(t.stageX,t.stageY),info:n}):dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.SHOW_PLAYER_INFO),n)}},e.prototype.updateRewardCount=function(){this.lbCount.text="奖励次数："+App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.godDmRewardNum)+"次"},e.prototype.onClick=function(t){var e=t.target;e==this.btnAdd?dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.SHOW_BUY_VIEW)):e==this.btnBonus?dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.SHOW_BONUS_RULE)):e==this.btnChat?dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.SHOW_CHAT_VIEW)):e==this.btnInvite?dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.ONEKEY_INVITE)):e==this.btnLeave&&dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.LEAVE_TEAM))},e.prototype.onOperation=function(){var t=this,e=this._model.myTeam.getSelfInfo();if(e.isCaptain())dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.START_BATTLE));else{var i=this._thread,n=e.svo.state==iface.tb_prop.groupStateTypeKey.yes?iface.tb_prop.groupStateTypeKey.no:iface.tb_prop.groupStateTypeKey.yes;n==iface.tb_prop.groupStateTypeKey.yes?App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.godDmRewardNum)<=0?common.AlertBox.showAlert({text:LanMgr.getLan("",10505),confirmCb:function(){i.changePrepareState(e,n).then(function(){t.checkState(),t.refreshMemberItem(App.hero.playerId)})},parm:null}):i.changePrepareState(e,n).then(function(){t.checkState(),t.refreshMemberItem(App.hero.playerId)}):i.changePrepareState(e,n).then(function(){t.checkState()})}},e.prototype.refreshMemberItem=function(e){var t=this._memberItems.find(function(t){return t.dataSource&&t.dataSource.isExist()&&t.dataSource.svo.playerId==e});t&&t.refreshData()},e.prototype.onChange=function(){var t=this;if(this._model.myTeam.getSelfInfo().isCaptain()&&this.checkBox.visible){var e=this.checkBox.selected?iface.tb_prop.groupJoinTypeKey.yes:iface.tb_prop.groupJoinTypeKey.no;this._thread.changeJoinState(e).then(function(){t.checkBox.selected=t._model.myTeam.isAutoJoin()})}},e.prototype.addNewChats=function(t){if(t&&0!=t.length){function e(e){var t=i._memberItems.find(function(t){return t.dataSource&&t.dataSource.isExist()&&t.dataSource.svo.playerId==e.svo.senderId});t&&t.addChat(e)}for(var i=this,n=0,o=t;n<o.length;n++)e(o[n])}},e.prototype.clearMemberList=function(){for(var t=0,e=this._memberItems;t<e.length;t++){var i=e[t];i.off(Laya.Event.MOUSE_UP,this,this.onItemClick),i.off(Laya.Event.MOUSE_DOWN,this,this.onItemClick),i.off(Laya.Event.MOUSE_OUT,this,this.onItemClick),i.off(Laya.Event.MOUSE_MOVE,this,this.onItemClick),i.off(Laya.Event.CLICK,this,this.onItemClick),i.dataSource=null}},e.prototype.onRank=function(t){dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.SHOW_RANK_VIEW))},e.prototype.onShop=function(){dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.SHOW_SHOP_VIEW))},e.prototype.onBuzhen=function(){dispatchEvt(new s.GodEvent(s.GodEvent.SHOW_BUZHEN_PANEL),iface.tb_prop.lineupTypeKey.attack)},e.prototype.onTeam=function(){dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.SHOW_TEAM_LIST))},e.prototype.onLeave=function(){dispatchEvt(new s.GodDomainEvent(s.GodDomainEvent.LEAVE_TEAM))},e);function e(){var t=a.call(this)||this;return t.group=UIConst.hud_group,t}s.GodDmTeamView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.goddomain.RankViewUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12324)},this.tabBar.selectHandler=Handler.create(this,this.onSelected,null,!1)},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.tabBar.selectedIndex=-1,this.rankList.array=null,this._rankList=null},e.prototype.initView=function(){this.tabBar.selectedIndex=0},e.prototype.onSelected=function(t){var e=this;-1!=t&&(0==(this.viewStack.selectedIndex=t)?this._rankList?this.setRankList():(this._rankList=[],this.rankList.array=null,this.lab_empty.visible=!this.rankList.array||0==this.rankList.array.length,GameUtil.requestRankList(iface.tb_prop.rankTypeKey.godDmLocal,i.GodDmRankVo).then(function(t){e._rankList=t.rankList,e._rank=t.myRank,e.setRankList()})):(this.rewardList.array=tb.TB_fight_goddomain_reward.getItemList(),this.lab_empty.visible=!1))},e.prototype.setRankList=function(){0==this.tabBar.selectedIndex&&(this.rankList.array=this._rankList,this.rankList.scrollTo(0),this.lbScore.text=i.GodDomainModel.getInstance().score+"",this.lbRank.text=0==this._rank?LanMgr.getLan("",12187):this._rank+"",this.lbScore.event(Laya.Event.RESIZE),this.lbRank.event(Laya.Event.RESIZE),this.lab_empty.visible=!this.rankList.array||0==this.rankList.array.length)},e);function e(){var t=n.call(this)||this;return t._rank=0,t}i.GodDmRankView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.goddomain.InviteListUI,__extends(n,i),n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),Laya.timer.clearAll(this),this.teamList.array=null,this.btnRefresh.off(Laya.Event.CLICK,this,this.onRefresh)},n.prototype.initView=function(){this.updateView(),this.btnRefresh.on(Laya.Event.CLICK,this,this.onRefresh),Laya.timer.loop(1e4,this,this.onRefresh)},n.prototype.updateView=function(){var t=e.GodDomainModel.getInstance().getInviteList();this.teamList.array=t,this.lbEmpty.visible=t.length<=0},n.prototype.onRefresh=function(){var t=this;e.GodDmThread.getInstance().requestInviteList(!0).then(function(){t.updateView()})},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.GodDm_InviteView,closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12325)},t}e.GodDmInviteView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var i,t=(i=ui.goddomain.fightStartUI,__extends(e,i),e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.drawData(),this.refresh()},e.prototype.drawData=function(){logfight("过场-----",this.dataSource);var t=this.dataSource.vo;if(t){var e=t.teams;if(e){var i=t.selfCamp==battle.BatteConsts.BATTLE_CAMPATK,n=i?e[0]:e[1],o=i?e[1]:e[0],a=i?t.leftInfo:t.rightInfo,r=i?t.rightInfo:t.leftInfo;this.img_01.skin=i?"jizhanshengyu/difang_bj.png":"jizhanshengyu/wofang_bj1.png",this.img_02.skin=i?"jizhanshengyu/wofang_bj.png":"jizhanshengyu/difang_bj1.png",this.cloneInfo(a,n),this.cloneInfo(r,o);var s=a[n],u=r[o];this.ui_head_left.dataSource=new UserHeadVo(s.head,s.level,s.headFrame),this.lab_name_left.text=s.name,this.lab_power_left.text=s.force+"",this.ui_head_right.dataSource=new UserHeadVo(u.head,u.level,u.headFrame),this.lab_name_right.text=u.name,this.lab_power_right.text=u.force+"",this.leftModel=h.GodUtils.getShowGodModel(s.godId,s.skinId),this.rightModel=h.GodUtils.getShowGodModel(u.godId,u.skinId),this.list_left.dataSource=a,this.list_right.dataSource=r}}},e.prototype.cloneInfo=function(t,e){for(var i=0;i<t.length;i++)t[i].state=i==e?1:i<e?0:2},e.prototype.close=function(){i.prototype.close.call(this),this.uiScene.onExit()},e.prototype.initView=function(){this.ani1.on(Laya.UIEvent.COMPLETE,this,this.onComplete1),this.ani2.on(Laya.UIEvent.COMPLETE,this,this.onComplete2)},e.prototype.refresh=function(){this.dataSource.optType==startOptState.START?(this.img_vs.visible=!1,this.ani2.play(0,!1)):this.dataSource.optType==startOptState.GUOCHANGCOMPLETE?(this.img_vs.visible=!0,this.ani1.play(0,!1)):this.dataSource.optType==startOptState.GUOCHANG&&(this.img_vs.visible=!1,this.ani2.play(0,!1))},e.prototype.onComplete1=function(){this.ani1.off(Laya.UIEvent.COMPLETE,this,this.onComplete1),this.onExit()},e.prototype.onComplete2=function(){var t=this;this.ani2.off(Laya.UIEvent.COMPLETE,this,this.onComplete2),this.uiScene.addModelChar(String(this.leftModel),160,950,180,2.2),this.uiScene.addModelChar(String(this.rightModel),560,550,180,2.2),Laya.timer.frameOnce(3,this,function(){t.dataSource.optType==startOptState.START?(t.img_vs.visible=!0,t.ani1.play(0,!1)):t.dataSource&&t.dataSource.cb&&t.dataSource.cb()})},e.prototype.onExit=function(){var t=this;setTimeout(function(){t.dataSource&&t.dataSource.cb&&t.dataSource.cb(),t.close()},1e3)},e);function e(){var t=i.call(this)||this;return t.isModelClose=!1,t.uiScene=new Base2dSceneLayerExt,t.addChild(t.uiScene),t}h.GodDmFightStart=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(p){var o,t=(o=ui.goddomain.BattleSettlementUI,__extends(e,o),e.prototype.popup=function(t,e){var i=this,n=this.dataSource.type==playState.VICTORY;n?this.bgPanel.showTitle(!0,"zhandoubiaoxian/shengli.png",!0,!0,!0,null,this):this.bgPanel.showTitle(!1,"zhandoubiaoxian/shibai.png",!1,!0,!1,null,this),this.bgPanel.height=n?541:726,this.height=n?525:710,this.closeByBlank.y=n?540:723,this.channel.visible=this.imgForce.visible=!1,o.prototype.popup.call(this,t,!1),this.initView(),this.channel.callback=function(){i.close()},this.bgPanel.bg.height=this.height-this.bgPanel.bg.y},e.prototype.createChildren=function(){o.prototype.createChildren.call(this),this.rewardList.renderHandler=new Handler(this,this.itemRender)},e.prototype.initView=function(){var t=this.dataSource,e=t.copyVo;t.type,playState.VICTORY,this.lbCount.text="奖励次数："+App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.godDmRewardNum)+"次";var i=e.responseData;if(i){this.rewardList.array=i.itemData;var n=i.mvpInfo;this.headBox.dataSource=new UserHeadVo(n.head,n.level,n.headFrame),this.lbMVP.text=n.name,this.lbForce.value=n.force+"";var o=i.scoreInfo[0]-i.scoreInfo[1];this.lbScore.text="神域积分："+o+" +"+i.scoreInfo[1],this.lbScore.y=this.rewardList.y+42*i.itemData.length+10,this.lbCount.y=this.lbScore.y+40,this.channel.visible?(this.imgForce.y=this.lbCount.y+34,this.channel.y=this.imgForce.y+33,this.height=this.bgPanel.height=this.channel.y+this.channel.height+40):this.height=this.bgPanel.height=this.lbCount.y+60}else this.rewardList.array=null,this.headBox.dataSource=null,this.lbMVP.text=this.lbForce.value=this.lbScore.text=""},e.prototype.itemRender=function(t,e){var i=t.dataSource,n=t.getChildByName("imgRes"),o=t.getChildByName("lbValue"),a=t.getChildByName("lbExtral");if(i){var r=Number(i[0]),s=tb.TB_item.get_TB_itemById(r),u=i[1],h=s.ID==iface.tb_prop.resTypeKey.godDomain?p.GodDomainModel.getInstance().myTeam.rewardAdd/100:1,l=Math.round(u/h),c=u-l;o.text="+"+l,a.text=0<c?"+"+c+"("+LanMgr.getLan("",12326,p.GodDomainModel.getInstance().myTeam.rewardAdd-100)+")":"",o.event(Laya.Event.RESIZE),a.event(Laya.Event.RESIZE),n.skin=SkinUtil.getCostSkin(s.ID)}},e.prototype.onClosed=function(){o.prototype.onClosed.call(this),this.rewardList.array=null},e.prototype.close=function(){dispatchEvt(new p.FightsEvent(p.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource.copyVo),o.prototype.close.call(this)},e);function e(){var t=o.call(this)||this;return t.isModelClose=!0,t}p.BattleSettlement=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.goddomain.BattleResultUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.myTeam.renderHandler=new Handler(this,this.itemRender),this.enemyTeam.renderHandler=new Handler(this,this.itemRender)},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,!1),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.myTeam.array=null,this.enemyTeam.array=null},n.prototype.initView=function(){this.dataSource&&(this.dataSource.type==playState.VICTORY?AudioMgr.playSound("sound/victory.mp3"):AudioMgr.playSound("sound/defeated.mp3"));var t=this.dataSource,e=t.copyVo,i=e.vo.godDomainVo;this.bgPanel.showTitle(!0,"zhandoubiaoxian/duizhanjieguo.png",!0,!0,!0,null,this);for(var n=e.responseData,o=!1,a=[],r=i.leftInfo,s=0;s<r.length;s++){var u=r[s],h=n.waveResults[1]?n.waveResults[1][s]:0;u.count=h,u.playerId==App.hero.playerId&&(o=!0),a.push(u)}var l=[],c=i.rightInfo;for(s=0;s<c.length;s++)u=c[s],h=n.waveResults[2]?n.waveResults[2][s]:0,u.count=h,l.push(u);this.myTeam.array=o?a:l,this.enemyTeam.array=o?l:a,t.type=o&&1==n.winCamp||!o&&2==n.winCamp?playState.VICTORY:playState.FAILURE;var p=t.type==playState.VICTORY;this.imgResultBg1.skin=p?SkinUtil.izsy_bg_succ:SkinUtil.izsy_bg_fail,this.imgResult1.skin=p?SkinUtil.lb_victory:SkinUtil.lb_failure,this.imgResultBg1.scaleY=p?1:-1,this.imgResultBg2.skin=p?SkinUtil.izsy_bg_fail:SkinUtil.izsy_bg_succ,this.imgResult2.skin=p?SkinUtil.lb_failure:SkinUtil.lb_victory,this.imgResultBg2.scaleY=p?1:-1},n.prototype.itemRender=function(t,e){var i=t.getChildByName("lbName"),n=t.getChildByName("lbCount"),o=t.getChildByName("ui_head"),a=t.dataSource;i.text=a.name,n.dataSource=a.count,n.value=a.count+"",o.dataSource=new UserHeadVo(a.head,a.level,a.headFrame)},n.prototype.close=function(){this.bgPanel.closeTitle();var t=this.dataSource,e={type:t.type,copyVo:t.copyVo,vo:t.vo};i.prototype.close.call(this),UIMgr.showUI(UIConst.GodDm_BattleSettlementView,e)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}t.BattleSettlementView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.goddomain.AutoMatchUI,__extends(n,i),n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),Laya.timer.clearAll(this),this.btnCancel.off(Laya.Event.CLICK,this,this.onCancel)},n.prototype.initView=function(){Laya.timer.loop(1e3,this,this.updateTime),this.updateTime(),this.btnCancel.on(Laya.Event.CLICK,this,this.onCancel),Laya.timer.loop(2e3,this,this.matchTeam)},n.prototype.updateTime=function(){var t=Math.ceil(App.serverTimeSecond-this._model.matchTime);this.lbTime.text=LanMgr.getLan("",10507,t)},n.prototype.matchTeam=function(){var t=this;this._thread.requestMyTeamInfo(!1).then(function(){t._model.hasTeam()&&(Laya.timer.clearAll(t),t._model.matchTime=0,t.close(),UIMgr.showUI(UIConst.GodDm_TeamView))})},n.prototype.onCancel=function(){var t=this;this._thread.cancelAutoMatch().then(function(){t._model.matchTime=0,t._model.hasTeam()?(Laya.timer.clearAll(t),t.close(),UIMgr.showUI(UIConst.GodDm_TeamView)):t.close()})},n);function n(){var t=i.call(this)||this;return t.isModelClose=!1,t._model=e.GodDomainModel.getInstance(),t._thread=e.GodDmThread.getInstance(),t}e.AutoMatchView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(n){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"GodDomainProcessor"},i.prototype.listenModuleEvents=function(){return[new n.GodDomainEvent(n.GodDomainEvent.SHOW_GODDOMAIN_VIEW),new n.GodDomainEvent(n.GodDomainEvent.SHOW_AUTO_MATCH_VIEW),new n.GodDomainEvent(n.GodDomainEvent.SHOW_RANK_VIEW),new n.GodDomainEvent(n.GodDomainEvent.SHOW_SHOP_VIEW),new n.GodDomainEvent(n.GodDomainEvent.SHOW_TEAM_LIST),new n.GodDomainEvent(n.GodDomainEvent.SHOW_RULE_VIEW),new n.GodDomainEvent(n.GodDomainEvent.SHOW_BUY_VIEW),new n.GodDomainEvent(n.GodDomainEvent.CREATE_TEAM_VIEW),new n.GodDomainEvent(n.GodDomainEvent.JOIN_TEAM),new n.GodDomainEvent(n.GodDomainEvent.SHOW_BONUS_RULE),new n.GodDomainEvent(n.GodDomainEvent.SHOW_CHAT_VIEW),new n.GodDomainEvent(n.GodDomainEvent.START_BATTLE),new n.GodDomainEvent(n.GodDomainEvent.ONEKEY_INVITE),new n.GodDomainEvent(n.GodDomainEvent.LEAVE_TEAM),new n.GodDomainEvent(n.GodDomainEvent.SHOW_INVITE_VIEW),new n.GodDomainEvent(n.GodDomainEvent.SHOW_PLAYER_INFO),new n.ChatEvent(n.ChatEvent.ADD_GROUP_CHAT),new n.HudEvent(n.HudEvent.SET_NAME),new n.HudEvent(n.HudEvent.UPDATE_POWER)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof n.GodDomainEvent)switch(t.type){case n.GodDomainEvent.SHOW_GODDOMAIN_VIEW:this.showGoddmView(t.data);break;case n.GodDomainEvent.SHOW_AUTO_MATCH_VIEW:this.showAutoMatchView();break;case n.GodDomainEvent.SHOW_RANK_VIEW:this.showRankView();break;case n.GodDomainEvent.SHOW_SHOP_VIEW:this.showShopView();break;case n.GodDomainEvent.SHOW_TEAM_LIST:this.showTeamList();break;case n.GodDomainEvent.SHOW_RULE_VIEW:this.showRuleView();break;case n.GodDomainEvent.SHOW_BUY_VIEW:this.showBuyView();break;case n.GodDomainEvent.CREATE_TEAM_VIEW:this.createTeamView();break;case n.GodDomainEvent.JOIN_TEAM:this.joinTeam(t.data);break;case n.GodDomainEvent.SHOW_BONUS_RULE:this.showBonusRule();break;case n.GodDomainEvent.SHOW_CHAT_VIEW:this.showChatView();break;case n.GodDomainEvent.START_BATTLE:this.startBattle(t.data);break;case n.GodDomainEvent.ONEKEY_INVITE:this.onekeyInvite();break;case n.GodDomainEvent.LEAVE_TEAM:this.levelTeam();break;case n.GodDomainEvent.SHOW_INVITE_VIEW:this.showInviteView();break;case n.GodDomainEvent.SHOW_PLAYER_INFO:this.showPlayerInfo(t.data)}else if(t instanceof n.ChatEvent)switch(t.type){case n.ChatEvent.ADD_GROUP_CHAT:this.addGroupChat(t.data)}else if(t instanceof n.HudEvent)switch(t.type){case n.HudEvent.SET_NAME:this.updateName();break;case n.HudEvent.UPDATE_POWER:this.updateForce()}},i.prototype.showGoddmView=function(t){var e=this;this._thread.requestMyTeamInfo().then(function(){e._model.hasTeam()?UIMgr.hasStage(UIConst.GodDm_TeamView)?e.teamView.show(!1,!1):UIMgr.showUI(UIConst.GodDm_TeamView):UIMgr.hasStage(UIConst.GodDomainView)?e.domainView.show(!1,!1):UIMgr.showUI(UIConst.GodDomainView)})},i.prototype.showAutoMatchView=function(){var t=this;if(this._model.isInDoubleTime())this._thread.autoMatch().then(function(){UIMgr.showUI(UIConst.GodDm_AutoMatchView)});else{var e=tb.TB_fight_goddomain_set.getSet().double_prompt;common.AlertBox.showAlert({text:e,confirmCb:function(){t._thread.autoMatch().then(function(){UIMgr.showUI(UIConst.GodDm_AutoMatchView)})},parm:null})}},i.prototype.showRankView=function(){UIMgr.showUI(UIConst.GodDm_RankView)},i.prototype.showShopView=function(){dispatchEvt(new n.ShopEvent(n.ShopEvent.SHOW_SHOP_VIEW),ShopType.godDm)},i.prototype.showTeamList=function(){this._thread.requestTeamList().then(function(){UIMgr.showUI(UIConst.GodDm_TeamListView)})},i.prototype.showRuleView=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20017))},i.prototype.showBonusRule=function(){PLC.request(Protocol.friend_group_getRewardAddInfo,null,function(t){if(t){var e=t.rewardAddInfo,i=tb.TB_fight_goddomain_set.getSet().team_bonus;UIUtil.showCommonTipView(LanMgr.getLanArr.apply(LanMgr,__spreadArrays([20016,[]],e,i)))}})},i.prototype.showChatView=function(){dispatchEvt(new n.ChatEvent(n.ChatEvent.SHOW_CHAT_PANEL),[n.OpenType.godDm,iface.tb_prop.chatChannelTypeKey.group])},i.prototype.showInviteView=function(){this._thread.requestInviteList().then(function(){UIMgr.showUI(UIConst.GodDm_InviteView)})},i.prototype.showBuyView=function(){UIUtil.checkLimitEnough(iface.tb_prop.limitTypeKey.buyGodDmRewardNum,iface.tb_prop.vipPrivilegeTypeKey.godDmRewardNum)&&UIMgr.showUI(UIConst.BuyBattleCount,{type:common.BuyBattleCountView.TYPE_GODDOMAIN,callback:function(t){var e={};e[Protocol.game_common_buyGodDomainRewardNum.args.count]=t,PLC.request(Protocol.game_common_buyGodDomainRewardNum,e,function(t){})}})},i.prototype.createTeamView=function(){var t=this;if(this._model.isInDoubleTime())this._thread.createTeam().then(function(){UIMgr.showUI(UIConst.GodDm_TeamView),UIMgr.hideUIByName(UIConst.GodDm_TeamListView)});else{var e=tb.TB_fight_goddomain_set.getSet().double_prompt;common.AlertBox.showAlert({text:e,confirmCb:function(){t._thread.createTeam().then(function(){UIMgr.showUI(UIConst.GodDm_TeamView),UIMgr.hideUIByName(UIConst.GodDm_TeamListView)})},parm:null})}},i.prototype.joinTeam=function(t){if(this._model.hasTeam())showToast(LanMgr.getLan("",10377));else if(3<=t.svo.memberNum){showToast(LanMgr.getLan("",10378));var e=UIMgr.getUIByName(UIConst.GodDm_TeamListView);e&&e.onRefresh()}else this._thread.joinTeam(t).then(function(t){if(t)UIMgr.hideUIByName(UIConst.GodDm_TeamListView),UIMgr.showUI(UIConst.GodDm_TeamView);else{var e=UIMgr.getUIByName(UIConst.GodDm_TeamListView);e&&e.onRefresh()}})},i.prototype.startBattle=function(t){var e=this;t||0<App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.godDmRewardNum)?this._thread.showTeamMatchView():common.AlertBox.showAlert({text:LanMgr.getLan("",10482),confirmCb:function(){e._thread.showTeamMatchView()},parm:null})},i.prototype.onekeyInvite=function(){var t=this;if(this._model.myTeam.isAllRealPerson())showToast(LanMgr.getLan("",10379));else{var e=this._model.oneKeyInviteCd;0<e&&App.serverTimeSecond<e?showToast(LanMgr.getLan("",10380,Math.ceil(e-App.serverTimeSecond))):this._thread.oneKeyInvite().then(function(){t.teamView.updateView()})}},i.prototype.levelTeam=function(){var t=this;common.AlertBox.showAlert({text:LanMgr.getLan("",10481),confirmCb:function(){t._thread.leaveTeam().then(function(){UIMgr.showUI(UIConst.GodDomainView)})},parm:null})},i.prototype.showPlayerInfo=function(t){var e=new n.GodDomainEvent(n.GodDomainEvent.SHOW_GODDOMAIN_VIEW),i={};t.isRobot()&&(i.name=t.svo.name,i.guildName=t.svo.guildName),dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_PLAYER_INFO_VIEW),{playerId:t.svo.playerId,event:e,clientVo:i})},i.prototype.addGroupChat=function(t){UIMgr.hasStage(UIConst.GodDm_TeamView)&&this.teamView.addNewChats(t)},i.prototype.updateName=function(){var t=this._model.myTeam.getSelfInfo();t&&t.isExist()&&(t.svo.name=App.hero.name),UIMgr.hasStage(UIConst.GodDm_TeamView)&&this.teamView.refreshMemberItem(App.hero.playerId),UIMgr.hasStage(UIConst.GodDomainView)&&this.domainView.updateName()},i.prototype.updateForce=function(){UIMgr.hasStage(UIConst.GodDomainView)&&this.domainView.updateForce()},Object.defineProperty(i.prototype,"domainView",{get:function(){return UIMgr.getUIByName(UIConst.GodDomainView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"teamView",{get:function(){return UIMgr.getUIByName(UIConst.GodDm_TeamView)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=n.GodDomainModel.getInstance(),t._thread=n.GodDmThread.getInstance(),t}n.GodDomainProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"GodDomainModule"},n.prototype.listProcessors=function(){return[new t.GodDomainProcessor]},n.prototype.onRegister=function(){t.GodDomainModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.GodDomainModule=i;var o,a,r=(o=tl3d.BaseEvent,__extends(s,o),s.SHOW_GODDOMAIN_VIEW="SHOW_GODDOMAIN_VIEW",s.SHOW_AUTO_MATCH_VIEW="SHOW_AUTO_MATCH_VIEW",s.SHOW_SHOP_VIEW="SHOW_SHOP_VIEW",s.SHOW_RANK_VIEW="SHOW_RANK_VIEW",s.SHOW_TEAM_LIST="SHOW_TEAM_LIST",s.SHOW_RULE_VIEW="SHOW_RULE_VIEW",s.SHOW_BUY_VIEW="SHOW_BUY_VIEW",s.CREATE_TEAM_VIEW="CREATE_TEAM_VIEW",s.SHOW_BONUS_RULE="SHOW_BONUS_RULE",s.SHOW_CHAT_VIEW="SHOW_CHAT_VIEW",s.SHOW_INVITE_VIEW="SHOW_INVITE_VIEW",s.SHOW_PLAYER_INFO="SHOW_PLAYER_INFO",s.JOIN_TEAM="JOIN_TEAM",s.START_BATTLE="START_BATTLE",s.ONEKEY_INVITE="ONEKEY_INVITE",s.LEAVE_TEAM="LEAVE_TEAM",s);function s(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.GodDomainEvent=r,(a=t.PoolConst||(t.PoolConst={})).TeamListVo="TeamListVo",a.InviteInfoVo="InviteInfoVo"}(game=game||{}),function(a){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initModel=function(){this.myTeam=new a.GodDmMyTeamVo,this.doubleTimeStr="";for(var t=tb.TB_fight_goddomain_set.getSet().double_time,e=0;e<t.length;e++){var i=t[e];this.doubleTimeStr+=i[0]+":00-"+i[1]+":00",e!=t.length-1&&(this.doubleTimeStr+="     ")}},e.prototype.updateTeamInfo=function(t,e){this.groupId=t.groupId,t.hasOwnProperty("godDmScore")&&(this.score=t.godDmScore),t.hasOwnProperty("myRank")&&(this.myRank=t.myRank),t.hasOwnProperty("autoJoin")&&(this.myTeam.autoJoin=t.autoJoin),t.hasOwnProperty("rewardAdd")&&(this.myTeam.rewardAdd=t.rewardAdd),t.hasOwnProperty("regTime")&&(this.myTeam.regTime=t.regTime),this.myTeam.updateData(e||[])},e.prototype.resetGroupId=function(){this.groupId=""},e.prototype.setTeamList=function(t){if(this._teamList)for(var e=0,i=this._teamList;e<i.length;e++){var n=i[e];Laya.Pool.recover(a.PoolConst.TeamListVo,n)}this._teamList=[];for(var o=0;o<t.length;o++)(n=Laya.Pool.getItemByClass(a.PoolConst.TeamListVo,a.GodDmTeamListVo)).setSvo(t[o]),this._teamList.push(n)},e.prototype.getTeamList=function(){return this._teamList?this._teamList:[]},e.prototype.setInviteList=function(t){if(this._inviteList)for(var e=0,i=this._inviteList;e<i.length;e++){var n=i[e];Laya.Pool.recover(a.PoolConst.InviteInfoVo,n)}this._inviteList=[];for(var o=0;o<t.length;o++)(n=Laya.Pool.getItemByClass(a.PoolConst.InviteInfoVo,a.GodDmInviteVo)).setSvo(t[o]),this._inviteList.push(n)},e.prototype.getInviteList=function(){return this._inviteList?this._inviteList:[]},e.prototype.hasTeam=function(){return this.groupId&&""!=this.groupId},e.prototype.isInDoubleTime=function(){var e=new Date(App.serverTime).getHours();return tb.TB_fight_goddomain_set.getSet().double_time.some(function(t){return e>=t[0]&&e<t[1]})},e.prototype.getBuyCost=function(){var t=tb.TB_fight_goddomain_set.getSet().buy_cost,e=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyGodDmRewardNum);return e>=t.length?t[t.length-1]:t[e]},e.prototype.challengeRp=function(){if(!this.isOpen())return!1;var t=this.isInDoubleTime(),e=!1;if(!t){var i=new Date(App.serverTime).getHours();e=tb.TB_fight_goddomain_set.getSet().double_time.every(function(t){return i>=t[0]&&i>=t[1]})}return this.isOpen()&&(t||e)&&0<App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.godDmRewardNum)},e.prototype.isOpen=function(){return App.IsSysOpen(ModuleConst.GOD_DOMAIN)},e);function e(){this.score=0,this.myRank=0,this.oneKeyInviteCd=0,this.matchTime=0}a.GodDomainModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var o,e=(o=ui.god.TupoUI,__extends(i,o),i.prototype.popup=function(){o.prototype.popup.call(this),this.bgPanel.dataSource={uiName:UIConst.God_TupoView,closeOnSide:this.isModelClose,title:"comp/title/tupochengg.png"};var t=this.dataSource,e=tb.TB_fusion_soul.get_TB_fusion_soulById(t.fuseLevel-1),i=tb.TB_fusion_soul.get_TB_fusion_soulById(t.fuseLevel),n=new Array;n.push(e),n.push(i),this.list_attr.dataSource=n},i.prototype.onRender=function(t,e){var i=t.getChildByName("lab_lv"),n=t.getChildByName("lab_add"),o=t.getChildByName("lab_tili"),a=t.getChildByName("lab_gongji"),r=t.getChildByName("lab_fangyu");i.text=LanMgr.getLan("",12179)+"："+t.dataSource.ID+LanMgr.getLan("",10031),n.text="速度：+"+t.dataSource.special_attr[0][1],o.text=LanMgr.getLan("",12335)+"："+t.dataSource.attr_max[0][1],a.text=LanMgr.getLan("",12336)+"："+t.dataSource.attr_max[1][1],r.text=LanMgr.getLan("",12337)+"："+t.dataSource.attr_max[2][1],n.color=a.color=r.color=o.color=i.color=this.dataSource.fuseLevel==t.dataSource.ID?"#13b222":ColorConst.normalFont},i.prototype.close=function(){o.prototype.close.call(this),this.bgPanel.dataSource=null},i);function i(){var t=o.call(this)||this;return t.isModelClose=!0,t.list_attr.renderHandler=new Handler(t,t.onRender),t}t.TupoView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var e,t=(e=ui.god.tab.TabStarupUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){var e=this._dataSource;e&&t&&e.uuid==t.uuid?this._needInit=!1:this._needInit=!0,this._dataSource=t},enumerable:!0,configurable:!0}),i.prototype.close=function(){this._needInit=!0,this._dataSource=null,this.list_choose.array=null,this.list_maxstar.array=null,this.list_nextstar.array=null,this.list_nowstar.array=null,this.starupRp.onDispose(),this.btn_tip.off(Laya.Event.CLICK,this,this.onClickTip)},i.prototype.init=function(){if(this.dataSource&&this._needInit){var t=this.dataSource,e=t.isStarupGod();if(this.lab_nostar.visible=!e,!e)return this.box_manxing.visible=this.box_shengxing.visible=this.list_choose.visible=!1,void(this.imgDi.y=263);this.starupRp.onDispose(),t.isInLinuep(iface.tb_prop.lineupTypeKey.attack)&&this.starupRp.setRedPointName("god_starup_"+t.uuid);var i=tb.TB_god_evolution.get_TB_god_evolutionById(t.starLevel),n=tb.TB_god_evolution.get_TB_god_evolutionById(t.starLevel+1),o=t.isMoreThanSix()?t.getStar()-5:t.getStar(),a=t.tab_god.star[1]==t.starLevel;if(this.box_manxing.visible=a,this.list_choose.visible=this.box_shengxing.visible=!a,this.imgDi.y=a?263:213,a)this.list_maxstar.repeatX=t.starLevel,this.lab_maxlevel.text=String(i.level),this.lbAwakenLimit.text=tb.TB_awaken_conditions.getTbById(t.starLevel).awake_section_max+"",this.lab_maxattr.text=i.multiple_show+"%",this.setStarData(o,t.starLevel,this.list_maxstar),this.list_maxstar.width=30*o+this.list_maxstar.spaceX*(o-1);else{if(!n)return;this.box_shuxing.visible=5<=t.starLevel,this.box_lvup.visible=6<=t.starLevel,this.list_afterdegree.visible=this.list_predegree.visible=!this.box_lvup.visible,this.box_shuxing.visible?(this.box_awaken.y=36,this.list_predegree.y=this.list_afterdegree.y=72):(this.box_awaken.y=16,this.list_predegree.y=this.list_afterdegree.y=52);var r=6<=o+1?o+1-5:o+1;this.list_nowstar.repeatX=t.starLevel,this.list_nextstar.repeatX=t.starLevel+1,this.list_nowstar.spaceX=this.list_nextstar.spaceX=5,this.starUp(),this.setStarData(o,t.starLevel,this.list_nowstar),this.setStarData(r,t.starLevel+1,this.list_nextstar);var s=tb.TB_awaken_conditions.getTbById(t.starLevel),u=tb.TB_awaken_conditions.getTbById(t.starLevel+1);if(this.lab_nowattr.text=i.multiple_show+"%",this.lab_nextattr.text=n.multiple_show+"%",this.lbNowAwaken.text=s.awake_section_max+"",this.lbNextAwaken.text=u?u.awake_section_max+"":"0",this.box_lvup.visible)this.lab_nowmaxlv.text=String(i.level),this.lab_nextmaxlv.text=String(n.level);else{var h=t.starLevel<6?t.starLevel:6;this.setDegreeData(h,this.list_predegree),this.setDegreeData(h+1,this.list_afterdegree),this.list_predegree.repeatX=h,this.list_afterdegree.repeatX=h+1}}this.btn_tip.on(Laya.Event.CLICK,this,this.onClickTip)}},i.prototype.starUp=function(){var e=this.dataSource;if(e){var t=h.GodUtils.getGodStarId(e.starLevel,e.templateId),i=tb.TB_god_star.get_TB_god_starById(t);if(i){var n=tb.TB_god_evolution.get_TB_god_evolutionById(e.starLevel),o=i.getGodMaterialList().map(function(t){return new h.GodMaterialVo(t,e)});if(this.list_choose.array=o,Laya.timer.callLater(this,this.refreshChooseList),this.list_choose.width=100*o.length+(o.length-1)*this.list_choose.spaceX,e.starLevel<tb.TB_god_set.get_TB_god_set().star_evolution)this.costContainer.visible=!1;else{var a=App.hero.getBagItemNum(n.cost[0][0]),r=a>=n.cost[0][1]?ColorConst.normalFont:ColorConst.RED;this.costContainer.visible=this.imgCost.visible=!0,this.lab_cost.text="/"+n.cost[0][1],this.lbhas.text=""+a,this.lbhas.color=r,this.lbhas.event(Laya.Event.RESIZE),this.boxCost.refresh()}this.btn_starup.centerX=this.costContainer.visible?160:0}}},i.prototype.onChooseSelect=function(t,e){if(t.type==Laya.Event.CLICK){var i=this.list_choose.getCell(e).dataSource;if(i){for(var n=[],o=0,a=this.list_choose.array;o<a.length;o++){var r=a[o];r!=i&&n.push.apply(n,r.choose)}var s=h.GodUtils.filterGods(i.tbVo,i.curGod,n);if(0<s.length){var u={allList:s,curMaterail:i,openType:ChooseOpenType.starUp};UIMgr.showUI(UIConst.God_ChooseGodView,u)}else showToast(LanMgr.getLan("",10368)),UIUtil.showJumpPanle2(1)}}},i.prototype.refreshChooseList=function(){for(var t=0,e=this.list_choose.cells;t<e.length;t++)e[t].refreshData(this.list_choose.array)},i.prototype.onStarUp=function(){this.dataSource&&dispatchEvt(new h.GodEvent(h.GodEvent.CLICK_STAR_UP),[this.dataSource,this.list_choose.array])},i.prototype.onClickTip=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(40001))},i.prototype.setStarData=function(t,e,i){for(var n=new Array,o=0;o<t;o++)n[o]=6<=e;i.array=n},i.prototype.setDegreeData=function(t,e){var i=this.dataSource;if(i){for(var n=new Array,o=0;o<t;o++)n.push(i.degree);e.array=n}},i.prototype.onXingjiRender=function(t,e){t.dataSource?(t.skin=SkinUtil.superXing,t.width=29,t.height=31):t.skin=SkinUtil.xingxing},i.prototype.onDegreeRender=function(t,e){t.gray=t.dataSource-1<e},i);function i(){var t=e.call(this)||this;return t.list_nowstar.renderHandler=new Handler(t,t.onXingjiRender),t.list_nextstar.renderHandler=new Handler(t,t.onXingjiRender),t.list_maxstar.renderHandler=new Handler(t,t.onXingjiRender),t.list_predegree.renderHandler=new Handler(t,t.onDegreeRender),t.list_afterdegree.renderHandler=new Handler(t,t.onDegreeRender),t.btn_starup.on(Laya.Event.CLICK,t,t.onStarUp),t._needInit=!0,t.list_choose.mouseHandler=new Handler(t,t.onChooseSelect),t}h.godTabStarupView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var t,e=(t=ui.god.tab.TabInfoUI,__extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._model=a.GodModel.getInstance(),this.list_pinjie.renderHandler=new Handler(this,this.onDegreeRender),this.btn_shengjie.on(Laya.Event.CLICK,this,this.openShengjie),this.btn_upGrade.on(Laya.Event.CLICK,this,this.onMouseDown),this.btnLookAttr.on(Laya.Event.CLICK,this,this.onLookAttr),this.checkBox.on(Laya.Event.CHANGE,this,this.onCheckBox),this.skillBox.visible=!1,this.skillBox.dataSource=null,this.skillList.array=null,this.skillList.mouseHandler=new Handler(this,this.onSkillClick),this.bombAnim.visible=!1,this.bombAnim.stop()},i.prototype.close=function(){Laya.timer.clearAll(this),this.dataSource=null,this.dgupRedPoint.onDispose(),this.lvupRedPoint.onDispose(),this.list_pinjie.array=null,this.skillBox.visible=!1,this.skillBox.dataSource=null,this.skillList.array=null,this.bombAnim.visible=!1,this.bombAnim.stop(),Laya.stage.off(Laya.Event.CLICK,this,this.onClickStage)},Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t},enumerable:!0,configurable:!0}),i.prototype.init=function(){this.initData(),this.updateXinxi()},i.prototype.initData=function(){var t=this.dataSource;if(t){var e=t.tab_god;this.lbType.text=LanMgr.godTypeName[e.type],this.skillBox.visible=!1,this.skillBox.dataSource=null,this.bombAnim.visible=!1,this.bombAnim.stop(),Laya.stage.on(Laya.Event.CLICK,this,this.onClickStage),this.updateList()}},i.prototype.updateXinxi=function(){var t=this.dataSource;if(t){this.setCostText(),this.setPinjieList();var e=t.degree>=tb.TB_god_set.get_TB_god_set().star_evolution?t.starLevel:t.degree,i=tb.TB_god_evolution.get_TB_god_evolutionById(e),n=i?i.level:-1,o=t.level==n&&t.level<a.GodModel.getMaxLv(t.starLevel);this.lab_dengji.text=LanMgr.getLan("{0}/{1}",-1,t.level,n),this.lbMaxLv.visible=this.imgDi.visible=t.level>=t.maxTbLv,this.btn_shengjie.label=LanMgr.getLan("",12356),this.checkBox.visible=this.btn_upGrade.visible=t.level!=n,this.checkBox.selected=this._model.isOnekeyLvup,this.box_canup.visible=this.btn_upGrade.visible,this.btn_shengjie.visible=!this.btn_upGrade.visible&&o,this.btn_shengjie.visible||this.btn_upGrade.visible||!t.canStarUp()||(this.btn_shengjie.label=LanMgr.getLan("",12357),this.btn_shengjie.visible=!0),this.lvupRedPoint.setRedPointName("god_lvup_"+t.uuid),this.dgupRedPoint.setRedPointName("god_dgup_"+t.uuid)}},i.prototype.onLookAttr=function(){var t=this.dataSource,e={basicAttr:t.getProperty(),allAttr:t.getAllAttr(iface.tb_prop.lineupTypeKey.attack)};UIMgr.showUI(UIConst.God_AttrView,e)},i.prototype.setPinjieList=function(){for(var t=this.dataSource,e=t.starLevel<6?t.starLevel:6,i=new Array,n=0;n<e;n++)i.push(t.degree);this.list_pinjie.repeatX=e,this.list_pinjie.dataSource=i},i.prototype.setCostText=function(){var t=this.dataSource;if(t){var e=App.hero.godExp,i=tb.TB_god_level.get_TB_god_levelnById(t.level),n=i.cost[0][1]-t.exp;this.lab_allExp.text=Snums(e),this.lab_needExp.text="/"+Snums(n),this.lab_allExp.color=e<n?ColorConst.redFont:ColorConst.normalFont,this.lab_getGold.text="/"+Snums(i.cost[1][1]),this.lab_getGold.color=App.hero.gold<i.cost[1][1]?ColorConst.redFont:ColorConst.normalFont,this.lbAllGold.text=Snums(App.hero.gold),this.HBoxExp.refresh(),this.hboxGold.refresh()}},i.prototype.onMouseDown=function(){var t=this.dataSource,e=App.hero.godExp,i=tb.TB_god_level.get_TB_god_levelnById(t.level);if(e<i.cost[0][1]-t.exp)showToast(LanMgr.getLan("",Lans.cost,6));else if(App.hero.gold<i.cost[1][1])showToast(LanMgr.getLan("",Lans.glod));else{if(this.btn_shengjie.visible)return;dispatchEvt(new a.GodEvent(a.GodEvent.USE_EXPPOOL),[t,this.checkBox.selected])}},i.prototype.openShengjie=function(){this.btn_shengjie.label==LanMgr.getLan("",12357)?this.godView.list_tab.selectedIndex=1:App.IsSysOpen(ModuleConst.SHENGJIE)?UIMgr.showUI(UIConst.God_DgUpView,this.dataSource):showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.SHENGJIE).prompt)},Object.defineProperty(i.prototype,"godView",{get:function(){return UIMgr.getUIByName(UIConst.God_MainView)},enumerable:!0,configurable:!0}),i.prototype.onDegreeRender=function(t,e){t.gray=t.dataSource-1<e},i.prototype.onXingjiRender=function(t,e){t.dataSource?(t.skin=SkinUtil.superXing,t.width=29,t.height=31):t.skin=SkinUtil.xingxing},i.prototype.onCheckBox=function(){this._model.isOnekeyLvup=this.checkBox.selected},i.prototype.updateList=function(){var t=this.dataSource;if(t){var e=t.getSkillList(),i=[];for(var n in e){var o=tb.TB_skill.get_TB_skillById(e[n][0]);if(o&&1!=o.type){var a=e[n][1];i.push({skill:o,godId:t.tab_god.ID,openDgLv:a,dgLv:t.degree,index:n})}}this.skillList.array=i,this.skillList.width=95*i.length+(i.length-1)*this.skillList.spaceX}},i.prototype.onSkillClick=function(t,e){if(t.type==Laya.Event.CLICK){var i=this.skillList.getCell(e);if(i&&i.dataSource){this.skillBox.dataSource=i.dataSource;var n=this.skillList.x+48+96*e+this.skillList.spaceX*e;this.skillBox.x=n+this.skillBox.width>=this.width?this.width-this.skillBox.width:n,this.skillBox.y=this.skillList.y-this.skillBox.height,this.skillBox.visible=!0}else this.skillBox.dataSource=null,this.skillBox.visible=!1}else t.type==Laya.Event.MOUSE_UP||(t.type,Laya.Event.MOUSE_OUT)},i.prototype.onClickStage=function(t){t.target instanceof a.GodSkillItemIR||(this.skillBox.dataSource=null,this.skillBox.visible=!1)},i);function i(){return t.call(this)||this}a.godTabInfoView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var e,t=(e=ui.god.tab.TabRonghunUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){var e=this._dataSource;e&&t&&e.uuid==t.uuid?this._needInit=!1:this._needInit=!0,this._dataSource=t},enumerable:!0,configurable:!0}),i.prototype.close=function(){this.dataSource=null,this._needInit=!0,this.jindubox1.dataSource=null,this.jindubox2.dataSource=null,this.jindubox3.dataSource=null,Laya.timer.clearAll(this),this.removeAllEffect(),tl3d.ModuleEventManager.removeEvent(h.ResEvent.PROP_CHANGE,this.updateResCount,this)},i.prototype.init=function(){this.dataSource&&this._needInit&&(this._needInit=!1,this._oldFuseLv=0,this.updateView(),this.list_have.array=this._typeAry,this.onItemClick(this.curBall),tl3d.ModuleEventManager.addEvent(h.ResEvent.PROP_CHANGE,this.updateResCount,this))},i.prototype.updateView=function(){var t=this.dataSource;if(t){var e=tb.TB_fusion_soul.get_TB_fusion_soulById(t.fuseLevel),i=tb.TB_fusion_soul.get_TB_fusion_soulById(t.fuseLevel+1),n=t.isRonghunMax(),o=!i;this.box_ronghun.visible=!n,this.box_tupo.visible=!this.box_ronghun.visible&&!o,this.boxMaxLv.visible=o&&n,this.lab_tiaojian.text=LanMgr.getLan("",12359,e.break_limit),this.lab_level.text=t.fuseLevel+LanMgr.getLan("",10031),t.fuseLevel>this._oldFuseLv&&(this._oldFuseLv=t.fuseLevel,this.jindubox1.dataSource={attrNo:1,curVo:t},this.jindubox2.dataSource={attrNo:2,curVo:t},this.jindubox3.dataSource={attrNo:3,curVo:t},this.onItemClick(this.curBall),this.removeAllEffect())}},i.prototype.updateResCount=function(){this.list_have.refresh()},i.prototype.onItemClick=function(t){var e=this.dataSource;this.curBall=t;for(var i=1;i<4;i++)this["jindubox"+i].setSelect(t==i);var n=tb.TB_fusion_soul.get_TB_fusion_soulById(e.fuseLevel);this.img_oneIcon.skin=SkinUtil.getRonghunHave(this._typeAry[t-1]);var o=n.getOnceCost(t);this.lab_oneNeed.text=o+"",this.updateCostColor(n,t),this.ronghunRP.onDispose(),this.ronghunRP.setRedPointName("god_ronghun_"+e.uuid+"_"+t),this.ronghunTenRP.onDispose(),this.ronghunTenRP.setRedPointName("god_ronghunten_"+e.uuid+"_"+t),this.btn_one.on(Laya.Event.CLICK,this,this.onRonghun,[t,!1]),this.btn_ten.on(Laya.Event.CLICK,this,this.onAuto,[t,!0]),dispatchEvt(new h.GodEvent(h.GodEvent.SELECT_RONGHUN_ITEM))},i.prototype.onRonghun=function(i,t){var n=this,e=this.dataSource;if(e){var o=tb.TB_fusion_soul.get_TB_fusion_soulById(e.fuseLevel);if(e.fuseAttrLevels[i]>=o.attr_max[i-1][1])showToast(LanMgr.getLan("",10374));else{var a=o.getOnceCost(i),r=t?10*a:a,s=this._typeAry[i-1];if(App.hero.getBagItemNum(s)<r)showToast(LanMgr.getLan("",10120,s));else{var u={};u[Protocol.game_god_fuseSoul.args.godId]=e.uuid,u[Protocol.game_god_fuseSoul.args.attrType]=i,u[Protocol.game_god_fuseSoul.args.numType]=t?iface.tb_prop.fuseNumTypeKey.ten:iface.tb_prop.fuseNumTypeKey.one,PLC.request(Protocol.game_god_fuseSoul,u,function(t,e){t&&(n.updateCostColor(o,i),n.successEffect(n.btn_one,i,o),dispatchEvt(new h.GodEvent(h.GodEvent.RONGHUN_SUCCESS)))})}}}},i.prototype.onAuto=function(t,e){this._timeout=0,h.GuideMask.show(this.btn_ten,h.DirectionType.none,null,!0,null,0,!1),this.btn_ten.off(Laya.Event.CLICK,this,this.onAuto),this.btn_ten.label=LanMgr.getLan("停 止",-1),this.btn_ten.on(Laya.Event.CLICK,this,this.onStop),this._timeoutflag=!1,this.onRonghunAuto(t,e),Laya.timer.loop(150,this,this.onRonghunAuto,[this.curBall,!0])},i.prototype.onStop=function(){this._timeout=0,this._timeoutflag=!1,Laya.timer.clear(this,this.onRonghunAuto),h.GuideMask.hide(),this.btn_ten.off(Laya.Event.CLICK,this,this.onStop),this.btn_ten.label=LanMgr.getLan("",12358),this.btn_ten.on(Laya.Event.CLICK,this,this.onAuto,[this.curBall,!0])},i.prototype.onRonghunAuto=function(i,t){var n=this,e=this.dataSource;if(e){var o=tb.TB_fusion_soul.get_TB_fusion_soulById(e.fuseLevel);if(e.fuseAttrLevels[i]>=o.attr_max[i-1][1])return this.onStop(),void showToast(LanMgr.getLan("",10374));var a=o.getOnceCost(i),r=this._typeAry[i-1];if(App.hero.getBagItemNum(r)<a)return this.onStop(),void showToast(LanMgr.getLan("",10120,r));if(this._timeoutflag)5e3<App.serverTime-this._timeout&&this.onStop();else{this._timeoutflag=!0,this._timeout=App.serverTime;var s={};s[Protocol.game_god_fuseSoul.args.godId]=e.uuid,s[Protocol.game_god_fuseSoul.args.attrType]=i,s[Protocol.game_god_fuseSoul.args.numType]=iface.tb_prop.fuseNumTypeKey.one,PLC.request(Protocol.game_god_fuseSoul,s,function(t,e){n._timeoutflag=!1,t?(n.updateCostColor(o,i),n.successEffect(n.btn_ten,i,o),dispatchEvt(new h.GodEvent(h.GodEvent.RONGHUN_SUCCESS))):n.onStop()})}}},i.prototype.updateCostColor=function(t,e){var i=t.getOnceCost(e);this.lab_oneNeed.color=App.hero.getBagItemNum(this._typeAry[e-1])>=i?ColorConst.normalFont:ColorConst.redFont},i.prototype.onTupo=function(){var i=this,n=this.dataSource;if(n){var t=tb.TB_fusion_soul.get_TB_fusion_soulById(n.fuseLevel);if(tb.TB_fusion_soul.get_TB_fusion_soulById(n.fuseLevel+1))if(n.starLevel<t.break_limit)showToast(LanMgr.getLan("",10376,t.break_limit));else{var e={};e[Protocol.game_god_break.args.godId]=n.uuid,PLC.request(Protocol.game_god_break,e,function(t,e){t&&(UIMgr.showUI(UIConst.God_TupoView,App.hero.getGodVoById(n.uuid)),i.updateView())})}else showToast(LanMgr.getLan("",10375))}},i.prototype.successEffect=function(t,e,i){this.updateView();var n="",o=0,a=iface.tb_prop.fuseAttrType[e],r=this["jindubox"+e];if(e==iface.tb_prop.fuseAttrTypeKey.hp?(n=SkinUtil.getRonghunHave(CostTypeKey.hun_life),o=i.add_hp):e==iface.tb_prop.fuseAttrTypeKey.atk?(n=SkinUtil.getRonghunHave(CostTypeKey.hun_attack),o=i.add_atk):e==iface.tb_prop.fuseAttrTypeKey.def&&(n=SkinUtil.getRonghunHave(CostTypeKey.hun_defense),o=i.add_def),0!=o&&r){a=LanMgr.attrName[e]+"+"+o;var s,u=r.x+r.width/2,h=r.y+120;0<this._imagePoolList.length?(s=this._imagePoolList.shift()).skin=n:((s=new Laya.Image(n)).width=s.height=28,s.anchorX=s.anchorY=.5),this._curImageList.push(s),s.x=this.box_ronghun.x+t.x+t.width/2,s.y=this.box_ronghun.y+t.y,this.addChild(s),Laya.Tween.to(s,{x:u,y:h},1e3,Laya.Ease.sineOut,new Handler(this,this.popText,[s,r,e,a]))}},i.prototype.popText=function(t,e,i,n){if(this.dataSource){e.dataSource={attrNo:i,curVo:this.dataSource},t.removeSelf(),this._imagePoolList.push(t);var o=this._curImageList.indexOf(t);-1!=o&&this._curImageList.splice(o,1);var a=new Laya.Label(n);a.fontSize=20,a.x=t.x+50,a.y=t.y,a.color="#00ff00",this._lableList.push(a),this.addChild(a),Laya.Tween.to(a,{y:a.y-50},800,Laya.Ease.sineOut,new Handler(this,function(){a.removeSelf()}))}},i.prototype.onLookInfo=function(){this.dataSource&&UIMgr.showUI(UIConst.God_fuseView,this.dataSource)},i.prototype.removeAllEffect=function(){Laya.Tween.clearTween(this);for(var t=0,e=this._lableList;t<e.length;t++)e[t].removeSelf();for(var i=0,n=this._curImageList;i<n.length;i++){var o=n[i];o.removeSelf(),this._imagePoolList.push(o)}},i);function i(){var t=e.call(this)||this;return t._typeAry=[CostTypeKey.hun_life,CostTypeKey.hun_attack,CostTypeKey.hun_defense],t._oldFuseLv=0,t._imagePoolList=[],t._curImageList=[],t._lableList=[],t.jindubox1.on(Laya.Event.CLICK,t,t.onItemClick,[1]),t.jindubox2.on(Laya.Event.CLICK,t,t.onItemClick,[2]),t.jindubox3.on(Laya.Event.CLICK,t,t.onItemClick,[3]),t.btn_tupo.on(Laya.Event.CLICK,t,t.onTupo),t.btn_look.on(Laya.Event.CLICK,t,t.onLookInfo),t._needInit=!0,t.curBall=1,t}h.godTabfuseView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(y){var e,t=(e=ui.god.tab.TabJuexingUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){var e=this._dataSource;e&&t&&e.uuid==t.uuid?this._needInit=!1:this._needInit=!0,this._dataSource=t},enumerable:!0,configurable:!0}),i.prototype.init=function(){this._dataSource&&this.initView()},i.prototype.close=function(){Laya.timer.clearAll(this),this._dataSource=null,this._needInit=!0,this.itemList.array=null,this.godList.array=null,this.attrList.array=null,this.redpoint.onDispose()},i.prototype.initView=function(){var t=this.dataSource;t&&this._needInit&&(this._needInit=!1,this.redpoint.onDispose(),t.isInLinuep(iface.tb_prop.lineupTypeKey.attack)&&this.redpoint.setRedPointName("god_awaken_"+t.uuid),this.lbUnlock.visible=this.btnLook.visible=t.tab_god.isCanAwaken(),this.lbUnlock.text=LanMgr.getLan("",12360,tb.TB_god_set.get_TB_god_set().awake_section),this.refreshJuexing())},i.prototype.refreshJuexing=function(){var e=this,t=this.dataSource;if(t){var i=tb.TB_awaken_conditions.getTbById(t.starLevel);this.lbCurLv.text=""+t.awakenLv,this.lbMaxLv.text="/"+i.awake_section_max,this.awakenHbox.refresh();var n=tb.TB_god_awaken.getTbById(t.awakenLv),o=tb.TB_god_awaken.getTbById(t.awakenLv+1),a=n.getMaterialList(),r=n.getGodMaterialList().map(function(t){return new y.GodMaterialVo(t,e.dataSource)}),s=[0,50,40,30,20,20,20,20,20][a.length+r.length];s=s<=20?20:s,this.itemList.array=a,this.itemList.spaceX=s,this.itemList.repeatX=a.length,this.itemList.width=100*a.length+(a.length-1)*this.itemList.spaceX,this.godList.array=r,Laya.timer.callLater(this,this.refreshGodList),this.godList.spaceX=s,this.godList.repeatX=r.length,this.godList.width=0==r.length?1:100*r.length+(r.length-1)*this.godList.spaceX;var u=0==r.length?0:s;this.itemList.x=this.width/2-(this.godList.width+this.itemList.width+u)/2,this.godList.x=this.itemList.x+this.itemList.width+u,this._attrToast=[];for(var h=[],l=0;l<n.attr.length;l++){var c=n.attr[l],p=c[0],d=c[1],_=o?o.getAttrValue(p):0,f=t.awakenLv<t.maxAwakenLv?_-d:-1;h.push([p,d,f]),0<f&&this._attrToast.push(iface.tb_prop.attrType[p]+"+"+f)}this.attrList.array=h;var g=t.awakenLv>=t.maxAwakenLv;this.btn_juexing.visible=this.itemList.visible=this.godList.visible=!g,this.maxLvNoticeBox.visible=g,this.imgDi.y=g?255:205}},i.prototype.attrRenderHandler=function(t,e){var i=t.getChildByName("imgAttr"),n=t.getChildByName("lbAttrVal");n.autoSize=!0;var o=t.getChildByName("lbNextAdd");o.autoSize=!0;var a=t.dataSource;if(a)if(i.skin=SkinUtil.getAttrSkin(a[0]),n.text=a[1],o.text="(+"+a[2]+")",o.visible=-1!=a[2],o.visible){var r=n.width+o.width+34+10;i.x=76-r/2+17,n.x=i.x+17+5,o.x=n.x+n.width+5}else r=n.width+34+5,i.x=76-r/2+17,n.x=i.x+17+5},i.prototype.refereshItemList=function(){this.itemList.refresh()},i.prototype.refreshGodList=function(){for(var t=0,e=this.godList.cells;t<e.length;t++)e[t].refreshData(this.godList.array)},i.prototype.onAwaken=function(){this.dataSource&&dispatchEvt(new y.GodEvent(y.GodEvent.CLICK_JUEXING_EVENT),[this.dataSource,this.godList.array])},i.prototype.onLook=function(){this.dataSource&&UIMgr.showUI(UIConst.GodSkinView,[this.dataSource,-1])},i.prototype.openChoose=function(t,e){if(t.type==Laya.Event.CLICK){var i=this.godList.getCell(e).dataSource;if(i){for(var n=[],o=0,a=this.godList.array;o<a.length;o++){var r=a[o];r!=i&&n.push.apply(n,r.choose)}var s=y.GodUtils.filterGods(i.tbVo,i.curGod,n);if(0<s.length){var u={allList:s,curMaterail:i,openType:ChooseOpenType.awaken};UIMgr.showUI(UIConst.God_ChooseGodView,u)}else showToast(LanMgr.getLan("",10368))}}},i.prototype.getAttrToast=function(){return this._attrToast},i.prototype.onXingjiRender=function(t,e){t.dataSource?(t.skin=SkinUtil.superXing,t.width=29,t.height=31):t.skin=SkinUtil.xingxing},i);function i(){var t=e.call(this)||this;return t.godList.mouseHandler=new Handler(t,t.openChoose),t.attrList.renderHandler=new Handler(t,t.attrRenderHandler),t.btn_juexing.on(Laya.Event.CLICK,t,t.onAwaken),t.btnLook.on(Laya.Event.CLICK,t,t.onLook),t._needInit=!0,t}y.godTabAwakeView=t}(game=game||{}),function(i){var n,t;(t=n=i.GodSkinType||(i.GodSkinType={}))[t.origin=0]="origin",t[t.awaken=-1]="awaken";var e=(o.prototype.getName=function(){return this.skinId==n.origin?LanMgr.getLan("",12218):this.skinId==n.awaken?LanMgr.getLan("",12219):this.tbSkin?this.tbSkin.name:LanMgr.getLan("",12230)},o.prototype.getName2=function(){return this.skinId==n.origin||this.skinId==n.awaken?this.tbGod.name:this.tbSkin?this.tbSkin.name:LanMgr.getLan("",12230)},o.prototype.getTitle=function(){return this.skinId==n.origin?this.tbGod.name+"("+LanMgr.getLan("",12218)+")":this.skinId==n.awaken?this.tbGod.name+"("+LanMgr.getLan("",12219)+")":this.tbSkin?this.tbGod.name+"("+this.tbSkin.name+")":this.tbGod.name+"("+LanMgr.getLan("",12230)+")"},o.prototype.getCondition=function(t){if(void 0===t&&(t=!0),this.skinId==n.origin)return t?LanMgr.getLan("",12218):LanMgr.getLan("",12364,this.tbGod.name);if(this.skinId==n.awaken)return LanMgr.getLan("",12361,tb.TB_god_set.get_TB_god_set().awake_section);var e=this.isNeedCost()?tb.TB_item.get_TB_itemById(this.costVo.id):null;return e?LanMgr.getLan("",12363,e.name):LanMgr.getLan("",12362)},o.prototype.getBgSkin=function(){return this.skinId==n.origin?"shizhuang/chushi.png":this.skinId==n.awaken?"shizhuang/xiyou.png":"shizhuang/chuanshuo.png"},o.prototype.getModelId=function(){return this.skinId==n.origin?this.tbGod.model:this.skinId==n.awaken?this.tbGod.awake_model:this.tbSkin?this.tbSkin.model:0},o.prototype.isActivity=function(t,e){return void 0===e&&(e=!0),this.skinId==n.origin?!!e||i.GodUtils.isActiveGod(this.tbGod.ID):this.skinId==n.awaken&&t>=tb.TB_god_set.get_TB_god_set().awake_section||-1!=App.hero.skinIds.indexOf(this.skinId)},o.prototype.isCanActivity=function(){return!(!this.isNeedCost()||this.isActivity(0))&&App.isEnough(this.costVo.id,this.costVo.count)},o.prototype.isWear=function(t){return t==this.skinId},o.prototype.isNeedCost=function(){return!!this.costVo},o.prototype.isSpecialSkin=function(){return!!this.tbSkin},o.prototype.getTbAttrStrAry=function(){if(!this.tbSkin)return null;if(!this._attrStrAry){this._attrStrAry=[];var t=LanMgr.attrName,e=[iface.tb_prop.attrTypeKey.effectHit,iface.tb_prop.attrTypeKey.effectResist,iface.tb_prop.attrTypeKey.crit,iface.tb_prop.attrTypeKey.dizzy,iface.tb_prop.attrTypeKey.critDmg,iface.tb_prop.attrTypeKey.healRate,iface.tb_prop.attrTypeKey.addDmg,iface.tb_prop.attrTypeKey.subDmg],i=this.tbSkin.getAttr(),n=i[0]||{},o=i[1]||{},a=[];for(var r in n){var s=LanMgr.getLan(t[Number(r)],-1),u=-1!=e.indexOf(Number(r))?"+"+Math.round(1e4*n[r])/100+"%":"+"+n[r];a.push([s,u])}for(var r in o)s=LanMgr.getLan(t[Number(r)],-1),u="+"+Math.round(1e4*o[r])/100+"%",a.push([s,u]);this._attrStrAry=a}return this._attrStrAry},o);function o(t,e){this.skinId=0,this.tbGod=t,0<(this.skinId=e)&&(this.tbSkin=tb.TB_skin.getTbById(e),this.costVo=this.tbSkin.item&&0<this.tbSkin.item.length?new ItemVo(this.tbSkin.item[0],this.tbSkin.item[1]):null)}i.GodSkinVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var t,e=(t=ui.god.GodSkinUI,__extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12220)},this.lbAttr.text="",this.skinList.array=null,this.skinList.selectedIndex=-1,this.skinList.selectEnable=!0,this.skinList.renderHandler=new Handler(this,this.onSkinRender),this.skinList.selectHandler=new Handler(this,this.selectHandler),this.btnWear.on(Laya.Event.CLICK,this,this.onWear),this.skinList.scrollBar&&this.skinList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollChange),this._uiScene=new Base2dSceneLayer,this.boxRole.addChild(this._uiScene),this._uiScene.setModelBox(this,this.lbName,this.lbDesc),this._listUIScene=new Base2dSceneLayerExt,this.skinPanel.addChild(this._listUIScene),this.skinPanel.mouseEnabled=!1,this.skinPanel.hScrollBarSkin="",this.bgPanel.box_Content.addChild(this.img_bg),this.bgPanel.box_Content.addChild(this.skinList),this.btn_rotateleft.on(Laya.Event.CLICK,this,this.rotateModel,[1]),this.btn_rotateright.on(Laya.Event.CLICK,this,this.rotateModel,[2])},i.prototype.popup=function(){t.prototype.popup.call(this),this.initView()},i.prototype.show=function(){t.prototype.show.call(this),this.initView()},i.prototype.onOpened=function(){t.prototype.onOpened.call(this),this.renderSkinPanel()},i.prototype.close=function(){t.prototype.close.call(this),this._uiScene.onExit(),this._listUIScene.onExit(),this.skinList.array=null,this.skinList.selectedIndex=-1,Laya.timer.clearAll(this),this._godVo=null,this._tbGod=null},i.prototype.initView=function(){var e=this;this._uiScene.onShow(),this._listUIScene.onShow(),this._isOpenByTujian=UIMgr.hasStage(UIConst.TujianView);var t=this.dataSource;t[0]instanceof GodItemVo?this._godVo=t[0]:t[0]instanceof tb.TB_god&&(this._tbGod=t[0]);var i=(this._godVo?this._godVo.tab_god:this._tbGod).getSkinList(),n=i.map(function(t){return{godVo:e._godVo,skinVo:t}});this.skinList.array=n,this.skinList.scrollBar&&(this.skinList.scrollBar.touchScrollEnable=3<n.length);var o=0,a=0;a=2<=t.length?t[1]:this._godVo?this._godVo.skinId:0,o=-1==(o=i.findIndex(function(t){return t.skinId==a}))?0:o,this.skinList.selectedIndex=o},i.prototype.selectHandler=function(t){-1!=t&&this.updateView()},i.prototype.onSkinRender=function(t,e){if(t){var i=this.skinList.selectedIndex==e;(t.imgDi.visible=i)?t.ani1.play(0,!0):t.ani1.gotoAndStop(0)}},i.prototype.updateView=function(t){void 0===t&&(t=!0);var e=this.skinList.selectedIndex;if(-1!=e){var i=this.skinList.array[e],n=i?i.skinVo:null;if(i&&n){this.lbName.text=n.getName(),this._godVo?this._godVo.tab_god:this._tbGod;var o=!!this._godVo&&n.isActivity(this._godVo.awakenLv);this.costItem.visible=this.lbCost.visible=this.lbHas.visible=!1,this.lbAttr.text="";var a=n.getTbAttrStrAry();if(a)for(var r=0;r<a.length;r++)this.lbAttr.text+=a[r][0]+" "+a[r][1]+(r==a.length-1?"":"      ");if(t&&Laya.timer.once(300,this,this.delayShow,[n.getModelId()]),this._isOpenByTujian)return this.btnWear.visible=!1,this.lbDesc.visible=!0,void(this.lbDesc.text=n.getCondition());if(this.canActivityRP.visible=n.isCanActivity(),o){var s=n.isWear(this._godVo.skinId);this.lbDesc.visible=s,this.lbDesc.text=LanMgr.getLan("",12365),this.btnWear.visible=!s,this.btnWear.label=LanMgr.getLan("",12366)}else if(n.skinId==h.GodSkinType.awaken)this.btnWear.visible=!1,this.lbDesc.visible=!0,this.lbDesc.text=LanMgr.getLan("",12361,tb.TB_god_set.get_TB_god_set().awake_section);else if(n.isNeedCost()){this.btnWear.visible=!0,this.btnWear.label=LanMgr.getLan("",12367),this.lbDesc.visible=!1,this.costItem.visible=this.lbCost.visible=this.lbHas.visible=!0,this.costItem.dataSource=n.costVo,this.lbCost.text="/"+n.costVo.count;var u=App.hero.getBagItemNum(n.costVo.id);this.lbHas.text=u+"",this.lbHas.color=u>=n.costVo.count?ColorConst.normalFont:ColorConst.RED}else this.btnWear.visible=!1,this.lbDesc.visible=!0,this.lbDesc.text=LanMgr.getLan("",12362)}}},i.prototype.onWear=function(){var e=this;if(this._godVo){var t=this._godVo,i=this.skinList.array[this.skinList.selectedIndex],n=i?i.skinVo:null;if(t&&i&&n)if(n.isActivity(t.awakenLv)&&!n.isWear(t.skinId))(o={})[Protocol.game_god_setGodSkinId.args.godId]=t.uuid,o[Protocol.game_god_setGodSkinId.args.skinId]=n.skinId,PLC.request(Protocol.game_god_setGodSkinId,o,function(t){t&&(e.updateView(!1),e.skinList.refresh(),UIMgr.hasStage(UIConst.God_MainView)&&UIMgr.getUIByName(UIConst.God_MainView).godView.refreshModel(),dispatchEvt(new h.GodEvent(h.GodEvent.WEAR_SUCCESS)))});else if(!n.isActivity(t.awakenLv)&&n.isNeedCost()){if(!App.isEnough(n.costVo.id,n.costVo.count))return void showToast(LanMgr.getLan("",10373));var o;(o={})[Protocol.game_god_activeGodSkin.args.godId]=t.uuid,o[Protocol.game_god_activeGodSkin.args.skinId]=n.skinId,PLC.request(Protocol.game_god_activeGodSkin,o,function(t){t&&(e.updateView(!1),e.skinList.refresh(),UIMgr.hasStage(UIConst.God_MainView)&&UIMgr.getUIByName(UIConst.God_MainView).godView.refreshModel(),dispatchEvt(new h.GodEvent(h.GodEvent.WEAR_SUCCESS)))})}}},i.prototype.delayShow=function(t){var e=this.boxRole.localToGlobal(new Laya.Point(0,0));this._uiScene.addModelChar(t,e.x+this.boxRole.width/2-Launch.offsetX,e.y-Launch.offsetY-50,180,2.7),this._uiScene.sceneChar.play(tl3d.CharAction.ATTACK_02,2)},i.prototype.rotateModel=function(t){this._uiScene.sceneChar.rotationY=1==t?this._uiScene.sceneChar.rotationY-15:this._uiScene.sceneChar.rotationY+15},i.prototype.renderSkinPanel=function(){for(var i=this,t=[],e=0;e<this.skinList.array.length;e++){var n=this.skinList.array[e];n&&n.skinVo&&t.push(n.skinVo)}for(e=0;e<t.length;e++)Laya.timer.once(50*e,this,function(t,e){i.skinPanelShow(t,e)},[h.GodUtils.getGodModel(t[e].skinId,t[e].tbGod),e])},i.prototype.skinPanelShow=function(t,e){if(t){var i=this.skinPanel.localToGlobal(new Laya.Point(0,0)),n=i.x+204*e+this.skinList.spaceX*e+102-Launch.offsetX,o=i.y+220-Launch.offsetY;this._listUIScene.addModelChar(t,n,o,180,1.3)}},i.prototype.onScrollChange=function(){this.skinList.scrollBar&&(this._listUIScene.x=-this.skinList.scrollBar.value)},i);function i(){return t.call(this)||this}h.GodSkinView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.render.GodSkinIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=t.skinVo;this.imgBg.skin=e.getBgSkin(),this.lbName.text=e.getName(),this.imgWear.visible=t.godVo&&e.skinId==t.godVo.skinId;var i=UIMgr.hasStage(UIConst.TujianView);this.canActivityRP.visible=!i&&e.isCanActivity(),this.ani1.play(0,!0)}else this.ani1.gotoAndStop(0)},n);function n(){return e.call(this)||this}t.GodSkinIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(t){var e,i=(e=ui.god.ReplaceGodUI,__extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12338)},this.raceList.selectHandler=new Handler(this,this.onRaceSelect),this.raceList.selectedIndex=-1,this._godAry=[]},n.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},n.prototype.getPos=function(){return this._pos},n.prototype.getGodVo=function(){return this._godVo},n.prototype.initView=function(){var t=this.dataSource;this._godVo=t[0],this._pos=t[1];var e=__spreadArrays(App.hero.getGodArr());(e=e.filter(function(t){return!t.isInLinuep(iface.tb_prop.lineupTypeKey.attack)})).forEach(function(t){t.sortNum=1e5*-t.starLevel-100*t.level-10*t.tab_god.quality+t.tab_god.race_type}),this._godAry=e.sort(function(t,e){return t.sortNum-e.sortNum}),this.raceList.array=[0,1,2,3,4,5],this.raceList.selectedIndex=0},n.prototype.onRaceSelect=function(e){if(-1!=e){var t=0==e?this._godAry:this._godAry.filter(function(t){return t.getRaceType()==e});this.godList.array=t,this.boxEmpty.visible=0==t.length}},n.prototype.getIRByid=function(t){for(var e=this.godList.cells,i=0;i<e.length;i++){var n=e[i];if(n.dataSource&&n.dataSource.templateId==t)return n}return e[0]},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.godList.array=null,this.raceList.array=null,this.raceList.selectedIndex=-1,this._godAry.length=0},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t}t.ReplaceGodView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.render.TabItemRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){t&&(this.btn_name.label=isArrayFn(t)?t[0]:t)},n);function n(){return e.call(this)||this}t.godTabIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(c){var e,t=(e=ui.god.render.SkillInfoBoxUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this._dataSource;if(t){var e=10,i=tb.TB_god.get_TB_godById(t.godId);i&&(e=i.star[1]),this.ui_icon.dataSource={skill:t.skill,openDgLv:t.openDgLv,dgLv:10};var n=t.skill;if(this.lbName.text=n.name+"  Lv."+n.level,this.lab_type.text=LanMgr.getLan("",12342)+":"+(3==n.type?LanMgr.getLan("",12340):LanMgr.getLan("",12341)),this.clearBuffList(),n.effect_desc&&0<n.effect_desc.length){var o=new Laya.Image(SkinUtil.fengexian);o.width=344,o.x=28,this.addChildAt(o,1),this._buffList.push(o);for(var a=0,r=n.effect_desc.length;a<r;a++){var s=tb.TB_skill_desc.getTbSkillDesc(n.effect_desc[a]);if(s){var u=new Laya.Label;u.fontSize=22,u.color=ColorConst.LIGHT,u.x=28,u.text="【"+s.name+"】",this.addChild(u),this._buffList.push(u);var h=new Laya.Label;h.autoSize=!0,h.width=344,h.wordWrap=!0,h.leading=5,h.fontSize=20,h.color="#b59c7e",h.x=28,h.text=s.desc,this.addChild(h),this._buffList.push(h)}}}if(this.lab_info.text=""+n.info,0<t.openDgLv&&t.dgLv<t.openDgLv)this.lab_condition.text=LanMgr.getLan("",12368,t.openDgLv);else{var l=c.GodUtils.getSkillUpLvCondition(t.index,n.level,e);this.lab_condition.text=0==l?LanMgr.getLan("",12369):LanMgr.getLan("",12370,l)}this.layoutView()}else this.clearBuffList(),this.lab_info.text=this.lbName.text="",this.ui_icon.dataSource=null},i.prototype.layoutView=function(){var t=this.lab_info.y+this.lab_info.height+5;if(0<this._buffList.length)for(var e=0,i=this._buffList.length;e<i;e++){var n=this._buffList[e];n.y=t,t+=n.height+(0==e?10:5)}this.img_split.y=t,t+=15,this.lab_condition.y=t,this.height=t+this.lab_condition.height+20},i.prototype.clearBuffList=function(){for(var t=0,e=this._buffList;t<e.length;t++)e[t].removeSelf();this._buffList.length=0},i);function i(){var t=e.call(this)||this;return t._buffList=[],t.lbName.autoSize=!0,t}c.SkillInfoBox=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.god.render.ReplaceIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t?(this.headbox.dataSource=t,this.lbName.text=t.tab_god.name,this.btnShangzhen.on(Laya.Event.CLICK,this,this.onShangzhen),this.headbox.on(Laya.Event.CLICK,this,this.onShow)):(this.headbox.dataSource=null,this.btnShangzhen.off(Laya.Event.CLICK,this,this.onShangzhen),this.headbox.off(Laya.Event.CLICK,this,this.onShow))},n.prototype.onShangzhen=function(){var t=UIMgr.getUIByName(UIConst.God_ReplaceGodView),e=t.getGodVo();this.dataSource&&i.GodUtils.replaceGod(e,this.dataSource,t.getPos())},n.prototype.onShow=function(){dispatchEvt(new i.TujianEvent(i.TujianEvent.SHOW_GUAIWUXINXI_PANEL),this._dataSource)},n);function n(){return t.call(this)||this}i.godReplaceIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.render.KeZhiForceBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t&&t.halos&&0<t.halos.length){var e=t.halos,i=e[0],n=i.raceType;this._sortNum=n+1e3,this.lab_title.text=LanMgr.RACE_FORCE_STR[n];for(var o=-1,a=e.length-1;0<=a;a--)if(t.godNum>=e[a].godNum){o=a;break}-1!=o&&(this._sortNum=i.type);var r=e.map(function(t,e){return{isActive:o==e,tbData:t}});this.list_kezhi.array=r,this.list_kezhi.repeatY=r.length,this.height=this.img_bg.height=this.list_kezhi.y+this.list_kezhi.height+15,this.img_icon.skin=SkinUtil.getGodBigRaceSkin(n),this.img_icon.gray=-1==o,this.visible=!0}else this.list_kezhi.array=null,this.visible=!1,this._sortNum=0},Object.defineProperty(n.prototype,"sortnum",{get:function(){return this._sortNum},enumerable:!0,configurable:!0}),n);function n(){var t=e.call(this)||this;return t._sortNum=0,t}t.RaceForceIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=ui.god.render.LineupGodIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=!!t.godVo,i=n.GodUtils.isUnlock(t.pos,t.userLv||App.hero.level);this.headBox.visible=e,this.headBox.dataSource=e?t.godVo:null,this.box_null.visible=!e,this.btn_add.visible=!e&&i,this.imgLock.visible=this.lbLock.visible=!i,this.lbLock.text=n.GodUtils.getUnlockLv(t.pos)+LanMgr.getLan("",10031),this.headBox.img_shangzhen.visible=!1,this.anim_select.play()}else this.headBox.dataSource=null,this.anim_select.gotoAndStop(0)},i);function i(){return t.call(this)||this}n.LineupGodIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.render.SkillItemIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t&&t.skill){var e=t.skill;this.icon.skin=e.getIconUrl();var i=t.dgLv>=t.openDgLv;this.icon.gray=this.imgSuo.visible=!i,this.lab_lv.visible=i,this.lab_lv.text="Lv."+e.level}else this.icon.skin=null,this.icon.gray=!1,this.imgSuo.visible=!1,this.lab_lv.visible=!1},n);function n(){return e.call(this)||this}t.GodSkillItemIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.render.HaveItemBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){this.img_icon.skin=SkinUtil.getRonghunHave(t),this.lab_have.text=String(App.hero.getBagItemNum(t))},n);function n(){return e.call(this)||this}t.godFuseUseIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.render.RonghunBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){this.dataSource?(this.img_jindu.skin=SkinUtil.getJinduBox(this._dataSource.attrNo),this.icon.skin=SkinUtil.getAwakenIcon(this._dataSource.attrNo),this.updateView(),this.ballRP.onDispose(),this.ballRP.setRedPointName("god_ball_"+this._dataSource.curVo.uuid+"_"+this._dataSource.attrNo)):(this.ballRP.onDispose(),this.img_jindu.mask=null,this._oldAttrVal=-1)},n.prototype.setSelect=function(t){t?this.ani_select.loadAnimation(ResConst.anim_circle_select,Handler.create(this,function(){this.ani_select.play(),this.ani_select.visible=!0}),ResConst.atlas_circle_select):(this.ani_select.visible=!1,this.ani_select.gotoAndStop(0))},n.prototype.updateView=function(){var t=this._dataSource.curVo,e=this._dataSource.attrNo,i=tb.TB_fusion_soul.get_TB_fusion_soulById(t.fuseLevel),n=t.countRonghunAttr(),o=n[e]>i.getMaxAttr(e)?1:n[e]/i.getMaxAttr(e),a=this.img_jindu.mask;this.img_jindu.mask||((a=new Laya.Sprite).graphics.drawRect(0,0,107,107,""),this.img_jindu.mask=a),-1==this._oldAttrVal?(a.pos(0,107*(1-o)),this._oldAttrVal=n[e]):Laya.Tween.to(a,{y:107*(1-o)},500),this.lbMax.visible=n[e]>=i.getMaxAttr(e),this.lab_attr.text=LanMgr.attrName[e]+"："+n[e]},n);function n(){var t=e.call(this)||this;return t._oldAttrVal=-1,t}t.godFuseIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.render.ChooseBoxUI,__extends(n,e),n.prototype.onBtnClick=function(){this._dataSource&&(this.dataSource.isInLinuep()||(this._dataSource.selected=!this._dataSource.selected,this.img_gouxuan.visible=this._dataSource.selected))},Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){if(this._dataSource){var t=this._dataSource;this.img_gouxuan.visible=t.selected,this.dataSource instanceof GodItemVo?this.god_icon.dataSource=t:this.item_icon.dataSource=t,this.dataSource instanceof GodItemVo?this.gray=this.dataSource.isInLinuep(iface.tb_prop.lineupTypeKey.attack):this.gray=!1,this.item_icon.visible=this.dataSource instanceof ItemVo,this.god_icon.visible=this.dataSource instanceof GodItemVo}},n);function n(){var t=e.call(this)||this;return t.on(Laya.Event.CLICK,t,t.onBtnClick),t}t.godChooseIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=ui.god.ZhenYingKeZhiUI,__extends(i,e),i.prototype.popup=function(){e.prototype.popup.call(this),this.zOrder=UI_DEPATH_VALUE.TOP+3,this.initView()},i.prototype.onClosed=function(){e.prototype.onClosed.call(this),this._allHalo=null,this.clearRaceForceIR()},i.prototype.initView=function(){var t=this.dataSource||{};if(this._allHalo=tb.TB_halo.getAllType(),this.clearRaceForceIR(),this._allHalo&&0<this._allHalo.length){this._allRaceAttr=[];for(var e=0;e<this._allHalo.length;e++){var i=this._allHalo[e];if(i&&0<i.length){var n=new o.RaceForceIR;n.dataSource={godNum:t[e]||0,halos:i},this.panel_attr.addChild(n),this._allRaceAttr.push(n)}}this.layoutAttr()}this.panel_attr.scrollTo(0,0)},i.prototype.layoutAttr=function(){if(this._allRaceAttr){this._allRaceAttr.sort(function(t,e){return t.sortnum-e.sortnum});for(var t=0,e=0;e<this._allRaceAttr.length;e++){var i=this._allRaceAttr[e];i.x=10,i.y=t,t+=i.height+10}}},i.prototype.clearRaceForceIR=function(){if(this._allRaceAttr){for(var t=0;t<this._allRaceAttr.length;t++)this._allRaceAttr[t].dataSource=null,this._allRaceAttr[t].destroy(),this._allRaceAttr[t]=null;this._allRaceAttr=null}},i);function i(){var t=e.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.God_kezhiView,closeOnSide:t.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12339)},t.panel_attr.vScrollBarSkin="",t}o.kezhiView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var t,e=(t=ui.god.GuanghuanUI,__extends(i,t),i.prototype.initView=function(t,o){function e(t){var e=a["img"+t];if(!e)return 1;var i=o[t]||0;if(e.visible=0<i,0<i){e.skin=SkinUtil.getGodRaceSkin(i);var n=o.filter(function(t){return t==i}).length;e.gray=!r.GodUtils.isActiveHalo(i,n)}}this._posAry=o,this.imgBg.skin=0==t?SkinUtil.wofang_guanghuan:SkinUtil.difang_guanghuan;for(var a=this,i=0;i<6;i++)e(i);this.on(Laya.Event.CLICK,this,this.onShow)},i.prototype.onShow=function(){var t={};if(this._posAry)for(var e=0,i=this._posAry;e<i.length;e++){var n=i[e];t[n]=t[n]||0,t[n]+=1}dispatchEvt(new r.GodEvent(r.GodEvent.SHOW_KEZHI_VIEW),t)},i.prototype.onExit=function(){this._posAry=null,this.off(Laya.Event.CLICK,this,this.onShow)},i);function i(){return t.call(this)||this}r.GuanghuanView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var s,e=(s=ui.god.GuaiwuxinxiUI,__extends(i,s),i.prototype.popup=function(){s.prototype.popup.call(this,!1,!0);var t=this.dataSource;this.headBox.dataSource=t,this._arrskilldata=[];var e=this.dataSource.getSkillList();for(var i in e){var n=tb.TB_skill.get_TB_skillById(e[i][0]);if(n&&1!=n.type){var o=e[i][1];this._arrskilldata.push({skill:n,isShow:!1,isShowlist:!1,openDgLv:o,dgLv:this.dataSource.degree})}}this.list_skill.array=this._arrskilldata,this.list_skill.selectedIndex=0,this.list_skill.selectEnable=!0,this.list_skill.width=90*this._arrskilldata.length+(this._arrskilldata.length-1)*this.list_skill.spaceX,this.lab_name.text=t.getName();var a=t.getAttrType?t.getAttrType():0;this.lab_type.text=LanMgr.godTypeName[a];var r=t.getProperty();this.lab_hp.text=Math.floor(r[0][1]).toString(),this.lab_ack.text=Math.floor(r[1][1]).toString(),this.lab_def.text=Math.floor(r[2]?r[2][1]:0).toString(),this.lab_spd.text=Math.floor(r[3]?r[3][1]:0).toString(),this.onSelectSkill(this.list_skill.selectedIndex),this.bgPanel.dataSource={uiName:UIConst.GuaiwuxinxiView,closeOnSide:this.isModelClose}},i.prototype.onSelectSkill=function(t){if(-1!=t){var e=this._arrskilldata[t].skill;this.lab_skill.text=e.name+"  Lv."+e.level,this.lab_open.text=LanMgr.getLan("",12343,this._arrskilldata[t].openDgLv),this.lab_skilldescription.text=""+e.info,this.lab_open.visible=this.dataSource.degree<this._arrskilldata[t].openDgLv,this.lab_skill_type.text=LanMgr.getLan("",12342)+":"+(3==e.type?LanMgr.getLan("",12340):LanMgr.getLan("",12341)),this.lab_open.x=this.lab_skill.x+this.lab_skill.width,this.updateSelect()}},i.prototype.updateSelect=function(){for(var t=this.list_skill.selectedIndex,e=0;e<this.list_skill.cells.length;e++){var i=this.list_skill.cells[e],n=e==t;(i.selectBox.visible=n)?i.selectBox.play():i.selectBox.gotoAndStop(0)}},i.prototype.close=function(){s.prototype.close.call(this,"",!0),this.bgPanel.dataSource=null,this.list_skill.array=null,this.list_skill.selectedIndex=-1},i);function i(){var t=s.call(this)||this;return t._sdsx=0,t._sdsy=0,t._arrskilldata=[],t.isModelClose=!0,t.list_skill.selectHandler=new Handler(t,t.onSelectSkill),t.list_skill.selectedIndex=-1,t.bgPanel.addChildAt(t.img_bg,3),t}t.GuaiwuxinxiView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var s,t=(s=ui.god.NewGodMainUI,__extends(e,s),e.prototype.createChildren=function(){s.prototype.createChildren.call(this),this.roleList.mouseHandler=new Handler(this,this.onMouseClick),this.roleList.renderHandler=new Handler(this,this.onRender),this.roleList.selectedIndex=-1,this._curIdx=-1,this.godView.visible=!1},e.prototype.setSize=function(t,e){s.prototype.setSize.call(this,t,e),this.godView.height=e,this.boxList.y=GameUtil.isFullScreen()?5+r.HudModel.TOP_ADD_HEIGHT:5},e.prototype.onOpened=function(){s.prototype.onOpened.call(this),this.godView.toOpen(),this._initIndex=this.dataSource&&isNaN(this.dataSource[1])?-1:this.dataSource[1];var e=this.dataSource?this.dataSource[0]:null,t=r.GodModel.getInstance().getViewGods(),i=t.filter(function(t){return t.godVo}).length;this.roleList.array=t,this.godView.visible=0<i;var n=t.findIndex(function(t){return t&&t.godVo&&t.godVo.uuid==e});i<=0&&0<App.hero.getGodArr().length&&this.godView.onBuzhen(),this.setGodSelectIndex(-1!=n?n:0);var o=GameUtil.isFullScreen()?5+r.HudModel.TOP_ADD_HEIGHT:5;UIUtil.boxUpDownTween(this.boxList,-this.boxList.height,o,!1,310,.1);var a=this.godView.height-this.godView.boxBottom.height-80;UIUtil.boxUpDownTween(this.godView.boxBottom,a+this.godView.boxBottom.height,a,!0,310,.05),this.godView.btnChange.visible=this.godView.btn_gh.visible=this.godView.btnBuzhen.visible=!0},Object.defineProperty(e.prototype,"curVo",{get:function(){return this.godView.curVo},enumerable:!0,configurable:!0}),e.prototype.onMouseClick=function(t,e){if(t.type==Laya.Event.CLICK){if(-1==e)return;var i=this.roleList.array[e];if(!i)return;if(!r.GodUtils.isUnlock(i.pos,App.hero.level))return this.roleList.selectedIndex=this._curIdx,void showToast(LanMgr.getLan("",10158,r.GodUtils.getUnlockLv(i.pos)));if(!i.godVo)return r.GodUtils.isCanBuzhen()?void dispatchEvt(new r.GodEvent(r.GodEvent.SHOW_REPLACE_VIEW)):void showToast(LanMgr.getLan("",10372));if(e==this._curIdx)return;this.setGodSelectIndex(e,!0)}},e.prototype.setGodSelectIndex=function(t,e){void 0===e&&(e=!0);var i=this.roleList.array[t];i&&i.godVo&&(this._curIdx=t,this.roleList.selectedIndex=t,this.selectGod(i,e))},e.prototype.selectGod=function(t,e){void 0===e&&(e=!0),this.godView.curVo=t.godVo,dispatchEvt(new r.GodEvent(r.GodEvent.SELECT_GOD_EVENT));var i=this.godView.tabList.selectedIndex;-1!=this._initIndex&&(i=this._initIndex,this._initIndex=-1),-1!=i?this.godView.onSetIndex(i):this.godView.tabList.selectedIndex=0,t.godVo&&(this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.SHENLING,t.godVo.tab_god.race_type))},e.prototype.onRender=function(t,e){var i=t.dataSource;t.redPoint.onDispose(),i&&(i.godVo?t.redPoint.setRedPointName("attack_linuep_god_"+i.godVo.uuid):r.GodUtils.isUnlock(i.pos,App.hero.level)&&t.redPoint.setRedPointName("shenling_buzhen_group"))},e.prototype.refreshRoles=function(){var e=this.roleList.selectedItem,t=r.GodModel.getInstance().getViewGods(),i=t.findIndex(function(t){return e&&t.godVo&&e.godVo&&t.godVo.uuid==e.godVo.uuid}),n=-1==i,o=(this.roleList.array=t).filter(function(t){return t.godVo}).length;this.godView.visible=0<o,i=-1!=i?i:0,this.setGodSelectIndex(i,n)},e.prototype.refreshRolesByGod=function(t,e){void 0===e&&(e=!1),t&&t&&this.godView.curVo&&(this.godView.curVo.uuid==t.uuid&&(this.godView.updateView(),this.godView.refreshCurRole()),this.roleList.refresh())},e.prototype.changeRole=function(e,t){var i=this.roleList.array.find(function(t){return e?t&&t.godVo&&t.godVo.uuid==e.uuid:t&&!t.godVo}),n=this.roleList.array.indexOf(i);if(-1!=n){var o={pos:i.pos,godVo:t};this.roleList.array[n]=o,this.setGodSelectIndex(n,!0),this.roleList.refresh()}},e.prototype.onClosed=function(){s.prototype.onClosed.call(this),this.godView.toClose(),this.godView.btnChange.visible=!1,this.roleList.array=null,this.roleList.selectedIndex=-1,this._curIdx=-1},e.prototype.getCanShangzhenIR=function(){for(var t=this.roleList.cells,e=0;e<t.length;e++){var i=t[e],n=i.dataSource;if(n&&!n.godVo&&r.GodUtils.isUnlock(n.pos,App.hero.level))return i}return null},Object.defineProperty(e.prototype,"list_tab",{get:function(){return this.godView.tabList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewInfo",{get:function(){return this.godView.viewInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewJuexing",{get:function(){return this.godView.viewJuexing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewStarup",{get:function(){return this.godView.viewStarup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewRonghun",{get:function(){return this.godView.viewRonghun},enumerable:!0,configurable:!0}),e);function e(){var t=s.call(this)||this;return t._initIndex=-1,t.group=UIConst.hud_group,t}r.GodMainView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.GodLiHuiUI,__extends(u,e),u.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},u.prototype.initView=function(){this.panel_main.on(Laya.Event.MOUSE_DOWN,this,this.onDown),this.panel_main.on(Laya.Event.MOUSE_UP,this,this.onUp),this.panel_main.on(Laya.Event.MOUSE_OUT,this,this.onUp),this.btn_reduce.on(Laya.Event.CLICK,this,this.onClickReduce),this.btn_add.on(Laya.Event.CLICK,this,this.onClickAdd),this.btn_close.on(Laya.Event.CLICK,this,this.close),this.sl_scale.changeHandler=Handler.create(this,this.onScaleChange,null,!1),this.sl_scale.showLabel=!1,this._godTemp=this.dataSource,this.lab_title.text=this._godTemp.name,this.updateView()},u.prototype.updateView=function(){var t=this;this.img_god.skin=SkinUtil.getLiHuiIcon(this._godTemp.paint),this.img_god.scale(1,1),this.img_god.x=this.panel_main.width/2,this.img_god.y=this.panel_main.height/2,Laya.timer.frameOnce(3,this,function(){t.sl_scale.value=100})},u.prototype.onDown=function(t){this._isDown=!0,this._lastPosX=t.currentTarget.mouseX,this._lastPosY=t.currentTarget.mouseY,this.panel_main.on(Laya.Event.MOUSE_MOVE,this,this.onMove);var e=t.touches;e&&2==e.length&&(this.lastDistance=this.getDistance(e))},u.prototype.getDistance=function(t){var e=0;if(t&&2==t.length){var i=t[0].stageX-t[1].stageX,n=t[0].stageY-t[1].stageY;e=Math.sqrt(i*i+n*n)}return e},u.prototype.onMove=function(t){if(this._isDown){var e=t.touches;if(e&&2==e.length){var i=this.getDistance(t.touches),n=(i-this.lastDistance)*this.factor;this.lastDistance=i,n+=this.sl_scale.value,n=Math.min(u.SCALE_MAX,n),this.sl_scale.value=Math.max(u.SCALE_MIN,n)}else{var o=t.currentTarget.mouseX,a=t.currentTarget.mouseY,r=o-this._lastPosX,s=a-this._lastPosY;this._lastPosX=o,this._lastPosY=a,this.img_god.x+=r,this.img_god.y+=s}}},u.prototype.onUp=function(t){this._isDown=!1,this.panel_main.off(Laya.Event.MOUSE_MOVE,this,this.onMove)},u.prototype.onScaleChange=function(t){var e=this.getScaleBySliderValue(t);this.img_god.scale(e,e)},u.prototype.onClickReduce=function(){this.sl_scale.value=Math.max(u.SCALE_MIN,this.sl_scale.value-1)},u.prototype.onClickAdd=function(){this.sl_scale.value=Math.min(u.SCALE_MAX,this.sl_scale.value+1)},u.prototype.getScaleBySliderValue=function(t){return t/100},u.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.panel_main.off(Laya.Event.MOUSE_DOWN,this,this.onDown),this.panel_main.off(Laya.Event.MOUSE_UP,this,this.onUp),this.panel_main.off(Laya.Event.MOUSE_OUT,this,this.onUp),this.btn_reduce.off(Laya.Event.CLICK,this,this.onClickReduce),this.btn_add.off(Laya.Event.CLICK,this,this.onClickAdd),this.btn_close.off(Laya.Event.CLICK,this,this.close),this.sl_scale.changeHandler&&(this.sl_scale.changeHandler.recover(),this.sl_scale.changeHandler=null),this._godTemp=null},u.SCALE_MIN=50,u.SCALE_MAX=150,u);function u(){var t=e.call(this)||this;return t.factor=.15,t.lastDistance=0,t._isDown=!1,t._lastPosX=0,t._lastPosY=0,t.isModelClose=!0,t.img_bg.skin=SkinUtil.getSysMapSkin(ModuleConst.GOD_LIHUI),t.panel_main.width=Laya.stage.width,t.panel_main.height=Laya.stage.height,t}t.GodLiHuiView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(a){var n,t=(n=ui.god.GodIntroduceUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this._model=a.GodModel.getInstance(),this.uiScene=new Base2dSceneLayer,this.roleBox.addChild(this.uiScene),this.uiScene.setModelBox(this,this.hbox,this.roleBox),this.list_shuxingup.renderHandler=new Handler(this,this.onUpRender),this.starList.renderHandler=new Handler(this,this.onXingjiRender),this.btnZiliao.on(Laya.Event.CLICK,this,this.onLookInfo),this.btnChange.on(Laya.Event.CLICK,this,this.onChange),this.box_model.on(Laya.Event.CLICK,this,this.onClickModel),this.btn_gh.on(Laya.Event.CLICK,this,this.onClickGH),this.btn_peiyin.on(Laya.Event.CLICK,this,this.onClickPeiYin),this.btn_lihui.on(Laya.Event.CLICK,this,this.onClickLiHui),this.btnSkin.on(Laya.Event.CLICK,this,this.onSkin),this.btnBuzhen.on(Laya.Event.CLICK,this,this.onBuzhen),this.list_attr.renderHandler=new Handler(this,this.onAttrRender),this.tabList.renderHandler=new Handler(this,this.onRenderIndex),this.tabList.selectedIndex=-1;var t=this._model;this.tabList.array=__spreadArrays(t.tabTypes);var e=t.tabTypes;this._tabInfoList=[];for(var i=0;i<e.length;i++)this._tabInfoList.push(this.buildTabInfo(e[i]));this._tabOperate=new common.TabListOperate(this.tabList,this.viewStack),this._tabOperate.setTabItemist(this._tabInfoList)},e.prototype.buildTabInfo=function(t){var i=this._model.getTabViewDatas(t);return{viewName:i.viewName,viewClz:i.viewClz,onSelectVerify:function(){var t=i.sysId,e=tb.TB_sys_open.get_TB_sys_openById(t);return!(e&&!App.IsSysOpen(t)&&(showToast(e.prompt),1))},onSelectAfter:function(){dispatchEvt(new a.GodEvent(a.GodEvent.SWITCH_TAB_SUCCESS))},onShow:function(t){t&&GameUtil.isFunction(t.init)&&t.init()},onHide:function(t){t&&GameUtil.isFunction(t.close)&&t.close()},onClosed:function(t){t&&GameUtil.isFunction(t.close)&&t.close()},dataSource:null}},e.prototype.toOpen=function(){tl3d.ModuleEventManager.addEvent(a.TreasureEvent.TREASURE_OPERATION,this.treasureOpt,this)},e.prototype.toClose=function(){tl3d.ModuleEventManager.removeEvent(a.TreasureEvent.TREASURE_OPERATION,this.treasureOpt,this),this._curVo=null,Laya.timer.clearAll(this),this._lastmodel=0,this.uiScene.onExit(),this.starList.array=null,this.list_shuxingup.array=null,this.godSkinRP.onDispose(),this._tabOperate.viewDispose()},e.prototype.treasureOpt=function(){this.timer.frameOnce(5,this,this.changeAttr)},Object.defineProperty(e.prototype,"curVo",{get:function(){return this._curVo},set:function(t){for(var e=0,i=this._tabInfoList;e<i.length;e++)i[e].dataSource=t;var n=!this._curVo||this.curVo.uuid!=t.uuid;this._curVo=t,this.playPySound(this._curVo.templateId),a.EquipModel.getInstance().curShowGod=this._curVo,this.tabList.refresh();var o=tb.TB_god.get_TB_godById(this._curVo.templateId);this.btn_lihui.visible=o&&0!=o.paint,n?this.initView():this.updateView()},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.uiScene.onShow(),this.initData(),this.updateView(),a.TreasureTipsView.HideTip()},e.prototype.initData=function(){var t=this._curVo;if(t){this.updateView();var e=t.tab_god;this.refreshModel(),this.imgRace.skin=SkinUtil.getGodRaceSkin(t.getRaceType()),this.lab_name.text=e.name,this.lab_name.event(Laya.Event.RESIZE),this.hbox.refresh()}},e.prototype.updateView=function(){var t=this._curVo;if(t){this.lbShenli.text=t.getShenli().toString();for(var e=t.isMoreThanSix()?t.getStar()-5:t.getStar(),i=new Array,n=0;n<e;n++)i[n]=6<=t.starLevel;this.starList.repeatX=e,this.starList.array=i,this.starList.x=(this.width-this.starList.width)/2-20,this.refreshModel(),this.treasureUI.dataSource=t,this.godSkinRP.setRedPointName("god_skin_"+t.uuid),this.changeAttr()}},e.prototype.onSetIndex=function(t){if(-1!=t)if(this.tabList.selectedIndex==t){var e=this._tabOperate.getViewName(t);this._tabOperate.updateItemByName(e,this._curVo)}else this.tabList.selectedIndex=t},e.prototype.refreshModel=function(){var t=this._curVo;if(t){var e=t.tab_god,i=a.GodUtils.getGodModel(t.skinId,e);this._lastmodel!=i&&Laya.timer.once(200,this,this.showModel,[i])}},e.prototype.refreshCurRole=function(){var t=this.tabList.selectedIndex;t==ShenlingTabType.info?this.viewInfo&&this.viewInfo.updateXinxi():t==ShenlingTabType.shengxin?this.viewStarup&&this.viewStarup.init():t==ShenlingTabType.ronghun?this.viewRonghun&&this.viewRonghun.init():t==ShenlingTabType.awaken&&this.viewJuexing&&this.viewJuexing.refreshJuexing()},e.prototype.onUpRender=function(t,e){this.list_shuxingup&&this.list_shuxingup.dataSource&&this.list_shuxingup.dataSource[e]&&2==this.list_shuxingup.dataSource[e].length&&(t.text=this.list_shuxingup.dataSource[e][0]+"+"+this.list_shuxingup.dataSource[e][1])},e.prototype.onXingjiRender=function(t,e){t.dataSource?(t.skin=SkinUtil.superXing,t.width=29,t.height=31):t.skin=SkinUtil.xingxing},e.prototype.onLookInfo=function(){this._curVo&&dispatchEvt(new a.TujianEvent(a.TujianEvent.SHOW_EVALUATION_PANEL),this._curVo.tab_god)},e.prototype.onClickModel=function(){this.uiScene.sceneChar&&(this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_01,2),this._curVo&&this.playPySound(this._curVo.templateId))},e.prototype.onChange=function(){var e=this._curVo;if(e){var t=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack,!0).findIndex(function(t){return t==e.uuid});if(-1!=t){var i=this._model.getLinuepGodTbid(iface.tb_prop.lineupTypeKey.attack),n=i.indexOf(e.templateId);if(-1!=n&&i.splice(n,1),!App.hero.getGodArr().some(function(t){return-1==i.indexOf(t.templateId)&&t.uuid!=e.uuid}))return void showToast(LanMgr.getLan("",10372));dispatchEvt(new a.GodEvent(a.GodEvent.SHOW_REPLACE_VIEW),[e,t])}}},e.prototype.onRenderIndex=function(t,e){if(this._curVo){t.img_suo.visible=!1;var i=t.dataSource;if(i==ShenlingTabType.ronghun?(t.btn_name.label=LanMgr.getLan("",12344),t.img_suo.visible=!App.IsSysOpen(ModuleConst.RONGHUN),t.img_suo.dataSource=ModuleConst.RONGHUN):i==ShenlingTabType.awaken?(t.btn_name.label=LanMgr.getLan("",12345),t.img_suo.visible=!App.IsSysOpen(ModuleConst.JUEXING),t.img_suo.dataSource=ModuleConst.JUEXING):i==ShenlingTabType.shengxin?(t.btn_name.label=LanMgr.getLan("",12346),t.img_suo.visible=!App.IsSysOpen(ModuleConst.SHENGXING),t.img_suo.dataSource=ModuleConst.SHENGXING):t.btn_name.label=LanMgr.getLan("",12347),t.btn_name.selected=e==this.tabList.selectedIndex&&!t.img_suo.visible,t.tabRedPoint.onDispose(),!t.img_suo.visible){var n=this._model.tabredName[e];t.tabRedPoint.setRedPointName(n+"_"+this._curVo.uuid)}t.btn_name.labelSize=this.tabList.selectedIndex==e?24:22,t.btn_name.labelColors=this.tabList.selectedIndex==e?"#7e5336,#7e5336,#7e5336":"#e6ca91,#e6ca91,#e6ca91"}},e.prototype.onClickGH=function(){dispatchEvt(new a.GodEvent(a.GodEvent.SHOW_KEZHI_VIEW))},e.prototype.showModel=function(t){this._lastmodel=t;var e=this.roleBox.localToGlobal(new Laya.Point(0,0));this.uiScene.addModelChar(t,e.x+this.roleBox.width/2-Launch.offsetX,e.y+10-Launch.offsetY),this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_01,2)},e.prototype.sendShuxingEvent=function(){var t=this._curVo;if(t){var e;AudioMgr.playSound("sound/goduplevel.mp3"),e=t.starLevel<=6||t.degree<=6?tb.TB_god_evolution.get_TB_god_evolutionById(t.degree):tb.TB_god_evolution.get_TB_god_evolutionById(t.starLevel);for(var i=new Array,n=0;n<3;n++)i.push([LanMgr.attrName[n+1],Math.floor(t.tab_god.attr_grow[n][1]*e.star_growth[n][1])]);this.showShuxing(i)}},e.prototype.showShuxing=function(t){var e=this;this.list_shuxingup.zOrder=9999,this.list_shuxingup.dataSource=t,this.list_shuxingup.x=290,this.list_shuxingup.y=456,this.list_shuxingup.alpha=1,this.list_shuxingup.visible=!0,Laya.Tween.clearAll(this.list_shuxingup);var i=this.roleBox.localToGlobal(new Laya.Point(0,0)),n=this.uiScene.get3dPos(i.x+this.roleBox.width/2-Launch.offsetX,i.y+this.roleBox.height-Launch.offsetY);this.uiScene.addEffect(this,1000004,n,4,20,null,0,0,!0),Laya.Tween.to(this.list_shuxingup,{x:320},100,null,Handler.create(this,function(){Laya.Tween.to(e.list_shuxingup,{y:370,alpha:.2},500,null,Handler.create(e,function(){e.list_shuxingup.visible=!1}))}))},e.prototype.showJuexingEffect=function(t){var e=this;this.list_shuxingup.zOrder=9999,this.list_shuxingup.array=t,this.list_shuxingup.x=290,this.list_shuxingup.y=456,this.list_shuxingup.alpha=1,this.list_shuxingup.visible=!0,Laya.Tween.clearAll(this.list_shuxingup),this.uiScene.scene.playLyf(getEffectUrl("1000004"),new tl3d.Vector3D(160,0,-440),20,4),Laya.Tween.to(this.list_shuxingup,{x:320},100,null,Handler.create(this,function(){Laya.Tween.to(e.list_shuxingup,{y:370,alpha:.2},500,null,Handler.create(e,function(){e.list_shuxingup.visible=!1}))}))},e.prototype.onSkin=function(){this._curVo&&UIMgr.getInstance().showUI(UIConst.GodSkinView,[this._curVo])},e.prototype.onBuzhen=function(){dispatchEvt(new a.GodEvent(a.GodEvent.SHOW_BUZHEN_PANEL),iface.tb_prop.lineupTypeKey.attack)},e.prototype.onClickLiHui=function(){if(this._curVo){var t=tb.TB_god.get_TB_godById(this._curVo.templateId);t&&0!=t.paint&&UIMgr.showUI(UIConst.GodLiHuiView,t)}},e.prototype.onClickPeiYin=function(){this._curVo&&(this.playPySound(this._curVo.templateId,"",!0),this.uiScene.sceneChar&&this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_01,2))},e.prototype.playPySound=function(t,e,i){if(void 0===e&&(e=""),void 0===i&&(i=!0),i||this._pyGodId!=t){this.stopPySound(),this._pyGodId=t;var n=Laya.Render.isConchApp?"ogg":"mp3";e=LanMgr.getLan("sound/god_peiyin/{0}/voice_{1}_dub.{2}",-1,n,t,n),this._pySoundUrl=e&&""!=e?e:"sound/godpeiyin.mp3",AudioMgr.playSound(this._pySoundUrl)}},e.prototype.stopPySound=function(t){void 0===t&&(t=0),0!=t&&this._pyGodId!=t||(AudioMgr.StopSound(this._pySoundUrl),this._pyGodId=0)},e.prototype.onAttrRender=function(t,e){if(t.dataSource){var i=t.dataSource;t.imgAttr.skin=SkinUtil.getAttrSkin(i[0]),t.lbvalue.text=~~i[1]+""}},e.prototype.changeAttr=function(){var t=this._curVo;if(t){var e=t.getAllAttr(iface.tb_prop.lineupTypeKey.attack);this.list_attr.array=e.filter(function(t){return t[0]<=4}),this.lbShenli.text=t.getShenli().toString()}},e.prototype.getView=function(t){return this._tabOperate.getViewByName(t)},Object.defineProperty(e.prototype,"viewInfo",{get:function(){return this.getView(a.GodModel.tabInfo)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewJuexing",{get:function(){return this.getView(a.GodModel.tabAwaken)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewStarup",{get:function(){return this.getView(a.GodModel.tabStarup)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewRonghun",{get:function(){return this.getView(a.GodModel.tabRonghun)},enumerable:!0,configurable:!0}),e);function e(){var t=n.call(this)||this;return t._lastmodel=0,t._pyGodId=0,t._pySoundUrl="",t}a.GodIntroduceView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.god.GodCultureUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.btnClose.on(Laya.Event.CLICK,this,this.onClick),this.btnLeft.on(Laya.Event.CLICK,this,this.onChange,[-1]),this.btnRight.on(Laya.Event.CLICK,this,this.onChange,[1])},n.prototype.setSize=function(t,e){i.prototype.setSize.call(this,t,e),this.godView.height=e},n.prototype.popup=function(){i.prototype.popup.call(this),this.initView(),this.godView.toOpen()},n.prototype.close=function(){i.prototype.close.call(this),this.godView.toClose()},n.prototype.initView=function(){var t=this.dataSource;this._curSelect=t[0]||0,this._godIdList=t[1]||[];var e=App.hero.getGodVoById(this._godIdList[this._curSelect]);e&&(this.godView.curVo=e,this.godView.tabList.selectedIndex=0,this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.SHENLING,e.tab_god.race_type)),this.godView.btnChange.visible=this.godView.btn_gh.visible=this.godView.btnBuzhen.visible=!1,this.updateBtn()},n.prototype.onChange=function(t){this._curSelect+=t;var e=App.hero.getGodVoById(this._godIdList[this._curSelect]);if(e){var i=this.godView.tabList.selectedIndex;this.godView.curVo=e,this.godView.onSetIndex(i),this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.SHENLING,e.tab_god.race_type)}this.updateBtn()},n.prototype.updateBtn=function(){this.btnLeft.disabled=0==this._curSelect,this.btnRight.disabled=this._curSelect==this._godIdList.length-1},n.prototype.refreshCurRole=function(t){t&&this.godView.curVo&&this.godView.curVo.uuid==t.uuid&&(this.godView.updateView(),this.godView.refreshCurRole())},n.prototype.onClick=function(){this.close()},Object.defineProperty(n.prototype,"viewInfo",{get:function(){return this.godView.viewInfo},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewJuexing",{get:function(){return this.godView.viewJuexing},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewStarup",{get:function(){return this.godView.viewStarup},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewRonghun",{get:function(){return this.godView.viewRonghun},enumerable:!0,configurable:!0}),n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}t.GodCultureView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(t){var e,i=(e=ui.god.GodAttrUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)&&this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource.basicAttr||[];t=__spreadArrays(t);for(var e=this.dataSource.allAttr,i=new Array,n=0;n<4;n++){var o=Math.floor(e[n][1])-Math.floor(t[n][1]);0!=o?i.push(o):i.push(0)}for(n=4;n<8;n++)t[n][1]=Math.floor(1e4*e[n][1])/100+"%";var a=e[iface.tb_prop.attrTypeKey.addDmg-1]||[],r=a[1]||0;r=Math.floor(1e4*r)/100,t.push([iface.tb_prop.attrTypeKey.addDmg,0<r?r+"%":"0%"]),r=(a=e[iface.tb_prop.attrTypeKey.subDmg-1]||[])[1]||0,r=Math.floor(1e4*r)/100,t.push([iface.tb_prop.attrTypeKey.subDmg,0<r?r+"%":"0%"]),this.greenList.array=i,this.attrList.array=t},n.prototype.onAttrRender=function(t,e){var i=t.dataSource;if(i){var n=LanMgr.attrName[i[0]],o=e<4?String(Math.floor(i[1])):i[1]+"";t.text=n+" : "+o}},n.prototype.onGreenRender=function(t,e){var i=t.dataSource;t.text=i?"+"+i:""},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.attrList.array=null,this.greenList.array=null},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t.attrList.renderHandler=new Handler(t,t.onAttrRender),t.greenList.renderHandler=new Handler(t,t.onGreenRender),t.bgPanel.lbTitle.visible=t.bgPanel.bgTitle.visible=!1,t.bgPanel.dataSource={uiName:UIConst.God_AttrView,closeOnSide:t.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12121)},t.bgPanel.addChildAt(t.img_bg,3),t}t.GodAttrView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.RonghunLvInfoUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this),this.bgPanel.dataSource={uiName:UIConst.God_fuseView,closeOnSide:this.isModelClose},this.lab_nowlv.text=this.dataSource.fuseLevel+LanMgr.getLan("",10031),this.list_info.dataSource=tb.TB_fusion_soul.get_TB_fusion_soul().slice(1,5)},n.prototype.onRender=function(t,e){var i=this.dataSource,n=t.dataSource,o=tb.TB_fusion_soul.get_TB_fusion_soulById(n.ID-1),a=t.getChildByName("lab_lv"),r=t.getChildByName("lab_add"),s=t.getChildByName("lab_tiaojian"),u=t.getChildByName("lab_shangxian");a.text=LanMgr.getLan("",12179)+n.ID,r.text=LanMgr.getLan("",12348)+n.special_attr[0][1],s.text=LanMgr.getLan("",12349,o.break_limit),u.text=LanMgr.getLan("",12350)+"："+LanMgr.getLan("",12351)+"："+n.attr_max[0][1]+" "+LanMgr.getLan("",12352)+"："+n.attr_max[1][1]+" "+LanMgr.getLan("",12353)+"："+n.attr_max[2][1],s.visible=0!=n.break_limit,r.color=u.color=a.color=i.fuseLevel>=n.ID?"#13b222":ColorConst.normalFont,s.color=i.starLevel>=o.break_limit?"#13b222":ColorConst.normalFont},n.prototype.close=function(){e.prototype.close.call(this),this.bgPanel.dataSource=null},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t.list_info.renderHandler=new Handler(t,t.onRender),t}t.fuseView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.god.ShengjieUI,__extends(i,e),i.prototype.popup=function(){e.prototype.popup.call(this),this.refreshData(this.dataSource),tl3d.ModuleEventManager.addEvent(a.ResEvent.PROP_CHANGE,this.setCostText,this)},i.prototype.refreshData=function(t){this.setCostText();for(var e=t.jisuanchushi(t.degree),i=t.jisuanchushi(t.degree+1),n=tb.TB_god_evolution.get_TB_god_evolutionById(this.dataSource.degree),o=tb.TB_god_evolution.get_TB_god_evolutionById(t.degree+1),a=t.starLevel<6?t.starLevel:6,r=new Array,s=new Array,u=0;u<3;u++)this["lab_now"+(u+1)].text=Math.floor(e[u][1]),this["lab_next"+(u+1)].text=Math.floor(i[u][1]);for(this.lab_nowlv.text=String(n.level),this.lab_nextlv.text=String(o.level),this.list_nowdegree.repeatX=a,this.list_nextdegree.repeatX=a,u=0;u<a;u++)r.push(t.degree),s.push(t.degree+1);this.list_nowdegree.dataSource=r,this.list_nextdegree.dataSource=s},i.prototype.setCostText=function(){var t=tb.TB_god_evolution.get_TB_god_evolutionById(this.dataSource.degree),e=App.hero.bagItemsObj[t.cost[0][0]],i=this.imgCost.width+5;this.lab_cost.text=e?Snums(e):"0",this.lab_cost.color=e>=t.cost[0][1]?ColorConst.normalFont:ColorConst.redFont,i+=this.lab_cost.width,this.lab_have.text=" / "+t.cost[0][1],i+=this.lab_have.width;var n=this.width/2-i/2;this.imgCost.x=n,this.lab_cost.x=this.imgCost.x+this.imgCost.width+5,this.lab_have.x=this.lab_cost.x+this.lab_cost.width},i.prototype.onRender=function(t,e){t.gray=t.dataSource-1<e},i.prototype.onShengjie=function(){var n=this,t=tb.TB_god_evolution.get_TB_god_evolutionById(this.dataSource.degree);if(App.hero.getBagItemNum(t.cost[0][0])<t.cost[0][1])showToast(LanMgr.getLan("",Lans.cost,t.cost[0][0]));else{var e={},o=this.dataSource.uuid;e[Protocol.game_god_raiseDegree.args.godId]=o,PLC.request(Protocol.game_god_raiseDegree,e,function(t,e){if(!e||t){for(var i in dispatchEvt(new a.GodEvent(a.GodEvent.GOD_SHENGJIE_SUCCESS),o),t.targetGod)dispatchEvt(new a.GodEvent(a.GodEvent.SHOW_SHENGJIE_ATTR),o);n.close()}else n.close()})}},i.prototype.close=function(){e.prototype.close.call(this),tl3d.ModuleEventManager.removeEvent(a.ResEvent.PROP_CHANGE,this.setCostText,this)},i);function i(){var t=e.call(this)||this;return t.isModelClose=!1,t.group=UIConst.two_group,t.list_nowdegree.renderHandler=new Handler(t,t.onRender),t.list_nextdegree.renderHandler=new Handler(t,t.onRender),t.btn_shengjie.on(Laya.Event.CLICK,t,t.onShengjie),t.bgPanel.dataSource={uiName:UIConst.God_DgUpView,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12354)},t.lab_cost.autoSize=!0,t.lab_have.autoSize=!0,t}a.DgUpView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var h,t=(h=ui.god.UplevelsuccUI,__extends(e,h),e.prototype.popup=function(){this.initView(),h.prototype.popup.call(this),this.bgPanel.dataSource={title:"comp/title/jinjiechenggong.png"}},e.prototype.initView=function(){var t=this.dataSource,e=App.hero.getGodVoById(t);this.setPinjieList(e)},e.prototype.setPinjieList=function(t){for(var e=t.starLevel<6?t.starLevel:6,i=new Array,n=new Array,o=0;o<e;o++)i.push(t.degree),n.push(t.degree-1);this.list_old.repeatX=e,this.list_old.dataSource=n,this.list_new.repeatX=e,this.list_new.dataSource=i;var a=tb.TB_god_evolution.get_TB_god_evolutionById(t.degree-1),r=tb.TB_god_evolution.get_TB_god_evolutionById(t.degree);this.lab_old.text=LanMgr.getLan("",12355)+"： "+a.level,this.lab_new.text=LanMgr.getLan("",12355)+"： "+r.level;var s=t.jisuanchushi(t.degree-1),u=t.jisuanchushi(t.degree);this.list_oldattr.dataSource=s,this.list_newattr.dataSource=u;var h=t.getSkillIdByDegree(t.degree),l=tb.TB_skill.get_TB_skillById(h);l?(this.skillBox.visible=!0,this.lbName.text=l.name,this.lab_info.text=""+l.info,this.height=this.bgPanel.height=600,this._skillVo={skill:l,openDgLv:l.level,dgLv:t.degree},this.skillIR.dataSource=this._skillVo):(this.skillBox.visible=!1,this.skillIR.dataSource=null,this.height=this.bgPanel.height=420)},e.prototype.jichuRender=function(t,e){var i=t.dataSource;if(i){var n=t.getChildByName("box_img").getChildByName("img_jichu"),o=t.getChildByName("lab_value");n.skin=SkinUtil.getAttrSkin(i[0]),o.text=""+Math.floor(i[1]),t.refresh()}},e.prototype.onDegreeRender=function(t,e){t.gray=t.dataSource-1<e,t.dataSource-1==e&&(this.img_eff.x=this.list_new.x+37*e+14,this.img_eff.y=this.list_new.y+16,this.ani1.play())},e.prototype.onDegreeRender1=function(t,e){t.gray=t.dataSource-1<e},e.prototype.close=function(){var e=this;if(h.prototype.close.call(this),this.bgPanel.dataSource=null,this.ani1.stop(),this._skillVo&&(UIMgr.hasStage(UIConst.God_MainView)||UIMgr.hasStage(UIConst.God_GodCultureView))){var t=UIMgr.hasStage(UIConst.God_MainView)?UIMgr.getUIByName(UIConst.God_MainView).godView:UIMgr.getUIByName(UIConst.God_GodCultureView).godView;if(!t)return;var i=t.viewInfo;if(!i)return;var n=i.skillList.cells.findIndex(function(t){return t&&t.dataSource&&t.dataSource.skill&&t.dataSource.skill.ID==e._skillVo.skill.ID}),o=i.skillList.getCell(n);if(!o)return;var a=o.localToGlobal(new Laya.Point(0,0)),r=new u.GodSkillItemIR;r.dataSource=this._skillVo;var s=this.skillIR.localToGlobal(new Laya.Point(0,0));r.x=s.x,r.y=s.y,Laya.stage.addChild(r),Laya.Tween.to(r,{x:a.x,y:a.y,alpha:.3},500,Laya.Ease.linearIn,new Handler(this,function(){t&&(UIMgr.hasStage(UIConst.God_MainView)||UIMgr.hasStage(UIConst.God_GodCultureView))&&(i.bombAnim.x=i.skillList.x+50+100*n+i.skillList.spaceX*n,i.bombAnim.y=i.skillList.y+55,i.bombAnim.visible=!0,i.bombAnim.play(0,!1),i.updateList()),Laya.stage.removeChild(r),Laya.Tween.clearTween(r)}),100)}this._skillVo=null},e.prototype.onClosed=function(){h.prototype.onClosed.call(this)},e);function e(){var t=h.call(this)||this;return t.isModelClose=!0,t.list_new.renderHandler=new Handler(t,t.onDegreeRender),t.list_old.renderHandler=new Handler(t,t.onDegreeRender1),t.list_newattr.renderHandler=new Handler(t,t.jichuRender),t.list_oldattr.renderHandler=new Handler(t,t.jichuRender),t}u.DgUpSuccView=t}(game=game||{}),function(t){function e(){}t.BuzhenItemVo=e;function i(t,e){this.showBlood=!1,this.hp=0,this.totalHp=0,this.canGray=!1,this.godVo=t,this.linuepType=e}t.BuzhenListItemVo=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var n,t=(n=ui.god.BuzhenUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!1,this.closeByBlank.visible=this.isModelClose,this.itemRenderAry=[];for(var t=0;t<6;t++){var e=this["ui_buzhenItem"+t];e.dataSource=new h.BuzhenItemVo,this.itemRenderAry.push(e)}this.list_buzhenrole.mouseHandler=new Handler(this,this.onSelect),this.list_buzhenrole.renderHandler=new Handler(this,this.onRender),this.btn_return.on(Laya.Event.CLICK,this,this.onCommit),this.raceList.selectHandler=new Handler(this,this.onRaceSelect),this.raceList.selectedIndex=-1,this.imgBgSQ.on(Laya.Event.CLICK,this,this.showShenqi)},e.prototype.close=function(){this._type=this.dataSource,this._type==iface.tb_prop.lineupTypeKey.attack&&App.hero.getLineUpTeam(this._type).length<=0?showToast(LanMgr.getLan("",10477)):n.prototype.close.call(this)},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),delete this._tempTeamObj,this.list_buzhenrole.array=null,this.raceList.selectedIndex=-1,this._buzhenRoles.forEach(function(t){t.offAll()}),this.guanghuanUI.onExit()},e.prototype.popup=function(){n.prototype.popup.call(this,!1,!1),this.zOrder=UI_DEPATH_VALUE.TOP+2,this.initView()},e.prototype.initView=function(){var i=this;this._buzhenGods=[],this._tempTeamObj={},this._oldTeamObj={},this._type=this.dataSource,this.lab_shiluo.visible=this._type==iface.tb_prop.lineupTypeKey.expedition;for(var t=tb.TB_game_set.get_TB_game_setById(1),e=0;e<this.itemRenderAry.length;e++){var n=this.itemRenderAry[e].dataSource;n.openflag=t.lineup[e]<=App.hero.level,n.msg=t.lineup[e]>App.hero.level?LanMgr.getLan("",10035,t.lineup[e]):"",n.data=null,n.posDes=e<2?LanMgr.getLan("",10558):LanMgr.getLan("",10559),this.itemRenderAry[e].refreshData(!0)}this.list_buzhenrole.spaceY=this._type==iface.tb_prop.lineupTypeKey.expedition?3:-25;var o=App.hero.getGodAry(-1,this._type);this._type==iface.tb_prop.lineupTypeKey.expedition&&(o=o.filter(function(t){return t.level>=h.YuanzhengModel.SHANGZHEN_LEVEL}));for(var a=0;a<o.length;a++){var r=o[a],s=-1;if(this._type==iface.tb_prop.lineupTypeKey.attack){if(!r.isAttackFight)break;s=r.local[0]}else if(this._type==iface.tb_prop.lineupTypeKey.expedition){if(!r.isYuanzhengFight)break;0<h.YuanzhengModel.getInstance().getGodHp(r.uuid)&&(s=r.local[2])}-1!=s&&(this._tempTeamObj[r.uuid]=s,this.itemRenderAry[s].dataSource.data=r,this.itemRenderAry[s].refreshData())}for(var s in this._tempTeamObj)this._oldTeamObj[s]=this._tempTeamObj[s];if(this.setBoxData(),this._type==iface.tb_prop.lineupTypeKey.expedition){var u=h.YuanzhengModel.getInstance().getMyHireList();this._buzhenGods=u.map(function(t){var e=new h.BuzhenListItemVo(t,i._type);return e.showBlood=!0,e.hp=h.YuanzhengModel.getInstance().getGodHp(t.uuid),e.totalHp=Math.ceil(t.getPropertyValue(1)),e.canGray=!0,e})}this._buzhenGods=this._buzhenGods.concat(o.map(function(t){var e=new h.BuzhenListItemVo(t,i._type);return i._type==iface.tb_prop.lineupTypeKey.expedition&&(e.showBlood=!0,e.hp=h.YuanzhengModel.getInstance().getGodHp(t.uuid),e.totalHp=Math.ceil(t.getPropertyValue(1)),e.canGray=!0),e})),this.raceList.array=[0,1,2,3,4,5],this.raceList.selectedIndex=0,this.updateShenqi()},e.prototype.onRaceSelect=function(e){if(-1!=e){var t=0==e?this._buzhenGods:this._buzhenGods.filter(function(t){return t&&t.godVo&&t.godVo.getRaceType()==e});this.list_buzhenrole.array=t}},e.prototype.onSelect=function(t,e){if(t.type==Laya.Event.CLICK){logdebug("当前选择",e),this._curIdx=e;var i=this.list_buzhenrole.array[e];if(!i||!i.godVo)return;var n=i.godVo;if(this._tempTeamObj.hasOwnProperty(n.uuid))this._buzhenRoles[this._tempTeamObj[n.uuid]]&&(this._buzhenRoles[this._tempTeamObj[n.uuid]].dataSource=null,this._buzhenRoles[this._tempTeamObj[n.uuid]].visible=!1),this.delRole(n);else{if(!this.validationRole(n))return;if(this._type==iface.tb_prop.lineupTypeKey.expedition){if(n.level<h.YuanzhengModel.SHANGZHEN_LEVEL)return void showToast(LanMgr.getLan("",10113));if(h.YuanzhengModel.getInstance().getGodHp(n.uuid)<=0)return void showToast(LanMgr.getLan("",10112))}if(!this.insertRole(n))return void showToast(LanMgr.getLan("",10478))}this.list_buzhenrole.refresh(),this.changeGodData(),dispatchEvt(new h.GodEvent(h.GodEvent.BUZHEN_SELECT_ROLE))}},e.prototype.validationRole=function(t){for(var e=t.templateId,i=0;i<this.itemRenderAry.length;i++){var n=this.itemRenderAry[i].dataSource;if(n.openflag&&n.data){var o=n.data.templateId;if(tb.TB_god.get_TB_godById(o),o==e)return showToast(LanMgr.getLan("",10353)),!1;if(n.data.isAid&&t.isAid)return showToast(LanMgr.getLan("",10479)),!1}}return!0},e.prototype.insertRole=function(t){for(var e=0;e<this.itemRenderAry.length;e++){var i=this.itemRenderAry[e].dataSource;if(i.openflag&&!i.data)return i.data=t,this._tempTeamObj[t.uuid]=String(e),this._buzhenRoles[e].dataSource=t,this.itemRenderAry[e].refreshData(),this._buzhenRoles[e].visible=!0}return!1},e.prototype.delRole=function(t){var e=Number(this._tempTeamObj[t.uuid]);this.itemRenderAry[e].dataSource.data=null,delete this._tempTeamObj[t.uuid],this.itemRenderAry[e].refreshData(!0)},e.prototype.getlist=function(){this._rolenum=0;for(var t=new Array,e=0;e<this.itemRenderAry.length;e++){var i=this.itemRenderAry[e].dataSource;if(i.openflag){var n=null;i.data&&(n=i.data.uuid,this._rolenum++,i.data.isAid&&h.YuanzhengModel.getInstance().setAidTag(i.data)),t.push(n)}}return t},e.prototype.onCommit=function(t){var r=this,e=this.getlist();if(this._rolenum<=0)showToast(LanMgr.getLan("",10477));else{var i={};i[Protocol.game_common_ajustLineup.args.type]=this._type,i[Protocol.game_common_ajustLineup.args.godIds]=e,PLC.request(Protocol.game_common_ajustLineup,i,function(t){if(t){if(r._type!=iface.tb_prop.lineupTypeKey.expedition){var e=r._tempTeamObj?r._tempTeamObj:{},i=!1,n=Object.getOwnPropertyNames(e).length,o=Object.getOwnPropertyNames(r._oldTeamObj).length;for(var a in o<n?e:r._oldTeamObj)e[a]!=r._oldTeamObj[a]&&(i=!0);i&&showToast(LanMgr.getLan("",10480))}else UIMgr.hasStage(UIConst.FightVictory)&&(UIMgr.getUIByName(UIConst.FightVictory).again=!0,UIMgr.hideUIByName(UIConst.FightVictory)),dispatchEvt(new h.YuanzhengEvent(h.YuanzhengEvent.GUANQIA_CHALLENGE));dispatchEvt(new h.GodEvent(h.GodEvent.BUZHEN_COMPLETE),r._type),dispatchEvt(new h.GodEvent(h.GodEvent.BUZHEN_COMPLETE_ALL),r._type),r.close()}else showToast(LanMgr.getLan("",10352))})}},e.prototype.setBoxData=function(){var o=this;this._buzhenRoles.forEach(function(t,e){var i=o.itemRenderAry[e].dataSource.data;t.visible=!!i;var n=o._uipos[e];t.dataSource=i,t.pos(n.x,n.y),t.hasListener(Laya.Event.MOUSE_UP)||t.on(Laya.Event.MOUSE_UP,o,o.onItemClick),t.hasListener(Laya.Event.MOUSE_DOWN)||t.on(Laya.Event.MOUSE_DOWN,o,o.onItemClick)}),this.changeGodData()},e.prototype.onRender=function(t,e){if(!(e>this.list_buzhenrole.array.length)){var i=this.list_buzhenrole.array[e];if(i&&i.godVo){var n=i.godVo;t.redPoint.onDispose(),t.redPoint.setRedPointName("god_buzhen_"+n.uuid),t.chk_select.visible=this._tempTeamObj.hasOwnProperty(n.uuid)}else t.redPoint.onDispose()}},e.prototype.showPanel=function(){var n={};this._buzhenRoles.forEach(function(t){var e=t.getDataSource();if(e){var i=e.getRaceType();n[i]=n[i]||0,n[i]+=1}}),dispatchEvt(new h.GodEvent(h.GodEvent.SHOW_KEZHI_VIEW),n)},e.prototype.onItemClick=function(t){var e=t.currentTarget;if(t.type==Laya.Event.MOUSE_DOWN){this.setChildIndex(e,this._childs.length-1);var i=this.localToGlobal(new Laya.Point(0,0)),n=Laya.stage.width-.5*e.width,o=Laya.stage.height-.3*e.height;e.startDrag(new Laya.Rectangle(-i.x,-i.y,n,o))}else if(t.type==Laya.Event.MOUSE_UP){t.currentTarget.stopDrag();var a=Number(e.name.replace(/[^0-9]/gi,"")),r=this._uipos[a],s=e.x,u=e.y;if(s==r.x&&u==r.y){var h=this.itemRenderAry[a].dataSource;return void(h.openflag?h.data&&(this.delRole(h.data),this.list_buzhenrole.refresh(),this._buzhenRoles[a].dataSource=null,this._buzhenRoles[a].visible=!1,this.changeGodData()):showToast(h.msg))}var l=this.itemRenderAry.findIndex(function(t){for(var e=0;e<=30;){var i=s+e,n=u+e;if(i>=t.x&&i<=t.x+t.width&&n>=t.y&&n<=t.y+t.height)return!0;e+=5}return!1});if(-1!=l&&l!=a){var c=new GodItemVo(this.itemRenderAry[a].dataSource.data);c=this.itemRenderAry[a].dataSource.data;var p=this.itemRenderAry[l].dataSource;p.data&&p.openflag?(this.setItemData(a,this.itemRenderAry[l].dataSource.data),this.setItemData(l,c)):p.openflag?(this.delRole(this.itemRenderAry[a].dataSource.data),this.setItemData(l,c)):showToast(p.msg)}s>=this.list_buzhenrole.x&&s<=this.list_buzhenrole.x+this.list_buzhenrole.width&&u>=this.list_buzhenrole.y&&u<=this.list_buzhenrole.y+this.list_buzhenrole.height&&(this.delRole(this.itemRenderAry[a].dataSource.data),this.list_buzhenrole.refresh()),this.setBoxData()}},e.prototype.setItemData=function(t,e){this.itemRenderAry[t].dataSource.data=e,this.itemRenderAry[t].refreshData(),this._tempTeamObj[e.uuid]=t},e.prototype.isExistLineupById=function(t){for(var e=0,i=this.itemRenderAry;e<i.length;e++){var n=i[e];if(n.dataSource&&n.dataSource.data&&n.dataSource.data.templateId==t)return!0}return!1},e.prototype.isExistLineupByIdx=function(t){var e=this.itemRenderAry[t];return e.dataSource&&e.dataSource.data},e.prototype.changeGodData=function(){var i=[],n=0;this._buzhenRoles.forEach(function(t){var e=t.getDataSource();e?(n+=e.isAid?e.fightPower:e.getShenli(),i.push(e.tab_god.race_type)):i.push(-1)}),this.guanghuanUI.initView(0,i),this.lbShenli.text=n+""},e.prototype.updateShenqi=function(){var t=App.hero.getArtifactIDByLineType();if(this.imgShenqi.visible=0<t,this.imgAddSQ.visible=t<=0,0<t){var e=tb.TB_artifact.get_TB_artifactById(t);this.imgShenqi.skin=SkinUtil.getArtifCircleIcon(e.icon)}},e.prototype.showShenqi=function(){dispatchEvt(new h.ArtifactEvent(h.ArtifactEvent.SHOW_ARTIFACT_LIST_PANEL))},e);function e(){var i=n.call(this)||this;return i._uipos=[],i._rolenum=0,i.guanghuanUI.on(Laya.Event.CLICK,i,i.showPanel),i._buzhenRoles=[i.ui_buzhenrole0,i.ui_buzhenrole1,i.ui_buzhenrole2,i.ui_buzhenrole3,i.ui_buzhenrole4,i.ui_buzhenrole5],i._buzhenRoles.forEach(function(t,e){t.name="ui_buzhenrole"+e,i._uipos.push(new Laya.Point(t.x,t.y))}),i}h.BuzhenView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.BuzhenBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){if(void 0===t&&(t=!1),this._dataSource){var e=this._dataSource;this.lbLock.visible=this.imgLock.visible=!e.openflag,this.lbLock.text=e.msg,this.lbEmpty.visible=t&&e.openflag,this.lbEmpty.text=e.posDes}},n);function n(){return e.call(this)||this}t.godBuzhenIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=ui.box.BuzhenItemBoxUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=t.godVo;if(this.ui_head.dataSource=e,this.lbBlood.visible=this.bloodProg.visible=!1,this.gray=!1,this.img_yuanzhu.visible=t.godVo.isAid,t.linuepType==iface.tb_prop.lineupTypeKey.expedition){if(t.showBlood){this.lbBlood.visible=this.bloodProg.visible=!0;var i=Math.ceil(t.hp/t.totalHp*100);this.lbBlood.text=i+"%",this.bloodProg.value=t.hp/t.totalHp}else this.lbBlood.visible=this.bloodProg.visible=!1;t.canGray&&(this.gray=t.hp<=0||e.level<n.YuanzhengModel.SHANGZHEN_LEVEL)}}else this.chk_select.visible=!1},i);function i(){return t.call(this)||this}n.BuzhenGodIR=e}(game=game||{}),function(t){var e,o,i,n=(a.prototype.getRaceType=function(){return this.curGod.tab_god.race_type},a.prototype.isEnough=function(){return this.choose.length>=this.tbVo.count},a.prototype.getFormatData=function(){for(var t=[[],[]],e=0,i=this.choose;e<i.length;e++){var n=i[e];n.type==o.god?t[0].push(n.id):n.type==o.card&&t[1].push(n.id)}return t},a);function a(t,e){this.tbVo=t,this.curGod=e,this.choose=[]}t.GodMaterialVo=n,(e=t.ConfigType||(t.ConfigType={}))[e.god=1]="god",e[e.race=2]="race",(i=o=t.MaterialType||(t.MaterialType={}))[i.god=1]="god",i[i.card=2]="card"}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var t,e=(t=ui.god.render.GodMaterialIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),i.prototype.initView=function(){var t=this.dataSource;if(t){var e=t.tbVo;if(e.type==h.ConfigType.god){var i=tb.TB_item.get_TB_itemById(e.godId),n=new ItemVo(i.ID,0);n.star=e.starLv,n.show=!1,n.clientUrl=6<=e.starLv?SkinUtil.getItemIcon(tb.TB_item.get_TB_itemById(CostTypeKey.suipian_wuxing)):null,this.view_icon.dataSource=n;var o=tb.TB_god.get_TB_godById(e.godId);this.img_type.skin=SkinUtil.getGodRaceSkin(o.race_type)}else{var a=h.GodModel.getInstance().getItemID(e.starLv),r=App.hero.createItemVo(0,a);r.show=!1,r.hideSuipian=!0,r.showStar=!0,r.clientUrl=6<=e.starLv?SkinUtil.getItemIcon(tb.TB_item.get_TB_itemById(CostTypeKey.suipian_wuxing)):null;var s=1==e.race?t.getRaceType():0;this.view_icon.dataSource=r,this.img_type.skin=SkinUtil.getGodRaceSkin(s)}}},i.prototype.refreshData=function(t){var e=this.dataSource;if(e){for(var i=[],n=0,o=t;n<o.length;n++){var a=o[n];a!=e&&i.push.apply(i,a.choose)}var r=h.GodUtils.filterGods(e.tbVo,e.curGod,i),s=e.tbVo,u=e.choose.length>=s.count;this.view_icon.itemBox.gray=!u,this.img_add.visible=0<r.length&&!u,this.lab_num.visible=!0,this.lab_num.text=e.choose.length+"/"+s.count,this.lab_num.color=e.choose.length==s.count?"#0bff00":"#ff0501"}},i);function i(){return t.call(this)||this}h.GodMaterialIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var t,e=(t=ui.god.ChooseGodUI,__extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,title:LanMgr.getLan("",12371)},this.list_gods.itemRender=u.ChooseGodIR,this.list_gods.mouseHandler=new Handler(this,this.onListHandler),this.btn_queding.on(Laya.Event.CLICK,this,this.onConfirm)},i.prototype.popup=function(){t.prototype.popup.call(this),this.initView()},i.prototype.onClosed=function(){t.prototype.onClosed.call(this),this.list_gods.array=null,Laya.timer.clearAll(this)},i.prototype.initView=function(){var t=this.dataSource;this.list_gods.array=t.allList,Laya.timer.callLater(this,this.initSelected)},i.prototype.initSelected=function(){var t=this.dataSource;if(t&&t.curMaterail){function e(e){var t=a[e],i=t.dataSource;if(!i)return 1;if(i instanceof GodItemVo){var n=o.some(function(t){return t.type==u.MaterialType.god&&t.id==i.uuid});t.img_gouxuan.visible=n}else i instanceof ItemVo&&(n=o.some(function(t){return t.type==u.MaterialType.card&&t.id==i.id&&t.index==Number(e)}),t.img_gouxuan.visible=n)}var o=t.curMaterail.choose,a=this.list_gods.cells;for(var i in a)e(i)}},i.prototype.onListHandler=function(t,e){var i=this;if(t.type==Laya.Event.CLICK){var n=this.list_gods.getCell(e),o=n.dataSource,a=this.dataSource;if(!o||!a)return;if(o instanceof GodItemVo&&o.isInLinuep(iface.tb_prop.lineupTypeKey.attack))return void common.AlertBox.showAlert({text:LanMgr.getLan("",10501),confirmCb:function(){u.GodUtils.downGods(o).then(function(){i.refreshData()})}});var r=a.curMaterail;if(!n.img_gouxuan.visible){var s=this.getCurSelectedCount();if((a.openType==ChooseOpenType.awaken||a.openType==ChooseOpenType.starUp)&&s>=r.tbVo.count)return void showToast(LanMgr.getLan("",10366,r.tbVo.count))}n.img_gouxuan.visible=!n.img_gouxuan.visible}},i.prototype.refreshData=function(){var t=this.list_gods.cells;for(var e in t){var i=t[e];i.dataSource&&i.refreshData()}},i.prototype.onConfirm=function(){var t=this.dataSource;if(t){t.curMaterail.choose=[];var e=this.list_gods.cells;for(var i in e){var n=e[i],o=n.dataSource;if(o&&n.img_gouxuan.visible){var a=-1,r=void 0;o instanceof GodItemVo?(a=u.MaterialType.god,r=o.uuid):o instanceof ItemVo&&(a=u.MaterialType.card,r=o.id),-1!=a&&t.curMaterail.choose.push({type:a,id:r,index:Number(i)})}}if(t.openType==ChooseOpenType.awaken)UIMgr.hasStage(UIConst.God_MainView)&&(s=UIMgr.getUIByName(UIConst.God_MainView)).viewJuexing&&s.viewJuexing.refreshGodList(),UIMgr.hasStage(UIConst.God_GodCultureView)&&(s=UIMgr.getUIByName(UIConst.God_GodCultureView).viewJuexing)&&s.refreshGodList();else if(t.openType==ChooseOpenType.starUp){var s;UIMgr.hasStage(UIConst.God_MainView)&&(s=UIMgr.getUIByName(UIConst.God_MainView)).viewStarup&&s.viewStarup.refreshChooseList(),UIMgr.hasStage(UIConst.God_GodCultureView)&&(s=UIMgr.getUIByName(UIConst.God_GodCultureView).viewStarup)&&s.refreshChooseList()}this.close()}},i.prototype.getCurSelectedCount=function(){var t=0,e=this.list_gods.cells;for(var i in e){var n=e[i];n.dataSource&&n.img_gouxuan.visible&&t++}return t},i);function i(){return t.call(this)||this}u.ChooseGodView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.render.ChooseBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){if(this._dataSource){var t=this.dataSource;t?(this.redpoint.onDispose(),this.img_gouxuan.visible=!1,this.god_icon.dataSource=null,this.item_icon.dataSource=null,this.god_icon.visible=this.item_icon.visible=!1,this.gray=!1,t instanceof GodItemVo?(this.god_icon.dataSource=t,this.god_icon.visible=!0,this.gray=this.dataSource.isInLinuep(iface.tb_prop.lineupTypeKey.attack)):(this.item_icon.dataSource=t,this.item_icon.visible=!0)):(this.redpoint.onDispose(),this.god_icon.dataSource=null,this.item_icon.dataSource=null,this.god_icon.visible=this.item_icon.visible=!1,this.gray=!1)}},n.prototype.refreshData=function(){var t=this.dataSource;t&&t instanceof GodItemVo&&(this.gray=this.dataSource.isInLinuep(iface.tb_prop.lineupTypeKey.attack))},n);function n(){return e.call(this)||this}t.ChooseGodIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.god.treasure.TreasureTujianUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12372)},this.itemList.array=null},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.itemList.array=null},n.prototype.initView=function(){this.itemList.array=t.TreasureModel.getInstance().getTujianViewList()},n);function n(){return i.call(this)||this}t.TreasureTujianView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.equip.EquipTipsUI,__extends(o,i),o.showTip=function(t,e,i){t==this._target&&this._tips||(this._target=t,this._tips||(this._tips=new o),this._tips.isModal=!1,this._tips.popupCenter=!1,this._tips.dataSource=[e,i,!0],this._tips.parent?this._tips.initView():this._tips.show(!1,!1),this._tips.x=Laya.stage.mouseX+this._tips.width>Laya.stage.width?Laya.stage.width-this._tips.width:Laya.stage.mouseX,this._tips.y=Laya.stage.mouseY+this._tips.height>Laya.stage.height?Laya.stage.height-this._tips.height:Laya.stage.mouseY,Laya.stage.on(Laya.Event.CLICK,this,this.onClickStage))},o.popupTip=function(t,e,i,n){return void 0===e&&(e=null),void 0===i&&(i=!1),this._tips||(this._tips=new o),this._tips.isModal=!0,this._tips.popupCenter=!0,this._tips.dataSource=[t,e,i,n],this._tips.parent?this._tips.initView():this._tips.popup(!1,!0),this._tips},o.getTipsUI=function(){return this._tips},o.onClickStage=function(t){this._tips&&this._tips.hitTestPoint(Laya.stage.mouseX,Laya.stage.mouseY)||this._target&&this._target.hitTestPoint(Laya.stage.mouseX,Laya.stage.mouseY)||this.HideTip()},o.HideTip=function(){this._target=null,this._tips&&(this._tips.close(),this._tips.removeSelf(),this._tips.destroy(!0),this._tips=null),Laya.stage.off(Laya.Event.CLICK,this,this.onClickStage)},o.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},o.prototype.popup=function(t,e){this.initView(),i.prototype.popup.call(this,t,e)},o.prototype.onOpened=function(){i.prototype.onOpened.call(this)},o.prototype.initView=function(){this.clear(),this._treasureVo=this.dataSource[0],this._godVo=this.dataSource[1],this._isShowAllBtn=this.dataSource[2],this._args=this.dataSource[3],this._spiltArr=[],this.updateData()},o.prototype.updateData=function(){this.updateTop(),this.updateBase(),this._treasureVo&&!this._treasureVo.isForbitStarup()&&this.updateStarup(),this.updateSuit(),this.layout()},o.prototype.updateTop=function(){this._treasureVo&&(this.lab_name.text=this._treasureVo.tbItem.name,this.lab_quality.text=LanMgr.getLan("",12374,LanMgr.qualityName[this._treasureVo.quality]),this.ui_item_icon.dataSource=this._treasureVo,this.img_bg_quality.skin=LanMgr.getLan("zhaungbei/zhaungbeipinzhi0{0}.png",-1,this._treasureVo.quality))},o.prototype.updateBase=function(){if(this._treasureVo){this._baseTitle=new Laya.Label(LanMgr.getLan("",12373)),this._baseTitle.color="#e8c859",this._baseTitle.fontSize=22,this.addChild(this._baseTitle),this._baseBtn=new Laya.Button("comp/button/btn_qianwang.png"),this._baseBtn.stateNum=2,this._baseBtn.width=97,this._baseBtn.height=40,this._baseBtn.label=LanMgr.getLan("",12375),this._baseBtn.labelSize=22,this._baseBtn.labelColors="#ffffff,#ffffff,#ffffff",this._baseBtn.labelStroke=4,this._baseBtn.labelStrokeColor="#538901",this._baseBtn.on(Laya.Event.CLICK,this,this.onClickBase),this.addChild(this._baseBtn),this._baseArr=[];for(var t=n.TreasureUtil.getTbAttrStrAry(this._treasureVo.getTbStrength()),e=0;e<t.length;e++){var i=new Laya.Label;i.color="#ffeecc",i.fontSize=20,i.text=t[e][0]+t[e][1],this.addChild(i),this._baseArr.push(i)}}},o.prototype.updateStarup=function(){if(this._treasureVo)if(this.addSplit(),this._starTitle=new Laya.Label(LanMgr.getLan("",12376)),this._starTitle.color="#e8c859",this._starTitle.fontSize=22,this.addChild(this._starTitle),this._starBtn=new Laya.Button("comp/button/btn_qianwang.png"),this._starBtn.stateNum=2,this._starBtn.width=97,this._starBtn.height=40,this._starBtn.label=LanMgr.getLan("",12377),this._starBtn.labelSize=22,this._starBtn.labelColors="#ffffff,#ffffff,#ffffff",this._starBtn.labelStroke=4,this._starBtn.labelStrokeColor="#538901",this._starBtn.on(Laya.Event.CLICK,this,this.onClickStarup),this.addChild(this._starBtn),this._starArr=[],this._treasureVo.starLv<=0)(i=new Laya.Label).color="#ffeecc",i.fontSize=20,i.text=LanMgr.getLan("",12084),this.addChild(i),this._starArr.push(i);else for(var t=n.TreasureUtil.getTbAttrStrAry(this._treasureVo.getTbStarup()),e=0;e<t.length;e++){var i;(i=new Laya.Label).color="#ffeecc",i.fontSize=20,i.text=t[e][0]+t[e][1],this.addChild(i),this._starArr.push(i)}},o.prototype.updateSuit=function(){this._treasureVo&&(this.addSplit(),this._itemTitle=new Laya.Label(LanMgr.getLan("",12378)),this._itemTitle.color="#e8c859",this._itemTitle.fontSize=22,this.addChild(this._itemTitle),this._itemDesc=new Laya.Label(this._treasureVo.tbItem.desc),this._itemDesc.width=270,this._itemDesc.leading=5,this._itemDesc.autoSize=!0,this._itemDesc.wordWrap=!0,this._itemDesc.color="#ffeecc",this._itemDesc.fontSize=20,this.addChild(this._itemDesc),this._btnChange=new Laya.Button("comp/button/button.png"),this._btnChange.stateNum=2,this._btnChange.label=LanMgr.getLan("",12379),this._btnChange.labelSize=22,this._btnChange.labelColors="#ffffff,#ffffff,#ffffff",this._btnChange.labelStroke=4,this._btnChange.labelStrokeColor="#ca7005",this.addChild(this._btnChange),this._btnChange.on(Laya.Event.CLICK,this,this.onClickTH),this._btnTakeoff=new Laya.Button("comp/button/btn_quxiao.png"),this._btnTakeoff.stateNum=2,this._btnTakeoff.label=LanMgr.getLan("",12380),this._btnTakeoff.labelSize=22,this._btnTakeoff.labelColors="#ffffff,#ffffff,#ffffff",this._btnTakeoff.labelStroke=4,this._btnTakeoff.labelStrokeColor="#e6360d",this.addChild(this._btnTakeoff),this._btnTakeoff.on(Laya.Event.CLICK,this,this.onClickTZ),this._btnWear=new Laya.Button("comp/button/button.png"),this._btnWear.stateNum=2,this._btnWear.label=LanMgr.getLan("",12366),this._btnWear.labelSize=22,this._btnWear.labelColors="#ffffff,#ffffff,#ffffff",this._btnWear.labelStroke=4,this._btnWear.labelStrokeColor="#ca7005",this.addChild(this._btnWear),this._btnWear.on(Laya.Event.CLICK,this,this.onClickWear))},o.prototype.addSplit=function(){var t=new Laya.Image("comp/image/zhaungbeixingxi02.png");this.addChild(t),this._spiltArr.push(t)},o.prototype.layout=function(){var t=150,e=0;if(this._baseTitle&&(this._baseTitle.x=24,this._baseTitle.y=t+5,this._baseBtn&&(this._baseBtn.x=this.width-15-this._baseBtn.width,this._baseBtn.y=t+5),t=this._baseTitle.y+this._baseTitle.height+10),this._baseArr)for(var i=0;i<this._baseArr.length;i++)(n=this._baseArr[i])&&(n.x=24,n.y=t,t+=n.height+10);if(this._starTitle&&(this._spiltArr[e].x=24,this._spiltArr[e].y=t,e++,t+=10,this._starTitle.x=24,this._starTitle.y=t+5,this._starBtn&&(this._starBtn.x=this.width-15-this._starBtn.width,this._starBtn.y=t+5),t=this._starTitle.y+this._starTitle.height+10),this._starArr)for(i=0;i<this._starArr.length;i++){var n;(n=this._starArr[i])&&(n.x=24,n.y=t,t+=n.height+10)}if(this._itemTitle&&(this._spiltArr[e].x=24,this._spiltArr[e].y=t,e++,t+=10,this._itemTitle.x=24,this._itemTitle.y=t+5,t=this._itemTitle.y+this._itemTitle.height+10),this._itemDesc&&(this._itemDesc.x=24,this._itemDesc.y=t+5,t=this._itemDesc.y+this._itemDesc.height+10),this._btnWear.centerX=0,this._btnWear.y=t,this._btnTakeoff.x=15,this._btnTakeoff.y=t,this._btnChange.x=24+this._btnTakeoff.width+0,this._btnChange.y=t,t+=this._btnChange.height+20,this._btnWear.label=LanMgr.getLan("",12366),this._baseBtn.visible=this._btnChange.visible=this._btnTakeoff.visible=this._btnWear.visible=this._isShowAllBtn,this._starBtn&&(this._starBtn.visible=this._isShowAllBtn),this._isShowAllBtn){var o=this._treasureVo&&this._treasureVo.isExsitGod();this._baseBtn.visible=this._btnChange.visible=this._btnTakeoff.visible=o,this._starBtn&&(this._starBtn.visible=o&&!this._treasureVo.isForbitStarup()),this._btnWear.visible=!o&&!!this._godVo}this._args&&this._args.hasOwnProperty("showStrengthBtn")&&(this._baseBtn.visible=this._args.showStrengthBtn),this._starBtn&&this._args&&this._args.hasOwnProperty("showStarBtn")&&(this._starBtn.visible=this._args.showStarBtn&&!this._treasureVo.isForbitStarup()),this._args&&this._args.hasOwnProperty("chooseFlag")&&(this._btnWear.visible=!0,this._btnWear.label=LanMgr.getLan("",12381));var a=this._btnChange.visible||this._btnTakeoff.visible||this._btnWear.visible;this.img_bg.height=a?t:t-60,this.height=a?t:t-60},o.prototype.clear=function(){if(this.ui_item_icon.dataSource=null,this.lab_name.text="",this.lab_quality.text="",this.img_bg_quality.skin="",this.clearLabel(this._baseTitle),this.clearButton(this._baseBtn,this.onClickBase),this.clearLabelArr(this._baseArr),this._baseTitle=null,this._baseBtn=null,this._baseArr=null,this.clearLabel(this._starTitle),this.clearButton(this._starBtn,this.onClickStarup),this.clearLabelArr(this._starArr),this._starTitle=null,this._starBtn=null,this._starArr=null,this.clearLabel(this._itemTitle),this.clearLabel(this._itemDesc),this.clearButton(this._btnTakeoff,this.onClickTZ),this.clearButton(this._btnChange,this.onClickTH),this.clearButton(this._btnWear,this.onClickWear),this._itemTitle=null,this._btnChange=null,this._btnTakeoff=null,this._btnWear=null,this._spiltArr){for(var t=0;t<this._spiltArr.length;t++){var e=this._spiltArr[t];e&&(e.removeSelf(),e.destroy(!0),e=null)}this._spiltArr=null}this.img_bg.height=200,this.height=200},o.prototype.clearLabel=function(t){t&&(t.removeSelf(),t.destroy(!0),t=null)},o.prototype.clearButton=function(t,e){t&&(e&&t.off(Laya.Event.CLICK,this,e),t.removeSelf(),t.destroy(!0),t=null)},o.prototype.clearLabelArr=function(t){if(t){for(var e=0;e<t.length;e++){var i=t[e];i&&(i.removeSelf(),i.destroy(!0),i=null)}t=null}},o.prototype.onClickBase=function(){this._treasureVo&&(dispatchEvt(new n.TreasureEvent(n.TreasureEvent.SHOW_STRENGTH_VIEW),this._treasureVo),o.HideTip())},o.prototype.onClickStarup=function(){this._treasureVo&&(dispatchEvt(new n.TreasureEvent(n.TreasureEvent.SHOW_STARUP_VIEW),this._treasureVo),o.HideTip())},o.prototype.onClickTH=function(){if(this._treasureVo){var t=App.hero.getGodVoById(this._treasureVo.godId);t&&(dispatchEvt(new n.TreasureEvent(n.TreasureEvent.SHOW_CHOOSE_TREASURE_VIEW),[n.ChooseTreasureOpenType.change,this._treasureVo,t]),o.HideTip())}},o.prototype.onClickTZ=function(){this._treasureVo&&(dispatchEvt(new n.TreasureEvent(n.TreasureEvent.TREASURE_OPERATION),[n.TreasureOperation.takeoff,[this._treasureVo]]),o.HideTip())},o.prototype.onClickWear=function(){this._args&&this._args.chooseFlag?(dispatchEvt(new n.TreasureEvent(n.TreasureEvent.CHOOSE_TREASURE),this._treasureVo),o.HideTip()):this._godVo&&this._treasureVo&&(dispatchEvt(new n.TreasureEvent(n.TreasureEvent.TREASURE_OPERATION),[n.TreasureOperation.wear,[this._godVo,this._treasureVo]]),o.HideTip())},o.prototype.getBtnWear=function(){return this._btnWear},o.prototype.getBtnStreng=function(){return this._baseBtn},o.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.clear(),this._godVo=null,this._treasureVo=null,this._isShowAllBtn=!1,this._args=null},o);function o(){var t=i.call(this)||this;return t._isShowAllBtn=!0,t.isModelClose=!0,t.mouseEnabled=!0,t.mouseThrough=!1,t.zOrder=UI_DEPATH_VALUE.TOP+9,t.name=UIConst.TreasureTipsView,t}n.TreasureTipsView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var i,t=(i=ui.god.treasure.TreasureStrengthUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._chooseList=[],this._curExp=0,this.itemList.selectEnable=!1,this.itemList.mouseHandler=new Handler(this,this.onTreasureClick),this.itemList.renderHandler=new Handler(this,this.onTrasureRender),this.btnQuick.on(Laya.Event.CLICK,this,this.onQuick),this.btnRule.on(Laya.Event.CLICK,this,this.onRule),this.btnStrength.on(Laya.Event.CLICK,this,this.onStrength)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.itemList.array=null,this._chooseList.length=0,this._curExp=0,Laya.timer.clearAll(this)},e.prototype.initView=function(){var t=this.dataSource,e=u.TreasureModel.getInstance().getStrengthTreasureList([t.uuid]);this.itemList.array=e,this.imgEmpty.visible=0==e.length;var i=t.isTopStrengthLv();this.nextBox.visible=this.imgTopArrow.visible=this.btnQuick.visible=this.btnStrength.visible=this.pgBar.visible=!i,this.imgAttrArrow.visible=this.nextAttrList.visible=!i,this.maxLvBox.visible=i;var n=u.TreasureUtil.createTreasureVo("",t);n.show=!0,n.num=0,this.curItem.dataSource=n;var o=u.TreasureUtil.getTbAttrStrAry(n.getTbStrength());if(this.curAttrList.array=o,this.curAttrList.height=24*o.length+(o.length-1)*this.curAttrList.spaceY,i)this.curBox.x=268,this.curAttrList.x=210;else{this.curBox.x=118,this.curAttrList.x=70;var a=u.TreasureUtil.createTreasureVo("",n);a.show=!0,a.num=0,a.strengthLv+=1,this.nextItem.dataSource=a;var r=u.TreasureUtil.getTbAttrStrAry(a.getTbStrength()).map(function(t){return t[2]=ColorConst.TASK_GREEN,t});this.nextAttrList.array=r,this.nextAttrList.height=24*r.length+(r.length-1)*this.nextAttrList.spaceY}this.updateProgress()},e.prototype.updateView=function(){var t=this.dataSource;if(t){for(var e=u.TreasureModel.getInstance().getStrengthTreasureList([t.uuid]),i=[],n=[],o=[],a=0;a<e.length;a++)(r=e[a])instanceof TreasureItemVo?o.push(r.uuid):r instanceof ItemVo&&(i.push(r.id),n.push(r));for(a=this._chooseList.length-1;0<=a;a--){var r;if((r=this._chooseList[a])instanceof TreasureItemVo&&-1==o.indexOf(r.uuid))this._chooseList.splice(a,1);else if(r instanceof ItemVo){var s=i.indexOf(r.id);-1==s?this._chooseList.splice(a,1):this._chooseList[a]=n[s]}}this.ani_succ.loadAnimation(ResConst.anim_strength,Handler.create(this,function(){this.ani_succ.play(0,!1),this.ani_succ.visible=!0}),ResConst.atlas_strength_effect),this.ani_succ_r.loadAnimation(ResConst.anim_strength,Handler.create(this,function(){this.ani_succ_r.play(0,!1),this.ani_succ_r.visible=!0}),ResConst.atlas_strength_effect),this.initView()}},e.prototype.updateProgress=function(){var t=this.dataSource,e=t?t.getTbStrength():null;if(t&&e){for(var i=0,n=0,o=this._chooseList;n<o.length;n++){var a=o[n];a instanceof TreasureItemVo?i+=a.getTbStrength().return_exp*a.num+tb.TB_treasure_set.getSet().getQualityExp(a.quality)*a.num:a instanceof ItemVo&&(i+=a.count*tb.TB_treasure_set.getSet().getTreasureExp(a.id))}this._curExp=i,this.pgBar.value=i/e.exp,this.lbValue.text=i+"/"+e.exp}},e.prototype.onTreasureClick=function(t,e){if(-1!=e&&t.type==Laya.Event.CLICK){var i=t.currentTarget,n=i.dataSource,o=this.getExistChooseIdx(n);-1!=o?(this._chooseList.splice(o,1),i.imgGouxuan.visible=!1):(this._chooseList.push(n),i.imgGouxuan.visible=!0),this.updateProgress(),dispatchEvt(new u.TreasureEvent(u.TreasureEvent.SELECT_STRENGTH_TREASURE))}},e.prototype.onTrasureRender=function(t,e){if(t.dataSource){var i=this.isExistChoose(t.dataSource);t.imgGouxuan.visible=i}},e.prototype.onQuick=function(){for(var t=this.itemList.cells.length,e=0;e<t;e++)if(e<10){var i=this.itemList.getCell(e);i&&i.dataSource&&(this.isExistChoose(i.dataSource)||this._chooseList.push(i.dataSource),i.imgGouxuan.visible=!0)}this.updateProgress()},e.prototype.getExistChooseIdx=function(e){return e?this._chooseList.findIndex(function(t){return t instanceof TreasureItemVo&&e instanceof TreasureItemVo&&t.uuid==e.uuid||t instanceof ItemVo&&e instanceof ItemVo&&t.id==e.id}):-1},e.prototype.isExistChoose=function(t){return-1!=this.getExistChooseIdx(t)},e.prototype.onRule=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20019))},e.prototype.onStrength=function(){var t=this.dataSource;if(t){var e=t.getTbStrength()?t.getTbStrength().exp:0;this._curExp<e?showToast(LanMgr.getLan("",10371)):dispatchEvt(new u.TreasureEvent(u.TreasureEvent.TREASURE_OPERATION),[u.TreasureOperation.strength,[t,this._chooseList]])}},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t}u.TreasureStrengthView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var e,t=(e=ui.god.treasure.TreasureStarupUI,__extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.TreasureStarupView,closeOnButton:!0,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12382)},this.btnStarup.on(Laya.Event.CLICK,this,this.onStarup),this.btnYulan.on(Laya.Event.CLICK,this,this.onYulan),this.materialList.mouseHandler=new Handler(this,this.onChooseSelect)},i.prototype.popup=function(){e.prototype.popup.call(this),this._curStatLv=-1,this.initView()},i.prototype.onClosed=function(){e.prototype.onClosed.call(this),Laya.timer.clearAll(this),this.materialList.array=null,this.attrList.array=null},i.prototype.initView=function(){var e=this.dataSource,t=e.isTopStarLv();this.nextBox.visible=this.costBox.visible=this.btnStarup.visible=this.imgArrow.visible=!t,this.maxLvBox.visible=t;var i=l.TreasureUtil.createTreasureVo("",e);if(i.show=!0,i.num=0,this.curItem.dataSource=i,t){this.curBox.x=268;var n=this.getAttrList(i,null);this.attrList.array=n,this.attrList.width=130,this.attrList.height=26*n.length+(n.length-1)*this.attrList.length}else{this.curBox.x=118;var o=l.TreasureUtil.createTreasureVo("",i);o.show=!0,o.num=0,o.starLv+=1,this.nextItem.dataSource=o,n=this.getAttrList(i,o),this.attrList.array=n,this.attrList.width=250,this.attrList.height=26*n.length+(n.length-1)*this.attrList.length;var a=e.getTbStarup().getMaterialList().map(function(t){return new l.TreasureMaterialVo(t,e)});this.materialList.array=a,Laya.timer.callLater(this,this.refreshChooseList),this.materialList.width=100*a.length+(a.length-1)*this.materialList.spaceX}this._curStatLv!=e.starLv&&(-1!=this._curStatLv&&(this.ani_succ.loadAnimation(ResConst.anim_strength,Handler.create(this,function(){this.ani_succ.play(0,!1),this.ani_succ.visible=!0}),ResConst.atlas_strength_effect),this.ani_succ_r.loadAnimation(ResConst.anim_strength,Handler.create(this,function(){this.ani_succ_r.play(0,!1),this.ani_succ_r.visible=!0}),ResConst.atlas_strength_effect)),this._curStatLv=e.starLv)},i.prototype.onChooseSelect=function(t,e){var i=this.dataSource;if(t.type==Laya.Event.CLICK){var n=this.materialList.getCell(e).dataSource;if(n){for(var o=[],a=0,r=this.materialList.array;a<r.length;a++){var s=r[a];s!=n&&o.push.apply(o,s.choose)}var u=l.TreasureUtil.filterTreasures(n.tbVo,i,o);if(0<u.length){var h={allList:u,curMaterail:n};UIMgr.showUI(UIConst.ChooseTreasureMaterialView,h)}else showToast(n.getWarn())}}},i.prototype.getAttrList=function(t,e){var i=l.TreasureUtil.getTbAttrStrAry(t.getTbStarup()),n=e?l.TreasureUtil.getTbAttrStrAry(e.getTbStarup()):[],o=[];if(0<i.length)for(var a=0;a<i.length;a++){var r=i[a][0]+" "+i[a][1],s=n[a]?"("+n[a][1]+")":"";o.push([r,s])}else if(0<n.length)for(a=0;a<n.length;a++)r=n[a][0]+" +0",s=n[a]?"("+n[a][1]+")":"",o.push([r,s]);return o},i.prototype.refreshChooseList=function(){for(var t=0,e=this.materialList.cells;t<e.length;t++)e[t].refreshData(this.materialList.array)},i.prototype.onStarup=function(){this.dataSource&&dispatchEvt(new l.TreasureEvent(l.TreasureEvent.TREASURE_OPERATION),[l.TreasureOperation.starup,[this.dataSource,this.materialList.array]])},i.prototype.onYulan=function(){this.dataSource&&dispatchEvt(new l.TreasureEvent(l.TreasureEvent.SHOW_STAR_ATTR_PREVIEW),this.dataSource)},i);function i(){var t=e.call(this)||this;return t._curStatLv=-1,t}l.TreasureStarupView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.god.treasure.StarAttrPreviewUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12383)},this._buffList=new common.BuffRenderList(this.contentBox.width,this.contentBox.height,null,50,2,!1),this._buffList.isAutoScroll=!1,this._buffList.spaceY=10,this._buffList.itemRender=t.TreasureStarAttrPreviewIR,this.contentBox.addChild(this._buffList),this.btnClose.on(Laya.Event.CLICK,this,this.close)},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._buffList.removeAll()},n.prototype.initView=function(){var e=this.dataSource,t=tb.TB_treasure_star.getList2(e.quality,e.slot);this._buffList.dataSource=t.map(function(t){return[t,e.starLv]})},n);function n(){return i.call(this)||this}t.TreasureStarAttrPreview=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var i,t=(i=ui.god.treasure.TreasureRebirthUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12384)},this.btnRebirth.on(Laya.Event.CLICK,this,this.onRebirth),this.btnRule.on(Laya.Event.CLICK,this,this.onRule),this.listTreasure.selectHandler=new Handler(this,this.onSelect),this.listTreasure.array=null,this.listTreasure.selectedIndex=-1,this.lbTitle.visible=!0},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.listCost.array=null,this.listItem.array=null,this.itemBox.dataSource=null,this.listTreasure.array=null,this.listTreasure.selectedIndex=-1,this.lbTitle.visible=!0},e.prototype.initView=function(){for(var t=[],e=0,i=tb.TB_treasure_set.getSet().recast_cost;e<i.length;e++){var n=i[e];t.push(new CostVo(n))}this.listCost.array=t,this.listCost.width=154*t.length+(t.length-1)*this.listCost.spaceX;var o=a.TreasureModel.getInstance().getRebirthTreasureList();this.listTreasure.array=o,this.boxEmpty.visible=0==o.length,this.setTreasureItem(null),this.listTreasure.selectedIndex=-1},e.prototype.onSelect=function(t){if(-1!=t){var e=this.listTreasure.getItem(t);this.setTreasureItem(e)}},e.prototype.setTreasureItem=function(r){var s=this,t=!!r;if(this.btnAdd.visible=!t,this.itemBox.visible=t,this.itemBox.dataSource=r){var e={};e[Protocol.game_treasure_recastReturnItems.args.treasureKey]=r.uuid,PLC.request(Protocol.game_treasure_recastReturnItems,e,function(t,e){if(!t)return s.listItem.array=null,void(s.lbTitle.visible=!0);var i=[];i.push(new ItemVo(r.templateId,r.num));for(var n=0,o=t.returnItems;n<o.length;n++){var a=o[n];i.push(new ItemVo(a[0],a[1]))}s.listItem.array=i,s.listItem.width=5<i.length?590:100*i.length+(i.length-1)*s.listItem.spaceX,s.lbTitle.visible=!1},!0)}else this.listItem.array=null,this.lbTitle.visible=!0},e.prototype.onRebirth=function(){var t=this.itemBox.dataSource;t?dispatchEvt(new a.TreasureEvent(a.TreasureEvent.TREASURE_OPERATION),[a.TreasureOperation.rebirth,[t]]):showToast(LanMgr.getLan("",10367))},e.prototype.onRule=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20018))},e);function e(){return i.call(this)||this}a.TreasureRebirthView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=ui.god.treasure.render.StarAttrPreviewIRUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource?this.dataSource[0]:null,e=this.dataSource?this.dataSource[1]:0;if(t){var i=t.getStarlv();this.lbName.text=r.TreasureUtil.getStarName(i);for(var n=5<i?i-5:i,o=new Array,a=0;a<n;a++)o[a]=6<=i;this.starList.repeatX=n,this.starList.array=o,this.lbActivity.text=i<=e?LanMgr.getLan("",12385):LanMgr.getLan("",12386),this.lbActivity.color=i<=e?ColorConst.TASK_GREEN:ColorConst.normalFont,this.attrList.array=r.TreasureUtil.getTbAttrStrAry(t),this.attrList.height=24*this.attrList.array.length+(this.attrList.array.length-1)*this.attrList.spaceY,this.height=this.attrList.y+this.attrList.height+10}else this.starList.array=null,this.attrList.array=null},i.prototype.onXingjiRender=function(t,e){t.dataSource?(t.width=29,t.height=31,t.skin=SkinUtil.superXing):(t.width=26,t.height=31,t.skin=SkinUtil.xingxing)},i);function i(){var t=e.call(this)||this;return t.starList.renderHandler=new Handler(t,t.onXingjiRender),t}r.TreasureStarAttrPreviewIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var t,e=(t=ui.god.treasure.render.TreasureMaterialIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),i.prototype.initView=function(){var t=this.dataSource;if(t){var e=t.tbVo,i={templateId:e.itemId,quality:e.quality,starLv:e.starLv,num:0},n=h.TreasureUtil.createTreasureVo("",i);if(n.show=!1,e.type==h.TreasureConfigType.item){var o=tb.TB_item.get_TB_itemById(e.itemId);n.quality=o?o.quality:1}else e.type==h.TreasureConfigType.quality&&(n.clientUrl=SkinUtil.getTreasureQualitySkin(e.quality));this.itemBox.dataSource=n}},i.prototype.refreshData=function(t){var e=this.dataSource;if(e){for(var i=[],n=0,o=t;n<o.length;n++){var a=o[n];a!=e&&i.push.apply(i,a.choose)}var r=h.TreasureUtil.filterTreasures(e.tbVo,e.curTreasure,i),s=e.tbVo,u=e.choose.length>=s.count;this.btnAdd.visible=0<r.length&&!u,this.lbNum.visible=!0,this.lbNum.text=e.choose.length+"/"+s.count,this.lbNum.color=e.choose.length==s.count?"#0bff00":"#ff0501"}},i);function i(){return t.call(this)||this}h.TreasureMaterialIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.treasure.render.TujianIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t?(this.itemBox.dataSource=t,this.imgMask.visible=-1==App.hero.treasureBooks.indexOf(t.templateId)):this.itemBox.dataSource=null},n);function n(){return e.call(this)||this}t.TreasueTujianIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.treasure.render.StrengthAttrIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t&&(this.lbName.text=t[0],this.lbValue.text=t[1],this.lbValue.color=t[2]||ColorConst.normalFont)},n);function n(){return e.call(this)||this}t.StrengthAttrIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.treasure.render.StarupAttrIrUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t&&(this.lbName.text=t[0],this.lbValue.text=t[1])},n);function n(){return e.call(this)||this}t.StarupAttrIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.treasure.render.SingleSelectTreasureIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t?(this.itemBox.dataSource=t,this.animSelect.play(0,!0)):(this.itemBox.dataSource=null,this.animSelect.stop())},n);function n(){return e.call(this)||this}t.SingleSelectTreasureIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.treasure.render.ChooseTreasureIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;this.itemBox.dataSource=t||null},n.prototype.refreshData=function(){},n);function n(){return e.call(this)||this}t.ChooseTreasureIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.god.treasure.GodTreasureUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;if(t){var e=App.IsSysOpen(ModuleConst.TREASURE),i=!!t.getCurTreasure();if(this.imgSuo.visible=!e,this.btnAdd.visible=e&&!i,this.itemBox.visible=i){var n=t.getCurTreasure();this.itemBox.dataSource=n}else this.itemBox.dataSource=null;this.on(Laya.Event.CLICK,this,this.onClick),this.redpoint.setRedPointName("god_treasure_wear_"+t.uuid)}else this.itemBox.dataSource=null,this.imgSuo.visible=this.btnAdd.visible=this.itemBox.visible=!1,this.off(Laya.Event.CLICK,this,this.onClick),this.redpoint.onDispose()},n.prototype.onClick=function(){if(App.IsSysOpen(ModuleConst.TREASURE)){var t=this.dataSource;if(t){var e=t.getCurTreasure();e?i.TreasureTipsView.showTip(this,e,t):dispatchEvt(new i.TreasureEvent(i.TreasureEvent.SHOW_CHOOSE_TREASURE_VIEW),[i.ChooseTreasureOpenType.wear,null,t])}}else showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.TREASURE).prompt)},n);function n(){return t.call(this)||this}i.GodTreasureView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var o,t;(t=o=n.ChooseTreasureOpenType||(n.ChooseTreasureOpenType={}))[t.wear=1]="wear",t[t.change=2]="change",t[t.rebirth=3]="rebirth";var i,e=(i=ui.god.treasure.ChooseTreasureUI,__extends(a,i),a.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0},this.itemList.selectedIndex=-1,this.itemList.selectEnable=!1,this.itemList.mouseHandler=new Handler(this,this.onSelect)},a.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},a.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.itemList.array=null,this.itemList.selectedIndex=-1,Laya.timer.clearAll(this),this._openType=0,this._treasureVo=null,this._godVo},a.prototype.initView=function(){var t=this.dataSource;this._openType=t[0],this._treasureVo=t[1],this._godVo=t[2];var e=n.TreasureModel.getInstance();this._openType==o.rebirth?this.itemList.array=e.getRebirthTreasureList():this.itemList.array=e.getTreasureChooseList(!0)},a.prototype.onSelect=function(t,e){if(-1!=e&&t.type==Laya.Event.CLICK){var i=this.itemList.array[e];if(!i)return;this._openType==o.wear||this._openType==o.change?n.TreasureTipsView.popupTip(i,this._godVo,!0):this._openType==o.rebirth&&n.TreasureTipsView.popupTip(i,this._godVo,!1,{chooseFlag:!0})}},a);function a(){return i.call(this)||this}n.ChooseTreasureView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.god.treasure.ChooseMaterialUI,__extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:""},this.itemList.mouseHandler=new Handler(this,this.onListHandler),this.itemList.selectEnable=!1,this.btnComfirm.on(Laya.Event.CLICK,this,this.onConfirm)},n.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.itemList.array=null,Laya.timer.clearAll(this)},n.prototype.initView=function(){var t=this.dataSource;this.itemList.array=t.allList,Laya.timer.callLater(this,this.initSelected)},n.prototype.initSelected=function(){var t=this.dataSource;if(t&&t.curMaterail){function e(t){var e=a[t],i=e.dataSource;if(!i)return 1;var n=o.some(function(t){return t.id==i.uuid});e.imgGouxuan.visible=n}var o=t.curMaterail.choose,a=this.itemList.cells;for(var i in a)e(i)}},n.prototype.onListHandler=function(t,e){if(t.type==Laya.Event.CLICK){var i=this.itemList.getCell(e),n=i.dataSource,o=this.dataSource;if(!n||!o)return;var a=o.curMaterail;if(!i.imgGouxuan.visible&&this.getCurSelectedCount()>=a.tbVo.count)return void showToast(LanMgr.getLan("",10366,a.tbVo.count));i.imgGouxuan.visible=!i.imgGouxuan.visible}},n.prototype.onConfirm=function(){var t=this.dataSource;if(t){t.curMaterail.choose=[];var e=this.itemList.cells;for(var i in e){var n=e[i],o=n.dataSource;o&&n.imgGouxuan.visible&&t.curMaterail.choose.push({id:o.uuid,index:Number(i)})}UIMgr.hasStage(UIConst.TreasureStarupView)&&UIMgr.getUIByName(UIConst.TreasureStarupView).refreshChooseList(),this.close()}},n.prototype.getCurSelectedCount=function(){var t=0,e=this.itemList.cells;for(var i in e){var n=e[i];n.dataSource&&n.imgGouxuan.visible&&(t+=n.dataSource.num)}return t},n);function n(){return e.call(this)||this}t.ChooseTreasureMaterialView=i}(game=game||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(l){var t=(e.createTreasureVo=function(t,e,i){var n=JSON.parse(JSON.stringify(e)),o=new TreasureItemVo(n);return o.uuid=t,i&&(o.slot=i),o},e.getTbAttrStrAry=function(t){if(!t)return[];var e=LanMgr.attrName,i=[iface.tb_prop.attrTypeKey.effectHit,iface.tb_prop.attrTypeKey.effectResist,iface.tb_prop.attrTypeKey.crit,iface.tb_prop.attrTypeKey.critDmg,iface.tb_prop.attrTypeKey.effectResist,iface.tb_prop.attrTypeKey.suckBlood,iface.tb_prop.attrTypeKey.strikeBack,iface.tb_prop.attrTypeKey.rampage,iface.tb_prop.attrTypeKey.dizzy,iface.tb_prop.attrTypeKey.healRate,iface.tb_prop.attrTypeKey.addDmg,iface.tb_prop.attrTypeKey.subDmg,iface.tb_prop.attrTypeKey.immuDizzy],n=t.getAttr(),o=n[0]||{},a=n[1]||{},r=[];for(var s in o){var u=LanMgr.getLan(e[Number(s)],-1),h=-1!=i.indexOf(Number(s))?"+"+Math.round(1e4*o[s])/100+"%":"+"+o[s];r.push([u,h])}for(var s in a)u=LanMgr.getLan(e[Number(s)],-1),h="+"+Math.round(1e4*a[s])/100+"%",r.push([u,h]);return r},e.getTbStrengthAttr=function(t,e,i){var n=tb.TB_treasure.getTbItem(t,e,i);return n?n.getAttr():[{},{}]},e.getTbStarAttr=function(t,e,i){var n=tb.TB_treasure_star.getTbItem(t,e,i);return n?n.getAttr():[{},{}]},e.filterTreasures=function(t,e,i,n){var o=l.TreasureModel.getInstance().getTreasures();o=o.filter(function(t){return!t.isExsitGod()});var a=[];if(t.type==l.TreasureConfigType.item)for(var r=0;r<o.length;r++)e&&o[r].uuid==e.uuid||o[r].templateId==t.itemId&&o[r].starLv==t.starLv&&a.push(o[r]);else if(t.type==l.TreasureConfigType.quality)for(r=0;r<o.length;r++)e&&o[r].uuid==e.uuid||o[r].starLv!=t.starLv||0!=t.quality&&o[r].quality!=t.quality||a.push(o[r]);function s(e){var t=a.findIndex(function(t){return t.uuid==e.id});-1!=t&&a.splice(t,1)}for(var u=0,h=i=i||[];u<h.length;u++)s(h[u]);return 0<n&&a.sort(function(t,e){return t.strengthLv-e.strengthLv}),__spreadArrays(a)},e.hasNotWearTreasures=function(){var t=App.hero.treasures;for(var e in t)if(!t[e].godId)return!0;return!1},e.getStarName=function(t){return LanMgr.starName[t]||LanMgr.getLan("",12230)},e.hasCanRebirthTreasure=function(){var t=App.hero.treasures;for(var e in t){var i=t[e];if(!i.godId&&i.quality>QualityConst.PURPLE&&(0<i.strengthLv||0<i.starLv))return!0}return!1},e);function e(){}l.TreasureUtil=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,n,e,u=(t=tl3d.BaseEvent,__extends(o,t),o.SHOW_CHOOSE_TREASURE_VIEW="SHOW_CHOOSE_TREASURE_VIEW",o.SHOW_STRENGTH_VIEW="SHOW_STRENGTH_VIEW",o.SHOW_STARUP_VIEW="SHOW_STARUP_VIEW",o.SHOW_STAR_ATTR_PREVIEW="SHOW_STAR_ATTR_PREVIEW",o.SHOW_TUJIAN_VIEW="SHOW_TUJIAN_VIEW",o.SHOW_REBIRTH_VIEW="SHOW_REBIRTH_VIEW",o.UPDATE_TREASURE_DATA="UPDATE_TREASURE_DATA",o.ADD_TREASURE="ADD_TREASURE",o.DEL_TREASURE="DEL_TREASURE",o.MODIFY_TREASURE="MODIFY_TREASURE",o.MODIFY_GOD_TREASURE="MODIFY_GOD_TREASURE",o.MODIFY_TARGET_TREASURE="MODIFY_TARGET_TREASURE",o.TREASURE_OPERATION="TREASURE_OPERATION",o.CHOOSE_TREASURE="CHOOSE_TREASURE",o.WEAR_SUCCESS="WEAR_TREASURE_SUCCESS",o.STRENGTH_SUCCESS="STRENGTH_TREASURE_SUCCESS",o.SELECT_STRENGTH_TREASURE="SELECT_STRENGTH_TREASURE",o);function o(){return null!==t&&t.apply(this,arguments)||this}i.TreasureEvent=u,(e=n=i.TreasureOperation||(i.TreasureOperation={}))[e.wear=1]="wear",e[e.takeoff=2]="takeoff",e[e.strength=3]="strength",e[e.starup=4]="starup",e[e.rebirth=5]="rebirth";var a,r=(a=tl3d.Processor,__extends(s,a),s.prototype.getName=function(){return"TreasureProcessor"},s.prototype.listenModuleEvents=function(){return[new u(u.SHOW_CHOOSE_TREASURE_VIEW),new u(u.SHOW_STRENGTH_VIEW),new u(u.SHOW_STARUP_VIEW),new u(u.SHOW_STAR_ATTR_PREVIEW),new u(u.SHOW_TUJIAN_VIEW),new u(u.SHOW_REBIRTH_VIEW),new u(u.MODIFY_GOD_TREASURE),new u(u.MODIFY_TARGET_TREASURE),new u(u.DEL_TREASURE),new u(u.ADD_TREASURE),new u(u.TREASURE_OPERATION),new u(u.CHOOSE_TREASURE)]},s.prototype.receivedModuleEvent=function(t){if(t instanceof u)switch(t.type){case u.SHOW_STRENGTH_VIEW:this.showStrengthView(t.data);break;case u.SHOW_STARUP_VIEW:this.showStarupView(t.data);break;case u.SHOW_STAR_ATTR_PREVIEW:this.showStarAttrPreview(t.data);break;case u.SHOW_CHOOSE_TREASURE_VIEW:this.showChooseTreasure(t.data);break;case u.SHOW_TUJIAN_VIEW:this.showTujianView();break;case u.SHOW_REBIRTH_VIEW:this.showRebirthView();break;case u.MODIFY_GOD_TREASURE:case u.MODIFY_TARGET_TREASURE:this.refreshGodTreasure(t.data);break;case u.ADD_TREASURE:case u.DEL_TREASURE:this.delTreasure();break;case u.TREASURE_OPERATION:this.treasureOperation(t.data);break;case u.CHOOSE_TREASURE:this.chooseTreasure(t.data)}},s.prototype.showStrengthView=function(t){t.isTopStrengthLv()?showToast(LanMgr.getLan("",10345)):UIMgr.showUI(UIConst.TreasureStrengthView,t)},s.prototype.showStarupView=function(t){t.isForbitStarup()?showToast(LanMgr.getLan("",10362)):t.isTopStarLv()?showToast(LanMgr.getLan("",10345)):UIMgr.showUI(UIConst.TreasureStarupView,t)},s.prototype.showStarAttrPreview=function(t){t&&UIMgr.showUI(UIConst.TreasureStarAttrPreview,t)},s.prototype.showTujianView=function(){UIMgr.showUI(UIConst.TreasureTujianView)},s.prototype.showRebirthView=function(){UIMgr.showUI(UIConst.TreasureRebirthView)},s.prototype.showChooseTreasure=function(t){var e=t[0];t[1],t[2],e!=i.ChooseTreasureOpenType.wear&&e!=i.ChooseTreasureOpenType.change||i.TreasureUtil.hasNotWearTreasures()?e!=i.ChooseTreasureOpenType.rebirth||0!=i.TreasureModel.getInstance().getRebirthTreasureList().length?UIMgr.showUI(UIConst.ChooseTreasureView,t):showToast(LanMgr.getLan("",10364)):showToast(LanMgr.getLan("",10363))},s.prototype.refreshGodTreasure=function(t){var e;UIMgr.hasStage(UIConst.God_MainView)&&((e=UIMgr.getUIByName(UIConst.God_MainView)).godView.treasureUI.refreshView(),t&&e.list_tab.selectedIndex==ShenlingTabType.info&&e.curVo&&-1!=t.indexOf(e.curVo.uuid)&&e.godView.refreshCurRole()),UIMgr.hasStage(UIConst.God_GodCultureView)&&(e=UIMgr.getUIByName(UIConst.God_GodCultureView)).godView.treasureUI.refreshView(),UIMgr.hasStage(UIConst.BagView)&&(e=UIMgr.getUIByName(UIConst.BagView)).refreshTreasure(!1)},s.prototype.delTreasure=function(){UIMgr.hasStage(UIConst.BagView)&&UIMgr.getUIByName(UIConst.BagView).refreshTreasure(!0)},s.prototype.chooseTreasure=function(t){UIMgr.hideUIByName(UIConst.ChooseTreasureView),UIMgr.hasStage(UIConst.TreasureRebirthView)&&UIMgr.getUIByName(UIConst.TreasureRebirthView).setTreasureItem(t)},s.prototype.treasureOperation=function(t){var e=t[0],i=t[1];e==n.wear?this.wearTreasure(i):e==n.takeoff?this.takeoff(i):e==n.strength?this.strength(i):e==n.starup?this.starup(i):e==n.rebirth&&this.rebirth(i)},s.prototype.wearTreasure=function(t){var e=t[0],i=t[1],n={};n[Protocol.game_treasure_wearTreasure.args.godId]=e.uuid,n[Protocol.game_treasure_wearTreasure.args.treasureKey]=i.uuid,PLC.request(Protocol.game_treasure_wearTreasure,n,function(t){t&&(UIMgr.hideUIByName(UIConst.ChooseTreasureView),dispatchEvt(new u(u.WEAR_SUCCESS)))})},s.prototype.takeoff=function(t){var e=t[0],i={};i[Protocol.game_treasure_dischargeTreasure.args.treasureKey]=e.uuid,PLC.request(Protocol.game_treasure_dischargeTreasure,i,function(t){})},s.prototype.strength=function(t){for(var e=t[0],i=t[1],n=[],o=[],a=0;a<i.length;a++){var r=i[a];r instanceof TreasureItemVo?o.push(r.uuid):r instanceof ItemVo&&n.push(r.id)}var s={};s[Protocol.game_treasure_strengthTreasure.args.treasureKey]=e.uuid,s[Protocol.game_treasure_strengthTreasure.args.materialArrs]=o,s[Protocol.game_treasure_strengthTreasure.args.itemIds]=n,PLC.request(Protocol.game_treasure_strengthTreasure,s,function(t){t&&(UIMgr.hasStage(UIConst.TreasureStrengthView)&&UIMgr.getUIByName(UIConst.TreasureStrengthView).updateView(),dispatchEvt(new u(u.STRENGTH_SUCCESS)))})},s.prototype.starup=function(t){var e=t[0],i=t[1];if(e.isForbitStarup())showToast(LanMgr.getLan("",10362));else if(e.isTopStarLv())showToast(LanMgr.getLan("",10345));else{var n=[];if(i.every(function(t){return t.isEnough()})){for(var o=0;o<i.length;o++)n.push(i[o].getFormatData());var a={};a[Protocol.game_treasure_riseStarTreasure.args.treasureKey]=e.uuid,a[Protocol.game_treasure_riseStarTreasure.args.materialArrs]=n,PLC.request(Protocol.game_treasure_riseStarTreasure,a,function(t,e){t&&UIMgr.hasStage(UIConst.TreasureStarupView)&&UIMgr.getUIByName(UIConst.TreasureStarupView).initView()})}else showToast(LanMgr.getLan("",12e3))}},s.prototype.rebirth=function(t){var e=t[0];if(e.isCanRebirth()){for(var i=0,n=tb.TB_treasure_set.getSet().recast_cost;i<n.length;i++){var o=n[i];if(UIUtil.checkNotEnough(o[0],o[1]))return}var a={};a[Protocol.game_treasure_recastTreasure.args.treasureKey]=e.uuid,PLC.request(Protocol.game_treasure_recastTreasure,a,function(t,e){t&&(UIUtil.showRewardView(t.commonData),UIMgr.hasStage(UIConst.TreasureRebirthView)&&UIMgr.getUIByName(UIConst.TreasureRebirthView).initView(),UIMgr.hasStage(UIConst.BagView)&&UIMgr.getUIByName(UIConst.BagView).refreshTreasure(!0))})}else showToast(LanMgr.getLan("",10364))},s);function s(){return a.call(this)||this}i.TreasureProcessor=r}(game=game||{}),function(u){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.initModel=function(){for(var t in this._treasureList.length=0,App.hero.treasures){var e=u.TreasureUtil.createTreasureVo(t,App.hero.treasures[t]);this._treasureList.push(e)}dispatchEvt(new u.TreasureEvent(u.TreasureEvent.UPDATE_TREASURE_DATA))},e.prototype.addTreasure=function(t){var e=[];for(var i in t)if(e.push(i),App.hero.treasures.hasOwnProperty(i))for(var n in t[i])App.hero.treasures[i][n]=t[i][n];else{App.hero.treasures[i]=t[i];var o=u.TreasureUtil.createTreasureVo(i,t[i]);this._treasureList.push(o)}dispatchEvt(new u.TreasureEvent(u.TreasureEvent.ADD_TREASURE),e)},e.prototype.delTreasure=function(t){var e=[];for(var i in t)App.hero.treasures.hasOwnProperty(i)&&(delete App.hero.treasures[i],e.push(i));for(var n=this._treasureList.length-1;0<=n;n--)i=this._treasureList[n].uuid,-1!=e.indexOf(i)&&this._treasureList.splice(n,1);dispatchEvt(new u.TreasureEvent(u.TreasureEvent.DEL_TREASURE),e)},e.prototype.modifyTreasures=function(t){var e=[],i=null;for(var n in t)(i=App.hero.treasures[n])&&(i.godId=t[n],this.getTreasureByUuid(n).godId=t[n],e.push(n));dispatchEvt(new u.TreasureEvent(u.TreasureEvent.MODIFY_TREASURE),e)},e.prototype.modifyNum=function(t){var e=[];for(var i in t){App.hero.treasures[i]&&(App.hero.treasures[i].num=t[i]);var n=this.getTreasureByUuid(i);n&&(n.num=t[i],e.push(i))}dispatchEvt(new u.TreasureEvent(u.TreasureEvent.MODIFY_TREASURE),e)},e.prototype.modifyGodTreasures=function(t){var e=[];for(var i in t){e.push(i);var n=App.hero.gods[i];n&&(n.treasureKeys=t[i]);var o=App.hero.getGodVoById(i),a=t[i];for(var r in o.treasureKeys=[],a){var s=this.getTreasureByUuid(a[r]);s||logerror("没有该圣物,uuid:",a[r]),o.treasureKeys.push(s)}}dispatchEvt(new u.TreasureEvent(u.TreasureEvent.MODIFY_GOD_TREASURE),e)},e.prototype.updateTargetTreasures=function(t){var e=[];for(var i in t){var n=t[i],o=App.hero.treasures[i];if(o){var a=this.getTreasureByUuid(i);for(var r in n)o[r]=n[r],a[r]=n[r];e.push(i)}}dispatchEvt(new u.TreasureEvent(u.TreasureEvent.MODIFY_TARGET_TREASURE),e)},e.prototype.getTreasureByUuid=function(e){return this._treasureList.find(function(t){return t.uuid==e})},e.prototype.getTreasures=function(){return this._treasureList},e.prototype.getTreasureChooseList=function(t){var e=this._treasureList.filter(function(t){return!t.isExsitGod()});return t&&(e.forEach(function(t){t.show=!1,t.sortNum=1e7*t.quality+1e5*t.starLv+1e3*t.strengthLv-t.templateId}),e.sort(function(t,e){return e.sortNum-t.sortNum})),e},e.prototype.getStrengthTreasureList=function(e){e=e||[];var t=this._treasureList.filter(function(t){return!t.isExsitGod()&&t.quality<QualityConst.ORANGE&&-1==e.indexOf(t.uuid)});t.forEach(function(t){t.show=!1,t.sortNum=1e7*t.quality+1e5*t.starLv-1e3*t.strengthLv-t.templateId}),t.sort(function(t,e){return t.sortNum-e.sortNum});var i=t,n=App.hero.getBagItemNum(CostTypeKey.treasure_exp);if(0<n){var o=new ItemVo(CostTypeKey.treasure_exp,n);o.show=!1,i.unshift(o)}return i},e.prototype.getBagViewList=function(){var t=this._treasureList.filter(function(t){return!t.isExsitGod()});return t.forEach(function(t){t.show=!1,t.sortNum=1e7*t.quality+1e5*t.starLv+1e3*t.strengthLv-t.templateId}),t.sort(function(t,e){return e.sortNum-t.sortNum}),t},e.prototype.getTujianViewList=function(){if(!this._tujianList){this._tujianList=[];var t=[],e=TableData.getInstance().getTableByName(TableData.tb_item).data;for(var i in e){var n=e[i];n.type==iface.tb_prop.itemTypeKey.treasure&&t.push(n)}this._tujianList=t.map(function(t){var e=tb.TB_treasure.getList2(t.quality,t.defined[0]),i=e[e.length-1],n=i?i.getStrengthLv():0,o=tb.TB_treasure_star.getList2(t.quality,t.defined[0]),a=o[o.length-1],r=a?a.getStarlv():0,s={templateId:t.ID,quality:t.quality,num:0,strengthLv:n,starLv:r},u=new TreasureItemVo(s);return u.show=!0,u})}return this._tujianList},e.prototype.getRebirthTreasureList=function(){return this._treasureList.filter(function(t){return t.show=!1,t.isCanRebirth()})},e);function e(){this._treasureList=[]}u.TreasureModel=t}(game=game||{}),function(t){var e,i,n=(o.prototype.isEnough=function(){return this.choose.length>=this.tbVo.count},o.prototype.getFormatData=function(){for(var t=[],e=0,i=this.choose;e<i.length;e++){var n=i[e];t.push(n.id)}return t},o.prototype.getWarn=function(){if(this.tbVo.type!=e.item)return LanMgr.getLan("",10370,this.tbVo.starLv,LanMgr.qualityColor[this.tbVo.quality]);var t=tb.TB_item.get_TB_itemById(this.tbVo.itemId);return t?LanMgr.getLan("",10369,this.tbVo.starLv,t.name):LanMgr.getLan("",10368)},o);function o(t,e){this.tbVo=t,this.curTreasure=e,this.choose=[]}t.TreasureMaterialVo=n,(i=e=t.TreasureConfigType||(t.TreasureConfigType={}))[i.item=1]="item",i[i.quality=2]="quality"}(game=game||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(_){var t=(f.filterGods=function(t,e,i){var n=App.hero.getGodAry(-1,-1),o=[];if(t.type==_.ConfigType.god)for(var a=0;a<n.length;a++)n[a].templateId==t.godId&&n[a].uuid!=e.uuid&&n[a].starLevel==t.starLv&&o.push(n[a]);else if(t.type==_.ConfigType.race)for(a=0;a<n.length;a++)n[a].tab_god.race_type!=e.tab_god.race_type&&0!=t.race||n[a].uuid==e.uuid||n[a].starLevel!=t.starLv||o.push(n[a]);function r(e){if(e.type==_.MaterialType.god)-1!=(t=o.findIndex(function(t){return t.uuid==e.id}))&&o.splice(t,1);else if(e.type==_.MaterialType.card){var t;-1!=(t=s.findIndex(function(t){return t.id==e.id}))&&s.splice(t,1)}}for(var s=f.getUniversalCards(t),u=0,h=i=i||[];u<h.length;u++)r(h[u]);return __spreadArrays(o,s)},f.isEnoughMaterial=function(t,e,i){void 0===i&&(i=!1);var n=[];if(i)for(var o=0,a=App.hero.getGodArr();o<a.length;o++){var r=a[o];r.isInLinuep()&&n.push({type:_.MaterialType.god,id:r.uuid,index:-1})}for(var s=!0,u=0,h=e;u<h.length;u++){var l=h[u],c=f.filterGods(l,t,n);if(c.length<l.count){s=!1;break}c=c.slice(0,l.count);for(var p=0;p<c.length;p++){var d=c[p];d instanceof GodItemVo?n.push({type:_.MaterialType.god,id:d.uuid,index:p}):d instanceof ItemVo&&n.push({type:_.MaterialType.card,id:d.id,index:p})}}return s},f.getUniversalCards=function(e,o){o=o||_.GodModel.getInstance().getWanNengCards();var t=tb.TB_god_set.get_TB_god_set().universal_card.filter(function(t){return e.type!=_.ConfigType.god?e.starLv==t[0]:tb.TB_god.get_TB_godById(e.godId).quality==t[1]&&e.starLv==t[0]}),a=new Array;return t.forEach(function(t){var e=o[t[2]];if(null!=e&&0<e)for(var i=0;i<e;i++){var n=new ItemVo(t[2],1);n.cardQuailty=t[1],n.show=!1,a.push(n)}}),a},f.isCanBuzhen=function(){var e=0;tb.TB_game_set.get_TB_game_setById(1).lineup.forEach(function(t){App.hero.level>=t&&e++});var t=App.hero.getLineUpTeam(iface.tb_prop.lineupTypeKey.attack),i=0;t.forEach(function(t){t.uuid&&""!=t.uuid&&i++});var n=App.hero.getGodAry().filter(function(e){return!t.some(function(t){return t.tab_god.ID==e.tab_god.ID})});return i<e&&0<n.length},f.isUnlock=function(t,e){return e>=tb.TB_game_set.get_TB_game_setById(1).lineup[t]},f.getUnlockLv=function(t){return tb.TB_game_set.get_TB_game_setById(1).lineup[t]},f.getUnlockNum=function(){for(var t=0,e=0,i=tb.TB_game_set.get_TB_game_setById(1).lineup;e<i.length;e++){var n=i[e];App.hero.level>=n&&t++}return t},f.downGods=function(r){return new Promise(function(e,t){if(r){var i=App.hero.lineupInfo;for(var n in i)if(Number(n)!=iface.tb_prop.lineupTypeKey.expedition){var o=i[n];if(o.some(function(t){return t==r.uuid})&&o.length<=1)return void showToast(Number(n)==iface.tb_prop.lineupTypeKey.expedition?LanMgr.getLan("",10365):LanMgr.getLan("",10351))}var a={};a[Protocol.game_common_quickQuitLineup.args.godId]=r.uuid,PLC.request(Protocol.game_common_quickQuitLineup,a,function(t){t?(r.isAttackFight=r.isDefendFight=r.isYuanzhengFight=!1,UIMgr.hasStage(UIConst.God_MainView)&&UIMgr.getUIByName(UIConst.God_MainView).refreshRoles(),e()):showToast(LanMgr.getLan("",10352))})}else logerror("下阵英雄不能为空")})},f.replaceGod=function(n,o,a){return new Promise(function(t,e){if(isNaN(a)||a<0||5<a)logwarn("更换英雄的位置错误：",a);else{var i=iface.tb_prop.lineupTypeKey.attack;-1==App.hero.getLineUpTeam(i,!0).filter(function(t,e){return t&&e!=a}).map(function(t){return t.templateId}).indexOf(o.templateId)?n&&(0<n.equipKeys.length||0<o.equipKeys.length||0<n.gemsList.length||0<o.gemsList.length)?common.AlertBox.showAlert({text:LanMgr.getLan("",10354),confirmCb:function(){var t={};t[Protocol.game_common_ajustLineupEquip.args.type]=i,t[Protocol.game_common_ajustLineupEquip.args.srcId]=o.uuid,t[Protocol.game_common_ajustLineupEquip.args.dstId]=n.uuid,PLC.request(Protocol.game_common_ajustLineupEquip,t,function(t){t?(UIMgr.hideUIByName(UIConst.God_ReplaceGodView),UIMgr.hasStage(UIConst.God_MainView)&&UIMgr.getUIByName(UIConst.God_MainView).changeRole(n,o)):showToast(LanMgr.getLan("",10355))})},cancelCb:function(){f.shangZhen(n,o,a,i,t)}}):f.shangZhen(n,o,a,i,t):showToast(LanMgr.getLan("",10353))}})},f.shangZhen=function(e,i,n,o,t){var a=App.hero.getLineUpTeam(o,!0).map(function(t,e){return t?e==n?i.uuid:t.uuid:e==n?i.uuid:null}),r=f.getUnlockNum();a=a.slice(0,r);var s={};s[Protocol.game_common_ajustLineup.args.type]=o,s[Protocol.game_common_ajustLineup.args.godIds]=a,PLC.request(Protocol.game_common_ajustLineup,s,function(t){t?(showToast(LanMgr.getLan("",10357)),UIMgr.hideUIByName(UIConst.God_ReplaceGodView),UIMgr.hasStage(UIConst.God_MainView)&&UIMgr.getUIByName(UIConst.God_MainView).changeRole(e,i),dispatchEvt(new _.GodEvent(_.GodEvent.BUZHEN_COMPLETE_ONE),o)):showToast(LanMgr.getLan("",10356))})},f.getGodLevelId=function(t,e){return 1e3*t+e},f.getGodStarId=function(t,e){return 1e4*t+e},f.getGodsNum=function(){return Object.keys(App.hero.gods).length},f.isCanActivitySkin=function(t){return t.getSkinList().some(function(t){return t.isCanActivity()})},f.getHaloGodNumAry=function(t){return tb.TB_halo.getType(t).map(function(t){return t.godNum})},f.isActiveHalo=function(t,e){return f.getHaloGodNumAry(t).some(function(t){return t<=e})},f.getSkillUpLvCondition=function(t,e,i){for(var n=0,o=tb.TB_god_evolution.get_TB_god_evolution(),a=0;a<o.length;a++){var r=o[a];if(r&&r.evolution_effect[t]==e+1){n=r.ID;break}}return i<n&&(n=0),n},f.isActiveGodStarLv=function(t,e){var i=App.hero.maxStarLvInfo;return e<=(i&&i.hasOwnProperty(t)&&i[t]||0)},f.isActiveGod=function(t){var e=tb.TB_god.get_TB_godById(t).star[0]||0;return f.isActiveGodStarLv(t,e)},f.getGodModel=function(t,e){if(t==_.GodSkinType.awaken)return e?e instanceof tb.TB_monster?e.model:e.awake_model:0;if(t==_.GodSkinType.origin)return e?e.model:0;var i=tb.TB_skin.getTbById(t);return i?i.model:0},f.getShowGodModel=function(t,e){var i=tb.TB_god.get_TB_godById(t),n=0;if(i){var o=i?i.getSkinVo(e):null;n=o?o.getModelId():0}else n=(i=tb.TB_god.get_TB_godById(common.GlobalData.DEFAULT_SHOW_GODID)).model;return n},f);function f(){}_.GodUtils=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(p){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"GodProcessor"},i.prototype.listenModuleEvents=function(){return[new p.GodEvent(p.GodEvent.SHOW_SHENGLING_PANEL),new p.GodEvent(p.GodEvent.SHOW_KEZHI_VIEW),new p.GodEvent(p.GodEvent.CLICK_JUEXING_EVENT),new p.GodEvent(p.GodEvent.SHOW_BUZHEN_PANEL),new p.GodEvent(p.GodEvent.USE_EXPPOOL),new p.GodEvent(p.GodEvent.CLICK_STAR_UP),new p.GodEvent(p.GodEvent.CHOOSE_LINEUP_GOD),new p.GodEvent(p.GodEvent.SHOW_SHENGJIE_ATTR),new p.GodEvent(p.GodEvent.GOD_PORP_CHANGE),new p.GodEvent(p.GodEvent.BUZHEN_COMPLETE_ALL),new p.ResEvent(p.ResEvent.PROP_CHANGE),new p.ResEvent(p.ResEvent.GOD_EXP_CHANGE),new p.GodEvent(p.GodEvent.GOD_SHENGJIE_SUCCESS),new p.GodEvent(p.GodEvent.SHOW_REPLACE_VIEW),new p.GodEvent(p.GodEvent.SHOW_GOD_CULTURE_VIEW)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof p.GodEvent)switch(t.type){case p.GodEvent.SHOW_SHENGLING_PANEL:this.showPanel(t.data);break;case p.GodEvent.SHOW_KEZHI_VIEW:this.showKezhiPanel(t.data);break;case p.GodEvent.CLICK_JUEXING_EVENT:this.onAwaken(t.data);break;case p.GodEvent.BUZHEN_COMPLETE_ALL:this.buzhenComplete();break;case p.GodEvent.GOD_PORP_CHANGE:this.godPropChange(t.data);break;case p.GodEvent.SHOW_BUZHEN_PANEL:this.show_buzhenView(t.data);break;case p.GodEvent.USE_EXPPOOL:this.expPoolLevelUp(t.data);break;case p.GodEvent.CLICK_STAR_UP:this.starUpEvent(t.data);break;case p.GodEvent.CHOOSE_LINEUP_GOD:this.downGods(t.data);break;case p.GodEvent.SHOW_SHENGJIE_ATTR:this.countDegreeUp(t.data);break;case p.GodEvent.GOD_SHENGJIE_SUCCESS:this.shengjieSucc(t.data);break;case p.GodEvent.SHOW_REPLACE_VIEW:this.showReplaceView(t.data);break;case p.GodEvent.SHOW_GOD_CULTURE_VIEW:this.showGodInfoView(t.data)}if(t instanceof p.ResEvent)switch(t.type){case p.ResEvent.PROP_CHANGE:this.propChange();break;case p.ResEvent.GOD_EXP_CHANGE:this.refreshResource()}},i.prototype.shengjieSucc=function(t){UIMgr.showUI(UIConst.God_DgUp_SUCCView,t)},i.prototype.showReplaceView=function(t){var e=t?t[0]:null,i=t?t[1]:void 0;!isNaN(i)&&null!=i&&null!=i||(i=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack,!0).findIndex(function(t){return!t||""==t})),0<=i&&i<6&&UIMgr.showUI(UIConst.God_ReplaceGodView,[e,i])},i.prototype.showGodInfoView=function(t){!t||t.length<2||UIMgr.showUI(UIConst.God_GodCultureView,t)},i.prototype.refreshResource=function(){UIMgr.hasStage(UIConst.God_MainView)&&this.godMainview.viewInfo&&this.godMainview.viewInfo.setCostText()},i.prototype.godPropChange=function(t){UIMgr.hasStage(UIConst.God_MainView)&&this.godMainview.refreshRolesByGod(t,!1),UIMgr.hasStage(UIConst.God_GodCultureView)&&this.godCultureView.refreshCurRole(t)},i.prototype.starUpEvent=function(t){var i=this,n=t[0],e=t[1]?t[1]:[];if(n.hasStarUpCost())if(n.forbitStarUpTo7())showToast(LanMgr.getLan("",10346));else{var o=p.GodUtils.getGodStarId(n.starLevel,n.templateId),a=tb.TB_god_star.get_TB_god_starById(o),r=[];if(a&&a.material){if(!e.every(function(t){return t.isEnough()}))return void showToast(LanMgr.getLan("",10347));for(var s=0,u=e;s<u.length;s++){var h=u[s];r.push(h.getFormatData())}}var l={};l[Protocol.game_god_raiseStar.args.godId]=n.uuid,l[Protocol.game_god_raiseStar.args.materialArrs]=r,PLC.request(Protocol.game_god_raiseStar,l,function(t,e){t&&(UIMgr.hasStage(UIConst.God_MainView)&&(i.godMainview.list_tab.selectedIndex=0),n=App.hero.getGodVoById(n.uuid),UIUtil.showRole(n,UI_FLYTEXT.UPSTART,t.commonData))})}else showToast(LanMgr.getLan("",Lans.cost))},i.prototype.propChange=function(){UIMgr.hasStage(UIConst.God_MainView)&&this.godMainview.viewJuexing&&this.godMainview.viewJuexing.refereshItemList(),UIMgr.hasStage(UIConst.God_GodCultureView)&&this.godCultureView.viewJuexing&&this.godCultureView.viewJuexing.refereshItemList()},i.prototype.buzhenComplete=function(){UIMgr.hasStage(UIConst.God_MainView)&&this.godMainview.refreshRoles()},i.prototype.onAwaken=function(t){var o=this,e=t[0],i=t[1]?t[1]:[];if(e.awakenLv>=e.maxAwakenLv)showToast(LanMgr.getLan("",10348));else if(e.awakenLv>=e.getCurMaxAwakenLv())showToast(LanMgr.getLan("",10349));else{var n=tb.TB_god_awaken.getTbById(e.awakenLv),a=App.isNotEnoughType(n.material);if(-1==a){var r=[];if(n.god_material){if(!i.every(function(t){return t.isEnough()}))return void showToast(LanMgr.getLan("",10350));for(var s=0,u=i;s<u.length;s++){var h=u[s];r.push(h.getFormatData())}}var l=e.uuid,c={};c[Protocol.game_god_awaken.args.godId]=l,c[Protocol.game_god_awaken.args.materialArrs]=r,PLC.request(Protocol.game_god_awaken,c,function(t,e){if(t){if(UIUtil.showRewardView(t.commonData),UIMgr.hasStage(UIConst.God_MainView)){var i=[];o.godMainview.viewJuexing&&(i=o.godMainview.viewJuexing.getAttrToast()),o.godMainview.godView.showJuexingEffect(i),o.godMainview.viewJuexing&&o.godMainview.viewJuexing.refreshJuexing()}UIMgr.hasStage(UIConst.God_GodCultureView)&&(i=[],o.godCultureView.viewJuexing&&(i=o.godCultureView.viewJuexing.getAttrToast()),o.godCultureView.godView.showJuexingEffect(i));var n=App.hero.getGodVoById(l);n&&n.awakenLv==tb.TB_god_set.get_TB_god_set().awake_section&&UIUtil.showRole(n,UI_FLYTEXT.AWAKEN),dispatchEvt(new p.GodEvent(p.GodEvent.GOD_AWAKEN_SUCCESS))}})}else showToast(LanMgr.getLan("",Lans.awakenCost,a))}},i.prototype.showPanel=function(t){UIMgr.hasStage(UIConst.God_MainView)||UIMgr.showUI(UIConst.God_MainView,t)},i.prototype.showKezhiPanel=function(t){t=t||p.GodModel.getInstance().getRaceNumObj(),UIMgr.showUI(UIConst.God_kezhiView,t)},i.prototype.downGods=function(t){var e=this;p.GodUtils.downGods(t).then(function(){e.fenjieview&&e.fenjieview.list_gods.refresh()})},i.prototype.show_buzhenView=function(t){p.GodUtils.getGodsNum()<=0?showToast(LanMgr.getLan("",10017)):UIMgr.showUI(UIConst.BuzhenView,t)},Object.defineProperty(i.prototype,"godMainview",{get:function(){return UIMgr.getUIByName(UIConst.God_MainView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fenjieview",{get:function(){return UIMgr.getUIByName(UIConst.FenjieView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"godCultureView",{get:function(){return UIMgr.getUIByName(UIConst.God_GodCultureView)},enumerable:!0,configurable:!0}),i.prototype.expPoolLevelUp=function(t){var i=this,n=t[0],e=t[1],o={};o[Protocol.game_god_upgrade.args.godId]=n.uuid,o[Protocol.game_god_upgrade.args.count]=e?5:1,PLC.request(Protocol.game_god_upgrade,o,function(t,e){t&&(UIMgr.hasStage(UIConst.God_MainView)&&i.godMainview.godView.sendShuxingEvent(),UIMgr.hasStage(UIConst.God_GodCultureView)&&i.godCultureView.godView.sendShuxingEvent(),dispatchEvt(new p.GodEvent(p.GodEvent.USE_EXPPOOL_SUCCESS),n.uuid))})},i.prototype.countDegreeUp=function(t){for(var e=App.hero.getGodVoById(t),i=e.degree,n=e.jisuanchushi(i),o=e.jisuanchushi(i-1),a=new Array,r=0;r<3;r++)a.push([LanMgr.attrName[r+1],Math.floor(n[r][1])-Math.floor(o[r][1])]);UIMgr.hasStage(UIConst.God_MainView)&&this.godMainview.godView.showShuxing(a)},i);function i(){return t.call(this)||this}p.GodProcessor=e}(game=game||{});var ChooseOpenType,ShenlingTabType;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"GodModule"},n.prototype.listProcessors=function(){return[new t.GodProcessor,new t.TreasureProcessor]},n.prototype.onRegister=function(){t.GodModel.getInstance()},n);function n(){return e.call(this)||this}t.GodModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_SHENGLING_PANEL="SHOW_SHENGLING_PANEL",r.CLICK_JUEXING_EVENT="CLICK_JUEXING_EVENT",r.SELECT_GOD_EVENT="SELECT_GOD_EVENT",r.CHANGE_GOD_ITEM="CHANGE_GOD_ITEM",r.SHOW_KEZHI_VIEW="SHOW_KEZHI_VIEW",r.BUZHEN_COMPLETE="BUZHEN_COMPLETE",r.BUZHEN_COMPLETE_ALL="BUZHEN_COMPLETE_ALL",r.BUZHEN_COMPLETE_ONE="BUZHEN_COMPLETE_ONE",r.SHOW_BUZHEN_PANEL="SHOW_BUZHEN_PANEL",r.SHOW_REPLACE_VIEW="SHOW_REPLACE_VIEW",r.SHOW_GOD_CULTURE_VIEW="SHOW_GOD_CULTURE_VIEW",r.BUZHEN_SELECT_ROLE="BUZHEN_SELECT_ROLE",r.USE_EXPPOOL="USE_EXPPOOL",r.WEAR_SUCCESS="WEAR_SUCCESS",r.CLICK_STAR_UP="CLICK_STAR_UP",r.CHOOSE_LINEUP_GOD="CHOOSE_LINEUP_GOD",r.SHOW_SHENGJIE_ATTR="SHOW_SHENGJIE_ATTR",r.GOD_PORP_CHANGE="GOD_LEVEL_UP_SUC",r.RONGHUN_SUCCESS="RONGHUN_SUCCESS",r.EQUIP_LEVELUP_SUCCESS="EQUIP_LEVELUP_SUCCESS",r.SWITCH_TAB_SUCCESS="SWITCH_TAB_SUCCESS",r.GOD_CHANGE="GOD_CHANGE",r.ADD_GODS="ADD_GODS",r.USE_EXPPOOL_SUCCESS="USE_EXPPOOL_SUCCESS",r.GOD_SHENGJIE_SUCCESS="GOD_SHENGJIE_SUCCESS",r.GOD_AWAKEN_SUCCESS="GOD_AWAKEN_SUCCESS",r.SELECT_RONGHUN_ITEM="SELECT_RONGHUN_ITEM",r.SHANGZHEN_ONE_GOD="SHANGZHEN_ONE_GOD",r.ADD_SKINID="ADD_SKINID",r.GOD_MAX_STAR_LV_CHANGE="GOD_MAX_STAR_LV_CHANGE",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.GodEvent=a}(game=game||{}),function(e){var t=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.getViewGods=function(){return App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack,!0).map(function(t){return App.hero.getGodVoById(t)}).map(function(t,e){return{godVo:t,pos:e}}).sort(function(t,e){return t.godVo||e.godVo?t.godVo&&!e.godVo?-1:!t.godVo&&e.godVo?1:e.godVo.fightPower-t.godVo.fightPower:t.pos-e.pos})},i.prototype.getTabViewDatas=function(t){switch(t){case ShenlingTabType.info:return{viewName:i.tabInfo,viewClz:e.godTabInfoView,sysId:ModuleConst.SHENLING};case ShenlingTabType.shengxin:return{viewName:i.tabStarup,viewClz:e.godTabStarupView,sysId:ModuleConst.SHENGXING};case ShenlingTabType.ronghun:return{viewName:i.tabRonghun,viewClz:e.godTabfuseView,sysId:ModuleConst.RONGHUN};case ShenlingTabType.awaken:return{viewName:i.tabAwaken,viewClz:e.godTabAwakeView,sysId:ModuleConst.JUEXING}}return null},i.prototype.getForce=function(t){void 0===t&&(t=iface.tb_prop.lineupTypeKey.attack);for(var e=App.hero.getLineUpTeam(t),i=0,n=0;n<e.length;n++)i+=e[n].getShenli(t);return i},i.prototype.getMaxForce=function(){for(var t=0,e=0,i=App.hero.getGodArr();e<i.length;e++){var n=i[e].getShenli();t<n&&(t=n)}return t},i.prototype.getWanNengCards=function(){for(var t={},e=0,i=tb.TB_god_set.get_TB_god_set().universal_card;e<i.length;e++){var n=i[e];t[n[2]]=App.hero.getBagItemNum(n[2])}return t},i.getMaxLv=function(t){var e=tb.TB_god_evolution.get_TB_god_evolutionById(t);return e?e.level:-1},i.prototype.getItemID=function(t){switch(t){case 3:return CostTypeKey.suipian_sanxing;case 4:return CostTypeKey.suipian_sixing;case 5:return CostTypeKey.suipian_wuxing;case 6:return CostTypeKey.liuxingka;case 7:return CostTypeKey.qixingka;case 8:return CostTypeKey.baxingka;case 9:return CostTypeKey.jiuxingka;default:return CostTypeKey.suipian_wuxing}},i.prototype.isHasGod=function(e){return App.hero.getGodArr().some(function(t){return t.templateId==e})},i.prototype.getLinuepGodTbid=function(t){return App.hero.getLineUpTeam(t,!1).map(function(t){return t&&t.templateId})},i.prototype.getLineupGodByTbid=function(t,e){return App.hero.getLineUpTeam(t,!1).find(function(t){return t&&t.templateId==e})},i.prototype.getLineupGodCount=function(t){for(var e=App.hero.lineupInfo[t]||[],i=0,n=0;n<e.length;n++)e[n]&&i++;return i},i.prototype.getRaceGodNumInLine=function(t){return t==iface.tb_prop.lineupTypeKey.attack?this._atkRaceGodNum:this._expRaceGodNum},i.prototype.getRaceGodNumInLineByRace=function(t,e){var i=t==iface.tb_prop.lineupTypeKey.attack?this._atkRaceGodNum:this._expRaceGodNum;return e<0||e>=i.length?0:i[e]},i.prototype.onAttackLineChange=function(t){var e=[0,0,0,0,0,0],i=App.hero.getLineUpTeam(t,!1);if(i&&0<i.length)for(var n=0;n<i.length;n++){var o=i[n];o&&e[o.getRaceType()]++}var a=t==iface.tb_prop.lineupTypeKey.attack?this._atkRaceGodNum:this._expRaceGodNum;for(n=0;n<a.length;n++)if(a[n]!=e[n]){t==iface.tb_prop.lineupTypeKey.attack?(this._atkRaceGodNum=e,this._isUpdateRaceAdd_atk=!0):(this._expRaceGodNum=e,this._isUpdateRaceAdd_exp=!0);break}},i.prototype.getRaceNumObj=function(){for(var t={},e=0,i=App.hero.getLineUpTeam(iface.tb_prop.lineupTypeKey.attack);e<i.length;e++){var n=i[e];if(n){var o=n.tab_god.race_type;t[o]=(t[o]||0)+1}}return t},i.prototype.getAllRaceAddTemp=function(t){var e=t==iface.tb_prop.lineupTypeKey.attack?this._atkRaceGodNum:this._expRaceGodNum,i=[],n=tb.TB_halo.getAllType();if(n&&0<n.length)for(var o=0;o<n.length;o++){var a=n[o];if(a&&0<a.length){for(var r=null,s=0;s<a.length;s++){var u=a[s],h=u.type%tb.TB_halo.TYPE_BASE;if(o==tb.TB_halo.TYPE_ALL){for(var l=!0,c=1;c<e.length;c++)if(e[c]<h){l=!1;break}l&&(r=u)}else e[o]>=h&&(r=u)}r&&i.push(r)}}return i},i.prototype.getRaceAddTempByRace=function(t,e){var i=this.getAllRaceAddTemp(t);if(i)for(var n=0;n<i.length;n++)if(i[n].raceType==e)return i[n];return null},i.prototype.isActiveRaceAdd=function(t,e,i,n){if(void 0===i&&(i=-1),void 0===n&&(n=-1),e<0)return!1;var o=this.getAllRaceAddTemp(t);if(o){i<0&&(i=Math.floor(e/tb.TB_halo.TYPE_BASE)),n<0&&(n=e%tb.TB_halo.TYPE_BASE);for(var a=0;a<o.length;a++){var r=o[a];if(r.raceType==i&&r.godNum>=n)return!0}}return!1},i.prototype.getRaceAdd=function(t,e){if(void 0===e&&(e=!0),t==iface.tb_prop.lineupTypeKey.attack?this._isUpdateRaceAdd_atk:this._isUpdateRaceAdd_exp){var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=this.getAllRaceAddTemp(t);if(o&&0<o.length)for(var a=0;a<o.length;a++){var r=o[a];if(r&&r.attr)for(var s=0;s<r.attr.length;s++){var u=r.attr[s],h=u[0];1==u[1]?n[h]+=u[2]:i[h]+=u[2]}}t==iface.tb_prop.lineupTypeKey.attack?(this._isUpdateRaceAdd_atk=!1,this._racePerAdd_atk=i,this._raceValueAdd_atk=n):(this._isUpdateRaceAdd_exp=!1,this._racePerAdd_exp=i,this._raceValueAdd_exp=n)}return e?t==iface.tb_prop.lineupTypeKey.attack?this._racePerAdd_atk:this._racePerAdd_exp:t==iface.tb_prop.lineupTypeKey.attack?this._raceValueAdd_atk:this._raceValueAdd_exp},i.tabInfo="tabInfo",i.tabStarup="tabStarup",i.tabRonghun="tabRonghun",i.tabAwaken="tabAwaken",i);function i(){this.isOnekeyLvup=!0,this.tabredName=["shenling_tab_0","shenling_tab_1","shenling_tab_2","shenling_tab_3","shenling_tab_4"],this.tabTypes=[ShenlingTabType.info,ShenlingTabType.shengxin,ShenlingTabType.awaken,ShenlingTabType.ronghun],this._atkRaceGodNum=[0,0,0,0,0,0],this._expRaceGodNum=[0,0,0,0,0,0],this._isUpdateRaceAdd_exp=!0,this._isUpdateRaceAdd_atk=!0}e.GodModel=t}(game=game||{}),function(t){t[t.FENJIE_VIEW=0]="FENJIE_VIEW",t[t.TURN_VIEW=3]="TURN_VIEW",t[t.awaken=4]="awaken",t[t.starUp=5]="starUp"}(ChooseOpenType=ChooseOpenType||{}),function(t){t[t.info=0]="info",t[t.shengxin=1]="shengxin",t[t.awaken=2]="awaken",t[t.ronghun=3]="ronghun"}(ShenlingTabType=ShenlingTabType||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(__extends(n,i=BaseFightVo),n.prototype.setData=function(t,e,i,n,o,a){this.playerId=t,this.name=e,this.force=i,this.head=n,this.level=o,this.headFrame=a,this.headVo=new UserHeadVo(n,o,a)},n.prototype.setSvo=function(t){for(var e in t)this[e]=t[e];this.headVo=new UserHeadVo(this.head,this.level,this.headFrame)},n.prototype.setDetailInfo=function(t,e){this.guildName=t,i.prototype.setLineupInfo.call(this,e)},n);function n(){var t=i.call(this)||this;return t.type=common.LinuepType.glory,t}t.GloryMatchPlayerVo=e}(game=game||{}),function(i){var t=(e.prototype.setGroupInfo=function(t){if(this.svo)for(var e in t)this.svo[e]=t[e];else this.svo=t;this.lUser.setData(t.leftId,t.leftName,t.leftForce,t.leftHead,t.leftLevel,t.leftHeadFrame),this.rUser.setData(t.rightId,t.rightName,t.rightForce,t.rightHead,t.rightLevel,t.rightHeadFrame),this.tbHonor||(this.tbHonor=tb.TB_honour.getItemById(t.stage)),this.sortNum=1e3*-t.session-100*t.stage-t.round},e.prototype.getGroupName=function(){if(this.isMyMatch){var t=this.svo.session==i.GloryModel.getInstance().season;return this.tbHonor.name+"（"+(t?LanMgr.getLan("",12387):LanMgr.getLan("",12388))+"）"}var e=this.isHaixuan()?this.svo.groupId:this.svo.pos+1;return LanMgr.getLan("",12389,e)},e.prototype.isHasResult=function(){return 0!=this.svo.winner},e.prototype.isEndGroup=function(){return this.isLastMatch||this.isMyMatch||App.serverTimeSecond>=i.GloryUtil.getGroupEndTime(this.tbHonor.ID)},e.prototype.isBye=function(){return!this.svo.leftId||!this.svo.rightId},e.prototype.isInCurGroup=function(){if(this.isLastMatch||this.isMyMatch)return!1;var t=this.tbHonor.ID;return App.serverTimeSecond>=i.GloryUtil.getGroupStartTime(t)&&App.serverTimeSecond<i.GloryUtil.getGroupEndTime(t)},e.prototype.isInBetTime=function(){return i.GloryUtil.isInBetTime(this.tbHonor.ID)},e.prototype.isHasBet=function(){return 0!=this.svo.betId},e.prototype.isHaixuan=function(){return i.GloryUtil.isHaixuan(this.tbHonor.ID)},e.prototype.isLeftWin=function(){return 1==this.svo.winner},e.prototype.getSelfCamp=function(){var t=battle.BatteConsts.BATTLE_CAMPATK;return this.rUser.playerId==App.hero.playerId&&(t=battle.BatteConsts.BATTLE_CAMPDEF),t},e);function e(){this.isMyMatch=!1,this.isLastMatch=!1,this.lUser=new i.GloryMatchPlayerVo,this.rUser=new i.GloryMatchPlayerVo}i.MatchGroupVo=t}(game=game||{}),function(u){var t=(e.prototype.initData=function(){this._matchList.length=0,this.winPos={},this.betInfo.length=0,this.curGroup=0,this._matchGroupList.length=0,this._isFinish=!1},e.prototype.updateMatchList=function(t,e,i,n){var o=0==this._matchList.length;for(var a in t)(r=this.getPlayerById(a))||((r=new u.GloryMatchPlayerVo).playerId=a,r.rankPos=Number(t[a]),r.isLastMatch=this.isLastMatch,this._matchList.push(r));for(var a in e){var r=this.getPlayerById(a),s=e[a];r.clearLineupInfo(),r.setSvo(s)}this.winPos=i,this.betInfo=n,o&&this._matchList.sort(function(t,e){return t.rankPos-e.rankPos})},e.prototype.setCurGroup=function(t){this.curGroup=t,this._isFinish=u.GloryUtil.isEndTime(t)},e.prototype.isNeedRequest=function(t){return!(0!=this._matchList.length&&!this.isLastMatch)||this.curGroup!=t||!this._isFinish&&u.GloryUtil.isEndTime(t)},e.prototype.getPlayerById=function(e){return this._matchList.find(function(t){return t.playerId==e})},e.prototype.getPlayerByPos=function(e){return this._matchList.find(function(t){return t.rankPos==e})},e.prototype.getMatchList=function(){return this._matchList},e.prototype.getMatchGroup=function(t){var e=this.getOtherPos(t);return[this.getPlayerByPos(t),this.getPlayerByPos(e)]},e.prototype.getPosPlayerId=function(t){return this.getPlayerByPos(t).playerId},e.prototype.getPosPlayerIds=function(t){var e=this;return t.map(function(t){return e.getPlayerByPos(t).playerId})},e.prototype.getGuanjun=function(){var t=this.honorType==u.GroupType.benfu?u.GloryId.benfu_juesai:u.GloryId.kuafu_juesai,e=this.winPos[t]||[];return this.getPlayerByPos(e[0])},e.prototype.getOtherPos=function(t){return 17-t},e.prototype.isEnd=function(t){return this.isLastMatch||App.serverTimeSecond>=u.GloryUtil.getGroupEndTime(t)},e.prototype.getWinType=function(t,e){var i=u.GloryModel.getInstance().updateCurGroup();return this.isLastMatch||t<i?(this.winPos[t]||[]).some(function(t){return-1!=e.indexOf(t)})?1:2:0},e.prototype.isWin=function(t,e){var i=(this.winPos[t]||[]).some(function(t){return-1!=e.indexOf(t)});return this.isLastMatch?i:i&&App.serverTimeSecond>=u.GloryUtil.getGroupEndTime(t)},e.prototype.getBetType=function(t,e){if(t!=this.curGroup)return 0;for(var i=0,n=0,o=e;n<o.length;n++){var a=o[n],r=this.getOtherPos(a);if(-1!=this.betInfo.indexOf(a)){i=1;break}if(-1!=this.betInfo.indexOf(r)){i=2;break}}return i},e.prototype.pushGroupWarInfo=function(t){var e=this.getGroupWarInfo(t.session,t.stage,t.pos);e||((e=new u.MatchGroupVo).isLastMatch=this.isLastMatch,this._matchGroupList.push(e)),e.setGroupInfo(t)},e.prototype.getGroupWarInfo=function(e,i,n){return this._matchGroupList.find(function(t){return t.svo.session==e&&t.svo.pos==n&&t.svo.stage==i})},e);function e(t){this._matchList=[],this.winPos={},this.betInfo=[],this._matchGroupList=[],this._isFinish=!1,this.honorType=t,this._matchList.length=0}u.MatchGroupListVo=t}(game=game||{}),function(i){var t=(s.getFormatTime=function(t,e,i,n){void 0===n&&(n=0);var o=new Date;o.setTime(App.serverTime),o.setHours(0,0,0,0);var a=o.getTime()/1e3,r=o.getDay();return(t<=(r=r==WeekNum.Sun?7:r)?a-(r-t)*TimeConst.ONE_DAY_SEC:a+(t-r)*TimeConst.ONE_DAY_SEC)+e*TimeConst.ONE_HOURS_SEC+60*i+n},s.getCurGroup=function(){var t=0,e=TableData.getInstance(),i=e.getTableByName(TableData.tb_honour).data;for(var n in i){var o=i[n],a=s.getFormatTime(Number(o.star_time[0]),Number(o.star_time[1]),Number(o.star_time[2])),r=s.getFormatTime(Number(o.end_time[0]),Number(o.end_time[1]),Number(o.end_time[2]));if(App.serverTimeSecond>=a&&App.serverTimeSecond<r){t=o.ID;break}}return 0==t&&(t=e.getTableByName(TableData.tb_honour).maxId),t},s.getHonorTypeByGroup=function(t){return-1!=[i.GloryId.benfu_haixuan,i.GloryId.benfu_16t8,i.GloryId.benfu_8t4,i.GloryId.benfu_4t2,i.GloryId.benfu_juesai,i.GloryId.kuafu_haixuan].indexOf(t)?i.GroupType.benfu:i.GroupType.kuafu},s.getGroupStartTime=function(t){var e=tb.TB_honour.getItemById(t);return s.getFormatTime(Number(e.star_time[0]),Number(e.star_time[1]),Number(e.star_time[2]))},s.getGroupEndTime=function(t){var e=tb.TB_honour.getItemById(t);return s.getFormatTime(Number(e.end_time[0]),Number(e.end_time[1]),Number(e.end_time[2]))},s.isInBetTime=function(t){var e=s.getGroupStartTime(t),i=s.getGroupEndTime(t),n=tb.TB_honour_set.getSet();return App.serverTimeSecond>=e&&App.serverTimeSecond<i-n.bet_endtime},s.isHaixuan=function(t){var e=tb.TB_honour.getItemById(t);return e.ID==i.GloryId.benfu_haixuan||e.ID==i.GloryId.kuafu_haixuan},s.isEndTime=function(t){var e=s.getGroupEndTime(t);return App.serverTimeSecond>=e},s.isInKuafu=function(t){return-1!=[i.GloryId.kuafu_16t8,i.GloryId.kuafu_8t4,i.GloryId.kuafu_4t2,i.GloryId.kuafu_juesai].indexOf(t)},s);function s(){}i.GloryUtil=t}(game=game||{}),function(u){var t=(e.requestSeason=function(){return new Promise(function(i,t){App.IsSysOpen(ModuleConst.GLORY_FIGHT)?PLC.request(Protocol.center_honour_getHonourWarSession,null,function(t){if(t){var e=u.GloryModel.getInstance();e.updateSeason(t.honourInfo),e.setLastRankList(t.rankList),i()}}):i()})},e.requestMatchInfo=function(r,s){return void 0===s&&(s=!1),new Promise(function(e,t){var i=u.GloryModel.getInstance();if(i.isInGameTime()){r=r==u.GloryId.kuafu_haixuan?u.GloryId.benfu_juesai:r;var n=u.GloryUtil.getHonorTypeByGroup(r),o=i.getGroupListVo(n);if(s||o.isNeedRequest(r)){var a={};a[Protocol.center_honour_getSessionListInfo.args.type]=0,a[Protocol.center_honour_getSessionListInfo.args.stage]=r,PLC.request(Protocol.center_honour_getSessionListInfo,a,function(t){if(!t)return showToast(n==u.GroupType.benfu?LanMgr.getLan("",10344):LanMgr.getLan("",10345)),void e(!1);i.setMatchInfo(n,r,t),e(!0)})}else e(!0)}else e(!1)})},e.requestLastList=function(o){return new Promise(function(e){var i=u.GloryModel.getInstance();if(i.season<=1)e();else{var n=u.GloryUtil.getHonorTypeByGroup(o);if(i.getLastListVo(n).isNeedRequest(o)){var t={};t[Protocol.center_honour_getSessionListInfo.args.type]=1,t[Protocol.center_honour_getSessionListInfo.args.stage]=o,PLC.request(Protocol.center_honour_getSessionListInfo,t,function(t){t&&i.setLastList(n,o,t),e()})}else e()}})},e.requestWarInfo=function(a,r,s){return new Promise(function(e){var t=u.GloryModel.getInstance(),i=a.isLastMatch?t.season-1:t.season,n=a.getGroupWarInfo(i,r,s);if(!n||!n.isHasResult()&&n.isEndGroup()){var o={};return o[Protocol.center_honour_getHonourWarInfo.args.stage]=r,o[Protocol.center_honour_getHonourWarInfo.args.type]=a.isLastMatch?1:0,o[Protocol.center_honour_getHonourWarInfo.args.pos]=s,void PLC.request(Protocol.center_honour_getHonourWarInfo,o,function(t){t&&(a.pushGroupWarInfo(t.warInfo),e(a.getGroupWarInfo(i,r,s)))})}e(n)})},e.requestUserLineup=function(n){return new Promise(function(i){if(n.isHasLineup())i();else{var t={};t[Protocol.center_honour_getHonourWarPlayerData.args.type]=n.isLastMatch?1:0,t[Protocol.center_honour_getHonourWarPlayerData.args.stage]=n.stage,t[Protocol.center_honour_getHonourWarPlayerData.args.pos]=n.pos,t[Protocol.center_honour_getHonourWarPlayerData.args.playerId]=n.playerId,PLC.request(Protocol.center_honour_getHonourWarPlayerData,t,function(t){if(t){var e=t.playerInfo;n.setDetailInfo(e.guildName,e.lineupInfo),i()}})}})},e.requestLineup=function(e,o){return new Promise(function(i){var n=o?e.lUser:e.rUser;if(n.isHasLineup())i();else{var t={};t[Protocol.center_honour_getHonourWarPlayerInfo.args.stage]=e.svo.stage,t[Protocol.center_honour_getHonourWarPlayerInfo.args.recordId]=e.svo.recordId,t[Protocol.center_honour_getHonourWarPlayerInfo.args.playerId]=n.playerId,PLC.request(Protocol.center_honour_getHonourWarPlayerInfo,t,function(t){if(t){var e=t.playerInfo;n.setDetailInfo(e.guildName,e.lineupInfo),i()}})}})},e.requestMyMatch=function(){var o=this;return new Promise(function(e){var i=u.GloryModel.getInstance(),n=i.updateCurGroup();o._rqGroup==n?e():PLC.request(Protocol.center_honour_getHonourWarMyList,null,function(t){t&&(o._rqGroup=n,i.setMyMatchList(t.myList)),e()})})},e._rqGroup=-1,e);function e(){}u.GloryThread=t}(game=game||{}),function(s){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.startRun=function(){var i=this;s.GuideWeakManager.listenSysOpen(ModuleConst.GLORY_FIGHT,this).then(function(){i.checkJoinNotice();var t=s.GloryModel.getInstance();if(0==t.serverPhase&&t.isInJoinTime()){var e=t.endJoinTime-App.serverTimeSecond;Laya.timer.once(1e3*e,i,i.timeoutRequest)}else i.checkInterval()})},e.prototype.timeoutRequest=function(){var t=this;Laya.timer.clear(this,this.timeoutRequest),s.GloryThread.requestSeason().then(function(){t.checkInterval()})},e.prototype.checkInterval=function(){if(0!=s.GloryModel.getInstance().serverPhase){this._gameTimeAry.length=0;for(var t=s.GloryId.benfu_16t8;t<=s.GloryId.kuafu_juesai;t++){var e=tb.TB_honour.getItemById(t),i=e?e.notice_time:[];if(0!=i.length)for(var n=0,o=i;n<o.length;n++){var a=o[n],r=s.GloryUtil.getFormatTime(a[0],a[1],a[2]);r>App.serverTimeSecond&&this._gameTimeAry.push([r,e.getNotice()])}}this._gameTimeAry.sort(function(t,e){return t[0]-e[0]}),loghgy("阶段公告时间点列表",this._gameTimeAry),this.startGameInterval()}},e.prototype.startGameInterval=function(){if(0!=this._gameTimeAry.length){var t=this._gameTimeAry.shift(),e=t[0]-App.serverTimeSecond;loghgy("延迟"+e+"秒发阶段公告"),Laya.timer.once(1e3*e,this,this.sendGameNotice,[t[1]])}else Laya.timer.clear(this,this.sendGameNotice)},e.prototype.sendGameNotice=function(t){loghgy("发阶段公告：",t),s.ChatModel.getInstance().addCustomChat(t),s.ChatNoticeMgr.getInstance().addCustomNotice(t),this.startGameInterval()},e.prototype.checkJoinNotice=function(){for(var t=this._joinTimeAry.length=0,e=tb.TB_honour.getItemById(s.GloryId.benfu_haixuan).notice_time;t<e.length;t++){var i=e[t],n=s.GloryUtil.getFormatTime(i[0],i[1],i[2]);n>App.serverTimeSecond&&this._joinTimeAry.push(n)}this._joinTimeAry.sort(function(t,e){return t-e}),loghgy("报名公告时间点列表",this._joinTimeAry),this.startJoinInterval()},e.prototype.startJoinInterval=function(){if(0!=this._joinTimeAry.length){var t=this._joinTimeAry.shift()-App.serverTimeSecond;loghgy("延迟"+t+"秒发报名公告"),Laya.timer.once(1e3*t,this,this.sendJoinNotice)}else Laya.timer.clear(this,this.sendJoinNotice)},e.prototype.sendJoinNotice=function(){var t=tb.TB_honour.getItemById(s.GloryId.benfu_haixuan);loghgy("发报名公告：",t.getNotice()),s.ChatModel.getInstance().addCustomChat(t.getNotice()),s.ChatNoticeMgr.getInstance().addCustomNotice(t.getNotice()),this.startJoinInterval()},e);function e(){this._gameTimeAry=[],this._joinTimeAry=[]}s.GloryNoticeMgr=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.glory.GloryAwardUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.tabbar.selectedIndex=-1,this.awardList.array=null},e.prototype.initView=function(){this.awardList.array=null,this.tabbar.selectHandler=new Handler(this,this.selectTab),this.tabbar.selectedIndex=0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12397)}},e.prototype.onClickClose=function(){UIMgr.hideUIByName(UIConst.GloryRewardView)},e.prototype.selectTab=function(t){-1!=t&&(this.lbCost.visible=0==t,this.lbReward.text=0==t?LanMgr.getLan("",12397):LanMgr.getLan("",12398),this.awardList.array=0==t?this.getYazhuList():1==t?this.getHonorReward(o.GroupType.benfu):this.getHonorReward(o.GroupType.kuafu),this.awardList.scrollTo(0))},e.prototype.getHonorReward=function(t){if(!this._benfuList||!this._kuafuList){this._benfuList=[],this._kuafuList=[];for(var e=tb.TB_honour_reward.getHonourRewardList(),i=0;i<e.length;i++){var n=e[i];tb.TB_honour.getItemById(n.type).type==o.GroupType.benfu?this._benfuList.push({title:n.name,rewardList:n.getRewardList(),costList:null}):this._kuafuList.push({title:n.name,rewardList:n.getRewardList(),costList:null})}}return t==o.GroupType.benfu?this._benfuList:this._kuafuList},e.prototype.getYazhuList=function(){if(!this._yazhuList){this._yazhuList=[];var t=TableData.getInstance().getTableByName(TableData.tb_honour).data;for(var e in t){var i=t[e];0<i.getItemList().length&&this._yazhuList.push({title:i.name,rewardList:i.getRewardList(),costList:i.getItemList()})}}return this._yazhuList},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.box_Content.addChild(t.img_bg),t}o.GloryRewardView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.glory.RecordUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnButton:!0,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12399)},this.bgPanel.addChildAt(this.img_bg,3)},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.close=function(){i.prototype.close.call(this),this.recordList.array=null},n.prototype.initView=function(){this.recordList.array=t.GloryModel.getInstance().getMyMatchList()},n);function n(){return i.call(this)||this}t.GloryRecordView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.glory.GloryGroupUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnButton:!0,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12400)}},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.close=function(){i.prototype.close.call(this),this.fightui.dataSource=null},n.prototype.initView=function(){var t=this.dataSource;this.fightui.dataSource=t},n);function n(){return i.call(this)||this}t.GloryGroupView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(d){var n,t=(n=ui.glory.FightListUI,__extends(e,n),e.prototype.show=function(t){this.dataSource=t,this.initView()},e.prototype.close=function(){for(var t=0;t<this._itemList.length;t++)this._itemList[t].dataSource=null},Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t},enumerable:!0,configurable:!0}),e.prototype.initView=function(){for(var t=this.dataSource,e=t.getMatchList(),i=0;i<this._itemList.length;i++)this._itemList[i].dataSource=e[i];var n=t.getGuanjun();this.boxGj.visible=!!n,this.lbDesc.visible=!n,this.lbDesc.text=""+(t.honorType==d.GroupType.benfu?LanMgr.getLan("",12401):LanMgr.getLan("",12402))+LanMgr.getLan("",12403),this.imgWangguan.y=n?235:400,n?(this.gjHead.dataSource=n.headVo,this.gjName.text=n.name,this.gjShenli.text=LanMgr.getLan("",10117,n.force)):this.gjHead.dataSource=null,this.renderLine(),this.renderBtnState()},e.prototype.renderLine=function(){var t=this.dataSource;if(t){var e=t.honorType,i={2:{user1:[1],user2:[2],user3:[3],user4:[4],user5:[5],user6:[6],user7:[7],user8:[8],user9:[9],user10:[10],user11:[11],user12:[12],user13:[13],user14:[14],user15:[15],user16:[16]},3:{user3_1:[1,16],user3_2:[8,9],user3_3:[4,13],user3_4:[5,12],user3_5:[2,15],user3_6:[7,10],user3_7:[3,14],user3_8:[6,11]},4:{user4_1:[1,16,8,9],user4_2:[4,13,5,12],user4_3:[2,15,7,10],user4_4:[3,14,6,11]},5:{user5_1:[1,16,8,9,4,13,5,12],user5_2:[2,15,7,10,3,14,6,11]}};for(var n in i){var o=Number(n);e==d.GroupType.kuafu&&(o+=5);var a=i[n];for(var r in a)this[r].visible=t.isWin(o,a[r])}}},e.prototype.renderBtnState=function(){var t=this.dataSource;if(t){var e=t.honorType,i={2:{btn2_1:[1,16],btn2_2:[8,9],btn2_3:[4,13],btn2_4:[5,12],btn2_5:[2,15],btn2_6:[7,10],btn2_7:[3,14],btn2_8:[6,11]},3:{btn3_1:[1,16,8,9],btn3_2:[4,13,5,12],btn3_3:[2,15,7,10],btn3_4:[3,14,6,11]},4:{btn4_1:[1,16,8,9,4,13,5,12],btn4_2:[2,15,7,10,3,14,6,11]},5:{btn5:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}};for(var n in i){var o=Number(n);e==d.GroupType.kuafu&&(o+=5);var a=i[n],r=t.isEnd(o),s=d.GloryModel.getInstance().updateCurGroup()==o;for(var u in a){var h=this[u],l=this[u.replace("btn","rp")];if(l.visible=!1,r)h.visible=!0,h.skin=SkinUtil.btn_fangdajing,h.stateNum=1;else if(s){var c=d.GloryUtil.isInBetTime(o);h.visible=!0;var p=0!=t.getBetType(o,a[u]);!c||p?h.skin=SkinUtil.btn_vs:(l.visible=!0,h.skin=SkinUtil.btn_bet),h.stateNum=1}else h.visible=!1}}}},e.prototype.onClick=function(t,e,i){var n=this.dataSource;if(n){var o=t.skin;o!=SkinUtil.btn_fangdajing&&o!=SkinUtil.btn_bet&&o!=SkinUtil.btn_vs||(n.honorType==d.GroupType.kuafu&&(e+=5),d.GloryThread.requestWarInfo(n,e,i-1).then(function(t){t&&UIMgr.showUI(UIConst.GloryGroupView,t)}))}},e.prototype.onLineup=function(){var t=this.dataSource,e=t?t.getGuanjun():null;e&&d.GloryThread.requestUserLineup(e).then(function(){dispatchEvt(new d.HudEvent(d.HudEvent.SHOW_PLAYER_LINEUP_VIEW),e)})},e);function e(){var t=n.call(this)||this;t._itemList=[];for(var e=1;e<=16;e++){var i=t["userBox"+e];t._itemList.push(i)}return t.btn2_1.on(Laya.Event.CLICK,t,t.onClick,[t.btn2_1,2,1]),t.btn2_2.on(Laya.Event.CLICK,t,t.onClick,[t.btn2_2,2,8]),t.btn2_3.on(Laya.Event.CLICK,t,t.onClick,[t.btn2_3,2,4]),t.btn2_4.on(Laya.Event.CLICK,t,t.onClick,[t.btn2_4,2,5]),t.btn2_5.on(Laya.Event.CLICK,t,t.onClick,[t.btn2_5,2,2]),t.btn2_6.on(Laya.Event.CLICK,t,t.onClick,[t.btn2_6,2,7]),t.btn2_7.on(Laya.Event.CLICK,t,t.onClick,[t.btn2_7,2,3]),t.btn2_8.on(Laya.Event.CLICK,t,t.onClick,[t.btn2_8,2,6]),t.btn3_1.on(Laya.Event.CLICK,t,t.onClick,[t.btn3_1,3,1]),t.btn3_2.on(Laya.Event.CLICK,t,t.onClick,[t.btn3_2,3,4]),t.btn3_3.on(Laya.Event.CLICK,t,t.onClick,[t.btn3_3,3,2]),t.btn3_4.on(Laya.Event.CLICK,t,t.onClick,[t.btn3_4,3,3]),t.btn4_1.on(Laya.Event.CLICK,t,t.onClick,[t.btn4_1,4,1]),t.btn4_2.on(Laya.Event.CLICK,t,t.onClick,[t.btn4_2,4,2]),t.btn5.on(Laya.Event.CLICK,t,t.onClick,[t.btn5,5,1]),t.gjHead.on(Laya.Event.CLICK,t,t.onLineup),t.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.GLORY_FIGHT,1),t}d.gloryFightListView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.glory.iRender.MatchPlayerIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initViewe()},enumerable:!0,configurable:!0}),n.prototype.initViewe=function(){var t=this.dataSource;t?(this.lbGroup.text=t.getGroupName(),this.headBox1.dataSource=t.lUser.headVo,this.lbName1.text=t.lUser.name,this.lbForce1.text=t.lUser.force+"",this.headBox2.dataSource=t.rUser.headVo,this.lbName2.text=t.rUser.name,this.lbForce2.text=t.rUser.force+"",this.updateView(),this.updateBet(),this.btnPlayback.on(Laya.Event.CLICK,this,this.onPlay),this.btnYazhu1.on(Laya.Event.CLICK,this,this.onYazhu1),this.btnYazhu2.on(Laya.Event.CLICK,this,this.onYazhu2),this.headBox1.on(Laya.Event.CLICK,this,this.onLeft),this.headBox2.on(Laya.Event.CLICK,this,this.onRight)):(this.btnPlayback.off(Laya.Event.CLICK,this,this.onPlay),this.btnYazhu1.off(Laya.Event.CLICK,this,this.onYazhu1),this.btnYazhu2.off(Laya.Event.CLICK,this,this.onYazhu2),this.headBox1.off(Laya.Event.CLICK,this,this.onLeft),this.headBox2.off(Laya.Event.CLICK,this,this.onRight))},n.prototype.updateView=function(){var t=this.dataSource;if(t){var e=t.isEndGroup();this.imgResult1.visible=this.imgResult2.visible=this.lbResult1.visible=this.lbResult2.visible=e,this.imgResult1.disabled=2==t.svo.winner,this.imgResult2.disabled=1==t.svo.winner,this.btnPlayback.visible=e,this.lbResult1.text=1==t.svo.winner?LanMgr.getLan("",12404):LanMgr.getLan("",12405),this.lbResult2.text=2==t.svo.winner?LanMgr.getLan("",12404):LanMgr.getLan("",12405)}},n.prototype.updateBet=function(){var t=this.dataSource;t&&(t.isEndGroup()?(this.btnYazhu1.visible=this.btnYazhu2.visible=!1,this.lbYazhu1.visible=this.lbYazhu2.visible=!1,1==t.svo.betId?(this.lbYazhu1.visible=!0,this.lbYazhu1.text=1==t.svo.winner?LanMgr.getLan("",12406):LanMgr.getLan("",12407)):2==t.svo.betId&&(this.lbYazhu2.visible=!0,this.lbYazhu2.text=2==t.svo.winner?LanMgr.getLan("",12406):LanMgr.getLan("",12407))):(this.btnYazhu1.disabled=this.btnYazhu2.disabled=!1,this.btnYazhu1.visible=this.btnYazhu2.visible=!0,this.lbYazhu1.visible=this.lbYazhu2.visible=!1,1==t.svo.betId?(this.btnYazhu1.label=LanMgr.getLan("",12408),this.btnYazhu1.disabled=!0,this.btnYazhu2.visible=!1):2==t.svo.betId?(this.btnYazhu2.label=LanMgr.getLan("",12408),this.btnYazhu2.disabled=!0,this.btnYazhu1.visible=!1):t.isInBetTime()?this.btnYazhu1.label=this.btnYazhu2.label=LanMgr.getLan("",12409):this.btnYazhu1.visible=this.btnYazhu2.visible=!1))},n.prototype.onPlay=function(){dispatchEvt(new e.GloryEvent(e.GloryEvent.SHOW_PLAYBACK),this.dataSource)},n.prototype.onYazhu1=function(){dispatchEvt(new e.GloryEvent(e.GloryEvent.BET_PLAYER),[!0,this])},n.prototype.onYazhu2=function(){dispatchEvt(new e.GloryEvent(e.GloryEvent.BET_PLAYER),[!1,this])},n.prototype.onLeft=function(){var t=this.dataSource;t&&t.lUser&&e.GloryThread.requestLineup(t,!0).then(function(){dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_PLAYER_LINEUP_VIEW),t.lUser)})},n.prototype.onRight=function(){var t=this.dataSource;t&&t.rUser&&e.GloryThread.requestLineup(t,!1).then(function(){dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_PLAYER_LINEUP_VIEW),t.rUser)})},n);function n(){return t.call(this)||this}e.gloryMatchPlayerIR=i}(game=game||{}),function(i){var t=(Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),e.prototype.refreshData=function(){var t=this.dataSource;if(t){this.lbName.text=t.name,this.lbForce.text=t.force+"",this.lbForce.event(Laya.Event.RESIZE),this.uiScene.onShow();var e=i.GodUtils.getShowGodModel(t.showGodId,t.showSkinId);Laya.timer.once(200,this,this.delayShow,[e]),this._rankui.visible=!0,this.roleBox.on(Laya.Event.CLICK,this,this.onShowInfo)}else this.uiScene.onExit(),Laya.timer.clearAll(this),this._rankui.visible=!1,this.roleBox.off(Laya.Event.CLICK,this,this.onShowInfo)},e.prototype.onShowInfo=function(){var t=this.dataSource;t&&t.playerId&&UIMgr.showUI(UIConst.PlayerLineupInfoView,t)},e.prototype.delayShow=function(t){if(!(t<=0)){var e=this.roleBox.localToGlobal(new Laya.Point(0,0));this.uiScene.addModelChar(t,e.x+this.roleBox.width/2-Launch.offsetX,e.y-Launch.offsetY+200,180,1.8)}},e);function e(t){this._rankui=t,this._rankui.visible=!1,this.lbName=t.getChildByName("lbName");var e=t.getChildByName("hbox");this.lbForce=e.getChildByName("lbForce"),this.roleBox=t.getChildByName("roleBox"),this.uiScene=new Base2dSceneLayer,this.roleBox.addChildAt(this.uiScene,0),this.uiScene.setModelBox(t,this.roleBox,this.lbForce)}i.gloryLastRankPropIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.glory.iRender.FightPlayerIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t?(this.headBox.dataSource=t.headVo,this.lbForce.text=LanMgr.getLan("",10117,t.force),this.lbName.text=t.name,this.headBox.on(Laya.Event.CLICK,this,this.onShowLineup)):(this.headBox.dataSource=null,this.headBox.off(Laya.Event.CLICK,this,this.onShowLineup))},n.prototype.onShowLineup=function(){var t=this.dataSource;t&&e.GloryThread.requestUserLineup(t).then(function(){dispatchEvt(new e.HudEvent(e.HudEvent.SHOW_PLAYER_LINEUP_VIEW),t)})},n);function n(){return t.call(this)||this}e.gloryFightPlayerIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.glory.iRender.AwardIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.lbName.text=t.title;var e=t.costList?t.costList:[],i=t.rewardList?t.rewardList:[];0<e.length?(this.itemList.width=90*e.length+(e.length-1)*this.itemList.spaceX,this.rewardList.x=this.itemList.x+this.itemList.width+50):(this.itemList.width=0,this.rewardList.x=this.itemList.x),this.rewardList.spaceX=10,this.rewardList.width=90*i.length+(i.length-1)*this.rewardList.spaceX,this.itemList.array=e,this.rewardList.array=i}else this.itemList.array=null,this.rewardList.array=null},n);function n(){return e.call(this)||this}t.gloryAwardIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var i,t=(i=ui.glory.GloryWaitUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._model=a.GloryModel.getInstance(),this._itemList=[];for(var t=1;t<=3;t++){var e=new a.gloryLastRankPropIR(this["boxRank"+t]);this._itemList.push(e)}this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.GLORY_FIGHT,0)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.close=function(){i.prototype.close.call(this),Laya.timer.clear(this,this.updateTime);for(var t=0,e=this._itemList;t<e.length;t++)e[t].dataSource=null},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_shop,callback:this.onShop.bind(this)},{btnSkin:SkinUtil.btn_jiangli,callback:this.onAward.bind(this)},{btnSkin:SkinUtil.btn_record,callback:this.onRecord.bind(this)},{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.honour];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,funList:t,resAry:e,closeCallback:this.onFanHui.bind(this)});var i=this._model;i.isInGameTime()?this.lbTime.text="":(this.updateTime(),Laya.timer.clear(this,this.updateTime),Laya.timer.loop(1e3,this,this.updateTime)),this.updateBtn(),this.btnJoin.on(Laya.Event.CLICK,this,this.onJoin),this.btnLast.on(Laya.Event.CLICK,this,this.onLast);for(var n=i.getLastRankList(),o=0;o<this._itemList.length;o++)this._itemList[o].dataSource=n[o];this.btnLast.visible=1<i.season,this.btnJoin.centerX=this.btnLast.visible?100:0,i.isHasShow||(i.isHasShow=!0,dispatchEvt(new a.GloryEvent(a.GloryEvent.SHOW_REDPOINT)))},e.prototype.updateTime=function(){var t=this._model,e=t.endJoinTime,i=t.startGameTime,n=App.serverTimeSecond;n<e?this.lbTime.text=LanMgr.getLan("",12391)+GameUtil.getTimeStr(e-n):n<i?this.lbTime.text=LanMgr.getLan("",12392)+GameUtil.getTimeStr(i-n):(this.lbTime.text="",Laya.timer.clear(this,this.updateTime),dispatchEvt(new a.GloryEvent(a.GloryEvent.SHOW_MAIN_VIEW)))},e.prototype.updateBtn=function(){var t=this._model,e=t.isJoin(),i=!t.isInJoinTime();this.btnJoin.disabled=e||i,this.btnJoin.label=e?LanMgr.getLan("",12281):i?LanMgr.getLan("",12390):LanMgr.getLan("",12284)},e.prototype.onJoin=function(){var e=this,t=this._model;t.isInJoinTime()?t.isJoin()?showToast(LanMgr.getLan("",10343)):PLC.request(Protocol.game_honour_reg,null,function(t){t&&(App.hero.copyInfo.honourWarRegTime=t.regTime,e.updateBtn(),dispatchEvt(new a.GloryEvent(a.GloryEvent.JOIN_SUCCESS)))}):showToast(LanMgr.getLan("",10342))},e.prototype.onLast=function(){dispatchEvt(new a.GloryEvent(a.GloryEvent.SHOW_LAST_REVIEW))},e.prototype.onFanHui=function(){dispatchEvt(new a.HudEvent(a.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_KUAFU))},e.prototype.onAward=function(){dispatchEvt(new a.GloryEvent(a.GloryEvent.SHOW_AWARD_VIEW))},e.prototype.onRule=function(){dispatchEvt(new a.GloryEvent(a.GloryEvent.SHOW_RULE_VIEW))},e.prototype.onShop=function(){dispatchEvt(new a.GloryEvent(a.GloryEvent.SHOW_SHOP_VIEW))},e.prototype.onRecord=function(){dispatchEvt(new a.GloryEvent(a.GloryEvent.SHOW_RECORD_VIEW))},e);function e(){var t=i.call(this)||this;return t.group=UIConst.hud_group,t}a.GloryWaitView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.glory.LastReviewUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._tabBar=new common.CustomTabBar,this._tabBar.buttons=[this.btnBenfu,this.btnKuafu],this._tabBar.selectHandler=new Handler(this,this.selectTab),this._tabBar.selectedIndex=-1,this.btnBenjie.on(Laya.Event.CLICK,this,this.onBenjie)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.close=function(){i.prototype.close.call(this),this._tabBar.selectedIndex=-1,this.listView.dataSource=null},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_shop,callback:this.onShop.bind(this)},{btnSkin:SkinUtil.btn_jiangli,callback:this.onAward.bind(this)},{btnSkin:SkinUtil.btn_record,callback:this.onRecord.bind(this)},{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.honour];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onFanHui.bind(this)});var i=this.dataSource,n=1;Array.isArray(i)&&0<i.length&&(n=i[0]),this._tabBar.selectedIndex=n},e.prototype.selectTab=function(t){var e=this;if(-1!=t){var i=o.GloryModel.getInstance();if(0==t)o.GloryThread.requestLastList(o.GloryId.benfu_juesai).then(function(){var t=i.getLastListVo(o.GroupType.benfu);if(t.getMatchList().length<=0)return showToast(LanMgr.getLan("",10333)),void(e._tabBar.selectedIndex=1);e.listView.show(t)});else{var n=i.getLastListVo(o.GroupType.kuafu);this.listView.show(n)}}},e.prototype.onBenjie=function(){dispatchEvt(new o.GloryEvent(o.GloryEvent.SHOW_MAIN_VIEW))},e.prototype.onFanHui=function(){dispatchEvt(new o.GloryEvent(o.GloryEvent.SHOW_MAIN_VIEW))},e.prototype.onAward=function(){dispatchEvt(new o.GloryEvent(o.GloryEvent.SHOW_AWARD_VIEW))},e.prototype.onRule=function(){dispatchEvt(new o.GloryEvent(o.GloryEvent.SHOW_RULE_VIEW))},e.prototype.onShop=function(){dispatchEvt(new o.GloryEvent(o.GloryEvent.SHOW_SHOP_VIEW))},e.prototype.onRecord=function(){dispatchEvt(new o.GloryEvent(o.GloryEvent.SHOW_RECORD_VIEW))},e);function e(){var t=i.call(this)||this;return t.group=UIConst.hud_group,t}o.GloryLastReview=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var h,t=(h=ui.glory.GloryFightUI,__extends(e,h),e.prototype.createChildren=function(){h.prototype.createChildren.call(this),this._model=u.GloryModel.getInstance(),this._tabBar=new common.CustomTabBar,this._tabBar.buttons=[this.btnBenfu,this.btnKuafu],this._tabBar.selectHandler=new Handler(this,this.selectTab),this._tabBar.selectedIndex=-1,this.btnLast.on(Laya.Event.CLICK,this,this.onShangjie)},e.prototype.close=function(){h.prototype.close.call(this),this._tabBar.selectedIndex=-1,this.listView.dataSource=null,Laya.timer.clearAll(this)},e.prototype.onClosed=function(){h.prototype.onClosed.call(this),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.show=function(t,e){h.prototype.show.call(this,t,e);var i=[{btnSkin:SkinUtil.btn_shop,callback:this.onShop.bind(this)},{btnSkin:SkinUtil.btn_jiangli,callback:this.onAward.bind(this)},{btnSkin:SkinUtil.btn_record,callback:this.onRecord.bind(this)},{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)}],n=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.honour];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:n,funList:i,closeCallback:this.onFanHui.bind(this)});var o=this._model;this.lbTime.visible=this.lbNotice.visible=!1;var a=o.updateCurGroup(),r=u.GloryUtil.isInKuafu(a)?1:0,s=this.dataSource;Array.isArray(s)&&0<s.length&&(r=s[0]),this._tabBar.selectedIndex=r,this.btnLast.visible=1<o.season,o.isHasShow||(o.isHasShow=!0,dispatchEvt(new u.GloryEvent(u.GloryEvent.SHOW_REDPOINT)))},e.prototype.selectTab=function(t){var e=this;if(-1!=t){var i,n=this._model,o=n.updateCurGroup(),a=u.GloryUtil.isInKuafu(o);if(0==t)o=a||o==u.GloryId.kuafu_haixuan?u.GloryId.benfu_juesai:o,i=n.getGroupListVoByGroup(o);else{if(!a)return showToast(LanMgr.getLan("",10341)),void(this._tabBar.selectedIndex=0);i=n.getGroupListVoByGroup(o)}i.isNeedRequest(o)?u.GloryThread.requestMatchInfo(o).then(function(t){t?e.updateView(i):e._tabBar.selectedIndex=0==e._tabBar.selectedIndex?1:0}):this.updateView(i)}},e.prototype.updateView=function(t){this._listVo=t,this.listView.show(t),this.updateLoop()},e.prototype.updateLoop=function(){if(this._listVo){var t=this._tabBar.selectedIndex,e=this._model;this.lbTime.visible=this.lbNotice.visible=!1,Laya.timer.clearAll(this);var i=e.updateCurGroup(),n=u.GloryUtil.isInKuafu(i);0!=t||n?1==t&&(i==u.GloryId.kuafu_juesai&&App.serverTimeSecond>=u.GloryUtil.getGroupEndTime(i)?(this._endTime=u.GloryUtil.getFormatTime(7,23,59,59)+1,this.lbTime.visible=this.lbNotice.visible=!0,this.lbNotice.text=LanMgr.getLan("",12394),Laya.timer.loop(1e3,this,this.updateShowTime),this.updateShowTime()):(this.lbTime.visible=this.lbNotice.visible=!0,this.lbNotice.text=e.getBetNotice(),this._endTime=u.GloryUtil.getGroupEndTime(i),this._endBetTime=this._endTime-tb.TB_honour_set.getSet().bet_endtime,this._endBetTime=App.serverTimeSecond>=this._endBetTime?0:this._endBetTime,Laya.timer.loop(1e3,this,this.updateEndTime),this.updateEndTime())):(this._endTime=u.GloryUtil.getGroupEndTime(i),this._endBetTime=this._endTime-tb.TB_honour_set.getSet().bet_endtime,this._endBetTime=App.serverTimeSecond>=this._endBetTime?0:this._endBetTime,i==u.GloryId.kuafu_haixuan?(this.lbTime.visible=this.lbNotice.visible=!0,this.lbNotice.text=LanMgr.getLan("",12393),Laya.timer.loop(1e3,this,this.updateShowTime),this.updateShowTime()):(this.lbTime.visible=this.lbNotice.visible=!0,this.lbNotice.text=e.getBetNotice(),Laya.timer.loop(1e3,this,this.updateEndTime),this.updateEndTime()))}},e.prototype.updateEndTime=function(){var e=this;if(this._listVo){var t=this._listVo.curGroup,i=this._endTime-App.serverTimeSecond;if(0<i)this.lbTime.text=""+LanMgr.getLan("",12395)+GameUtil.toCountdown(i,"hh:mm:ss"),0<this._endBetTime&&App.serverTimeSecond>=this._endBetTime&&(this._endBetTime=0,this.listView.renderBtnState());else{Laya.timer.clearAll(this),this.lbTime.text="";var n=t==u.GloryId.benfu_juesai||t==u.GloryId.kuafu_juesai?t:t+1;u.GloryThread.requestMatchInfo(n,!0).then(function(t){t&&e.updateView(e._model.getGroupListVoByGroup(n))})}}},e.prototype.updateShowTime=function(){var e=this;if(this._listVo){var t=this._model,i=t.curPhase,n=this._endTime-App.serverTimeSecond;0<n?this.lbTime.text=(i==u.GloryId.kuafu_haixuan?LanMgr.getLan("",12396):LanMgr.getLan("",12391))+GameUtil.toCountdown(n,"hh:mm:ss"):(Laya.timer.clearAll(this),this.lbTime.text="",i==u.GloryId.kuafu_haixuan?u.GloryThread.requestMatchInfo(u.GloryId.kuafu_16t8,!0).then(function(t){t&&(e._tabBar.selectedIndex=1)}):(t.weekRest(),dispatchEvt(new u.GloryEvent(u.GloryEvent.SHOW_MAIN_VIEW))))}},e.prototype.updateList=function(){this._listVo&&this.listView.show(this._listVo)},e.prototype.onShangjie=function(){dispatchEvt(new u.GloryEvent(u.GloryEvent.SHOW_LAST_REVIEW))},e.prototype.onFanHui=function(){dispatchEvt(new u.HudEvent(u.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_KUAFU))},e.prototype.onAward=function(){dispatchEvt(new u.GloryEvent(u.GloryEvent.SHOW_AWARD_VIEW))},e.prototype.onRule=function(){dispatchEvt(new u.GloryEvent(u.GloryEvent.SHOW_RULE_VIEW))},e.prototype.onShop=function(){dispatchEvt(new u.GloryEvent(u.GloryEvent.SHOW_SHOP_VIEW))},e.prototype.onRecord=function(){dispatchEvt(new u.GloryEvent(u.GloryEvent.SHOW_RECORD_VIEW))},e);function e(){var t=h.call(this)||this;return t.group=UIConst.hud_group,t}u.GloryFightView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"GloryProcessor"},i.prototype.listenModuleEvents=function(){return[new h.GloryEvent(h.GloryEvent.SHOW_MAIN_VIEW),new h.GloryEvent(h.GloryEvent.SHOW_LAST_REVIEW),new h.GloryEvent(h.GloryEvent.SHOW_AWARD_VIEW),new h.GloryEvent(h.GloryEvent.SHOW_RULE_VIEW),new h.GloryEvent(h.GloryEvent.SHOW_SHOP_VIEW),new h.GloryEvent(h.GloryEvent.SHOW_RECORD_VIEW),new h.GloryEvent(h.GloryEvent.SHOW_RECORD_BACK_VIEW),new h.GloryEvent(h.GloryEvent.SHOW_PLAYBACK),new h.GloryEvent(h.GloryEvent.BET_PLAYER)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof h.GloryEvent)switch(t.type){case h.GloryEvent.SHOW_MAIN_VIEW:this.showMainView(t.data);break;case h.GloryEvent.SHOW_LAST_REVIEW:this.showLastReview(t.data);break;case h.GloryEvent.SHOW_AWARD_VIEW:this.showAward();break;case h.GloryEvent.SHOW_RULE_VIEW:this.showRule();break;case h.GloryEvent.SHOW_SHOP_VIEW:this.showShop();break;case h.GloryEvent.SHOW_RECORD_VIEW:this.showRecord();break;case h.GloryEvent.SHOW_RECORD_BACK_VIEW:this.showRecordBack(t.data);break;case h.GloryEvent.SHOW_PLAYBACK:this.showPalyback(t.data);break;case h.GloryEvent.BET_PLAYER:this.betPlayer(t.data)}},i.prototype.showMainView=function(e){var i=this._model;h.GloryThread.requestSeason().then(function(){if(i.isInGameTime()&&0<i.serverPhase){var t=i.updateCurGroup();h.GloryThread.requestMatchInfo(t).then(function(t){t&&UIMgr.showUI(UIConst.GloryFightView,e)})}else UIMgr.showUI(UIConst.GloryWaitView)})},i.prototype.showLastReview=function(t){var e=this;h.GloryThread.requestLastList(h.GloryId.kuafu_juesai).then(function(){e._model.getLastListVo(h.GroupType.kuafu).getMatchList().length<=0?showToast(LanMgr.getLan("",10333)):UIMgr.showUI(UIConst.GloryLastReview,t)})},i.prototype.showAward=function(){UIMgr.showUI(UIConst.GloryRewardView)},i.prototype.showRule=function(){var t=Math.floor(tb.TB_honour_set.getSet().bet_endtime/60);UIUtil.showCommonTipView(LanMgr.getLanArr(20014,[],[t]))},i.prototype.showShop=function(){dispatchEvt(new h.ShopEvent(h.ShopEvent.SHOW_SHOP_VIEW),ShopType.rongyao)},i.prototype.showRecord=function(){var t=this;h.GloryThread.requestMyMatch().then(function(){0!=t._model.getMyMatchList().length?UIMgr.showUI(UIConst.GloryRecordView):showToast(LanMgr.getLan("",10334))})},i.prototype.showRecordBack=function(t){0==t?this.showMainView(null):this.showLastReview(null),this.showRecord()},i.prototype.showPalyback=function(i){var n=this;if(i.isBye())showToast(LanMgr.getLan("",10335));else{var o=this._model;if(o.reportDataDic[i.svo.recordId])this.doPlayback(i,o.reportDataDic[i.svo.recordId]);else{var t={};t[Protocol.center_honour_getHonourWarPlayback.args.recordId]=i.svo.recordId,t[Protocol.center_honour_getHonourWarPlayback.args.stage]=i.svo.stage,PLC.request(Protocol.center_honour_getHonourWarPlayback,t,function(t){if(t){var e=t.battleInfo.reportData;e&&(o.reportDataDic[i.svo.recordId]=e,n.doPlayback(i,e))}})}}},i.prototype.doPlayback=function(t,e){logzhanbao(e);var i=new h.FightVo;i.copyType=CopyType.glory,i.gloryMatchVo=t;var n=new h.ServerPage;n.initPage(e),n.result=1==t.svo.winner?playState.VICTORY:playState.FAILURE,i.fightPageControl=n;var o=h.GloryUtil.isInKuafu(t.svo.stage)?1:0,a=t.svo.stage,r=t.isMyMatch?h.GloryEvent.SHOW_RECORD_BACK_VIEW:UIMgr.hasStage(UIConst.GloryLastReview)?h.GloryEvent.SHOW_LAST_REVIEW:h.GloryEvent.SHOW_MAIN_VIEW,s=t.isMyMatch?UIMgr.hasStage(UIConst.GloryLastReview)?1:0:[o,a],u={vo:i,event:new h.GloryEvent(r),eventdata:s};dispatchEvt(new h.FightsEvent(h.FightsEvent.ENTER_FIGHT_EVENT),u)},i.prototype.betPlayer=function(t){var e=this,i=t[1].dataSource;if(i.isBye())showToast(LanMgr.getLan("",10336));else if(i.isInBetTime())if(i.isHasBet())showToast(LanMgr.getLan("",10339));else if(i.isHasResult())showToast(LanMgr.getLan("",10340));else{for(var n=!1,o=0,a=i.tbHonor.bet_item;o<a.length;o++){var r=a[o];if(UIUtil.checkNotEnough(r[0],r[1]))return void(n=!0)}if(!n){for(var s=LanMgr.getLan("",10502),u=0,h=i.tbHonor.bet_item;u<h.length;u++){var l=h[u];s+=l[1]+" <img style='padding:10px 3px 3px 3px;' src='"+SkinUtil.getCostSkin(l[0])+"' ></img>  "}s+=LanMgr.getLan("",10503),common.AlertBox.showAlert({text:s,confirmCb:function(){e.doBet(t)},parm:null,yes:LanMgr.getLan("",10504)})}}else showToast(this._model.getBetNotice())},i.prototype.doBet=function(t){var n=this,e=t[0],o=t[1],a=o.dataSource,i={},r=e?a.lUser.playerId:a.rUser.playerId;i[Protocol.game_honour_honourWarBet.args.playerId]=r,i[Protocol.game_honour_honourWarBet.args.recordId]=a.svo.recordId,i[Protocol.game_honour_honourWarBet.args.stage]=a.svo.stage,PLC.request(Protocol.game_honour_honourWarBet,i,function(t){if(t){a.svo.betId=t.betId,o.updateBet();var e=n._model.getGroupListVoByGroup(a.svo.stage),i=e&&e.getPlayerById(r);i&&e.betInfo.push(i.rankPos),UIMgr.hasStage(UIConst.GloryFightView)&&UIMgr.getUIByName(UIConst.GloryFightView).listView.renderBtnState(),dispatchEvt(new h.GloryEvent(h.GloryEvent.BET_SUCCESS))}})},i);function i(){var t=e.call(this)||this;return t._model=h.GloryModel.getInstance(),t}h.GloryProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"GloryModule"},n.prototype.listProcessors=function(){return[new t.GloryProcessor]},n.prototype.onRegister=function(){t.GloryModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.GloryModule=i;var o,a,r,s=(o=tl3d.BaseEvent,__extends(u,o),u.SHOW_MAIN_VIEW="SHOW_MAIN_VIEW",u.SHOW_LAST_REVIEW="SHOW_LAST_REVIEW",u.SHOW_AWARD_VIEW="SHOW_AWARD_VIEW",u.SHOW_RULE_VIEW="SHOW_RULE_VIEW",u.SHOW_RECORD_VIEW="SHOW_RECORD_VIEW",u.SHOW_RECORD_BACK_VIEW="SHOW_RECORD_BACK_VIEW",u.SHOW_SHOP_VIEW="SHOW_SHOP_VIEW",u.SHOW_PLAYBACK="SHOW_PLAYBACK",u.BET_PLAYER="BET_PLAYER",u.BET_SUCCESS="BET_SUCCESS",u.JOIN_SUCCESS="JOIN_SUCCESS",u.SHOW_REDPOINT="SHOW_REDPOINT",u);function u(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.GloryEvent=s,(a=t.GroupType||(t.GroupType={}))[a.benfu=1]="benfu",a[a.kuafu=2]="kuafu",(r=t.GloryId||(t.GloryId={}))[r.benfu_haixuan=1]="benfu_haixuan",r[r.benfu_16t8=2]="benfu_16t8",r[r.benfu_8t4=3]="benfu_8t4",r[r.benfu_4t2=4]="benfu_4t2",r[r.benfu_juesai=5]="benfu_juesai",r[r.kuafu_haixuan=6]="kuafu_haixuan",r[r.kuafu_16t8=7]="kuafu_16t8",r[r.kuafu_8t4=8]="kuafu_8t4",r[r.kuafu_4t2=9]="kuafu_4t2",r[r.kuafu_juesai=10]="kuafu_juesai"}(game=game||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(a){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.testChange=function(){var t=tb.TB_honour_set.getSet();t.match_interval=20,t.bet_startime=30,t.bet_endtime=30;var e=new Date;e.setTime(App.serverTime);var i=e.getDay();i=i==WeekNum.Sun?7:i;var n,o=e.getHours(),a=e.getMinutes(),r=TableData.getInstance().getTableByName(TableData.tb_honour).data;for(var s in r){var u=r[s];1==u.ID||u.ID,a+=2,u.star_time=n?__spreadArrays(n.end_time):[1,0,0],u.end_time=[i,o,a],u.notice_time=n?[[i,o,u.star_time[2]+.5],[i,o,u.star_time[2]+1]]:[[i,o,a-1],[i,o,a-.5]],n=u}loghgy("测试：更改荣耀之战表数据",r),this.serverPhase=1,this.initModel(),this.endJoinTime=this.startGameTime-60},e.prototype.initModel=function(){this.requestThread=new a.GloryThread,this.curPhase=0,this._curMatchDic[a.GroupType.benfu]=new a.MatchGroupListVo(a.GroupType.benfu),this._curMatchDic[a.GroupType.kuafu]=new a.MatchGroupListVo(a.GroupType.kuafu),this._lastMatchDic[a.GroupType.benfu]=new a.MatchGroupListVo(a.GroupType.benfu),this._lastMatchDic[a.GroupType.kuafu]=new a.MatchGroupListVo(a.GroupType.kuafu),this.updateTime(),this.updateCurGroup(),a.GloryNoticeMgr.getInstance().startRun()},e.prototype.updateTime=function(){var t=tb.TB_honour_set.getSet().apply_endtime;this.endJoinTime=a.GloryUtil.getFormatTime(Number(t[0]),Number(t[1]),Number(t[2])),t=tb.TB_honour.getItemById(1).end_time,this.startGameTime=a.GloryUtil.getFormatTime(Number(t[0]),Number(t[1]),Number(t[2]))},e.prototype.updateSeason=function(t){t.hasOwnProperty("session")&&(this.season=t.session),t.hasOwnProperty("stage")&&(this.serverPhase=t.stage),this.updateCurGroup()},e.prototype.updateServerPhase=function(){this.serverPhase=App.hero.kuafuHonourStage||App.hero.honourStage},e.prototype.updateCurGroup=function(){return(this.curPhase<=0||App.serverTimeSecond>=a.GloryUtil.getGroupEndTime(this.curPhase))&&(this.curPhase=a.GloryUtil.getCurGroup()),this.curPhase},e.prototype.weekRest=function(){for(var t in this.updateTime(),this.updateCurGroup(),this._curMatchDic){var e=this.getGroupListVo(Number(t));e&&e.initData()}this.serverPhase=0,a.GloryNoticeMgr.getInstance().startRun()},e.prototype.setMatchInfo=function(t,e,i){if(i){var n=this._curMatchDic[t];n.setCurGroup(e),n.isLastMatch=!1,n.updateMatchList(i.playerPos,i.baseInfo,i.winPos,i.betInfo)}},e.prototype.getGroupListVo=function(t){return this._curMatchDic[t]},e.prototype.getGroupListVoByGroup=function(t){var e=a.GloryUtil.getHonorTypeByGroup(t);return this._curMatchDic[e]},e.prototype.isJoin=function(){return App.serverTimeSecond<App.hero.copyInfo.honourWarRegTime},e.prototype.isInJoinTime=function(){return App.serverTimeSecond<this.endJoinTime},e.prototype.isInGameTime=function(){return App.serverTimeSecond>=this.startGameTime},e.prototype.setMyMatchList=function(t){this._myMatchList=[];for(var e=0,i=t;e<i.length;e++){var n=i[e];if(n.leftId&&n.rightId){var o=new a.MatchGroupVo;o.setGroupInfo(n),o.isMyMatch=!0,this._myMatchList.push(o)}}this._myMatchList.sort(function(t,e){return t.sortNum-e.sortNum})},e.prototype.getMyMatchList=function(){return this._myMatchList?this._myMatchList:[]},e.prototype.setLastList=function(t,e,i){if(i){var n=this._lastMatchDic[t];n.setCurGroup(e),n.isLastMatch=!0,n.updateMatchList(i.playerPos,i.baseInfo,i.winPos,i.betInfo)}},e.prototype.getLastListVo=function(t){return this._lastMatchDic[t]},e.prototype.getLastRankList=function(){return this._lastRankList?this._lastRankList:[]},e.prototype.setLastRankList=function(i){if(i){function t(t){var r=i[t],e={rank:t+1,name:r[0],force:r[1],showGodId:r[2],showSkinId:r[3],playerId:r[4],head:r[5],headFrame:r[6],sex:r[7],level:r[8],guildName:r[9],getLineupGods:function(){for(var t=[],e=0,i=r[10][0];e<i.length;e++){var n=i[e];if(n){var o=tb.TB_god.get_TB_godById(n[0]),a=new GodItemVo(o);a.starLevel=n[1],a.level=n[2],a.dataType=1,n[3]&&(a.iSeverAttri=map2ary(n[3])),t.push(a)}else t.push(null)}return t},getShenqiAry:function(){return r[10][1]}};n._lastRankList.push(e)}this._lastRankList=[];for(var n=this,e=0;e<i.length;e++)t(e)}},e.prototype.isCanJoin=function(){return this.isOpen()&&!this.isJoin()&&this.isInJoinTime()},e.prototype.isOpen=function(){return App.IsSysOpen(ModuleConst.GLORY_FIGHT)},e.prototype.getBetNotice=function(){var t=tb.TB_honour_set.getSet().bet_endtime;return 60<=t?LanMgr.getLan("",10337,Math.ceil(t/60)):LanMgr.getLan("",10338,t)},e);function e(){this.reportDataDic={},this.isHasShow=!1,this.endJoinTime=0,this.startGameTime=0,this.season=0,this.curPhase=0,this.serverPhase=0,this._curMatchDic={},this._lastMatchDic={}}a.GloryModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.friend.FriendListUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)?this.show():this.onClosed()},enumerable:!0,configurable:!0}),i.prototype.onClosed=function(){},i.prototype.show=function(t,e){a.FriendModel.getInstance().queryList(Protocol.friend_friend_list,this.initView.bind(this))},i.prototype.initView=function(){var t=a.FriendModel.getInstance().getFriendList(!0);t&&0!=t.length?(this.list_friend.visible=!0,this.lab_notfriend.visible=!1):(this.list_friend.visible=!1,this.lab_notfriend.visible=!0);var e=new Date(1e3*App.serverTimeSecond);e.setHours(0,0,0,0),this._model.dateTime=e.getTime()/1e3,this.list_friend.array=t,this.lab_friendship.text="X"+App.hero.friend.toString(),this.lab_friendsNum.text=t.length.toString()+"/"+tb.TB_game_set.getMaxfriendNum(),this.lab_gain.text="X"+(tb.TB_game_set.getMaxFriendPonit()-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.friendPoint)).toString(),4<t.length?this.img_side.visible=!0:this.img_side.visible=!1},i.prototype.onOneKey=function(){var i=this,t=new Array;if(0<this.list_friend.array.length){t=this.list_friend.array;var e=!0,n=!0;for(var o in t)t[o].giveTime<this._model.dateTime&&(e=!1),0<t[o].pointNum&&(n=!1);e&&n?showToast(LanMgr.getLan("",10330)):(e||PLC.request(Protocol.friend_friend_give,null,function(t,e){t&&(a.FriendModel.getInstance().setGiveTime(t.giveId,t.giveTime),showToast(LanMgr.getLan("",10331)),i.initView())}),n||PLC.request(Protocol.friend_friend_pointGet,null,function(t,e){t&&(a.FriendModel.getInstance().delPoint(t.delPoint),showToast(LanMgr.getLan("",10332)),i.initView())}))}else showToast(LanMgr.getLan("",10329))},i.prototype.showPrivateChat=function(){dispatchEvt(new a.ChatEvent(a.ChatEvent.SHOW_PRIVATE_CHAT_VIEW))},i);function i(){var t=e.call(this)||this;return t.list_friend.array=null,t.btnPrivateChat.on(Laya.Event.CLICK,t,t.showPrivateChat),t.btn_allgift.on(Laya.Event.CLICK,t,t.onOneKey,[null]),t._model=a.FriendModel.getInstance(),t}a.FriendsView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.friend.FriendMainUI,__extends(n,i),n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.tab.selectedIndex=-1,this.tab_friendlist.dataSource=null,this.tab_addfriend.dataSource=null,this.tab_applyfriend.dataSource=null},n.prototype.show=function(){i.prototype.show.call(this),this.tab.selectedIndex=this.dataSource?this.dataSource:0},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.tab.selectedIndex=this.dataSource?this.dataSource:0},n.prototype.onTab=function(t){-1!=t&&(0==(this.viewStack.selectedIndex=t)?this.tab_friendlist.dataSource=!0:1==t?this.tab_addfriend.dataSource=!0:this.tab_applyfriend.dataSource=!0)},n.prototype.initFriendListView=function(){this.tab_friendlist.initView()},n.prototype.initApplyFriendList=function(t){this.tab_applyfriend.initFriendsList(t)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.Friend_MainView,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12410)},t.addChild(t.bgPanel.btnClose),t.tab.selectedIndex=-1,t.tab.selectHandler=new Handler(t,t.onTab),t}t.FriendMain=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.friend.ApplyfriendUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)?this.show():this.exit()},enumerable:!0,configurable:!0}),n.prototype.exit=function(){this.list_friend.array=null},n.prototype.show=function(t,e){this._model.queryList(Protocol.friend_friend_apply_list,this.initFriendsList.bind(this))},n.prototype.initFriendsList=function(t){this.list_friend.array=t,this.updateState()},n.prototype.updateState=function(){var t=this.list_friend.array.length;this._model.updateFriendApply(0<t),this.img_side.visible=5<t,this.lab_notfriend.visible=0==t,this.lab_friendsNum.text=LanMgr.getLan("",-12411,t)},n.prototype.onRender=function(t,e){var i=t.dataSource;if(i){var n=new UserHeadVo(i.head,i.level,i.headFrame);t.headbox.dataSource=n,t.lab_name.text=i.name,t.lab_force.text=LanMgr.getLan("",10117,i.force),t.lab_online.text=1==i.online?LanMgr.getLan("",12248):GameUtil.getOfflineTimeStr(i.outlineTime,App.serverTime/1e3),t.lab_online.color=1==i.online?"#17d745":"#535353",t.btn_agree.on(Laya.Event.CLICK,this,this.onFriendApply,[t,0]),t.btn_refuse.on(Laya.Event.CLICK,this,this.onFriendApply,[t,1]),t.headbox.on(Laya.Event.CLICK,this,this.onClickFriend,[i])}else t.btn_agree.off(Laya.Event.CLICK,this,this.onFriendApply),t.btn_refuse.off(Laya.Event.CLICK,this,this.onFriendApply),t.headbox.off(Laya.Event.CLICK,this,this.onClickFriend)},n.prototype.onFriendApply=function(t,e){t.dataSource&&this.onApplyOperation(t.dataSource,e)},n.prototype.onOnekeyAgree=function(){this.onApplyOperation(null,0)},n.prototype.onOnekeyRefuse=function(){this.onApplyOperation(null,1)},n.prototype.onApplyOperation=function(o,t){var a=this,r=!o,e=this.list_friend.array.length,s=0==t;if(r&&e<=0)showToast(LanMgr.getLan("",10324));else if(s&&this._model.getFriendList().length>=tb.TB_game_set.getMaxfriendNum())showToast(LanMgr.getLan("",10325));else{var i={};i[Protocol.friend_friend_apply_opt.args.playerId]=o?o.playerId:null,i[Protocol.friend_friend_apply_opt.args.opt_type]=t,PLC.request(Protocol.friend_friend_apply_opt,i,function(t,e){if(t){if(App.hero.removeBlockListById(t.delBlack),App.hero.removeBlackList(t.delBlackList),r)if(s){var i=Array.isArray(t.addfriendList)?t.addfriendList.length:0;0<i&&showToast(LanMgr.getLan("",10326,i))}else a.list_friend.array=null;else{var n=!!t.addfriend;s&&n&&showToast(LanMgr.getLan("",10327,o?o.name:"")),s||showToast(LanMgr.getLan("",10328,o?o.name:""))}t.delrequest&&a.delApplyItem([t.delrequest]),t.delrequestList&&a.delApplyItem(t.delrequestList),a.updateState()}})}},n.prototype.delApplyItem=function(t){function e(i){var t=n.list_friend.array.findIndex(function(t,e){return!!t&&t.playerId==i});-1!=t&&n.list_friend.deleteItem(t)}for(var n=this,i=0,o=t;i<o.length;i++)e(o[i])},n.prototype.onClickFriend=function(t){if(t){var e=new i.FriendEvent(i.FriendEvent.SHOW_FRIEND_PANEL);dispatchEvt(new i.HudEvent(i.HudEvent.SHOW_PLAYER_INFO_VIEW),{playerId:t.playerId,event:e})}},n.prototype.update=function(){this._model.queryList(Protocol.friend_friend_apply_list,this.initFriendsList.bind(this))},n);function n(){var t=e.call(this)||this;return t._model=i.FriendModel.getInstance(),t.list_friend.array=null,t.list_friend.renderHandler=new Handler(t,t.onRender),t.btn_update.on(Laya.Event.CLICK,t,t.update),t.btnOneKeyAgree.on(Laya.Event.CLICK,t,t.onOnekeyAgree),t.btnOneKeyRefuse.on(Laya.Event.CLICK,t,t.onOnekeyRefuse),t}i.ApplyView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.friend.AddFriendUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)?this.show():this.onClosed()},enumerable:!0,configurable:!0}),n.prototype.onClosed=function(){this._playerIds={},this.list_friend.array=null,this.lab_notfriend.visible=!1},n.prototype.show=function(t,e){i.FriendModel.getInstance().queryList(Protocol.friend_friend_recommend,this.initFriendsList.bind(this))},n.prototype.initFriendsList=function(t){this.list_friend.array=t,this.updateState()},n.prototype.updateState=function(){var t=this.list_friend.array.length;this.are_putin.text="",this.img_side.visible=4<t,this.lab_notfriend.visible=0==t},n.prototype.onRender=function(t,e){var i=t.dataSource;if(i){var n=new UserHeadVo(i.head,i.level,i.headFrame);t.headbox.dataSource=n,t.lab_name.text=i.name,t.lab_jifen.text=""+i.force,t.lab_type.text=LanMgr.getLan("",12248),t.lab_type.color=ColorConst.TASK_GREEN,t.btn_add.visible=!this.isapplyfriend(i.playerId),t.lab_isapply.visible=!t.btn_add.visible,t.btn_add.on(Laya.Event.CLICK,this,this.addfriend,[i.playerId]),t.headbox.on(Laya.Event.CLICK,this,this.onClickFriend,[i])}else t.btn_add.off(Laya.Event.CLICK,this,this.addfriend),t.headbox.off(Laya.Event.CLICK,this,this.onClickFriend)},n.prototype.lookup=function(){var n=this;if(0!==this.are_putin.text.length){var t={};t[Protocol.friend_friend_find.args.name]=this.are_putin.text,PLC.request(Protocol.friend_friend_find,t,function(t,e){if(t){var i=new Array;i.push(t.targetData),n.initFriendsList(i)}else n.initFriendsList(new Array)})}else showToast(LanMgr.getLan("",10321))},n.prototype.update=function(){var o=this;PLC.request(Protocol.friend_friend_recommend,null,function(t,e){if(t){var i=[];if(t.recommondList)for(;0<t.recommondList.length;){var n=Math.floor(Math.random()*t.recommondList.length);i.push(t.recommondList[n]),t.recommondList.splice(n,1)}o.initFriendsList(i)}})},n.prototype.addfriend=function(u){var h=this;if(i.FriendModel.getInstance().getFriendList().length>=tb.TB_game_set.getMaxfriendNum())showToast(LanMgr.getLan("",10322));else if(i.FriendModel.getInstance().isMyFriend(u))showToast(LanMgr.getLan("",10133));else if(App.hero.playerId!=u){var t={};t[Protocol.friend_friend_apply.args.playerId]=u,PLC.request(Protocol.friend_friend_apply,t,function(t,e,i){for(var n=t&&t.applyList||[],o=0,a=n;o<a.length;o++){var r=a[o];h._playerIds[r]=1}if(n.length<=0){var s=h.list_friend.array.findIndex(function(t,e){return t&&u==t.playerId});-1!=s&&h.list_friend.deleteItem(s)}h.list_friend.refresh(),h.updateState()})}else showToast(LanMgr.getLan("",10320))},n.prototype.onOneKeyAdd=function(){var l=this,e=[];if(this.list_friend.array.forEach(function(t){t&&t.playerId&&e.push(t.playerId)}),e.length<=0)showToast(LanMgr.getLan("",10323));else if(i.FriendModel.getInstance().getFriendList().length>=tb.TB_game_set.getMaxfriendNum())showToast(LanMgr.getLan("",10322));else{var t={};t[Protocol.friend_friend_oneKeyApply.args.playerIds]=e,PLC.request(Protocol.friend_friend_oneKeyApply,t,function(t,e,i){for(var n=t&&t.applyList||[],o=0,a=n;o<a.length;o++){var r=a[o];l._playerIds[r]=1}for(var s=0,u=n;s<u.length;s++){r=u[s];var h=l.list_friend.array.findIndex(function(t,e){return!t||!t||-1==n.indexOf(t.playerId)});-1!=h&&l.list_friend.deleteItem(h)}l.list_friend.refresh(),l.updateState()})}},n.prototype.isapplyfriend=function(t){return this._playerIds.hasOwnProperty(t)},n.prototype.onClickFriend=function(t){var e=new i.FriendEvent(i.FriendEvent.SHOW_FRIEND_PANEL);dispatchEvt(new i.HudEvent(i.HudEvent.SHOW_PLAYER_INFO_VIEW),{playerId:t.playerId,event:e})},n);function n(){var t=e.call(this)||this;return t._playerIds={},t.list_friend.array=null,t.list_friend.renderHandler=new Handler(t,t.onRender),t.btn_update.on(Laya.Event.CLICK,t,t.update),t.btn_lookup.on(Laya.Event.CLICK,t,t.lookup),t.btnOneKeyApply.on(Laya.Event.CLICK,t,t.onOneKeyAdd),t}i.AddView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.friend.FriendIRUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=new UserHeadVo(t.head,t.level,t.headFrame);this.headbox.dataSource=e,this.lab_name.text=t.name,this.lab_shenli.text=LanMgr.getLan("",10117,t.force),this.lab_type.text=0==t.logoutTime?LanMgr.getLan("",12248):GameUtil.getTimePrev(t.logoutTime),this.lab_type.color=0==t.logoutTime?ColorConst.TASK_GREEN:ColorConst.GRAY,this.btn_gift.visible=!1,this.btn_hasgift.visible=!1,this.btn_receive.visible=!1,0<t.pointNum?this.btn_receive.visible=!0:t.giveTime<n.FriendModel.getInstance().dateTime?this.btn_gift.visible=!0:this.btn_hasgift.visible=!0}},i.prototype.onReceive=function(){var i=this,t=this.dataSource;if(t&&0<t.pointNum){var e={};e[Protocol.friend_friend_pointGet.args.playerId]=t.playerId,PLC.request(Protocol.friend_friend_pointGet,e,function(t,e){t&&(n.FriendModel.getInstance().delPoint(t.delPoint),i.refreshData())})}},i.prototype.onClickFriend=function(){var t=this.dataSource;if(t){var e=new n.FriendEvent(n.FriendEvent.SHOW_FRIEND_PANEL);dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_PLAYER_INFO_VIEW),{playerId:t.playerId,event:e})}},i.prototype.onQieCuo=function(){var t=this.dataSource;if(t){var e=new n.FriendEvent(n.FriendEvent.SHOW_FRIEND_PANEL);dispatchEvt(new n.FriendEvent(n.FriendEvent.FRIEND_QIECUO),{playerId:t.playerId,event:e})}},i.prototype.allgift=function(){var i=this,t=this.dataSource;if(t){var e={};e[Protocol.friend_friend_give.args.playerId]=t.playerId,PLC.request(Protocol.friend_friend_give,e,function(t,e){t&&(n.FriendModel.getInstance().setGiveTime(t.giveId,t.giveTime),i.refreshData())})}},i);function i(){var t=e.call(this)||this;return t.btn_gift.on(Laya.Event.CLICK,t,t.allgift),t.headbox.on(Laya.Event.CLICK,t,t.onClickFriend),t.btn_receive.on(Laya.Event.CLICK,t,t.onReceive),t.btnFight.on(Laya.Event.CLICK,t,t.onQieCuo),t}n.FriendIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.friend.ApplyfriendIRUI,__extends(n,e),n);function n(){return e.call(this)||this}t.ApplyFriendIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.friend.AddFriendIRUI,__extends(n,e),n);function n(){return e.call(this)||this}t.AddFriendIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"FriendProcessor"},i.prototype.listenModuleEvents=function(){return[new u.FriendEvent(u.FriendEvent.SHOW_FRIEND_PANEL),new u.FriendEvent(u.FriendEvent.FRIEND_PANAEL_ADDFRIEND),new u.FriendEvent(u.FriendEvent.FRIEND_QIECUO)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof u.FriendEvent)switch(t.type){case u.FriendEvent.SHOW_FRIEND_PANEL:this.showFriendPanel(0);break;case u.FriendEvent.FRIEND_PANAEL_ADDFRIEND:this.friendAddfriend(t.data);break;case u.FriendEvent.FRIEND_QIECUO:this.showQieCuoFight(t.data)}},i.prototype.showFriendPanel=function(t){UIMgr.hasStage(UIConst.Friend_MainView)?this.friendsMainView.initFriendListView():Laya.timer.callLater(this,function(){UIMgr.hasStage(UIConst.FightViews)||UIMgr.showUI(UIConst.Friend_MainView)})},i.prototype.showQieCuoFight=function(s){if(s&&s.playerId&&s.playerId!=App.hero.playerId){var t={};t[Protocol.center_query_queryPlayer.args.playerId]=s.playerId,PLC.request(Protocol.center_query_queryPlayer,t,function(t){if(t){var e=new common.PlayerInfoVo;if(e.setData(t,s.playerId,s.event,s.eventData,!1),e.isHasLineup()){var i=new u.FightVo;i.copyType=CopyType.qiecuo,i.qiecuoVo=e;var n=new battle.BattleScenePvp(i.copyType);n.init([i.getOwnTeam()],i.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.god,i.getAllRound(),i.getTeamHp()),n.start();var o=n.winCamp===battle.BatteConsts.BATTLE_CAMPATK,a=new u.NewClientPage;a.result=o?playState.VICTORY:playState.FAILURE,a.initPage(n.battleReport),a.defType=iface.tb_prop.battleObjTypeKey.god,i.fightPageControl=a;var r={vo:i,event:e.svo.event?e.svo.event:new u.HudEvent(u.HudEvent.QIECUO_BACK),eventdata:e.svo.eventdata?e.svo.eventdata:e.svo.playerId};dispatchEvt(new u.FightsEvent(u.FightsEvent.ENTER_FIGHT_EVENT),r)}else LanMgr.getLan("",10134)}})}},i.prototype.friendAddfriend=function(t){if(this._model.isMyFriend(t))showToast(LanMgr.getLan("",10133));else if(App.hero.playerId!=t){var e={};e[Protocol.friend_friend_apply.args.playerId]=t,PLC.request(Protocol.friend_friend_apply,e,function(t,e){})}else showToast(LanMgr.getLan("",10320))},Object.defineProperty(i.prototype,"friendsMainView",{get:function(){return UIMgr.getUIByName(UIConst.Friend_MainView)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=u.FriendModel.getInstance(),t}u.FriendProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"FriendModule"},n.prototype.listProcessors=function(){return[new t.FriendProcessor]},n.prototype.onRegister=function(){t.FriendModel.getInstance().queryList(Protocol.friend_friend_list,function(){t.ChatModel.getInstance().initModel()})},n);function n(){return e.call(this)||this}t.FriendModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_FRIEND_PANEL="SHOW_FRIEND_PANEL",r.FRIEND_PANAEL_ADDFRIEND="FRIEND_PANAEL_ADDFRIEND",r.FRIEND_QIECUO="FRIEND_QIECUO",r.UPDATE_FRIEND_APPLY="UPDATE_FRIEND_APPLY",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.FriendEvent=a;function s(){}t.IFriendInfoVo=s;function u(){}t.IFriendRecommendSvo=u;function h(){}t.IFriendApplySvo=h}(game=game||{}),function(u){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.updateFriendApply=function(t){this.hasFriendApply=t,dispatchEvt(new u.FriendEvent(u.FriendEvent.UPDATE_FRIEND_APPLY))},e.prototype.friendApplyRp=function(){return this.loginApplyRp||this.hasFriendApply},e.prototype.queryList=function(o,a){var r=this;void 0===a&&(a=null),PLC.request(o,null,function(t,e){if(t)switch(o.name){case Protocol.friend_friend_list.name:var i=t.friendList||[];r.checkFriend(r._friendList,i),r._friendList=i,a&&a(i);break;case Protocol.friend_friend_apply_list.name:var n=t.requestList||[];r.loginApplyRp=!1,r.updateFriendApply(0<n.length),a&&a(n);break;case Protocol.friend_friend_recommend.name:r.recommendList=t.recommondList,a&&a(t.recommondList)}})},e.prototype.getFriendList=function(t){return void 0===t&&(t=!1),t&&this._friendList.sort(function(t,e){return 0==t.logoutTime&&0==e.logoutTime?e.force-t.force:0==t.logoutTime||0==e.logoutTime?1:e.logoutTime-t.logoutTime}),this._friendList},e.prototype.checkFriend=function(t,e){for(var i=[],n=0,o=e;n<o.length;n++){var a=o[n];i.push(a.playerId)}for(var r=0,s=t;r<s.length;r++)a=s[r],-1==i.indexOf(a.playerId)&&u.ChatModel.getInstance().delPrivateChat(a.playerId)},e.prototype.isMyFriend=function(e){return this._friendList.some(function(t){return t.playerId==e})},e.prototype.delFriend=function(e){var t=this._friendList.findIndex(function(t){return t.playerId==e});-1!=t&&this._friendList.splice(t,1),u.PrivateChatStorage.getInstance().delStorage(e),u.ChatModel.getInstance().delPrivateChat(e)},e.prototype.delPoint=function(e){e=e||[],this.getFriendList().forEach(function(t){-1!=e.indexOf(t.playerId)&&(t.pointNum=0)})},e.prototype.setGiveTime=function(e,i){e=e||[],this.getFriendList().forEach(function(t){-1!=e.indexOf(t.playerId)&&(t.giveTime=i)})},e.prototype.getFriendById=function(e){return this._friendList.find(function(t){return t.playerId==e})},e);function e(){this.loginApplyRp=!1,this.hasFriendApply=!1,this._friendList=new Array,this.recommendList=new Array}u.FriendModel=t}(game=game||{}),function(n){var t=(e.prototype.isCurrent=function(){return this._model.isCurrent(this.tbForest.ID)},e.prototype.isLast=function(){return this._model.isAllFinish()},e.prototype.isPass=function(){return this._model.forestCurFloor>=this.tbForest.ID},e.prototype.isHasBaoxiang=function(){return this.tbForest.first_reward&&0<this.tbForest.first_reward.length},e.prototype.isSpecial=function(){return this.tbForest.special_show&&0<this.tbForest.special_show.length},e.prototype.getShowItem=function(){if(!this.isSpecial())return null;var t=new ItemVo(this.tbForest.special_show[0],this.tbForest.special_show[1]);return t.show=!0,t},e.prototype.isReward=function(){return-1!=App.hero.doneForestChests.indexOf(this.tbForest.ID)},e.prototype.isCanReward=function(){return this.isPass()&&!this.isReward()},e);function e(t){if(this._model=n.FogForestModel.getInstance(),this.tbForest=t,this.modelId=tb.TB_monster.get_TB_monsterById(t.boss_show).model,this.specialModel=0,this.isSpecial()){var e=tb.TB_item.get_TB_itemById(this.tbForest.special_show[0]);if(e.type==iface.tb_prop.itemTypeKey.god){var i=e?tb.TB_god.get_TB_godById(e.defined[0]):null;this.specialModel=i?i.model:0}else this.itemVo=new ItemVo(e.ID,this.tbForest.special_show[1])}}n.ForestGuanqiaVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fogforest.RankIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t?1==t[0]?(this.lbGuanqia.fontSize=this.lbName.fontSize=this.lbRank.fontSize=20,this.lbGuanqia.text=t[1][1]+LanMgr.getLan("",12412),this.lbName.text=t[1][2],this.lbRank.text="1"):2==t[0]?(this.lbGuanqia.fontSize=this.lbName.fontSize=this.lbRank.fontSize=20,this.lbGuanqia.text=t[1][1]+LanMgr.getLan("",12412),this.lbName.text=t[1][2],this.lbRank.text="2"):3==t[0]&&(this.lbGuanqia.fontSize=this.lbName.fontSize=this.lbRank.fontSize=20,this.lbGuanqia.text=t[1][1]+LanMgr.getLan("",12412),this.lbName.text=t[1][2],this.lbRank.text="3"):(this.lbGuanqia.text="",this.lbName.text="",this.lbRank.text="")},n);function n(){return e.call(this)||this}t.forestRankIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=ui.fogforest.RewardViewUI,__extends(i,n),i.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12261)}},i.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},i.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},i.prototype.close=function(t,e,i){n.prototype.close.call(this,t,e,i)},i.prototype.initView=function(){this.rewardList.array=t.FogForestModel.getInstance().getChestList(!0)},i);function i(){return n.call(this)||this}t.ForestRewardView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fogforest.RewardIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;t?(this.lbName.text=LanMgr.getLan("",12002,t.tbForest.ID),this.btnLingqu.visible=!t.isReward(),this.btnLingqu.label=t.isCanReward()?LanMgr.getLan("",10041):LanMgr.getLan("",10045),this.btnLingqu.gray=!t.isCanReward(),this.imgYilingqu.visible=t.isReward(),this.itemList.array=t.tbForest.getBossRewards(),this.btnLingqu.on(Laya.Event.CLICK,this,this.onClick)):this.btnLingqu.off(Laya.Event.CLICK,this,this.onClick)},n.prototype.onClick=function(){dispatchEvt(new t.FogForestEvent(t.FogForestEvent.OPEN_BAOXIANG,this))},n);function n(){return e.call(this)||this}t.ForestRewardIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.fogforest.GuanqiaBoxUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;if(t){this.lab_condition.visible=!1;var e=t.tbForest.ID%2==1;this.imgDitu.scaleX=e?1:-1,this.boxRole.x=e?this.width/2+100:this.width/2-300,this.boxChallenge.x=e?this.width/2+40:this.width/2-120,this.ani_guanqia.x=this.boxChallenge.x+this.boxChallenge.width/2,this.ani_guanqia.y=this.boxChallenge.y+this.boxChallenge.height/2;var i=t.isCurrent(),n=t.isPass();this.lbTitle.visible=this.imgDi.visible=!0,this.lbTitle.text=t.tbForest.name,this.imgMask.visible=n,this.imgMiwu.visible=!n&&!i,i?(this.ani_guanqia.play(0,!0),this.ani_guanqia.visible=!0):(this.ani_guanqia.stop(),this.ani_guanqia.visible=!1),this.removeBgEff(),this.uiScenes.onExit(),n&&!i||(this.uiScenes.onShow(),Laya.timer.once(300,this,this.delayShow,[t.modelId]),i&&Laya.timer.once(350,this,this.addBgEff)),this.boxChallenge.on(Laya.Event.CLICK,this,this.onChallenge),this.boxRole.on(Laya.Event.CLICK,this,this.onChallenge)}else this.uiScenes.onExit(),this.removeBgEff(),Laya.timer.clearAll(this),this.boxChallenge.off(Laya.Event.CLICK,this,this.onChallenge),this.boxRole.off(Laya.Event.CLICK,this,this.onChallenge),this.ani_guanqia.stop(),this.ani_guanqia.visible=!1},n.prototype.onChallenge=function(){var t=this.dataSource;t&&t.isCurrent()&&dispatchEvt(new e.FogForestEvent(e.FogForestEvent.GUANQIA_CHALLENGE),t)},n.prototype.addBgEff=function(){var e=this,t=this.dataSource;if(!this._hasbgEff&&t){this._hasbgEff=!0;var i=this.boxRole.localToGlobal(new Laya.Point(0,0)),n=this.uiScenes.get3dPos(i.x+this.boxRole.width/2-Launch.offsetX,i.y+this.boxRole.height-Launch.offsetY);this.uiScenes.addEffect(this,10000022,n,2.5,30,function(t){e._bgEff=t,e._hasbgEff||e.removeBgEff()})}},n.prototype.removeBgEff=function(){this._hasbgEff=!1,this._bgEff&&(this.uiScenes.removeEffect(this._bgEff),this._bgEff=null)},n.prototype.delayShow=function(t){var e=this.boxRole.localToGlobal(new Laya.Point(0,0));if(this.uiScenes.sceneChar)this.uiScenes.sceneChar.setRoleUrl(getRoleUrl(t)),this.uiScenes.sceneChar.play(tl3d.CharAction.ATTACK_02,2);else{var i=e.y+this.boxRole.height-Launch.offsetY;this.uiScenes.addModelChar(t,e.x+this.boxRole.width/2-Launch.offsetX,i,180,2)}},n);function n(){var t=i.call(this)||this;return t._hasbgEff=!1,t.uiScenes=new Base2dSceneLayer,t.boxRole.addChild(t.uiScenes),t.uiScenes.setModelBox(t,t.lbTitle,t.imgDitu),t}e.ForestGuanqiaBox=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var o,t=(o=ui.fogforest.FogForestUI,__extends(e,o),e.prototype.createChildren=function(){o.prototype.createChildren.call(this);var t=Laya.stage.width,e=Laya.stage.height;this._guanqiaLiat=[this.guanqia1,this.guanqia2,this.guanqia3],this.guanqia1.width=t,this.guanqia1.height=e/3,this.guanqia2.width=t,this.guanqia2.height=e/3,this.guanqia3.width=t,this.guanqia3.height=e/3,this.guanqia3.y=0,this.guanqia2.y=this.guanqia3.y+this.guanqia3.height,this.guanqia1.y=this.guanqia2.y+this.guanqia2.height},e.prototype.show=function(t,e){o.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){o.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(t,e,i){o.prototype.close.call(this,t,e,i);for(var n=0;n<this._guanqiaLiat.length;n++)this._guanqiaLiat[n].dataSource=null;this.boxRank.visible=!1,this.awardUI.dataSource=null,this.rankList.array=null},e.prototype.onClosed=function(){o.prototype.onClosed.call(this),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_jiangli,redpointName:"forest_reward",callback:this.onBaoxiang.bind(this)},{btnSkin:SkinUtil.btn_rank,callback:this.showRankBox.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.toClose.bind(this)}),this.requestRankList(),this.boxRank.visible=!1;var i=a.FogForestModel.getInstance();this.awardUI.dataSource=i.getSpecialGuanqia();for(var n=i.getViewList(),o=0;o<n.length;o++)this._guanqiaLiat[o].dataSource=n[o]},e.prototype.requestRankList=function(){var i=this;this.rankList.array=null;var t={};t[Protocol.game_rank_getRankList.args.rankType]=iface.tb_prop.rankTypeKey.forest,PLC.request(Protocol.game_rank_getRankList,t,function(t){if(t)for(var e in i.rankList.repeatY=3,t.rankList)i.rankList.itemRender=a.forestRankIR,i.rankList.addItemAt([Number(e),t.rankList[e]],Number(e)-1)})},e.prototype.toClose=function(){dispatchEvt(new a.HudEvent(a.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_MAOXIAN))},e.prototype.onOnekey=function(){dispatchEvt(new a.FogForestEvent(a.FogForestEvent.ONE_KEY_PASS))},e.prototype.onBaoxiang=function(){dispatchEvt(new a.FogForestEvent(a.FogForestEvent.SHOW_REWARD_VIEW))},e.prototype.showRankBox=function(){this.boxRank.visible?this.boxRank.visible=!1:this.boxRank.visible=!0},e);function e(){var t=o.call(this)||this;return t.isModelClose=!1,t.group=UIConst.hud_group,t}a.FogForestView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fogforest.AwardUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;if(t)if(this.visible=!0,this.lbDesc.text=t.tbForest.special_desc,t.isSpecial()){var e=0<t.specialModel;this.itemBox.visible=!1,this.uiScenes1.onExit(),e?(this.uiScenes1.onShow(),Laya.timer.once(200,this,this.delayShow,[t.specialModel])):(this.itemBox.visible=!0,this.itemBox.dataSource=t.itemVo)}else this.uiScenes1.onExit();else this.uiScenes1.onExit(),this.visible=!1},n.prototype.delayShow=function(t){var e=this.lbDesc.localToGlobal(new Laya.Point(0,0));this.uiScenes1.addModelChar(t,e.x+this.lbDesc.width/2-Launch.offsetX,e.y-Launch.offsetY-10,180,1.2),this.uiScenes1.sceneChar.play(tl3d.CharAction.ATTACK_02,2)},n);function n(){var t=e.call(this)||this;return t.uiScenes1=new Base2dSceneLayer,t.addChild(t.uiScenes1),t.uiScenes1.setModelBox(t,t.lbDesc,t.lbDesc),t}t.forestAwardView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"FogForestProcessor"},i.prototype.listenModuleEvents=function(){return[new r.FogForestEvent(r.FogForestEvent.SHOW_MAIN_VIEW),new r.FogForestEvent(r.FogForestEvent.SHOW_REWARD_VIEW),new r.FogForestEvent(r.FogForestEvent.OPEN_BAOXIANG),new r.FogForestEvent(r.FogForestEvent.GUANQIA_CHALLENGE),new r.FogForestEvent(r.FogForestEvent.ONE_KEY_PASS),new r.FogForestEvent(r.FogForestEvent.UPDATE_VIEW)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof r.FogForestEvent)switch(t.type){case r.FogForestEvent.SHOW_MAIN_VIEW:this.showMainView();break;case r.FogForestEvent.SHOW_REWARD_VIEW:this.showRewardView();break;case r.FogForestEvent.OPEN_BAOXIANG:this.openBaoxiang(t.data);break;case r.FogForestEvent.GUANQIA_CHALLENGE:this.challenge(t.data);break;case r.FogForestEvent.ONE_KEY_PASS:this.oneKeyPass();break;case r.FogForestEvent.UPDATE_VIEW:this._model.initNum(),this.initView()}},i.prototype.showMainView=function(){this._model.firstLogin=!1,UIMgr.showUI(UIConst.FogForestView)},i.prototype.showRewardView=function(){UIMgr.showUI(UIConst.FogForestRewardView)},i.prototype.openBaoxiang=function(i){var t=i.dataSource;if(t&&t.isCanReward()){var e={};e[Protocol.game_forest_getChestAward.args.floor]=t.tbForest.ID,PLC.request(Protocol.game_forest_getChestAward,e,function(t){if(t){UIUtil.showRewardView(t.commonData),i.refreshView(),UIMgr.getUIByName(UIConst.FogForestView);var e=UIMgr.getUIByName(UIConst.FogForestRewardView);e&&e.initView(),dispatchEvt(new r.FogForestEvent(r.FogForestEvent.RECEIVE_SUCCESS))}})}else showToast(LanMgr.getLan("",10317))},i.prototype.oneKeyPass=function(){var e=this,i=this._model;if(i.isMaxFloor())showToast(LanMgr.getLan("",10185));else{var t=tb.TB_vip_privilege.get_TB_vip_privilegeById(iface.tb_prop.levelPrivilegeTypeKey.forest);App.hero.vip>=t.vip_level||t.para&&App.hero.forestMaxFloor>=t.para?PLC.request(Protocol.game_forest_sweepForest,{},function(t){t&&(UIUtil.showRewardView(t.commonData),i.forestCurFloor=App.hero.forestMaxFloor,e.initView(),dispatchEvt(new r.FogForestEvent(r.FogForestEvent.ALL_PASS_SUCCESS)))}):showToast(LanMgr.getLan("",10318,t.para,t.vip_level))}},i.prototype.challenge=function(t){if(this._model.isAllFinish())showToast(LanMgr.getLan("",10185));else if(t.isPass())showToast(LanMgr.getLan("",10319));else if(t.tbForest.need_power>App.hero.force)showToast(LanMgr.getLan("",10200,t.tbForest.need_power));else{var e=new r.FightVo;e.copyType=CopyType.fogForest,e.forestGuanqia=t;var i=new battle.BattleScenePve(e.copyType);i.init([e.getOwnTeam()],e.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.monster,e.getAllRound(),e.getTeamHp()),i.start();var n=i.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",n,"战报：",i.battleReport);var o=new r.NewClientPage;o.result=n?playState.VICTORY:playState.FAILURE,o.initPage(i.battleReport),o.defType=iface.tb_prop.battleObjTypeKey.monster,e.fightPageControl=o;var a={vo:e,event:new r.FogForestEvent(r.FogForestEvent.SHOW_MAIN_VIEW)};dispatchEvt(new r.FightsEvent(r.FightsEvent.ENTER_FIGHT_EVENT),a)}},i.prototype.initView=function(){var t=UIMgr.getUIByName(UIConst.FogForestView);t&&t.initView(),UIMgr.hasStage(UIConst.SysTopView)&&UIMgr.getUIByName(UIConst.SysTopView).updateFogforest()},i);function i(){var t=e.call(this)||this;return t._model=r.FogForestModel.getInstance(),t}r.FogForestProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"FogForestModule"},n.prototype.listProcessors=function(){return[new t.FogForestProcessor]},n.prototype.onRegister=function(){t.FogForestModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.FogForestModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_MAIN_VIEW="SHOW_MAIN_VIEW",r.SHOW_REWARD_VIEW="SHOW_REWARD_VIEW",r.OPEN_BAOXIANG="OPEN_BAOXIANG",r.ONE_KEY_PASS="ONE_KEY_PASS",r.UPDATE_VIEW="UPDATE_VIEW",r.GUANQIA_CHALLENGE="GUANQIA_CHALLENGE",r.RECEIVE_SUCCESS="RECEIVE_SUCCESS",r.CHALLENGE_SUCCESS="CHALLENGE_SUCCESS",r.ALL_PASS_SUCCESS="ALL_PASS_SUCCESS",r.UPDATE_CUR_GUANQIA="UPDATE_CUR_GUANQIA",r.Init_FOREST="Init_FOREST",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.FogForestEvent=a;function s(){}t.IRankVo=s}(game=game||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(i){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initModel=function(){this.firstLogin=!0,this._guanqiaList=[];var t=TableData.getInstance().getTableByName(TableData.tb_forest).data;for(var e in t)this._guanqiaList.push(new i.ForestGuanqiaVo(t[e]));this.maxTbFloor=this._guanqiaList.length,this.initNum(),dispatchEvt(new i.FogForestEvent(i.FogForestEvent.Init_FOREST))},e.prototype.initNum=function(){this.forestCurFloor=App.hero.forestCurFloor},e.prototype.addForestCurFloor=function(){this.forestCurFloor+=1,dispatchEvt(new i.FogForestEvent(i.FogForestEvent.UPDATE_CUR_GUANQIA))},e.prototype.getList=function(){return this._guanqiaList},e.prototype.getViewList=function(){var e=this,i=0;return 0<this.forestCurFloor&&(i=this._guanqiaList.findIndex(function(t){return t.tbForest.ID==e.forestCurFloor}),i+=1),i>=this._guanqiaList.length-1&&(i=this._guanqiaList.length-2),this._guanqiaList.filter(function(t,e){return 0==i?0==e||1==e||2==e:e==i||e==i+1||e==i-1})},e.prototype.getChestList=function(t){void 0===t&&(t=!1);var e=this._guanqiaList.filter(function(t){return t.isHasBaoxiang()});return e=__spreadArrays(e),t&&(e.forEach(function(t){t.sortNum=t.tbForest.ID,t.isCanReward()?t.sortNum-=1e5:t.isReward()?t.sortNum+=1e3:t.sortNum-=1e4}),e.sort(function(t,e){return t.sortNum-e.sortNum})),e},e.prototype.getSpecialGuanqia=function(){return this._guanqiaList.find(function(t){return t.isSpecial()&&!t.isPass()&&!t.isReward()})},e.prototype.isAllFinish=function(){var t=this._guanqiaList.length;return 0<t&&this.forestCurFloor==this._guanqiaList[t-1].tbForest.ID},e.prototype.isMaxFloor=function(){return this.forestCurFloor>=App.hero.forestMaxFloor},e.prototype.isCurrent=function(e){var i=this,t=this._guanqiaList.findIndex(function(t){return t.tbForest.ID==i.forestCurFloor});return this._guanqiaList.findIndex(function(t){return t.tbForest.ID==e})-t==1},e.prototype.isCanOneKeyPass=function(){return!(!App.IsSysOpen(ModuleConst.FOG_FOREST)||this.isMaxFloor())&&App.hero.levelPrivilege(iface.tb_prop.levelPrivilegeTypeKey.forest)},e.prototype.isCanReward=function(){return!!App.IsSysOpen(ModuleConst.FOG_FOREST)&&this.getChestList().some(function(t){return t.isCanReward()})},e.prototype.isVisible=function(){return!!App.IsSysOpen(ModuleConst.FOG_FOREST)&&this.forestCurFloor<App.hero.forestMaxFloor},e.AUTO_NEXXT_CD=5,e);function e(){this.autoNext=!0,this._guanqiaList=[]}i.FogForestModel=t}(game=game||{}),function(n){var t=(e.prototype.getShowBuff=function(){for(var t=new Array,e=0;e<this.buffAry.length;e++)this.buffAry[e],this.buffAry[e].tb_buff.is_show&&t.push(JSON.parse(JSON.stringify(this.buffAry[e])));return t},Object.defineProperty(e.prototype,"hpr",{get:function(){return this._hpr},set:function(t){var e=this;t<=0&&(t=0,this.char.play(tl3d.CharAction.DEATH,1,!1),tl3d.TimeUtil.addTimeOut(1500,function(){e.char&&e.hpr<=0&&e.char.onStage&&(e.char.removeChar(),e.onDead&&e.onDead.call(null,[e.godid]))})),this._hpr=t},enumerable:!0,configurable:!0}),e.prototype.getHp=function(){return this.hp},e.prototype.setHp=function(t,e){2==e?this.hp+=t:this.hp-=t,this.hpr=Math.floor(this.hp/this.maxhp*100);var i=0;0<this.hpr&&(i=this.hpr<5?5:this.hpr),this.tab instanceof tb.TB_monster&&0<this.tab.type?dispatchEvt(new n.FirstGuideEvent(n.FirstGuideEvent.CHANGE_BOSSBLOOD),{vo:i,type:-300}):this.char.lifenumExt=i},e.prototype.beatWitheFilter=function(){var t=this;this.char.changeColor=[100,10,10,.7],this._tickw=setTimeout(function(){t.char.changeColor=[1,1,1,t.char.alpha]},150)},e.prototype.beatRedFilter=function(){var t=this;this.char.changeColor=[100,0,0,.7],this._tickr=setTimeout(function(){t.char.changeColor=[1,1,1,t.char.alpha]},150)},e.prototype.onDispose=function(){clearTimeout(this._tickw),clearTimeout(this._tickr),this.buffAry=[],this.char.destory(),this.char=null},e);function e(){this.movesucc=!1,this.hp=0}n.MoiveGodVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=Laya.Sprite,__extends(i,e),i.prototype.initCam=function(t){var e;void 0===t&&(t=null),e=t||this.dxc_initHeadCamparm,this.gameScene.camRotationX=e[0],this.gameScene.camRotationY=e[1],this.gameScene.camDistance=e[2],this.gameScene.camPositionX=e[3],this.gameScene.camPositionY=e[4],this.gameScene.camPositionZ=e[5]},i.prototype.nextStep=function(t){var e=this;if(this._stepIdx=t,this.curVo=this.stepAry[this._stepIdx],!this.curVo)return logerror("引导步骤错误：",this._stepIdx),void BingoSDK.reportError("引导步骤错误："+this._stepIdx);this._stepIdx++,1==this.curVo.type?1<this.curVo.id&&dispatchEvt(new u.FirstGuideEvent(u.FirstGuideEvent.GUIDE_START),this.curVo.id):2==this.curVo.type?(this.curVo.guideid&&0<this.curVo.guideid&&dispatchEvt(new u.FirstGuideEvent(u.FirstGuideEvent.GUIDE_START),this.curVo.id),this.onFight(this.curVo)):3==this.curVo.type?(this.hideRolePar(),this.guochang(this.curVo)):4==this.curVo.type&&(this.gameScene.scene.skillMgr.shock.clearShock(),this.gameScene.scene.skillMgr.shock.shock(999999999,this.curVo.amp),setTimeout(function(){e.gameScene.scene.skillMgr.shock.shock(3e3,4),dispatchEvt(new u.FirstGuideEvent(u.FirstGuideEvent.GUIDE_START),e.curVo.id)},this.curVo.time))},i.prototype.onFight=function(t){this.setCurRole(t.caster);var e=this.roleMap[t.caster];for(var i in e.skillMap){var n=e.skillMap[i];0<n.cd&&n.cd--}this.fight(t)},i.prototype.getChar3dPosAry=function(t,e){var i=this;this.clearSelectEff();var n,o=new Array;for(var a in n=1==t||3==t?this.getMinHpTarget(t,e):this.roleMap){var r=n[a];if(0<r.hpr&&(0<r.rotation&&t<3||0==r.rotation&&2<t)){var s=r.char.scale,u=new tl3d.Vector3D(r.pos.x,r.char.getCharHeight()+17,r.pos.z);"2_4"==r.godid&&(2200135==r.tab.ID?(u.x+=6,u.y=u.y+20,u.z-=160):(u.x-=12,u.y=u.y+20,u.z-=120)),this.gameScene.addEffect(this,1000003,u,s,10,function(t){i._selectEffAry.push(t)}),o.push(r)}}return o},i.prototype.getMinHpTarget=function(t,e){var i=new Array;for(var n in this.roleMap){var o=this.roleMap[n];(0<o.rotation&&t<3||0==o.rotation&&2<t)&&i.push(o)}var a={};i.sort(function(t,e){return t.hpr-e.hpr});for(var r=0;r<e&&!(r>=i.length);r++)a[i[r].godid]=i[r];return a},i.prototype.clearSelectEff=function(){for(this._selectEffAry||(this._selectEffAry=new Array);0<this._selectEffAry.length;)this.gameScene.removeEffect(this._selectEffAry[0]),this._selectEffAry.shift()},i.prototype.selectSkill=function(){this.fight(this.curVo)},i.prototype.guochang=function(t){var e=this;this.setTeamRoleAction(tl3d.CharAction.WALK,0),this._sceneTransitionUi.visible=!0,Laya.Tween.to(this._sceneTransitionUi,{alpha:1},t.time>>1,null,Laya.Handler.create(this,function(){e.refreshEnemy(1,2),e.setTeamRoleAction(tl3d.CharAction.STANAD,0),e.initCam(e.dxc_initBossCamparm),Laya.Tween.to(e._sceneTransitionUi,{alpha:0},t.time>>1,null,Laya.Handler.create(e,function(){e.tweenCam(5,function(){e.sendsucc(t.id)}),e._sceneTransitionUi.visible=!1}))}))},i.prototype.setTeamRoleAction=function(t,e){for(var i in this.roleMap)this.roleMap[i]&&0==this.roleMap[i].rotation&&this.roleMap[i].char.play(t,e,!1)},i.prototype.initRoles=function(){var e=this;this.myteam.forEach(function(t){e.addBaseRole(t)})},i.prototype.refreshEnemy=function(t,e){this._curIdx=t,this._bossType=e,this.refreshEnemyRole()},i.prototype.refreshEnemyRole=function(){var e=this;for(var t in this.roleMap){var i=this.roleMap[t];i&&(0<i.rotation?(this.roleMap[t].char.delUIConatiner(),delete this.roleMap[t]):(i.buffAry=[],i.char&&(i.char.buffary=i.buffAry)))}this.enemyteam.forEach(function(t){e.addBaseRole(t)}),this.setTeamPost()},i.prototype.setTeamPost=function(){for(var t in this.roleMap){var e=this.roleMap[t];0<this._bossType?e.pos=0==e.rotation?this._dxcBossMyPosition[e.locad]:this._dxcBossPosition[e.locad]:e.pos=0==e.rotation?this._dxcMyPosition[e.locad]:this._dxcEnemyPosition[e.locad],e.char.px=e.pos.x,e.char.py=e.pos.y,e.char.pz=e.pos.z}},i.prototype.getRolePos=function(t){var e=this.roleMap[t];return e.char.math3DWorldtoDisplay2DPos(new tl3d.Vector3D(e.char.px,e.char.py+e.char.tittleHeight>>1,e.char.pz))},i.prototype.mainSceneComplete=function(){this.sceneComplete&&this.sceneComplete()},i.prototype.addBaseRole=function(t){var e=new u.MoiveGodVo;e.godid=t.team+"_"+t.location,e.locad=t.location,e.rotation=1==t.team?0:180,e.lev=10,e.tab=t.tab,e.maxhp=t.hp,e.skillMap=new Object;for(var i=0;i<t.skill.length;i++){var n=t.skill[i],o=new GodSkillVo;o.skillid=n;var a=tb.TB_skill.get_TB_skillById(n);if((o.cd=0)<(o.tabskill1=a).effect){var r=tb.TB_skill_effect.get_TB_skill_effectById(a.effect);o.skillfile=String(r.effect_id),o.effectName=r.action}e.skillMap[n]=o}var s=new FightChar;this.gameScene.scene.addMovieDisplay(s),s.setRoleUrl(getRoleUrl(String(t.model))),s.scale=t.scale,t.tab instanceof tb.TB_monster&&0<t.tab.type?dispatchEvt(new u.FirstGuideEvent(u.FirstGuideEvent.CHANGE_BOSSBLOOD),{vo:100,type:-300}):(s.bloodEnableExt=!0,s.setbloodColor(1==t.team),s.nameEnable=!0,s.charName=t.name),s.shadow=!0,s.setShadowSize(6),s.rotationY=e.rotation,s.visible=!0,s.setAnger(100),e.char=s,e.setHp(t.hp,2),this.roleMap||(this.roleMap={}),this.roleMap[e.godid]=e},i.prototype.getCam3d=function(){return new tl3d.Vector3D(this.gameScene.copyCam3d.x,this.gameScene.copyCam3d.y,this.gameScene.copyCam3d.z)},i.prototype.downPointTo3d=function(t,e){return this.gameScene.getGroundPos(t,e)},i.prototype.enterScene=function(t,e){this._curmapid=t,this.sceneComplete=e,this.gameScene.scene.loadScene(t,function(){},function(t){1<=t||UIMgr.getInstance().loadingProcess(.8+.2*t)},this.mainSceneComplete.bind(this))},i.prototype.tweenCam=function(t,e){var i;switch(void 0===e&&(e=null),t){case 2:i=this.dxc_fightCamparm;break;case 3:i=this.dxc_victoryCamparm;break;case 4:i=0<this._bossType?this.dxc_bossBadCamparm:this.dxc_enimyBadCamparm;break;case 5:i=this.dxc_fightBossCamparm}Laya.Tween.to(this.gameScene,{camRotationX:i[0]},1e3),Laya.Tween.to(this.gameScene,{camRotationY:i[1]},1e3),Laya.Tween.to(this.gameScene,{camDistance:i[2]},1e3),Laya.Tween.to(this.gameScene,{camPositionX:i[3]},1e3),Laya.Tween.to(this.gameScene,{camPositionY:i[4]},1e3),Laya.Tween.to(this.gameScene,{camPositionZ:i[5]},1e3,null,Handler.create(this,function(){e&&e()}))},i.prototype.exitScene=function(){TimeUtil.removeAllTickOut(),this.roleMap=null,this.clearSelectEff(),this.gameScene.onExit()},i.prototype.setCurRole=function(t){var e=this,i=this.roleMap[t];this.hideRolePar(),this.gameScene.addEffect(this,888888,i.pos,"2_4"==i.godid?2.5:i.char.scale,5,function(t){e._lastRolePar=t})},i.prototype.hideRolePar=function(){this._lastRolePar&&(this.gameScene.removeEffect(this._lastRolePar),this._lastRolePar=null)},i.prototype.flytext=function(c){function t(){var n=c.hpAry[_],o=d.roleMap[n.id];if(o){var a=tl3d.TextJumpType.N_NORMALDAMAGE;if((a=1==c.tarType?Math.random()<.5?tl3d.TextJumpType.N_NORMALDAMAGE:tl3d.TextJumpType.N_CRIT:tl3d.TextJumpType.N_UPHP)==tl3d.TextJumpType.N_CRIT&&d.gameScene.scene.skillMgr.shock.shock(300,10),2==c.tarType)setTimeout(function(){o.setHp(n.hp,c.tarType),p.showJumpText(p.gameScene.scene,new tl3d.Vector3D(o.char.px,o.char.py,o.char.pz),n.hp,a,tl3d.TimeUtil.getTimer(p.gameScene.scene.startTime))},300);else{var r=tl3d.TimeUtil.getTimer(tl3d.TimeUtil.START_TIME);if(1<c.times){var s=c.times,u=c.timelist||[];if(0==u.length)for(var t=Math.floor(100/s),e=0;e<s;e++)e==s-1?u.push(100-(s-1)*t):u.push(t);function i(){var t=0;t=l==s-1?n.hp-h:u[l]/100*n.hp,t=Math.floor(t),h+=t;var e=c.flytimes?frame2time(c.flytimes[l]):300*l;e/=d.gameScene.timespeed1+1;var i=r+e;d.showJumpText(d.gameScene.scene,new tl3d.Vector3D(o.char.px,o.char.py,o.char.pz),t,a,i),0==e?(o.setHp(t,c.tarType),d.playInjured1(o)):tl3d.TimeUtil.addTimeOut(e,function(){o.setHp(t,c.tarType),p.playInjured1(o)})}for(var h=0,l=0;l<s;l++)i()}else o.setHp(n.hp,c.tarType),d.showJumpText(d.gameScene.scene,new tl3d.Vector3D(o.char.px,o.char.py,o.char.pz),n.hp,a,r),d.playInjured1(o)}}}for(var p=this,d=this,_=0;_<c.hpAry.length;_++)t()},i.prototype.playInjured1=function(t){t&&(t.beatWitheFilter(),this.gameScene.addEffect(this,1029,new tl3d.Vector3D(t.char.x,t.char.y+50,t.char.z),2,0,null,0,0,!0),t.char.curentAction!=tl3d.CharAction.DEATH&&(t.char.curentAction==tl3d.CharAction.INJURED&&t.char.play(tl3d.CharAction.STANAD,2,!1),t.char.play(tl3d.CharAction.INJURED,2,!1)))},i.prototype.roleDeath=function(t){},i.prototype.fight=function(t){var e=this,i=tb.TB_skill.get_TB_skillById(t.skillid);if(i){var n=0,o=tb.TB_skill_effect.get_TB_skill_effectById(i.effect);o&&o.frame&&0<o.frame.length&&(n=frame2time(o.frame[1]));var a=this.roleMap[t.caster];a.skillMap[t.skillid].cd=0,o&&1==o.att_type?(n+=500,this.jinzhan(t,a,i)):o&&2==o.att_type&&this.yuancheng(o,t,a,i),TimeUtil.addTimeOut(n/(this.gameScene.timespeed1+1),function(){e.flytext(t)})}else this.sendsucc(t.id)},i.prototype.playInjured=function(t,i){var n=this;if(t&&t.frame&&1<t.frame.length)for(var e=1;e<t.frame.length;e++){t.frame[e];var o=1==t.att_type?500+frame2time(t.frame[e]):frame2time(t.frame[e]);o/=this.gameScene.timespeed1+1,TimeUtil.addTimeOut(o,function(){for(var t=0;t<i.target.length;t++){var e=n.roleMap[i.target[t]];e&&e.char.onStage&&e.char.curentAction!=tl3d.CharAction.DEATH&&(e.char.curentAction==tl3d.CharAction.INJURED&&e.char.play(tl3d.CharAction.STANAD,2,!1),e.char.play(tl3d.CharAction.INJURED,2,!1))}})}},i.prototype.jinzhan=function(i,t,e){var n=this,o=this.roleMap[i.target[0]],a=o.char;t.char.watch(a),t.char.play(tl3d.CharAction.WALK,2,!1);var r=tl3d.Vector3D.distance(o.pos,t.pos),s=o.pos.subtract(t.pos);s.normalize(),s.scaleBy(.6*r);var u=t.pos.add(s),h=500/(this.gameScene.timespeed1+1);Laya.Tween.to(t.char,{px:u.x,pz:u.z},h,null,Laya.Handler.create(this,function(t,e){n.charPlaySkill(t,e,i)},[t,e]))},i.prototype.yuancheng=function(t,e,i,n){if(1==t.ballistic)for(var o=this.getTargetRoleList(e.target),a=0;a<o.length;a++){var r=a+1;r==o.length&&i.char.watch(o[a].char),this.charDandaoPlaySkill(i,n,o[a],r==o.length?e:null)}else{var s=void 0;s=0<this._bossType?0==i.rotation?this.dxcBossenemyskillDot:this.dxcBossmyskillDot:0==i.rotation?this.dxcenemyskillDot:this.dxcmyskillDot;var u=3==t.ballistic||0==t.ballistic?null:[s];3==t.ballistic&&this.watchPoint(s,i.char),this.charPlaySkill(i,n,e,u)}},i.prototype.getTargetRoleList=function(t){for(var e=new Array,i=0;t&&i<t.length;i++)e.push(this.roleMap[t[i]]);return e},i.prototype.watchPoint=function(t,e){var i=t.x-e.px,n=t.z-e.pz,o=Math.sqrt(i*i+n*n);i/=o,n/=o;var a=Math.asin(i)/Math.PI*180;n<=0&&(a=180-a),isNaN(a)||(e.forceRotationY=a)},i.prototype.skillComplete=function(e,i,n){var o=this;if(this.roleMap){for(var t=0;t<n.target.length;t++){var a=this.roleMap[n.target[t]];a&&a.hpr<=0&&this.roleDeath(a.char)}TimeUtil.addTimeOut(300,function(){if(1==tb.TB_skill_effect.get_TB_skill_effectById(i.effect).att_type){e.char.rotationY+=180,e.char.play(tl3d.CharAction.WALK,2,!1);var t=500/(o.gameScene.timespeed1+1);Laya.Tween.to(e.char,{px:e.pos.x,pz:e.pos.z},t,null,Laya.Handler.create(o,function(){e.char.rotationY=e.rotation,o.sendsucc(n.id)}))}else e.char.rotationY=e.rotation,o.sendsucc(n.id)})}},i.prototype.sendsucc=function(t){dispatchEvt(new u.FirstGuideEvent(u.FirstGuideEvent.FIRST_GUIDE_STEP_SUCC),t)},i.prototype.charDandaoPlaySkill=function(t,e,i,n){var o=this;if(void 0===n&&(n=null),t.char._scene.ready){var a=t.skillMap[e.ID];if("0"!=a.skillfile){var r=this.gameScene.scene.skillMgr.getSkill(getSkillUrl(a.skillfile),a.effectName,function(){logdebug("技能加载完成"),o.charDandaoPlaySkill(t,e,i,n)});r.keyAry&&(r&&(r.reset(),r.isDeath=!1),tl3d.PathManager.init(),r.configTrajectory(t.char,i.char,null==n?null:function(){o.skillComplete(t,e,n)}),this.gameScene.scene.skillMgr.playSkill(r))}}},i.prototype.charPlaySkill=function(t,e,i,n){var o=this;if(void 0===n&&(n=null),tb.TB_skill_effect.get_TB_skill_effectById(e.effect),t.char._scene.ready){var a=t.skillMap[e.ID];if("0"!=a.skillfile){var r=this.gameScene.scene.skillMgr.getSkill(getSkillUrl(a.skillfile),a.effectName,function(){logdebug("技能加载完成"),o.charPlaySkill(t,e,i,n)});r.keyAry&&(r&&(r.reset(),r.isDeath=!1),r.configFixEffect(t.char,function(){o.skillComplete(t,e,i)},n),this.gameScene.scene.skillMgr.playSkill(r))}}},i.prototype.showJumpText=function(t,e,i,n,o){var a=new tl3d.TextJumpUiVo;n==tl3d.TextJumpType.N_NORMALDAMAGE||n==tl3d.TextJumpType.N_CRIT?a.str="-"+i:a.str="+"+i,a.pos=new tl3d.Vector3D,a.pos.x=e.x+25,a.pos.z=e.z+25,a.pos.y=30,a.type=Number(n),a.starttime=o,a.endtime=o+1200,t.bloodMgr.setJumpNum(a)},i);function i(){var t=e.call(this)||this;return t.dxc_initHeadCamparm=[-38,35,2e3,-399,-333,-500],t.dxc_fightCamparm=[-27,-14,1623,128,-56,-500],t.dxc_victoryCamparm=[-41,184,463,26,473,11],t.dxc_enimyBadCamparm=[-35,4,1470,-45,-99,-439],t.dxc_bossBadCamparm=[-27,4,1023,-85,252,11],t.dxc_initBossCamparm=[-51,45,2e3,0,252,0],t.dxc_fightBossCamparm=[-20,0,1637,0,150,0],t.dxcmyskillDot=new tl3d.Vector3D(35,0,-1162),t.dxcenemyskillDot=new tl3d.Vector3D(34,0,-883),t.dxcBossmyskillDot=new tl3d.Vector3D(0,0,-285),t.dxcBossenemyskillDot=new tl3d.Vector3D(-28,0,51),t.myteam=[{team:1,hp:15e4,location:2,tab:tb.TB_god.get_TB_godById(3006),skill:[300670,300610],scale:1,name:"托尔",model:3106},{team:1,hp:15e4,location:3,tab:tb.TB_god.get_TB_godById(4003),skill:[400300,400310],scale:1,name:"雅典娜",model:4103},{team:1,hp:15e4,location:4,tab:tb.TB_god.get_TB_godById(3001),skill:[300100,300110],scale:1,name:"孙悟空",model:3101}],t.enemyteam=[{team:2,hp:3e5,location:4,tab:tb.TB_monster.get_TB_monsterById(2200135),skill:[2001200,2001210],scale:1.5,name:"尼德霍格",model:20012}],t.stepAry=[{id:1,type:1,guideid:1},{id:2,type:2,tarType:1,skillid:2001200,caster:"2_4",target:["1_2","1_3","1_4"],hpAry:[{id:"1_2",hp:32041},{id:"1_3",hp:35989},{id:"1_4",hp:36052}],times:3},{id:3,type:1,guideid:2},{id:4,type:2,guideid:3,tarType:1,skillid:300610,caster:"1_2",target:["2_4"],hpAry:[{id:"2_4",hp:56201}],times:1},{id:5,type:2,tarType:1,skillid:400310,caster:"1_3",target:["2_4"],hpAry:[{id:"2_4",hp:58652}],times:1},{id:6,type:2,tarType:1,skillid:300110,caster:"1_4",target:["2_4"],hpAry:[{id:"2_4",hp:68294}],times:1},{id:7,type:2,tarType:1,skillid:2001210,caster:"2_4",target:["1_2","1_3","1_4"],hpAry:[{id:"1_2",hp:91209},{id:"1_3",hp:89326},{id:"1_4",hp:88129}],times:3},{id:8,type:2,guideid:8,tarType:1,skillid:300670,caster:"1_2",target:["2_4"],hpAry:[{id:"2_4",hp:148921}],times:6,timelist:[5,8,13,17,24,33],flytimes:[0,16,33,58,94,134]},{id:9,type:4,time:2e3,amp:30},{id:10,type:1,guideid:9}],t._dxcMyPosition=[new tl3d.Vector3D(87,0,-1194),new tl3d.Vector3D(-22,0,-1201),new tl3d.Vector3D(157,0,-1105),new tl3d.Vector3D(44,0,-1129),new tl3d.Vector3D(-69,0,-1146)],t._dxcEnemyPosition=[new tl3d.Vector3D(-73,0,-1005),new tl3d.Vector3D(93,0,-829),new tl3d.Vector3D(159,0,-972),new tl3d.Vector3D(33,0,-937),new tl3d.Vector3D(43,0,-887)],t._dxcBossPosition=[new tl3d.Vector3D(-130,0,-9),new tl3d.Vector3D(-73,0,209),new tl3d.Vector3D(81,0,14),new tl3d.Vector3D(-73,0,209),new tl3d.Vector3D(0,0,168)],t._dxcBossMyPosition=[new tl3d.Vector3D(-75,0,-250),new tl3d.Vector3D(75,0,-250),new tl3d.Vector3D(0,0,-250),new tl3d.Vector3D(-70,0,-380),new tl3d.Vector3D(70,0,-380),new tl3d.Vector3D(113,0,-350)],t.width=Laya.stage.width,t.height=Laya.stage.height,t.gameScene=new Base3dSceneLayerExt,t.gameScene.scene.changeBloodManager(new BloodManagerExt),t.addChild(t.gameScene),t._sceneTransitionUi=new Laya.Image("preload/black.jpg"),t._sceneTransitionUi.x=t._sceneTransitionUi.y=0,t._sceneTransitionUi.width=Laya.stage.width,t._sceneTransitionUi.height=Laya.stage.height,t._sceneTransitionUi.alpha=0,t._sceneTransitionUi.visible=!1,Laya.stage.addChild(t._sceneTransitionUi),t._stepIdx=0,t}u.MoiveScene=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.firstguide.FirstGuideUI,__extends(n,e),n.prototype.onEndClick=function(){this.lab_info.visible&&this.endterGame()},Object.defineProperty(n.prototype,"loadcomplete",{set:function(t){(this._loadcomplete=t)&&this._anicomplete&&this.startFight()},enumerable:!0,configurable:!0}),n.prototype.LoadGuideModel=function(){var t=this;if(this.scene.gameScene){this.guideResVis(!0),this.startGuide();var o=UIMgr.getInstance();LoadeQueue.getInstance().loadAll(this.scene.gameScene,this.skillKey,[3106,20012,3101,4103],[888888,1029,1024,1000003],"scene012",function(t,e){var i=0==e?10545:1==e?10546:2==e?10547:3==e?10548:-1,n=LanMgr.getLan("",i);o.loadingProcess(t,n)},function(){o.hideLoading(),t.loadcomplete=!0,t.scene.initRoles(),t.scene.refreshEnemy(1,2)})}},n.prototype.guideResVis=function(t){this.img_pic1.visible=this.img_pic2.visible=this.img_pic3.visible=this.box_info1.visible=this.box_info2.visible=this.box_info3.visible=this.box_info4.visible=t,this.img_bg.visible=t},n.prototype.preLoadSkill=function(){for(var t=0;t<this.skillKey.length;t++)this.scene.gameScene.scene.skillMgr.preLoadSkill(getSkillUrl(this.skillKey[t]))},n.prototype.startGuide=function(){this.ani1.play(0,!1)},n.prototype.onAniComplete=function(){var t=this;this._anicomplete=!0,setTimeout(function(){t.lab_info.visible=!0,t._autoenter=setTimeout(function(){t.endterGame()},3e3)},1e3)},n.prototype.endterGame=function(){clearTimeout(this._autoenter),this.lab_info.visible=!1,this.guideResVis(!1),this._loadcomplete?this.startFight():UIMgr.getInstance().showLoading()},n.prototype.startFight=function(){this._fightstart||this.initFight()},n.prototype.initFight=function(){var t=this;this._fightstart=!0,this.scene.initCam(this.scene.dxc_initBossCamparm),setTimeout(function(){t.scene.tweenCam(5,function(){t.fightNext(0),i.GuideManager.startFightGuide(),dispatchEvt(new i.LoginLoadEvent(i.LoginLoadEvent.LOADHUD_EVENT),!0)})},500)},n.prototype.fightNext=function(t){var e=this;t>=this.scene.stepAry.length-1?setTimeout(function(){e.close(),e.scene.gameScene.scene.skillMgr.shock.clearShock(),dispatchEvt(new i.LoginLoadEvent(i.LoginLoadEvent.ENTERHUD_EVENT),e.scene.stepAry.length+1)},100):this.scene.nextStep(t)},n.prototype.onOpened=function(){e.prototype.onOpened.call(this),this._fightstart=!1,this.lab_info.visible=!1,this.scene.gameScene.timespeed1=.3,AudioMgr.setPlayRate(1.3),this.loadcomplete=!1,this._anicomplete=!1,this.LoadGuideModel()},n.prototype.setBossBlood=function(t){var e=this,i=t/100*538;if(!this.box_blood.visible&&0<t)return this.box_blood.visible=!0,this.img_blood.width=i,this.img_pross.width=i,void(this._bossblood=t);Laya.Tween.clearTween(this.img_blood),Laya.Tween.clearTween(this.img_pross),this._bossblood<t?(this.img_pross.width=i,Laya.Tween.to(this.img_blood,{width:i},500,null,Laya.Handler.create(this,function(){e.box_blood.visible=0<t}))):this._bossblood>t&&(this.img_blood.width=i,Laya.Tween.to(this.img_pross,{width:i},500,null,Laya.Handler.create(this,function(){e.box_blood.visible=0<t}))),this._bossblood=t},n.prototype.show=function(){e.prototype.show.call(this)},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),AudioMgr.setPlayRate(1),clearTimeout(this._autoenter),this.scene.gameScene.timespeed1=0},n);function n(){var t=e.call(this)||this;return t.skillKey=["1010110","300060","300010","400030"],t.scene=new i.MoiveScene,t.addChildAt(t.scene,0),t.img_bg.width=Laya.stage.width,t.img_bg.height=Laya.stage.height,t.ani1.on(Laya.UIEvent.COMPLETE,t,t.onAniComplete),t.img_bg.on(Laya.Event.CLICK,t,t.onEndClick),t}i.FirstGuideView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=tl3d.Processor,__extends(n,t),n.prototype.getName=function(){return"FirstGuideProcessor"},n.prototype.listenModuleEvents=function(){return[new e.FirstGuideEvent(e.FirstGuideEvent.FIRST_GUIDE_STEP_SUCC),new e.FirstGuideEvent(e.FirstGuideEvent.CHANGE_BOSSBLOOD)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.FirstGuideEvent)switch(t.type){case e.FirstGuideEvent.CHANGE_BOSSBLOOD:null!=t.data&&t.data.type!=iface.tb_prop.copyTypeKey.main&&this.changeBossBlood(t.data.vo);break;case e.FirstGuideEvent.FIRST_GUIDE_STEP_SUCC:this.stepsucc(t.data)}},n.prototype.stepsucc=function(t){this.fightview&&this.fightview.fightNext(t)},n.prototype.changeBossBlood=function(t){this.fightview&&this.fightview.setBossBlood(t)},Object.defineProperty(n.prototype,"fightview",{get:function(){return UIMgr.hasStage(UIConst.FirstGuide)?UIMgr.getUIByName(UIConst.FirstGuide):null},enumerable:!0,configurable:!0}),n);function n(){return t.call(this)||this}e.FirstGuideProcessor=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"FirstGuideModule"},n.prototype.listProcessors=function(){return[new t.FirstGuideProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.FirstGuideModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.GUIDE_START="GUIDE_START",r.FIGHT_SKILL_SELECT="FIGHT_SKILL_SELECT",r.CHANGE_BOSSBLOOD="CHANGE_BOSSBLOOD",r.FIRST_GUIDE_STEP_SUCC="FIRST_GUIDE_STEP_SUCC",r.FIRST_GUIDE_SELECT_TAR_SUCC="FIRST_GUIDE_SELECT_TAR_SUCC",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.FirstGuideEvent=a}(game=game||{}),(game||(game={})).sStep=function(t,e){this.step=t,this.skillId=e},function(n){var t=(e.prototype.deleteBuff=function(t){var e=this.buffAry.indexOf(t);-1!=e&&this.buffAry.splice(e,1)},e.prototype.deathFun=function(){for(;0<this.delayList.length;){var t=this.delayList.shift();this.scene.onPlay(t.step,t.skillId)}this.deadIng=!1,this.scene.removeStep("dead"+this.objId)},e.prototype.deathTimeOut=function(){this.char&&this.hpr<=0&&this.char.onStage&&(this.char.shadow=!1,this.char.removeChar())},Object.defineProperty(e.prototype,"hpr",{get:function(){return this._hpr},set:function(t){var e=this;if(logyhj("血量百分比,",t,this.objId),(this._hpr=t)<=0){if(t=0,!this.char.onStage)return;clearTimeout(this._deathFunKey),this.char.play(tl3d.CharAction.DEATH,1,!1),this.deadIng=!0,this.scene.tagStep("dead"+this.objId),this.onDead&&this.onDead.call(null,this.objId);var i=this.getresultTime(frame2time(this.tab.death_frame));this._deathFunKey=setTimeout(function(){e.deathFun(),e.deathTimeOut()},i)}else tl3d.TimeUtil.hasTimeOut(this.deathTimeOut.bind(this))&&tl3d.TimeUtil.removeTimeOut(this.deathTimeOut.bind(this)),tl3d.TimeUtil.hasTimeOut(this.deathFun.bind(this))&&tl3d.TimeUtil.removeTimeOut(this.deathFun.bind(this)),this.char.onStage?this.char.curentAction==tl3d.CharAction.DEATH&&this.char.play(tl3d.CharAction.STANAD,2,!1):(this.scene.gameScene.scene.addMovieDisplay(this.char),this.char.scale=1,this.tab instanceof tb.TB_monster?(this.char.scale=this.tab.model_multiple,this.tab.type<=0&&this.initCharBlood()):this.tab instanceof tb.TB_god&&this.initCharBlood(),this.char.shadow=!0,this.char.setShadowSize(6),this.char.rotationY=this.rotation,this.char.visible=!0,this.char.play(tl3d.CharAction.STANAD,2,!1));logfight("角色：",this.objId,this.tab.name,"当前血量：",this._hp,"百分比:",t)},enumerable:!0,configurable:!0}),e.prototype.getresultTime=function(t){return t/(this.scene.gameScene.timespeed1+1)},e.prototype.initCharBlood=function(){this.char.bloodEnableExt=!0,this.char.setbloodColor(this.isPlayer),this.char.buffEnable=!0,this.char.roleLevEnable=!0,this.char.setBloodExtOffsetX(10),this.char.setroleLev(this.lev,this.tab.race_type)},Object.defineProperty(e.prototype,"hp",{get:function(){return this._hp},set:function(t){this._hp=t,this._hp=Math.min(this._hp,this.hpMax),this._hp=Math.max(this._hp,0);var e=Math.ceil(this._hp/this.hpMax*100);if(this.hpr=e,logfight("角色：",this.objId,this.tab.name,"当前血量：",this._hp,"百分比:",e),this.tab instanceof tb.TB_monster&&0<this.tab.type)dispatchEvt(new n.FightsEvent(n.FightsEvent.CHANGE_BOSSBLOOD),{vo:e,info:Math.floor(this.hp)+"/"+Math.floor(this.hpMax)});else{var i=0;0<e&&(i=e<5?5:e),this.char.lifenumExt=i}},enumerable:!0,configurable:!0}),e.prototype.showJumpText=function(t){this.flyTextList||(this.flyTextList=new Array,this.flying=!1),this.flyTextList.push(t),this.flying||this.startShow()},e.prototype.startShow=function(){if(this.flyTextList&&0<this.flyTextList.length){this.flying=!0;var t=this.flyTextList.shift();this.JumpPiecewiseOpt(t,tl3d.TimeUtil.getTimer(tl3d.TimeUtil.START_TIME)),Laya.timer.once(100,this,this.startShow)}else this.flying=!1},e.prototype.JumpPiecewiseOpt=function(t,e){void 0===t.skillid||t.type!=tl3d.TextJumpType.N_NORMALDAMAGE&&t.type!=tl3d.TextJumpType.N_CRIT&&t.type!=tl3d.TextJumpType.N_UPHP?this.playJumpText(t.value,t.type,e):this.onPiecewise(t,e)},e.prototype.onPiecewise=function(n,t){var o=this,e=tb.TB_skill.get_TB_skillById(n.skillid);if(0<e.effect){var a=tb.TB_skill_effect.get_TB_skill_effectById(e.effect),r=a.damage_section&&a.damage_section.length==a.frame.length-1,s=a.frame.length-1;if(2<a.frame.length){function i(){var t=0;if(r){var e=perc2num(a.damage_section[d-1]);t=d==s?c-l:e*c}else t=d==s?c-l:(u=utils.random(90,110)/100,c/s*u);t=Math.floor(t),l+=t;var i=p.getresultTime(frame2time(a.frame[d]-h));setTimeout(function(){o.hp+=t,logfight("分段同步血量：",o.hp),o.playJumpText(t,n.type,tl3d.TimeUtil.getTimer(tl3d.TimeUtil.START_TIME))},i)}for(var u,h=a.frame[1],l=0,c=n.value,p=this,d=1;d<a.frame.length;d++)i()}else this.playJumpText(n.value,n.type,t);this.char&&n.type==tl3d.TextJumpType.N_CRIT&&this.char._scene.skillMgr.shock.shock(300,10)}else this.playJumpText(n.value,n.type,t)},e.prototype.playJumpText=function(t,e,i){if(this.char){var n=new tl3d.TextJumpUiVo;n.pos=new tl3d.Vector3D(this.char.px,30,this.char.pz),n.type=Number(e),n.str=String(t),n.type!=tl3d.TextJumpType.N_PASSIVE&&n.type!=tl3d.TextJumpType.N_UPHP||(n.str="+"+n.str),n.starttime=i,n.endtime=i+900,this.scene.gameScene.scene.bloodMgr.setJumpNum(n),this.playInjured(e)}},e.prototype.playInjured=function(t){t!=tl3d.TextJumpType.N_NORMALDAMAGE&&t!=tl3d.TextJumpType.N_CRIT||this.char&&this.scene&&this.scene.gameScene&&(this.beatWitheFilter(),this.scene.gameScene.addEffect(this,1029,new tl3d.Vector3D(this.char.px,this.char.py+50,this.char.pz),2,30,null,0,0,!0),this.char.curentAction!=tl3d.CharAction.STANAD&&this.char.play(tl3d.CharAction.STANAD,2,!1),0<this.hpr?this.char.play(tl3d.CharAction.INJURED,2,!1):this.char.play(tl3d.CharAction.DEATH,1,!1))},e.prototype.beatWitheFilter=function(){var t=this;clearTimeout(this._tickw),this.char.changeColor=[100,10,10,.7],this._tickw=setTimeout(function(){t.char.changeColor=[1,1,1,t.char.alpha]},150)},e.prototype.beatRedFilter=function(){var t=this;clearTimeout(this._tickr),this.char.changeColor=[100,0,0,.7],this._tickr=setTimeout(function(){t.char.changeColor=[1,1,1,t.char.alpha]},150)},e.prototype.onDispose=function(){clearTimeout(this._tickw),clearTimeout(this._tickr),this.buffAry=[],this.char.destory(),this.char=null},e.prototype.setAnger=function(t){this.char&&(this.tab instanceof tb.TB_monster&&0<this.tab.type?dispatchEvt(new n.FightsEvent(n.FightsEvent.CHANGE_BOSSANGER),t):this.char.setAnger(t))},e);function e(){this._hp=0,this.deadIng=!1,this.delayList=[]}n.SceneGodVo=t}(game=game||{}),(game||(game={})).GodBuffVo=function(){},(game||(game={})).FlyText=function(){},function(d){var t=(e.prototype.getMapid=function(){switch(this.copyType){case iface.tb_prop.copyTypeKey.rune:case iface.tb_prop.copyTypeKey.underground:case iface.tb_prop.copyTypeKey.tower:return this.tab_copyinfo.scene;case CopyType.glory:return tb.TB_honour_set.getSet().scene;case CopyType.jingji_pve:case CopyType.jingji_record:case CopyType.qiecuo:return tb.TB_arena_new_set.getArenaNewSet().map;case CopyType.arenaMatch:return tb.TB_match_set.getSet().map;case CopyType.dailycopy:return tb.TB_copy_set.getCopySet().daily_copymap;case CopyType.yuanzhenCopy:return tb.TB_copy_set.getCopySet().expedition_map;case CopyType.fogForest:return tb.TB_forest_set.getSet().scene;case CopyType.worldboss:return tb.TB_boss_set.getSet().map;case CopyType.escort:return tb.TB_escort_set.getSet().scene;case CopyType.guildFight:return tb.TB_guild_war_set.getSet().scene;case CopyType.guildCopy:return tb.TB_guild_set.getSet().map;case CopyType.island:return tb.TB_island_set.getSet().scene;case CopyType.godDomain:return tb.TB_fight_goddomain_set.getSet().map;case CopyType.teamCopy:return tb.TB_team_set.getTB_team_set().map;default:return 23}},e.prototype.getCamp=function(){switch(this.copyType){case CopyType.godDomain:return this.godDomainVo.getSelfCamp();case CopyType.glory:return this.gloryMatchVo.getSelfCamp();default:return battle.BatteConsts.BATTLE_CAMPATK}},e.prototype.guochangAction=function(){switch(this.copyType){case CopyType.godDomain:return tl3d.CharAction.ATTACK_01;case CopyType.teamCopy:return tl3d.CharAction.STANAD;default:return tl3d.CharAction.WALK}},e.prototype.fightStart=function(t,e){var i=null;switch(this.copyType){case CopyType.godDomain:var n=this.godDomainVo.getFightTeams(this.fightPageControl.curwave-1);if(i={optType:t,vo:{leftInfo:this.godDomainVo.leftInfo,rightInfo:this.godDomainVo.rightInfo,teams:n,selfCamp:this.getCamp()},cb:e},UIMgr.hasStage(UIConst.GodDomain_FightStart)){var o=UIMgr.getUIByName(UIConst.GodDomain_FightStart);o.dataSource=i,o.refresh()}else UIMgr.showUI(UIConst.GodDomain_FightStart,i);break;case CopyType.teamCopy:var a=this.copyTeamFightVo.getShowMonsterVo();a&&(a.force=this.getEnemyForce());var r=this.copyTeamFightVo.getPosMember(this.fightPageControl.curwave-1);if(r){var s=null,u=r.lineupInfo[0];for(var h in u)if(u[h]){s=u[h];break}s&&(r.modelId=d.GodUtils.getShowGodModel(s[0],s[6]))}if(i={optType:t,vo:{leftInfo:r,rightInfo:a},cb:e},UIMgr.hasStage(UIConst.CopyTeamFightStart)){var l=UIMgr.getUIByName(UIConst.CopyTeamFightStart);l.dataSource=i,l.refresh()}else UIMgr.showUI(UIConst.CopyTeamFightStart,i);break;default:var c=!1;if(this.copyType==iface.tb_prop.copyTypeKey.rune&&0==this.tab_copyinfo.boss_icon&&(c=!0),i={optType:t,cb:e,isBoss:this.copyType==CopyType.guildCopy||this.copyType==CopyType.worldboss||this.copyType==iface.tb_prop.copyTypeKey.rune&&0<this.tab_copyinfo.boss_icon,isJy:c},UIMgr.hasStage(UIConst.General_FightStart)){var p=UIMgr.getUIByName(UIConst.General_FightStart);p.dataSource=i,p.refresh()}else UIMgr.showUI(UIConst.General_FightStart,i)}},e.prototype.getTotalWave=function(){return this.fightPageControl.getWaveNum()},e.prototype.getEnemyIdAry=function(){var t=new Array;switch(this.copyType){case iface.tb_prop.copyTypeKey.rune:case iface.tb_prop.copyTypeKey.underground:case iface.tb_prop.copyTypeKey.tower:return this.tab_copyinfo.monster;case CopyType.teamCopy:return this.copyTeamFightVo.getMonster();case CopyType.qiecuo:return[this.qiecuoVo.getLineupGodIds()];case CopyType.dailycopy:return[this.dailyCopyInfo.tbCopy.monster];case CopyType.yuanzhenCopy:return[this.yuanzhengCopyVo.getLineupGodIds()];case CopyType.fogForest:return this.forestGuanqia.tbForest.monster;case CopyType.worldboss:return[this.worldBossInfo.tbBoss.monster];case CopyType.escort:for(var e=this.caravanInfoVo.lineupInfo[0],i=0;i<e.length;i++){var n=e[i];t.push(n&&3<n.length?n[0]:0)}return[t];case CopyType.guildFight:return[this.guildMemberVo.getLineupGodIds()];case CopyType.guildCopy:return[this.guildGuanqiaVo.tbCopy.moster];case CopyType.island:return[this.islandOreInfo.getLineupGodIds()]}return[]},e.prototype.getFightName=function(){switch(this.copyType){case iface.tb_prop.copyTypeKey.rune:return d.GuajiModel.getInstance().copyName[this.tab_copy.sub_type]+" "+this.tab_copy.chapter+"-"+this.tab_copyinfo.area_number;case iface.tb_prop.copyTypeKey.underground:case iface.tb_prop.copyTypeKey.tower:return this.tab_copyinfo.name;case CopyType.glory:return LanMgr.getLan("",12413);case CopyType.arenaMatch:return LanMgr.getLan("",12414);case CopyType.jingji_pve:case CopyType.jingji_record:return LanMgr.getLan("",12415);case CopyType.qiecuo:return LanMgr.getLan("",12416);case CopyType.dailycopy:return LanMgr.getLan("",12417);case CopyType.yuanzhenCopy:return LanMgr.getLan("",12418)+" "+this.yuanzhengCopyVo.guanqiaVo.tbCopy.ID+LanMgr.getLan("",12419);case CopyType.fogForest:return LanMgr.getLan("",12420)+" "+this.forestGuanqia.tbForest.ID+LanMgr.getLan("",12419);case CopyType.worldboss:return LanMgr.getLan("",12421);case CopyType.escort:return LanMgr.getLan("",12422);case CopyType.guildFight:return LanMgr.getLan("",12423);case CopyType.guildCopy:return LanMgr.getLan("",12424);case CopyType.island:return LanMgr.getLan("",12425);case CopyType.godDomain:return LanMgr.getLan("",12426);case CopyType.teamCopy:return LanMgr.getLan("",12427);default:return"xxx"}},e.prototype.getWaveAndWave=function(){return this.fightPageControl.getTitle()},e.prototype.getMaxWave=function(){return this.fightPageControl.getWaveNum()},e.prototype.getAllRound=function(){switch(this.copyType){case CopyType.jingji_pve:case CopyType.jingji_record:case CopyType.jingji_npc:return tb.TB_arena_new_set.getArenaNewSet().round_max;case CopyType.guildCopy:return tb.TB_guild_set.getSet().round_max;case CopyType.worldboss:return tb.TB_boss_set.getSet().round_max;case CopyType.arenaMatch:return tb.TB_match_set.getSet().round_max;case CopyType.godDomain:return tb.TB_fight_goddomain_set.getSet().time;default:return tb.TB_copy_set.getCopySet().round_max}},e.prototype.getNextRound=function(){return this.fightPageControl.getNextRound()},e.prototype.canJump=function(){var t=this.getConfigSet();return!!t&&1==t.is_skip},e.prototype.getConfigSet=function(){var t=19;switch(this.copyType){case iface.tb_prop.copyTypeKey.rune:t=1;break;case iface.tb_prop.copyTypeKey.underground:t=3;break;case iface.tb_prop.copyTypeKey.tower:t=2;break;case CopyType.glory:t=13;break;case CopyType.arenaMatch:t=this.arenaMatchVo.isRecord()?17:14;break;case CopyType.godDomain:t=18;break;case CopyType.jingji_record:t=5;break;case CopyType.jingji_pve:t=4;break;case CopyType.qiecuo:t=16;break;case CopyType.dailycopy:t=9;break;case CopyType.yuanzhenCopy:t=6;break;case CopyType.fogForest:t=8;break;case CopyType.worldboss:t=12;break;case CopyType.escort:t=7;break;case CopyType.guildFight:t=11;break;case CopyType.guildCopy:t=10;break;case CopyType.island:t=15;break;case CopyType.teamCopy:t=20}return 19==t&&logerror("-----------------为找到相应的战斗id-------------------"),tb.TB_copy_config.getSet(t)},e.prototype.getOwnForce=function(){switch(this.copyType){case iface.tb_prop.copyTypeKey.rune:case iface.tb_prop.copyTypeKey.tower:case CopyType.jingji_pve:case CopyType.qiecuo:case CopyType.dailycopy:case CopyType.fogForest:case CopyType.worldboss:case CopyType.escort:case CopyType.guildFight:case CopyType.guildCopy:case CopyType.island:return App.hero.force;case CopyType.arenaMatch:return this.arenaMatchVo.getForce();case CopyType.glory:return this.gloryMatchVo.svo.leftForce;case CopyType.jingji_record:return this.arenaReportVo.force;case CopyType.yuanzhenCopy:return getLineupForce(this.getOwnTeam());case CopyType.godDomain:var t=this.godDomainVo.getFightTeams(this.fightPageControl.curwave-1);return(this.getCamp()==battle.BatteConsts.BATTLE_CAMPATK?this.godDomainVo.leftInfo[t[0]]:this.godDomainVo.rightInfo[t[1]]).force;case CopyType.teamCopy:return this.copyTeamFightVo.getCurAtkForce(this.fightPageControl.curwave-1);default:return 0}},e.prototype.getEnemyForce=function(){switch(this.copyType){case iface.tb_prop.copyTypeKey.rune:case iface.tb_prop.copyTypeKey.tower:case CopyType.dailycopy:case CopyType.fogForest:case CopyType.worldboss:case CopyType.guildCopy:var t=this.getEnemyTeam()[this.fightPageControl.curwave-1];if(!t)return 0;var e=t[0];return this.calMonsterForce(e);case CopyType.jingji_pve:return this.arenaReportVo.force;case CopyType.qiecuo:return this.qiecuoVo.svo.force;case CopyType.arenaMatch:return this.arenaMatchVo.getTagForce();case CopyType.escort:return this.caravanInfoVo.svo.force;case CopyType.guildFight:return this.guildMemberVo.svo.force;case CopyType.island:return this.islandOreInfo.svo.force;case CopyType.glory:return this.gloryMatchVo.svo.rightForce;case CopyType.jingji_record:return this.arenaReportVo.targetforce;case CopyType.yuanzhenCopy:return this.yuanzhengCopyVo.svo.force;case CopyType.godDomain:var i=this.godDomainVo.getFightTeams(this.fightPageControl.curwave-1);return(this.getCamp()==battle.BatteConsts.BATTLE_CAMPATK?this.godDomainVo.rightInfo[i[1]]:this.godDomainVo.leftInfo[i[0]]).force;case CopyType.teamCopy:var n=this.getEnemyTeam()[0];if(!n)return 0;var o=n[0];return this.calMonsterForce(o);default:return 0}},e.prototype.calMonsterForce=function(t){for(var e=null,i=0,n=0;t&&n<t.length;n++){var o=t[n];o&&(e=tb.TB_god.get_TB_godById(Number(o[0])),i+=getForce(o[3],e?e.quality:1))}return i},e.prototype.getTeamLineup=function(){switch(this.copyType){case CopyType.yuanzhenCopy:return iface.tb_prop.lineupTypeKey.expedition;default:return iface.tb_prop.lineupTypeKey.attack}},e.prototype.getTeamHp=function(){var t={};switch(this.copyType){case CopyType.yuanzhenCopy:for(var e=this.yuanzhengCopyVo.getSelfGodsHp(),i=0;i<e.length;i++)t[100*battle.BatteConsts.BATTLE_CAMPATK+(i+1)]=e[i];for(var n=this.yuanzhengCopyVo.getEnemyGodsHpAry(),o=0;o<n.length;o++)t[100*battle.BatteConsts.BATTLE_CAMPDEF+(o+1)]=n[o];return logfight("战斗初始化血量：",t),isEmptyObject(t)?null:t;case CopyType.worldboss:for(var a=this.worldBossInfo.getMonstersHp(),r=0;r<a.length;r++)t[100*battle.BatteConsts.BATTLE_CAMPDEF+(r+1)]=a[r];return logfight("战斗初始化血量：",t),isEmptyObject(t)?null:t;case CopyType.guildFight:for(var s=this.guildMemberVo.getEnemyGodsHpAry(),u=0;u<s.length;u++)t[100*battle.BatteConsts.BATTLE_CAMPDEF+(u+1)]=s[u];return logfight("战斗初始化血量：",t),isEmptyObject(t)?null:t;case CopyType.guildCopy:for(var h=this.guildGuanqiaVo.getMonstersHp(),l=0;l<h.length;l++)t[100*battle.BatteConsts.BATTLE_CAMPDEF+(l+1)]=h[l];return logfight("战斗初始化血量：",t),isEmptyObject(t)?null:t;default:return null}},e.prototype.getFightVo=function(){switch(this.copyType){case CopyType.qiecuo:return this.qiecuoVo;case CopyType.guildFight:return this.guildMemberVo;case CopyType.yuanzhenCopy:return this.yuanzhengCopyVo;case CopyType.escort:return this.caravanInfoVo;case CopyType.island:return this.islandOreInfo;default:return null}},e.prototype.getEnemyShenQi=function(){var t=this.getFightVo();if(t){var e=t.shenqiVo;return e&&2<=e.length?e:[]}return[]},e.prototype.getMyShenQi=function(){var t=this.getTeamLineup();if(App.hero.lineupArtifactInfo.hasOwnProperty(t)){var e=Number(App.hero.lineupArtifactInfo[t]);if(0<e)return[e,App.hero.artifactSkillLv,App.hero.artifactStrengthLv]}return[]},e.prototype.getOwnTeam=function(){for(var t=this.getTeamLineup(),e=new Array,i=App.hero.getLineUpTeam(t,!0),n=0;n<i.length;n++){var o=i[n];if(o){var a=null;if(o.isAid){var r=d.YuanzhengModel.getInstance().getHelpItemByUuid(o.uuid);(a=r?r.godInfo:null)&&(a[7]=String(o.templateId))}else(a=new Array).push(o.templateId),a.push(o.starLevel),a.push(o.level),a.push(o.getFightAttr(t)),a.push(o.degree),a.push(o.awakenLv),a.push(o.skinId),a.push(o.uuid);e.push(a)}else e.push(null)}return[e,this.getMyShenQi()]},e.prototype.getHeadData=function(){var t={ownName:App.hero.name,enemyName:"异常啦",ownLevel:App.hero.level,enemyLevel:0,ownTeam:{},enemyTeam:{},ownForce:0,enemyForce:0,title:this.getFightName()};switch(this.copyType){case CopyType.qiecuo:this.setHeadData(t,1,this.qiecuoVo.svo.level,this.qiecuoVo.svo.name);break;case CopyType.escort:this.setHeadData(t,1,this.caravanInfoVo.svo.level,this.caravanInfoVo.svo.name);break;case CopyType.yuanzhenCopy:this.setHeadData(t,1,this.yuanzhengCopyVo.svo.level,this.yuanzhengCopyVo.svo.name);break;case CopyType.guildFight:this.setHeadData(t,1,this.guildMemberVo.svo.level,this.guildMemberVo.svo.name);break;case CopyType.island:this.setHeadData(t,1,this.islandOreInfo.svo.level,this.islandOreInfo.svo.playerName);break;case CopyType.glory:this.setHeadData(t,2,this.gloryMatchVo.svo.leftLevel,this.gloryMatchVo.svo.leftName),this.setHeadData(t,1,this.gloryMatchVo.svo.rightLevel,this.gloryMatchVo.svo.rightName);break;case CopyType.arenaMatch:this.setHeadData(t,1,this.arenaMatchVo.level,this.arenaMatchVo.name);break;case CopyType.jingji_pve:case CopyType.jingji_record:this.setHeadData(t,1,10,this.arenaReportVo.name);break;case CopyType.godDomain:var e=this.godDomainVo.getFightTeams(this.fightPageControl.curwave-1),i=this.getCamp()==battle.BatteConsts.BATTLE_CAMPATK,n=i?this.godDomainVo.leftInfo[e[0]]:this.godDomainVo.rightInfo[e[1]],o=i?this.godDomainVo.rightInfo[e[1]]:this.godDomainVo.leftInfo[e[0]];this.setHeadData(t,2,n.level,n.name),this.setHeadData(t,1,o.level,o.name);break;case CopyType.teamCopy:this.copyTeamFightVo.setHeadData(t,this.fightPageControl.curwave-1);break;default:for(var a=void 0,r=void 0,s=this.getEnemyIdAry(),u=0;u<s.length;u++)for(var h=s[u],l=0;l<h.length;l++){var c=Number(h[l]);if(r){if((a=tb.TB_monster.get_TB_monsterById(c))&&0<a.type){r=a;break}}else if((r=tb.TB_monster.get_TB_monsterById(c))&&0<r.type)break}r&&this.setHeadData(t,1,r.level,r.name)}var p=this.fightPageControl.getWaveObj();for(var d in p)"1"==d?t.ownTeam=this.doHalo(p[d]):t.enemyTeam=this.doHalo(p[d]);return t.ownForce=Math.ceil(this.getOwnForce()),t.enemyForce=Math.ceil(this.getEnemyForce()),t},e.prototype.doHalo=function(t){var e,i,n={},o={},a=[0,0,0,0,0,0];for(var r in t)for(var s in t[r])e=t[r][s],a[(i="god"==r?tb.TB_god.get_TB_godById(e):tb.TB_monster.get_TB_monsterById(e)).race_type]++,n[s]={race:i.race_type,active:!1};var u=TableData.getInstance().getTableByName(TableData.tb_halo).data;for(var h in u){e=u[h].type;var l=Math.floor(e/tb.TB_halo.TYPE_BASE),c=e%tb.TB_halo.TYPE_BASE;0==l?0<a[1]&&0<a[2]&&0<a[3]&&0<a[4]&&0<a[5]&&(o[l]=c):a[l]>=c&&(!o.hasOwnProperty(l)||o[l]<c)&&(o[l]=c)}for(var r in o)this.resetRaceAct(n,r,o[r]);return{lineup:n,teamInfo:o}},e.prototype.resetRaceAct=function(t,e,i){var n=null,o=0;if(0==Number(e))for(var a in t)t[a].active=!0;else for(var a in t)(n=t[a]).race==Number(e)&&o<Number(i)&&(n.active=!0,o++)},e.prototype.setHeadData=function(t,e,i,n){1==e?(t.enemyLevel=i,t.enemyName=n):(t.ownLevel=i,t.ownName=n)},e.prototype.getEnemyTeam=function(){switch(this.copyType){case CopyType.qiecuo:return[this.qiecuoVo.lineupInfo];case CopyType.escort:return[this.caravanInfoVo.lineupInfo];case CopyType.yuanzhenCopy:return[this.yuanzhengCopyVo.lineupInfo];case CopyType.guildFight:return[this.guildMemberVo.lineupInfo];case CopyType.island:return[this.islandOreInfo.lineupInfo];default:return this.resetList()}},e.prototype.resetList=function(){for(var t=new Array,e=this.getEnemyIdAry(),i=0;i<e.length;i++){for(var n=e[i],o=new Array,a=0;a<n.length;a++){var r=Number(n[a]);if(0!=r){var s=void 0,u={},h=0,l=0,c=[];switch(this.copyType){case iface.tb_prop.copyTypeKey.rune:case iface.tb_prop.copyTypeKey.underground:case iface.tb_prop.copyTypeKey.tower:case CopyType.dailycopy:case CopyType.fogForest:case CopyType.worldboss:case CopyType.guildCopy:case CopyType.teamCopy:if(!(s=tb.TB_monster.get_TB_monsterById(r))){logerror("怪物不存在:%d",r);continue}l=s.star,u=ary2map(s.attr),h=s.level;var p=modifyPasvAttr(s.skill),d=p[0],_=p[1],f=void 0,g=void 0;for(var y in d)f=d[y]||0,g=_[y]||0,u[y]=calAddAttr(y,f,g,u[y]),c.push(y);for(var y in _)-1==c.indexOf(y)&&(f=d[y]||0,g=_[y]||0,u[y]=calAddAttr(y,f,g,u[y]))}var m=new Array;m.push(r),m.push(l),m.push(h),m.push(u),m.push(999),m.push(999),m.push(0),m.push(s.ID),o.push(m)}else o.push(null)}t.push([o,this.getEnemyShenQi()])}return t},e.prototype.getCopyId=function(){switch(this.copyType){case iface.tb_prop.copyTypeKey.rune:case iface.tb_prop.copyTypeKey.underground:case iface.tb_prop.copyTypeKey.tower:return this.tab_copyinfo.ID;case CopyType.guildCopy:return this.guildGuanqiaVo.tbCopy.ID;case CopyType.worldboss:return this.worldBossInfo.tbBoss.ID;case CopyType.dailycopy:return this.dailyCopyInfo.tbCopy.ID;case CopyType.yuanzhenCopy:return this.yuanzhengCopyVo.guanqiaVo.tbCopy.ID;case CopyType.escort:return this.caravanInfoVo.tbEscort.ID;case CopyType.fogForest:return this.forestGuanqia.tbForest.ID;case CopyType.island:return this.islandOreInfo.tbOre.ID;case CopyType.teamCopy:return this.copyTeamFightVo.copyFloor}},e.prototype.turnTemplatID=function(t){switch(this.copyType){case iface.tb_prop.copyTypeKey.rune:case iface.tb_prop.copyTypeKey.underground:case iface.tb_prop.copyTypeKey.tower:case CopyType.guildCopy:var e={},i=this.getEnemyIdAry()[0];for(var n in t)e[i[Number(n)%10-1]]=t[n];return e;default:var o=this.getFightVo();return o?o.turnTemplatID(t):null}},e);function e(){}d.FightVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var n,t=(n=ui.fight.shengliUI,__extends(e,n),e.prototype.popup=function(){this.box_content.visible=!1,this.bgPanel.showTitle(!0,"zhandoubiaoxian/shengli.png",!0,!0,!0,Handler.create(this,this.showTitleComplete));var t=this.dataSource.copyVo.vo,e=this.dataSource.vo;t.copyType==CopyType.teamCopy?e&&e.extReward&&(this.ary=e.extReward):(e&&e.commonData&&UIUtil.getRewardItemVoList(this.ary,e.commonData),e&&e.firstData&&UIUtil.getRewardItemVoList(this.ary,e.firstData,!0));var i=0<this.ary.length;this.box_title.visible=this.imgXian.visible=i,this.lab_empty.visible=!this.box_title.visible,i?(this.btn_close.y=this.btn_again.y=366,this.height=500):(this.btn_close.y=this.btn_again.y=196,this.height=330),this.showbtn(i),this.listVo._dataSource=this.list_item.array=this.ary,this.list_item.AutoLayout(this.width),this.listVo.setHeight(200),this.listVo.setPosition(this.list_item.x+(Laya.stage.width-this.width)/2,(Laya.stage.height-this.height)/2+this.list_item.y),this.listVo._height=this.list_item.height,this.mouseEnabled=!0,this.chk_next.on(Laya.Event.CHANGE,this,this.onChkChange),n.prototype.popup.call(this,!1,!1)},e.prototype.showTitleComplete=function(){this.box_content.visible=!0,this._efflist=common.EffectList.showEffectList(this.listVo)},e.prototype.onOpened=function(){n.prototype.onOpened.call(this),this.again=!1,AudioMgr.setPlayRate(1),AudioMgr.playSound("sound/victory.mp3")},e.prototype.showbtn=function(t){void 0===t&&(t=!1);var e=this.dataSource.copyVo.vo;this.lab_time.visible=this.lab_txt.visible=e.copyType==iface.tb_prop.copyTypeKey.main;var i=-1==[CopyType.teamCopy,iface.tb_prop.copyTypeKey.main,CopyType.jingji_npc,CopyType.qiecuo,CopyType.escort,CopyType.island,CopyType.guildFight].indexOf(e.copyType);switch(this.btn_close.x=i?174:282,this.btn_again.visible=i,this.btn_again.gray=!1,this.lbDesc.text="",this.chk_next.visible=!1,e.copyType){case iface.tb_prop.copyTypeKey.rune:this.btn_close.x=282,this.btn_again.visible=!1;break;case iface.tb_prop.copyTypeKey.underground:this.btn_again.label=LanMgr.getLan("",12571);break;case CopyType.dailycopy:this.btn_close.x=282,this.btn_again.visible=!1;break;case iface.tb_prop.copyTypeKey.tower:var n=tb.TB_copy_info.get_TB_copy_infoById(e.tab_copyinfo.next);this.btn_again.label=LanMgr.getLan("",12572),e.tab_copyinfo.area_number%10==0?(this.btn_close.x=282,this.btn_again.visible=!1):this.dataSource.copyVo.vo.tab_copyinfo=n;break;case CopyType.island:this.lbDesc.text=t?e.islandOreInfo.getFightDesc():"";break;case CopyType.fogForest:e.forestGuanqia.isLast()?(this.btn_close.x=282,this.btn_again.visible=!1):(e.forestGuanqia=new a.ForestGuanqiaVo(tb.TB_forest.getItemById(e.forestGuanqia.tbForest.ID+1)),App.hero.force>=e.forestGuanqia.tbForest.need_power&&(this.chk_next.visible=!0,this.chk_next.selected=a.FogForestModel.getInstance().autoNext,this.onChkChange()),this.btn_again.label=LanMgr.getLan("",12572));break;case CopyType.teamCopy:this.lbDesc.text=this.dataSource.vo&&!this.dataSource.vo.commonData&&this.dataSource.vo.extReward?LanMgr.getLan("",10202):"";break;case CopyType.yuanzhenCopy:a.YuanzhengModel.getInstance().isAllFinish()?(this.btn_close.x=282,this.btn_again.visible=!1):(this.btn_again.visible=!0,this.btn_again.label=LanMgr.getLan("",12572));break;default:this.lbDesc.text="",this.btn_again.label=LanMgr.getLan("",12572)}var o=500;o=this.lab_time.visible||this.chk_next.visible||this.lab_txt.visible?this.chk_next.y+this.chk_next.height+20:this.btn_again.y+this.btn_again.height+30,this.height=this.bgPanel.height=o,this.bgPanel.bg.height=o-this.bgPanel.bg.y},e.prototype.onChkChange=function(){a.FogForestModel.getInstance().autoNext=this.chk_next.selected,this.chk_next.selected?(this._nextcd=a.FogForestModel.AUTO_NEXXT_CD,Laya.timer.loop(1e3,this,this.updateNextCD,[1]),this.updateNextCD()):(Laya.timer.clear(this,this.updateNextCD),this.chk_next.label=LanMgr.getLan("",12573))},e.prototype.updateNextCD=function(t){void 0===t&&(t=0),this._nextcd-=t,this.chk_next.label=LanMgr.getLan("",12574,this._nextcd),this._nextcd<=0&&this.startPlay()},e.prototype.qianzhi=function(t){var e=tb.TB_copy_info.get_TB_copy_infoById(t);return copymodule.CopyUtils.copyOpen(e.precondition,a.GuajiModel.getInstance().getMaxLev()).isopen},e.prototype.copyData=function(){var t=this.dataSource.copyVo;return t.vo.fightPageControl=t.vo.fightPageControl.clonePage(t.vo),t},e.prototype.isOpen=function(){var t=this.dataSource.copyVo.vo;switch(t.copyType){case iface.tb_prop.copyTypeKey.rune:case iface.tb_prop.copyTypeKey.tower:var e=t.copyType==iface.tb_prop.copyTypeKey.tower?a.TowerModel.getInstance().getMaxCopyId():a.GuajiModel.getInstance().getMaxLev(),i=copymodule.CopyUtils.copyOpen(t.tab_copyinfo.precondition,e);return i.isopen||showToast(i.info),i.isopen;case CopyType.fogForest:var n=t.forestGuanqia.tbForest.need_power<=App.hero.force;return n||showToast(LanMgr.getLan("",11004,t.forestGuanqia.tbForest.need_power)),n}},e.prototype.onPlay=function(){this.btn_again.gray?showToast(LanMgr.getLan("",10046)):this.dataSource.copyVo.vo.copyType!=CopyType.yuanzhenCopy?this.btn_again.label==LanMgr.getLan("",12572)?this.isOpen()&&this.startPlay():this.startPlay():PLC.request(Protocol.game_expedition_getChallengerInfo,null,function(t){t&&(a.YuanzhengModel.getInstance().updateData(t.challengerInfo),dispatchEvt(new a.GodEvent(a.GodEvent.SHOW_BUZHEN_PANEL),iface.tb_prop.lineupTypeKey.expedition))})},e.prototype.startPlay=function(){this.again=!0;var i=this.copyData(),t=i.vo;if(this.close(),t.copyType==iface.tb_prop.copyTypeKey.tower){var e=t.tab_copyinfo.ID,n=Protocol.game_copy_settleTowerCopy,o={};return o[n.args.copyId]=e,o[n.args.isWin]=t.fightPageControl.result==playState.VICTORY,void PLC.request(n,o,function(t,e){t&&(i.vo.resultData=t,dispatchEvt(new a.FightsEvent(a.FightsEvent.REPLAY_GAME_EVENT),i))})}dispatchEvt(new a.FightsEvent(a.FightsEvent.REPLAY_GAME_EVENT),i)},e.prototype.close=function(){this.again||dispatchEvt(new a.FightsEvent(a.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource.copyVo),n.prototype.close.call(this),this.bgPanel.closeTitle(),Laya.timer.clear(this,this.updateNextCD),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),this.list_item.array=null,this.listVo._dataSource&&(this.listVo._dataSource.length=0),this.chk_next.off(Laya.Event.CHANGE,this,this.onChkChange)},e.prototype.onClosed=function(){n.prototype.onClosed.call(this)},e);function e(){var t=n.call(this)||this;return t.ary=new Array,t._nextcd=0,t.closeEffect=null,t.btn_close.on(Laya.Event.CLICK,t,t.close),t.btn_again.on(Laya.Event.CLICK,t,t.onPlay),t.list_item.array=[],t.listVo=new ListVo(t.list_item),t.listVo.setPosition(t.list_item.x+Launch.offsetX,500+Launch.offsetY),t}a.VictoryView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fight.shengliQieCuoUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this,!1,!1),this.mouseEnabled=!0,this.btn_close.on(Laya.Event.CLICK,this,this.close)},n.prototype.onOpened=function(){e.prototype.onOpened.call(this),AudioMgr.setPlayRate(1),AudioMgr.playSound("sound/victory.mp3"),this.bg.showTitle(!0,SkinUtil.title_shengli,!0,!0,!0,null,this)},n.prototype.close=function(){e.prototype.close.call(this),this.btn_close.off(Laya.Event.CLICK,this,this.close),dispatchEvt(new t.FightsEvent(t.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource.copyVo)},n.prototype.onClosed=function(){e.prototype.onClosed.call(this)},n);function n(){return e.call(this)||this}t.VictoryQieCuoView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.fight.FightGuildCopyResultUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this,!1,!1),this.initView()},n.prototype.initView=function(){this._again=!1,this.dataSource&&(AudioMgr.setPlayRate(1),this.dataSource.type==playState.VICTORY||this.dataSource.copyVo.vo.copyType==CopyType.worldboss?AudioMgr.playSound("sound/victory.mp3"):AudioMgr.playSound("sound/defeated.mp3")),this.bgPanel.showTitle(!0,"zhandoubiaoxian/huodejianli.png",!0,!0,!0,Handler.create(this,this.showTitleComplete),this);var t,e=this.dataSource.copyVo.vo;e.copyType==CopyType.guildCopy?t=e.guildGuanqiaVo:e.copyType==CopyType.worldboss&&(t=e.worldBossInfo),this.lbRank.text=LanMgr.getLan("",10029,t.getRank()),this.lbDamage.text=LanMgr.getLan("",10086,t.getCurDamage()),this.lbTotalDamage.text=LanMgr.getLan("",10087,t.getTotalDamage());var i=new Array;t.battleEndData.commonData&&UIUtil.getRewardItemVoList(i,t.battleEndData.commonData),t.battleEndData.firstData&&UIUtil.getRewardItemVoList(i,t.battleEndData.firstData,!0),this._listVo=new ListVo(this.rewardList);var n=(Laya.stage.height-this.height>>1)+this.rewardList.y;switch(this.rewardList.AutoLayout(this.width,i),this._listVo.setHeight(100),this._listVo.setPosition(this.rewardList.x+Launch.offsetX,n),this._listVo._dataSource=i,this.btn_again.on(Laya.Event.CLICK,this,this.onClickAgain),this.btn_again.visible=!1,e.copyType){case CopyType.guildCopy:this.btn_close.x=290;break;case CopyType.worldboss:this.btn_close.x=172,this.btn_again.visible=!0}},n.prototype.showTitleComplete=function(){this._efflist=common.EffectList.showEffectList(this._listVo)},n.prototype.close=function(){this._again||dispatchEvt(new i.FightsEvent(i.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource.copyVo),e.prototype.close.call(this),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null)},n.prototype.onClickAgain=function(){var t=this.dataSource.copyVo.vo.worldBossInfo,e=App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.worldBossNum);if(tb.TB_boss_set.getSet().max_time,e<1)return showToast(LanMgr.getLan("",10105)),void dispatchEvt(new i.BossEvent(i.BossEvent.SHOW_BUY_VIEW));this.close(),dispatchEvt(new i.BossEvent(i.BossEvent.CHALLENGE_BOSS,t))},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.bgPanel.closeTitle(),this.btn_again.off(Laya.Event.CLICK,this,this.onClickAgain),this.rewardList.array=null},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t.closeEffect=null,t.btn_close.on(Laya.Event.CLICK,t,t.close),t}i.GuildCopyResultView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.fight.GloryFightResultUI,__extends(n,i),n.prototype.popup=function(){i.prototype.popup.call(this,!1,!1),this.initView()},n.prototype.show=function(){i.prototype.show.call(this,!1,!1),this.initView()},n.prototype.initView=function(){this._again=!1;var t=this.dataSource.vo,e=t.copyType==CopyType.glory?t.gloryMatchVo:null;if(e){this.bgPanel.showTitle(!0,"zhandoubiaoxian/duizhanjieguo.png",!0,!0,!0,null,this);var i=e.isLeftWin();this.lbName1.text=e.lUser.name,this.clip_force1.dataSource=e.lUser.force,this.clip_force1.value=String(e.lUser.force),this.headBox1.dataSource=e.lUser.headVo,i?(this.bg1.skin="zhandoubiaoxian/hongse.png",this.lbResult1.skin="zhandoubiaoxian/sheng.png",this.bg1.scaleY=1):(this.bg1.skin="zhandoubiaoxian/lanse.png",this.lbResult1.skin="zhandoubiaoxian/bai.png",this.bg1.scaleY=-1),this.lbName2.text=e.rUser.name,this.clip_force2.dataSource=e.rUser.force,this.clip_force2.value=String(e.rUser.force),this.headBox2.dataSource=e.rUser.headVo,i?(this.bg2.skin="zhandoubiaoxian/lanse.png",this.lbResult2.skin="zhandoubiaoxian/bai.png",this.bg2.scaleY=1):(this.bg2.skin="zhandoubiaoxian/hongse.png",this.lbResult2.skin="zhandoubiaoxian/sheng.png",this.bg2.scaleY=-1)}else logerror("result error")},n.prototype.onClosed=function(){i.prototype.onClosed.call(this)},n.prototype.close=function(){this._again||dispatchEvt(new e.FightsEvent(e.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource),i.prototype.close.call(this),this.bgPanel.closeTitle()},n.prototype.onPlay=function(){this._again=!0;var t=this.copyData();this.close(),dispatchEvt(new e.FightsEvent(e.FightsEvent.REPLAY_GAME_EVENT),t)},n.prototype.copyData=function(){var t=this.dataSource;return t.vo.fightPageControl.initState(),t},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.closeEffect=null,t.btnClose.on(Laya.Event.CLICK,t,t.close),t.btnReplay.on(Laya.Event.CLICK,t,t.onPlay),t}e.GloryFightResultView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=ui.fight.shibaiUI,__extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.bgPanel.bg.height=this.bgPanel.height-this.bgPanel.bg.y},i.prototype.channelCb=function(t){t&&this.dataSource&&this.dataSource.copyVo&&(this.dataSource.copyVo.flag=!0),this.close()},i.prototype.timeTick=function(){this.time--,this.time<=0&&this.close(),this.lab_time.text=String(this.time)},i.prototype.popup=function(){e.prototype.popup.call(this,!1,!1),this.bgPanel.showTitle(!1,"zhandoubiaoxian/shibai.png",!1,!0,!1,null,this),this.showbtn()},i.prototype.onOpened=function(){e.prototype.onOpened.call(this),this._again=!1,AudioMgr.setPlayRate(1),AudioMgr.playSound("sound/defeated.mp3")},i.prototype.showbtn=function(){var t=this.dataSource.copyVo.vo;this.lab_time.visible=this.lab_txt.visible=t.copyType==iface.tb_prop.copyTypeKey.main,this.btn_again.visible=-1==[CopyType.teamCopy,CopyType.jingji_npc,CopyType.yuanzhenCopy,CopyType.escort,CopyType.island,CopyType.guildFight].indexOf(t.copyType),this.btn_close.x=this.btn_again.visible?174:282,t.copyType==iface.tb_prop.copyTypeKey.main?(this.time=10,this.lab_time.text=String(this.time),this.timerLoop(1e3,this,this._tickFun)):t.copyType==iface.tb_prop.copyTypeKey.rune&&(this.btn_again.visible=!1,this.btn_close.x=282),this.btn_again.visible&&(this.btn_again.label=LanMgr.getLan("",12571))},i.prototype.copyData=function(){var t=this.dataSource.copyVo;return t.vo.fightPageControl=t.vo.fightPageControl.clonePage(t.vo),t},i.prototype.onPlay=function(){var i=this;this._again=!0;var n=this.copyData(),t=n.vo;if(t.copyType==iface.tb_prop.copyTypeKey.tower){var e=t.tab_copyinfo.ID,o=Protocol.game_copy_settleTowerCopy,a={};return a[o.args.copyId]=e,a[o.args.isWin]=t.fightPageControl.result==playState.VICTORY,void PLC.request(o,a,function(t,e){t&&(n.vo.resultData=t,dispatchEvt(new r.FightsEvent(r.FightsEvent.REPLAY_GAME_EVENT),n),i.close())})}dispatchEvt(new r.FightsEvent(r.FightsEvent.REPLAY_GAME_EVENT),n),this.close()},i.prototype.onClosed=function(){e.prototype.onClosed.call(this)},i.prototype.close=function(){this._again||dispatchEvt(new r.FightsEvent(r.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource.copyVo),e.prototype.close.call(this),this.bgPanel.closeTitle(),this.clearTimer(this,this._tickFun)},i);function i(){var t=e.call(this)||this;return t.btn_close.on(Laya.Event.CLICK,t,t.close),t.closeEffect=null,t.btn_again.on(Laya.Event.CLICK,t,t.onPlay),t._tickFun=function(){t.timeTick()},t.channel.callback=t.channelCb.bind(t),t}r.Failure=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fight.box.playSkillBoxUI,__extends(n,e),n.prototype.setData=function(t,e,i){this.img_bg1.skin=t==battle.BatteConsts.BATTLE_CAMPATK?SkinUtil.wofangjinengdi:SkinUtil.difangjinengdi,this.img_bg2.skin=t==battle.BatteConsts.BATTLE_CAMPATK?SkinUtil.wofangjinengGX:SkinUtil.difangjinengGX,this.img_icon.skin=SkinUtil.getHeadIcon(e),this.img_icon.x=t==battle.BatteConsts.BATTLE_CAMPATK?82:271,this.lab_name.text=i,this.lab_name.strokeColor=t==battle.BatteConsts.BATTLE_CAMPATK?"#003481":"#810000",this.lab_name.x=t==battle.BatteConsts.BATTLE_CAMPATK?137:82,this.clearTimer(this,this.playEnd),this.ani2.stop(),this.ani1.stop(),this.ani1.play(0,!1),this.timerOnce(1500,this,this.playEnd)},n.prototype.playEnd=function(){this.ani2.play(0,!1)},n);function n(){return e.call(this)||this}t.playSkillRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fight.box.FightItemBoxUI,__extends(n,e),n);function n(){return e.call(this)||this}t.FightItemBox=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.fight.fightHeadUI,__extends(n,e),n.prototype.showEff=function(){var t=this;this.setVis(!0),UIUtil.boxLeftRightTween(this.box_head0,-136,163,!1,310,.05),UIUtil.boxLeftRightTween(this.box_head1,Laya.stage.width+136,Laya.stage.width-163,!0,310,.05),setTimeout(function(){t.setVsVis(!0)},310)},n.prototype.setVsVis=function(t){this.lab_title.visible=this.lab_round.visible=this.img_vs.visible=t},n.prototype.setScale=function(t){this.box_head0.scale(t,t),this.box_head1.scale(t,t)},n.prototype.setVis=function(t){this.box_head0.visible=this.box_head1.visible=t},n.prototype.hide=function(){this._complete&&(this.hideItem(this._defItemAry),this.hideItem(this._atkItemAry),this.setVis(!1),this._complete=!1)},n.prototype.setData=function(){this._complete=!0,this.lab_title.text=this.dataSource.title,this.lab_name0.text=this.dataSource.ownName,this.lab_name1.text=this.dataSource.enemyName,this.box_force0.visible=0!=this.dataSource.ownForce,this.box_force1.visible=0!=this.dataSource.enemyForce,this.clip_force0.value=String(this.dataSource.ownForce),this.clip_force1.value=String(this.dataSource.enemyForce);for(var t=this.dataSource.enemyTeam||{},e=t.lineup||{},i=0;i<6;i++)this.setItem(battle.BatteConsts.BATTLE_CAMPDEF,i,e);e=(t=this.dataSource.ownTeam||{}).lineup||{};for(var n=0;n<6;n++)this.setItem(battle.BatteConsts.BATTLE_CAMPATK,n,e)},n.prototype.hideItem=function(t){for(var e=0;t&&e<t.length;e++)t[e].visible=!1},n.prototype.setItem=function(t,e,i){var n,o;if(!(n=t==battle.BatteConsts.BATTLE_CAMPDEF?(this._defItemAry||(this._defItemAry=[]),this._defItemAry):(this._atkItemAry||(this._atkItemAry=[]),this._atkItemAry))[e]){var a=new Laya.Image;a.scaleX=a.scaleY=.94,a.anchorY=a.anchorX=.5,o=t==battle.BatteConsts.BATTLE_CAMPDEF?(this.box_head1.addChild(a),this._enemyItemLoacl[e]):(this.box_head0.addChild(a),this._ownItemLoacl[e]),a.x=o[0],a.y=o[1],n.push(a)}var r=n[e];i.hasOwnProperty(e)?(r.visible=!0,r.skin=SkinUtil.getGodRaceSkin(Number(i[e].race)),r.gray=!i[e].active):r.visible=!1},n.prototype.setRound=function(t){this.lab_round.text=t},n.prototype.onShowKezhi=function(t){var e=this.dataSource.enemyTeam||{};t&&(e=this.dataSource.ownTeam||{}),dispatchEvt(new i.GodEvent(i.GodEvent.SHOW_KEZHI_VIEW),e.teamInfo)},n);function n(){var t=e.call(this)||this;return t._enemyItemLoacl=[[215,47],[216,75],[241,31],[268,47],[268,75],[241,89]],t._ownItemLoacl=[[87,46],[87,75],[59,31],[33,47],[34,75],[59,89]],t.width=Laya.stage.width,t.box_head0.on(Laya.Event.CLICK,t,t.onShowKezhi,[!0]),t.box_head1.on(Laya.Event.CLICK,t,t.onShowKezhi,[!1]),t}i.FightHeadRender=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fight.box.BossBuffBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){if(this.dataSource){var t=this.dataSource;this.img_buff.skin=SkinUtil.getBuffIcon(t.tb_buff.icon),this.lab_round.text=String(t.round)}},n);function n(){return e.call(this)||this}t.fightBossBuffIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.fight.box.ArtifactRenderUI,__extends(n,e),n.prototype.initArtifact=function(t,e){var i=this;this.visible=!1,this.img_shenqiiconteam.skin="shenqi/"+tb.TB_artifact.get_TB_artifactById(t).icon+".png",this._probarmask||(this._probarmask=new Laya.Sprite,this.img_probarteam.mask=this._probarmask),this.setAnger(e),setTimeout(function(){i.visible=!0},1e3)},n.prototype.setAnger=function(t){if(this._probarmask){var e=this.img_angerAll2,i=this.ani1;e.visible=!1,i.isPlaying&&i.stop();var n=tb.TB_artifact_set.get_TB_artifact_setById(1),o=t>n.anger[0]?n.anger[0]:t,a=Math.floor(o/n.anger[0]*360);this._probarmask.graphics.clear(),360==a?(this._probarmask.graphics.drawCircle(63.5,63.5,70,"#f16712",null,.01),e.visible=!0,i.play(1,!0)):this._probarmask.graphics.drawPie(63.5,63.5,70,270,270+a,"#f16712",null,.01)}},n.prototype.clearArtifact=function(){this.visible=!1,this.img_probarteam.mask=null,this._probarmask&&(this._probarmask.destroy(),this._probarmask=null)},n);function n(){return e.call(this)||this}t.ArtifactRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var n,o=Laya.Event,t=(n=ui.fight.fightsUI,__extends(a,n),a.prototype.setSize=function(t,e){n.prototype.setSize.call(this,t,e),this.width=t,this.height=e,this.img_startbg.width=t,this.img_startbg.height=e;var i=GameUtil.isFullScreen();this.box_blood.y=i?173+u.HudModel.TOP_ADD_HEIGHT:173,this.list_bossbuff.y=i?241+u.HudModel.TOP_ADD_HEIGHT:241},a.prototype.setAnger=function(t,e){t==this.getFightVo().getCamp()?this._artiface1.setAnger(e):this._artiface2.setAnger(e)},a.prototype.clearArtifact=function(){this._artiface1&&this._artiface1.clearArtifact(),this._artiface2&&this._artiface2.clearArtifact()},a.prototype.setBossAnger=function(t){var e=Number((t/tb.TB_skill_set.getSkillSet().spell_anger).toFixed(2));if(e=Math.min(1,e),(e=Math.max(.001,e))!=this._bossanger){var i=450*e;if(!this.img_anger.visible&&0<t)return this._bossanger=e,this.img_anger.width=i,void(this.img_anger_pross.width=i);Laya.Tween.clearTween(this.img_anger),Laya.Tween.clearTween(this.img_anger_pross),this._bossanger<e?(this.img_anger_pross.width=i,Laya.Tween.to(this.img_anger,{width:i},1e3,null,Laya.Handler.create(this,function(){}))):this._bossanger>e&&(this.img_anger.width=i,Laya.Tween.to(this.img_anger_pross,{width:i},1e3,null,Laya.Handler.create(this,function(){}))),this._bossanger=e}},a.prototype.initArtifact=function(t,e,i){t==this.getFightVo().getCamp()?(this._artiface1||(this._artiface1=new u.ArtifactRender,this._artiface1.x=20,this._artiface1.bottom=22,this.addChildAt(this._artiface1,this._childs.length-2)),this._artiface1.initArtifact(e,i)):(this._artiface2||(this._artiface2=new u.ArtifactRender,this._artiface2.y=GameUtil.isFullScreen()?u.HudModel.TOP_ADD_HEIGHT+145:145,this._artiface2.right=16,this.addChildAt(this._artiface2,this._childs.length-2)),this._artiface2.initArtifact(e,i))},a.prototype.onOpened=function(){n.prototype.onOpened.call(this),this.setData(this.dataSource)},a.prototype.setData=function(t){var e=this;if(this.talkStart=!1,t){UIMgr.getInstance().showLoading(),this.stopFightEnd=!1,this._curRound=0,this._fightcopyVo=t;var i=this.getFightVo();this.initCamMove(),this.fightTitle.setVsVis(!1),this.fightTitle.setVis(!1),this.setJumpAndStop(),this.clearArtifact(),this.setBossBuff(null),AudioMgr.stopMusic(),this.setRound(-1);var n=i.fightPageControl.getPreloadIds(),o=tb.TB_map.get_TB_map_ById(i.getMapid()).map_id;this._scene.gameScene&&(i.copyType==CopyType.worldboss&&(this._bossRankView||(this._bossRankView=new u.BossFightRankView,this._bossRankView.x=10,this._bossRankView.y=250),this.addChild(this._bossRankView),this._bossRankView.dataSource=i.worldBossInfo.rankList,this._bossRankView.initView()),LoadeQueue.getInstance().loadAll(this._scene.gameScene,n.skills,n.roles,[888888,1029,1017,1024,10000030],o,function(t,e){var i=0==e?10545:1==e?10546:2==e?10547:3==e?10548:-1,n=LanMgr.getLan("",i);UIMgr.getInstance().loadingProcess(t,n)},function(){logfight("资源加载完成"),e.initAutoBtn(),e.initScene()}))}else logerror("战斗vo不存在")},a.prototype.initAutoBtn=function(){if(this.getFightVo(),a.chkCam){var t=new common.CamraView(this._scene);return this.addChild(t),t.left=10,void(t.bottom=10)}},a.prototype.startTalkEnd=function(){this.talkStart&&this._scene.init&&this._scene.startFight()},a.prototype.initScene=function(){var t=this;this.box_blood.visible=!1,this.list_bossbuff.visible=!1;var e=this.getFightVo();this._scene.enterScene(this.talkStart,e,e.getMapid(),function(){t.callLater(t.sceneCom)})},a.prototype.sceneCom=function(){var i=this;AudioMgr.playMusic("sound/battle_bgm2.mp3"),UIMgr.getInstance().hideLoading(),dispatchEvt(new u.FightsEvent(u.FightsEvent.SCENE_COMPLETE_EVENT),{type:this.getFightVo().copyType}),Laya.timer.once(1e3,this,function(){logfight("监听点击事件开启");var t=i.getFightVo(),e=tb.TB_map.get_TB_map_ById(t.getMapid());i._camTopLimit=e.longitudinal_scope[0],i._camBottomLimit=e.longitudinal_scope[1],i._camLeftLimit=e.transverse_scope?e.transverse_scope[0]:NaN,i._camRightLimit=e.transverse_scope?e.transverse_scope[1]:NaN,!a.chkCam&&e.canTurn()&&i.on(o.MOUSE_DOWN,i,i.onMouseDown)})},a.prototype.showStartBg=function(){var t=this;this.img_startbg.visible=!0,Laya.timer.once(900,this,function(){t.img_startbg.visible=!1})},a.prototype.initSpeed=function(){var t=Laya.LocalStorage.getItem(App.hero.playerId+"tickspeed"),e=t?Number(t):0;this._curspeed=e,this.setSpeedLab()},a.prototype.refreshTitle=function(){var t=this.getFightVo();this.fightTitle.dataSource=t.getHeadData(),this.fightTitle.setData(),this.fightTitle.showEff()},a.prototype.setRound=function(t){var e=this.getFightVo().getAllRound();-1!=t&&(this._curRound=t),this.fightTitle&&this.fightTitle.setRound(LanMgr.getLan("",12303)+" "+this._curRound+"/"+e)},a.prototype.setBossBlood=function(t,e){var i=this;if(logfight("boss血量：",t,e),this.lab_bosshp.text=e,t!=this._bossblood){var n=t/100*538;if(!this.box_blood.visible&&0<t)return this._bossblood=t,this.setUiVisable(),this.img_blood.width=n,void(this.img_pross.width=n);Laya.Tween.clearTween(this.img_blood),Laya.Tween.clearTween(this.img_pross),this._bossblood<t?(this.img_pross.width=n,Laya.Tween.to(this.img_blood,{width:n},500,null,Laya.Handler.create(this,function(){i.setUiVisable()}))):this._bossblood>t&&(this.img_blood.width=n,Laya.Tween.to(this.img_pross,{width:n},500,null,Laya.Handler.create(this,function(){i.setUiVisable()}))),this._bossblood=t}},a.prototype.setUiVisable=function(){this.list_bossbuff.visible=this.box_blood.visible=0<this._bossblood},a.prototype.setBossLev=function(t){this.lab_bosslev.visible=!1,this.lab_bosslev.text="Lv."+t},a.prototype.setBossBuff=function(t){if(this.list_bossbuff.visible=this.box_blood.visible,this.box_blood.visible&&t){this.list_bossbuff.dataSource=t;var e=360-(55*this.list_bossbuff.dataSource.length>>1)+Launch.offsetX;this.list_bossbuff.x=e<0?0:e}},a.prototype.onSpeed=function(){this._curspeed+=1,this.setSpeedLab()},a.prototype.setSpeedLab=function(){var t=this._curspeed%2;if(this._curspeed%2==1&&!App.hero.levelPrivilege(iface.tb_prop.levelPrivilegeTypeKey.battleSpeed)){var e=tb.TB_vip_privilege.get_TB_vip_privilegeById(iface.tb_prop.levelPrivilegeTypeKey.battleSpeed),i=LanMgr.getLan("",10311,e.vip_level);showToast(i+=999!=e.general_level?LanMgr.getLan("",10312,e.general_level):""),this._curspeed++,t=0}this.setTickSpeed(t),this.lbl_speed.text="X"+(t+1),Laya.LocalStorage.setItem(App.hero.playerId+"tickspeed",String(t)),dispatchEvt(new u.FightsEvent(u.FightsEvent.SWITCH_SPEED_SUCCESS))},a.prototype.getCurspeed=function(){return this._curspeed},a.prototype.fightEnd=function(t){void 0===t&&(t=!1),logfight("结束战斗"),this.onStopSceneTick(),this.stopFightEnd||this.doFigthEnd(t)},a.prototype.doFigthEnd=function(t){var e=this;this.stopFightEnd=!1,this.getFightVo().fightPageControl.getResult()==playState.VICTORY?this._scene.tweenCam(u.CameraConst.VICTORY,function(){e.victoryFun(t)}):this._scene.tweenCam(u.CameraConst.DEFEATED,function(){e.defeatedFun(t)})},a.prototype.victoryFun=function(t){var n=this,e=this.getFightVo();if(e.copyType==CopyType.qiecuo||e.copyType==CopyType.escort||e.copyType==CopyType.guildFight||e.copyType==CopyType.island||e.copyType==CopyType.teamCopy){var i=null;e.copyType!=CopyType.qiecuo&&(i=this._fightcopyVo.responseData),dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_RESULT_EVENT),{type:playState.VICTORY,vo:i,copyVo:this._fightcopyVo})}else if(e.copyType==iface.tb_prop.copyTypeKey.rune)(o={})[Protocol.game_copy_settleRuneCopy.args.copyId]=e.getCopyId(),PLC.request(Protocol.game_copy_settleRuneCopy,o,function(t){t&&(App.hero.updateGuajiData(t),u.GuajiModel.getInstance().updatePassGuanqia(e.tab_copy.ID,e.tab_copyinfo.ID),dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_RESULT_EVENT),{type:playState.VICTORY,vo:t,copyVo:n._fightcopyVo}))});else if(e.copyType==CopyType.dailycopy)dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_RESULT_EVENT),{type:playState.VICTORY,vo:e.resultData,copyVo:this._fightcopyVo});else if(e.copyType==iface.tb_prop.copyTypeKey.underground)(o={})[Protocol.game_copy_settleGroundCopy.args.copyId]=e.getCopyId(),PLC.request(Protocol.game_copy_settleGroundCopy,o,function(t){t&&dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_RESULT_EVENT),{type:playState.VICTORY,vo:t,copyVo:n._fightcopyVo})});else if(e.copyType==iface.tb_prop.copyTypeKey.tower)dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_RESULT_EVENT),{type:playState.VICTORY,vo:e.resultData,copyVo:this._fightcopyVo});else if(e.copyType==CopyType.fogForest){var o;(o={})[Protocol.game_forest_settleForest.args.floor]=e.getCopyId(),PLC.request(Protocol.game_forest_settleForest,o,function(t,e,i){319!==i?t&&(u.FogForestModel.getInstance().addForestCurFloor(),dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_RESULT_EVENT),{type:playState.VICTORY,vo:t,copyVo:n._fightcopyVo})):dispatchEvt(new u.FightsEvent(u.FightsEvent.EXIT_FIGHT_EVENT),n._fightcopyVo)})}this.resultFun(t)},a.prototype.defeatedFun=function(t){var e=this.getFightVo(),i=[CopyType.teamCopy,CopyType.jingji_npc,CopyType.dailycopy,CopyType.qiecuo,CopyType.fogForest,CopyType.escort,CopyType.guildFight,CopyType.island];(e.copyType<5||-1!=i.indexOf(e.copyType))&&dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_RESULT_EVENT),{type:playState.FAILURE,copyVo:this._fightcopyVo}),this.resultFun(t)},a.prototype.resultFun=function(t){var n=this,e=this.getFightVo(),o=e.fightPageControl.getResult(),i=o==playState.VICTORY;if(e.copyType==CopyType.yuanzhenCopy)if(t)dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_RESULT_EVENT),{type:playState.FAILURE,copyVo:this._fightcopyVo});else{var a=this.getLossHpObj(e.fightPageControl.getLossHpObj()),r={},s=e.yuanzhengCopyVo.getSelfHpInfo(a.atk,e.fightPageControl.getMaxHpObj(),i,e.getTeamLineup());r[Protocol.game_expedition_expeditionBattleEnd.args.selfHpInfo]=s,r[Protocol.game_expedition_expeditionBattleEnd.args.id]=e.getCopyId(),r[Protocol.game_expedition_expeditionBattleEnd.args.damageInfo]=i?null:e.yuanzhengCopyVo.turnTemplatID(a.def),loghgy("打完远征请求参数：",r),PLC.request(Protocol.game_expedition_expeditionBattleEnd,r,function(t,e,i){367!==i?t&&(App.hero.updateCopyInfo(t),u.YuanzhengModel.getInstance().updateCurGuanqia(),dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_RESULT_EVENT),{type:o,vo:t,copyVo:n._fightcopyVo})):dispatchEvt(new u.FightsEvent(u.FightsEvent.EXIT_FIGHT_EVENT),n._fightcopyVo)})}else e.copyType==CopyType.glory||e.copyType==CopyType.jingji_pve||e.copyType==CopyType.jingji_record||e.copyType==CopyType.arenaMatch?dispatchEvt(new u.FightsEvent(u.FightsEvent.GLORY_RESULT_EVENT),this._fightcopyVo):e.copyType==CopyType.guildCopy||e.copyType==CopyType.worldboss?dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_GUILD_COPY_RESULT_EVENT),{type:o,copyVo:this._fightcopyVo,vo:this._fightcopyVo.responseData}):e.copyType==CopyType.godDomain&&dispatchEvt(new u.FightsEvent(u.FightsEvent.SHOW_GODDOMAIN_RESULT_EVENT),{type:o,copyVo:this._fightcopyVo,vo:this._fightcopyVo.responseData})},a.prototype.getLossHpObj=function(t){var e={},i={};for(var n in t){var o=Math.floor(Number(n)/10);o===battle.BatteConsts.BATTLE_CAMPATK?e[n]=t[n]:o===battle.BatteConsts.BATTLE_CAMPDEF&&(i[n]=t[n])}return{atk:e,def:i}},a.prototype.setJumpAndStop=function(){var t=this.getFightVo();this.box_jump.visible=t.canJump(),this.box_jump.x=this.width-109,this.box_speed.x=this.box_jump.visible?this.box_jump.x-109:this.box_jump.x,this.box_cam.x=this.box_speed.x-109},a.prototype.initCamMove=function(){var t=Laya.LocalStorage.getItem(App.hero.playerId+"camMove"),e=!t||"1"==t,i=tb.TB_map.get_TB_map_ById(this.getFightVo().getMapid());this.camMove.selected=!(e&&i.canAutoTurn()),this._scene.setCamMove(!this.camMove.selected)},a.prototype.onCamMove=function(){this.camMove.selected=!this.camMove.selected,this._scene.setCamMove(!this.camMove.selected),this._scene.setSceneMovie(),Laya.LocalStorage.setItem(App.hero.playerId+"camMove",this.camMove.selected?"0":"1")},a.prototype.onJump=function(){var t=this.getFightVo(),e=t.getConfigSet();if(0!=e.is_skip){var i=App.hero.levelPrivilege(7);if(1==e.is_skipfree)if(!0===i||e.skipfree_round<=this._curRound||0<e.level_skip&&App.hero.level>=e.level_skip)this.JumpFightEnd(t);else{var n=tb.TB_vip_privilege.get_TB_vip_privilegeById(7);0<e.level_skip?showToast(LanMgr.getLan("",10313,e.name,n.vip_level,e.level_skip)):999!=e.skipfree_round?showToast(LanMgr.getLan("",10314,e.name,n.vip_level,e.skipfree_round)):showToast(LanMgr.getLan("",10315,e.name,n.vip_level))}else!0===i?this.JumpFightEnd(t):!1===i?(n=tb.TB_vip_privilege.get_TB_vip_privilegeById(7),showToast(LanMgr.getLan("",10315,e.name,n.vip_level))):logerror("levelPrivilege cb error!")}else showToast(LanMgr.getLan("",10198))},a.prototype.JumpFightEnd=function(t){t.fightPageControl&&!t.fightPageControl.isQuick&&(t.fightPageControl.quickFight(),this.fightEnd())},a.prototype.onStopSceneTick=function(){this._scene.exitRound(),this._speedlev=-1,this._scene.gameScene.timespeed1=0,this._scene.game2dScene.timespeed1=0,logfight("tick倍数设置1：",this._scene.gameScene.timespeed1);var t=this.getFightVo();this._scene.playAction(t.fightPageControl.getResult()),this._scene.setSceneMovie(!1)},a.prototype.setTickSpeed=function(t){if(void 0===this._speedlev||t!=this._speedlev){var e=this.getFightVo();this._speedlev=0,e.fightPageControl&&!e.fightPageControl.isQuick&&(this._speedlev=t),this._scene.gameScene.timespeed1=this._scene.game2dScene.timespeed1=this._SpeedKey[this._speedlev],logfight("tick倍数设置2：",this._scene.game2dScene.timespeed1),AudioMgr.setPlayRate(0==this._speedlev?1.3:1.4)}},a.prototype.onClick=function(){if(a.chkCam){this._posAry||(this._posAry=this._scene.getAllCharPos());for(var t=0;this._posAry&&t<this._posAry.length;t++){var e=this._posAry[t];if(e.char&&e.char.mouseClik(this._scene.getCam3d(),this._scene.downPointTo3d(Laya.stage.mouseX,Laya.stage.mouseY))&&(logfight("选中目标：",e.objId),a.chkCam))return void(this._curselect=e)}}},a.prototype.fightSelectSkill=function(t){this.getFightVo().fightPageControl.selectSkillFight(t)},a.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.exitView(),AudioMgr.stopMusic(),AudioMgr.setPlayRate(1),AudioMgr.playMusic()},a.prototype.exitView=function(){this.off(o.MOUSE_DOWN,this,this.onMouseDown),this.fightTitle.hide(),this._bossblood=-1,this._bossanger=0,this.stopFightEnd=!1,this.clearArtifact(),this.onStopSceneTick(),this._scene.exitScene(),this._bossRankView&&this._bossRankView.removeSelf()},a.prototype.getFightVo=function(){return this._fightcopyVo.vo},a.prototype.initCam=function(){this._scene.initCam();var t=new tl3d.Object3D;t.rotationX=-14,t.rotationY=358,t.x=-86,t.y=281,t.z=-32,this._scene.gameScene.setLook(t)},a.prototype.onkeydown=function(t){a.chkCam&&this._curselect&&this._scene.setPos(this._curselect,t.keyCode)},a.prototype.addBox=function(t){this._clickBox||(this._clickBox=new Laya.Box,this._clickBox.width=100,this._clickBox.height=100),Laya.stage.addChild(this._clickBox);var e=this._scene.getRolePos(1==t?11:21);return this._clickBox.x=2==t?e.x-this._clickBox.width/2:e.x,this._clickBox.y=2==t?e.y-30:e.y,this._clickBox},a.prototype.onMouseDown=function(t){this.downX=this.prevX=this.stage.mouseX,this.downY=this.prevY=this.stage.mouseY,this.on(o.MOUSE_MOVE,this,this.onMouseMove);var e=t.touches;e&&2==e.length&&(this.lastDistance=getDistance(e))},a.prototype.onMouseMove=function(t){var e=(this.prevX-this.stage.mouseX)*this.factor,i=(this.prevY-this.stage.mouseY)*this.sfactor;this.prevX=this.stage.mouseX,this.prevY=this.stage.mouseY,this._scene.gameScene.camRotationY=(this._scene.gameScene.camRotationY+e)%360,this._scene.gameScene.camRotationY=1<this._scene.gameScene.camRotationY/180?this._scene.gameScene.camRotationY-360:this._scene.gameScene.camRotationY,isNaN(this._camLeftLimit)||this._scene.gameScene.camRotationY<this._camLeftLimit&&(this._scene.gameScene.camRotationY=this._camLeftLimit),isNaN(this._camRightLimit)||this._scene.gameScene.camRotationY>this._camRightLimit&&(this._scene.gameScene.camRotationY=this._camRightLimit),this._scene.gameScene.camRotationX+=i,this._scene.gameScene.camRotationX>this._camBottomLimit&&(this._scene.gameScene.camRotationX=this._camBottomLimit),this._scene.gameScene.camRotationX<this._camTopLimit&&(this._scene.gameScene.camRotationX=this._camTopLimit)},a.prototype.onMouseUp=function(t){this.off(o.MOUSE_MOVE,this,this.onMouseMove)},a.prototype.playSkillName=function(t,e,i){this._skillBox||(this._skillBox=new u.playSkillRender,this.addChild(this._skillBox)),this._skillBox.x=i==battle.BatteConsts.BATTLE_CAMPATK?20:Laya.stage.width-476,this._skillBox.y=i==battle.BatteConsts.BATTLE_CAMPATK?Laya.stage.height-650:420,this._skillBox.setData(i,e,t)},a);function a(){var t=n.call(this)||this;return t._curspeed=0,t._bossanger=0,t._SpeedKey=[.6,.9],t.factor=.15,t.sfactor=.05,t.lastDistance=0,t._scene=new u.FightScene,t.addChildAt(t._scene.gameScene,0),t.addChild(t._scene.game2dScene),t.on(Laya.Event.CLICK,t,t.onClick),t.btn_speed.on(Laya.Event.CLICK,t,t.onSpeed),t.btn_jump.on(Laya.Event.CLICK,t,t.onJump),t.btn_cam.on(Laya.Event.CLICK,t,t.onCamMove),Laya.stage.on(Laya.Event.KEY_DOWN,t,t.onkeydown),t.addChild(t.img_startbg),t.fightTitle||(t.fightTitle=new u.FightHeadRender,t.fightTitle.x=0,t.fightTitle.y=GameUtil.isFullScreen()?u.HudModel.TOP_ADD_HEIGHT+10:10,t.addChildAt(t.fightTitle,t._childs.length-1)),t.on(o.MOUSE_UP,t,t.onMouseUp),t.on(o.MOUSE_OUT,t,t.onMouseUp),t}u.FightView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.fight.FightTishiUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e)},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.FightTishiView,closeOnSide:t.isModelClose,title:LanMgr.getLan("",10536)},t}t.FightTishiView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(__extends(n,i=DialogExt),n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.isModal=!this.dataSource.isJy,this.initView()},n.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.refresh()},n.prototype.close=function(){i.prototype.close.call(this),this.game2dScene.onExit(),this.clearJingYingStartEff()},n.prototype.initView=function(){},n.prototype.refresh=function(){var t=this;this._sceneTransitionUi.visible=this.dataSource.optType!=startOptState.START&&this.isModal,this.dataSource.optType==startOptState.START?this.dataSource.isJy?this.playJingYingStartEff():this.playStartEff(this.dataSource.isBoss):this.dataSource.optType==startOptState.GUOCHANG?Laya.Tween.to(this._sceneTransitionUi,{alpha:.6},1e3,null,Laya.Handler.create(this,function(){t.dataSource&&t.dataSource.cb&&t.dataSource.cb()})):this.dataSource.optType==startOptState.GUOCHANGCOMPLETE&&(this._sceneTransitionUi.alpha=.6,Laya.Tween.to(this._sceneTransitionUi,{alpha:0},1e3,null,Laya.Handler.create(this,this.onComplete)))},n.prototype.playStartEff=function(e){var i=this;this.game2dScene.addEffect(this,e?10000017:10000013,new tl3d.Vector3D(180,0,-400),e?18:3,30,function(t){t.onComplete=function(t){i.game2dScene.scene.removeParticle(t),e?i.playStartEff(!1):i.onComplete()}})},n.prototype.playJingYingStartEff=function(){this._jyStartEff||(this._jyStartEff=new Laya.Animation,this._jyStartEff.x=this.width/2,this._jyStartEff.y=this.height/2),this._jyStartEff.loadAnimation("eff/TiaoZhanJingYingEff.ani",Handler.create(this,function(){this._jyStartEff.play(0,!1)}),"guaji.atlas"),this.addChild(this._jyStartEff),this._jyStartEff.visible=!0,Laya.timer.clear(this,this.onComplete),Laya.timer.once(1200,this,this.onComplete)},n.prototype.clearJingYingStartEff=function(){this._jyStartEff&&(this._jyStartEff.stop(),this._jyStartEff.visible=!1),Laya.timer.clear(this,this.onComplete)},n.prototype.onComplete=function(){this.dataSource&&this.dataSource.cb&&this.dataSource.cb(),this.close()},n);function n(){var t=i.call(this)||this;return t.isModelClose=!1,t.width=Laya.stage.width,t.height=Laya.stage.height,t.game2dScene=new Base2dSceneLayer,t.addChild(t.game2dScene),t._sceneTransitionUi=new Laya.Image("preload/black.jpg"),t._sceneTransitionUi.x=t._sceneTransitionUi.y=0,t._sceneTransitionUi.width=Laya.stage.width,t._sceneTransitionUi.height=Laya.stage.height,t._sceneTransitionUi.alpha=0,t._sceneTransitionUi.visible=!1,t.addChild(t._sceneTransitionUi),t}t.FightStart=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=Laya.Sprite,__extends(i,e),i.prototype.initCam=function(t){var e;void 0===t&&(t=null),e=t||tb.TB_map.get_TB_map_ById(this._curmapid).mcamera[0],this.gameScene.camRotationX=Number(e[0]),this.gameScene.camRotationY=Number(e[1]),this.gameScene.camDistance=Number(e[2]),this.gameScene.camPositionX=Number(e[3]),this.gameScene.camPositionY=Number(e[4]),this.gameScene.camPositionZ=Number(e[5])},i.prototype.StartRound=function(){this.frameLoop(1,this,this.TickUpdate)},i.prototype.exitRound=function(){this.clearTimer(this,this.TickUpdate),this.removeAllBuff()},i.prototype.TickUpdate=function(){if(this._copyVo&&(this.stepOverAry||(this.stepOverAry=new Array),0==this.stepOverAry.length)){if(null===this.roundAry)return logfight("战斗结束"),void dispatchEvt(new u.FightsEvent(u.FightsEvent.FIGHT_END),this._copyVo.fightPageControl.getResult());if(this.isNewWave)return this.hideRolePar(),void this.guochang();if(!u.FightView.chkCam||!this._stop)if(this.curRound&&this.curRound.roundary&&0<this.curRound.roundary.length){for(var t=this.curRound.roundary.shift(),e=0;e<t.length;e++){var i=t[e];this.onPlayBefore(i)}this._stop=u.FightView.chkCam}else this.roundAry&&0<this.roundAry.length?(this.curRound=this.roundAry.shift(),this.curRound&&(this.isNewWave=this.curRound.newWave)):this.roundAry=this._copyVo.getNextRound()}},i.prototype.onPlayBefore=function(t,e){if(t.hasOwnProperty("objId")||t.type==iface.tb_prop.battleOpTypeKey.rmBuff){var i=this.getRoleById(t.objId);if(!i){var n=this.getWorldBuff(t.buffInstId);n&&(i=this.getRoleById(n.targetId))}i&&i.deadIng?i.delayList.push(new u.sStep(t,e)):this.onPlay(t,e)}else this.onPlay(t,e)},i.prototype.getRoleById=function(t){return this.roleMap&&this.roleMap.has(t)?this.roleMap.get(t):null},i.prototype.getArtifactById=function(t){return this.artifactMap&&this.artifactMap.has(t)?this.artifactMap.get(t):null},i.prototype.onPlay=function(t,e){t.type==iface.tb_prop.battleOpTypeKey.useSkill?(this.tagStep(t.type+"_"+t.skillId),this.fight(t)):t.type==iface.tb_prop.battleOpTypeKey.atftInit?(this.tagStep(String(t.type)),this.artifactInfo(t)):t.type==iface.tb_prop.battleOpTypeKey.atftUseSkill?(this.tagStep(t.type+"_"+t.skillId),this.artifactFight(t)):t.type==iface.tb_prop.battleOpTypeKey.atkSpdChange?this.roleAtkSpdChange(t):t.type==iface.tb_prop.battleOpTypeKey.atkBarMax?this._atkMax=t.atkBarMax:t.type==iface.tb_prop.battleOpTypeKey.hpChange?this.hpchange(t,e):t.type==iface.tb_prop.battleOpTypeKey.flyText?this.flytest(t,e):t.type==iface.tb_prop.battleOpTypeKey.atkBar?this.changeActionBar(t):t.type==iface.tb_prop.battleOpTypeKey.objInit?(this.tagStep(String(t.type)),this.roleInfo(t)):t.type==iface.tb_prop.battleOpTypeKey.buffChange?this.updataBuff(t):t.type==iface.tb_prop.battleOpTypeKey.addBuff?this.addBuff(t):t.type==iface.tb_prop.battleOpTypeKey.rmBuff?this.removeBuff(t):t.type==iface.tb_prop.battleOpTypeKey.angerChange?dispatchEvt(new u.FightsEvent(u.FightsEvent.SET_ANGER),t):t.type==iface.tb_prop.battleOpTypeKey.trigPasvSkill?this.trigPasvSkill(t):t.type==iface.tb_prop.battleOpTypeKey.hpMaxChange?this.hpMaxChange(t):t.type==iface.tb_prop.battleOpTypeKey.roleAngerChange?this.angerChange(t):t.type==iface.tb_prop.battleOpTypeKey.nextRound&&(t.round&&(logfight("回合：",t.round),dispatchEvt(new u.FightsEvent(u.FightsEvent.SET_ROUND_TEXT),t.round)),this._curRoleId=t.objId,this.setCurRole())},i.prototype.tagStep=function(t){-1==this.stepOverAry.indexOf(t)&&(this.stepOverAry.push(t),t==String(iface.tb_prop.battleOpTypeKey.objInit)&&(this.buffMap?this.removeAllBuff():this.buffMap=new Map,this._bossType=0,this.roleMap?this.removeRole():this.roleMap=new Map),t==String(iface.tb_prop.battleOpTypeKey.atftInit)&&(this.artifactMap?(this.removeArtifact(),dispatchEvt(new u.FightsEvent(u.FightsEvent.CLEAR_ARTIFACE))):this.artifactMap=new Map))},i.prototype.hasTag=function(t){return-1!=this.stepOverAry.indexOf(t)},i.prototype.removeStep=function(t){var e=this.stepOverAry.indexOf(t);-1!=e&&this.stepOverAry.splice(e,1)},i.prototype.removeStepByType=function(t){for(var e=!0,i=0;e&&this.stepOverAry&&0!=this.stepOverAry.length;)for(i=0;i<this.stepOverAry.length;i++){if(-1!=this.stepOverAry[i].indexOf(t+"_")){this.stepOverAry.splice(i,1);break}this.stepOverAry.length-1<=i&&(e=!1)}},i.prototype.angerChange=function(t){var e=this.getRoleById(t.objId);e&&e.setAnger(t.anger)},i.prototype.artifactInfo=function(t){this.addArtifact(t),dispatchEvt(new u.FightsEvent(u.FightsEvent.INIT_ARTIFACE),t),Laya.timer.frameOnce(2,this,this.artifactInfoCom,[t])},i.prototype.artifactInfoCom=function(t){this.removeStep(String(t.type))},i.prototype.roleInfo=function(t){this.addBaseRole(t),Laya.timer.frameOnce(2,this,this.roleInfoCom,[t])},i.prototype.roleInfoCom=function(t){var e=this;this.setTeamPost(),this.init?this.guochang2():(this.init=!0,this.mainSceneComplete(),this.initCam(),this.tweenCam(u.CameraConst.MAIN,function(){e._talkStart||e.startFight()}))},i.prototype.startFight=function(){var e=this;dispatchEvt(new u.FightsEvent(u.FightsEvent.REFRESH_TITLE_EVENT)),this._copyVo.fightStart(startOptState.START,function(){if(e.removeStep(String(iface.tb_prop.battleOpTypeKey.objInit)),dispatchEvt(new u.FightsEvent(u.FightsEvent.INIT_SPEED)),e.setSceneMovie(),e._copyVo&&e._copyVo.barrageList&&0<e._copyVo.barrageList.length){for(var t=0;t<e._copyVo.barrageList.length;t++)e._copyVo.barrageList[t].parentBox=UIMgr.getUIByName(UIConst.FightViews);BarrageMgr.getInstance().addBarrages(e._copyVo.barrageList)}})},i.prototype.setTeamPost=function(){var n=this;this.roleMap.forEach(function(t,e,i){n.setRolePos(t),n.moveUnvisable(t,!0)})},i.prototype.setRolePos=function(t){var e=tb.TB_map.get_TB_map_ById(this._curmapid);2==this._bossType?t.pos=0==t.rotation?this.ary2v3(e.blocal_god[t.locad%6]):this.ary2v3(e.blocal_monster[t.locad%6]):1==this._bossType?t.pos=0==t.rotation?this.ary2v3(e.mlocal_god[t.locad%6]):this.ary2v3(e.mlocal_boss[t.locad%6]):0==this._bossType&&(t.pos=0==t.rotation?this.ary2v3(e.mlocal_god[t.locad%6]):this.ary2v3(e.mlocal_monster[t.locad%6])),t.char.px=t.pos.x,t.char.py=t.pos.y,t.char.pz=t.pos.z},i.prototype.ary2v3=function(t){return new tl3d.Vector3D(Number(t[0]),Number(t[1]),Number(t[2]))},i.prototype.addArtifact=function(t){var e=new u.SceneGodVo;e.scene=this,e.objId=1e3+t.camp,e.locad=6,e.team=t.camp,e.rotation=t.camp==this._copyVo.getCamp()?0:180,e.templatId=t.templateId,e.tab=tb.TB_artifact.get_TB_artifactById(e.templatId);var i=new FightChar;i.setRoleUrl(getRoleUrl(String(e.tab.model))),i.rotationY=e.rotation,e.char=i,this.artifactMap.set(t.camp,e)},i.prototype.createCharFun=function(){console.log("通过方法创建对象");var t=new u.SceneGodVo,e=new FightChar;return t.char=e,t},i.prototype.addBaseRole=function(t){var e=Laya.Pool.getItemByCreateFun("fightChar",this.createCharFun.bind(this));e.scene=this,e.objId=t.objId,e.objType=t.objType,e.templatId=t.templateId,e.locad=t.objId%10-1,e.team=Math.floor(t.objId/10),e.isPlayer=e.team==this._copyVo.getCamp(),e.rotation=e.isPlayer?0:180,e.atkBar=-1,e.atkSpd=t.atkSpd,e.lev=t.level;var i=t.objType==battle.BatteConsts.BATTLE_CAMPATK?tb.TB_god.get_TB_godById(t.templateId):tb.TB_monster.get_TB_monsterById(t.templateId);e.tab=i,e.onDead=this.roleDeath.bind(this);var n=u.GodUtils.getGodModel(t.skinId,e.tab);e.char.setRoleUrl(getRoleUrl(String(n))),e.hpMax=t.hpMax,e.hp=t.hp,e.setAnger(t.anger),e.tab instanceof tb.TB_monster&&(e.tab.type>this._bossType&&(this._bossType=e.tab.type),0<e.tab.type&&dispatchEvt(new u.FightsEvent(u.FightsEvent.CHANGE_BOSSLEV),e.lev)),e.buffAry=[],this.roleMap.set(e.objId,e)},i.prototype.enterScene=function(t,e,i,n){this.init=!1,this._talkStart=t,this._copyVo=e,this._curmapid=i,this.sceneComplete=n,this.stepOverAry=new Array,this.roundAry=[],this.curRound=null,this.StartRound()},i.prototype.setTest=function(){tl3d.ProgrmaManager.getInstance().registe(tl3d.LineDisplayShader.LineShader,new tl3d.LineDisplayShader);var t=new tl3d.GridLineSprite;this.gameScene.scene.addDisplay(t)},i.prototype.camMove=function(){var t=tb.TB_map.get_TB_map_ById(this._curmapid);if(!(this.gameScene.camRotationY<Number(t.auto_scope[0])||this.gameScene.camRotationY>Number(t.auto_scope[1]))){var e=this.toflag?this.gameScene.camRotationY+t.amp:this.gameScene.camRotationY-t.amp;(e<=Number(t.auto_scope[0])||e>=Number(t.auto_scope[1]))&&(this.toflag=!this.toflag),this.gameScene.camRotationY=this.toflag?this.gameScene.camRotationY+t.amp:this.gameScene.camRotationY-t.amp}},i.prototype.mainSceneComplete=function(){this.sceneComplete&&Laya.timer.frameOnce(2,this,this.sceneComplete.bind(this))},i.prototype.playAction=function(t){this.setTeamRoleAction(tl3d.CharAction.ATTACK_01,0,t==playState.VICTORY?1:2)},i.prototype.tweenCam=function(t,e){void 0===e&&(e=null),Laya.Tween.clearAll(this.gameScene);var i,n=tb.TB_map.get_TB_map_ById(this._curmapid);switch(t){case u.CameraConst.MAIN:i=n.mcamera[1];break;case u.CameraConst.VICTORY:this.clearGuoChang(),i=this._copyVo.getCamp()==battle.BatteConsts.BATTLE_CAMPATK?2==this._bossType?n.bcamera[2]:n.mcamera[2]:2==this._bossType?n.bcamera[3]:n.mcamera[3];break;case u.CameraConst.DEFEATED:this.clearGuoChang(),i=this._copyVo.getCamp()==battle.BatteConsts.BATTLE_CAMPATK?2==this._bossType?n.bcamera[3]:n.mcamera[3]:2==this._bossType?n.bcamera[2]:n.mcamera[2];break;case u.CameraConst.BOSSMAIN:i=n.bcamera[1]}Laya.Tween.to(this.gameScene,{camRotationX:Number(i[0])},800),Laya.Tween.to(this.gameScene,{camRotationY:Number(i[1])},800),Laya.Tween.to(this.gameScene,{camDistance:Number(i[2])},800),Laya.Tween.to(this.gameScene,{camPositionX:Number(i[3])},800),Laya.Tween.to(this.gameScene,{camPositionY:Number(i[4])},800),Laya.Tween.to(this.gameScene,{camPositionZ:Number(i[5])},800,null,Handler.create(this,function(){e&&e()}))},i.prototype.clearGuoChang=function(){Laya.Tween.clearAll(this._sceneTransitionUi),this._sceneTransitionUi.alpha=0,this._sceneTransitionUi.visible=!1},i.prototype.roleAtkSpdChange=function(t){var e=this.getRoleById(t.objId);e&&(e.atkSpd=t.atkSpd)},i.prototype.exitScene=function(){this._copyVo&&this._copyVo.barrageList&&(this._copyVo.barrageList=null,BarrageMgr.getInstance().removeBarrageByBox(UIMgr.getUIByName(UIConst.FightViews))),TimeUtil.removeAllTickOut(),this.exitRound(),this._copyVo=null,logfight("设置copyvo == null"),this.removeRole(),this.game2dScene.onExit(),this.gameScene.onExit()},i.prototype.removeRole=function(){this.roleMap.forEach(function(t,e,i){t&&(t.buffAry=[],t.char&&(t.char.buffary=t.buffAry,t.char.shadow=!1,t.char.removeChar()),Laya.Pool.recover("fightChar",t))}),this.roleMap.clear()},i.prototype.removeArtifact=function(){this.artifactMap.forEach(function(t,e,i){t&&(t.buffAry=[],t.char&&(t.char.buffary=t.buffAry),t.onDispose())}),this.artifactMap.clear()},i.prototype.removeAllBuff=function(){var n=this;this.buffMap.forEach(function(t,e,i){n.removeBuffByOne(e)})},i.prototype.setCurRole=function(){var e=this;this.hideRolePar();var t=this.getRoleById(this._curRoleId);if(t){var i=1;t.tab instanceof tb.TB_monster&&0<t.tab.type&&(i=1==t.tab.type?t.tab.model_multiple:4),this.gameScene.addEffect(this,888888,t.pos,i,5,function(t){e._lastRolePar=t})}},i.prototype.hideRolePar=function(){this._lastRolePar&&(this.gameScene.removeEffect(this._lastRolePar),this._lastRolePar=null)},i.prototype.changeActionBar=function(t){var e=this.getRoleById(t.objId);e&&(e.atkBar=t.atkBar,Laya.timer.frameOnce(3,this,this.showActionBar))},i.prototype.showActionBar=function(){var o=this,a=new Array;this.roleMap.forEach(function(t,e,i){t.lastAction=t.char.actionRatio,null!=o._atkMax&&0!=o._atkMax||logerror("atkMax error");var n=t.atkBar/o._atkMax;n=1<n?1:n,n=Math.floor(100*n),a.push({roleid:t.objId,atkpre:n,speed:t.atkSpd,team:t.team})}),this.atkBarRank(a);for(var t=new Array,e=[null,null,null,null,null,null,null,null,null,null],i=0;i<a.length;i++){var n=a[i],r=this.getRoleById(n.roleid);r&&(n.roleid==this._curRoleId?r.char.actionRatio=108:this.diguiFun(t,n.atkpre,r.char),0<r.hpr&&(e[0==r.rotation?r.locad:5+r.locad]={roleid:r.objId,lastrate:r.lastAction,rate:r.char.actionRatio,img:r.tab.icon,isMain:r.objId==this._curRoleId,team:r.team}),logfight(r.objId+"行动条设置："+r.char.actionRatio))}logfight("行动条设置完成"),this.changeActionEvent(e)},i.prototype.diguiFun=function(t,e,i){this.hasItem(t,e)?(e-=3,this.diguiFun(t,e,i)):(i.actionRatio=Math.max(e,0),t.push(e))},i.prototype.hasItem=function(t,e){for(var i=0;i<t.length;i++){if(!t[i])return!1;if(t[i]-3<=e)return!0}return!1},i.prototype.atkBarRank=function(t){t.sort(function(t,e){return t.atkpre!==e.atkpre?e.atkpre-t.atkpre:t.speed!==e.speed?e.speed-t.speed:t.team!==e.team?t.team-e.team:t.roleid-e.roleid})},i.prototype.changeActionEvent=function(t){void 0===t&&(t=null),null==t&&this.roleMap.forEach(function(t,e,i){t.lastAction=0}),dispatchEvt(new u.FightsEvent(u.FightsEvent.CHANGE_ACTIONBAR),{vo:t})},i.prototype.hpchange=function(t,e){if(void 0!==e){var i=tb.TB_skill.get_TB_skillById(e);if(0<i.effect&&2<tb.TB_skill_effect.get_TB_skill_effectById(i.effect).frame.length)return}var n=this.getRoleById(t.objId);n&&(logfight("血量变化：",t.hp),n.hp=t.hp)},i.prototype.flytest=function(t,e){var i=this.getRoleById(t.objId);if(i){iface.tb_prop.flyTextTypeKey.reborn==t.flyTextType&&(this.playEffSkill([t.objId],1017),this.setRolePos(i)),t.hasOwnProperty("showeff")&&this.playEffSkill([t.objId],1024);var n=new u.FlyText;n.type=this.getFlyType(t.flyTextType,t.value),n.value=t.value,n.skillid=e,i.showJumpText(n),logfight("飘字：",t.objId,t.flyTextType,t.value)}},i.prototype.getFlyType=function(t,e){switch(t){case iface.tb_prop.flyTextTypeKey.hpChange:return 0<e?tl3d.TextJumpType.N_UPHP:tl3d.TextJumpType.N_NORMALDAMAGE;case iface.tb_prop.flyTextTypeKey.crit:return tl3d.TextJumpType.N_CRIT;case iface.tb_prop.flyTextTypeKey.resist:return tl3d.TextJumpType.N_RESISTANCES;case iface.tb_prop.flyTextTypeKey.rampage:return tl3d.TextJumpType.N_ONCEATTACK;case iface.tb_prop.flyTextTypeKey.passive:return tl3d.TextJumpType.N_PASSIVE;case iface.tb_prop.flyTextTypeKey.reborn:return tl3d.TextJumpType.N_RESURGENCE;case iface.tb_prop.flyTextTypeKey.strikeBack:return tl3d.TextJumpType.N_BEATBACK;case iface.tb_prop.flyTextTypeKey.banRecover:return tl3d.TextJumpType.N_DOWNHP;case iface.tb_prop.flyTextTypeKey.shield:return tl3d.TextJumpType.N_SHIELD;case iface.tb_prop.flyTextTypeKey.god:return tl3d.TextJumpType.N_INVINCIBLE;case iface.tb_prop.flyTextTypeKey.immune:return tl3d.TextJumpType.N_IMMUNE;case iface.tb_prop.flyTextTypeKey.share:return tl3d.TextJumpType.N_SHARE;case iface.tb_prop.flyTextTypeKey.reboundDmg:return tl3d.TextJumpType.N_FANTAN;case iface.tb_prop.flyTextTypeKey.angerDown:return tl3d.TextJumpType.N_ANGER_DOWN}},i.prototype.addBuff=function(t){var e=new u.GodBuffVo;e.casterId=t.casterId,e.round=t.round,e.skillId=t.skillId,e.targetId=t.objId,e.stackCnt=t.stackCnt,e.uuid=t.buffInstId,e.tb_buff=tb.TB_buff.get_TB_buffById(t.buffId),this.buffMap.set(e.uuid,e),this.showBuffFlyText(e,t.hasOwnProperty("showeff")),this.addBuffByOne(e),Laya.timer.frameOnce(3,this,this.showBuff)},i.prototype.showBuffFlyText=function(t,e){var i=this.getRoleById(t.targetId);i&&e&&this.buffJumpText(t,i)},i.prototype.showBuff=function(){var s=this;this.roleMap.forEach(function(t,e,i){for(var n=new Array,o=0;o<t.buffAry.length;o++){var a=t.buffAry[o],r=s.getWorldBuff(a);r&&r.tb_buff.is_show&&9999!=r.tb_buff.round&&n.push(JSON.parse(JSON.stringify(r)))}t.tab instanceof tb.TB_monster&&0<t.tab.type?dispatchEvt(new u.FightsEvent(u.FightsEvent.CHANGE_BOSSBUFF),n):t.char.buffary=n})},i.prototype.addBuffByOne=function(e){var i=this,t=this.getRoleById(e.targetId);if(t){if(0!=e.tb_buff.index){var n=tb.TB_buff_effect.get_TB_buff_effectById(e.tb_buff.index);this.addEffect(n.effect_id,t,n.location,function(t){1==n.is_cycle&&(e.particle=t,i.buffMap.has(e.uuid)||i.gameScene.removeEffect(t))})}t.buffAry.push(e.uuid)}},i.prototype.addEffect=function(t,e,i,n){var o=1,a=1;e.tab instanceof tb.TB_monster&&0<e.tab.type&&(a=1==e.tab.type?e.tab.model_multiple:4,o=e.tab.model_multiple);var r=e.char.getCharHeight();r*=o,0==e.rotation&&(r+=17,e.tab instanceof tb.TB_monster&&2==e.tab.type&&(r+=40));var s=1==i?r:e.char.py;this.gameScene.addEffect(this,t,new tl3d.Vector3D(e.char.px,s,e.char.pz),a,10,function(t){n&&n(t),t.x=e.char.px,t.z=e.char.pz})},i.prototype.buffJumpText=function(t,e){var i=-1;if(1==t.tb_buff.type)2==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_ATTACK_UP:tl3d.TextJumpType.N_ATTACK_DOWN:3==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_DEFENSE_UP:tl3d.TextJumpType.N_DEFENSE_DOWN:4==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_SPEED_UP:tl3d.TextJumpType.N_SPEED_DOWN:5==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_CRIT_RATE_UP:tl3d.TextJumpType.N_CRIT_RATE_DOWN:7==t.tb_buff.type_param?i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_HIT_UP:tl3d.TextJumpType.N_HIT_DOWN:8==t.tb_buff.type_param&&(i=1==t.tb_buff.status_type?tl3d.TextJumpType.N_RESIST_RATE_UP:tl3d.TextJumpType.N_RESIST_RATE_DOWN);else if(2==t.tb_buff.type)i=tl3d.TextJumpType.N_IMMUNE;else if(3==t.tb_buff.type)i=tl3d.TextJumpType.N_INVINCIBLE;else if(7==t.tb_buff.type){var n=t.tb_buff.type_param%10;i=tl3d.TextJumpType.N_BLEED,1==n?i=tl3d.TextJumpType.N_ZHONGDU:2==n&&(i=tl3d.TextJumpType.N_ZHUOSHAO)}else 8==t.tb_buff.type?(i=tl3d.TextJumpType.N_DIZZY,1==t.tb_buff.type_param?i=tl3d.TextJumpType.N_BINGFENG:2==t.tb_buff.type_param?i=tl3d.TextJumpType.N_SHUFU:3==t.tb_buff.type_param?i=tl3d.TextJumpType.N_MEIHUO:4==t.tb_buff.type_param?i=tl3d.TextJumpType.N_SHIHUA:5==t.tb_buff.type_param?i=tl3d.TextJumpType.N_MABI:6==t.tb_buff.type_param&&(i=tl3d.TextJumpType.N_FENNU)):9==t.tb_buff.type?i=tl3d.TextJumpType.N_DOWNHP:10==t.tb_buff.type?i=tl3d.TextJumpType.N_SILENCE:13==t.tb_buff.type?i=tl3d.TextJumpType.N_SARCASM:17==t.tb_buff.type?i=tl3d.TextJumpType.N_SLEEP:18==t.tb_buff.type?i=tl3d.TextJumpType.N_SHIELD:20==t.tb_buff.type?(i=tl3d.TextJumpType.N_TARGET,1==t.tb_buff.type_param?i=tl3d.TextJumpType.N_LEIDIAN:2==t.tb_buff.type_param&&(i=tl3d.TextJumpType.N_WANGLING)):24==t.tb_buff.type&&(i=tl3d.TextJumpType.N_SHARE);if(-1!=i){var o=new u.FlyText;o.type=i,o.value=0,e.showJumpText(o)}},i.prototype.removeBuff=function(t){var e=t.buffInstId;this.removeBuffByOne(e)},i.prototype.removeBuffByOne=function(t){var e=this.getWorldBuff(t);if(e){var i=this.getRoleById(e.targetId);i&&i.deleteBuff(t),e.particle&&(logfight("移除特效：",e.targetId,"的"+tb.TB_buff_effect.get_TB_buff_effectById(e.tb_buff.index).name),this.gameScene.removeEffect(e.particle)),this.buffMap.delete(t),logfight("删除buff：",e.uuid,this.buffMap.has(t)),Laya.timer.frameOnce(3,this,this.showBuff)}},i.prototype.updataBuff=function(t){if(this.buffMap.has(t.buffInstId)){var e=this.buffMap.get(t.buffInstId);e.round=t.round,e.stackCnt=t.stackCnt,this.showBuffFlyText(e,t.hasOwnProperty("showeff")),Laya.timer.frameOnce(3,this,this.showBuff)}else this.addBuff(t)},i.prototype.hpMaxChange=function(t){var e=this.getRoleById(t.objId);e&&(logfight("血量变化：",t.hp),e.hpMax=t.hpMax,e.hp=t.hp)},i.prototype.trigPasvSkill=function(t){var e=String(t.skillId),i=tb.TB_skill.get_TB_skillById(Number(e));if(i&&0<i.effect)logfight("被动存在技能表现"),this.tagStep(t.type+"_"+t.skillId),this.fight(t);else if(-1==this.curRound.succOpt.indexOf(Number(e))&&this.curRound.roundmap.hasOwnProperty(e)){this.curRound.succOpt.push(Number(e));for(var n=this.curRound.roundmap[e],o=0;n&&o<n.length;o++){var a=n[o];this.onPlayBefore(a,t.skillId)}}},i.prototype.roleDeath=function(t){var e=this.getRoleById(t);if(e)for(;e.buffAry&&0<e.buffAry.length;){var i=e.buffAry.shift();this.removeBuffByOne(i)}},i.prototype.getWorldBuff=function(t){return this.buffMap&&this.buffMap.has(t)?this.buffMap.get(t):null},i.prototype.resetScene=function(){var t=tb.TB_map.get_TB_map_ById(this._curmapid).mcamera[1];this.initCam(t)},i.prototype.setTeamRoleAction=function(n,o,a){void 0===a&&(a=-1),this.roleMap.forEach(function(t,e,i){0<t.hpr&&(-1==a||a==t.team)&&t.char.play(n,o,!1)})},i.prototype.guochang=function(){var t=this;this.setSceneMovie(!1),this.tagStep("sceneSwitch"),this.isNewWave=!1,this.resetScene(),this.artifactMap&&(this.removeArtifact(),dispatchEvt(new u.FightsEvent(u.FightsEvent.CLEAR_ARTIFACE))),this.setTeamRoleAction(this._copyVo.guochangAction(),0),this._copyVo.fightStart(startOptState.GUOCHANG,function(){t.guochang1()})},i.prototype.guochang1=function(){this.changeActionEvent(),dispatchEvt(new u.FightsEvent(u.FightsEvent.SET_ROUND_TEXT),-1),this.removeStep("sceneSwitch")},i.prototype.guochang2=function(){var t=this;dispatchEvt(new u.FightsEvent(u.FightsEvent.HIDE_TITLE_EVENT)),2==this._bossType&&this.initCam(tb.TB_map.get_TB_map_ById(this._curmapid).bcamera[0]),this._copyVo.fightStart(startOptState.GUOCHANGCOMPLETE,function(){t.guochang3()})},i.prototype.guochang3=function(){var t=this;2==this._bossType?this.tweenCam(u.CameraConst.BOSSMAIN,function(){dispatchEvt(new u.FightsEvent(u.FightsEvent.REFRESH_TITLE_EVENT)),t.removeStep(String(iface.tb_prop.battleOpTypeKey.objInit)),t.setSceneMovie()}):(dispatchEvt(new u.FightsEvent(u.FightsEvent.REFRESH_TITLE_EVENT)),this.removeStep(String(iface.tb_prop.battleOpTypeKey.objInit)),this.setSceneMovie()),this._sceneTransitionUi.visible=!1},i.prototype.setCamMove=function(t){this._camAutoMove=t},i.prototype.setSceneMovie=function(t){void 0===t&&(t=this._camAutoMove),this.gameScene.camAotuMove=t},i.prototype.artifactFight=function(t){var e=this;logfight("神器释放技能：",t.skillId,"施法阵营 =>"+t.camp,"受击者 =>"+t.targetIds);var i=tb.TB_skill.get_TB_skillById(t.skillId),n=0,o=tb.TB_skill_effect.get_TB_skill_effectById(i.effect);if(o){o.frame&&0<o.frame.length&&(logfight("打击帧数：",o.frame[1]),n=frame2time(o.frame[1]));var a=this.getArtifactById(t.camp);a&&(i.skill_feature,a.skilltag=!1,a.actiontag=!1,t.camp==battle.BatteConsts.BATTLE_CAMPATK?UIMgr.showUI(UIConst.ShowSkill,{text:i.name,model:a.tab.model,scale:a.tab.location[3]+2,charx:180,chary:1400,effz:-640,cb:function(){e.onArtifactFight(a,o,n,t,i)}}):this.onArtifactFight(a,o,n,t,i))}else logerror("efftab null")},i.prototype.onArtifactFight=function(t,e,i,n,o){var a=this;this.setRolePos(t),this.gameScene.scene.addMovieDisplay(t.char);var r={speednum:0};1==e.att_type?(i+=this.ATTACK_DELAY,this.jinzhan(n,t,o)):e&&2==e.att_type&&this.yuancheng(e,n,t,o,frame2time(e.frame[0]),r),i+=Number(r.speednum),TimeUtil.addTimeOut(this.getresultTime(i),function(){a.triggerEffect(n)})},i.prototype.fight=function(t){var e=this;logfight("当前释放技能：",t.skillId,"施法者 =>"+t.objId,"受击者 =>"+t.targetIds);var i={speednum:0},n=tb.TB_skill.get_TB_skillById(t.skillId),o=0,a=tb.TB_skill_effect.get_TB_skill_effectById(n.effect);if(!a)return logerror("efftab null"),this.triggerEffect(t),void this.removeStep(t.type+"_"+t.skillId);a.frame&&0<a.frame.length&&(logfight("打击帧数：",a.frame[1]),o=frame2time(a.frame[1]));var r=this.getRoleById(t.objId);r&&(1==n.skill_feature&&dispatchEvt(new u.FightsEvent(u.FightsEvent.PLAY_SKILL_EFF),{name:n.name,icon:r.tab.icon,team:r.team}),r.actiontag=!1,r.skilltag=!1,1==a.att_type?(o+=this.ATTACK_DELAY,this.jinzhan(t,r,n)):a&&2==a.att_type&&this.yuancheng(a,t,r,n,frame2time(a.frame[0]),i),logfight("播放被击打效果:",o+=Number(i.speednum),t),TimeUtil.addTimeOut(this.getresultTime(o),function(){e.triggerEffect(t)}))},i.prototype.triggerEffect=function(t){var e=this;if(logfight("触发被击打效果:",t),-1==this.curRound.succOpt.indexOf(Number(t.skillId))&&this.curRound.roundmap.hasOwnProperty(String(t.skillId))){this.curRound.succOpt.push(Number(t.skillId));for(var i=this.curRound.roundmap[String(t.skillId)],n=0;i&&n<i.length;n++){var o=i[n];if(o.type==iface.tb_prop.battleOpTypeKey.trigPasvSkill){var a=tb.TB_skill.get_TB_skillById(t.skillId);if(a&&0<a.effect){var r=tb.TB_skill_effect.get_TB_skill_effectById(a.effect);if(2<r.frame.length){var s=frame2time(r.frame[0]-r.frame[1]);tl3d.TimeUtil.addTimeOut(this.getresultTime(s),function(){e.onPlayBefore(o,t.skillId)})}else this.onPlayBefore(o,t.skillId)}else this.onPlayBefore(o,t.skillId)}else this.onPlayBefore(o,t.skillId)}}},i.prototype.moveUnvisable=function(t,e){for(var i=0;i<t.buffAry.length;i++){var n=this.getWorldBuff(t.buffAry[i]);n&&n.particle&&(n.particle.sceneVisible=e)&&(n.particle.x=t.char.px,n.particle.z=t.char.pz)}},i.prototype.jinzhan=function(t,e,i){var n=this.getRoleById(t.targetIds[0]);if(n){var o=n.char;e.char.watch(o),e.char.play(tl3d.CharAction.WALK,2,!1);var a=tl3d.Vector3D.distance(n.pos,e.pos),r=n.pos.subtract(e.pos);r.normalize(),r.scaleBy(.8*a);var s=e.pos.add(r),u=this.getresultTime(this.ATTACK_DELAY);Laya.timer.callLater(this,this.moveChar,[e,s,u,t,i])}},i.prototype.getresultTime=function(t){return t/(this.gameScene.timespeed1+1)},i.prototype.moveChar=function(t,e,i,n,o){var a=this;this.moveUnvisable(t,!1),Laya.Tween.to(t.char,{px:e.x,pz:e.z},i,null,Laya.Handler.create(this,function(t,e){a.charPlaySkill(t,e,n)},[t,o]))},i.prototype.yuancheng=function(t,e,i,n,o,a){var r=this;if(1==t.ballistic){if(!e.targetIds)return void logerror("目标不存在");for(var s=e.targetIds.length,u=0;u<s;u++){var h=this.getRoleById(e.targetIds[u]);if(h){var l=u+1;this.charDandaoPlaySkill(i,n,h,l==s?e:null,a)}}0<s&&(logfight("actiontag:cbtime",o+a.speednum),TimeUtil.addTimeOut(this.getresultTime(o+a.speednum),function(){i.actiontag=!0,logfight("actiontag:true"),Laya.timer.frameOnce(3,r,r.skillComplete,[i,n,e])}))}else if(0==t.ballistic){if(this.charPlaySkill(i,n,e),!e.targetIds)return void logerror("目标不存在")}else{var c=tb.TB_map.get_TB_map_ById(this._curmapid),p=void 0;p=2==this._bossType?0==i.rotation?this.ary2v3(c.bskilldot[1]):this.ary2v3(c.bskilldot[0]):0==i.rotation?this.ary2v3(c.mskilldot[1]):this.ary2v3(c.mskilldot[0]);var d=3==t.ballistic||0==t.ballistic?null:[p];3==t.ballistic&&i.char.watch(p),this.charPlaySkill(i,n,e,d)}},i.prototype.playEffSkill=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],o=this.getRoleById(n);this.addEffect(e,o,0)}},i.prototype.skillComplete=function(t,e,i){if(t.skilltag&&t.actiontag&&this.roleMap&&t&&t.char){if(logfight("战斗技能结束",i.skillId),i.type==iface.tb_prop.battleOpTypeKey.atftUseSkill)return this.gameScene.scene.removeMovieDisplay(t.char),void this.removeStep(i.type+"_"+i.skillId);t.char.forceRotationY=t.rotation,this.removeStep(i.type+"_"+i.skillId);var n=tb.TB_skill_effect.get_TB_skill_effectById(e.effect);i.type==iface.tb_prop.battleOpTypeKey.trigPasvSkill&&2==n.att_type&&1==n.ballistic&&this.removeStepByType(i.type)}},i.prototype.charDandaoPlaySkill=function(t,e,i,n,o){var a=this;if(t.char._scene.ready){var r=tb.TB_skill_effect.get_TB_skill_effectById(e.effect);if(r){var s=this.gameScene.scene.skillMgr.getSkill(getSkillUrl(String(r.effect_id)),r.action,function(){logfight("技能加载完成"),a.charDandaoPlaySkill(t,e,i,n,o)});if(s.keyAry){var u=s.keyAry[0];u&&u instanceof tl3d.SkillTrajectory&&(logfight("弹道速度:",u.data.speed),u.data.speed<10&&(o.speednum=this.REMOTE_DELAY)),s&&(s.reset(),s.isDeath=!1),tl3d.PathManager.init(),s.configTrajectory(t.char,i.char,null==n?null:function(){t.skilltag=!0,logfight("技能回调skilltag:true"),Laya.timer.frameOnce(3,a,a.skillComplete,[t,e,n])}),t.char.watch(i.char),this.gameScene.scene.skillMgr.playSkill(s)}}else logerror("技能效果不存在",e.effect)}},i.prototype.charPlaySkill=function(t,e,i,n){var o=this;void 0===n&&(n=null);var a=tb.TB_skill_effect.get_TB_skill_effectById(e.effect);if(t&&t.char&&t.char._scene&&t.char._scene.ready){var r=tb.TB_skill_effect.get_TB_skill_effectById(e.effect);if(r){var s=this.gameScene.scene.skillMgr.getSkill(getSkillUrl(String(r.effect_id)),r.action,function(){logfight("技能加载完成"),o.charPlaySkill(t,e,i,n)});s.keyAry&&(s&&(s.reset(),s.isDeath=!1),s.configFixEffect(t.char,function(){t.skilltag=!0,logfight("skilltag:true"),Laya.timer.frameOnce(3,o,o.skillComplete,[t,e,i])},n),this.gameScene.scene.skillMgr.playSkill(s),TimeUtil.addTimeOut(this.getresultTime(frame2time(a.frame[0])),function(){t.actiontag=!0,logfight("actiontag:time:",frame2time(a.frame[0])),Laya.timer.frameOnce(3,o,o.skillComplete,[t,e,i])}),1==a.att_type&&TimeUtil.addTimeOut(this.getresultTime(frame2time(a.action_frame)),function(){o.roleMove(t)}))}else logerror("技能效果不存在",e.effect)}},i.prototype.roleMove=function(t){var e=this;if(t&&t.char){t.char.forceRotationY=t.char.rotationY+180,t.char.play(tl3d.CharAction.WALK,2,!1);var i=this.getresultTime(this.ATTACK_DELAY);Laya.Tween.to(t.char,{px:t.pos.x,pz:t.pos.z},i,null,Laya.Handler.create(this,function(){t&&t.char&&(t.char.curentAction!=tl3d.CharAction.STANAD&&t.char.play(tl3d.CharAction.STANAD),e.moveUnvisable(t,!0),t.char.forceRotationY=t.rotation)}))}},i.prototype.getAllCharPos=function(){var n=new Array;return this.roleMap.forEach(function(t,e,i){n.push(t)}),n},i.prototype.selectSkillOk=function(){if(this._tempDeathRoleList&&0!=this._tempDeathRoleList.length){for(var t=0;t<this._tempDeathRoleList.length;t++){var e=this._tempDeathRoleList[t];e.char.alpha=1,this.gameScene.scene.removeMovieDisplay(e.char)}this._tempDeathRoleList=null}},i.prototype.getCam3d=function(){return new tl3d.Vector3D(this.gameScene.copyCam3d.x,this.gameScene.copyCam3d.y,this.gameScene.copyCam3d.z)},i.prototype.downPointTo3d=function(t,e){return this.gameScene.getGroundPos(t,e)},i.prototype.setPos=function(t,e){var i=this.getRoleById(t.objId);i&&(e==Laya.Keyboard.UP?i.char.pz+=1:e==Laya.Keyboard.DOWN?--i.char.pz:e==Laya.Keyboard.LEFT?--i.char.px:e==Laya.Keyboard.RIGHT&&(i.char.px+=1))},i.prototype.LogPos=function(){var n={};this.roleMap.forEach(function(t,e,i){n[t.objId]=new tl3d.Vector3D(t.char.px,t.char.py,t.char.pz)}),logfight("----------新坐标------",n)},i.prototype.getRolePos=function(t){var e=this.getRoleById(t);return e.char.math3DWorldtoDisplay2DPos(new tl3d.Vector3D(e.char.px,e.char.py+e.char.tittleHeight>>1,e.char.pz))},i);function i(){var t=e.call(this)||this;return t.isNewWave=!1,t.awake_section=tb.TB_god_set.get_TB_god_set().awake_section,t.ATTACK_DELAY=300,t.REMOTE_DELAY=500,t.DEATH_DELAY=800,t.END_DELAY=200,t.toflag=!1,t._camAutoMove=!1,t.gameScene=new Base3dSceneLayerExt,t.gameScene.camMoveFun=function(){t.camMove()},t.gameScene.scene.changeBloodManager(new BloodManagerExt),t.game2dScene=new Base2dSceneLayer,t._sceneTransitionUi=new Laya.Image("preload/black.jpg"),t._sceneTransitionUi.x=t._sceneTransitionUi.y=0,t._sceneTransitionUi.width=Laya.stage.width,t._sceneTransitionUi.height=Laya.stage.height,t._sceneTransitionUi.alpha=0,t._sceneTransitionUi.visible=!1,Laya.stage.addChild(t._sceneTransitionUi),t}u.FightScene=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.ServerPage,__extends(o,e),o.prototype.clonePage=function(t){var e=new o;e.defType=this.defType;var i=new battle.BattleScenePve(t.copyType);i.init([t.getOwnTeam()],t.getEnemyTeam(),this.defType,t.getAllRound(),t.getTeamHp()),i.start();var n=i.winCamp===battle.BatteConsts.BATTLE_CAMPATK;return logfight("战斗结果：",n,"战报：",i.battleReport),e.result=n?playState.VICTORY:playState.FAILURE,e.initPage(i.battleReport),e},o);function o(){return null!==e&&e.apply(this,arguments)||this}t.NewClientPage=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=tl3d.Processor,__extends(n,t),n.prototype.getName=function(){return"FightsProcessor"},n.prototype.listenModuleEvents=function(){return[new e.FightsEvent(e.FightsEvent.FIGHT_END),new e.FightsEvent(e.FightsEvent.CHANGE_BOSSBLOOD),new e.FightsEvent(e.FightsEvent.CHANGE_BOSSANGER),new e.FightsEvent(e.FightsEvent.CHANGE_ACTIONBAR),new e.FightsEvent(e.FightsEvent.CHANGE_BOSSBUFF),new e.FightsEvent(e.FightsEvent.CHANGE_BOSSLEV),new e.FightsEvent(e.FightsEvent.INIT_ARTIFACE),new e.FightsEvent(e.FightsEvent.REFRESH_TITLE_EVENT),new e.FightsEvent(e.FightsEvent.HIDE_TITLE_EVENT),new e.FightsEvent(e.FightsEvent.SHOW_START_BG),new e.FightsEvent(e.FightsEvent.SET_ANGER),new e.FightsEvent(e.FightsEvent.CLEAR_ARTIFACE),new e.FightsEvent(e.FightsEvent.SET_ROUND_TEXT),new e.FightsEvent(e.FightsEvent.GLORY_RESULT_EVENT),new e.FightsEvent(e.FightsEvent.INIT_SPEED),new e.FightsEvent(e.FightsEvent.EXIT_FIGHT_EVENT),new e.FightsEvent(e.FightsEvent.ENTER_FIGHT_EVENT),new e.FightsEvent(e.FightsEvent.PLAY_SKILL_EFF),new e.FightsEvent(e.FightsEvent.SHOW_RESULT_EVENT),new e.FightsEvent(e.FightsEvent.REPLAY_GAME_EVENT),new e.FightsEvent(e.FightsEvent.SHOW_GUILD_COPY_RESULT_EVENT),new e.FightsEvent(e.FightsEvent.SHOW_GODDOMAIN_RESULT_EVENT)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.FightsEvent)switch(t.type){case e.FightsEvent.FIGHT_END:Laya.timer.callLater(this,this.fightend);break;case e.FightsEvent.CHANGE_BOSSBLOOD:null!=t.data&&this.changeBossBlood(t.data);break;case e.FightsEvent.CHANGE_BOSSANGER:null!=t.data&&this.changeBossAnger(t.data);break;case e.FightsEvent.CHANGE_ACTIONBAR:null!=t.data&&this.changeActionBar(t.data.vo);break;case e.FightsEvent.CHANGE_BOSSLEV:null!=t.data&&this.changeBossLev(t.data);break;case e.FightsEvent.CHANGE_BOSSBUFF:this.showBossBuff(t.data);break;case e.FightsEvent.INIT_ARTIFACE:this.initartiface(t.data);break;case e.FightsEvent.SET_ANGER:this.setanger(t.data);break;case e.FightsEvent.REFRESH_TITLE_EVENT:this.refreshTitle();break;case e.FightsEvent.HIDE_TITLE_EVENT:this.hideTitle();break;case e.FightsEvent.SET_ROUND_TEXT:this.setRoundText(t.data);break;case e.FightsEvent.CLEAR_ARTIFACE:this.clearArtiface();break;case e.FightsEvent.INIT_SPEED:this.initSpeed();break;case e.FightsEvent.ENTER_FIGHT_EVENT:this.enterFight(t.data);break;case e.FightsEvent.GLORY_RESULT_EVENT:this.showGloryResult(t.data);break;case e.FightsEvent.EXIT_FIGHT_EVENT:this.exitFight(t.data);break;case e.FightsEvent.SHOW_RESULT_EVENT:this.showResultView(t.data);break;case e.FightsEvent.SHOW_GUILD_COPY_RESULT_EVENT:this.showGuildCopyResultView(t.data);break;case e.FightsEvent.SHOW_GODDOMAIN_RESULT_EVENT:this.showGodDomainResultView(t.data);break;case e.FightsEvent.SHOW_START_BG:this.showStartBg();break;case e.FightsEvent.PLAY_SKILL_EFF:this.playSkillEff(t.data);break;case e.FightsEvent.REPLAY_GAME_EVENT:this.replayGame(t.data)}},n.prototype.replayGame=function(t){this.fightview&&(this.fightview.exitView(),this.fightview.dataSource=t,this.fightview.setData(t))},n.prototype.playSkillEff=function(t){this.fightview&&this.fightview.playSkillName(t.name,t.icon,t.team)},n.prototype.showStartBg=function(){this.fightview&&this.fightview.showStartBg()},n.prototype.showGuildCopyResultView=function(t){this.fightview&&(common.AlertBox.close(),UIMgr.showUI(UIConst.FightGuildCopyResultView,t),UIMgr.hideUIByName(UIConst.PlayerLineupInfoView),UIMgr.hideUIByName(UIConst.GuaiwuxinxiView),UIMgr.hideUIByName(UIConst.FightTishiView))},n.prototype.showResultView=function(t){this.fightview&&(common.AlertBox.close(),t.type==playState.VICTORY?t.copyVo&&t.copyVo.vo&&t.copyVo.vo.copyType==CopyType.qiecuo?UIMgr.showUI(UIConst.FightVictoryQc,t):UIMgr.showUI(UIConst.FightVictory,t):UIMgr.showUI(UIConst.FightFailure,t),UIMgr.hideUIByName(UIConst.PlayerLineupInfoView),UIMgr.hideUIByName(UIConst.GuaiwuxinxiView),UIMgr.hideUIByName(UIConst.FightTishiView))},n.prototype.showGodDomainResultView=function(t){this.fightview&&(common.AlertBox.close(),UIMgr.showUI(UIConst.GodDm_BattleResultView,t))},n.prototype.showGloryResult=function(t){if(this.fightview&&t&&t.vo){common.AlertBox.close();var e=t.vo;e.copyType==CopyType.jingji_pve?e.fightPageControl.getResult()==playState.VICTORY?UIMgr.showUI(UIConst.ArenaSuccView,t):UIMgr.showUI(UIConst.ArenaFailView,t):e.copyType==CopyType.jingji_record?UIMgr.showUI(UIConst.ArenaResultView,t):e.copyType==CopyType.glory?UIMgr.showUI(UIConst.GloryFightResultView,t):e.copyType==CopyType.arenaMatch&&(e.arenaMatchVo.isRecord()?UIMgr.showUI(UIConst.ArenaResultView,t):UIMgr.showUI(UIConst.MatchResultView,t))}},n.prototype.exitFight=function(t){if(t){var e=t;if(e){if(e.event&&null==e.flag){var i=e.hasOwnProperty("eventdata")?e.eventdata:null;dispatchEvt(e.event,i)}UIMgr.hasStage(UIConst.HudView)||UIMgr.showUI(UIConst.HudView),UIMgr.hideUIByName(UIConst.FightViews)}}},n.prototype.enterFight=function(t){logdebug("enterFight:",t),UIUtil.checkUnableToEnterFight()||(this.fightview?this.replayGame(t):UIMgr.showUI(UIConst.FightViews,t))},n.prototype.initSpeed=function(){this.fightview&&this.fightview.initSpeed()},n.prototype.clearArtiface=function(){this.fightview&&this.fightview.clearArtifact()},n.prototype.setRoundText=function(t){this.fightview&&this.fightview.setRound(t)},n.prototype.refreshTitle=function(){this.fightview&&this.fightview.refreshTitle()},n.prototype.hideTitle=function(){this.fightview&&this.fightview.fightTitle.setVis(!1)},n.prototype.showBossBuff=function(t){this.fightview&&this.fightview.setBossBuff(t)},n.prototype.setanger=function(t){this.fightview&&this.fightview.setAnger(t.camp,t.anger)},n.prototype.initartiface=function(t){this.fightview&&this.fightview.initArtifact(t.camp,t.templateId,t.anger)},n.prototype.fightend=function(){this.fightview&&this.fightview.fightEnd()},n.prototype.changeActionBar=function(t){this.fightview},n.prototype.changeBossBlood=function(t){this.fightview&&this.fightview.setBossBlood(t.vo,t.info)},n.prototype.changeBossAnger=function(t){this.fightview&&this.fightview.setBossAnger(t)},n.prototype.changeBossLev=function(t){this.fightview&&this.fightview.setBossLev(t)},Object.defineProperty(n.prototype,"fightview",{get:function(){return UIMgr.hasStage(UIConst.FightViews)?UIMgr.getUIByName(UIConst.FightViews):null},enumerable:!0,configurable:!0}),n);function n(){return t.call(this)||this}e.FightsProcessor=i}(game=game||{});var CopyType,playState,startOptState;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"FightsModule"},n.prototype.listProcessors=function(){return[new t.FightsProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.FightsModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.FIGHT_END="FIGHT_END",r.CHANGE_BOSSBLOOD="CHANGE_BOSSBLOOD",r.CHANGE_BOSSANGER="CHANGE_BOSSANGER",r.CHANGE_ACTIONBAR="CHANGE_ACTIONBAR",r.CHANGE_BOSSBUFF="CHANGE_BOSSBUFF",r.CHANGE_BOSSLEV="CHANGE_BOSSLEV",r.INIT_ARTIFACE="INIT_ARTIFACE",r.REFRESH_TITLE_EVENT="REFRESH_TITLE_EVENT",r.HIDE_TITLE_EVENT="HIDE_TITLE_EVENT",r.SET_ANGER="SET_ANGER",r.SET_ROUND_TEXT="SET_ROUND_TEXT",r.CLEAR_ARTIFACE="CLEAR_ARTIFACE",r.INIT_SPEED="INIT_SPEED",r.ENTER_FIGHT_EVENT="ENTER_FIGHT_EVENT",r.EXIT_FIGHT_EVENT="EXIT_FIGHT_EVENT",r.SHOW_RESULT_EVENT="SHOW_RESULT_EVENT",r.GLORY_RESULT_EVENT="GLORY_RESULT_EVENT",r.SHOW_GUILD_COPY_RESULT_EVENT="SHOW_GUILD_COPY_RESULT_EVENT",r.SHOW_GODDOMAIN_RESULT_EVENT="SHOW_GODDOMAIN_RESULT_EVENT",r.SKILL_SELECTED="SKILL_SELECTED",r.CLICK_ROLE_SUCCESS="CLICK_ROLE_SUCCESS",r.CLICK_AUTO_SUCCESS="CLICK_AUTO_SUCCESS",r.SWITCH_SPEED_SUCCESS="SWITCH_SPEED_SUCCESS",r.SCENE_COMPLETE_EVENT="SCENE_COMPLETE_EVENT",r.SKILL_PANEL_VISIBLE="SKILL_PANEL_VISIBLE",r.SHOW_START_BG="SHOW_START_BG",r.PLAY_SKILL_EFF="PLAY_SKILL_EFF",r.REPLAY_GAME_EVENT="REPLAY_GAME_EVENT",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.FightsEvent=a}(game=game||{}),function(t){var e=(i.START="0",i.END="-1",i);function i(){}t.StepKeyConst=e}(game=game||{}),function(t){t[t.jingji_npc=1001]="jingji_npc",t[t.jingji_pve=1002]="jingji_pve",t[t.jingji_record=1003]="jingji_record",t[t.qiecuo=2001]="qiecuo",t[t.guildCopy=4001]="guildCopy",t[t.guildFight=4002]="guildFight",t[t.worldboss=5001]="worldboss",t[t.dailycopy=5002]="dailycopy",t[t.yuanzhenCopy=5003]="yuanzhenCopy",t[t.escort=5004]="escort",t[t.fogForest=5005]="fogForest",t[t.island=5006]="island",t[t.glory=5007]="glory",t[t.arenaMatch=5008]="arenaMatch",t[t.godDomain=5009]="godDomain",t[t.teamCopy=5010]="teamCopy",t[t.test=1e5]="test"}(CopyType=CopyType||{}),function(t){t[t.PREPARE=0]="PREPARE",t[t.FIGHT=1]="FIGHT",t[t.VICTORY=2]="VICTORY",t[t.FAILURE=3]="FAILURE"}(playState=playState||{}),function(t){t[t.START=0]="START",t[t.GUOCHANG=1]="GUOCHANG",t[t.GUOCHANGCOMPLETE=2]="GUOCHANGCOMPLETE"}(startOptState=startOptState||{}),function(t){var e;(e=t.CameraConst||(t.CameraConst={}))[e.BOSSMAIN=0]="BOSSMAIN",e[e.MAIN=1]="MAIN",e[e.BOSSINIT=2]="BOSSINIT",e[e.INIT=3]="INIT",e[e.VICTORY=4]="VICTORY",e[e.DEFEATED=5]="DEFEATED"}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var n,t=(n=ui.fenjie.FenjieUI,__extends(e,n),e.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this),this._model.tempReturnData={},this.list_gods.array=null,this.list_race.array=null,this.list_race.selectedIndex=-1,this._curSelectGods.length=0,this.btn_fast.off(Laya.Event.CLICK,this,this.onFast),this.btn_fenjie.off(Laya.Event.CLICK,this,this.onFenjie)},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.show=function(t,e){n.prototype.show.call(this,!1,!1),this.initView()},e.prototype.initView=function(){this._model.tempReturnData={},this.btn_fast.on(Laya.Event.CLICK,this,this.onFast),this.btn_fenjie.on(Laya.Event.CLICK,this,this.onFenjie),this.btnNext.on(Laya.Event.CLICK,this,this.onScroll,[!0]),this.btnPrev.on(Laya.Event.CLICK,this,this.onScroll,[!1]),this.list_race.array=[0,1,2,3,4,5],this.list_race.selectedIndex=0,this.showHaveGod(),this.refreshItemList()},e.prototype.showHaveGod=function(){var t=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum);this.lab_godnum.text=LanMgr.getLan("",12578,a.GodUtils.getGodsNum(),t)},e.prototype.refreshItemList=function(){var n=this,t=this._curSelectGods.length;this.lbSelect.text=0<t?LanMgr.getLan("",12576):LanMgr.getLan("",12577),this._model.requestReturnList(this._curSelectGods).then(function(t){var e=(t=t||[]).length;n.btnPrev.visible=n.btnNext.visible=5<t.length;var i=100*e+(e-1)*n.itemList.spaceX;i=556<i?556:i,n.itemList.array=t,n.itemList.width=i})},e.prototype.refreshView=function(){this.onRaceSelect(this.list_race.selectedIndex)},e.prototype.onRaceRender=function(t,e){t&&(t.img_selected.visible=e==this.list_race.selectedIndex)},e.prototype.onRaceSelect=function(e){if(-1!=e){var t=App.hero.getGodAry().filter(function(t){return 0==e||t.getRaceType()==e});this.sortGods(t),this.list_gods.array=t,this.clearSelect()}},e.prototype.sortGods=function(t){t.forEach(function(t){t.sortNum=0,t.isInLinuep()?(t.sortNum=1e5,t.sortNum+=t.isInLinuep(iface.tb_prop.lineupTypeKey.attack)?1:2):t.sortNum+=1e3*t.starLevel+t.level}),t.sort(function(t,e){return t.sortNum-e.sortNum})},e.prototype.onMouseHandler=function(t,e){if(t.type==Laya.Event.CLICK){var i=this.list_gods.getCell(e),n=i.dataSource;if(!n)return;if(i.img_gouxuan.visible){i.img_gouxuan.visible=!1;var o=this._curSelectGods.findIndex(function(t){return t.uuid==n.uuid});-1!=o&&this._curSelectGods.splice(o,1)}else{if(10<=this._curSelectGods.length)return void showToast(LanMgr.getLan("",10309));if(n.isInLinuep())return void common.AlertBox.showAlert({text:LanMgr.getLan("",10501),confirmCb:function(){dispatchEvt(new a.GodEvent(a.GodEvent.CHOOSE_LINEUP_GOD),n)}});if(6<=n.starLevel)return void showToast(LanMgr.getLan("",10310));i.img_gouxuan.visible=!0,this._curSelectGods.push(n)}this.refreshItemList()}},e.prototype.onGodRender=function(t,e){var i=t.dataSource;i?(t.god_icon.dataSource=i,t.item_icon.dataSource=null,t.item_icon.visible=!1,t.god_icon.visible=!0,t.img_gouxuan.visible=this._curSelectGods.some(function(t){return t.uuid==i.uuid}),t.gray=i.isInLinuep()):(t.god_icon.dataSource=null,t.item_icon.dataSource=null,t.gray=!1,t.img_gouxuan.visible=!1)},e.prototype.onFast=function(){for(var t=[],e=this.list_gods.array,i=0;i<10;i++)!e[i]||e[i].isInLinuep()||6<=e[i].starLevel||t.push(e[i]);this.fastSelect(t)},e.prototype.fastSelect=function(t){for(var e=t.map(function(t){return t.uuid}),i=0;i<this.list_gods.cells.length;i++){var n=this.list_gods.cells[i],o=n.dataSource;n.img_gouxuan.visible=o&&-1!=e.indexOf(o.uuid)}this._curSelectGods=t,this.refreshItemList()},e.prototype.clearSelect=function(){for(var t=0;t<this.list_gods.cells.length;t++)this.list_gods.cells[t].img_gouxuan.visible=!1;this._curSelectGods.length=0},e.prototype.onFenjie=function(){dispatchEvt(new a.FenjieEvent(a.FenjieEvent.CLICK_BTN_FENJIE),this._curSelectGods)},e.prototype.onScroll=function(t){t?this.itemList.scrollBar.value+=300:this.itemList.scrollBar.value-=300},e);function e(){var t=n.call(this)||this;return t._curSelectGods=[],t.isModelClose=!0,t.bgPanel.dataSource={closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12575)},t.bgPanel.box_Content.addChild(t.img_bg),t._curSelectGods=[],t.list_race.selectHandler=new Handler(t,t.onRaceSelect),t.list_race.renderHandler=new Handler(t,t.onRaceRender),t.list_race.selectedIndex=-1,t.list_gods.mouseHandler=new Handler(t,t.onMouseHandler),t.list_gods.renderHandler=new Handler(t,t.onGodRender),t._model=a.FenjieModel.getInstance(),t}a.FenjieView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=tl3d.Processor,__extends(n,i),n.prototype.getName=function(){return"FenjieProcessor"},n.prototype.listenModuleEvents=function(){return[new e.FenjieEvent(e.FenjieEvent.SHOW_FENJIE_VIEW),new e.FenjieEvent(e.FenjieEvent.CLICK_BTN_FENJIE),new e.GodEvent(e.GodEvent.GOD_CHANGE)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.FenjieEvent)switch(t.type){case e.FenjieEvent.SHOW_FENJIE_VIEW:this.showFenjie();break;case e.FenjieEvent.CLICK_BTN_FENJIE:this.fenjie(t.data)}else if(t instanceof e.GodEvent)switch(t.type){case e.GodEvent.GOD_CHANGE:this.fenjieview&&this.refrshFenjieView()}},n.prototype.showFenjie=function(){UIMgr.showUI(UIConst.FenjieView)},n.prototype.fenjie=function(t){var e=this;if(t&&0!=t.length){for(var i=!1,n=0;n<t.length;n++)if(4<=t[n].starLevel){i=!0;break}if(i){var o=LanMgr.getLan("",10500);common.AlertBox.showAlert({text:o,confirmCb:function(){e.sendFenjie(t)}})}else this.sendFenjie(t)}},n.prototype.sendFenjie=function(t){var a=this;if(t&&0!=t.length){for(var e=new Array,i=0;i<t.length;i++)e.push(t[i].uuid);var n={};n[Protocol.game_god_resolve.args.rsvIds]=e,PLC.request(Protocol.game_god_resolve,n,function(t,e){if(t){if(a.refrshFenjieView(),UIMgr.hasStage(UIConst.God_MainView)&&UIMgr.getUIByName(UIConst.God_MainView).onOpened(),t.commonData.modifyEquips){t.commonData.returnEquip={};var i=t.commonData.modifyEquips;for(var n in i){var o=App.hero.getEquipByuuid(n);o.type=2,t.commonData.returnEquip[n]=o}}UIUtil.showRewardView(t.commonData)}})}},n.prototype.refrshFenjieView=function(){var t=this.fenjieview;t.refreshView(),t.clearSelect(),t.showHaveGod(),t.refreshItemList()},Object.defineProperty(n.prototype,"fenjieview",{get:function(){return UIMgr.getUIByName(UIConst.FenjieView)},enumerable:!0,configurable:!0}),n);function n(){var t=i.call(this)||this;return t._model=e.FenjieModel.getInstance(),t}e.FenjieProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"FenjieModule"},n.prototype.listProcessors=function(){return[new t.FenjieProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.FenjieModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_FENJIE_VIEW="SHOW_FENJIE_VIEW",r.CLICK_BTN_FENJIE="CLICK_BTN_FENJIE",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.FenjieEvent=a}(game=game||{}),function(t){var e=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.requestReturnList=function(s){var u=this;return new Promise(function(a,t){if(0!=s.length){for(var e=[],i=0;i<s.length;i++){var n=s[i];u.tempReturnData.hasOwnProperty(n.uuid)||e.push(n.uuid)}if(0!=e.length){var r=1==e.length?e[0]:"",o={};o[Protocol.game_god_queryResolve.args.rsvIds]=e,PLC.request(Protocol.game_god_queryResolve,o,function(t){if(t){for(var e=[],i=0,n=t.resolveItem;i<n.length;i++){var o=n[i];e.push(new ItemVo(o[0],o[1]))}""!=r?(u.tempReturnData[r]=e,a(u.getReturnList(s,[],!0))):a(u.getReturnList(s,e,!1))}})}else a(u.getReturnList(s,[],!0))}else a([])})},i.prototype.getReturnList=function(t,e,i){var n=[];if(i){for(var o={},a=0,r=t;a<r.length;a++){var s=r[a],u=this.tempReturnData[s.uuid];if(u&&0!=u.length)for(var h=0,l=u;h<l.length;h++){var c=l[h];o.hasOwnProperty(c.id)||(o[c.id]=0),o[c.id]+=c.count}}for(var p in e=[],o)e.push(new ItemVo(Number(p),Number(o[p])))}e&&0<e.length&&n.push.apply(n,e);for(var d={},_=0,f=t;_<f.length;_++){for(var g=0,y=(s=f[_]).getEquipItems();g<y.length;g++){var m=y[g],v=App.hero.getEquipByuuid(m);v.show=!0,v.type=2,n.push(v)}for(var b=0,I=s.gemsList;b<I.length;b++){var T=I[b];d[T.templateId]||(d[T.templateId]=0),d[T.templateId]++}}for(var w in d)n.push(new ItemVo(Number(w),d[w]));return n},i);function i(){this.tempReturnData={}}t.FenjieModel=e}(game=game||{}),function(t){var e=(i.prototype.isBeRod=function(){return this.svo.recordType==iface.tb_prop.escortRecordTypeKey.fail},i.prototype.getLossList=function(){return this.isBeRod()?this.tbEscort.getLossList():[]},i.prototype.getContent=function(){var t=App.serverTimeSecond-this.svo.recordTime,e="";return e=t<3600?Math.ceil(t/60)+LanMgr.getLan("",12097)+",":t<86800?Math.ceil(t/3600)+LanMgr.getLan("",12098)+",":Math.ceil(t/86800)+LanMgr.getLan("",12099)+",",this.isBeRod()?e+(0<this.tbEscort.getLossList().length?LanMgr.getLan("",12428,this.svo.name):LanMgr.getLan("",12429,this.svo.name)):e+LanMgr.getLan("",12204,this.svo.name)},i);function i(t){this.svo=t,this.tbEscort=tb.TB_escort.getItemById(t.tradeId)}t.CaravanRecordVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(__extends(n,i=BaseFightVo),n.prototype.setDetailInfo=function(t){this.svo.guildName=t.guildName,this.svo.robCount=t.robCount,this.svo.multiple=t.multiple,this.svo.force=t.force,this.svo.head=t.head,this.svo.level=t.level,this.svo.lineupInfo||(this.svo.lineupInfo=t.lineupInfo,i.prototype.setLineupInfo.call(this,t.lineupInfo))},n);function n(t){var e=i.call(this)||this;return e.svo=t,e.tbEscort=tb.TB_escort.getItemById(t.tradeId),e}t.CaravanInfoVo=e}(game=game||{}),function(t){var e=(i.prototype.isMaxQuality=function(){return t.EscortModel.getInstance().isMaxQuality(this.tbEscort.ID)},i.prototype.isSelected=function(){return this.tbEscort.ID==t.EscortModel.getInstance().escortId},i);function i(t){this.tbEscort=t}t.CaravanGoodsVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.escort.RobbedRecordUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._buffList=new common.BuffRenderList(this.itemBox.width,this.itemBox.height,null,500,2,!1),this._buffList.isAutoScroll=!1,this._buffList.spaceY=10,this._buffList.itemRender=t.RobRecordIR,this.itemBox.addChild(this._buffList)},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._buffList.removeAll(),this.bgPanel.dataSource=null},n.prototype.initView=function(){this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12430)},this._buffList.dataSource=this.dataSource},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.addChildAt(t.itemBox,3),t}t.RobbedRecordView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.escort.EscortRewardUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this)},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.close=function(){i.prototype.close.call(this)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.itemList.array=null,this.btnReward.off(Laya.Event.CLICK,this,this.onReward)},n.prototype.initView=function(){var n=this,r=tb.TB_escort.getItemById(this.dataSource);this.itemList.array=null,this.bgPanel.dataSource={uiName:UIConst.EscortRewardView,closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12431)},this.btnReward.on(Laya.Event.CLICK,this,this.onReward),this.ui_escort.dataSource=new t.CaravanGoodsVo(r),this.ui_escort.img_select.visible=!1,PLC.request(Protocol.center_escort_getSelfInfo,null,function(t){if(t){var o=t.escortInfo,a=[];r.escort_reward.forEach(function(e){var t=new ItemVo(Number(e[0]),Number(e[1])),i=1<o.multiple?o.multiple:1;if(t.count*=i,0<o.robCount){var n=r.escort_loss?r.escort_loss.find(function(t){return t[0]==e[0]}):null;n&&(t.count-=n[1]*o.robCount*i)}a.push(t)}),n.itemList.array=a}else n.itemList.array=r.getRewardList();var e=n.itemList.array?n.itemList.array.length:0,i=0<e?(90+n.itemList.spaceX)*e:0;548<i&&(i=548),n.itemList.x=(n.width-i)/2})},n.prototype.onReward=function(){dispatchEvt(new t.EscortEvent(t.EscortEvent.RECEIVE_AWARD))},n);function n(){var t=i.call(this)||this;return t.isModelClose=!1,t}t.RewardView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.escort.itemRender.RobRecordIRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;if(t){this.lbContent.text=t.getContent();var e=t.getLossList();0<e.length?(this.itemList.y=this.lbContent.y+this.lbContent.height+9,this.itemList.array=e,this.bg.height=this.height=this.itemList.y+this.itemList.height+18):(this.itemList.array=null,this.bg.height=this.height=this.lbContent.y+this.lbContent.height+16)}else this.itemList.array=null},n);function n(){var t=e.call(this)||this;return t.lbContent.autoSize=!0,t}t.RobRecordIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.escort.itemRender.EscortIRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t?(this.imgQuality.skin=SkinUtil.getEscortQulityIcon(t.tbEscort.ID),this.img_icon.skin=LanMgr.getLan("husong/husong_{0}.png",-1,t.tbEscort.ID),this.itemList.array=t.tbEscort.getRewardList()):this.itemList.array=null},n);function n(){return e.call(this)||this}t.EscortIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.escort.itemRender.EscortCircleIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t&&(this.img_icon.skin=LanMgr.getLan("husong/husong_{0}.png",-1,t.tbEscort.ID),this.img_select.visible=!t.isSelected(),this.imgQuality.skin=SkinUtil.getEscortQulityIcon(t.tbEscort.ID))},n);function n(){return e.call(this)||this}t.EscortCircleIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.escort.itemRender.CaravanIRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.setStartPositon=function(t,e){void 0===e&&(e=420),this.x=15-this.width,this.y=e+Math.floor(Math.random()*(t-e))-this.height},n.prototype.initView=function(){var t=this.dataSource;t?(this.lbName.text=t.svo.name,this.lbShenli.text=LanMgr.getLan("",10117,t.svo.force),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime(),this.uiScene.onShow(),this._modelId=t.tbEscort.model,Laya.timer.once(200,this,this.delayShow),Laya.timer.frameLoop(2,this,this.updatePosition),this.on(Laya.Event.CLICK,this,this.onShowDetail)):this.onRemove()},n.prototype.updateTime=function(){var t=this.dataSource;if(t){var e=t.svo.endTime-App.serverTimeSecond;0<e?(this.lbTime.text=GameUtil.toCountdown(e,"mm:ss"),995<=this.x&&this.onRemove()):this.onRemove()}},n.prototype.updatePosition=function(){if(this.x+=2.5,this.uiScene.sceneChar){var t=this.lbShenli.localToGlobal(new Laya.Point(0,0));this.uiScene.sceneChar.set2dPos(this.getX(t.x),this.getY(t.y))}},n.prototype.getX=function(t){return t+this.lbShenli.width/2-Launch.offsetX},n.prototype.getY=function(t){return t-20-Launch.offsetY},n.prototype.delayShow=function(){if(this._modelId){var t=this.lbShenli.localToGlobal(new Laya.Point(0,0));this.uiScene.addModelChar(this._modelId,this.getX(t.x),this.getY(t.y),90,1),this.uiScene.sceneChar.play(tl3d.CharAction.WALK,0)}},n.prototype.onShowDetail=function(){this.dataSource&&dispatchEvt(new t.EscortEvent(t.EscortEvent.SHOW_CARAVAN_INFO_VIEW,this.dataSource))},n.prototype.onRemove=function(){this._dataSource=null,Laya.timer.clearAll(this),this.off(Laya.Event.CLICK,this,this.onShowDetail),this.uiScene.onExit(),t.EscortModel.getInstance().pushItemRender(this),this.removeSelf()},n);function n(){var t=e.call(this)||this;return t.uiScene=new Base2dSceneLayer,t.addChildAt(t.uiScene,0),t.uiScene.setModelBox(t,t.lbName,t.lbTime),t}t.CaravanIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.escort.EscortUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.close=function(){i.prototype.close.call(this),this.itemList.array=null},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.bgPanel.dataSource=null},n.prototype.initView=function(){this.bgPanel.dataSource={uiName:UIConst.EscortView,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12398)},this.itemList.array=t.EscortModel.getInstance().getGoodsList()},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.box_Content.addChild(t.img_bg),t}t.EscortView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var n,t=(n=ui.escort.EscortMainUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this._model=o.EscortModel.getInstance(),this.itemPanel.hScrollBarSkin="",this.bgImg.skin=SkinUtil.getSysMapSkin(ModuleConst.CARAVAN_ESCORT)},e.prototype.show=function(t,e){var i=this;n.prototype.show.call(this,t,e),this.initView(),this._model.requestCaravanList().then(function(){i.startRun()})},e.prototype.close=function(){n.prototype.close.call(this),Laya.timer.clearAll(this),this.list_quality.array=null;for(var t=this._model.caravanList.length=0,e=this.bgImg._childs;t<e.length;t++){var i=e[t];i instanceof o.CaravanIR&&i.onRemove()}this.btnEscort.off(Laya.Event.CLICK,this,this.onEscort),this.lbFinish.off(Laya.Event.CLICK,this,this.onFinish),this.btn_orange.off(Laya.Event.CLICK,this,this.onOnekey),this.btn_refresh.off(Laya.Event.CLICK,this,this.onRefresh),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.onClosed=function(){n.prototype.onClosed.call(this)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_record,redpointName:"escort_record",callback:this.onRecord.bind(this)},{btnSkin:SkinUtil.btn_jiangli,callback:this.onReward.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onFanHui.bind(this)}),this.btnEscort.on(Laya.Event.CLICK,this,this.onEscort),this.lbFinish.on(Laya.Event.CLICK,this,this.onFinish),this.btn_orange.on(Laya.Event.CLICK,this,this.onOnekey),this.btn_refresh.on(Laya.Event.CLICK,this,this.onRefresh),this.updateCount(),this.refreshInterval(),this.showReward()},e.prototype.requestList=function(){var t=this,e=this._model;e.requestCaravanList().then(function(){0<e.caravanList.length?t.startRun():Laya.timer.once(2e4,t,t.requestList)})},e.prototype.startRun=function(){var t=this._model.getCaravanList();0<t.length?this.intetvalAnim(t):Laya.timer.once(2e4,this,this.requestList)},e.prototype.intetvalAnim=function(t){if(0<t.length){var e=t.shift();this.addCaravan(e),Laya.timer.once(800,this,this.intetvalAnim,[t])}else Laya.timer.once(8e3,this,this.startRun)},e.prototype.addCaravan=function(e){if(-1==this.bgImg._childs.findIndex(function(t){return t instanceof o.CaravanIR&&t.dataSource&&t.dataSource.svo.playerId==e.svo.playerId})){var t=this._model.getItemRender(),i=this.height-845,n=this.box_husong.visible?this.box_husong.y:this.box_husonging.y;t.setStartPositon(n,i),t.dataSource=e,this.bgImg.addChild(t)}},e.prototype.showReward=function(){var t=this._model;if(t.endTime<=0)Laya.timer.clear(this,this.showReward);else if(t.endTime<=App.serverTimeSecond){Laya.timer.clear(this,this.showReward),UIMgr.showUI(UIConst.EscortRewardView,t.escortId);var e=this.bgImg._childs.find(function(t){return t instanceof o.CaravanIR&&t.dataSource&&t.dataSource.svo.playerId==App.hero.playerId});e&&e.onRemove()}else Laya.timer.loop(1e3,this,this.showReward)},e.prototype.updateCount=function(){var t=this._model;this.lbEscortCnt.text=LanMgr.getLan("",12432,t.getEscortCount()),this.lbRobCnt.text=LanMgr.getLan("",12433,t.getRobCount())},e.prototype.refreshInterval=function(){var t=this._model;t.endTime>App.serverTimeSecond?(this.box_husonging.visible=!0,this.box_husong.visible=!1,Laya.timer.loop(1e3,this,this.updateTime),this.updateTime(),this.list_quality.array=null,Laya.timer.clear(this,this.loopSelecteGoods)):(this.box_husonging.visible=!1,this.box_husong.visible=!0,this._inAnim=!1,Laya.timer.clear(this,this.updateTime),this.list_quality.array=t.getGoodsList(),this.updateCost())},e.prototype.updateTime=function(){var t=this._model.endTime-App.serverTimeSecond;0<t?(this.lbTime.text=GameUtil.toCountdown(t,"mm:ss"),this.pro_husong.value=t/tb.TB_escort_set.getSet().escort_time):this.refreshInterval()},e.prototype.updateCost=function(){var t=this._model;if(this.box_husong.visible){var e=t.getRefreshCost();this.img_refresh_cost.skin=SkinUtil.getCostSkin(e[0]);var i=t.getOneKeyCost();this.img_orange_cost.skin=SkinUtil.getCostSkin(i[0]),e[0]==iface.tb_prop.resTypeKey.diamond?this.lab_refresh_cost.text=e[1]:this.lab_refresh_cost.text=App.hero.getBagItemNum(e[0])+"/"+e[1],i[0]==iface.tb_prop.resTypeKey.diamond?this.lab_orange_cost.text=i[1]:this.lab_orange_cost.text=App.hero.getBagItemNum(i[0])+"/"+i[1]}},e.prototype.startAnim=function(e){this.box_husong.visible&&(this._curIdx=this.list_quality.cells.findIndex(function(t){return!t.img_select.visible}),this._curIdx=this._curIdx<0?0:this._curIdx,this._toIdx=this.list_quality.cells.findIndex(function(t){return t&&t.dataSource&&t.dataSource.tbEscort.ID==e}),this._toIdx<0||(this._ringNum=0,this._time=60,this._inAnim=!0,this.startInterval()))},e.prototype.startInterval=function(){Laya.timer.clear(this,this.loopSelecteGoods),Laya.timer.loop(this._time,this,this.loopSelecteGoods)},e.prototype.loopSelecteGoods=function(){var t=this._curIdx;this._curIdx++;var e=this.list_quality.array.length;return this._curIdx>=e&&(t=e-1,this._curIdx=0),4==this._ringNum&&this._curIdx==this._toIdx&&(this._inAnim=!1,Laya.timer.clear(this,this.loopSelecteGoods),dispatchEvt(new o.EscortEvent(o.EscortEvent.ANIMATION_END))),this.list_quality.getCell(t).img_select.visible=!0,this.list_quality.getCell(this._curIdx).img_select.visible=!1,this._curIdx>=e-1&&this._ringNum++,2==this._ringNum&&this._curIdx==e-1?(this._time=60,void this.startInterval()):3==this._ringNum&&this._curIdx==e-1?(this._time=125,void this.startInterval()):void 0},e.prototype.selectItem=function(e){if(this.box_husong.visible){var t=this.list_quality.cells.find(function(t){return!t.img_select.visible});t&&(t.img_select.visible=!0);var i=this.list_quality.cells.find(function(t){return t.dataSource&&t.dataSource.tbEscort.ID==e});i&&(i.img_select.visible=!1)}},e.prototype.onRefresh=function(){this._inAnim?showToast(LanMgr.getLan("",10170)):dispatchEvt(new o.EscortEvent(o.EscortEvent.REFRESH_GOODS))},e.prototype.onOnekey=function(){this._inAnim?showToast(LanMgr.getLan("",10170)):dispatchEvt(new o.EscortEvent(o.EscortEvent.ONEKEY_REFRESH_GOODS))},e.prototype.onEscort=function(){this._inAnim?showToast(LanMgr.getLan("",10170)):dispatchEvt(new o.EscortEvent(o.EscortEvent.ESCORT_GOODS))},e.prototype.onFinish=function(){var t=tb.TB_escort_set.getSet().complete_cost,e=LanMgr.getLan("",10307,t[1])+"<img style='padding:10px 3px 3px 3px;' src='"+SkinUtil.getCostSkin(t[0])+"' ></img>"+LanMgr.getLan("",10308);common.AlertBox.showAlert({text:e,confirmCb:function(){dispatchEvt(new o.EscortEvent(o.EscortEvent.QUICK_FINISH))},parm:null})},e.prototype.onRule=function(){dispatchEvt(new o.EscortEvent(o.EscortEvent.SHOW_RULE_VIEW))},e.prototype.onRecord=function(){dispatchEvt(new o.EscortEvent(o.EscortEvent.SHOW_RECORD_VIEW))},e.prototype.onReward=function(){UIMgr.showUI(UIConst.EscortView)},e.prototype.onFanHui=function(){dispatchEvt(new o.HudEvent(o.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_LILIAN))},e);function e(){var t=n.call(this)||this;return t._ringNum=0,t._time=50,t._inAnim=!1,t.isModelClose=!0,t.group=UIConst.hud_group,t}o.EscortMainView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.escort.CaravanInfoUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btnRob.off(Laya.Event.CLICK,this,this.onRob),this.linuepList.array=null,this.rewardList.array=null,this.bgPanel.dataSource=null},n.prototype.initView=function(){var t=this.dataSource;this.ui_head.dataSource=new UserHeadVo(t.svo.head,t.svo.level,t.svo.headFrame),this.lbName.text=t.svo.name,this.lbGuild.text=t.svo.guildName?t.svo.guildName:LanMgr.getLan("",10063),this.lbShenli.text=LanMgr.getLan("",10117,t.svo.force),this.linuepList.array=t.getExistGods(),this.lbRobCnt.text=LanMgr.getLan("",12434,e.EscortModel.getInstance().getRobCount()),this.rewardList.array=t.tbEscort.getRobList(),this.btnRob.on(Laya.Event.CLICK,this,this.onRob),this.bgPanel.dataSource={uiName:UIConst.CaravanInfoView,closeOnSide:this.isModelClose,title:t.tbEscort.name}},n.prototype.onRob=function(){dispatchEvt(new e.EscortEvent(e.EscortEvent.ROBBED_GOODS,this.dataSource))},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}e.CaravanInfoView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"EscortProcessor"},i.prototype.listenModuleEvents=function(){return[new r.EscortEvent(r.EscortEvent.SHOW_MAIN_VIEW),new r.EscortEvent(r.EscortEvent.SHOW_CARAVAN_INFO_VIEW),new r.EscortEvent(r.EscortEvent.SHOW_ESCORT_GOODS_VIEW),new r.EscortEvent(r.EscortEvent.SHOW_RECORD_VIEW),new r.EscortEvent(r.EscortEvent.SHOW_RULE_VIEW),new r.EscortEvent(r.EscortEvent.QUICK_FINISH),new r.EscortEvent(r.EscortEvent.ROBBED_GOODS),new r.EscortEvent(r.EscortEvent.REFRESH_GOODS),new r.EscortEvent(r.EscortEvent.ONEKEY_REFRESH_GOODS),new r.EscortEvent(r.EscortEvent.ESCORT_GOODS),new r.EscortEvent(r.EscortEvent.RECEIVE_AWARD)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof r.EscortEvent)switch(t.type){case r.EscortEvent.SHOW_MAIN_VIEW:this.showView();break;case r.EscortEvent.SHOW_CARAVAN_INFO_VIEW:this.showCarvanView(t.data);break;case r.EscortEvent.SHOW_ESCORT_GOODS_VIEW:break;case r.EscortEvent.SHOW_RECORD_VIEW:this.showRecordView();break;case r.EscortEvent.SHOW_RULE_VIEW:this.showRuleView();break;case r.EscortEvent.QUICK_FINISH:this.quickFinish();break;case r.EscortEvent.ROBBED_GOODS:this.robbedGoods(t.data);break;case r.EscortEvent.REFRESH_GOODS:this.refreshGoods();break;case r.EscortEvent.ONEKEY_REFRESH_GOODS:this.oneKeyGoods();break;case r.EscortEvent.ESCORT_GOODS:this.escortGoods();break;case r.EscortEvent.RECEIVE_AWARD:this.receiveAward()}},i.prototype.showView=function(){UIMgr.showUI(UIConst.EscortMainView)},i.prototype.showCarvanView=function(e){if(e.svo.playerId!=App.hero.playerId)if(this._model.getRobCount()<=0)showToast(LanMgr.getMsgByCode("RobCountNotEnough"));else if(App.serverTimeSecond>=e.svo.endTime)showToast(LanMgr.getLan("",10166));else if(e.svo.robCount>=tb.TB_escort_set.getSet().rob_num)showToast(LanMgr.getLan("",10165,2));else{var t={};t[Protocol.center_escort_getTargetInfo.args.playerId]=e.svo.playerId,PLC.request(Protocol.center_escort_getTargetInfo,t,function(t){t&&(e.setDetailInfo(t.targetInfo),UIMgr.showUI(UIConst.CaravanInfoView,e))})}else showToast(LanMgr.getMsgByCode("EscortIsMySelf"))},i.prototype.showRecordView=function(){var a=this;PLC.request(Protocol.game_escort_getRecordList,null,function(t){if(t){for(var e=[],i=0,n=t.recordList;i<n.length;i++){var o=n[i];e.push(new r.CaravanRecordVo(o))}e.length<=0?showToast(LanMgr.getLan("",10070)):(e.sort(function(t,e){return e.svo.recordTime-t.svo.recordTime}),a._model.updateNewRecord(!1),UIMgr.showUI(UIConst.RobbedRecordView,e))}})},i.prototype.showRuleView=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20009))},i.prototype.quickFinish=function(){var e=this,i=this._model;if(App.serverTimeSecond>=i.endTime)showToast(LanMgr.getLan("",10175));else{var t=tb.TB_escort_set.getSet().complete_cost;UIUtil.checkNotEnough(t[0],t[1])||PLC.request(Protocol.game_escort_quickEscort,null,function(t){t&&(i.updateEscortInfo(t.escortInfo),e.caravanMainView.refreshInterval(),e.caravanMainView.showReward(),dispatchEvt(new r.EscortEvent(r.EscortEvent.UPDATE_SELF_INFO)))})}},i.prototype.refreshGoods=function(){var e=this,i=this._model;if(i.isMaxQuality(i.escortId))showToast(LanMgr.getLan("",10169));else{var t=i.getRefreshCost();UIUtil.checkNotEnough(t[0],t[1])||PLC.request(Protocol.game_escort_refreshQuality,null,function(t){t&&(App.hero.escortTradeId=t.escortTradeId,i.updateEscortInfo(null),e.caravanMainView.startAnim(t.escortTradeId),e.caravanMainView.updateCost(),dispatchEvt(new r.EscortEvent(r.EscortEvent.REFRESH_GOODS_SUCCESS)))})}},i.prototype.oneKeyGoods=function(){var e=this,i=this._model;if(i.isMaxQuality(i.escortId))showToast(LanMgr.getLan("",10169));else{var t=i.getOneKeyCost();UIUtil.checkNotEnough(t[0],t[1])||PLC.request(Protocol.game_escort_refreshOrange,null,function(t){t&&(App.hero.escortTradeId=t.escortTradeId,i.updateEscortInfo(null),e.caravanMainView.selectItem(t.escortTradeId),e.caravanMainView.updateCost())})}},i.prototype.escortGoods=function(){var t=this._model;if(t.endTime>=App.serverTimeSecond)showToast(LanMgr.getLan("",10167));else if(t.getEscortCount()<=0)showToast(LanMgr.getMsgByCode("EscortCountNotEnough"));else if(t.isDoubleTime()||r.GuideWeakManager.isExcuting())this.onRequestEscortGoods();else{var e=this;common.AlertBox.showAlert({text:tb.TB_escort_set.getSet().double_prompt,confirmCb:function(){e.onRequestEscortGoods()}})}},i.prototype.onRequestEscortGoods=function(){var n=this;PLC.request(Protocol.game_escort_tradeEscort,null,function(t){if(t){var e=n._model;t.addEscort.playerId=App.hero.playerId;var i=new r.CaravanInfoVo(t.addEscort);e.updateEscortInfo({tradeId:i.svo.tradeId,endTime:i.svo.endTime}),App.hero.escortTradeId=t.escortTradeId,e.delayRewardInfo(),n.caravanMainView.addCaravan(i),n.caravanMainView.updateCount(),n.caravanMainView.refreshInterval(),UIMgr.hideUIByName(UIConst.EscortView),dispatchEvt(new r.EscortEvent(r.EscortEvent.ESCORT_GOODS_SUCCESS))}})},i.prototype.robbedGoods=function(e){var i=this;if(App.serverTimeSecond>=e.svo.endTime)showToast(LanMgr.getLan("",10166));else{var t={};t[Protocol.game_escort_robTradeBattleStart.args.playerId]=e.svo.playerId,PLC.request(Protocol.game_escort_robTradeBattleStart,t,function(t){t&&(e.setDetailInfo(t.targetInfo),i.doFight(e))})}},i.prototype.doFight=function(t){var i=new r.FightVo;i.copyType=CopyType.escort,i.caravanInfoVo=t;var e=new battle.BattleScenePvp(i.copyType);e.init([i.getOwnTeam()],i.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.god,i.getAllRound(),i.getTeamHp()),e.start();var n=e.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",n,"战报：",e.battleReport);var o=new r.ServerPage;o.result=n?playState.VICTORY:playState.FAILURE,o.initPage(e.battleReport),i.fightPageControl=o;var a={};a[Protocol.game_escort_robTradeBattleEnd.args.isWin]=n,a[Protocol.game_escort_robTradeBattleEnd.args.playerId]=t.svo.playerId,PLC.request(Protocol.game_escort_robTradeBattleEnd,a,function(t){if(t){var e={vo:i,event:new r.EscortEvent(r.EscortEvent.SHOW_MAIN_VIEW),responseData:t};dispatchEvt(new r.FightsEvent(r.FightsEvent.ENTER_FIGHT_EVENT),e)}})},i.prototype.receiveAward=function(){var i=this;PLC.request(Protocol.game_escort_receiveAwards,null,function(t){if(t){var e=i._model;e.updateEscortInfo(null),UIUtil.showRewardView(t.commonData),e.updateEscortInfo(t.escortInfo),i.caravanMainView.selectItem(App.hero.escortTradeId),UIMgr.hideUIByName(UIConst.EscortRewardView),dispatchEvt(new r.EscortEvent(r.EscortEvent.UPDATE_REWARD_RP))}})},Object.defineProperty(i.prototype,"caravanMainView",{get:function(){return UIMgr.getUIByName(UIConst.EscortMainView)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=r.EscortModel.getInstance(),t}r.EscortProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"CaravanEscortModule"},n.prototype.listProcessors=function(){return[new t.EscortProcessor]},n.prototype.onRegister=function(){t.EscortModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.EscortModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_MAIN_VIEW="SHOW_MAIN_VIEW",r.SHOW_CARAVAN_INFO_VIEW="SHOW_CARAVAN_INFO_VIEW",r.SHOW_ESCORT_GOODS_VIEW="SHOW_ESCORT_GOODS_VIEW",r.SHOW_RULE_VIEW="SHOW_RULE_VIEW",r.SHOW_RECORD_VIEW="SHOW_RECORD_VIEW",r.ROBBED_GOODS="ROBBED_GOODS",r.QUICK_FINISH="QUICK_FINISH",r.REFRESH_GOODS="REFRESH_GOODS",r.ONEKEY_REFRESH_GOODS="ONEKEY_REFRESH_GOODS",r.ESCORT_GOODS="ESCORT_GOODS",r.RECEIVE_AWARD="RECEIVE_AWARD",r.REFRESH_GOODS_SUCCESS="REFRESH_GOODS_SUCCESS",r.ESCORT_GOODS_SUCCESS="ESCORT_GOODS_SUCCESS",r.UPDATE_SELF_INFO="UPDATE_SELF_INFO",r.UPDATE_RECORD_RP="UPDATE_RECORD_RP",r.UPDATE_REWARD_RP="UPDATE_REWARD_RP",r.ANIMATION_END="ANIMATION_END",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.EscortEvent=a}(game=game||{}),function(r){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initModel=function(){var e=this;this._goodsList=[],this.caravanList=[];var t=TableData.getInstance().getTableByName(TableData.tb_escort).data;for(var i in t)this._goodsList.push(new r.CaravanGoodsVo(t[i]));App.IsSysOpen(ModuleConst.CARAVAN_ESCORT)&&PLC.request(Protocol.center_escort_getSelfInfo,null,function(t){e.updateEscortInfo(t?t.escortInfo:null),dispatchEvt(new r.EscortEvent(r.EscortEvent.UPDATE_SELF_INFO)),e.delayRewardInfo()})},e.prototype.delayRewardInfo=function(){0<this.endTime&&App.serverTimeSecond<this.endTime&&Laya.timer.once(this.endTime-App.serverTimeSecond,this,function(){dispatchEvt(new r.EscortEvent(r.EscortEvent.UPDATE_REWARD_RP))})},e.prototype.updateEscortInfo=function(t){t?(this.escortId=t.tradeId,this.endTime=t.endTime):(this.escortId=App.hero.escortTradeId,this.endTime=0)},e.prototype.requestCaravanList=function(){var a=this;return this.caravanList=[],new Promise(function(o,t){PLC.request(Protocol.center_escort_getEscortList,null,function(t){if(t){a.caravanList=[],a.updateEscortInfo(t.escortInfo);for(var e=0,i=t.escortList;e<i.length;e++){var n=i[e];a.caravanList.push(new r.CaravanInfoVo(n))}a.caravanList.sort(function(t,e){return t.svo.endTime-e.svo.endTime}),o()}})})},e.prototype.getCaravanList=function(){for(var t=[];0<this.caravanList.length&&t.length<10;)t.push(this.caravanList.shift());return t},e.prototype.getItemRender=function(){return 0<this._itemCacheList.length?this._itemCacheList.shift():new r.CaravanIR},e.prototype.pushItemRender=function(t){-1==this._itemCacheList.indexOf(t)&&this._itemCacheList.push(t)},e.prototype.getGoodsList=function(){return this._goodsList},e.prototype.getRefreshCost=function(){var t=tb.TB_escort_set.getSet().refresh_item;return App.isEnough(t[0],t[1])?t:[iface.tb_prop.resTypeKey.diamond,tb.TB_escort_set.getSet().refresh_cost]},e.prototype.getOneKeyCost=function(){var t=tb.TB_escort_set.getSet().auto_item;return App.isEnough(t[0],t[1])?t:[iface.tb_prop.resTypeKey.diamond,tb.TB_escort_set.getSet().auto_cost]},e.prototype.isMaxQuality=function(t){return 4==t},e.prototype.isDoubleTime=function(){for(var t=new Date(App.serverTime).getHours(),e=0,i=tb.TB_escort_set.getSet().double_time;e<i.length;e++){var n=i[e];if(t>=Number(n[0])&&t<Number(n[1]))return!0}return!1},e.prototype.getEscortCount=function(){return tb.TB_escort_set.getSet().escort_num-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.escortCount)},e.prototype.getRobCount=function(){return tb.TB_escort_set.getSet().rob_num-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.robCount)},e.prototype.canDoubleEscort=function(){return!!this.isDoubleTime()&&0<this.getEscortCount()&&App.serverTimeSecond>=this.endTime},e.prototype.updateNewRecord=function(t){this.hasNewRecord=t,dispatchEvt(new r.EscortEvent(r.EscortEvent.UPDATE_RECORD_RP))},e.prototype.canReward=function(){var t=this.endTime;return 0<t&&t<=App.serverTimeSecond},e);function e(){this.endTime=0,this.escortId=0,this.caravanList=[],this._itemCacheList=[],this.hasNewRecord=!1}r.EscortModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var i,t=(i=ui.equip.EquipStrengthenUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView(this.dataSource)},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView(this.dataSource)},e.prototype.initView=function(t){this.dataSource=t,this.ui_itemBox.dataSource=t,this.btn_last.disabled=1==t.slot,this.btn_next.disabled=4==t.slot;var e=t.getStrengthLv(),i=e==tb.TB_equip_set.get_TB_equip_setById().strength_maxlevel;this.lab_nextLevel.visible=this.imgArrow.visible=!i,this.lab_name.changeText(t.tab_item.name),this.lab_nowLevel.changeText(e.toString()),this.lab_nextLevel.changeText((e+1).toString()),this.list_proprety.array=this.getCurLvAndNextLvAttri(t),this.oneList.array=i?null:CostVo.createCostVos(t.strengthCost()),this.fiveList.array=i?null:CostVo.createCostVos(t.strengthCost(5));var n=s.EquipModel.getInstance();this.btn_last.visible=n.showEquipByView!=EquipType.BAG_VIEW,this.btn_next.visible=n.showEquipByView!=EquipType.BAG_VIEW,this.btn_once.gray=this.btn_five.gray=!App.IsSysOpen(ModuleConst.EQUIP_STRENGTH),this.bgPanel.dataSource={uiName:UIConst.Equip_StrengthView,closeOnSide:this.isModelClose},tl3d.ModuleEventManager.addEvent(s.ResEvent.PROP_CHANGE,this.updateView,this),tl3d.ModuleEventManager.addEvent(s.ResEvent.RESOURCE_CHANGE,this.updateView,this)},e.prototype.updateView=function(){this.initView(this.dataSource)},e.prototype.getCurLvAndNextLvAttri=function(t){var e=t.getStrengthAttr(),i=t.getStrengthAttr(1),n=s.EquipModel.getInstance().arrLongAttriName,o=new Array;for(var a in e){var r={};r.name=n[Number(a)],r.value=e[a],r.nextValue=i[a]||0,o.push(r)}return o},e.prototype.equipStrength=function(t){if(App.IsSysOpen(ModuleConst.EQUIP_STRENGTH)){var e=this.dataSource;if(e.getStrengthLv()>=s.EquipModel.getInstance().tbEquipSet.strength_maxlevel)showToast(LanMgr.getLan("",10306));else{var i=App.hero.getGodVoById(e.godId),n=(t==iface.tb_prop.equipStthTypeKey.one?this.oneList.array:this.fiveList.array).find(function(t){return t.isNotHaveCost()});if(n)showToast(LanMgr.getLan("",Lans.cost,n.itemId));else{var o={type:t,uuid:e.uuid,godId:i.uuid};dispatchEvt(new s.EquipEvent(s.EquipEvent.EQUIP_OPERATION),[o,EquipOperation.STRENGTH])}}}else showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIP_STRENGTH).prompt)},e.prototype.switch=function(t){var e={equip:this.dataSource,type:t};dispatchEvt(new s.EquipEvent(s.EquipEvent.EQUIP_OPERATION),[e,EquipOperation.SWITCH])},e.prototype.playeff=function(){this.ani_succ.play(0,!1)},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.list_proprety.array=null,tl3d.ModuleEventManager.removeEvent(s.ResEvent.PROP_CHANGE,this.updateView,this),tl3d.ModuleEventManager.removeEvent(s.ResEvent.RESOURCE_CHANGE,this.updateView,this)},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t.btn_next.on(Laya.Event.CLICK,t,t.switch,[1]),t.btn_last.on(Laya.Event.CLICK,t,t.switch,[-1]),t.btn_once.on(Laya.Event.CLICK,t,t.equipStrength,[iface.tb_prop.equipStthTypeKey.one]),t.btn_five.on(Laya.Event.CLICK,t,t.equipStrength,[iface.tb_prop.equipStthTypeKey.five]),t}s.StrengthView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.equip.EquipRefineUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView(this.dataSource)},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView(this.dataSource)},e.prototype.initView=function(t){this.dataSource=t,this.initHeroCostAry(),this.ui_itemBox.dataSource=t,this.btn_last.disabled=1==t.slot,this.btn_next.disabled=4==t.slot,this._perCurExp=t.getcurRefineExp();var e=t.getRefineLevel();this.lab_nowLevel.changeText(e.toString()),this.lab_nextLevel.changeText((e+1).toString()),this.list_nowAtrri.dataSource=t.getAttributeByValue(0,0),this.lab_xiajie.visible=t.refineLv<this.tbEquipSet.refine_maxlevel;var i=n.EquipModel.getInstance();this.btn_last.visible=i.showEquipByView!=EquipType.BAG_VIEW,this.btn_next.visible=i.showEquipByView!=EquipType.BAG_VIEW,this.bgPanel.dataSource={uiName:UIConst.Equip_Refine,closeOnSide:this.isModelClose},t.refineLv<this.tbEquipSet.refine_maxlevel?this.list_nextAtrri.array=t.getAttributeByValue(0,1):this.list_nextAtrri.array=[]},e.prototype.initHeroCostAry=function(){var t=this.dataSource,e=(App.hero.getGodVoById(t.godId),this.tbEquipSet.refine_maxlevel);if(this.btn_red.disabled=t.refineLv==e,this.btn_add.disabled=t.refineLv==e,this.lab_maxLv.text=t.refineLv==this.tbEquipSet.refine_maxlevel?LanMgr.getLan("",12589):LanMgr.getLan("",12590),this.lab_maxLv.visible=t.refineLv==e,this.img_right.visible=t.refineLv!=e,this.btn_red10.disabled=t.refineLv==e,this.btn_add10.disabled=t.refineLv==e,this.lab_nextLevel.visible=t.refineLv!=e,t.refineLv==e)return this.input_level.text="0",this.lab_nextLevel.text="",void(this.costList.array=[]);this.computeRefineCost()},e.prototype.computeRefineCost=function(){var t=this.dataSource;this._maxRefineLevel=t.getCanRefineNum(),this.upGradeNeedCost(1)},e.prototype.upGradeNeedCost=function(t){var e=this.dataSource,i=(App.hero.getGodVoById(e.godId),this.tbEquipSet.refine_maxlevel);t=Math.max(1,t),t=Math.min(i-e.refineLv,t),this.input_level.text=t.toString(),this.lab_nextLevel.text=e.refineLv+t+"",this.list_nextAtrri.array=e.getAttributeByValue(0,t);var n=map2ary(e.getRefineCost(t));this.costList.array=CostVo.createCostVos(n),this.btn_add.disabled=t+e.refineLv>=i,this.btn_red.disabled=t<=1,this.btn_red10.disabled=this.btn_red.disabled,this.btn_add10.disabled=this.btn_add.disabled},e.prototype.switch=function(t){var e={equip:this.dataSource,type:t};dispatchEvt(new n.EquipEvent(n.EquipEvent.EQUIP_OPERATION),[e,EquipOperation.SWITCH])},e.prototype.redlevel=function(t){var e=Number(this.input_level.text)-t;this.upGradeNeedCost(e)},e.prototype.addlevel=function(t){if(0!=this._maxRefineLevel){var e=Number(this.input_level.text)+t;this.upGradeNeedCost(e)}else showToast(LanMgr.getLan("",10287))},e.prototype.refine=function(){var t={uuid:this.dataSource.uuid,refNum:Number(this.input_level.text),type:1};dispatchEvt(new n.EquipEvent(n.EquipEvent.EQUIP_OPERATION),[t,EquipOperation.REFINE])},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.list_nowAtrri.array=null,this.list_nextAtrri.array=null},e);function e(){var t=i.call(this)||this;return t.tbEquipSet=tb.TB_equip_set.get_TB_equip_setById(1),t._isSchedule=!1,t.isModelClose=!0,t.btn_refine.on(Laya.Event.CLICK,t,t.refine),t.btn_next.on(Laya.Event.CLICK,t,t.switch,[1]),t.btn_last.on(Laya.Event.CLICK,t,t.switch,[-1]),t.btn_red.on(Laya.Event.CLICK,t,t.redlevel,[1]),t.btn_add.on(Laya.Event.CLICK,t,t.addlevel,[1]),t.btn_red10.on(Laya.Event.CLICK,t,t.redlevel,[10]),t.btn_add10.on(Laya.Event.CLICK,t,t.addlevel,[10]),t}n.RefineView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.equip.EquipRecycleUI,__extends(n,i),n.prototype.popup=function(){i.prototype.popup.call(this),this.lab_info.text=LanMgr.getLan("",12592,this.dataSource.length),this.bgPanel.dataSource={uiName:UIConst.Equip_Recycle,closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12591)};var t=e.EquipModel.getInstance().countReturnItem(this.dataSource);this.list_item.spaceX=6<=t.length?6:15,this.list_item.array=t,this.list_item.width=6<=t.length?525:90*t.length+(t.length-1)*this.list_item.spaceX},n.prototype.recycle=function(){for(var i=this,t=new Array,e=0;e<this.dataSource.length;e++)t.push(Number(this.dataSource[e].uuid));var n={};n[Protocol.game_equip_recycle.args.equipKeys]=t,PLC.request(Protocol.game_equip_recycle,n,function(t,e){t&&(UIUtil.showRewardView(t.commonData),UIMgr.hideUIByName(UIConst.EquipChangeView),i.close())})},n.prototype.close=function(){i.prototype.close.call(this),this.bgPanel.dataSource=null,this.list_item.array=null},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.btn_close.on(Laya.Event.CLICK,t,t.close),t.btn_recycle.on(Laya.Event.CLICK,t,t.recycle),t}e.EquipRecycleView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var s,e=(s=ui.equip.EquipMasterUI,__extends(i,s),i.prototype.popup=function(){s.prototype.popup.call(this),this.bgPanel.dataSource={uiName:UIConst.Equip_MasterView,closeOnSide:this.isModelClose};var t=this.dataSource[0],e=this.dataSource[1];this.bgPanel.updateTitle(e==EquipTabType.strength?LanMgr.getLan("",12595):LanMgr.getLan("",12596));var i=e==EquipTabType.strength?LanMgr.getLan("",10304):LanMgr.getLan("",10305),n=e==EquipTabType.strength?t.countMasterLevel():t.refineMasterLevel();this.lab_masterName.text=0==n?LanMgr.getLan("",12593,i):LanMgr.getLan("",12594,i,n);var o=e==EquipTabType.strength?tb.TB_strength_suit.get_TB_strength_suitById(n):tb.TB_refine_suit.get_TB_refine_suitById(n),a=e==EquipTabType.strength?tb.TB_strength_suit.get_TB_strength_suitById(n+1):tb.TB_refine_suit.get_TB_refine_suitById(n+1),r=[];o||((o=e==EquipTabType.strength?new tb.TB_strength_suit:new tb.TB_refine_suit).ID=0,o.level=0,o.attr=[[1,0],[2,0],[3,0]]),r.push(o),a?(r.push(a),this.list_levelInfo.array=r,this.list_levelInfo.width=550,this.imgArrow.visible=!0):(this.list_levelInfo.array=r,this.list_levelInfo.width=232,this.imgArrow.visible=!1),Laya.timer.frameOnce(3,this,this.delayRender)},i.prototype.delayRender=function(){for(var t=0;t<this.list_levelInfo.cells.length;t++){var e=this.list_levelInfo.cells[t];e&&e.refreshData(0==t)}},i.prototype.close=function(){s.prototype.close.call(this),Laya.timer.clearAll(this),this.list_levelInfo.array=null,this.bgPanel.dataSource=null},i);function i(){var t=s.call(this)||this;return t.isModelClose=!0,t.bgPanel.addChildAt(t.img_bg,3),t}t.MasterView=e;var n,o=(n=ui.equip.MasterRenderUI,__extends(a,n),Object.defineProperty(a.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),a.prototype.initView=function(){var t=this.dataSource;this._dataSource?t instanceof tb.TB_strength_suit?(this.lab_masterLv.text=LanMgr.getLan("",12435,t.ID),this.lab_need.text=LanMgr.getLan("",12437,t.level),this.lab_need.visible=0<t.ID,this.list_attr.array=t.attr):t instanceof tb.TB_refine_suit&&(this.lab_masterLv.text=LanMgr.getLan("",12436,t.ID),this.lab_need.text=LanMgr.getLan("",12438,t.level),this.lab_need.visible=0<t.ID,this.list_attr.array=t.attr):this.list_attr.array=null},a.prototype.onAttrRender=function(t,e){var i=t.dataSource;if(i){var n=i[0],o=i[1];t.text=iface.tb_prop.attrType[n]+"：+"+o}},a.prototype.refreshData=function(t){for(var e=0;e<this.list_attr.cells.length;e++)this.list_attr.cells[e]},a);function a(){var t=n.call(this)||this;return t.list_attr.renderHandler=new Handler(t,t.onAttrRender),t}t.MasterItemRender=o}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=ui.equip.JumpViewUI,__extends(i,e),i.prototype.popup=function(){e.prototype.popup.call(this),this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12439)};var t=this.dataSource;Array.isArray(this.dataSource)?this.refreshByAry(t):this.refreshData(t)},i.prototype.refreshData=function(t){this.icon.visible=this.lab_name.visible=this.lab_num.visible=!0,this.bg.y=193,this.list_where.y=211;var e=tb.TB_item.get_TB_itemById(t);this.list_where.dataSource=e.way_link;var i=new ItemVo(t,0,0);this.icon.dataSource=i,this.lab_name.text=e.name,this.lab_num.text=LanMgr.getLan("",12440,App.hero.getBagItemNum(t))},i.prototype.refreshByAry=function(t){this.bg.y=123,this.list_where.y=131,this.icon.dataSource=null,this.icon.visible=this.lab_name.visible=this.lab_num.visible=!1,this.list_where.dataSource=t},i.prototype.close=function(){e.prototype.close.call(this),this.bgPanel.dataSource=null},i);function i(){var t=e.call(this)||this;return t.isModelClose=!0,t.bgPanel.addChildAt(t.bg,3),t}o.JumpView=t;var n,a=(n=ui.god.render.GetItemBoxUI,__extends(r,n),Object.defineProperty(r.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),r.prototype.refreshData=function(){if(this._dataSource){var t=tb.TB_sys_open.get_TB_sys_openById(this._dataSource[0]);this.lab_name.text=t.name,this.btn_goto.on(Laya.Event.CLICK,this,this.gotoView,[t.ID]),this.img_di.on(Laya.Event.CLICK,this,this.gotoView,[t.ID])}else this.lab_name.text="",this.btn_goto.off(Laya.Event.CLICK,this,this.gotoView),this.img_di.off(Laya.Event.CLICK,this,this.gotoView)},r.prototype.gotoView=function(t){if(!this.isBtnFunctiNotonOpen(t)){if(t==ModuleConst.SHOP){var e=UIMgr.getUIByName(UIConst.Equip_JumpView);if(e){var i=tb.TB_goods.get_TB_goods().find(function(t){return t.item_id[0]==e.dataSource});if(i){var n=o.ShopModel.getInstance();n.requestShopList(i.type).then(function(){var t={item:i,arrlimit:n.getLimitNumById(i.type,i.ID)};dispatchEvt(new o.ShopEvent(o.ShopEvent.SHOW_GOUMAI_PANEL),t)})}}}else dispatchEvt(new o.HudEvent(o.HudEvent.SHOW_MODULE_VIEW),[t]);dispatchEvt(new o.EquipEvent(o.EquipEvent.CLOSE_JUMP_VIEW))}},r.prototype.isBtnFunctiNotonOpen=function(t){var e=tb.TB_sys_open.get_TB_sys_openById(t);return!(!e||App.IsSysOpen(t)||(showToast(e.prompt),0))},r);function r(){return n.call(this)||this}o.GetItemRender=a}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var n,t=(n=ui.equip.EquipViewUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.EQUIPMENT)},e.prototype.setSize=function(t,e){n.prototype.setSize.call(this,t,e),this.view_list.height=e,this.viewBaoshi.height=e-this.view_list.y,this.viewEquip.height=e-this.view_list.y,this.boxTop.y=GameUtil.isFullScreen()?5+l.HudModel.TOP_ADD_HEIGHT:5},e.prototype.onOpened=function(){n.prototype.onOpened.call(this),this._oldIndex=-1,this.initView();var t=GameUtil.isFullScreen()?5+l.HudModel.TOP_ADD_HEIGHT:5;UIUtil.boxUpDownTween(this.boxTop,-this.boxTop.height,t,!1,310,.1);var e=this.height-this.boxTab.height-90;UIUtil.boxUpDownTween(this.boxTab,e+this.boxTab.height,e,!0,310,.05);var i=this.viewEquip.height-this.viewEquip.boxBottom.height-89;UIUtil.boxUpDownTween(this.viewEquip.boxBottom,i+this.viewEquip.boxBottom.height,i,!0,310,.05),ResUseMgr.loadRes([ResConst.atlas_strength_effect])},Object.defineProperty(e.prototype,"curVo",{get:function(){return this.list_roles.array[this.list_roles.selectedIndex]},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this._initIndex=Array.isArray(this.dataSource)?this.dataSource[0]:-1,this.list_roles.array=App.hero.getGodAry().concat(null),this.list_roles.selectedIndex=0},e.prototype.onMouseIndex=function(t,n,e){var i;if(void 0===e&&(e=!1),!t||t.type==Laya.Event.CLICK){if(this._isplayTurnPan&&t)return void(-1==this._oldIndex?this.onMouseIndex(t,0,e):this.list_tab.selectedIndex=this._oldIndex);if(t&&(i=this.list_tab.selection),i&&i.img_suo.dataSource){var o=i.img_suo.dataSource,a=tb.TB_sys_open.get_TB_sys_openById(o);if(a&&!App.IsSysOpen(o))return showToast(a.prompt),void(-1==this._oldIndex?this.onMouseIndex(t,0,e):this.list_tab.selectedIndex=this._oldIndex)}var r=n;this.btnFenjie.visible=r!=EquipTabType.baoshi,this.list_tab.selectedIndex=n;var s=e||t&&0<=n&&n!=this._oldIndex;this._oldIndex=n,this.list_tab.cells.forEach(function(t,e){var i=t;i.btn_name.labelSize=n==e?24:22,i.btn_name.labelColors=n==e?"#7e5336,#7e5336,#7e5336":"#e6ca91,#e6ca91,#e6ca91"}),1<=n&&--n;var u=this.view_list.selection;u&&u.close(),this.view_list.selectedIndex=n,this.view_list.items[n].dataSource=this.curVo;var h=this.view_list.selection;h&&(h.init(r),dispatchEvt(new l.EquipEvent(l.EquipEvent.SWITCH_TAB_SUCCESS),r)),s&&this.playTurnPan()}},e.prototype.playTurnPan=function(){var t=this.view_list.selection;t?(this._isplayTurnPan=!0,t.playEquipEff(this.stopTurnPan.bind(this))):this._isplayTurnPan=!1},e.prototype.stopTurnPan=function(){this._isplayTurnPan=!1},e.prototype.onGodSelect=function(t){if(this.list_roles.array[t]){this._oldGodSelect=this.list_roles.selectedIndex,this._model.curShowGod=this.list_roles.array[t],dispatchEvt(new l.GodEvent(l.GodEvent.SELECT_GOD_EVENT)),this.list_tab.refresh();var e=this.list_tab.selectedIndex;0<=this._initIndex?(this.onMouseIndex(null,this._initIndex,!0),this._initIndex=-1):-1!=e?this.onMouseIndex(null,e,!0):this.onMouseIndex(null,0,!0)}else dispatchEvt(new l.SummonEvent(l.SummonEvent.SHOW_ZHAOHUAN_PANEL))},e.prototype.refreshData=function(t){var e=this;if(t){var i=App.hero.getGodAry().find(function(t){return t.uuid==e.curVo.uuid});i&&(this.curVo.equipKeys=i.equipKeys)}this.onMouseIndex(null,this.list_tab.selectedIndex),this.viewEquip.visible&&this.viewEquip.refreshGod()},e.prototype.onFenjie=function(){dispatchEvt(new l.BagEvent(l.BagEvent.OPEN_SELL_VIEW))},e.prototype.onRenderIndex=function(t,e){this.curVo&&t.dataSource&&(t.img_suo.visible=!1,0!=t.dataSource[1]&&(t.img_suo.visible=!App.IsSysOpen(t.dataSource[1]),t.img_suo.dataSource=t.dataSource[1]),t.btn_name.selected=e==this.list_tab.selectedIndex&&!t.img_suo.visible,t.img_suo.visible?t.tabRedPoint.onDispose():t.tabRedPoint.setRedPointName(this._model.equiptabredName[e]+"_"+this.curVo.uuid))},e.prototype.onRender=function(t,e){var i=t.headBox;i.visible=!!t.dataSource,t.box_null.visible=!i.visible;var n=this.list_roles.array[e];n&&(i.img_shangzhen.visible=n.isInLinuep(iface.tb_prop.lineupTypeKey.attack),t.redPoint.onDispose(),t.dataSource&&App.hero.isInLineup(t.dataSource.uuid,iface.tb_prop.lineupTypeKey.attack)&&t.redPoint.setRedPointName("attack_linuep_god_equip_"+t.dataSource.uuid))},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.viewBaoshi.stopEquipEff(),this.viewEquip.stopEquipEff(),this.viewEquip.close(),this.viewBaoshi.close(),this.list_roles.array=null,this.list_tab.selectedIndex=-1,this.stopTurnPan()},e);function e(){var t=n.call(this)||this;return t._initIndex=-1,t._oldIndex=-1,t._isplayTurnPan=!1,t._oldGodSelect=-1,t._model=l.EquipModel.getInstance(),t.group=UIConst.hud_group,t.list_tab.array=t._model.equipTabName,t.list_roles.renderHandler=new Handler(t,t.onRender),t.list_tab.mouseHandler=new Handler(t,t.onMouseIndex),t.list_tab.renderHandler=new Handler(t,t.onRenderIndex),t.list_roles.selectHandler=new Handler(t,t.onGodSelect),t.btnFenjie.on(Laya.Event.CLICK,t,t.onFenjie),t}l.EquipView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.equip.EquipTipsUI,__extends(n,i),n.showTip=function(t,e){t==this._target&&this._tips||(this._target=t,this._tips||(this._tips=new n),this._tips.dataSource=e,this._tips.parent?this._tips.initView():this._tips.show(!1,!1),this._tips.x=Laya.stage.mouseX+this._tips.width>Laya.stage.width?Laya.stage.width-this._tips.width:Laya.stage.mouseX,this._tips.y=Laya.stage.mouseY+this._tips.height>Laya.stage.height?Laya.stage.height-this._tips.height:Laya.stage.mouseY,Laya.stage.on(Laya.Event.CLICK,this,this.onClickStage))},n.onClickStage=function(t){this._tips&&this._tips.hitTestPoint(Laya.stage.mouseX,Laya.stage.mouseY)||this._target&&this._target.hitTestPoint(Laya.stage.mouseX,Laya.stage.mouseY)||this.HideTip()},n.HideTip=function(){this._target=null,this._tips&&(this._tips.close(),this._tips.removeSelf(),this._tips.destroy(!0),this._tips=null),Laya.stage.off(Laya.Event.CLICK,this,this.onClickStage)},n.prototype.show=function(t,e){this.popupCenter=!1,i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){this.initView(!0),this.popupCenter=!0,i.prototype.popup.call(this,t,e)},n.prototype.onOpened=function(){i.prototype.onOpened.call(this)},n.prototype.initView=function(t){void 0===t&&(t=!1),this._isHideBtn=t,this.clear(),this._equipData=this.dataSource,this._spiltArr=[],this.updateData()},n.prototype.updateData=function(){this.updateTop(),this.updateBase(),this.updateJingLian(),this.updateSuit(),this.layout()},n.prototype.updateTop=function(){this._equipData&&(this.lab_name.text=this._equipData.tab_item.name+"+"+this._equipData.strengthLv,this.lab_quality.text=LanMgr.getLan("",12374,LanMgr.qualityName[this._equipData.quality]),this.ui_item_icon.dataSource=this._equipData,this.img_bg_quality.skin=LanMgr.getLan("zhaungbei/zhaungbeipinzhi0{0}.png",-1,this._equipData.quality))},n.prototype.updateBase=function(){if(this._equipData){this._baseTitle=new Laya.Label(LanMgr.getLan("",12373)),this._baseTitle.color="#e8c859",this._baseTitle.fontSize=22,this.addChild(this._baseTitle),this._baseBtn=new Laya.Button("comp/button/btn_qianwang.png"),this._baseBtn.stateNum=2,this._baseBtn.width=97,this._baseBtn.height=40,this._baseBtn.label=LanMgr.getLan("",12375),this._baseBtn.labelSize=22,this._baseBtn.labelColors="#ffffff,#ffffff,#ffffff",this._baseBtn.labelStroke=4,this._baseBtn.labelStrokeColor="#538901",this._baseBtn.on(Laya.Event.CLICK,this,this.onClickBase),this.addChild(this._baseBtn),this._baseArr=[];var t=this._equipData.getStrengthAttr(),e=LanMgr.attrName,i=[];for(var n in t)if(0!=t[n]){var o={};o.name=LanMgr.getLan(e[Number(n)],-1),o.value=t[n],i.push(o)}for(n=0;n<i.length;n++){var a=new Laya.Label;a.color="#ffeecc",a.fontSize=20,a.text=LanMgr.getLan("{0}:{1}",-1,i[n].name,i[n].value),this.addChild(a),this._baseArr.push(a)}}},n.prototype.updateJingLian=function(){if(this._equipData)if(this.addSplit(),this._jingLianTitle=new Laya.Label(LanMgr.getLan("",12441)),this._jingLianTitle.color="#e8c859",this._jingLianTitle.fontSize=22,this.addChild(this._jingLianTitle),this._jingLianBtn=new Laya.Button("comp/button/btn_qianwang.png"),this._jingLianBtn.stateNum=2,this._jingLianBtn.width=97,this._jingLianBtn.height=40,this._jingLianBtn.label=LanMgr.getLan("",12442),this._jingLianBtn.labelSize=22,this._jingLianBtn.labelColors="#ffffff,#ffffff,#ffffff",this._jingLianBtn.labelStroke=4,this._jingLianBtn.labelStrokeColor="#538901",this._jingLianBtn.on(Laya.Event.CLICK,this,this.onClickJingLian),this.addChild(this._jingLianBtn),this._jingLianArr=[],this._equipData.refineLv<=0)(i=new Laya.Label).color="#ffeecc",i.fontSize=20,i.text=LanMgr.getLan("",12084),this.addChild(i),this._jingLianArr.push(i);else for(var t=this._equipData.getAttributeByValue(0,0),e=0;e<t.length;e++){var i;(i=new Laya.Label).color="#ffeecc",i.fontSize=20,i.text="【Lv."+this._equipData.refineLv+"】"+t[e],this.addChild(i),this._jingLianArr.push(i)}},n.prototype.updateSuit=function(){if(this._equipData){var t=this._model,e=this._equipData.getEquipAllSuitArray();if(e&&0<e.length){this.addSplit(),this._suitTitle=new Laya.Label(LanMgr.getLan("",12443)),this._suitTitle.color="#e8c859",this._suitTitle.fontSize=22,this.addChild(this._suitTitle),this._suitArr=[];for(var i=LanMgr.attrName,n=0;n<e.length;n++){var o=e[n].getQuality(),a=e[n].getCount(),r=new Laya.Label;r.fontSize=20,t.getEquipQualityNum(this._equipData.godId,o)>=a?r.color="#2aff00":r.color="#ffeecc",r.text=LanMgr.getLan("",12444,i[e[n].suit_percent[0]],100*e[n].suit_percent[2],a),this.addChild(r),this._suitArr.push(r)}}this._suitTHBtn=new Laya.Button("comp/button/button.png"),this._suitTHBtn.stateNum=2,this._suitTHBtn.label=LanMgr.getLan("",12379),this._suitTHBtn.labelSize=22,this._suitTHBtn.labelColors="#ffffff,#ffffff,#ffffff",this._suitTHBtn.labelStroke=4,this._suitTHBtn.labelStrokeColor="#ca7005",this.addChild(this._suitTHBtn),this._suitTHBtn.on(Laya.Event.CLICK,this,this.onClickTH),this._suitTZBtn=new Laya.Button("comp/button/btn_quxiao.png"),this._suitTZBtn.stateNum=2,this._suitTZBtn.label=LanMgr.getLan("",12380),this._suitTZBtn.labelSize=22,this._suitTZBtn.labelColors="#ffffff,#ffffff,#ffffff",this._suitTZBtn.labelStroke=4,this._suitTZBtn.labelStrokeColor="#e6360d",this.addChild(this._suitTZBtn),this._suitTZBtn.on(Laya.Event.CLICK,this,this.onClickTZ)}},n.prototype.addSplit=function(){var t=new Laya.Image("comp/image/zhaungbeixingxi02.png");this.addChild(t),this._spiltArr.push(t)},n.prototype.layout=function(){var t=150,e=0;if(this._baseTitle&&(this._baseTitle.x=24,this._baseTitle.y=t+5,this._baseBtn&&(this._baseBtn.x=this.width-15-this._baseBtn.width,this._baseBtn.y=t),t=this._baseTitle.y+this._baseTitle.height+10),this._baseArr)for(var i=0;i<this._baseArr.length;i++)(o=this._baseArr[i])&&(o.x=24,o.y=t,t+=o.height+10);if(this._jingLianTitle&&(this._spiltArr[e].x=24,this._spiltArr[e].y=t,e++,t+=10,this._jingLianTitle.x=24,this._jingLianTitle.y=t+5,this._jingLianBtn&&(this._jingLianBtn.x=this.width-15-this._jingLianBtn.width,this._jingLianBtn.y=t),t=this._jingLianTitle.y+this._jingLianTitle.height+10),this._jingLianArr)for(i=0;i<this._jingLianArr.length;i++)(o=this._jingLianArr[i])&&(o.x=24,o.y=t,t+=o.height+10);if(this._gemTitle&&(this._spiltArr[e].x=24,this._spiltArr[e].y=t,e++,t+=10,this._gemTitle.x=24,this._gemTitle.y=t+5,this._gemBtn&&(this._gemBtn.x=this.width-15-this._gemBtn.width,this._gemBtn.y=t),t=this._gemTitle.y+this._gemTitle.height+10),this._gemIcon)for(i=0;i<this._gemIcon.length;i++){var n=this._gemIcon[i];n&&(n.x=24,n.y=t,(o=this._gemArr[i])&&(o.x=24+n.width*n.scaleX+5,o.y=t+(n.height*n.scaleX-o.height)/2),t=t+n.height*n.scaleX+10)}if(this._gemEmpty&&(this._gemEmpty.x=24,this._gemEmpty.y=t+5,t=this._gemEmpty.y+this._gemEmpty.height+10),this._suitTitle&&(this._spiltArr[e].x=24,this._spiltArr[e].y=t,e++,t+=10,this._suitTitle.x=24,this._suitTitle.y=t+5,t=this._suitTitle.y+this._suitTitle.height+10),this._suitArr)for(i=0;i<this._suitArr.length;i++){var o;(o=this._suitArr[i])&&(o.x=24,o.y=t,t+=o.height+10)}this._suitTZBtn.x=15,this._suitTZBtn.y=t,this._suitTHBtn.x=24+this._suitTZBtn.width+0,this._suitTHBtn.y=t,t+=this._suitTHBtn.height+20,this.img_bg.height=this._isHideBtn?t-60:t,this.height=this._isHideBtn?t-60:t,this._baseBtn.visible=this._jingLianBtn.visible=this._suitTHBtn.visible=this._suitTZBtn.visible=!this._isHideBtn,this._gemBtn&&(this._gemBtn.visible=!this._isHideBtn)},n.prototype.onClickBase=function(){this.strengthen()},n.prototype.onClickJingLian=function(){this.refine()},n.prototype.onClickGem=function(){if(App.IsSysOpen(ModuleConst.EQUIP_BAOSHI)){var t=UIMgr.getUIByName(UIConst.EquipView);t&&t.onMouseIndex(null,2),n.HideTip()}else showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIP_BAOSHI).prompt)},n.prototype.onClickTH=function(){this.replace()},n.prototype.onClickTZ=function(){this.unLoad()},n.prototype.clear=function(){if(this.ui_item_icon.dataSource=null,this.lab_name.text="",this.lab_quality.text="",this.img_bg_quality.skin="",this.clearLabel(this._baseTitle),this.clearButton(this._baseBtn,this.onClickBase),this.clearLabelArr(this._baseArr),this._baseTitle=null,this._baseBtn=null,this._baseArr=null,this.clearLabel(this._jingLianTitle),this.clearButton(this._jingLianBtn,this.onClickJingLian),this.clearLabelArr(this._jingLianArr),this._jingLianTitle=null,this._jingLianBtn=null,this._jingLianArr=null,this.clearLabel(this._gemTitle),this.clearButton(this._gemBtn,this.onClickGem),this.clearLabelArr(this._gemArr),this._gemIcon){for(var t=0;t<this._gemIcon.length;t++){var e=this._gemIcon[t];e&&(e.dataSource=null,e.removeSelf(),e.destroy(!0),e=null)}this._gemIcon=null}if(this.clearLabel(this._gemEmpty),this._gemTitle=null,this._gemBtn=null,this._gemArr=null,this._gemEmpty=null,this.clearLabel(this._suitTitle),this.clearButton(this._suitTZBtn,this.onClickTZ),this.clearButton(this._suitTHBtn,this.onClickTH),this.clearLabelArr(this._suitArr),this._suitTitle=null,this._suitTHBtn=null,this._suitTZBtn=null,this._suitArr=null,this._spiltArr){for(t=0;t<this._spiltArr.length;t++){var i=this._spiltArr[t];i&&(i.removeSelf(),i.destroy(!0),i=null)}this._spiltArr=null}this.img_bg.height=200,this.height=200},n.prototype.clearLabel=function(t){t&&(t.removeSelf(),t.destroy(!0),t=null)},n.prototype.clearButton=function(t,e){t&&(e&&t.off(Laya.Event.CLICK,this,e),t.removeSelf(),t.destroy(!0),t=null)},n.prototype.clearLabelArr=function(t){if(t){for(var e=0;e<t.length;e++){var i=t[e];i&&(i.removeSelf(),i.destroy(!0),i=null)}t=null}},n.prototype.replace=function(){var t=this.dataSource;this._model.showEquipByView=EquipType.EQUIP_VIEW,dispatchEvt(new e.EquipEvent(e.EquipEvent.OPEN_EQUIP_PANEL),[t.slot,1,t]),n.HideTip()},n.prototype.refine=function(){App.IsSysOpen(ModuleConst.EQUIP_JINGLIAN)?(dispatchEvt(new e.EquipEvent(e.EquipEvent.SHOW_EQUIPREFINE_PANEL),this._dataSource),n.HideTip()):showToast(this._model.getRefineOpenData().prompt)},n.prototype.strengthen=function(){App.IsSysOpen(ModuleConst.EQUIP_STRENGTH)?(dispatchEvt(new e.EquipEvent(e.EquipEvent.SHOW_EQUIP_STH_PANEL),this._dataSource),n.HideTip()):showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIP_STRENGTH).prompt)},n.prototype.unLoad=function(){dispatchEvt(new e.EquipEvent(e.EquipEvent.EQUIP_OPERATION),[this.dataSource,EquipOperation.DISCHARGE])},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.clear(),this._equipData=null,this._isHideBtn=!1},n);function n(){var t=i.call(this)||this;return t._isHideBtn=!1,t.isModelClose=!0,t.mouseEnabled=!0,t.mouseThrough=!1,t._model=e.EquipModel.getInstance(),t}e.EquipTipsView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.equip.EquipSuitUI,__extends(i,e),i.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},i.prototype.initView=function(){var t=this.dataSource,e=t[0],o=t[1],i=(a.EquipModel.getInstance(),LanMgr.qualityColor[e]+LanMgr.getLan("",12597));this.lbName.text=i+"（"+o+"/4）：",this.bgPanel.updateTitle(i);var n=tb.TB_equip_suit.getSuitByQuality(e);n=n.map(function(t){var e=LanMgr.getLan("",12598,LanMgr.numChinese[t.ID%10])+"：",i=t.suit_percent,n=0==i[1]?i[2]:100*i[2]+"%";return{content:e+iface.tb_prop.attrType[i[0]]+"+"+n,enough:o>=t.ID%10}}),this.itemList.array=n},i.prototype.itemRender=function(t,e){var i=t.dataSource;t.text=i.content,t.color=i.enough?"#319c28":"#45290a"},i.prototype.close=function(){e.prototype.close.call(this),this.itemList.array=null},i);function i(){var t=e.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={closeOnButton:!0,closeOnSide:t.isModelClose,title:""},t.itemList.renderHandler=new Handler(t,t.itemRender),t.bgPanel.addChildAt(t.img_bg,3),t}a.EquipSuitsView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.equip.EquipSuitLvupUI,__extends(n,e),n.prototype.popup=function(){this.initView(),e.prototype.popup.call(this)},n.prototype.show=function(){this.initView(),e.prototype.show.call(this)},n.prototype.initView=function(){var t=this.dataSource[0],e=this.dataSource[1];this.clip_num.index=e%2!=0?e-e%2:e,this.clip_num.skin=t==QualityConst.PURPLE?SkinUtil.equip_purple_suit_num:t==QualityConst.ORANGE?SkinUtil.equip_orange_suit_num:SkinUtil.equip_red_suit_num,this.imgBg.skin=t==QualityConst.PURPLE?SkinUtil.equip_purple_suit:t==QualityConst.ORANGE?SkinUtil.equip_orange_suit:SkinUtil.equip_red_suit,this.visible=!1},n.prototype.onOpened=function(){var t=this;e.prototype.onOpened.call(this),this.y-=20,this.alpha=0,this.visible=!0,Laya.Tween.to(this,{y:this.y-150,alpha:1},600,Laya.Ease.linearIn,new Handler(this,function(){Laya.timer.once(1e3,t,function(){t.close()})}))},n.prototype.close=function(){e.prototype.close.call(this),Laya.Tween.clearAll(this),Laya.timer.clearAll(this)},n);function n(){var t=e.call(this)||this;return t.isModelClose=!1,t.mouseEnabled=!1,t}t.EquipSuitLvupView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.equip.EquipLvupUI,__extends(n,e),n.prototype.popup=function(){this.initView(),e.prototype.popup.call(this)},n.prototype.show=function(){this.initView(),e.prototype.show.call(this)},n.prototype.initView=function(){var t=this.dataSource[0],e=this.dataSource[1];9<e?(this.clip_ten.visible=!0,this.clip_one.x=237,this.clip_ten.index=e%10,this.clip_one.index=Math.floor(e/10)):(this.clip_ten.visible=!1,this.clip_one.x=255,this.clip_one.index=e),this.imgBg.skin=0==t?SkinUtil.equip_sth_lvup:SkinUtil.equip_ref_lvup,this.visible=!1},n.prototype.onOpened=function(){var t=this;e.prototype.onOpened.call(this),this.y-=20,this.alpha=0,this.visible=!0,Laya.Tween.to(this,{y:this.y-150,alpha:1},600,Laya.Ease.linearIn,new Handler(this,function(){Laya.timer.once(1e3,t,function(){t.close()})}))},n.prototype.close=function(){e.prototype.close.call(this),Laya.Tween.clearAll(this),Laya.timer.clearAll(this)},n);function n(){var t=e.call(this)||this;return t.isModelClose=!1,t.mouseEnabled=!1,t}t.EquipLvupView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var e,t=(e=ui.equip.EquipChangeUI,__extends(i,e),i.prototype.initUi=function(){this.shipinList=new common.BagRenderList(625,680),this.shipinList.itemRender=h.BagIR,this.shipinList.spaceY=5,this.shipinList.x=45,this.shipinList.y=87,this.addChild(this.shipinList)},i.prototype.popup=function(){e.prototype.popup.call(this),this.refreshData(),this.bgPanel.dataSource={uiName:UIConst.EquipChangeView,closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12599)}},i.prototype.refreshData=function(){var t;0==this.dataSource[1]||(t=App.hero.getEquips(this.dataSource[0],!0));for(var e=new Array,i=0;i<t.length;i++){var n=t[i];n.selectid=-1,n.indexid=i,n.bag=!1}for(var o=t.length,a=h.BagModel.line_num,r=o%a==0?o/a:Math.floor(o/a+1),s=0;s<r;s++){var u=t.slice(s*a,s*a+a);e.push(u)}this.shipinList.dataSource=e,this.dataSource[2]&&this.findSelected(this.dataSource[2].uuid)},i.prototype.findSelected=function(t){void 0===t&&(t=this.changeUuid);for(var e=this.shipinList.dataSource,i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++){var o=e[i][n];if(o.uuid==t){var a=Math.floor(o.indexid/h.BagModel.line_num);o.selectid=o.indexid,this.shipinList.dataSource[a][0].selectid=o.indexid,this.shipinList.scrollBarTo(100*a)}}},i.prototype.updateItem=function(t){this.changeUuid=t.uuid;for(var e=this.shipinList.dataSource,i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++){var o=e[i][n];if(t.uuid==o.uuid){t.selectid=o.selectid,t.indexid=o.indexid,e[i].splice(n,1,t);var a=Math.floor(o.indexid/h.BagModel.line_num);this.shipinList.getCell(a).updataItem(n)}}},i.prototype.close=function(){e.prototype.close.call(this),this.bgPanel.dataSource=null,this.shipinList.dataSource=[]},i);function i(){var t=e.call(this)||this;return t.isModelClose=!0,t.initUi(),t}h.EquipChangeView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var o,t;(t=o=r.EquipRoot||(r.EquipRoot={}))[t.Wear=1]="Wear",t[t.Strength=2]="Strength",t[t.Refine=3]="Refine",t[t.TakeOff=4]="TakeOff";var e,i=(e=ui.equip.tab.TabEquipUI,__extends(n,e),n.prototype.setSize=function(){},Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t},enumerable:!0,configurable:!0}),n.prototype.init=function(t){if(this.curType=t,this.setResEvent(!0),this.setEquipAccsItemData(),this.box_refine.visible=t==EquipTabType.refine,this.box_strength.visible=t==EquipTabType.strength,this.strengCkbox.visible=this.btn_strength.visible=this.btn_getStrengh.visible=App.IsSysOpen(ModuleConst.EQUIP_STRENGTH),this.dataSource.isAllEquipLvTop(EquipTabType.strength)){var e=this.dataSource.getCurLvAttriAndNext(t==EquipTabType.strength?1:0);e[1]=e[3]=e[5]=null,this.list_attr.array=e,this.img_arrow.visible=!1,this.list_attr.x=265}else this.list_attr.array=this.dataSource.getCurLvAttriAndNext(t==EquipTabType.strength?1:0),this.img_arrow.visible=!0,this.list_attr.x=145;var i=this.dataSource;this.strengthRP.setRedPointName("god_onekey_strength_"+i.uuid),this.equipRP.setRedPointName("god_onekey_equip_"+i.uuid),this.redpointRefine.setRedPointName("god_onekey_refine_"+i.uuid),t==EquipTabType.strength?this.setStrengthView():this.setRefineView(),this.refreshGod()},n.prototype.refreshGod=function(){this.updateSuit(),this.updateDaShi()},n.prototype.updateDaShi=function(){var t=this.dataSource;if(this.curType==EquipTabType.strength){var e=t.countMasterLevel();this.lab_dashi.text=0==e?LanMgr.getLan("",12448):LanMgr.getLan("",12435,e)}else{var i=t.refineMasterLevel();this.lab_dashi.text=0==i?LanMgr.getLan("",12449):LanMgr.getLan("",12436,i)}},n.prototype.updateSuit=function(){var t=this.dataSource.getMaxQualityAnNum();if(0<t.length){var e=t[1];switch(t[0]){case QualityConst.RED:this.lab_suit.text=LanMgr.getLan("",12601,LanMgr.getLan("",12445),LanMgr.numChinese[e]),this.lab_suit.color=ColorConst.RED;break;case QualityConst.ORANGE:this.lab_suit.text=LanMgr.getLan("",12601,LanMgr.getLan("",12446),LanMgr.numChinese[e]),this.lab_suit.color="#de8a0b";break;case QualityConst.PURPLE:this.lab_suit.text=LanMgr.getLan("",12601,LanMgr.getLan("",12447),LanMgr.numChinese[e]),this.lab_suit.color="#ca1fe2";break;default:this.lab_suit.text=LanMgr.getLan("",12600),this.lab_suit.color=ColorConst.normalFont}}else this.lab_suit.text=LanMgr.getLan("",12600),this.lab_suit.color=ColorConst.normalFont},n.prototype.onSuit=function(){var t=this._dataSource;if(t){var e=t.getMaxQualityAnNum();e.length<=0?showToast(LanMgr.getLan("",10300)):UIMgr.showUI(UIConst.Equip_SuitView,e)}},n.prototype.setCostText=function(){this.curType==EquipTabType.strength?this.setStrengthView():this.setRefineView()},n.prototype.setStrengthView=function(){var t=this._dataSource,e=t.getStrengthCost();this.costList.array=CostVo.createCostVos(e),this.box_cost.visible=this.costList.array&&0<this.costList.array.length&&App.IsSysOpen(ModuleConst.EQUIP_STRENGTH);var i=t.isAllEquipLvTop(EquipTabType.strength);this.boxMaxLv.visible=i,this.box_strength.visible=!i},n.prototype.setRefineView=function(){var t=this._dataSource,e=t.getRefineCost();this.costList.array=CostVo.createCostVos(e),this.box_cost.visible=this.costList.array&&0<this.costList.array.length,this.btn_rootRefine.selected=this.btn_rootRefine.gray=!App.IsSysOpen(ModuleConst.EQUIP_JINGLIAN);var i=t.isAllEquipLvTop(EquipTabType.refine);this.boxMaxLv.visible=i,this.box_refine.visible=!i},n.prototype.setEquipAccsItemData=function(t){t=t||this._dataSource;for(var e=[null,null,null,null],i=0;i<t.equipKeys.length;i++){var n=t.equipKeys[i];n.type=this.curType,e.splice(n.slot-1,1,n)}this.list_equips.array=e},n.prototype.updateView=function(t){this.setEquipAccsItemData(t),this.curType==EquipTabType.strength?this.setStrengthView():this.setRefineView()},n.prototype.onAttrRender=function(t,e){if(!t.dataSource)return t.lab_attr.text="",void(t.img_attrname.skin="");t.img_attrname.skin=SkinUtil.getAttrSkin(t.dataSource[0]),t.lab_attr.text="+"+t.dataSource[1],t.lab_attr.color=e%2==0?"#7e5336":"#319c28"},n.prototype.onEquipMouse=function(t,e){var i=r.EquipModel.getInstance();if(t.type==Laya.Event.CLICK){var n=this.list_equips.array[e];if(n)i.curPointEquipData=n,r.EquipTipsView.showTip(this.list_equips.cells[e],n);else{var o=App.hero.getEquips(e+1,!0);if(o&&0<o.length)i.showEquipByView=EquipType.SHENLING_VIEW,dispatchEvt(new r.EquipEvent(r.EquipEvent.OPEN_EQUIP_PANEL),[e+1,1]);else{var a=3==e?21013:2==e?21012:1==e?21011:21010;this.openJumpView(a)}}this.list_equips.selectedIndex=-1}},n.prototype.playEquipEff=function(t){this._playCallback=t,this.stopEquipEff(),this._isplayEff=!0;for(var e=0;e<this.list_equips.cells.length;e++){var i=this.list_equips.cells[e];Laya.Tween.to(i,{x:152,y:122},160,null)}Laya.timer.once(260,this,this.fanEquipEff)},n.prototype.fanEquipEff=function(){for(var t=0;t<this.list_equips.cells.length;t++){var e=this.list_equips.cells[t];Laya.Tween.to(e,{x:this.equippos[2*t],y:this.equippos[2*t+1]},260,null)}Laya.timer.once(260,this,this.stopEquipEff)},n.prototype.stopEquipEff=function(){this._playCallback&&(this._playCallback(),this._playCallback=null),this._isplayEff=!1,Laya.timer.clear(this,this.fanEquipEff),Laya.timer.clear(this,this.stopEquipEff);for(var t=0;t<this.list_equips.cells.length;t++){var e=this.list_equips.cells[t];e.x=this.equippos[2*t],e.y=this.equippos[2*t+1],Laya.Tween.clearAll(e)}},n.prototype.onEquipAccsItemRender=function(t,e){if(this.list_equips.array){t.x=this.equippos[2*e],t.y=this.equippos[2*e+1];var i=this.list_equips.array[e];t.itemBox.dataSource=i,t.itemBox.visible=!!i,i||t.ani_succ.gotoAndStop(0),t.btn_add.visible=!i,t.img_suo.visible=!1,t.redpoint.onDispose(),this.dataSource&&t.redpoint.setRedPointName("god_equip_"+this.dataSource.uuid+"_"+(e+1))}},n.prototype.playEffect=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];function e(t){var e=o[t],i=e.dataSource;if(!i)return 1;-1!=n.indexOf(i.slot)&&e.ani_succ.loadAnimation(ResConst.anim_strength,Handler.create(null,function(){e.ani_succ.play(0,!1),e.ani_succ.visible=!0}),ResConst.atlas_strength_effect)}for(var o=this.list_equips.cells,i=0;i<o.length;i++)e(i)},n.prototype.updateItem=function(t){for(var e=this.list_equips.array,i=0;i<e.length;i++)if(e[i]){var n=e[i];t.uuid==n.uuid&&(this.list_equips.array[i]=t,this.list_equips.refresh())}},n.prototype.setResEvent=function(t){t?(tl3d.ModuleEventManager.addEvent(r.ResEvent.PROP_CHANGE,this.updateResoure,this),tl3d.ModuleEventManager.addEvent(r.ResEvent.RESOURCE_CHANGE,this.updateResoure,this)):(tl3d.ModuleEventManager.removeEvent(r.ResEvent.PROP_CHANGE,this.updateResoure,this),tl3d.ModuleEventManager.removeEvent(r.ResEvent.RESOURCE_CHANGE,this.updateResoure,this))},n.prototype.updateResoure=function(){this.callLater(this.setCostText)},n.prototype.quick=function(t){var e=r.EquipModel.getInstance();if(t!=o.Strength||App.IsSysOpen(ModuleConst.EQUIP_STRENGTH))if(t!=o.Refine||App.IsSysOpen(ModuleConst.EQUIP_JINGLIAN)){var i=this.dataSource.equipKeys;if(t!=o.TakeOff&&t!=o.Refine&&t!=o.Strength||0!=i.length){if(t==o.Wear&&0==e.equipQiuck(this._dataSource).length)return void showToast(LanMgr.getLan("",10302));var n=t==o.Strength?this.strengCkbox.selected:this.refineCkbox.selected;dispatchEvt(new r.EquipEvent(r.EquipEvent.EQUIP_OPERATION),[t,EquipOperation.ROOT_EQUIP_CHANGE,n])}else showToast(LanMgr.getLan("",10301))}else showToast(e.getRefineOpenData().prompt);else showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIP_STRENGTH).prompt)},n.prototype.openMasterView=function(t){var e=this.dataSource;if(e.equipKeys.length<r.EquipModel.EQUIP_COUNT){var i=0==this.curType?LanMgr.getLan("",10304):LanMgr.getLan("",10305);showToast(LanMgr.getLan("",10303,i))}else UIMgr.showUI(UIConst.Equip_MasterView,[e,this.curType])},n.prototype.resfresh=function(){this.list_equips.refresh()},n.prototype.openJumpView=function(t){UIUtil.showJumpPanle(t)},n.prototype.close=function(){this.setResEvent(!1),this.list_equips.array=null,r.EquipTipsView.HideTip(),tl3d.ModuleEventManager.removeEvent(r.ResEvent.PROP_CHANGE,this.setCostText,this)},n);function n(){var t=e.call(this)||this;return t.equippos=[0,0,304,0,0,244,304,244],t._isplayEff=!1,t.list_attr.renderHandler=new Handler(t,t.onAttrRender),t.list_equips.mouseHandler=new Handler(t,t.onEquipMouse),t.list_equips.renderHandler=new Handler(t,t.onEquipAccsItemRender),t.list_equips.selectEnable=!1,t.btn_strengthMaster.on(Laya.Event.CLICK,t,t.openMasterView),t.btn_getRefine.on(Laya.Event.CLICK,t,t.openJumpView,[CostTypeKey.jinglianshi]),t.btn_getStrengh.on(Laya.Event.CLICK,t,t.openJumpView,[CostTypeKey.qianghuashi]),t.btn_wear.on(Laya.Event.CLICK,t,t.quick,[o.Wear]),t.btn_takeoff.on(Laya.Event.CLICK,t,t.quick,[o.TakeOff]),t.btn_strength.on(Laya.Event.CLICK,t,t.quick,[o.Strength]),t.btn_rootRefine.on(Laya.Event.CLICK,t,t.quick,[o.Refine]),t.refineCkbox.selected=t.strengCkbox.selected=!1,t.btnSuit.on(Laya.Event.CLICK,t,t.onSuit),t}r.TabEquip=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=Laya.Label,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){this.text=t},n);function n(){return e.call(this)||this}t.PropretyIR=i;var o,a=(o=Laya.Box,__extends(r,o),Object.defineProperty(r.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),r.prototype.refreshData=function(t){if(t){var e=this.getChildByName("lab_attriName"),i=this.getChildByName("lab_nowAttriPro"),n=this.getChildByName("lab_nextAttriPro");this.getChildByName("imgArrow").visible=n.visible=!!t.nextValue,e.text=t.name,i.text="+"+t.value,n.text="+"+t.nextValue}},r);function r(){return o.call(this)||this}t.strengthAttriRender=a}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.EquipItemBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){},n);function n(){return e.call(this)||this}t.EquipItemIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.equip.render.EquipGodIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){this.dataSource?(this.headBox.dataSource=this.dataSource,this.headBox.visible=!0,this.anim_select.play()):(this.headBox.dataSource=null,this.headBox.visible=!1,this.anim_select.gotoAndStop(0))},n);function n(){return e.call(this)||this}t.EquipGodIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=ui.equip.gemstone.SingleCompoundUI,__extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12450)},this._curGemvo=o.GemstoneUtils.createGemstoneVo(),this._nextGemvo=o.GemstoneUtils.createGemstoneVo(),this._counterBar=new common.CounterBar,this._counterBar.setComponent(this.btnAddOne,this.btnAddTen,this.btnRedOne,this.btnRedTen,this.lbInput),this.btnComp.on(Laya.Event.CLICK,this,this.onCompound)},i.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},i.prototype.show=function(){e.prototype.show.call(this),this.initView()},i.prototype.close=function(){e.prototype.close.call(this)},i.prototype.initView=function(){var t=this.dataSource.tbItem;this._curGemvo.setData({equipId:0,num:0,templateId:t.ID});var e=tb.TB_gemstone_new.getTBOneById(t.defined[0]);this.headBox1.dataSource=t,this.headBox1.itemBox.label_number.visible=!1,this.imgAttr1.skin=SkinUtil.getAttrSkin(e.getAttrType()),this.lbAttr1.text=e.getAttrVal()+"",this.lbName1.text=t.name,this._nextGemvo.setData({equipId:0,num:0,templateId:t.ID+1});var i=tb.TB_item.get_TB_itemById(this._nextGemvo.templateId),n=tb.TB_gemstone_new.getTBOneById(i.defined[0]);this.headBox2.dataSource=i,this.headBox2.itemBox.label_number.visible=!1,this.imgAttr2.skin=SkinUtil.getAttrSkin(n.getAttrType()),this.lbAttr2.text=n.getAttrVal()+"",this.lbName2.text=i.name,this._maxNum=o.GemstoneUtils.getCompoundNum(i.ID),this._curNum=Math.max(1,this._maxNum),this._counterBar.setInitData(this._curNum,this._maxNum,this.setSumNum.bind(this)),this.setSumNum()},i.prototype.setSumNum=function(){var t=o.GemstoneUtils.getCompoundObjById(this._nextGemvo.templateId);if(t){this._curNum=this._counterBar.getCurNum(),this.lbInput.text=this._curNum.toString();var e=t.materialNum*this._curNum,i=o.GemstoneUtils.getOwnNum(t.materialId);this.pbNum.value=i/e,this.lbNum.text=i+"/"+e}},i.prototype.refreshView=function(){this.initView()},i.prototype.playSuccAnim=function(){},i.prototype.onCompound=function(){this._curNum<=0?showToast(LanMgr.getLan("",10299)):this._curGemvo.templateId&&dispatchEvt(new o.GemstoneEvent(o.GemstoneEvent.COMPOUND_GEMSTONE),[this._nextGemvo.templateId,this._curNum])},i);function i(){var t=e.call(this)||this;return t._curNum=1,t._maxNum=0,t}o.SingleCompoundView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.equip.gemstone.GemstoneTipsUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.btnWear.on(Laya.Event.CLICK,this,this.onWear)},n.prototype.popup=function(){i.prototype.popup.call(this),this.initView()},n.prototype.close=function(){i.prototype.close.call(this)},n.prototype.initView=function(){var t=this.dataSource;if(t){var e=t.gemVo.tbItem,i=t.gemVo.tbGem;this.itemBox.dataSource=e,this.lbName.text=e.name,this.lbNum.text=t.gemVo.num+"",this.lbDesc.text=LanMgr.attrName[i.getType()]+"+"+i.getAttrVal(),this.btnWear.visible=!t.hideBtn}},n.prototype.onWear=function(){var t=this.dataSource;t&&(dispatchEvt(new e.GemstoneEvent(e.GemstoneEvent.WEAR_GEMSTONE),t),this.close())},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}e.GemstoneTipsView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.equip.gemstone.GemstoneReplaceUI,__extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12451)},this.listGems.mouseHandler=new Handler(this,this.onSelect),this.listGems.renderHandler=new Handler(this,this.onGenRender),this.listGems.selectEnable=!1,this.addChild(this.bgPanel.btnClose)},n.prototype.popup=function(){t.prototype.popup.call(this),this.initView()},n.prototype.close=function(){t.prototype.close.call(this),this.listGems.array=null},n.prototype.initView=function(){var t=this.dataSource,e=i.GemstoneModel.getInstance().getReplaceViewList(t.type,!0);this.listGems.array=e,this.imgEmpty.visible=0==e.length,this.lbEmpty.text=LanMgr.getLan("",12452,LanMgr.baoshiName[t.type])},n.prototype.onSelect=function(t,e){if(-1!=e&&t.type==Laya.Event.CLICK){var i=this.listGems.array[e],n=this.dataSource;if(!i||!n)return;var o={gemVo:i,godVo:n.godVo,hideBtn:!1,slot:n.slot};UIMgr.showUI(UIConst.GemstoneTipsView,o)}},n.prototype.onGenRender=function(t,e){var i=t.dataSource;if(i){var n=t.getChildByName("itemBox"),o=t.getChildByName("lbLv");n.dataSource=i,n.itemBox.lbLevel.visible=!1,o.text=""+i.gemLv+LanMgr.getLan("",10031)+LanMgr.attrName[i.tbGem.getAttrType()]}},n);function n(){return t.call(this)||this}i.GemstoneReplaceView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(r){var e,t=(e=ui.equip.gemstone.GemstoneCompoundUI,__extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.isModelClose=!0,this.listGems.mouseHandler=new Handler(this,this.onMouseClick),this.listGems.renderHandler=new Handler(this,this.onGenRender),this.listYulan.renderHandler=new Handler(this,this.onYulanRender),this.btnComp.on(Laya.Event.CLICK,this,this.onOneKeyCompound),this.lvCombo.selectedIndex=-1,this.typeCombo.selectedIndex=-1,this.lvCombo.dataSource=["2","3","4","5","6","7","8"],this.lvCombo.selectHandler=new Handler(this,this.onSelectLv),this.lvCombo.showHandler=new Handler(this,this.onShowCombo),this.typeCombo.dataSource=[LanMgr.getLan("",12453),LanMgr.getLan("",12351),LanMgr.getLan("",12352),LanMgr.getLan("",12353)],this.typeCombo.selectHandler=new Handler(this,this.onSelectType),this.typeCombo.showHandler=new Handler(this,this.onShowCombo)},i.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},i.prototype.show=function(){e.prototype.show.call(this),this.initView()},i.prototype.close=function(){e.prototype.close.call(this),this.lvCombo.selectedIndex=-1,this.typeCombo.selectedIndex=-1,this.listGems.array=null,this.listYulan.array=null},i.prototype.initView=function(){this.refreshView(),this._curLv=8,this._curType=0,this.lvCombo.selectedIndex=6,this.typeCombo.selectedIndex=0,this.renderYulan()},i.prototype.onSelectLv=function(t){t<0||(this._curLv=this.lvCombo.selectedIndex+2,this.renderYulan())},i.prototype.onSelectType=function(t){t<0||(this._curType=this.typeCombo.selectedIndex,this.renderYulan())},i.prototype.onShowCombo=function(t){this.isModelClose=!t},i.prototype.renderYulan=function(){var t=r.GemstoneUtils.getCanCompMaxLvList(this._curType,this._curLv);this.listYulan.array=t,this.listYulan.width=100*t.length+(t.length-1)*this.listYulan.spaceX,this.boxEmptyHC.visible=0==t.length},i.prototype.onMouseClick=function(t,e){if(t.type==Laya.Event.CLICK){var i=this.listGems.getItem(e);if(i.gemLv>=r.GemstoneModel.max_gem_lv)return void showToast(LanMgr.getLan("",10298));UIMgr.showUI(UIConst.SingleCompoundView,i)}},i.prototype.onGenRender=function(t,e){var i=t.dataSource;if(i){var n=t.getChildByName("itemBox"),o=t.getChildByName("lbLv"),a=t.getChildByName("imgRedpoint");n.dataSource=i,n.itemBox.lbLevel.visible=!1,o.text=""+i.gemLv+LanMgr.getLan("",10031)+LanMgr.attrName[i.tbGem.getAttrType()],a.visible=r.GemstoneUtils.isCanCompoundByMaterial(i.tbItem.ID)}},i.prototype.onYulanRender=function(t,e){var i=t.dataSource;if(i){var n=t.getChildByName("itemBox"),o=t.getChildByName("lbLv");n.dataSource=i,n.itemBox.lbLevel.visible=!1,n.itemBox.addTipsListener();var a=tb.TB_item.get_TB_itemById(i.id),r=tb.TB_gemstone_new.getTBOneById(a.defined[0]);o.text=""+r.getLevel()+LanMgr.getLan("",10031)+LanMgr.attrName[r.getAttrType()]}},i.prototype.refreshView=function(){var t=__spreadArrays(r.GemstoneModel.getInstance().getCompoundViewList());t.sort(function(t,e){return e.gemLv-t.gemLv}),this.listGems.array=t,this.boxEmptyGems.visible=0==t.length,this.renderYulan()},i.prototype.onOneKeyCompound=function(){dispatchEvt(new r.GemstoneEvent(r.GemstoneEvent.ONEKEY_COMPOUND_GEM),[this._curLv,this._curType,__spreadArrays(this.listYulan.array)])},i);function i(){var t=e.call(this)||this;return t._curLv=0,t._curType=0,t}r.GemstoneCompoundView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=ui.equip.gemstone.EquipBaoshiIRUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=t.equipVo,i=t.position,n=t.godVo,o=this.equipBox,a=!!e;o.dataSource=e,o.itemBox.visible=a,o.itemBox.dataSource=e,o.btn_add.visible=!1,this.imgGem1.visible=n.isExistGem(3*(i-1)+r.GemstoneType.shengming),this.imgGem2.visible=n.isExistGem(3*(i-1)+r.GemstoneType.gongji),this.imgGem3.visible=n.isExistGem(3*(i-1)+r.GemstoneType.fangyu),this.redpoint.onDispose(),this.redpoint.setRedPointName("equip_baoshi_group_"+n.uuid+"_"+i),o.ani_select.play()}else this.equipBox.ani_select.gotoAndStop(0)},i);function i(){var t=e.call(this)||this;return t.equipBox.img_suo.visible=!1,t.equipBox.lab_isopen.visible=!1,t.equipBox.redpoint.onDispose(),t}r.EquipBaoshiIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.equip.gemstone.BaoShiIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.imgAttr.skin=SkinUtil.getAttrSkin(t.type),this.lbAttr.text="0";var e=t.gemVo,i=!!e;this.itemBox.visible=i,this.btnAdd.visible=!i,this.itemBox.dataSource=e,this.itemBox.label_number.visible=!1,this.itemBox.lbLevel.visible=!1,this.lbName.text=LanMgr.baoshiName[t.type],e&&(this.lbAttr.text=e.tbGem.getAttrVal()+"",this.lbName.text=e.tbItem.name),this.redpoint.onDispose(),t.godVo&&this.redpoint.setRedPointName("equip_baoshi_"+t.godVo.uuid+"_"+t.slot),this.imgBg.on(Laya.Event.CLICK,this,this.onChange)}else this.itemBox.dataSource=null,this.redpoint.onDispose(),this.imgBg.off(Laya.Event.CLICK,this,this.onChange)},n.prototype.playAnim=function(){this.dataSource&&this.ani_succ.loadAnimation(ResConst.anim_strength,Handler.create(this,function(){this.ani_succ.play(0,!1),this.ani_succ.visible=!0}),ResConst.atlas_strength_effect)},n.prototype.onChange=function(){var t=this.dataSource;t&&dispatchEvt(new e.GemstoneEvent(e.GemstoneEvent.SHOW_REPLACE_GEM_VIEW),t)},n);function n(){return t.call(this)||this}e.BaoshiIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.equip.gemstone.TabBaoshiNewUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t},enumerable:!0,configurable:!0}),i.prototype.close=function(){Laya.timer.clearAll(this),this.list_equip.array=null,this.list_equip.selectedIndex=-1,this._curIdx=-1,this.gemItem1.dataSource=null,this.gemItem2.dataSource=null,this.gemItem3.dataSource=null},i.prototype.init=function(){for(var t=this.dataSource,e=[],i=1;i<=4;i++){var n={equipVo:t.getEquipmentBySlot(i),godVo:t,position:i};e.push(n)}this.list_equip.array=e,this._curIdx=e.findIndex(function(t){return!!t}),this._curIdx=this._curIdx<0?0:this._curIdx,this.list_equip.selectedIndex=this._curIdx,this.onEquipMouseSelect(null,this._curIdx,!1)},i.prototype.onEquipMouseSelect=function(t,e,i){void 0===i&&(i=!0),t&&t.type!=Laya.Event.CLICK||this.list_equip.getItem(e)&&(this._curIdx=e,this.renderEquipInfo())},i.prototype.renderEquipInfo=function(){if(!(this._curIdx<0)){var t=this.list_equip.getItem(this._curIdx),e=this.dataSource;if(t&&e){var i=t.equipVo;this.lbEquipName.text=i?i.tab_item.name:"";var n=this._curIdx*a.GemstoneModel.gemstone_type_count+a.GemstoneType.shengming;this.gemItem1.dataSource={godVo:e,slot:n,equipVo:i,type:a.GemstoneType.shengming,gemVo:e.getGemsBySlot(n)},n=this._curIdx*a.GemstoneModel.gemstone_type_count+a.GemstoneType.gongji,this.gemItem2.dataSource={godVo:e,slot:n,equipVo:i,type:a.GemstoneType.gongji,gemVo:e.getGemsBySlot(n)},n=this._curIdx*a.GemstoneModel.gemstone_type_count+a.GemstoneType.fangyu,this.gemItem3.dataSource={godVo:e,slot:n,equipVo:i,type:a.GemstoneType.fangyu,gemVo:e.getGemsBySlot(n)};var o=0<Object.keys(a.GemstoneUtils.getCanWearGemList(e)).length;this.btnOnekeyWear.visible=o,this.btnOnekeyUnload.visible=!o}}},i.prototype.selectedEquip=function(e){var t=this.list_equip.array.findIndex(function(t){return t&&t.equipVo&&t.equipVo.uuid==e});-1!=t&&(this.list_equip.selectedIndex=t,this.onEquipMouseSelect(null,t))},i.prototype.playAnim=function(t){this.gemItem1.dataSource&&-1!=t.indexOf(this.gemItem1.dataSource.type)&&this.gemItem1.playAnim(),this.gemItem2.dataSource&&-1!=t.indexOf(this.gemItem2.dataSource.type)&&this.gemItem2.playAnim(),this.gemItem3.dataSource&&-1!=t.indexOf(this.gemItem3.dataSource.type)&&this.gemItem3.playAnim()},i.prototype.onUnload=function(){var t=this.dataSource;t&&dispatchEvt(new a.GemstoneEvent(a.GemstoneEvent.ONE_KEY_UNLOAD),t)},i.prototype.onWear=function(){var t=this.dataSource;t&&dispatchEvt(new a.GemstoneEvent(a.GemstoneEvent.ONE_KEY_WEAR),t)},i.prototype.onComp=function(){dispatchEvt(new a.GemstoneEvent(a.GemstoneEvent.SHOW_COMPOUND_VIEW))},i.prototype.playEquipEff=function(t){this._playCallback=t,this.stopEquipEff(),this._isplayEff=!0;for(var e=0;e<this.list_equip.cells.length;e++){var i=this.list_equip.cells[e];Laya.Tween.to(i,{x:152,y:121},160,null)}Laya.timer.once(260,this,this.fanEquipEff)},i.prototype.fanEquipEff=function(){for(var t=0;t<this.list_equip.cells.length;t++){var e=this.list_equip.cells[t];Laya.Tween.to(e,{x:this.equippos[2*t],y:this.equippos[2*t+1]},260,null)}Laya.timer.once(260,this,this.stopEquipEff)},i.prototype.stopEquipEff=function(){this._playCallback&&(this._playCallback(),this._playCallback=null),this._isplayEff=!1,Laya.timer.clear(this,this.fanEquipEff),Laya.timer.clear(this,this.stopEquipEff);for(var t=0;t<this.list_equip.cells.length;t++){var e=this.list_equip.cells[t];e.x=this.equippos[2*t],e.y=this.equippos[2*t+1],Laya.Tween.clearAll(e)}},i.prototype.onEquipItemRender=function(t,e){t&&(t.x=this.equippos[2*e],t.y=this.equippos[2*e+1],t.equipBox.getChildByName("selectBox").visible=this._curIdx==e)},i);function i(){var t=e.call(this)||this;return t._curIdx=-1,t._isplayEff=!1,t.equippos=[0,0,304,0,0,242,304,242],t.list_equip.selectedIndex=-1,t.list_equip.mouseHandler=new Handler(t,t.onEquipMouseSelect),t.list_equip.renderHandler=new Handler(t,t.onEquipItemRender),t.btnOnekeyUnload.on(Laya.Event.CLICK,t,t.onUnload),t.btnOnekeyWear.on(Laya.Event.CLICK,t,t.onWear),t.btnComp.on(Laya.Event.CLICK,t,t.onComp),t}a.TabBaoshiNew=t}(game=game||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(_){var t=(p.createGemstoneVo=function(t,e){void 0===t&&(t=""),void 0===e&&(e=null);var i=new GemstoneItemVo;if(e){var n=JSON.parse(JSON.stringify(e));i.setData(n)}return i.uuid=t,i},p.getCompoundObj=function(){if(!this._compoundObj){this._compoundObj={};for(var t=tb.TB_gemstone_compound.getTBList(),e=0;e<t.length;e++){var i=t[e],n=i.obtain[0][0],o=i.obtain[0][1],a=i.material[0][0],r=i.material[0][1],s=tb.TB_item.get_TB_itemById(n),u=tb.TB_gemstone_new.getTBOneById(s.defined[0]);this._compoundObj[n]={ID:i.ID,obtainId:n,obtainNum:o,materialId:a,materialNum:r,gemType:u.getType(),gemLv:u.getLevel(),clinetNum:0}}}return this._compoundObj},p.getCompoundNum=function(t){var e=this.getCompoundObjById(t);if(!e)return 0;var i=p.getOwnNum(e.materialId);return Math.floor(i/e.materialNum)},p.getCompoundObjById=function(t){return this.getCompoundObj()[t]},p.getOwnNum=function(t){var e=_.GemstoneModel.getInstance().getGemstoneByTbID(t);return e?e.num:0},p.isCanCompound=function(t,e){var i=p.getCompoundObj(),n=!1;for(var o in i)if((0==t||i[o].gemType==t)&&e>=i[o].gemLv&&0<p.getCompoundNum(Number(o))){n=!0;break}return n},p.isCanCompoundByMaterial=function(t){var e=p.getCompoundObj(),i=!1;for(var n in e)if(e[n].materialId==t&&0<p.getCompoundNum(Number(n))){i=!0;break}return i},p.getCanCompMaxLvList=function(t,e){var i=p.getCompoundObj(),a=[];for(var n in i){var o=i[n],r=p.getOwnNum(o.materialId);(0==t||i[n].gemType==t)&&e>=o.gemLv&&a.push({obtainId:n,ownMaterCount:r,gemLv:o.gemLv,gemType:o.gemType,hechengCount:0})}function s(t){var e=a[t],i=p.getCompoundObjById(e.obtainId),n=a.find(function(t){return i.materialId==t.obtainId}),o=0;n&&(o=n.hechengCount||0),o+e.ownMaterCount>=i.materialNum&&(e.hechengCount=Math.floor((o+e.ownMaterCount)/i.materialNum)*i.obtainNum)}a.sort(function(t,e){return t.gemType==e.gemType?t.gemLv-e.gemLv:t.gemType-e.gemType});for(var u=0;u<a.length;u++)s(u);a.sort(function(t,e){return t.gemType==e.gemType?e.gemLv-t.gemLv:t.gemType-e.gemType});var h=[],l=[];for(u=0;u<a.length;u++)if(0<(o=a[u]).hechengCount&&-1==l.indexOf(o.gemType)){l.push(o.gemType);var c=new ItemVo(o.obtainId,o.hechengCount);c.show=!0,h.push(c)}return h},p.getCanWearGemList=function(t){var e=_.GemstoneModel.getInstance().getGemtones().filter(function(t){return!t.isExsitGod()});e.sort(function(t,e){return e.gemLv-t.gemLv}),e.forEach(function(t){return t.clientNum=t.num});var o={1:[],2:[],3:[]};e.forEach(function(t){var e=t.gemType;if(o[e]||(o[e]=[]),o[e].length<4)for(var i=4-o[e].length,n=0;n<i&&!(t.clientNum<=0);n++)o[e].push({templateId:t.templateId,uuid:t.uuid,gemLv:t.gemLv}),t.clientNum--});for(var i=[],n=[],a=1;a<=12;a++)t.isExistGem(a)?i.push(a):n.push(a);for(var r=__spreadArrays(n,i),s=!1,u={},h=0;h<r.length;h++){var l=(a=r[h])%_.GemstoneModel.gemstone_type_count==0?_.GemstoneType.fangyu:a%_.GemstoneModel.gemstone_type_count,c=t.getGemsBySlot(a),p=o[l];if(0!=p.length)if(c)(d=p[0]).gemLv>c.gemLv&&(u[a]=d,p.splice(0,1),s=!0);else{var d=p[0];u[a]=d,p.splice(0,1),s=!0}}return s?u:{}},p.getGemRewardItemList=function(t){var e={},i=t.addGemstones||{};for(var n in i)e[a=(h=i[n]).templateId]=e[a]?e[a]+h.num:h.num;var o=t.clientAddGemsByModifyNum||{};if(0<Object.keys(o).length)for(var a in o){var r=o[a];e[a]=e[a]?e[a]+r:r}var s=t.clientAddGemsByModifyGems||{};if(0<Object.keys(s).length)for(var a in s)r=s[a],e[a]=e[a]?e[a]+r:r;var u=[];for(var a in e){var h;(h=new ItemVo(Number(a),e[a])).show=!1,u.push(h)}return u},p);function p(){}_.GemstoneUtils=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var t,s=(t=tl3d.BaseEvent,__extends(e,t),e.INIT_GEM_DATA="INIT_GEM_DATE",e.ADD_GEMTONE="ADD_GEMTONE",e.DEL_GEMTONE="DEL_GEMTONE",e.MODIFY_GEMTONE="MODIFY_GEMTONE",e.MODIFY_GOD_GEMTONE="MODIFY_EQUIP_GEMTONE",e.MODIFY_TARGET_GEMTONE="MODIFY_TARGET_GEMTONE",e.SHOW_REPLACE_GEM_VIEW="SHOW_REPLACE_GEM_VIEW",e.SHOW_COMPOUND_VIEW="SHOW_COMPOUND_VIEW",e.WEAR_GEMSTONE="WEAR_GEMSTONE",e.WEAR_SUCCESS="WEAR_SUCCESS",e.ONE_KEY_UNLOAD="ONE_KEY_UNLOAD",e.ONE_KEY_WEAR="ONE_KEY_WEAR",e.ONE_KEY_WEAR_SUCCESS="ONE_KEY_WEAR_SUCCESS",e.COMPOUND_GEMSTONE="COMPOUND_GEMSTONE",e.ONEKEY_COMPOUND_GEM="ONEKEY_COMPOUND_GEM",e);function e(){return null!==t&&t.apply(this,arguments)||this}r.GemstoneEvent=s;var i,n=(i=tl3d.Processor,__extends(o,i),o.prototype.getName=function(){return"GemstoneProcessor"},o.prototype.listenModuleEvents=function(){return[new s(s.SHOW_REPLACE_GEM_VIEW),new s(s.SHOW_COMPOUND_VIEW),new s(s.WEAR_GEMSTONE),new s(s.ONE_KEY_UNLOAD),new s(s.ONE_KEY_WEAR),new s(s.COMPOUND_GEMSTONE),new s(s.ONEKEY_COMPOUND_GEM),new s(s.MODIFY_GOD_GEMTONE),new s(s.MODIFY_TARGET_GEMTONE)]},o.prototype.receivedModuleEvent=function(t){if(t instanceof s)switch(t.type){case s.SHOW_REPLACE_GEM_VIEW:this.showReplaceView(t.data);break;case s.SHOW_COMPOUND_VIEW:this.showCompoundView();break;case s.WEAR_GEMSTONE:this.wearGemstone(t.data);break;case s.ONE_KEY_UNLOAD:this.oneKeyUnload(t.data);break;case s.ONE_KEY_WEAR:this.oneKeyWear(t.data);break;case s.COMPOUND_GEMSTONE:this.compoundGem(t.data);break;case s.ONEKEY_COMPOUND_GEM:this.oneKeyCompound(t.data);break;case s.MODIFY_GOD_GEMTONE:this.modifyEquipGem(t.data);break;case s.MODIFY_TARGET_GEMTONE:this.modifyGemData(t.data)}},o.prototype.showReplaceView=function(t){t&&UIMgr.showUI(UIConst.GemstoneReplaceView,t)},o.prototype.showCompoundView=function(){UIMgr.showUI(UIConst.GemstoneCompoundView)},o.prototype.modifyEquipGem=function(t){if(UIMgr.hasStage(UIConst.EquipView)){var e=UIMgr.getUIByName(UIConst.EquipView);if(e.list_tab.selectedIndex==EquipTabType.baoshi){var i=e.viewBaoshi;i.list_equip.refresh(),i.renderEquipInfo()}}},o.prototype.modifyGemData=function(t){if(UIMgr.hasStage(UIConst.EquipView)){var e=UIMgr.getUIByName(UIConst.EquipView);e.list_tab.selectedIndex==EquipTabType.baoshi&&e.viewBaoshi.renderEquipInfo()}},o.prototype.wearGemstone=function(i){if(i){var t={};t[Protocol.game_gemstone_wearGemstone.args.godId]=Number(i.godVo.uuid),t[Protocol.game_gemstone_wearGemstone.args.gemKey]=i.gemVo.uuid,t[Protocol.game_gemstone_wearGemstone.args.slot]=i.slot,PLC.request(Protocol.game_gemstone_wearGemstone,t,function(t){if(t){if(UIMgr.hideUIByName(UIConst.GemstoneReplaceView),UIMgr.hasStage(UIConst.EquipView)){var e=UIMgr.getUIByName(UIConst.EquipView);e.list_tab.selectedIndex==EquipTabType.baoshi&&e.viewBaoshi.playAnim([i.gemVo.gemType])}dispatchEvt(new s(s.WEAR_SUCCESS))}})}},o.prototype.oneKeyUnload=function(t){if(t){var e={};e[Protocol.game_gemstone_oneKeyDischargeGemstone.args.godId]=Number(t.uuid),PLC.request(Protocol.game_gemstone_oneKeyDischargeGemstone,e,function(t){})}},o.prototype.oneKeyWear=function(t){if(t){var e=r.GemstoneUtils.getCanWearGemList(t);if(0!=Object.keys(e).length){var i=[],n={};for(var o in e)n[o]=e[o].uuid;var a={};a[Protocol.game_gemstone_oneKeyWearGemstone.args.godId]=t.uuid,a[Protocol.game_gemstone_oneKeyWearGemstone.args.gemKeys]=n,PLC.request(Protocol.game_gemstone_oneKeyWearGemstone,a,function(t){if(t){if(UIMgr.hasStage(UIConst.EquipView)){var e=UIMgr.getUIByName(UIConst.EquipView);e.list_tab.selectedIndex==EquipTabType.baoshi&&e.viewBaoshi.playAnim(i)}dispatchEvt(new s(s.ONE_KEY_WEAR_SUCCESS))}})}else showToast(LanMgr.getLan("",10294))}},o.prototype.compoundGem=function(t){if(t){var e=t[0],i=t[1],n=r.GemstoneUtils.getCompoundObjById(e);if(n)if(r.GemstoneUtils.getCompoundNum(e)<i)showToast(LanMgr.getLan("",10296,i*n.materialNum));else{var o={};o[Protocol.game_gemstone_gemstoneCompound.args.id]=n.ID,o[Protocol.game_gemstone_gemstoneCompound.args.num]=i,PLC.request(Protocol.game_gemstone_gemstoneCompound,o,function(t){t&&(UIMgr.hideUIByName(UIConst.SingleCompoundView),UIMgr.hasStage(UIConst.GemstoneCompoundView)&&UIMgr.getUIByName(UIConst.GemstoneCompoundView).refreshView(),UIUtil.showRewardView(t.commonData))})}else showToast(LanMgr.getLan("",10295,e))}},o.prototype.oneKeyCompound=function(t){var e=t[0]||r.GemstoneModel.max_gem_lv,i=t[1]||0,n=t[2];if(r.GemstoneUtils.isCanCompound(i,e)){var o={};o[Protocol.game_gemstone_oneKeyGemstoneCompound.args.level]=e,o[Protocol.game_gemstone_oneKeyGemstoneCompound.args.type]=i,PLC.request(Protocol.game_gemstone_oneKeyGemstoneCompound,o,function(t){t&&(UIMgr.hasStage(UIConst.GemstoneCompoundView)&&UIMgr.getUIByName(UIConst.GemstoneCompoundView).refreshView(),UIUtil.showRewardView({clientAddItemVoList:n}))})}else showToast(LanMgr.getLan("",10297))},o);function o(){return i.call(this)||this}r.GemstoneProcessor=n}(game=game||{}),function(h){var t;(t=h.GemstoneType||(h.GemstoneType={}))[t.shengming=1]="shengming",t[t.gongji=2]="gongji",t[t.fangyu=3]="fangyu";var e=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.initData=function(){for(var t in this._gemstoneList.length=0,App.hero.gemstones){var e=h.GemstoneUtils.createGemstoneVo(t,App.hero.gemstones[t]);this._gemstoneList.push(e)}dispatchEvt(new h.GemstoneEvent(h.GemstoneEvent.INIT_GEM_DATA))},i.prototype.addGemstones=function(t){var e=[];for(var i in t){e.push(i),App.hero.gemstones[i]=t[i];var n=h.GemstoneUtils.createGemstoneVo(i,t[i]);this._gemstoneList.push(n)}h.BagModel.getInstance().updateGemstones(),dispatchEvt(new h.GemstoneEvent(h.GemstoneEvent.ADD_GEMTONE),e)},i.prototype.delGemstone=function(t){var e=[];for(var i in t)App.hero.gemstones[i]=null,delete App.hero.gemstones[i],e.push(i);for(var n=this._gemstoneList.length-1;0<=n;n--)i=this._gemstoneList[n].uuid,-1!=e.indexOf(i)&&this._gemstoneList.splice(n,1);h.BagModel.getInstance().updateGemstones(),dispatchEvt(new h.GemstoneEvent(h.GemstoneEvent.DEL_GEMTONE),e)},i.prototype.modifyNum=function(t,e){var i={},n=[];for(var o in e){var a=App.hero.gemstones[o].num,r=e[o];if(a<r){var s=App.hero.gemstones[o].templateId,u=r-a;i[s]=i[s]?i[s]+u:u}App.hero.gemstones[o].num=r,this.getGemstoneByUuid(o).num=r,n.push(o)}t.clientAddGemsByModifyNum=i,dispatchEvt(new h.GemstoneEvent(h.GemstoneEvent.MODIFY_GEMTONE),n)},i.prototype.modifyGemstones=function(t,e){var i={},n=[];for(var o in e){var a=App.hero.gemstones[o],r=e[o];a.godId&&!r&&(i[a.templateId]=i[a.templateId]?i[a.templateId]+1:1),a.godId=r,this.getGemstoneByUuid(o).godId=r,n.push(o)}t.clientAddGemsByModifyGems=i,h.BagModel.getInstance().updateGemstones(),dispatchEvt(new h.GemstoneEvent(h.GemstoneEvent.MODIFY_GEMTONE),n)},i.prototype.modifyGodGemstones=function(t){var e=[];for(var i in t){e.push(i);var n=App.hero.gods[i];n&&(n.gemInfo=t[i]);var o=App.hero.getGodVoById(i);o&&o.setgemInfo(t[i])}dispatchEvt(new h.GemstoneEvent(h.GemstoneEvent.MODIFY_GOD_GEMTONE),e)},i.prototype.getGemstoneByUuid=function(e){return this._gemstoneList.find(function(t){return t.uuid==e})},i.prototype.getGemstoneByTbID=function(e){return this._gemstoneList.find(function(t){return!t.isExsitGod()&&t.templateId==e})},i.prototype.getGemstoneByType=function(e){return this._gemstoneList.find(function(t){return!t.isExsitGod()&&t.gemType==e})},i.prototype.getGemtones=function(){return this._gemstoneList},i.prototype.isHasBetterGem=function(e,i){return this._gemstoneList.some(function(t){return!t.isExsitGod()&&t.gemType==e&&t.gemLv>i&&0<t.num})},i.prototype.getReplaceViewList=function(e,t){void 0===t&&(t=!1);var i=this._gemstoneList.filter(function(t){return!t.isExsitGod()&&(0==e||e==t.gemType)});return t&&(i.forEach(function(t){t.show=!1,t.sortNum=t.gemLv}),i.sort(function(t,e){return e.sortNum-t.sortNum})),i},i.prototype.getCompoundViewList=function(){var t=this._gemstoneList.filter(function(t){return!t.isExsitGod()});return t.sort(function(t,e){return t.gemLv-e.gemLv}),t},i.gemstone_type_count=3,i.max_gem_lv=8,i);function i(){this._gemstoneList=[]}h.GemstoneModel=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(p){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"EquipProcessor"},i.prototype.listenModuleEvents=function(){return[new p.EquipEvent(p.EquipEvent.EQUIP_OPERATION),new p.EquipEvent(p.EquipEvent.SHOW_EQUIPREFINE_PANEL),new p.EquipEvent(p.EquipEvent.SHOW_EQUIP_STH_PANEL),new p.EquipEvent(p.EquipEvent.CHANGE_EQUIP_ITEM),new p.EquipEvent(p.EquipEvent.SHOW_EQUIP_PANEL),new p.EquipEvent(p.EquipEvent.SWITCH_TAB_SUCCESS),new p.EquipEvent(p.EquipEvent.CLOSE_JUMP_VIEW),new p.EquipEvent(p.EquipEvent.OPEN_EQUIP_PANEL),new p.GodEvent(p.GodEvent.BUZHEN_COMPLETE)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof p.EquipEvent)switch(t.type){case p.EquipEvent.EQUIP_OPERATION:this.equipOperation(t.data);break;case p.EquipEvent.SHOW_EQUIPREFINE_PANEL:this.showRefinePanel(t.data);break;case p.EquipEvent.SHOW_EQUIP_STH_PANEL:this.showStrengthPanel(t.data);break;case p.EquipEvent.SHOW_EQUIP_PANEL:this.showPanel(t.data);break;case p.EquipEvent.CLOSE_JUMP_VIEW:this.jumpview.close();break;case p.EquipEvent.CHANGE_EQUIP_ITEM:UIMgr.hasStage(UIConst.EquipView)&&this.equipview.refreshData(t.data);break;case p.EquipEvent.OPEN_EQUIP_PANEL:this.openShipin(t.data)}},i.prototype.equipOperation=function(t){switch(t[1]){case EquipOperation.RESOLVE:this.onProtocolRecycle(t[0]);break;case EquipOperation.WEAR:case EquipOperation.CHANGE:this.onProtocolWearOrChange(t[0]);break;case EquipOperation.DISCHARGE:this.onProtocolDischarge(t[0]);break;case EquipOperation.STRENGTH:this.onProtocolStrength(t[0]);break;case EquipOperation.REFINE:this.onProtocolRefine(t[0]);break;case EquipOperation.ROOT_EQUIP_CHANGE:this.onProtocolQuick(t[0],t[2]);break;case EquipOperation.SWITCH:this.switch(t[0])}},i.prototype.openShipin=function(t){UIMgr.showUI(UIConst.EquipChangeView,t)},i.prototype.showRefinePanel=function(t){App.IsSysOpen(ModuleConst.EQUIP_JINGLIAN)?t.isExsitGod()?UIMgr.showUI(UIConst.Equip_Refine,t):showToast(LanMgr.getLan("",10293)):showToast(this._model.getRefineOpenData().prompt)},i.prototype.showStrengthPanel=function(t){App.IsSysOpen(ModuleConst.EQUIP_STRENGTH)?t.isExsitGod()?UIMgr.showUI(UIConst.Equip_StrengthView,t):showToast(LanMgr.getLan("",10290)):showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIP_STRENGTH).prompt)},i.prototype.onProtocolDischarge=function(i){var n=this,t={};t[Protocol.game_equip_discharge.args.equipKey]=i.uuid,PLC.request(Protocol.game_equip_discharge,t,function(t,e){t&&n.viewIsShow(UIConst.EquipChangeView)&&n.shipinview.updateItem(i)})},i.prototype.onProtocolRecycle=function(t){UIMgr.showUI(UIConst.Equip_Recycle,[t])},i.prototype.onProtocolWearOrChange=function(n){var o=this._model.curShowGod,a=o.getMaxQualityAnNum(),t={};t[Protocol.game_equip_wear.args.godId]=o.uuid,t[Protocol.game_equip_wear.args.equipKey]=n.uuid,PLC.request(Protocol.game_equip_wear,t,function(t,e){if(t&&(UIMgr.hideUIByName(UIConst.EquipChangeView),UIMgr.hideUIByName(UIConst.Equip_Recycle),UIUtil.checkEquipSuitLvup(a,o.getMaxQualityAnNum()),dispatchEvt(new p.EquipEvent(p.EquipEvent.WEAR_EQUIPMENT_SUCCESS)),UIMgr.hasStage(UIConst.EquipView))){var i=UIMgr.getUIByName(UIConst.EquipView);i.list_tab.selectedIndex==EquipTabType.baoshi&&i.viewBaoshi.selectedEquip(n.uuid)}})},i.prototype.onProtocolStrength=function(t){var n=this,e=App.hero.getEquipByuuid(t.uuid),o=App.hero.getGodVoById(e.godId);if(o){var a=o.countMasterLevel();if(this._model.isCanSth(e,null,!0)){var i={};i[Protocol.game_equip_strength.args.type]=t.type,i[Protocol.game_equip_strength.args.equipKey]=t.uuid,PLC.request(Protocol.game_equip_strength,i,function(t,e){if(t){var i=o.countMasterLevel();a<i&&UIUtil.showEquipLvupView(0,i),n.setView(t.targetEquips),AudioMgr.playSound("sound/equstrength.mp3"),dispatchEvt(new p.EquipEvent(p.EquipEvent.EQUIP_STRENGTH_SUCCESS))}})}}else showToast(LanMgr.getLan("",10290))},i.prototype.onProtocolRefine=function(t){var n=this,e=App.hero.getEquipByuuid(t.uuid),o=App.hero.getGodVoById(e.godId);if(o){if(this._model.isCanRefine(e,null,!0)){var a=o.refineMasterLevel(),i={};i[Protocol.game_equip_refine.args.equipKey]=t.uuid,i[Protocol.game_equip_refine.args.refNum]=t.refNum,PLC.request(Protocol.game_equip_refine,i,function(t,e){if(t){var i=o.refineMasterLevel();a<i&&UIUtil.showEquipLvupView(1,i),n.setView(t.targetEquips),dispatchEvt(new p.EquipEvent(p.EquipEvent.DEFINE_EQUIPMENT_SUCCESS))}})}}else showToast(LanMgr.getLan("",10293))},i.prototype.onProtocolQuick=function(t,e){var o=this,i=this._model,n={},a=i.curShowGod;if(t==p.EquipRoot.TakeOff)n[Protocol.game_equip_quickDischarge.args.godId]=a.uuid,PLC.request(Protocol.game_equip_quickDischarge,n,function(t,e){});else if(t==p.EquipRoot.Refine){if(i.isCanRefine(null,a,!0)){var r=a.refineMasterLevel(),s=a.getLowestEquipSlots(EquipTabType.refine);n[Protocol.game_equip_quickRefine.args.godId]=a.uuid,n[Protocol.game_equip_quickRefine.args.type]=e?iface.tb_prop.equipUpgradeTypeKey.five:iface.tb_prop.equipUpgradeTypeKey.one,PLC.request(Protocol.game_equip_quickRefine,n,function(t,e){var i;if(t){o.equipview.viewEquip.list_equips.refresh(),(i=o.equipview.viewEquip).playEffect.apply(i,s);var n=a.refineMasterLevel();r<n&&UIUtil.showEquipLvupView(1,n),dispatchEvt(new p.EquipEvent(p.EquipEvent.ONEKE_REFINE_SUCCESS))}})}}else if(t==p.EquipRoot.Strength){if(i.isCanSth(null,a,!0)){var u=a.countMasterLevel(),h=a.getLowestEquipSlots(EquipTabType.strength);n[Protocol.game_equip_quickStth.args.godId]=a.uuid,n[Protocol.game_equip_quickStth.args.type]=e?iface.tb_prop.equipUpgradeTypeKey.five:iface.tb_prop.equipUpgradeTypeKey.one,PLC.request(Protocol.game_equip_quickStth,n,function(t,e){var i;if(t){o.equipview.viewEquip.list_equips.refresh(),(i=o.equipview.viewEquip).playEffect.apply(i,h);var n=a.countMasterLevel();u<n&&UIUtil.showEquipLvupView(0,n),dispatchEvt(new p.EquipEvent(p.EquipEvent.ONEKE_STRENGTH_SUCCESS))}})}}else if(t==p.EquipRoot.Wear){var l=a.getMaxQualityAnNum(),c=i.equipQiuck(a).map(function(t){return t?t.uuid:""});n[Protocol.game_equip_quickWear.args.godId]=a.uuid,n[Protocol.game_equip_quickWear.args.equipKeys]=c,PLC.request(Protocol.game_equip_quickWear,n,function(t,e){t&&(UIUtil.checkEquipSuitLvup(l,a.getMaxQualityAnNum()),dispatchEvt(new p.EquipEvent(p.EquipEvent.ONEKE_WEAR_SUCCESS)))})}},i.prototype.switch=function(t){var e=this._model,i=this.equipview.viewEquip.list_equips.array;if(-1==t.type){for(var n=Number(t.equip.slot-1);0<=n;n--)if(i[n]&&i[n].slot!=t.equip.slot){e.curPointEquipData=i[n],this.setView(i[n],1);break}}else for(n=Number(t.equip.slot-1);n<6;n++)if(i[n]&&i[n].slot!=t.equip.slot){e.curPointEquipData=i[n],this.setView(i[n],1);break}},i.prototype.setView=function(t,e){void 0===e&&(e=0);var i=t;if(0==e){var n=getobjectFirstAttribute(t);(i=new EquipItemVo(t[n])).uuid=n}this.viewIsShow(UIConst.EquipChangeView)&&this.shipinview.updateItem(i),this.viewIsShow(UIConst.Equip_Refine)&&this.EquipRefine.initView(i),this.viewIsShow(UIConst.Equip_StrengthView)&&this.EquipStrengthen.initView(i)},i.prototype.showPanel=function(t){App.IsSysOpen(ModuleConst.EQUIPMENT)?UIMgr.hasStage(UIConst.EquipView)||UIMgr.showUI(UIConst.EquipView,t):showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIPMENT).prompt)},i.prototype.viewIsShow=function(t){return UIMgr.hasStage(t)},Object.defineProperty(i.prototype,"EquipStrengthen",{get:function(){return UIMgr.getUIByName(UIConst.Equip_StrengthView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"EquipRefine",{get:function(){return UIMgr.getUIByName(UIConst.Equip_Refine)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shipinview",{get:function(){return UIMgr.getUIByName(UIConst.EquipChangeView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shenlingview",{get:function(){return UIMgr.getUIByName(UIConst.God_MainView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"equipview",{get:function(){return UIMgr.getUIByName(UIConst.EquipView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"jumpview",{get:function(){return UIMgr.getUIByName(UIConst.Equip_JumpView)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=p.EquipModel.getInstance(),t}p.EquipProcessor=t}(game=game||{});var EquipType,EquipTabType;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"EquipModule"},n.prototype.listProcessors=function(){return[new t.EquipProcessor,new t.GemstoneProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.EquipModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.EQUIP_OPERATION="EQUIP_WEAR_ORCHANGE",r.EQUIP_STRENGTH_SUCCESS="EQUIP_STRENGTH_SUCCESS",r.WEAR_EQUIPMENT_SUCCESS="WEAR_EQUIPMENT_SUCCESS",r.ONEKE_WEAR_SUCCESS="ONEKE_WEAR_SUCCESS",r.ONEKE_STRENGTH_SUCCESS="ONEKE_STRENGTH_SUCCESS",r.ONEKE_REFINE_SUCCESS="ONEKE_REFINE_SUCCESS",r.DEFINE_EQUIPMENT_SUCCESS="DEFINE_EQUIPMENT_SUCCESS",r.CHANGE_EQUIP_ITEM="CHANGE_EQUIP_ITEM",r.SHOW_EQUIP_PANEL="SHOW_EQUIP_PANEL",r.SWITCH_TAB_SUCCESS="SWITCH_TAB_SUCCESS",r.CLOSE_JUMP_VIEW="CLOSE_JUMP_VIEW",r.SHOW_EQUIPREFINE_PANEL="SHOW_EQUIPREFINE_PANEL",r.SHOW_EQUIP_STH_PANEL="SHOW_EQUIP_STH_PANEL",r.OPEN_EQUIP_PANEL="OPEN_EQUIP_PANEL",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.EquipEvent=a}(game=game||{}),function(t){var e=(a.getInstance=function(){return a._instance||(a._instance=new a),a._instance},a.prototype.getRefineOpenData=function(){return tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIP_JINGLIAN)},a.prototype.countReturnItem=function(t){for(var e={},i=new Array,n=0;n<t.length;n++){for(var o=t[n],a=10*o.quality+o.slot,r=tb.TB_equip_recycle.get_TB_equip_recycleById(a).return_item,s=0;s<r.length;s++){var u=r[s][0],h=Number(r[s][1]);e[u]?e[u]+=h:e[u]=h}if(0<o.strengthLv){var l=tb.TB_equip_strength.get_TB_equip_strengthById(o.strengthId).total_cost;for(var s in l)e[l[s][0]]=e[l[s][0]]?Number(l[s][1])+e[l[s][0]]:Number(l[s][1])}if(0<o.refineLv)for(var s in l=tb.TB_equip_refine.get_TB_equip_refineById(o.refineId).total_cost)e[l[s][0]]=e[l[s][0]]?Number(l[s][1])+e[l[s][0]]:Number(l[s][1])}for(var s in e){var c=App.hero.createItemVo(e[s],s);c.show=!0,c.bag=!0,i.push(c)}return i},a.prototype.equipQiuck=function(t,e){void 0===e&&(e=!1);for(var i=[],n=1;n<=a.EQUIP_COUNT;n++){var o=this.slotEquip(t,n,!1);e?i.push(o):o&&i.push(o)}return i},a.prototype.slotEquip=function(t,e,i){if(void 0===i&&(i=!1),!App.IsSysOpen(ModuleConst.EQUIPMENT))return null;var n=App.hero.getEquips(e,!0).filter(function(t){return!t.isExsitGod()});if(i)return t.getEquipmentBySlot(e)?null:n.find(function(t){return!t.isExsitGod()});var o=t.getEquipmentBySlot(e);return o?n.find(function(t){return t.getSortNum()>o.getSortNum()}):n.find(function(t){return!t.isExsitGod()})},a.prototype.isCanSth=function(t,e,i){if(void 0===i&&(i=!1),!App.IsSysOpen(ModuleConst.EQUIP_STRENGTH)){var n=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIP_STRENGTH);return i&&showToast(n.prompt),!1}if(!t&&!e)return!1;if(t){if(t.isTopStrengthLv())return i&&showToast(LanMgr.getLan("",10289)),!1;if(!App.hero.getGodVoById(t.godId))return i&&showToast(LanMgr.getLan("",10290)),!1;var o=map2ary(t.strengthCost());if(-1!=(a=App.isNotEnoughType(o)))return i&&showToast(LanMgr.getLan("",Lans.cost,a)),!1}if(e){if(e.equipKeys.length<=0)return void(i&&showToast(LanMgr.getLan("",10291)));if(e.isAllEquipLvTop(EquipTabType.strength))return i&&showToast(LanMgr.getLan("",10289)),!1;var a;if(-1!=(a=App.isNotEnoughType(e.getStrengthCost())))return i&&showToast(LanMgr.getLan("",Lans.cost,a)),!1}return!0},a.prototype.isCanRefine=function(t,e,i){if(void 0===i&&(i=!1),!App.IsSysOpen(ModuleConst.EQUIP_JINGLIAN)){var n=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.EQUIP_JINGLIAN);return i&&showToast(n.prompt),!1}if(t){if(t.isTopRefineLv())return i&&showToast(LanMgr.getLan("",10292)),!1;if(!App.hero.getGodVoById(t.godId))return i&&showToast(LanMgr.getLan("",10293)),!1;var o=map2ary(t.getRefineCost());if(-1!=(a=App.isNotEnoughType(o)))return i&&showToast(LanMgr.getLan("",Lans.cost,a)),!1}if(e){if(e.equipKeys.length<=0)return i&&showToast(LanMgr.getLan("",10291)),!1;if(e.isAllEquipLvTop(EquipTabType.refine))return i&&showToast(LanMgr.getLan("",10292)),!1;var a;if(-1!=(a=App.isNotEnoughType(e.getRefineCost())))return i&&showToast(LanMgr.getLan("",Lans.cost,a)),!1}return!0},a.prototype.getEquipQualityNum=function(t,e){var i=App.hero.getGodVoById(t);return i?i.getQualityEquips(e).length:0},a.prototype.createEquipVo=function(t,e,i,n){void 0===i&&(i=null);var o=new EquipItemVo(App.hero.bagEquipsObj[t]);return o.slot=e,o.uuid=t,o.godId=i,o.isFirst=n,o},a.EQUIP_COUNT=4,a);function a(){this.tbEquipSet=tb.TB_equip_set.get_TB_equip_setById(1),this.equipMasterLevel=0,this.refineOpenLv=0,this.curShowGod=null,this.equipTabName=[[LanMgr.getLan("",12579),0],[LanMgr.getLan("",12580),ModuleConst.EQUIP_JINGLIAN],[LanMgr.getLan("",12581),ModuleConst.EQUIP_BAOSHI]],this.equiptabredName=["equip_tab_0","equip_tab_1","equip_tab_2"],this.arrOpertionName=[LanMgr.getLan("",12582),LanMgr.getLan("",12583),LanMgr.getLan("",12584),LanMgr.getLan("",12585)],this.arrLongAttriName=["",LanMgr.getLan("",12586),LanMgr.getLan("",12587),LanMgr.getLan("",12588)]}t.EquipModel=e}(game=game||{}),function(t){t[t.BAG_VIEW=0]="BAG_VIEW",t[t.EQUIP_VIEW=1]="EQUIP_VIEW",t[t.SHENLING_VIEW=2]="SHENLING_VIEW",t[t.SHENLING_BAOSHI_VIEW=3]="SHENLING_BAOSHI_VIEW"}(EquipType=EquipType||{}),function(t){t[t.strength=0]="strength",t[t.refine=1]="refine",t[t.baoshi=2]="baoshi"}(EquipTabType=EquipTabType||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=tl3d.Processor,__extends(n,t),n.prototype.getName=function(){return"ResProcessor"},n.prototype.listenModuleEvents=function(){return[]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.ResEvent)switch(t.type){case e.ResEvent.RESOURCE_CHANGE:logdebug("货币变化");break;case e.ResEvent.PROP_CHANGE:logdebug("道具变化")}},n);function n(){return t.call(this)||this}e.ResProcessor=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"ResModule"},n.prototype.listProcessors=function(){return[new t.ResProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.ResModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.RESOURCE_CHANGE="COINS_CHANGE",r.PROP_CHANGE="PROP_CHANGE",r.TIME_PROP_CHANGE="PROP_CHANGE",r.EQUIPMENET_CHANGE="EQUIPMENET_CHANGE",r.ROLE_EXP_CHANGE="ROLE_EXP_CHANGE",r.GOD_EXP_CHANGE="GOD_EXP_CHANGE",r.ARENA_NUM_CHANGE="ARENA_NUM_CHANGE",r.GUILE_DONATE_CHANGE="GUILE_DONATE_CHANGE",r.ROLE_LEVEL_CHANGE="ROLE_LEVEL_CHANGE",r.LIMIT_VALUE_CHANGE="LIMIT_VALUE_CHANGE",r.OVERPLUS_VALUE_CHANGE="OVERPLUS_VALUE_CHANGE",r.VIP_LEVEL_CHANGE="VIP_LEVEL_CHANGE",r.ISCERTIFICATION_EVENT="ISCERTIFICATION_EVENT",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.ResEvent=a}(game=game||{}),function(t){var e=(i.prototype.setAnswer=function(t){this.questValue=t,this.answerFlag=!0},i.prototype.isExpire=function(){return App.serverTimeSecond>=this.svo.limitTime},i.prototype.isHasAnswer=function(){return this.answerFlag},i.prototype.getQuestTb=function(){return tb.TB_question.getTB_questionById(this.svo.questId)},i);function i(t,e){this.answerFlag=!1,this.key=t,this.svo=e,this.tbRisk=tb.TB_risk.getTB_riskById(e.riskId)}t.DafuwengVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var o,e=(__extends(i,o=GameUIChar),i.prototype.moveTomorepos=function(t){this.posAry=t,this.goto()},i.prototype.set2dPos=function(t,e){o.prototype.set2dPos.call(this,t,e),this.pixelPos=new tl3d.Vector2D(t,e)},i.prototype.updateFrame=function(t){if(this.moveToCurV2d){if(10<tl3d.Vector2D.distance(this.pixelPos,this.moveToCurV2d)){var e=this.pixelPos.sub(this.moveToCurV2d);e.normalize(),e.scaleBy(this.runspeed),this.pixelPos.x+=e.x,this.pixelPos.y+=e.y,o.prototype.set2dPos.call(this,this.pixelPos.x,this.pixelPos.y),this.play(tl3d.CharAction.WALK)}else o.prototype.set2dPos.call(this,this.moveToCurV2d.x,this.moveToCurV2d.y),this.goto();this.moveingFun&&this.moveingFun(this.pixelPos)}if(o.prototype.updateFrame.call(this,t),this._partDic)for(var i=this._partDic.mesh,n=0;i&&n<i.length;n++)i[n].scaleX!=this.scale&&(i[n].scaleX=this.scale,i[n].scaleY=this.scale,i[n].scaleZ=this.scale)},i.prototype.goto=function(){if(this.moveToCurV2d=this.posAry&&0<this.posAry.length?this.posAry.shift():null,this.moveToCurV2d){var t=this.pixelPos.sub(this.moveToCurV2d);this.pRotationY=180-180*Math.atan2(t.x,t.y)/Math.PI}else this.play(tl3d.CharAction.STANAD),this.movetocb&&this.movetocb()},i);function i(){var t=o.call(this)||this;return t.posAry=[],t}t.DafuwengChar=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.dafuweng.startIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){},n);function n(){return e.call(this)||this}t.startIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.dafuweng.questionPanelUI,__extends(i,e),i.prototype.close=function(){this.lab_question.text="",this.btn_result1.label="",this.btn_result2.label=""},i.prototype.initView=function(){var t=this.dataSource;if(t&&t.tbRisk.type==n.RiskType.QUESTION){this.img_right.visible=this.img_wrong.visible=!1,this.btn_result1.disabled=this.btn_result2.disabled=!1;var e=t.getQuestTb();this.lab_question.text=e.question,this.btn_result1.label=e.left_option,this.btn_result2.label=e.right_option;var i=ary2prop(e.correct_reward);this.list_reward.array=i,this.list_reward.width=80*i.length+this.list_reward.spaceX*(i.length-1)}},i.prototype.onCommit=function(o){var a=this,r=this.dataSource;if(r&&r.tbRisk.type==n.RiskType.QUESTION)if(r.isExpire())showToast(LanMgr.getLan("",10286));else{var t={};t[Protocol.game_risk_answer.args.riskKey]=r.key,t[Protocol.game_risk_answer.args.id]=Number(o.target.name),PLC.request(Protocol.game_risk_answer,t,function(t){if(t){r.setAnswer(Number(o.target.name)),t.delRiskKey&&a._model.delRiskInfo([t.delRiskKey]);var e=[];UIUtil.getRewardItemVoList(e,t.commonData,!1,!1);var i=t.commonData?LanMgr.getLan("",12455):LanMgr.getLan("",12456),n={title:LanMgr.getLan("",12454),content:i,itemList:e,callBack:a.toClose.bind(a)};UIMgr.showUI(UIConst.DFW_QiyuResultView,n)}})}},i.prototype.toClose=function(){var t=this.dataSource;dispatchEvt(new n.DafuwengEvent(n.DafuwengEvent.DEL_QIYU_TAB),t?t.key:null)},i);function i(){var t=e.call(this)||this;return t.isModelClose=!1,t.btn_result1.on(Laya.Event.CLICK,t,t.onCommit),t.btn_result2.on(Laya.Event.CLICK,t,t.onCommit),t._model=n.DafuwengModel.getInstance(),t}n.questionPanel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.dafuweng.questionIRUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)||this.ani1.stop()},enumerable:!0,configurable:!0}),n.prototype.onClick=function(){showToast(LanMgr.getLan("",10285))},n);function n(){var t=i.call(this)||this;return t._model=e.DafuwengModel.getInstance(),t.img_question.on(Laya.Event.CLICK,t,t.onClick),t}e.questionIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(i){var n,t=(n=ui.dafuweng.QiyuViewUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this._model=i.DafuwengModel.getInstance(),this.width=Laya.stage.width,this.height=Laya.stage.height,this.isModelClose=!1,this._viewMap={},this.listTab.array=null,this.listTab.selectHandler=new Handler(this,this.onSelect),this.listTab.selectedIndex=-1,this.btnLeft.on(Laya.Event.CLICK,this,this.onLeft),this.btnRight.on(Laya.Event.CLICK,this,this.onRight),this.imgBg.on(Laya.Event.CLICK,this,this.close),this.uiScene=new i.DafuwengExtSceneLayer,this.addChild(this.uiScene)},e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(){for(var t in n.prototype.close.call(this),this.listTab.array=null,this.listTab.selectedIndex=-1,this._shaizi=null,this.uiScene.onExit(),this._viewMap){var e=this._viewMap[t];GameUtil.isFunction(e.close)&&e.close()}Dialog.manager.mouseEnabled=!0},e.prototype.initView=function(){this._shaizi=this.uiScene.addModelChar(String(100006),360,720,180,2.7),this._shaizi.shadow=!1,this.removeShaizi();var t=this._model.getRiskList(!0);this.listTab.array=__spreadArrays(t),this.listTab.selectedIndex=0,this.uiScene.onShow()},e.prototype.delTab=function(t){var e=this._model.getRiskList(!0);if(this.listTab.array=__spreadArrays(e),0<e.length){var i=this.listTab.selectedIndex;0<i?this.listTab.selectedIndex=i-1:(this.listTab.selectedIndex=-1,this.listTab.selectedIndex=i)}else this.close()},e.prototype.onSelect=function(t){if(-1!=t){var e=this.listTab.getItem(t);if(e){var i=this.getView(e.tbRisk.type);i.dataSource=e,this.boxContent.height=i.height,this.boxContent.removeChildren(),this.boxContent.addChild(i),GameUtil.isFunction(i.initView)&&i.initView()}}},e.prototype.onLeft=function(){this.listTab.scrollTo(this.listTab.selectedIndex-1)},e.prototype.onRight=function(){this.listTab.scrollTo(this.listTab.selectedIndex+1)},e.prototype.caiDaXiaoResult=function(n){var o=this;if(DialogExt.manager.mouseEnabled=!1,n.sdata.winType){var t=n.selectId%2;n.sdata.winType==iface.tb_prop.guessTypeKey.loss&&(t=(n.selectId+1)%2);var e=tb.TB_risk_set.getTabSet(),i=utils.random(e.guess_size[t][0],e.guess_size[t][1]);this.playShaizi(i),setTimeout(function(){if(o.removeShaizi(),n.sdata.winType==iface.tb_prop.guessTypeKey.win||n.sdata.winType==iface.tb_prop.guessTypeKey.loss){var t=[];UIUtil.getRewardItemVoList(t,n.sdata.commonData,!1,!1);var e=n.sdata.winType==iface.tb_prop.guessTypeKey.win?LanMgr.getLan("",12458):LanMgr.getLan("",12459),i={title:LanMgr.getLan("",12457),content:e,itemList:t,callBack:o.delTab.bind(o)};UIMgr.showUI(UIConst.DFW_QiyuResultView,i)}DialogExt.manager.mouseEnabled=!0},2450)}},e.prototype.playShaizi=function(t){this._shaizi&&(this._shaizi.visible=!0,this._shaizi.play(String(t),1))},e.prototype.removeShaizi=function(){this._shaizi&&(this._shaizi.play(tl3d.CharAction.STANAD,1),this._shaizi.visible=!1)},e.prototype.getView=function(t){if(!this._viewMap[t]){var e=void 0;t==i.RiskType.QUESTION?e=new i.questionPanel:t==i.RiskType.CAIDAXIAO?e=new i.caiDaXiaoView:t==i.RiskType.CAIQUAN?e=new i.caiQuanView:t==i.RiskType.BIYANLI&&(e=new i.biYanLiView),e.centerX=0,this._viewMap[t]=e}return this._viewMap[t]},e);function e(){return n.call(this)||this}i.QiyuView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.dafuweng.QiyuTabIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t?(this._endTime=t.svo.limitTime,Laya.timer.loop(1e3,this,this.updateTime),this.updateTime(),this.img.skin=SkinUtil.getQiyuSkin(t.tbRisk.type),this.animSelect.play(0,!0)):(Laya.timer.clearAll(this),this._endTime=0,this.animSelect.stop())},n.prototype.updateTime=function(){var t=this._endTime-App.serverTimeSecond;this.lbTime.text=GameUtil.toCountdown(t,"hh:mm:ss")},n);function n(){var t=e.call(this)||this;return t._endTime=0,t}t.QiyuTabIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.dafuweng.QiyuResultUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.DFW_QiyuResultView,closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",10536)}},n.prototype.popup=function(t,e){this.initSize(),i.prototype.popup.call(this,t,e),this.initView()},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e)},n.prototype.close=function(){i.prototype.close.call(this),this._resultVo&&this._resultVo.callBack&&(this._resultVo.callBack(),this._resultVo.callBack=null),this.listItem.array=null,this._resultVo=null},n.prototype.initSize=function(){this._resultVo=this.dataSource;var t=0<(this._resultVo.itemList||[]).length;this.height=t?400:300},n.prototype.initView=function(){this.bgPanel.updateTitle(this._resultVo.title),this.lbTitle.text=this._resultVo.content,this.setList()},n.prototype.setList=function(){var t=this._resultVo.itemList||[],e=0<t.length;(this.listItem.visible=e)&&(this.listItem.array=t,this.listItem.width=100*t.length+(t.length-1)*this.listItem.spaceX)},n);function n(){return i.call(this)||this}t.QiyuResultView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.dafuweng.QiyuBtnUI,__extends(n,e),n.prototype.onShow=function(){this.redPoint.setRedPointName("adventure_qiyu"),tl3d.ModuleEventManager.addEvent(t.DafuwengEvent.ADD_RISK_INFO,this.initView,this),tl3d.ModuleEventManager.addEvent(t.DafuwengEvent.DEL_RISK_INFO,this.initView,this),tl3d.ModuleEventManager.addEvent(t.DafuwengEvent.UPDATE_RISK_INFO,this.initView,this),this.bombAnim.visible=!1,this.bombAnim.stop(),this.bombAnim.on(Laya.Event.COMPLETE,this,this.onBombComple),this.ani2.on(Laya.Event.COMPLETE,this,this.onCompleAnim2),this.ani2.gotoAndStop(0),this.ani1.gotoAndStop(0),this.initView()},n.prototype.onExist=function(){this.bombAnim.visible=!1,this.bombAnim.stop(),this.ani2.gotoAndStop(0),this.ani1.gotoAndStop(0),this.redPoint.onDispose(),Laya.timer.clearAll(this),tl3d.ModuleEventManager.removeEvent(t.DafuwengEvent.ADD_RISK_INFO,this.initView,this),tl3d.ModuleEventManager.removeEvent(t.DafuwengEvent.DEL_RISK_INFO,this.initView,this),tl3d.ModuleEventManager.removeEvent(t.DafuwengEvent.UPDATE_RISK_INFO,this.initView,this)},n.prototype.initView=function(){0<t.DafuwengModel.getInstance().getRiskList(!1).length?this.ani1.play(0,!0):this.ani1.gotoAndStop(0),this.ani2.gotoAndStop(0)},n.prototype.playAnim2=function(){this.ani1.stop(),this.ani2.play(0,!1),this.bombAnim.visible=!0,this.bombAnim.play(0,!1)},n.prototype.onCompleAnim2=function(){this.initView()},n.prototype.onBombComple=function(){this.bombAnim.visible=!1,this.bombAnim.stop()},n);function n(){return e.call(this)||this}t.QiyuBtnView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var e,t=(e=ui.dafuweng.QiyuAnimUI,__extends(i,e),i.prototype.startAnim=function(t,e,i,n){Dialog.manager.mouseEnabled=!1,this._removeCallback=i,this._itemAnimEndCallback=n,this.x=Laya.stage.width/2-this.width/2,this.y=Laya.stage.height/2-this.height/2,Laya.stage.addChild(this),this.ani1.play(0,!1),this._targetPos=e,this._btnList.length=0;for(var o=t.length,a=this.width/2-(4<o?340:170*o/2),r=this.height/2-90,s=0;s<o;s++){var u=new h.QiyuTabIR;u.scale(1,1),u.dataSource=t[s],u.clientPos=new Laya.Point(a+s%4*170,r+185*Math.floor(s/4)),u.x=u.clientPos.x,u.y=u.clientPos.y,u.visible=!1,this._btnList.push(u),this.addChild(u)}},i.prototype.showQiyu=function(){function t(t){var e=1300+200*t;o=e;var i=a._btnList[t];i.visible=!0,Laya.Tween.from(i,{x:275,y:840,alpha:.5},300),Laya.Tween.to(i,{x:a._targetPos.x,y:a._targetPos.y,alpha:.5,scaleX:.5,scaleY:.5},500,null,new Handler(a,function(){i&&i.removeSelf(),n._itemAnimEndCallback&&n._itemAnimEndCallback()}),e)}for(var n=this,e=this._btnList.length,o=0,a=this,i=0;i<e;i++)t(i);Laya.timer.once(1300,this,function(){n.ani2.play(0,!1)}),Laya.timer.once(o+500,this,this.onRemove)},i.prototype.onRemove=function(){Dialog.manager.mouseEnabled=!0;for(var t=0,e=this._btnList;t<e.length;t++){var i=e[t];Laya.Tween.clearAll(i),i.removeSelf()}this._btnList.length=0,this.removeSelf(),Laya.Tween.clearAll(this),Laya.timer.clearAll(this),this.ani1.gotoAndStop(0),this._removeCallback&&(this._removeCallback(),this._removeCallback=null),this._itemAnimEndCallback=null},i);function i(){var t=e.call(this)||this;return t._btnList=[],t.mouseEnabled=!0,t.mouseThrough=!1,t.ani1.on(Laya.Event.COMPLETE,t,t.showQiyu),t}h.QiyuAnimView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.dafuweng.propIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){this.dataSource&&(this.ui_item.dataSource=new ItemVo(this.dataSource.para[0][0],this.dataSource.para[0][1]))},n);function n(){return e.call(this)||this}t.propIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.dafuweng.goAndOutIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){this.dataSource?(this.lab_info.text=0<this.dataSource.para[0][0]?""+LanMgr.getLan("",12460)+this.dataSource.para[0][0]:""+LanMgr.getLan("",12461)+Math.abs(this.dataSource.para[0][0]),this.ani1.play()):this.ani1.stop()},n);function n(){return e.call(this)||this}t.goAndOutIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.dafuweng.diamondIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){this.dataSource&&(this.img.skin=this.dataSource.para[0][0]==iface.tb_prop.resTypeKey.gold?"tanxian/jinqian.png":"tanxian/zuanshi.png",this.lab_num.text=Snums(this.dataSource.para[0][1]))},n);function n(){return e.call(this)||this}t.diamondIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var a,t;(t=a=e.CaiQuanState||(e.CaiQuanState={}))[t.BEFORE=0]="BEFORE",t[t.ONGOING=1]="ONGOING",t[t.ENDING=2]="ENDING";var i,n=(i=ui.dafuweng.caiQuanViewUI,__extends(o,i),o.prototype.close=function(){},o.prototype.initView=function(){var t=this.dataSource;if(t){var e=ary2prop(t.tbRisk.para);this.list_reward.array=e,this.list_reward.width=80*e.length+this.list_reward.spaceX*(e.length-1),this.setVis(!0),this._state=a.BEFORE}},o.prototype.onClick=function(e){var i=this,n=this.dataSource;if(n&&this._state==a.BEFORE)if(n.isExpire())showToast(LanMgr.getLan("",10286));else{this._state=a.ONGOING,DialogExt.manager.mouseEnabled=!1;var o=setTimeout(function(){DialogExt.manager.mouseEnabled=!0},5e3),t={};t[Protocol.game_risk_fingerGuess.args.riskKey]=n.key,t[Protocol.game_risk_fingerGuess.args.id]=null,PLC.request(Protocol.game_risk_fingerGuess,t,function(t){t&&(n.setAnswer(Number(e.target.name)),clearTimeout(o),t.delRiskKey&&i._model.delRiskInfo([t.delRiskKey]),i.result(t,Number(e.target.name)))})}},o.prototype.result=function(n,t){var o=this;if(this.dataSource){var e=t;n.winType==iface.tb_prop.guessTypeKey.win?e=this.getTagId(t,!0):n.winType==iface.tb_prop.guessTypeKey.loss&&(e=this.getTagId(t,!1)),this.setVis(!1),this.btn_1.skin=this.skins[t-1],this.btn_1.visible=this.btn_3.visible=!0,this._loopNum=0,this.btn_3.skin=this.skins[this._loopNum%3],this._loopNum++,this.timer.loop(150,this,function(){10<o._loopNum?(o.timer.clearAll(o),o.btn_3.skin=o.skins[e-1],setTimeout(function(){if(o._state=a.ENDING,n.winType==iface.tb_prop.guessTypeKey.win||n.winType==iface.tb_prop.guessTypeKey.loss){var t=[];UIUtil.getRewardItemVoList(t,n.commonData,!1,!1);var e=n.winType==iface.tb_prop.guessTypeKey.win?LanMgr.getLan("",12463):LanMgr.getLan("",12464),i={title:LanMgr.getLan("",12462),content:e,itemList:t,callBack:o.toClose.bind(o)};UIMgr.showUI(UIConst.DFW_QiyuResultView,i)}else o._state=a.BEFORE,showToast(LanMgr.getLan("",10288)),o.setVis(!0);DialogExt.manager.mouseEnabled=!0},500)):(o.btn_3.skin=o.skins[o._loopNum%3],o._loopNum++)})}},o.prototype.toClose=function(){var t=this.dataSource;dispatchEvt(new e.DafuwengEvent(e.DafuwengEvent.DEL_QIYU_TAB),t?t.key:null)},o.prototype.setVis=function(t){this.btn_1.visible=this.btn_2.visible=this.btn_3.visible=t,t&&(this.btn_1.skin=this.skins[0],this.btn_2.skin=this.skins[1],this.btn_3.skin=this.skins[2]),this.img_vs.visible=!t},o.prototype.getTagId=function(t,e){for(var i=tb.TB_risk_set.getTabSet(),n=0;n<i.guess_fist.length;n++){var o=i.guess_fist[n];if(e){if(o[0]==t)return o[1]}else if(o[1]==t)return o[0]}return t},o);function o(){var t=i.call(this)||this;return t._model=e.DafuwengModel.getInstance(),t.skins=["tanxian/jiandao.png","tanxian/shitou.png","tanxian/bu.png"],t.isModelClose=!1,t.btn_1.on(Laya.Event.CLICK,t,t.onClick),t.btn_2.on(Laya.Event.CLICK,t,t.onClick),t.btn_3.on(Laya.Event.CLICK,t,t.onClick),t}e.caiQuanView=n}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.dafuweng.caiDaXiaoViewUI,__extends(i,e),i.prototype.close=function(){this.setVisible(!0)},i.prototype.initView=function(){var t=this.dataSource;if(t){var e=ary2prop(t.tbRisk.para);this.list_reward.dataSource=e,this.list_reward.width=80*e.length+this.list_reward.spaceX*(e.length-1);var i=tb.TB_risk_set.getTabSet();this.img_icon0.skin=SkinUtil.getCostSkin(i.guess_size_cost[0][0]),this.img_icon1.skin=SkinUtil.getCostSkin(i.guess_size_cost[0][0]),this.lab_cost0.text=Snums(i.guess_size_cost[0][1]),this.lab_cost1.text=Snums(i.guess_size_cost[0][1]),this.setVisible(!0)}},i.prototype.setVisible=function(t){this.btn_small.visible=this.img_icon0.visible=this.lab_cost0.visible=t,this.btn_big.visible=this.img_icon1.visible=this.lab_cost1.visible=t,this.imgSaizi.visible=t},i.prototype.onClick=function(e){var i=this,n=this.dataSource;if(n)if(n.isExpire())showToast(LanMgr.getLan("",10286));else{var t=tb.TB_risk_set.getTabSet();if(App.getResNum(t.guess_size_cost[0][0])<t.guess_size_cost[0][1])showToast(LanMgr.getLan("",10287));else{var o={};o[Protocol.game_risk_sizeGuess.args.riskKey]=n.key,o[Protocol.game_risk_sizeGuess.args.id]=null,PLC.request(Protocol.game_risk_sizeGuess,o,function(t){t&&(i.setVisible(!1),n.setAnswer(Number(e.target.name)),t.delRiskKey&&i._model.delRiskInfo([t.delRiskKey]),dispatchEvt(new a.DafuwengEvent(a.DafuwengEvent.CLICK_CAIDAXIAO),{sdata:t,selectId:Number(e.target.name),key:n.key}))})}}},i);function i(){var t=e.call(this)||this;return t._model=a.DafuwengModel.getInstance(),t.isModelClose=!1,t.btn_small.on(Laya.Event.CLICK,t,t.onClick),t.btn_big.on(Laya.Event.CLICK,t,t.onClick),t}a.caiDaXiaoView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.dafuweng.boxIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){},n.prototype.onClick=function(){UIMgr.showUI(UIConst.ManyItemsTip,{data:ary2prop(this.dataSource.box_preview),info:LanMgr.getLan("",12465)})},n);function n(){var t=e.call(this)||this;return t.img_box.on(Laya.Event.CLICK,t,t.onClick),t}t.boxIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t;(t=i=e.bowieState||(e.bowieState={}))[t.CLOSE=0]="CLOSE",t[t.OPEN=1]="OPEN";var n,o=(n=ui.dafuweng.yanliBoxIRUI,__extends(a,n),Object.defineProperty(a.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),a.prototype.initView=function(){Laya.Tween.clearAll(this),Laya.Tween.clearAll(this.img_barrel),this.dataSource&&(this.ui_prop.dataSource=new ItemVo(this.dataSource.prop[0],this.dataSource.prop[1]),this.img_barrel.y=0,this.img_barrel.alpha=1,this.curState=i.CLOSE)},a.prototype.openAndcloseEff=function(t){var e=this;this.openEff(function(){setTimeout(function(){e.closeEff(function(){t&&t()})},1e3)})},a.prototype.openEff=function(t){var e=this;this.dataSource&&Laya.Tween.to(this.img_barrel,{y:-93,alpha:.7},600,null,Handler.create(this,function(){e.curState=i.OPEN,t&&t()}))},a.prototype.closeEff=function(t){var e=this;this.dataSource&&Laya.Tween.to(this.img_barrel,{y:0,alpha:1},600,null,Handler.create(this,function(){e.curState=i.CLOSE,t&&t()}))},a);function a(){var t=n.call(this)||this;return t._model=e.DafuwengModel.getInstance(),t}e.bowieIR=o}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var a,t;(t=a=n.BiYanLiGameState||(n.BiYanLiGameState={}))[t.BEFORE=0]="BEFORE",t[t.ONGOING=1]="ONGOING",t[t.END=2]="END";var e,i=(e=ui.dafuweng.biYanLiViewUI,__extends(o,e),o.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.btn_start.on(Laya.Event.CLICK,this,this.onClick),this.ui_tong1.img_barrel.on(Laya.Event.CLICK,this,this.onClickBowie,[this.ui_tong1]),this.ui_tong2.img_barrel.on(Laya.Event.CLICK,this,this.onClickBowie,[this.ui_tong2]),this.ui_tong3.img_barrel.on(Laya.Event.CLICK,this,this.onClickBowie,[this.ui_tong3])},o.prototype.close=function(){},o.prototype.initView=function(){var t=this.dataSource;if(t){this._gamestate=a.BEFORE,this.btn_start.visible=!0;var e=t.tbRisk;this.ui_tong1.dataSource={id:1,prop:e.para[0]},this.ui_tong2.dataSource={id:2,prop:e.para[1]},this.ui_tong3.dataSource={id:3,prop:e.para[2]}}else logerror("比眼力获取不到数据")},o.prototype.onClickBowie=function(t){var o=this,e=this.dataSource;if(e&&this._gamestate!=a.BEFORE&&t.dataSource&&t.curState==n.bowieState.CLOSE&&this._gamestate==a.ONGOING){if(e.isExpire())return void showToast(LanMgr.getLan("",10286));Dialog.manager.mouseEnabled=!1,this.ui_tong1.openEff(),this.ui_tong2.openEff(),this.ui_tong3.openEff();var i={};i[Protocol.game_risk_eyesightGuess.args.id]=t.dataSource.id,i[Protocol.game_risk_eyesightGuess.args.riskKey]=e.key,PLC.request(Protocol.game_risk_eyesightGuess,i,function(n){n?(e.setAnswer(Number(t.dataSource.id)),n.delRiskKey&&o._model.delRiskInfo([n.delRiskKey]),Laya.timer.once(1e3,o,function(){Dialog.manager.mouseEnabled=!0;var t=[];UIUtil.getRewardItemVoList(t,n.commonData,!1,!1);var e=LanMgr.getLan("",12467),i={title:LanMgr.getLan("",12466),content:e,itemList:t,callBack:o.toClose.bind(o)};UIMgr.showUI(UIConst.DFW_QiyuResultView,i)})):Dialog.manager.mouseEnabled=!0}),this._gamestate=a.END}},o.prototype.toClose=function(){var t=this.dataSource;dispatchEvt(new n.DafuwengEvent(n.DafuwengEvent.DEL_QIYU_TAB),t?t.key:null)},o.prototype.onClick=function(){this._gamestate==a.BEFORE&&(this._gamestate=a.ONGOING,this._showcbflag=!0,this.btn_start.visible=!1,Dialog.manager.mouseEnabled=!1,this.ui_tong1.openAndcloseEff(this.showcb.bind(this)),this.ui_tong2.openAndcloseEff(this.showcb.bind(this)),this.ui_tong3.openAndcloseEff(this.showcb.bind(this)))},o.prototype.showcb=function(){if(this.ui_tong1.curState==n.bowieState.CLOSE&&this.ui_tong2.curState==n.bowieState.CLOSE&&this.ui_tong3.curState==n.bowieState.CLOSE){if(!this._showcbflag)return;this._showcbflag=!1,this._changeNum=0,this._speed=500,this.startChange()}},o.prototype.startChange=function(){var t=this;if(this._changeNum>this._difficulty)Dialog.manager.mouseEnabled=!0;else{this.updateorder(),this._changeNum++;var e=random(3),i=(e+1)%3;e+=1,++i;var n=this.getChildByName("ui_tong"+e),o=n.x,a=n.y,r=this.getChildByName("ui_tong"+i),s=r.x,u=r.y;Laya.Tween.to(n,{x:s,y:u},this._speed),Laya.Tween.to(r,{x:o,y:a},this._speed,null,Handler.create(this,function(){t.startChange()})),this._speed=Math.floor(this._speed/1.1)}},o.prototype.updateorder=function(){this.ui_tong1.zOrder=this.ui_tong1.y,this.ui_tong2.zOrder=this.ui_tong2.y,this.ui_tong3.zOrder=this.ui_tong3.y,this.updateZOrder()},o);function o(){var t=e.call(this)||this;return t._model=n.DafuwengModel.getInstance(),t._difficulty=11,t._speed=500,t}n.biYanLiView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.dafuweng.biYanLiIRUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)||this.ani1.stop()},enumerable:!0,configurable:!0}),n.prototype.onClick=function(){showToast(LanMgr.getLan("",10285))},n);function n(){var t=i.call(this)||this;return t._model=e.DafuwengModel.getInstance(),t.img_game.on(Laya.Event.CLICK,t,t.onClick),t}e.biYanLiIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var n,t=(n=ui.dafuweng.dafuwengViewUI,__extends(e,n),e.prototype.setSize=function(t,e){n.prototype.setSize.call(this,t,e),this.box_top.width=t;var i=GameUtil.isFullScreen();this.box_top.height=i?134+l.HudModel.TOP_ADD_HEIGHT:134,this.box_reward.y=i?65+l.HudModel.TOP_ADD_HEIGHT:65,this.btnQiyu.y=i?80+l.HudModel.TOP_ADD_HEIGHT:80},e.prototype.onRule=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(40002))},e.prototype.onShowQiyu=function(){dispatchEvt(new l.DafuwengEvent(l.DafuwengEvent.SHOW_QIYU_VIEW))},e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(){n.prototype.close.call(this),this._resetflag=!1,this._secondMoveFlag=!1,this.clearAllProp(),tl3d.ModuleEventManager.removeEvent(l.ResEvent.PROP_CHANGE,this.updateRes,this),this.btnQiyu.onExist(),this.resList.array=null,this.uiScene.onExit(),this._char=null,this._shaizi=null,this.ui_special_reward.dataSource=null,dispatchEvt(new l.HudEvent(l.HudEvent.SHOW_MODULE_VIEW),[ModuleConst.FIGHT])},e.prototype.initView=function(){var e=this;this.checkBox.selected=this._model.TEN_SELECT,this._resetflag=!1,this._secondMoveFlag=!1,tl3d.ModuleEventManager.addEvent(l.ResEvent.PROP_CHANGE,this.updateRes,this),this.resList.array=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond],this.resList.width=150*this.resList.array.length+(this.resList.array.length-1)*this.resList.spaceX,this.updateRes(),this.setNum(),this.creatStart();var t=tb.TB_risk_set.getTabSet();this.ui_special_reward.dataSource=new ItemVo(t.circle_reward[0][0],t.circle_reward[0][1]),this._localpoint=this._model.curRiskId;var i=tb.TB_risk.getTB_riskById(this._localpoint),n=(this._localpoint+1)%l.DafuwengModel.STEP_COUNT,o=tb.TB_risk.getTB_riskById(n),a=new tl3d.Vector2D(i.coordinate[0],i.coordinate[1]).sub(new tl3d.Vector2D(o.coordinate[0],o.coordinate[1]));this._char=this.uiScene.addModelChar(String(1004),i.coordinate[0],i.coordinate[1],180-180*Math.atan2(a.x,a.y)/Math.PI,.9),this._char.shadow=!0,this._shaizi=this.uiScene.addModelChar(String(100006),360,850,180,2.7),this._shaizi.shadow=!1,this.removeShaizi(),this._char.movetocb=function(){e.charMoveFun()},this._char.moveingFun=function(t){e.moveToCurLocal(t.x)},this.initPropByEff(),this.btnQiyu.onShow()},e.prototype.setNum=function(){var t=tb.TB_risk_set.getTabSet(),e=this.checkBox.selected?10*t.once_cost[1]:t.once_cost[1],i=App.hero.getBagItemNum(t.once_cost[0]);this.lbNum.text=""+Snums(i),this.lbNum.color=e<=i?"#ffffff":"#ff0000",this.lbCostNum.text="/"+e,this.boxNum.refresh()},e.prototype.charMoveFun=function(){var e=this;this.setStartVisable();var t=tb.TB_risk.getTB_riskById(this._localpoint);if(this._localpoint!=this._model.curRiskId)if(t.type==l.RiskType.OUT){var i=Number(t.para[0][0]),n=this._localpoint;setTimeout(function(){e.moveChar(n,i)},300),showToast(0<i?LanMgr.getLan("",10282,i):LanMgr.getLan("",10283,i)),this._propObj.hasOwnProperty(t.ID)&&(this._propObj[t.ID].removeSelf(),delete this._propObj[t.ID])}else{var o=this._localpoint;if(this._secondMoveFlag){var a=this._model.curRiskId-this._localpoint;this._secondMoveFlag=!1,setTimeout(function(){e.moveChar(o,a)},1e3)}else logerror("大富翁数据异常",this._localpoint,this._model.curRiskId)}else{this._lockflag=!1,this.mouseEnabled=!0;var r=(this._commondata?this._commondata.riskList:[])||[];UIUtil.showRewardView(this._commondata,function(){if(0<r.length){var t=e.btnQiyu.localToGlobal(new Laya.Point(0,0));e._qiyuAnim||(e._qiyuAnim=new l.QiyuAnimView),e._qiyuAnim.startAnim(r,t,null,function(){e.btnQiyu.playAnim2()})}}),this._commondata=null;for(var s=0,u=this._model.riskIds;s<u.length;s++){var h=u[s];this._propObj.hasOwnProperty(h)&&(this._propObj[h].removeSelf(),delete this._propObj[h])}}this._resetflag&&(this.initPropByEff(),this._resetflag=!1)},e.prototype.creatStart=function(){if(!this._startUI){var t=tb.TB_risk.getTB_riskById(0);this._startUI=new l.startIR,this._startUI.x=t.item_coordinate[0],this._startUI.y=t.item_coordinate[1],this._startUI.dataSource=t,this._startUI.zOrder=this._startUI.y,this.box_itemspr.addChild(this._startUI),this.setStartVisable()}},e.prototype.setStartVisable=function(){this._startUI.visible=0!=this._model.curRiskId,this.img_index.visible&&(Laya.Tween.clearAll(this.img_index),this.img_index.visible=!1)},e.prototype.onPlay=function(){var n=this,o=this.checkBox.selected?10:1,t=tb.TB_risk_set.getTabSet();if(App.hero.getBagItemNum(t.once_cost[0])<t.once_cost[1]*o)showToast(LanMgr.getLan("",10284));else if(!this._lockflag){AudioMgr.playSound("sound/touzi.mp3"),this.mouseEnabled=!1,this._lockflag=!0;var e={};e[Protocol.game_risk_rollDice.args.count]=o,PLC.request(Protocol.game_risk_rollDice,e,function(t){if(t){n._char.runspeed=1==o?3:9,n._commondata=t.commonData||{};var e=n._localpoint;n._model.curRiskId=t.curRiskId,n._model.riskIds=t.riskIds,t.hasOwnProperty("addRiskInfo")&&(n._commondata.riskList=n._model.addRiskInfo(t.addRiskInfo)),dispatchEvt(new l.DafuwengEvent(l.DafuwengEvent.PLAY_SUCCESS));var i=t.diceNum;1==o?(n.playShaizi(i),setTimeout(function(){n.removeShaizi(),t.hasOwnProperty("clearQuestIds")&&(n._resetflag=!0),n.moveChar(e,i)},2450)):(t.hasOwnProperty("clearQuestIds")?(n._resetflag=!0,0<n._model.curRiskId&&(n._secondMoveFlag=!0)):i=n._model.curRiskId-n._localpoint,n.moveChar(e,i))}else n.mouseEnabled=!0})}},e.prototype.playShaizi=function(t){this._shaizi&&(this._shaizi.visible=!0,this._shaizi.set2dPos(360-this.img_bg.x+643,850),this._shaizi.play(String(t),1))},e.prototype.removeShaizi=function(){this._shaizi&&(this._shaizi.play(tl3d.CharAction.STANAD,1),this._shaizi.visible=!1)},e.prototype.moveChar=function(a,r){var s=this;this._char&&this.moveBg(this._char.get2dPos().x,function(){var t=a+r;s._resetflag&&(t=l.DafuwengModel.STEP_COUNT);var e=tb.TB_risk.getTB_riskById(t%l.DafuwengModel.STEP_COUNT);s.img_index.visible||(s.img_index.x=e.item_coordinate[0],s.img_index.y=e.item_coordinate[1]-80,s.img_index.visible=!0,UIUtil.loop(s.img_index,s.img_index.x,s.img_index.y,1e3,30,TweenDirection.down));var i=[],n=t<a,o=a+1;for(n&&(o=a-1);n?t<=o:o<=t;n?o--:o++)(e=tb.TB_risk.getTB_riskById(o%l.DafuwengModel.STEP_COUNT))&&i.push(new tl3d.Vector2D(e.coordinate[0],e.coordinate[1]));s._char.moveTomorepos(i),s._localpoint=t%l.DafuwengModel.STEP_COUNT})},e.prototype.getPosX=function(t){var e=Laya.stage.width;return(t=-(t-e/2))<e-this.img_bg.width&&(t=e-this.img_bg.width),t>-Launch.offsetX&&(t=-Launch.offsetX),t+643},e.prototype.moveToCurLocal=function(t){var e=this.getPosX(t);this.img_bg.x!=e&&(this.img_bg.x=e,this.uiScene.setPosition(this.img_bg.x-643,this.img_bg.y-640))},e.prototype.moveBg=function(t,e){var i=this,n=this.getPosX(t);if(this.img_bg.x!=n){var o=this._speed*Math.abs(n-this.img_bg.x);Laya.Tween.to(this.img_bg,{x:n,update:new Laya.Handler(this,function(){i.uiScene.setPosition(i.img_bg.x-643,i.img_bg.y-640)})},o,null,new Laya.Handler(this,function(){e&&e()}))}else e&&e()},e.prototype.updateRes=function(){this.resList.refresh()},e.prototype.mouseDown=function(t){this.downX=this.mLastMouseX=this.img_bg.mouseX,this.downY=this.mLastMouseY=this.img_bg.mouseY,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove)},e.prototype.mouseMove=function(t){var e=this.img_bg.mouseX-this.mLastMouseX;this.img_bg.x+=e;var i=Laya.stage.width;this.img_bg.x<i-this.img_bg.width-Launch.offsetX+643&&(this.img_bg.x=i-this.img_bg.width-Launch.offsetX+643),this.img_bg.x>643-Launch.offsetX&&(this.img_bg.x=643-Launch.offsetX),this.uiScene.setPosition(this.img_bg.x-643,this.img_bg.y-640)},e.prototype.mouseUp=function(){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.mouseMove)},e.prototype.initComplete=function(){var t=this;this.box_itemspr.updateZOrder(),this._char&&this.moveBg(this._char.get2dPos().x,function(){t._localpoint==t._model.curRiskId&&(t.mouseEnabled=!0)})},e.prototype.initPropByEff=function(){var t=this;this._propObj||(this._propObj={}),this._riskList=tb.TB_risk.get_TB_risk(),this._init?(this.mouseEnabled=!1,this._ware=0,this._itemnum=0,this.img_bg.scale(3,3),Laya.Tween.to(this.img_bg,{scaleX:1,scaleY:1},300),setTimeout(function(){t.createNodes()},200)):this.fastCreateNodes()},e.prototype.fastCreateNodes=function(){for(var t=0;t<this._riskList.length;t++){var e=this._riskList[t];if(e.type!=l.RiskType.EMPTY&&-1==this._model.riskIds.indexOf(e.ID)&&!this._propObj.hasOwnProperty(e.ID)){var i=this.createNode(e);i.y=i.dataSource.item_coordinate[1],this.box_itemspr.addChild(i),(this._propObj[e.ID]=i).ani1&&i.ani1.play()}}},e.prototype.createNodes=function(){if(!this._riskList||this._riskList.length<=0)this.initComplete();else{var t=this._riskList.shift();if(t.type!=l.RiskType.EMPTY)if(-1==this._model.riskIds.indexOf(t.ID)){var e;if(this._propObj.hasOwnProperty(t.ID)?e=this._propObj[t.ID]:(e=this.createNode(t),this.box_itemspr.addChild(e),this._propObj[t.ID]=e),this.downTween(e),this._itemnum++,10<this._itemnum)return this._ware++,this._itemnum=0,void this.timer.once(60,this,this.createNodes);this.createNodes()}else this.createNodes();else this.createNodes()}},e.prototype.downTween=function(t){var e=t.dataSource.item_coordinate[1];t.y=e-600;var i=600-150*this._ware;Laya.Tween.to(t,{y:e},i,Laya.Ease.sineIn,new Handler(this,function(){t.ani1&&t.ani1.play()}))},e.prototype.clearAllProp=function(){for(var t in this._propObj)if(this._propObj.hasOwnProperty(t)){var e=this._propObj[t];e.dataSource=null,e.removeSelf()}this._propObj=null},e.prototype.createNode=function(t){var e;switch(t.type){case l.RiskType.PROP:t.para[0][0]==iface.tb_prop.resTypeKey.gold||t.para[0][0]==iface.tb_prop.resTypeKey.diamond?e=new l.diamondIR:(e=new l.propIR).scale(.8,.8);break;case l.RiskType.OUT:e=new l.goAndOutIR;break;case l.RiskType.QUESTION:e=new l.questionIR;break;case l.RiskType.BOX:e=new l.boxIR;break;case l.RiskType.CAIQUAN:case l.RiskType.CAIDAXIAO:case l.RiskType.BIYANLI:e=new l.biYanLiIR;break;default:e=new l.boxIR}return e.x=t.item_coordinate[0],e.zOrder=t.item_coordinate[1],e.dataSource=t,e},e.prototype.onCheckbox=function(){this._model.TEN_SELECT=this.checkBox.selected,this.setNum()},e);function e(){var t=n.call(this)||this;return t._model=l.DafuwengModel.getInstance(),t._speed=4,t.group=UIConst.hud_group,t.img_viewport.viewport=new laya.maths.Rectangle(0,0,Laya.stage.width,1280),t.uiScene=new l.DafuwengExtSceneLayer,t.uiScene.scene.changeBloodManager(new BloodManagerExt),t.img_bg.skin=SkinUtil.getSysMapSkin(ModuleConst.ADVENTURE),t.img_bg.loadImage(SkinUtil.getSysMapSkin(ModuleConst.ADVENTURE),void 0,void 0,void 0,void 0,Handler.create(t,function(){t._init=!0})),t.img_bg.addChild(t.uiScene),t.uiScene.setPosition(t.img_bg.x-643,t.img_bg.y-640),t._resetflag=!1,t._secondMoveFlag=!1,t.img_bg.on(Laya.Event.MOUSE_DOWN,t,t.mouseDown),t.img_bg.on(Laya.Event.MOUSE_UP,t,t.mouseUp),t.img_bg.on(Laya.Event.MOUSE_OUT,t,t.mouseUp),t.btn_close.on(Laya.Event.CLICK,t,t.close),t.btn_play.on(Laya.Event.CLICK,t,t.onPlay),t.btnQiyu.on(Laya.Event.CLICK,t,t.onShowQiyu),t.btn_rule.on(Laya.Event.CLICK,t,t.onRule),tl3d.ModuleEventManager.addEvent(l.ResEvent.PROP_CHANGE,t.setNum,t),t.checkBox.selected=t._model.TEN_SELECT,t.checkBox.on(Laya.Event.CHANGE,t,t.onCheckbox),t.img_index.zOrder=1e6,t}l.DafuwengView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var t,e=(__extends(i,t=Base2dSceneLayer),i.prototype.setPosition=function(t,e){this.x=t+Launch.offsetX,this.y=e+Launch.offsetY},i.prototype.upFrame=function(){Scene_data.context3D.setWriteDepth(!0),Scene_data.context3D.setDepthTest(!0),tl3d.TimeUtil.update(),Scene_data.focus3D.rotationY=0,Scene_data.focus3D.rotationX=-60,Scene_data.cam3D.distance=250,scene2d.CanvasPostionModel.getInstance().tureMoveV2d=new tl3d.Vector2D(this.x,this.y),scene2d.CanvasPostionModel.getInstance().resetSize(),Scene_data.context3D.renderContext.clear(Scene_data.context3D.renderContext.DEPTH_BUFFER_BIT),tl3d.MathClass.getCamView(Scene_data.cam3D,Scene_data.focus3D),Scene_data.context3D._contextSetTest.clear(),this.scene.upFrame()},i.prototype.addModelChar=function(t,e,i,n,o,a){void 0===n&&(n=180),void 0===o&&(o=2.7),void 0===a&&(a=0);var r=new s.DafuwengChar;return this.scene.addMovieDisplay(r),r.setRoleUrl(getRoleUrl(t)),r.play(tl3d.CharAction.STANAD),r.forceRotationY=n,r.rotationZ=a,r.set2dPos(e,i),r.scale=o,r},i);function i(){return t.call(this)||this}s.DafuwengExtSceneLayer=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=tl3d.Processor,__extends(n,i),n.prototype.getName=function(){return"DafuwengProcessor"},n.prototype.listenModuleEvents=function(){return[new e.DafuwengEvent(e.DafuwengEvent.SHOW_QIYU_VIEW),new e.DafuwengEvent(e.DafuwengEvent.DEL_QIYU_TAB),new e.DafuwengEvent(e.DafuwengEvent.CLICK_CAIDAXIAO)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.DafuwengEvent)switch(t.type){case e.DafuwengEvent.SHOW_QIYU_VIEW:this.showQiyuView();break;case e.DafuwengEvent.DEL_QIYU_TAB:this.delQiyuTab(t.data);break;case e.DafuwengEvent.CLICK_CAIDAXIAO:this.clickCaidaxiao(t.data)}},n.prototype.showQiyuView=function(){0!=e.DafuwengModel.getInstance().getRiskList(!1).length?UIMgr.showUI(UIConst.DFW_QiyuView):showToast(LanMgr.getLan("",10281))},n.prototype.delQiyuTab=function(t){UIMgr.hasStage(UIConst.DFW_QiyuView)&&UIMgr.getUIByName(UIConst.DFW_QiyuView).delTab(t)},n.prototype.clickCaidaxiao=function(t){UIMgr.hasStage(UIConst.DFW_QiyuView)&&UIMgr.getUIByName(UIConst.DFW_QiyuView).caiDaXiaoResult(t)},n);function n(){var t=i.call(this)||this;return t._model=e.DafuwengModel.getInstance(),t}e.DafuwengProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"DafuwengModule"},n.prototype.listProcessors=function(){return[new t.DafuwengProcessor]},n.prototype.onRegister=function(){t.DafuwengModel.getInstance()},n);function n(){return e.call(this)||this}t.DafuwengModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_QIYU_VIEW="SHOW_QIYU_VIEW",r.DEL_QIYU_TAB="DEL_QIYU_TAB",r.UPDATE_RISK_INFO="UPDATE_RISK_INFO",r.ADD_RISK_INFO="ADD_RISK_INFO",r.DEL_RISK_INFO="DEL_RISK_INFO",r.CLICK_CAIDAXIAO="CLICK_CAIDAXIAO",r.PLAY_SUCCESS="PLAY_SUCCESS",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.DafuwengEvent=a}(game=game||{}),function(a){var t;(t=a.RiskType||(a.RiskType={}))[t.EMPTY=0]="EMPTY",t[t.PROP=1]="PROP",t[t.OUT=2]="OUT",t[t.QUESTION=3]="QUESTION",t[t.BOX=4]="BOX",t[t.CAIQUAN=5]="CAIQUAN",t[t.CAIDAXIAO=6]="CAIDAXIAO",t[t.BIYANLI=7]="BIYANLI";var e=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.initData=function(){var t=App.hero.welfare;for(var e in this.curRiskId=isEmptyObject(t)?0:t.curRiskId,this.riskIds=isEmptyObject(t)?[]:t.riskIds,this.riskInfo=isEmptyObject(t)?{}:t.riskInfo,this.riskList.length=0,this.riskInfo){var i=new a.DafuwengVo(Number(e),this.riskInfo[e]);i.isExpire()||this.riskList.push(i)}this.resetTimeout(),dispatchEvt(new a.DafuwengEvent(a.DafuwengEvent.UPDATE_RISK_INFO))},i.prototype.getRiskList=function(t){return void 0===t&&(t=!1),this.checkInvaildRisk(),t&&this.riskList.sort(function(t,e){return t.svo.limitTime-e.svo.limitTime}),this.riskList},i.prototype.addRiskInfo=function(t){var e=[];for(var i in t){this.riskInfo[i]=t[i];var n=new a.DafuwengVo(Number(i),t[i]);this.riskList.push(n),e.push(n)}return this.resetTimeout(),dispatchEvt(new a.DafuwengEvent(a.DafuwengEvent.ADD_RISK_INFO)),e},i.prototype.delRiskInfo=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];delete this.riskInfo[n]}for(var o=this.riskList.length-1;0<=o;o--)-1!=t.indexOf(this.riskList[o].key)&&this.riskList.splice(o,1);this.resetTimeout(),dispatchEvt(new a.DafuwengEvent(a.DafuwengEvent.DEL_RISK_INFO))},i.prototype.getRiskInfo=function(e){return this.riskList.find(function(t){return t.key==e})},i.prototype.checkInvaildRisk=function(){for(var t=[],e=0,i=this.riskList;e<i.length;e++){var n=i[e];n.isExpire()&&t.push(n.key)}0<t.length&&this.delRiskInfo(t)},i.prototype.resetTimeout=function(){for(var t=0,e=0,i=this.riskList;e<i.length;e++){var n=i[e];n.svo.limitTime>t&&(t=n.svo.limitTime)}var o=t-App.serverTimeSecond;Laya.timer.clearAll(this),0<o&&Laya.timer.once(1e3*o,this,function(){dispatchEvt(new a.DafuwengEvent(a.DafuwengEvent.UPDATE_RISK_INFO))})},i.STEP_COUNT=80,i);function i(){this.TEN_SELECT=!1,this.riskList=[]}a.DafuwengModel=e}(game=game||{}),function(e){var t=(i.prototype.isHire=function(){return this.svo.isHire},i.prototype.isOverForce=function(){var t=e.GodModel.getInstance().getMaxForce();return this.force>t*tb.TB_copy_set.getCopySet().hire_fight_percent/100},i);function i(t){var e=(this.svo=t).godInfo;this.force=e[0];var i=e[1],n=tb.TB_god.get_TB_godById(i[0]),o=new GodItemVo(n);o.starLevel=i[1],o.level=i[2],o.degree=i[4],o.dataType=1,i[3]&&(o.iSeverAttri=map2ary(i[3])),this.godVo=o,this.godVo.svrForce=this.force,this.godVo.dataType=1}e.YZHelpInfoVo=t}(game=game||{}),function(e){var t=(i.prototype.isPass=function(){var t=App.hero.copyInfo.expeditionId;return this.tbCopy.ID<=t},i.prototype.isCurrent=function(){var t=e.YuanzhengModel.getInstance().curGuanqia;return t&&t.tbCopy.ID==this.tbCopy.ID},i.prototype.isReward=function(){var t=App.hero.copyInfo.expeditionRewardInfo;return t[this.tbCopy.ID]&&0<t[this.tbCopy.ID]},i.prototype.isCanReward=function(){return this.isHasBaoxiang()&&this.isPass()&&!this.isReward()},i.prototype.isHasBaoxiang=function(){return 0<this.tbCopy.getBoxRewardList().length},i);function i(t,e){this.tbCopy=t,this.index=e}e.YZGuanqiaVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(d){var e,t=(__extends(i,e=BaseFightVo),i.prototype.setServerInfo=function(t){this.svo=t,e.prototype.setLineupInfo.call(this,this.svo.lineupInfo),this.headVo=new UserHeadVo(this.svo.head,this.svo.level,this.svo.headFrame)},i.prototype.setGuanqiaVo=function(t){this.guanqiaVo=t},i.prototype.getLineupGodIds=function(){for(var t=[],e=0;e<this.lineupGods.length;e++){var i=this.lineupGods[e];i&&0<this.svo.hpInfo[i.templateId]?t.push(i.templateId):t.push(0)}return t},i.prototype.getEnemyGodHp=function(t){return this.svo.hpInfo[t]},i.prototype.getEnemyGodsHpAry=function(){for(var t=[],e=this.getLineupGodIds(),i=0;i<e.length;i++){var n=e[i];if(0!=n){tb.TB_god.get_TB_godById(n);var o=this.svo.hpInfo[n];t.push(o)}else t.push(0)}return t},i.prototype.getSelfGodsHp=function(){for(var t=[],e=App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.expedition,!0),i=App.hero.copyInfo.expeditionSelfHpInfo,n=0;n<e.length;n++){var o=i.hasOwnProperty(e[n])?i[e[n]]/d.YuanzhengModel.BLOOD_BASE:1;t.push(o)}return t},i.prototype.getSelfHpInfo=function(t,e,i,n){var o={};if(!i){for(var a in t)o[this.getGodUuid(a,n)]=0;return loghgy("最终的剩余的血量万分比:",o),o}var r=App.hero.copyInfo.expeditionSelfHpInfo;for(var s in loghgy("lossHpInfo:",t,e,r),t){var u=this.getGodUuid(s,n),h=e[s],l=t[s],c=Math.ceil(l/h*d.YuanzhengModel.BLOOD_BASE);r.hasOwnProperty(u)||(r[u]=d.YuanzhengModel.BLOOD_BASE);var p=r[u]-c;p=(p=p<=0?0:p)>=d.YuanzhengModel.BLOOD_BASE?d.YuanzhengModel.BLOOD_BASE:p,o[u]=p}return loghgy("最终的剩余的血量万分比:",o),o},i.prototype.getGodUuid=function(t,e){var i=App.hero.lineupInfo[e];if(i)return i[t%10-1]},i);function i(){return e.call(this)||this}d.YZChallengeVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"YuanzhengProcessor"},i.prototype.listenModuleEvents=function(){return[new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_MAIN_VIEW),new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_RECOVERY_VIEW),new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_CHALLENGE_VIEW),new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_SHOP_VIEW),new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_HELP_VIEW),new s.YuanzhengEvent(s.YuanzhengEvent.GOTO_SET_LINUEP),new s.YuanzhengEvent(s.YuanzhengEvent.GUANQIA_CHALLENGE),new s.YuanzhengEvent(s.YuanzhengEvent.GUANQIA_REWARD),new s.YuanzhengEvent(s.YuanzhengEvent.RECOVERY_GOD),new s.YuanzhengEvent(s.YuanzhengEvent.UPDATE_VIEW)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof s.YuanzhengEvent)switch(t.type){case s.YuanzhengEvent.SHOW_MAIN_VIEW:this.showMainView();break;case s.YuanzhengEvent.SHOW_RECOVERY_VIEW:this.showRecoveryView(t.data);break;case s.YuanzhengEvent.SHOW_CHALLENGE_VIEW:this.showChallengeView(t.data);break;case s.YuanzhengEvent.SHOW_SHOP_VIEW:this.showShopView(t.data);break;case s.YuanzhengEvent.SHOW_HELP_VIEW:this.showHelpView();break;case s.YuanzhengEvent.GOTO_SET_LINUEP:this.gotoBuzhen(t.data);break;case s.YuanzhengEvent.GUANQIA_CHALLENGE:this.challengeGuanqia();break;case s.YuanzhengEvent.GUANQIA_REWARD:this.rewardGuanqia(t.data);break;case s.YuanzhengEvent.RECOVERY_GOD:this.recoveryGod(t.data);break;case s.YuanzhengEvent.UPDATE_VIEW:this.updateView()}},i.prototype.updateView=function(){UIMgr.hasStage(UIConst.YuanzhengView)&&UIMgr.getUIByName(UIConst.YuanzhengView).initView()},i.prototype.showMainView=function(){UIMgr.showUI(UIConst.YuanzhengView)},i.prototype.showChallengeView=function(t){if(t.isPass())showToast(LanMgr.getLan("",10107));else if(t.isCurrent()){var e=s.YuanzhengModel.getInstance(),i=e.curChallengeVo;i.guanqiaVo==t?PLC.request(Protocol.game_expedition_getChallengerInfo,null,function(t){t&&(e.updateData(t.challengerInfo),UIMgr.showUI(UIConst.Yuanzheng_ChallengeView,i))}):logwarn("数据不匹配,不是当前挑战关卡")}else showToast(LanMgr.getLan("",10014))},i.prototype.showRecoveryView=function(t){s.YuanzhengModel.getInstance().getGodsByRecoveryType(t).length<=0?showToast(LanMgr.getLan("",t==iface.tb_prop.expeditionOpTypeKey.recover?10127:10128)):UIMgr.showUI(UIConst.Yuanzheng_RecoveryView,t)},i.prototype.showShopView=function(t){dispatchEvt(new s.ShopEvent(s.ShopEvent.SHOW_SHOP_VIEW),ShopType.yuanzheng)},i.prototype.showHelpView=function(){UIMgr.showUI(UIConst.Yuanzheng_HelpView)},i.prototype.gotoBuzhen=function(t){dispatchEvt(new s.GodEvent(s.GodEvent.SHOW_BUZHEN_PANEL),iface.tb_prop.lineupTypeKey.expedition)},i.prototype.challengeGuanqia=function(){if(!UIUtil.checkUnableToEnterFight(iface.tb_prop.lineupTypeKey.expedition)){var t=new s.FightVo;t.copyType=CopyType.yuanzhenCopy,t.yuanzhengCopyVo=s.YuanzhengModel.getInstance().curChallengeVo;var e=new battle.BattleScenePvp(t.copyType);e.init([t.getOwnTeam()],t.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.god,t.getAllRound(),t.getTeamHp()),e.start();var i=e.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",i,"战报：",e.battleReport);var n=new s.NewClientPage;n.result=i?playState.VICTORY:playState.FAILURE,n.initPage(e.battleReport),n.defType=iface.tb_prop.battleObjTypeKey.god,t.fightPageControl=n,t.fightPageControl.lossHpObj=e.getLossHpObj(),t.fightPageControl.maxHpObj=e.getMaxHpObj();var o={vo:t,event:new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_MAIN_VIEW)};dispatchEvt(new s.FightsEvent(s.FightsEvent.ENTER_FIGHT_EVENT),o)}},i.prototype.rewardGuanqia=function(e){var t=e.dataSource;if(t)if(t.isCanReward()){var i={};i[Protocol.game_expedition_getBoxReward.args.id]=t.tbCopy.ID,PLC.request(Protocol.game_expedition_getBoxReward,i,function(t){t&&(App.hero.updateCopyInfo(t),UIUtil.showRewardView(t.commonData),e.refreshView())})}else UIMgr.showUI(UIConst.ManyItemsTip,{data:t.tbCopy.getBoxRewardList()})},i.prototype.recoveryGod=function(t){var e=this,i=s.YuanzhengModel.getInstance(),n=t.type,o=t.godVo;if(n==iface.tb_prop.expeditionOpTypeKey.recover&&App.hero.getBagItemNum(CostTypeKey.huifu_yaoshui)<=0){var a=LanMgr.getLan("",10307,i.getMedicineCost(CostTypeKey.huifu_yaoshui))+"<img style='padding:10px 3px 3px 3px;' src='"+SkinUtil.getCostSkin(iface.tb_prop.resTypeKey.diamond)+"' ></img>"+LanMgr.getLan("",10498);common.AlertBox.showAlert({text:a,confirmCb:function(){e.buyYaoshui(t)},parm:null,yes:LanMgr.getLan("",10499)})}else if(n==iface.tb_prop.expeditionOpTypeKey.revive&&App.hero.getBagItemNum(CostTypeKey.fuhuo_yaoshui)<=0)a=LanMgr.getLan("",10307,i.getMedicineCost(CostTypeKey.fuhuo_yaoshui))+"<img style='padding:10px 3px 3px 3px;' src='"+SkinUtil.getCostSkin(iface.tb_prop.resTypeKey.diamond)+"' ></img>"+LanMgr.getLan("",10498),common.AlertBox.showAlert({text:a,confirmCb:function(){e.buyYaoshui(t)},parm:null,yes:LanMgr.getLan("",10499)});else{var r={};r[Protocol.game_expedition_expeditionGodOperate.args.godId]=o.uuid,r[Protocol.game_expedition_expeditionGodOperate.args.opType]=n,PLC.request(Protocol.game_expedition_expeditionGodOperate,r,function(t){if(t){showToast(LanMgr.getLan("",n==iface.tb_prop.expeditionOpTypeKey.recover?10115:10116)),App.hero.updateCopyInfo(t);var e=UIMgr.getUIByName(UIConst.Yuanzheng_RecoveryView);e&&e.delItem()}})}},i.prototype.buyYaoshui=function(e){var i=this,t=e.type,n=(e.godVo,s.YuanzhengModel.getInstance().getMedicineCost(t));if(!UIUtil.checkNotEnough(iface.tb_prop.resTypeKey.diamond,n)){var o=t==iface.tb_prop.expeditionOpTypeKey.recover?CostTypeKey.huifu_yaoshui:CostTypeKey.fuhuo_yaoshui,a={};a[Protocol.game_shop_specialItemBuy.args.id]=o,PLC.request(Protocol.game_shop_specialItemBuy,a,function(t){t&&i.recoveryGod(e)})}},Object.defineProperty(i.prototype,"yuanzhengView",{get:function(){return UIMgr.getUIByName(UIConst.YuanzhengView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}s.YuanzhengProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"YuanzhengModule"},n.prototype.listProcessors=function(){return[new t.YuanzhengProcessor]},n.prototype.onRegister=function(){t.YuanzhengModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.YuanzhengModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_MAIN_VIEW="SHOW_MAIN_VIEW",r.SHOW_RECOVERY_VIEW="SHOW_RECOVERY_VIEW",r.SHOW_CHALLENGE_VIEW="SHOW_CHALLENGE_VIEW",r.SHOW_SHOP_VIEW="SHOW_YAUNZHENG_SHOP_VIEW",r.GOTO_SET_LINUEP="GOTO_SET_LINUEP",r.SHOW_HELP_VIEW="SHOW_HELP_VIEW",r.GUANQIA_CHALLENGE="GUANQIA_CHALLENGE",r.GUANQIA_REWARD="GUANQIA_REWARD",r.RECOVERY_GOD="YAUNZHENG_RECOVERY_GOD",r.UPDATE_VIEW="UPDATE_VIEW",r.YZ_DISPATCH_SUCC="YZ_DISPATCH_SUCC",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.YuanzhengEvent=a}(game=game||{}),function(u){var t=(o.getInstance=function(){return this._instance||(this._instance=new o),this._instance},o.prototype.resetDataByCrossDay=function(){UIMgr.hideUIByName(UIConst.Yuanzheng_HelpView),this._isRequestDis=!1,this._myDispatchList.length=0,this._helpMeList.length,App.hero.copyInfo.helpGodId=[],App.hero.copyInfo.friendHelpList=[]},o.prototype.initModel=function(){this.curChallengeVo=new u.YZChallengeVo,this._guanqiaList=[];var t=TableData.getInstance().getTableByName(TableData.tb_expedition).data,e=1;for(var i in t)this._guanqiaList.push(new u.YZGuanqiaVo(t[i],e++));this._baoxiangList=[],this._baoxiangList=this._guanqiaList.filter(function(t){return t.isHasBaoxiang()}),this.updateCurGuanqia()},o.prototype.updateCurGuanqia=function(){var e=App.hero.copyInfo.expeditionId,t=this._guanqiaList.findIndex(function(t){return t.tbCopy.ID==e})+1;this.curGuanqia=this._guanqiaList[t],this.curChallengeVo.setGuanqiaVo(this.curGuanqia)},o.prototype.updateData=function(t){this.curChallengeVo.setServerInfo(t)},o.prototype.getGodHp=function(t){if(Number(t)<0){var e=this.getHelpItemByUuid(t);return e&&e.godInfo[3][1]}var i=App.hero.getGodVoById(t).getPropertyValue(1),n=App.hero.copyInfo.expeditionSelfHpInfo;return n.hasOwnProperty(t)?Math.ceil(i*n[t]/o.BLOOD_BASE):Math.ceil(i)},o.prototype.getGuanqiaList=function(){return this._guanqiaList},o.prototype.getBaoxiangList=function(){return this._baoxiangList},o.prototype.getGuanqiaById=function(e){return this._guanqiaList.find(function(t){return t.tbCopy.ID==e})},o.prototype.getGodsByRecoveryType=function(i){var n=this;return App.hero.getGodAry().filter(function(t){if(t.level<o.SHANGZHEN_LEVEL)return!1;var e=n.getGodHp(t.uuid);return i==iface.tb_prop.expeditionOpTypeKey.revive?e<=0:i!=iface.tb_prop.expeditionOpTypeKey.recover||0<e&&e<t.getPropertyValue(1)})},o.prototype.getMedicineCost=function(e){var t=tb.TB_copy_set.getCopySet().special_type_cost.find(function(t){return t[0]==e});return t?t[1]:0},o.prototype.isAllFinish=function(){return this._guanqiaList.every(function(t){return t.isPass()})},o.prototype.setAidTag=function(t){this._aidTag=t},o.prototype.getAidTag=function(){return this._aidTag},o.prototype.clearAidTag=function(){this._aidTag=null},o.prototype.hasAidTag=function(){return Boolean(this._aidTag)},o.prototype.getHelpMeList=function(){return this._helpMeList},o.prototype.getHireCount=function(){return this._helpMeList.filter(function(t){return t.isHire()}).length},o.prototype.requestHelpMeList=function(){var s=this;return new Promise(function(r,t){PLC.request(Protocol.friend_friendHelp_getFriendHelpList,null,function(t,e){if(t){for(var i=t.friendHelpList||[],n=s._helpMeList.length=0,o=i;n<o.length;n++){var a=o[n];s._helpMeList.push(new u.YZHelpInfoVo(a))}s._helpMeList.sort(function(t,e){return e.force-t.force}),r()}else r()})})},o.prototype.addHireInfo=function(t){t&&App.hero.copyInfo.friendHelpList.push(t)},o.prototype.getMyHireList=function(){for(var t=[],e=App.hero.copyInfo.friendHelpList||[],i=0;i<e.length;i++){var n=-1-i+"";if(!(App.hero.copyInfo.expeditionSelfHpInfo.hasOwnProperty(n)&&App.hero.copyInfo.expeditionSelfHpInfo[n]<=0)){var o=e[i],a=o.godInfo,r=tb.TB_god.get_TB_godById(a[0]),s=new GodItemVo(r);s.starLevel=a[1],s.level=a[2],s.degree=a[4],a[3]&&(s.iSeverAttri=map2ary(a[3])),s.uuid=n,s.fightPower=o.force,s.isAid=!0,t.push(s)}}return t},o.prototype.getHelpItemByUuid=function(t){var e=Math.abs(Number(t))-1;return App.hero.copyInfo.friendHelpList[e]||null},o.prototype.getMyDispatchList=function(){return this._myDispatchList},o.prototype.addDispatchInfo=function(t,e){App.hero.copyInfo.helpGodId.push(t);var i=new u.YZHelpInfoVo(e);return i.godVo.uuid=t+"",this._myDispatchList.push(i),dispatchEvt(new u.YuanzhengEvent(u.YuanzhengEvent.YZ_DISPATCH_SUCC)),i},o.prototype.requestDispatchList=function(){var r=this;return new Promise(function(a,t){r._isRequestDis?a():PLC.request(Protocol.friend_friendHelp_getMyFriendHelpList,null,function(t,e){if(t){r._isRequestDis=!0;for(var i=t.friendHelpList||[],n=r._myDispatchList.length=0;n<i.length;n++){var o=new u.YZHelpInfoVo(i[n]);o.godVo.uuid=App.hero.copyInfo.helpGodId[n],r._myDispatchList.push(o)}a()}})})},o.prototype.isDispatch=function(t){return-1!=(App.hero.copyInfo.helpGodId||[]).indexOf(t)},o.prototype.getDispatchNum=function(){return(App.hero.copyInfo.helpGodId||[]).length},o.SHANGZHEN_LEVEL=30,o.BLOOD_BASE=1e4,o);function o(){this._helpMeList=[],this._myDispatchList=[],this._isRequestDis=!1}u.YuanzhengModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.yuanzheng.JiangliViewUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this)},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.bgPanel.dataSource=null},n.prototype.initView=function(){var t=this.dataSource;this.rewardList.array=t.tbCopy.getBoxRewardList(),this.rewardList.width=(90+this.rewardList.spaceX)*this.rewardList.length,this.bgPanel.dataSource={uiName:UIConst.Yuanzheng_RewardView,closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12468)}},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}t.YZJiangliView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.yuanzheng.HuifuViewUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.godList.mouseHandler=new Handler(this,this.onSelect)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.godList.array=null,this.bgPanel.dataSource=null,this.btnUse.off(Laya.Event.CLICK,this,this.onUse),tl3d.ModuleEventManager.removeEvent(o.ResEvent.PROP_CHANGE,this.updateCount,this)},e.prototype.initView=function(){var t=this.dataSource==iface.tb_prop.expeditionOpTypeKey.recover?LanMgr.getLan("",12469):LanMgr.getLan("",12470);this.bgPanel.dataSource={uiName:UIConst.Yuanzheng_RecoveryView,closeOnSide:this.isModelClose,title:t},this.btnUse.on(Laya.Event.CLICK,this,this.onUse),this._curIdx=-1;var i=this.dataSource,n=o.YuanzhengModel.getInstance(),e=n.getGodsByRecoveryType(i);this.godList.array=e.map(function(t){var e=new o.BuzhenListItemVo(t,iface.tb_prop.lineupTypeKey.expedition);return i==iface.tb_prop.expeditionOpTypeKey.recover&&(e.showBlood=!0,e.hp=n.getGodHp(t.uuid),e.totalHp=Math.ceil(t.getPropertyValue(1))),e}),this.updateCount(),tl3d.ModuleEventManager.addEvent(o.ResEvent.PROP_CHANGE,this.updateCount,this)},e.prototype.delItem=function(){this.godList.getCell(this._curIdx).chk_select.visible=!1,this.godList.deleteItem(this._curIdx),this.godList.refresh(),this._curIdx=-1},e.prototype.updateCount=function(){this.dataSource==iface.tb_prop.expeditionOpTypeKey.recover?(this.lbDesc.text=LanMgr.getLan("",10118),this.lbCount.text=App.hero.getBagItemNum(CostTypeKey.huifu_yaoshui).toString(),this.costIcon.skin=SkinUtil.getCostSkin(CostTypeKey.huifu_yaoshui)):(this.lbDesc.text=LanMgr.getLan("",10119),this.lbCount.text=App.hero.getBagItemNum(CostTypeKey.fuhuo_yaoshui).toString(),this.costIcon.skin=SkinUtil.getCostSkin(CostTypeKey.fuhuo_yaoshui))},e.prototype.onSelect=function(t,e){if(t.type==Laya.Event.CLICK){if(-1==this._curIdx)return this._curIdx=e,void(this.godList.getCell(e).chk_select.visible=!0);this._curIdx==e?(this._curIdx=-1,this.godList.getCell(e).chk_select.visible=!1):(this.godList.getCell(this._curIdx).chk_select.visible=!1,this.godList.getCell(e).chk_select.visible=!0,this._curIdx=e)}},e.prototype.onUse=function(){var t=this.dataSource;if(-1!=this._curIdx){var e=this.godList.getCell(this._curIdx).dataSource,i=e?e.godVo:null;i?dispatchEvt(new o.YuanzhengEvent(o.YuanzhengEvent.RECOVERY_GOD,{type:t,godVo:i})):showToast(LanMgr.getLan("",t==iface.tb_prop.expeditionOpTypeKey.recover?10110:10111))}else showToast(LanMgr.getLan("",t==iface.tb_prop.expeditionOpTypeKey.recover?10110:10111))},e);function e(){var t=i.call(this)||this;return t._curIdx=-1,t.isModelClose=!0,t}o.YZHuifuView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(a){var i,t=(i=ui.yuanzheng.HelpViewUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.Yuanzheng_RewardView,closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12471)},this.tabbar.selectedIndex=-1,this.tabbar.selectHandler=new Handler(this,this.onSelect),this.listHelpFriend.array=null,this.listHelpMe.array=null,this._model=a.YuanzhengModel.getInstance()},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.tabbar.selectedIndex=-1,this.listHelpFriend.array=null,this.listHelpMe.array=null,this.godList=null},e.prototype.initView=function(){this.tabbar.selectedIndex=0},e.prototype.onSelect=function(t){var e=this;if(!(t<0)){var i=0==t;this.lbCount.visible=this.lbHelpMeDesc.visible=this.listHelpMe.visible=i,this.lbHelpFriendDesc.visible=this.listHelpFriend.visible=!i,(this.boxEmpty.visible=i)?this._model.requestHelpMeList().then(function(){e.renderHelpMe()}):this._model.requestDispatchList().then(function(){e.renderHelpFriend()})}},e.prototype.renderHelpMe=function(){var t=this._model,e=t.getHelpMeList();this.listHelpMe.array=e,this.boxEmpty.visible=0==e.length,this.lbHelpMeDesc.text=LanMgr.getLan("",12473,tb.TB_copy_set.getCopySet().hire_fight_percent),this.lbCount.text=LanMgr.getLan("",12472,t.getHireCount(),tb.TB_copy_set.getCopySet().hire_num)},e.prototype.renderHelpFriend=function(){var i=this;if(!this.godList){this.godList=[];var t=__spreadArrays(App.hero.getGodArr());t.sort(function(t,e){return e.getShenli()-t.getShenli()}),this.godList=t.filter(function(t,e){return e<20&&t.level>=a.YuanzhengModel.SHANGZHEN_LEVEL&&!i._model.isDispatch(t.uuid)});for(var e=0,n=this._model.getMyDispatchList();e<n.length;e++){var o=n[e];this.godList.unshift(o.godVo)}}this.listHelpFriend.array=this.godList,this.boxEmpty.visible=!1},e);function e(){return i.call(this)||this}a.YZHelpView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var t,e=(t=ui.yuanzheng.HelpMeIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),i.prototype.refreshView=function(){var t=this.dataSource;if(t){this.headBox.dataSource=t.godVo;var e=t.godVo.tab_god;this.lbName.text=e.name+"   "+LanMgr.godTypeName[e.type],this.lbForce.text=LanMgr.getLan("",10117,t.force),this.lbFried.text=LanMgr.getLan("",12474)+t.svo.name,this.lbYiguyong.visible=t.isHire();var i=t.isOverForce();this.lbLimit.visible=!t.isHire()&&i,this.btnGuyong.visible=!t.isHire()&&!i,this.btnGuyong.on(Laya.Event.CLICK,this,this.onClick)}else this.btnGuyong.off(Laya.Event.CLICK,this,this.onClick)},i.prototype.onClick=function(){var i=this,n=this.dataSource;if(n){var o=a.YuanzhengModel.getInstance(),t=tb.TB_copy_set.getCopySet().hire_num;if(o.getHireCount()>=t)showToast(LanMgr.getLan("",10279,t));else{var e={};e[Protocol.friend_friendHelp_hireFriendHelp.args.helpId]=n.svo.helpId,PLC.request(Protocol.friend_friendHelp_hireFriendHelp,e,function(t,e){t&&(showToast(LanMgr.getLan("",10280)),n.svo.isHire=!0,o.addHireInfo(t.addFriendHelpList),i.refreshView(),UIMgr.hasStage(UIConst.Yuanzheng_HelpView)&&UIMgr.getUIByName(UIConst.Yuanzheng_HelpView).renderHelpMe())})}}},i);function i(){return t.call(this)||this}a.YZHelpMeIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.yuanzheng.HelpFriendIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),i.prototype.refreshView=function(){var t=this.dataSource;if(t){this.headBox.dataSource=t,this.lbName.text=t.tab_god.name+"   "+LanMgr.godTypeName[t.tab_god.type],this.lbForce.text=LanMgr.getLan("",10117,0<t.svrForce?t.svrForce:t.getShenli());var e=!t.uuid||o.YuanzhengModel.getInstance().isDispatch(t.uuid);this.btnSelect.visible=!e,this.lbYipaiqian.visible=e,this.btnSelect.on(Laya.Event.CLICK,this,this.onClick)}else this.btnSelect.off(Laya.Event.CLICK,this,this.onClick)},i.prototype.onClick=function(){var n=this,t=this.dataSource;if(t)if(0<o.YuanzhengModel.getInstance().getDispatchNum())showToast(LanMgr.getLan("",10277));else{var e={};e[Protocol.friend_friendHelp_createFriendHelp.args.godId]=t.uuid,PLC.request(Protocol.friend_friendHelp_createFriendHelp,e,function(t,e){if(t){showToast(LanMgr.getLan("",10278));var i=o.YuanzhengModel.getInstance().addDispatchInfo(t.addHelpGodId,t.addFriendHelp);n.dataSource=i.godVo,n.refreshView(),UIMgr.hasStage(UIConst.Yuanzheng_HelpView)&&(UIMgr.getUIByName(UIConst.Yuanzheng_HelpView).godList=null)}})}},i);function i(){return t.call(this)||this}o.YZHelpFriendIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.yuanzheng.GuanqiaIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;t?(this.btnOpen.skin=t.isPass()||t.isCurrent()?SkinUtil.zuobiao_liang:SkinUtil.zuobiao_an,this.box.visible=t.isPass(),this.lbName.text=t.index.toString(),this.on(Laya.Event.CLICK,this,this.onClick)):this.off(Laya.Event.CLICK,this,this.onClick)},n.prototype.onClick=function(){dispatchEvt(new t.YuanzhengEvent(t.YuanzhengEvent.SHOW_CHALLENGE_VIEW,this.dataSource))},n);function n(){return e.call(this)||this}t.YZGuanqiaIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var i,t=(i=ui.yuanzheng.ChallengeInfoViewUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this._godItems=[];for(var t=0;t<6;t++){var e=this["godBox"+t];e.on(Laya.Event.CLICK,this,this.onShowGodInfo),this._godItems.push(e)}this.bgPanel.dataSource={uiName:UIConst.Yuanzheng_ChallengeView,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12127)},this.btnChallenge.on(Laya.Event.CLICK,this,this.onChallenge)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.rewardList.array=null,this.headBox.dataSource=null},e.prototype.initView=function(){var i=this.dataSource,t=i.guanqiaVo.tbCopy.getRewardList();this.rewardList.array=t,this.rewardList.width=100*t.length+(t.length-1)*this.rewardList.spaceX,this.lbName.text=i.svo.name,this.lbShenli.text=Math.ceil(i.svo.force).toString(),this.headBox.dataSource=i.headVo;var e=i.getLineupGods().map(function(t){if(t){var e=new r.BuzhenListItemVo(t,iface.tb_prop.lineupTypeKey.expedition);return e.showBlood=!0,e.hp=i.getEnemyGodHp(t.templateId),e.totalHp=i.getGodTotalHp(t.templateId),e}return null});this.setLinueBox(e);var n=i.getShenqiAry(),o=n&&0<n.length?n[0]:0;if(this.imgShenqi.visible=0<o,0<o){var a=tb.TB_artifact.get_TB_artifactById(o);this.imgShenqi.skin=SkinUtil.getArtifCircleIcon(a.icon)}},e.prototype.setLinueBox=function(t){var e=[];t=t||[];for(var i=0;i<6;i++){var n=this._godItems[i],o=t[i];o&&o.godVo?(n.dataSource=o,n.visible=!!o,e.push(o.godVo.tab_god.race_type)):(n.visible=!1,e.push(-1))}this.guanghuanUI.initView(0,e)},e.prototype.onShowGodInfo=function(t){var e=t.target;if(e.dataSource){var i=e.dataSource,n=i?i.godVo:null;i&&n&&UIUtil.showGodTip(n.templateId,{degree:n.degree,starLevel:n.starLevel,level:n.level})}},e.prototype.onChallenge=function(){dispatchEvt(new r.YuanzhengEvent(r.YuanzhengEvent.GOTO_SET_LINUEP,this.dataSource))},e);function e(){return i.call(this)||this}r.YZChallengeView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.yuanzheng.BaoxiangIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this,e=this.dataSource;e?(this.icon.skin=SkinUtil.getTaskBaoxiang(4,e.isReward()),this.ani_jiangli.visible=e.isCanReward(),e.isCanReward()?(this.ani_jiangli.loadAnimation(ResConst.anim_baoxiang,Handler.create(null,function(){t.ani_jiangli.play(0,!0)}),ResConst.atlas_baoxiang),this.ani1.play(0,!0)):(this.ani_jiangli.stop(),this.ani1.stop()),this.on(Laya.Event.CLICK,this,this.onClick)):(this.ani_jiangli.stop(),this.ani1.stop(),this.off(Laya.Event.CLICK,this,this.onClick))},n.prototype.onClick=function(){dispatchEvt(new t.YuanzhengEvent(t.YuanzhengEvent.GUANQIA_REWARD,this))},n);function n(){return e.call(this)||this}t.YZBaoxiangIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var i,t=(i=ui.yuanzheng.YuanzhengViewUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._guanqiaList=[];for(var t=1;t<=15;t++)this._guanqiaList.push(this["item"+t]);for(this._baoxiangList=[],t=1;t<=5;t++)this._baoxiangList.push(this["box"+t]);this.itemPanel.hScrollBarSkin="",this.imgBg1.skin=SkinUtil.getSysMapSkin(ModuleConst.EXPEDITION,1),this.imgBg2.skin=SkinUtil.getSysMapSkin(ModuleConst.EXPEDITION,2),this.imgBg3.skin=SkinUtil.getSysMapSkin(ModuleConst.EXPEDITION,3),this.imgBg4.skin=SkinUtil.getSysMapSkin(ModuleConst.EXPEDITION,4)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.showTopView(),this.initView(!0)},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.showTopView(),this.initView(!0)},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),Laya.Tween.clearTween(this.imgArrow);for(var t=0,e=this._guanqiaList.length;t<e;t++)this._guanqiaList[t].dataSource=null;for(t=0,e=this._baoxiangList.length;t<e;t++)this._baoxiangList[t].dataSource=null;tl3d.ModuleEventManager.removeEvent(s.ResEvent.PROP_CHANGE,this.updateCount,this),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.showTopView=function(){var t=[{btnSkin:SkinUtil.btn_shop,callback:this.onShop.bind(this)},{btnId:s.BtnFuncId.reviveHero,btnSkin:SkinUtil.btn_fuhuo,text:App.hero.getBagItemNum(CostTypeKey.fuhuo_yaoshui),callback:this.onFuhuo.bind(this)},{btnId:s.BtnFuncId.recoverHero,btnSkin:SkinUtil.btn_huifu,text:App.hero.getBagItemNum(CostTypeKey.huifu_yaoshui),callback:this.onHuifu.bind(this)},{btnSkin:SkinUtil.btn_zhuzhan,redpointName:"yuanzheng_dispatch",callback:this.onYuanzhu.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.darkEssence];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onFanHui.bind(this)})},e.prototype.initView=function(t){void 0===t&&(t=!1);for(var e=s.YuanzhengModel.getInstance(),i=e.getGuanqiaList(),n=0,o=this._guanqiaList.length;n<o;n++)this._guanqiaList[n].dataSource=i[n];var a=e.getBaoxiangList();for(n=0,o=this._baoxiangList.length;n<o;n++)this._baoxiangList[n].dataSource=a[n];tl3d.ModuleEventManager.addEvent(s.ResEvent.PROP_CHANGE,this.updateCount,this);var r=this._guanqiaList.find(function(t){return t.dataSource.isCurrent()});this.setIndexImage(r),this.updateCount(),t&&Laya.timer.callLater(this,this.scrollToItemRender,[r||this._guanqiaList[this._guanqiaList.length-1]])},e.prototype.updateCount=function(){var t=[{btnId:s.BtnFuncId.reviveHero,text:App.hero.getBagItemNum(CostTypeKey.fuhuo_yaoshui)},{btnId:s.BtnFuncId.recoverHero,text:App.hero.getBagItemNum(CostTypeKey.huifu_yaoshui)}];dispatchEvt(new s.HudEvent(s.HudEvent.UPDATE_SYS_TOP_BTN_INFO),t)},e.prototype.setIndexImage=function(t){t?(Laya.Tween.clearTween(this.imgArrow),this.imgArrow.x=t.x+13,this.imgArrow.y=t.y-15,this.imgArrow.visible=!0,UIUtil.loop(this.imgArrow,this.imgArrow.x,this.imgArrow.y,1e3,30,TweenDirection.down)):(this.imgArrow.visible=!1,Laya.Tween.clearTween(this.imgArrow))},e.prototype.scrollToItemRender=function(t){if(t){var e=t.x-360;this.itemPanel.scrollTo(e,0)}},e.prototype.onFuhuo=function(){dispatchEvt(new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_RECOVERY_VIEW,iface.tb_prop.expeditionOpTypeKey.revive))},e.prototype.onHuifu=function(){dispatchEvt(new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_RECOVERY_VIEW,iface.tb_prop.expeditionOpTypeKey.recover))},e.prototype.onShop=function(){dispatchEvt(new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_SHOP_VIEW),4)},e.prototype.onFanHui=function(){dispatchEvt(new s.HudEvent(s.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_LILIAN))},e.prototype.onYuanzhu=function(){dispatchEvt(new s.YuanzhengEvent(s.YuanzhengEvent.SHOW_HELP_VIEW))},e);function e(){var t=i.call(this)||this;return t.group=UIConst.hud_group,t.isModelClose=!0,t}s.YuanzhengView=t}(game=game||{}),function(o){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.requestMyTeamInfo=function(i){var n=this;return void 0===i&&(i=!0),new Promise(function(e,t){App.IsSysOpen(ModuleConst.TEAM_COPY)?PLC.request(Protocol.friend_groupCopy_getGroupInfo,null,function(t){t&&(n._model.updateTeamInfo(t.myGroup,t.memberList),t.battleReport&&dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.PLAY_REPORT),t),e())},i):showToast(LanMgr.getLan("",10272))})},e.prototype.createTeam=function(){var i=this;return new Promise(function(e,t){PLC.request(Protocol.friend_groupCopy_groupCreate,null,function(t){t&&(i._model.updateTeamInfo(t.myGroup,t.memberList),e())})})},e.prototype.leaveTeam=function(){var i=this;return new Promise(function(e,t){PLC.request(Protocol.friend_groupCopy_groupExit,null,function(t){t&&(i._model.updateTeamInfo(t.myGroup,t.memberList),e())})})},e.prototype.appointCaptain=function(n){return new Promise(function(e,t){var i={};i[Protocol.friend_groupCopy_groupAppoint.args.playerId]=n,PLC.request(Protocol.friend_groupCopy_groupAppoint,i,function(t){t&&e()})})},e.prototype.kickoutMember=function(n){var o=this;return new Promise(function(e,t){var i={};i[Protocol.friend_groupCopy_groupKick.args.playerId]=n,PLC.request(Protocol.friend_groupCopy_groupKick,i,function(t){t&&(o._model.delMember(t.delMemberId),e())})})},e.prototype.swapMember=function(n){var o=this;return new Promise(function(e,t){var i={};i[Protocol.friend_groupCopy_setPos.args.src_pos]=n,i[Protocol.friend_groupCopy_setPos.args.dst_pos]=n-1,PLC.request(Protocol.friend_groupCopy_setPos,i,function(t){t&&o._model.swapMember(t.setPos),e()})})},e.prototype.applyJoinTeam=function(n){return new Promise(function(e,t){var i={};i[Protocol.friend_groupCopy_groupJoin.args.groupId]=n,PLC.request(Protocol.friend_groupCopy_groupJoin,i,function(t){t?showToast(LanMgr.getLan("",10273)):e(!1)})})},e.prototype.getApplyList=function(i){var n=this;return void 0===i&&(i=!1),new Promise(function(e,t){n._model.hasTeam()&&(i&&0<n._applyRefreshTime&&App.serverTime-n._applyRefreshTime<1e3?showToast(LanMgr.getLan("",11015)):PLC.request(Protocol.friend_groupCopy_getApplyList,null,function(t){t&&(i&&(n._applyRefreshTime=App.serverTime),n._model.setApplyList(t.applyList),e())}))})},e.prototype.requestTeamList=function(i){var n=this;return void 0===i&&(i=!1),new Promise(function(e,t){i&&0<n._teamRefreshTime&&App.serverTime-n._teamRefreshTime<1e3?showToast(LanMgr.getLan("",11015)):PLC.request(Protocol.friend_groupCopy_groupList,null,function(t){t&&(i&&(n._teamRefreshTime=App.serverTime),n._model.setTeamList(t.groupList),e())})})},e.prototype.requestInviteList=function(i){var n=this;return void 0===i&&(i=!1),new Promise(function(e,t){i&&0<n._inviteRefreshTime&&App.serverTime-n._inviteRefreshTime<1e3?showToast(LanMgr.getLan("",11015)):PLC.request(Protocol.friend_groupCopy_inviteList,null,function(t){t&&(i&&(n._inviteRefreshTime=App.serverTime),n._model.setInviteList(t.inviteList),e())})})},e.prototype.inviteFriend=function(n){var o=this;return new Promise(function(e,t){if(o._model.memberList&&0!=o._model.memberList.length)if(3<=o._model.memberList.length)showToast(LanMgr.getLan("",10275));else{var i={};i[Protocol.friend_groupCopy_inviteFriend.args.playerId]=n,PLC.request(Protocol.friend_groupCopy_inviteFriend,i,function(t){t&&e()})}else showToast(LanMgr.getLan("",10274))})},e.prototype.showInviteJoinView=function(){PLC.request(Protocol.friend_groupCopy_getInviteList,null,function(t){if(t&&!UIMgr.hasStage(UIConst.FightViews)){var e=t.inviteInfo?t.inviteInfo:[];if(0!=e.length){var i=e.pop();if(UIMgr.hasStage(UIConst.CopyTeamInviteJoinView)){var n=UIMgr.getUIByName(UIConst.CopyTeamInviteJoinView);n.dataSource=i,n.initView()}else UIMgr.showUI(UIConst.CopyTeamInviteJoinView,i)}}})},e.prototype.joinInvite=function(n){var o=this;return new Promise(function(e,t){var i={};i[Protocol.friend_groupCopy_acceptInvite.args.playerId]=n,PLC.request(Protocol.friend_groupCopy_acceptInvite,i,function(t){t&&o.requestMyTeamInfo().then(function(){e()})})})},e.prototype.refuseInvite=function(n){return new Promise(function(e,t){var i={};i[Protocol.friend_groupCopy_refuseInvite.args.playerId]=n,PLC.request(Protocol.friend_groupCopy_refuseInvite,i,function(t){t&&e()})})},e.prototype.todayRefuseJoin=function(n,o){return new Promise(function(i,t){var e={};e[Protocol.friend_groupCopy_setInvite.args.playerId]=n,e[Protocol.friend_groupCopy_setInvite.args.state]=o,PLC.request(Protocol.friend_groupCopy_setInvite,e,function(t){if(t){var e=t.setInvite[n];i(e)}})})},e.prototype.noticeRefuse=function(){PLC.request(Protocol.friend_groupCopy_getRefuseInviteList,null,function(t){if(t)for(var e=0,i=t.refuseInviteList?t.refuseInviteList:[];e<i.length;e++){var n=i[e];showToast(LanMgr.getLan("",10276,n))}})},e.prototype.applyOpt=function(n,o){var a=this;return new Promise(function(e,t){var i={};n&&(i[Protocol.friend_groupCopy_applyListOpt.args.playerId]=n),i[Protocol.friend_groupCopy_applyListOpt.args.opt_type]=o,PLC.request(Protocol.friend_groupCopy_applyListOpt,i,function(t){t&&(a._model.clearApplyList(t.delApplyList),t.memberList&&a._model.updateMemberList(t.memberList),e())})})},e);function e(){this._applyRefreshTime=0,this._teamRefreshTime=0,this._inviteRefreshTime=0,this._model=o.CopyTeamModel.getInstance()}o.CopyTeamThread=t}(game=game||{}),function(t){var e=(i.prototype.setSvo=function(t){this.svo=t;var e=null;for(var i in this.svo.memberInfo)e=this.svo.memberInfo[i],this.memberList[e.pos-1]=e},i);function i(){this.memberList=[];for(var t=1;t<=3;t++)this.memberList.push({pos:t})}t.CopyTeamListVo=e}(game=game||{}),function(t){var e=(i.prototype.getCurAtkForce=function(t){var e=this.getPosMember(t);return e&&e.force||0},i.prototype.getMonster=function(){var t=tb.TB_team_copy.getTB_team_copyById(this.copyFloor);return t?[t.monster]:[[]]},i.prototype.setHeadData=function(t,e){var i=tb.TB_team_copy.getTB_team_copyById(this.copyFloor);if(i){var n=tb.TB_monster.get_TB_monsterById(i.monster_show);t.enemyLevel=n.level,t.enemyName=n.name}var o=this.getPosMember(e);o&&(t.ownLevel=o.level,t.ownName=o.name)},i.prototype.getShowMonsterVo=function(){var t=tb.TB_team_copy.getTB_team_copyById(this.copyFloor);if(!t)return null;var e=tb.TB_monster.get_TB_monsterById(t.monster_show),i=new n;return i.head=e.icon,i.modelId=e.model,i.headFrame=0,i.level=e.level,i.name=e.name,i},i.prototype.getPosMember=function(t){return this.memberlist?(this.memberlist.sort(function(t,e){return t.pos-e.pos}),this.memberlist[t]):null},i);function i(t,e){this.copyFloor=t,this.memberlist=e}t.CopyTeamFightVo=e;var n=function(){};t.copyTeamFightMember=n}(game=game||{}),function(t){var e=(i.prototype.isFinish=function(){return t.CopyTeamModel.getInstance().myFloor>=this.tbData.need_copy},i.prototype.isReward=function(){return-1!=t.CopyTeamModel.getInstance().groupCopyChapterAward.indexOf(this.tbData.ID)},i.prototype.isCanReward=function(){return this.isFinish()&&!this.isReward()},i);function i(t){this.tbData=t,this.sortNum=0}t.CopyRewardVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.teamcopy.render.TeamTransferRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.ui_head.dataSource=t.head?new UserHeadVo(t.head,t.level,t.headFrame):null,this.lab_name.text=t.name,this.lab_force.text=String(t.force);var e=tb.TB_team_copy.getTB_team_copyById(t.copyFloor);e&&(this.lab_info.text=LanMgr.getLan("",12478)+(Math.floor(e.copy/10)+"-")+e.copy%10,this.lab_info.color=t.copyFloor>i.CopyTeamModel.getInstance().captainFloor?"#ff0000":"#319c28")}},n.prototype.onClick=function(){var t=this.dataSource;t&&(t.copyFloor>i.CopyTeamModel.getInstance().captainFloor?showToast(LanMgr.getLan("",10270)):common.AlertBox.showAlert({text:LanMgr.getLan("",10271,t.name),confirmCb:function(){i.CopyTeamThread.getInstance().appointCaptain(t.playerId).then(function(){dispatchEvt(new i.CopyTeamEvent(i.CopyTeamEvent.HIDE_TRANSFER_PANEL))})},parm:null}))},n);function n(){var t=e.call(this)||this;return t.imgBg.on(Laya.Event.CLICK,t,t.onClick),t}i.TeamTransferRender=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.teamcopy.render.TeamInvitationRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.ui_render.dataSource=t;var e=App.serverTime/1e3,i=e-t.logoutTime;i=Math.min(i,7*TimeConst.ONE_DAY_SEC),this.lab_online.text=0==t.logoutTime?LanMgr.getLan("",12248):GameUtil.getOfflineTimeStr(e-i,e),this.lab_online.color=0==t.logoutTime?"#18ad00":"#535353"}},n);function n(){return e.call(this)||this}t.TeamInviteRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.teamcopy.render.TeamInfoRenderUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;this.img_leader.visible=t.job&&t.job==iface.tb_prop.groupJobTypeKey.captain,this.img_pos.skin=SkinUtil.getTeamPos(t.pos),this.img_force.visible=this.lab_force.visible=this.list_god.visible=null!=t.playerId,this.btn_transfer.visible=1<t.pos&&null!=t.playerId&&this._model.IsLeader(),this.btn_kickout.visible=this._model.IsLeader()&&null!=t.playerId&&this._model.leaderId!==t.playerId,this.btn_invitation.visible=null==t.playerId&&this._model.IsLeader(),this.lab_info.y=null!=t.playerId?22:63,t.playerId?(this.lab_info.text=t.name,this.lab_force.text=String(t.force),this.list_god.array=this.getLineupInfo(t.lineupInfo[0])):(this.lab_info.text=LanMgr.getLan("",12487),this.list_god.array=null,this.lab_force.text="")},n.prototype.getLineupInfo=function(t){for(var e,i=null,n=[],o=0;o<6;o++)if(i=t[o]){e=tb.TB_god.get_TB_godById(i[0]);var a=new GodItemVo(e);a.starLevel=i[1],a.level=i[2],a.degree=i[4],a.dataType=1,i[3]&&(a.iSeverAttri=map2ary(i[3])),n.push(a)}else n.push(null);return n},n.prototype.onInvitation=function(){this.dataSource&&dispatchEvt(new e.CopyTeamEvent(e.CopyTeamEvent.SHOW_INVITE_VIEW))},n.prototype.onKickOut=function(){this.dataSource&&dispatchEvt(new e.CopyTeamEvent(e.CopyTeamEvent.KICK_OUT_MEMBER),this.dataSource.playerId)},n.prototype.onTransfer=function(){this.dataSource&&dispatchEvt(new e.CopyTeamEvent(e.CopyTeamEvent.SET_POS_TEAM),this.dataSource.pos)},n);function n(){var t=i.call(this)||this;return t._model=e.CopyTeamModel.getInstance(),t.btn_invitation.on(Laya.Event.CLICK,t,t.onInvitation),t.btn_kickout.on(Laya.Event.CLICK,t,t.onKickOut),t.btn_transfer.on(Laya.Event.CLICK,t,t.onTransfer),t}e.TeamInfoItemRender=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.teamcopy.render.TeamBuildRenderUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.btnApply.label=LanMgr.getLan("",12489),this.btnApply.disabled=!1,this.lbName.text=t.svo.name,this.lbForce.text=String(t.svo.force);var e=tb.TB_team_copy.getTB_team_copyById(this._model.getNextId(t.svo.copyFloor));this.lbInfo.text=LanMgr.getLan("",10079,Math.floor(e.copy/10))+"-"+LanMgr.getLan("",10030,e.copy%10),this.lbInfo.color=this._model.myFloor>=t.svo.copyFloor?"#319c28":"#ff0000";for(var i=null,n=0;n<t.memberList.length;n++)(1==(i=t.memberList[n]).pos?this.ui_pic1:2==i.pos?this.ui_pic2:this.ui_pic3).dataSource=i.head?new UserHeadVo(i.head,i.level,i.headFrame):null}},n.prototype.onApply=function(){if(this.dataSource){if(this.dataSource.svo.copyFloor>this._model.myFloor)return void showToast(LanMgr.getLan("",10269));dispatchEvt(new e.CopyTeamEvent(e.CopyTeamEvent.APPLY_JOIN_TEAM),this.dataSource.svo.groupId),this.btnApply.label=LanMgr.getLan("",12488),this.btnApply.disabled=!0}},n);function n(){var t=i.call(this)||this;return t._model=e.CopyTeamModel.getInstance(),t.btnApply.on(Laya.Event.CLICK,t,t.onApply),t}e.TeamBuildRender=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.teamcopy.render.TeamApplyRenderUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.lab_info.text=t.name,this.lab_force.text=String(t.force),this.list_god.dataSource=this.getLineupInfo(t.lineupInfo[0])):this.list_god.dataSource=null},n.prototype.getLineupInfo=function(t){for(var e,i=null,n=[],o=0;o<6;o++)if(i=t[o]){e=tb.TB_god.get_TB_godById(i[0]);var a=new GodItemVo(e);a.starLevel=i[1],a.level=i[2],a.degree=i[4],a.dataType=1,i[3]&&(a.iSeverAttri=map2ary(i[3])),n.push(a)}else n.push(null);return n},n.prototype.onAgreed=function(){this.dataSource&&dispatchEvt(new e.CopyTeamEvent(e.CopyTeamEvent.AGREED_APPLY),{playerId:this.dataSource.playerId,state:iface.tb_prop.applyOptTypeKey.yes})},n);function n(){var t=i.call(this)||this;return t._model=e.CopyTeamModel.getInstance(),t.btn_gread.on(Laya.Event.CLICK,t,t.onAgreed),t}e.TeamApplyRender=t;var o,a=(__extends(r,o=t),Object.defineProperty(r.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),r.prototype.refreshData=function(){this.dataSource&&(o.prototype.refreshData.call(this),this.updateBtn())},r.prototype.updateBtn=function(){this.btn_gread.label=this.dataSource.isInvite?LanMgr.getLan("",12330):LanMgr.getLan("",12331),this.btn_gread.disabled=this.dataSource.isInvite},r.prototype.onAgreed=function(){var t=this;this.dataSource&&e.CopyTeamThread.getInstance().inviteFriend(this.dataSource.playerId).then(function(){t.dataSource.isInvite=!0,t.updateBtn()})},r);function r(){return o.call(this)||this}e.TeamInviteChiRender=a}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.teamcopy.render.RewardIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){this.lbTitle.text=t.tbData.desc,this.listReward.array=t.tbData.getRewardItems();var e=t.isFinish(),i=t.isReward();i?(this.btnLingqu.visible=!1,this.lbYilingqu.visible=!0):(this.btnLingqu.visible=!0,this.lbYilingqu.visible=!1,e?(this.btnLingqu.label=LanMgr.getLan("",10041),this.btnLingqu.skin=SkinUtil.buttonGreen,this.btnLingqu.labelStrokeColor=ColorConst.GREEN_FILTER):(this.btnLingqu.label=LanMgr.getLan("",10045),this.btnLingqu.skin=SkinUtil.buttonNormal,this.btnLingqu.labelStrokeColor=ColorConst.ORANGE_FILTER)),this.imgRedpoint.visible=e&&!i}else this.listReward.array=null},n.prototype.onLingqu=function(){var t=this.dataSource;if(t&&t.isCanReward()){var e={};e[Protocol.friend_groupCopy_getChapterAward.args.id]=t.tbData.ID,PLC.request(Protocol.friend_groupCopy_getChapterAward,e,function(t){t&&(t.addChapterAward&&i.CopyTeamModel.getInstance().groupCopyChapterAward.push(t.addChapterAward),UIMgr.hasStage(UIConst.CopyTeamRewardView)&&UIMgr.getUIByName(UIConst.CopyTeamRewardView).initView(),UIUtil.showRewardView(t.commonData),dispatchEvt(new i.CopyTeamEvent(i.CopyTeamEvent.REWARD_SUCC)))})}},n);function n(){var t=e.call(this)||this;return t.btnLingqu.on(Laya.Event.CLICK,t,t.onLingqu),t}i.CopyTeamRewardIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.teamcopy.render.TeamRankRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t)if(this.ui_bg.dataSource={rank:t.rank},this.boxInfo.visible=null!=t.playerId,this.labInfo.visible=null==t.playerId,this.boxInfo.visible){this.lbName.text=t.name,this.lbMid.text=String(t.force);var e=tb.TB_team_copy.getTB_team_copyById(t.value);e&&(this.lbValue.text=Math.floor(e.copy/10)+"-"+e.copy%10),this.headBox.dataSource=t.getHeadVo(),this.headBox.on(Laya.Event.CLICK,this,this.onShowInfo)}else this.headBox.dataSource=null,this.headBox.off(Laya.Event.CLICK,this,this.onShowInfo);else this.headBox.dataSource=null,this.headBox.off(Laya.Event.CLICK,this,this.onShowInfo)},n.prototype.onShowInfo=function(){var t=this.dataSource;t&&t.playerId&&UIUtil.showPlayerLineupInfo(t.playerId)},n);function n(){return e.call(this)||this}t.CopyTeamRankRender=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.teamcopy.TeamCopyRankUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12475)}},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.listteam.array=null},n.prototype.initView=function(){var o=this;this.lab_empty.visible=!this.listteam.array||this.listteam.array.length<=0,GameUtil.requestRankList(iface.tb_prop.rankTypeKey.groupCopyFloor,common.RankVo).then(function(t){o._listDatas=t.rankList;var e=o._listDatas.length;if(e<6)for(var i=0;i<6-e;i++){var n=new common.RankVo;n.rank=e+i+1,n.playerId=null,o._listDatas.push(n)}o._rank=t.myRank,o.setlistteam()})},n.prototype.setlistteam=function(){if(this.listteam.array=this._listDatas,this.listteam.scrollTo(0),this.lbRank.text=0==this._rank?LanMgr.getLan("",12187):this._rank+"",this.lbRank.event(Laya.Event.RESIZE),this.lbPass.text=LanMgr.getLan("",12476),0<e.CopyTeamModel.getInstance().myFloor){var t=tb.TB_team_copy.getTB_team_copyById(e.CopyTeamModel.getInstance().myFloor);t&&(this.lbPass.text=Math.floor(t.copy/10)+"-"+t.copy%10)}this.lbPass.event(Laya.Event.RESIZE),this.lab_empty.visible=!this.listteam.array||this.listteam.array.length<=0},n);function n(){var t=i.call(this)||this;return t._rank=0,t}e.CopyTeamRank=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.teamcopy.transferLeaderUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this._model=t.CopyTeamModel.getInstance()},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),tl3d.ModuleEventManager.removeEvent(t.CopyTeamEvent.UPDATE_MEMBERLIST,this.updateList,this),this.bgPanel.dataSource=null,this.itemlist.dataSource=null},n.prototype.initView=function(){tl3d.ModuleEventManager.addEvent(t.CopyTeamEvent.UPDATE_MEMBERLIST,this.updateList,this),this.bgPanel.dataSource={uiName:UIConst.CopyTeamTransfer,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12477)},this.updateList()},n.prototype.updateList=function(){!this._model.hasTeam()||!this._model.IsLeader()||this._model.getOtherMembers().length<=0?this.close():(this.itemlist.dataSource=this._model.getOtherMembers(),listAtCenter(this.itemlist,51,2,this.itemlist.dataSource.length,176))},n);function n(){return i.call(this)||this}t.CopyTeamTransferLeader=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.teamcopy.TeamCopyRewardUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12304)},this.addChild(this.bgPanel.btnClose)},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.listReward.array=null},n.prototype.initView=function(){this.listReward.array=t.CopyTeamModel.getInstance().getRewardList(!0)},n);function n(){return i.call(this)||this}t.CopyTeamRewardView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.teamcopy.TeamCopyMainUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this._model=i.CopyTeamModel.getInstance(),this.boxCopy0.on(Laya.Event.CLICK,this,this.onClickBox),this.boxCopy1.on(Laya.Event.CLICK,this,this.onClickBox),this.boxCopy2.on(Laya.Event.CLICK,this,this.onClickBox),this.btn_left.on(Laya.Event.CLICK,this,this.onPage,[-1]),this.btn_right.on(Laya.Event.CLICK,this,this.onPage,[1]),this.uiScene=new Base2dSceneLayerExt,this.itemPanel.addChildAt(this.uiScene,2),this.uiScene.setPos(0,0),this.itemPanel.hScrollBarSkin="",this.itemPanel.hScrollBar&&this.itemPanel.hScrollBar.on(Laya.Event.CHANGE,this,this.onScrollChange)},e.prototype.setSize=function(t,e){n.prototype.setSize.call(this,t,e),this.itemPanel.width=t,this.itemPanel.height=e,this.itemPanel.hScrollBar&&(this.itemPanel.hScrollBar.max=Math.max(900-t,0)),this.lbDesc.y=GameUtil.isFullScreen()?i.HudModel.TOP_ADD_HEIGHT+178:178,this.btn_left.y=GameUtil.isFullScreen()?i.HudModel.TOP_ADD_HEIGHT+178:178,this.btn_right.y=GameUtil.isFullScreen()?i.HudModel.TOP_ADD_HEIGHT+178:178},e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.stopTime(),UIMgr.hideUIByName(UIConst.SysTopView),this.itemPanel.hScrollBar.value=0,this.uiScene.onExit(),this._model1=null,this._model2=null,this._model3=null},e.prototype.initView=function(){var t=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond],e=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_jiangli,redpointName:"team_reward",callback:this.onJiangli.bind(this)},{btnSkin:SkinUtil.btn_rank,callback:this.onRank.bind(this)},{btnSkin:SkinUtil.btn_team,callback:this.onTeam.bind(this),redpointName:"CopyTeamRp"}];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:t,funList:e,closeCallback:this.onFanHui.bind(this)}),Laya.timer.frameOnce(2,this,this.delayScroll),this.uiScene.onShow(),this.startTime()},e.prototype.startTime=function(){this.stopTime(),this._model.hasTeam()&&this.timerLoop(3e3,this,this.updateRender)},e.prototype.stopTime=function(){this.clearTimer(this,this.updateRender)},e.prototype.updateRender=function(){i.CopyTeamThread.getInstance().requestMyTeamInfo()},e.prototype.updateMainState=function(){var t=this._model.getMyNextId();this.ani_guanqia.stop(),this.ani_roleselect.stop(),this.ani_guanqia.visible=!1,this.ani_roleselect.visible=!1,this.lbDesc.text=LanMgr.getLan("",10079,num2ChiNum(this._chapter));for(var e=this._model.getTeamAryByChapter(this._chapter),i=null,n=0;n<e.length;n++)(i=e[n])&&this.drawItem(i,t)},e.prototype.drawItem=function(t,e){var i=t.copy%10,n=1==i?this.lbCopy0:2==i?this.lbCopy1:this.lbCopy2;n.text=this._model.myFloor>=t.ID?LanMgr.getLan("",12478):LanMgr.getLan("",10030,num2ChiNum(i)),n.color=this._model.myFloor>=t.ID?"#40ff7c":"#ffeecc";var o=tb.TB_monster.get_TB_monsterById(t.monster_show),a=1==i?this._model1:2==i?this._model2:this._model3,r=1==i?this.boxCopy0:2==i?this.boxCopy1:this.boxCopy2;r.dataSource=t,a?(a.setRoleUrl(getRoleUrl(String(o.model))),a.scale=t.model_multiple):(a=this.uiScene.addModelChar(String(o.model),r.x,r.y,180,t.model_multiple),1==i?this._model1=a:2==i?this._model2=a:this._model3=a),e!=this._model.myFloor&&t.ID==e&&(this.ani_roleselect.visible=this.ani_guanqia.visible=!0,this.ani_guanqia.play(0,!0),this.ani_roleselect.play(0,!0),this.ani_guanqia.x=r.x,this.ani_guanqia.y=r.y-150,this.ani_roleselect.x=r.x,this.ani_roleselect.y=r.y-25,this.ani_roleselect.scaleX=i<=2?.6:1,this.ani_roleselect.scaleY=i<=2?.6:1)},e.prototype.onRule=function(){dispatchEvt(new i.CopyTeamEvent(i.CopyTeamEvent.SHOW_RULE_VIEW))},e.prototype.onJiangli=function(){dispatchEvt(new i.CopyTeamEvent(i.CopyTeamEvent.SHOW_REWARD_VIEW))},e.prototype.onRank=function(){dispatchEvt(new i.CopyTeamEvent(i.CopyTeamEvent.SHOW_RANK_VIEW))},e.prototype.onPage=function(t,e){e.target.dataSource&&e.target.dataSource.info?0<e.target.dataSource.info.length&&showToast(e.target.dataSource.info):(this._chapter+=t,this.updateBtn(),this.updateMainState())},e.prototype.onTeam=function(){dispatchEvt(new i.CopyTeamEvent(i.CopyTeamEvent.SHOW_TEAMBUILD))},e.prototype.delayScroll=function(){var t=this._model.hasTeam()?this._model.captainFloor:this._model.myFloor;t=this._model.getNextId(t);var e=tb.TB_team_copy.getTB_team_copyById(t);if(e){this._chapter=Math.floor(e.copy/10);var i=e.copy%10;this.lab_campInfo.visible=this._model.hasTeam(),this.lab_campInfo.text=LanMgr.getLan("",12479)+":"+this._chapter+"-"+i,this.updateBtn(),this.updateMainState(),this.itemPanel.hScrollBar&&(this.itemPanel.hScrollBar.max=900-this.itemPanel.width,this.itemPanel.hScrollBar.value=1==i?0:2==i?180:90)}},e.prototype.updateBtn=function(){if(this.btn_left.gray=this._chapter<=1,this.btn_left.dataSource=null,this._chapter<=1&&(this.btn_left.dataSource={info:LanMgr.getLan("",10263)}),this.btn_right.gray=!1,this.btn_right.dataSource=null,this._chapter>=this._model.MaxChapter)this.btn_right.gray=!0,this.btn_right.dataSource={info:LanMgr.getLan("",10263)};else{var t=this._model.getTeamAryByChapter(this._chapter+1);t?(this.btn_right.gray=t[0].ID>this._model.getMyNextId(),this.btn_right.gray&&(this.btn_right.dataSource={info:LanMgr.getLan("",10264)})):(this.btn_right.gray=!0,this.btn_right.dataSource={info:LanMgr.getLan("",10265)})}},e.prototype.onClickBox=function(e){var i=this;if(e.target&&e.target.dataSource)if(this._model.hasTeam())if(this._model.IsLeader()){var t=this._model.memberList.findIndex(function(t){return i._model.getNextId(t.copyFloor)<e.target.dataSource.ID});-1==t?UIMgr.showUI(UIConst.CopyTeamBattleInfo,tb.TB_team_copy.getTB_team_copyById(e.target.dataSource.ID)):showToast(LanMgr.getLan("",10266,this._model.memberList[t].name))}else showToast(LanMgr.getLan("",10267));else e.target.dataSource.ID<=this._model.getMyNextId()?UIMgr.showUI(UIConst.CopyTeamBattleInfo,tb.TB_team_copy.getTB_team_copyById(e.target.dataSource.ID)):showToast(LanMgr.getLan("",10268))},e.prototype.onFanHui=function(){dispatchEvt(new i.HudEvent(i.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_LILIAN))},e.prototype.onScrollChange=function(){this.itemPanel.hScrollBar&&(this.uiScene.x=-this.itemPanel.hScrollBar.value)},e);function e(){var t=n.call(this)||this;return t.group=UIConst.hud_group,t}i.CopyTeamMainView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.goddomain.InviteJoinUI,__extends(e,n),e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),Laya.timer.clearAll(this),this.btnYes.off(Laya.Event.CLICK,this,this.onYes),this.btnNo.off(Laya.Event.CLICK,this,this.onNot),this.checkBox.off(Laya.Event.CHANGE,this,this.onChange)},e.prototype.initView=function(){this.checkBox.selected=!1,this._cd=tb.TB_fight_goddomain_set.getSet().invite_time;var t=this.dataSource;this.lab_title.text=LanMgr.getLan("",12480),this.lbContent.text=LanMgr.getLan("",12481,t.name),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime(),this.btnYes.on(Laya.Event.CLICK,this,this.onYes),this.btnNo.on(Laya.Event.CLICK,this,this.onNot),this.checkBox.on(Laya.Event.CHANGE,this,this.onChange)},e.prototype.updateTime=function(){if(this._cd<=0)return Laya.timer.clear(this,this.updateTime),void this.close();this.lbTime.text=LanMgr.getLan("",12172,this._cd)+"s",this._cd--},e.prototype.onYes=function(){var t=this,e=this.dataSource;e&&(i.GodDomainModel.getInstance().hasTeam()?common.AlertBox.showAlert({text:LanMgr.getLan("",10497),confirmCb:function(){t.joinOpt(e.playerId)},parm:null}):this.joinOpt(e.playerId))},e.prototype.joinOpt=function(t){this.close(),this._thread.joinInvite(t).then(function(){i.GodDomainModel.getInstance().resetGroupId(),dispatchEvt(new i.CopyTeamEvent(i.CopyTeamEvent.SHOW_TEAMBUILD))})},e.prototype.onNot=function(){this.close();var t=this.dataSource;t&&this._thread.refuseInvite(t.playerId).then(function(){})},e.prototype.onChange=function(){var e=this,t=this.dataSource,i=this.checkBox.selected?iface.tb_prop.groupInviteTypeKey.no:iface.tb_prop.groupInviteTypeKey.yes;this._thread.todayRefuseJoin(t.playerId,i).then(function(t){e.checkBox.selected=t==iface.tb_prop.groupInviteTypeKey.no})},e);function e(){var t=n.call(this)||this;return t.isModelClose=!1,t._thread=i.CopyTeamThread.getInstance(),t}i.CopyTeamInviteJoinView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.teamcopy.TeamCopyInvitationUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.btnRefresh.on(Laya.Event.CLICK,this,this.onRefresh),this._model=e.CopyTeamModel.getInstance()},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),tl3d.ModuleEventManager.removeEvent(e.CopyTeamEvent.UPDATE_MEMBERLIST,this.updateList,this),this.bgPanel.dataSource=null,this.teamList.array=null},n.prototype.initView=function(){tl3d.ModuleEventManager.addEvent(e.CopyTeamEvent.UPDATE_MEMBERLIST,this.updateList,this),this.bgPanel.dataSource={uiName:UIConst.CopyTeamInvite,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12482)},this.updateList()},n.prototype.updateList=function(){this.teamList.array=this._model.getInviteList(),this.imgEmpty.visible=this.lbEmpty.visible=this.teamList.array.length<=0},n.prototype.onRefresh=function(){var t=this;e.CopyTeamThread.getInstance().requestInviteList(!0).then(function(){t.updateList()})},n);function n(){return i.call(this)||this}e.CopyTeamInvite=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.teamcopy.TeamInfoUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.btn_apply.on(Laya.Event.CLICK,this,this.onApply),this.btn_leave.on(Laya.Event.CLICK,this,this.onLeave),this.btn_transfer.on(Laya.Event.CLICK,this,this.onTransfer),this._model=t.CopyTeamModel.getInstance()},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),tl3d.ModuleEventManager.removeEvent(t.CopyTeamEvent.UPDATE_MEMBERLIST,this.updateRender,this)},n.prototype.initView=function(){this.refreshOpt(),tl3d.ModuleEventManager.addEvent(t.CopyTeamEvent.UPDATE_MEMBERLIST,this.updateRender,this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.CopyTeamInfo,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12483)}},n.prototype.updateRender=function(){this._model.hasTeam()?this.refreshOpt():this.close()},n.prototype.refreshOpt=function(){this.lab_force.text=String(this._model.getTeamAllForce()),this.btn_transfer.visible=this.btn_apply.visible=this._model.IsLeader(),this.btn_leave.x=this._model.IsLeader()?61:227,this.ui_item0.dataSource=this._model.getMemberById(1),this.ui_item1.dataSource=this._model.getMemberById(2),this.ui_item2.dataSource=this._model.getMemberById(3)},n.prototype.onApply=function(){dispatchEvt(new t.CopyTeamEvent(t.CopyTeamEvent.APPLY_TEAM_PANEL))},n.prototype.onLeave=function(){dispatchEvt(new t.CopyTeamEvent(t.CopyTeamEvent.LEAVE_TEAM))},n.prototype.onTransfer=function(){dispatchEvt(new t.CopyTeamEvent(t.CopyTeamEvent.SHOW_TRANSFER_PANEL))},n);function n(){var t=i.call(this)||this;return t.group=UIConst.team_two_group,t}t.CopyTeamInfo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.teamcopy.teamCopyStartUI,__extends(n,i),n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.drawData(),this.refresh()},n.prototype.drawData=function(){logfight("过场-----",this.dataSource);var t=this.dataSource.vo;if(t){var e=t.leftInfo,i=t.rightInfo;e&&(this.ui_head_left.dataSource=new UserHeadVo(e.head,e.level,e.headFrame),this.lab_name_left.text=e.name,this.lab_power_left.text=e.force+"",this.leftModel=e.modelId),i&&(this.ui_head_right.dataSource=new UserHeadVo(i.head,i.level,i.headFrame),this.lab_name_right.text=i.name,this.lab_power_right.text=i.force+"",this.rightModel=i.modelId)}},n.prototype.close=function(){i.prototype.close.call(this),this.uiScene.onExit()},n.prototype.initView=function(){this.ani1.on(Laya.UIEvent.COMPLETE,this,this.onComplete1),this.ani2.on(Laya.UIEvent.COMPLETE,this,this.onComplete2)},n.prototype.refresh=function(){this.dataSource.optType==startOptState.START||this.dataSource.optType==startOptState.GUOCHANG?(this.img_vs.visible=!1,this.ani2.play(0,!1)):this.dataSource.optType==startOptState.GUOCHANGCOMPLETE&&(this.img_vs.visible=!0,this.ani1.play(0,!1))},n.prototype.onComplete1=function(){this.ani1.off(Laya.UIEvent.COMPLETE,this,this.onComplete1),this.onExit()},n.prototype.onComplete2=function(){var t=this;this.ani2.off(Laya.UIEvent.COMPLETE,this,this.onComplete2),this.uiScene.addModelChar(String(this.leftModel),160,950,180,2.2),this.uiScene.addModelChar(String(this.rightModel),560,550,180,2.2),Laya.timer.frameOnce(3,this,function(){t.dataSource.optType==startOptState.START?(t.img_vs.visible=!0,t.ani1.play(0,!1)):t.dataSource&&t.dataSource.cb&&t.dataSource.cb()})},n.prototype.onExit=function(){var t=this;setTimeout(function(){t.dataSource&&t.dataSource.cb&&t.dataSource.cb(),t.close()},1e3)},n);function n(){var t=i.call(this)||this;return t.leftModel=2010,t.rightModel=2010,t.isModelClose=!1,t.uiScene=new Base2dSceneLayerExt,t.addChild(t.uiScene),t}t.CopyTeamFightStart=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.teamcopy.TeamBuildUI,__extends(n,i),n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),tl3d.ModuleEventManager.removeEvent(e.CopyTeamEvent.DISEVT_JOIN_TEAM,this.disJoinTeam,this),this.teamList.array=null,this.timer.clear(this,this.onRefresh),this.btnRefresh.off(Laya.Event.CLICK,this,this.onRefresh),this.btnCreateTeam.off(Laya.Event.CLICK,this,this.onCreat)},n.prototype.initView=function(){this.updateView(),tl3d.ModuleEventManager.addEvent(e.CopyTeamEvent.DISEVT_JOIN_TEAM,this.disJoinTeam,this),this.btnRefresh.on(Laya.Event.CLICK,this,this.onRefresh),this.btnCreateTeam.on(Laya.Event.CLICK,this,this.onCreat),this.timer.loop(5e3,this,this.onRefresh)},n.prototype.disJoinTeam=function(){UIMgr.showUI(UIConst.CopyTeamInfo)},n.prototype.updateView=function(){var t=e.CopyTeamModel.getInstance().getTeamList();this.teamList.array=t,this.imgEmpty.visible=this.lbEmpty.visible=t.length<=0},n.prototype.onRefresh=function(){var t=this;e.CopyTeamThread.getInstance().requestTeamList(!0).then(function(){t.updateView()})},n.prototype.onCreat=function(){dispatchEvt(new e.CopyTeamEvent(e.CopyTeamEvent.CREATE_TEAM_VIEW))},n);function n(){var t=i.call(this)||this;return t.group=UIConst.team_two_group,t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.CopyTeamBuild,closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12484)},t}e.CopyTeamBuild=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.teamcopy.BattleInfoUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._model=t.CopyTeamModel.getInstance(),this.isModelClose=!0,this.btn_addteam.on(Laya.Event.CLICK,this,this.onAddTeam),this.btn_singlebattle.on(Laya.Event.CLICK,this,this.onSingleBattle)},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.lineupUI.dataSource=null,this.bgPanel.dataSource=null,this.rewardList.dataSource=null},n.prototype.initView=function(){var t=this.dataSource;t&&(this.bgPanel.dataSource={uiName:UIConst.CopyTeamBattleInfo,closeOnButton:!1,closeOnSide:this.isModelClose,centerBgHide:!0,title:LanMgr.getLan("",10079,Math.floor(t.copy/10))+" "+LanMgr.getLan("",10030,t.copy%10)},this.lineupUI.dataSource={lineupGods:this.getMonsterList(t.monster),shenqiAry:[],showShenli:!1,title:LanMgr.getLan("",10020)},this.rewardList.dataSource=t.getRewardList(),listAtCenter(this.rewardList,92,5,this.rewardList.dataSource.length,100),this.btn_singlebattle.label=this._model.hasTeam()?LanMgr.getLan("",12486):LanMgr.getLan("",12485),this.btn_singlebattle.x=this._model.hasTeam()?284:447,this.btn_addteam.visible=!this._model.hasTeam())},n.prototype.getMonsterList=function(t){for(var e=[],i=null,n=0;n<t.length;n++)(i=tb.TB_monster.get_TB_monsterById(t[n]))?e.push(i):logerror("team Copy data error:"+t[n]);return e},n.prototype.onAddTeam=function(){if(this._model.hasTeam())return showToast(LanMgr.getLan("",10203)),void this.close();dispatchEvt(new t.CopyTeamEvent(t.CopyTeamEvent.SHOW_TEAMBUILD))},n.prototype.onSingleBattle=function(){if(this.dataSource)return this._model.hasTeam()&&!this._model.IsLeader()?(showToast(LanMgr.getLan("",10203)),void this.close()):void dispatchEvt(new t.CopyTeamEvent(t.CopyTeamEvent.TEAM_COPY_BATTLE),this.dataSource.ID)},n);function n(){var t=i.call(this)||this;return t.group=UIConst.team_two_group,t}t.CopyTeamBattleInfo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.teamcopy.TeamCopyApplyUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.btnRefresh.on(Laya.Event.CLICK,this,this.onRefresh),this.btnRefuse.on(Laya.Event.CLICK,this,this.onRefuse),this._model=e.CopyTeamModel.getInstance()},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.timer.clear(this,this.onRefresh),this.bgPanel.dataSource=null,this.teamList.array=null},n.prototype.initView=function(){this.timer.clear(this,this.onRefresh),this.timer.loop(1e4,this,this.onRefresh),this.bgPanel.dataSource={uiName:UIConst.CopyTeamApply,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12259)},this.updateList()},n.prototype.updateList=function(){this.teamList.array=this._model.getApplyList(),this.imgEmpty.visible=this.lbEmpty.visible=this.teamList.array.length<=0},n.prototype.onRefresh=function(){var t=this;e.CopyTeamThread.getInstance().getApplyList(!0).then(function(){t.updateList()})},n.prototype.onRefuse=function(){var t=this;!this.teamList||!this.teamList.array||this.teamList.array.length<=0||e.CopyTeamThread.getInstance().applyOpt(null,iface.tb_prop.applyOptTypeKey.no).then(function(){t.updateList()})},n);function n(){return i.call(this)||this}e.CopyTeamApply=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"CopyTeamProcessor"},i.prototype.listenModuleEvents=function(){return[new a.CopyTeamEvent(a.CopyTeamEvent.SHOW_MAIN_PANEL),new a.CopyTeamEvent(a.CopyTeamEvent.SHOW_RULE_VIEW),new a.CopyTeamEvent(a.CopyTeamEvent.SHOW_REWARD_VIEW),new a.CopyTeamEvent(a.CopyTeamEvent.SHOW_RANK_VIEW),new a.CopyTeamEvent(a.CopyTeamEvent.SHOW_TEAMBUILD),new a.CopyTeamEvent(a.CopyTeamEvent.CREATE_TEAM_VIEW),new a.CopyTeamEvent(a.CopyTeamEvent.LEAVE_TEAM),new a.CopyTeamEvent(a.CopyTeamEvent.SET_POS_TEAM),new a.CopyTeamEvent(a.CopyTeamEvent.APPLY_JOIN_TEAM),new a.CopyTeamEvent(a.CopyTeamEvent.APPLY_TEAM_PANEL),new a.CopyTeamEvent(a.CopyTeamEvent.KICK_OUT_MEMBER),new a.CopyTeamEvent(a.CopyTeamEvent.AGREED_APPLY),new a.CopyTeamEvent(a.CopyTeamEvent.TEAM_COPY_BATTLE),new a.CopyTeamEvent(a.CopyTeamEvent.DISEVT_JOIN_TEAM),new a.CopyTeamEvent(a.CopyTeamEvent.DISEVT_EXIT_TEAM),new a.CopyTeamEvent(a.CopyTeamEvent.DISEVT_JOIN_OTHER_TEAM),new a.CopyTeamEvent(a.CopyTeamEvent.PLAY_REPORT),new a.CopyTeamEvent(a.CopyTeamEvent.SHOW_INVITE_VIEW),new a.CopyTeamEvent(a.CopyTeamEvent.SEND_INVITE),new a.CopyTeamEvent(a.CopyTeamEvent.HIDE_TRANSFER_PANEL),new a.CopyTeamEvent(a.CopyTeamEvent.SHOW_TRANSFER_PANEL),new a.CopyTeamEvent(a.CopyTeamEvent.UPDATE_TEAM_FLOOR)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof a.CopyTeamEvent)switch(t.type){case a.CopyTeamEvent.SHOW_MAIN_PANEL:this.showMainPanel();break;case a.CopyTeamEvent.SHOW_RULE_VIEW:this.showRuleView();break;case a.CopyTeamEvent.SHOW_REWARD_VIEW:this.showRewardView();break;case a.CopyTeamEvent.SHOW_RANK_VIEW:this.showRankView();break;case a.CopyTeamEvent.SHOW_TEAMBUILD:this.showTeamList();break;case a.CopyTeamEvent.CREATE_TEAM_VIEW:this.createTeamView();break;case a.CopyTeamEvent.LEAVE_TEAM:this.levelTeam();break;case a.CopyTeamEvent.SET_POS_TEAM:this.setPosTeam(t.data);break;case a.CopyTeamEvent.APPLY_JOIN_TEAM:this.applyJoinTeam(t.data);break;case a.CopyTeamEvent.APPLY_TEAM_PANEL:this.showApplyPanel();break;case a.CopyTeamEvent.AGREED_APPLY:this.agreedApply(t.data);break;case a.CopyTeamEvent.KICK_OUT_MEMBER:this.kickOutMember(t.data);break;case a.CopyTeamEvent.TEAM_COPY_BATTLE:this.teamCopyBattle(t.data);break;case a.CopyTeamEvent.DISEVT_JOIN_TEAM:this.disevtJoinTeam();break;case a.CopyTeamEvent.DISEVT_EXIT_TEAM:this.disevtExitTeam();break;case a.CopyTeamEvent.DISEVT_JOIN_OTHER_TEAM:break;case a.CopyTeamEvent.PLAY_REPORT:this.playReport(t.data);break;case a.CopyTeamEvent.SHOW_INVITE_VIEW:this.showInviteView();break;case a.CopyTeamEvent.SEND_INVITE:this.sendInvite(t.data);break;case a.CopyTeamEvent.HIDE_TRANSFER_PANEL:this.hideTransferPanel();break;case a.CopyTeamEvent.SHOW_TRANSFER_PANEL:this.showTransferPanel();break;case a.CopyTeamEvent.UPDATE_TEAM_FLOOR:this.updateTeamFloor()}},i.prototype.showMainPanel=function(){var t=this;this._thread.requestMyTeamInfo().then(function(){t.teamCopyView||UIMgr.showUI(UIConst.Copy_TeamMainView)})},i.prototype.showRuleView=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(40003))},i.prototype.showRewardView=function(){UIMgr.showUI(UIConst.CopyTeamRewardView)},i.prototype.showRankView=function(){UIMgr.showUI(UIConst.CopyTeamRank)},i.prototype.showTeamList=function(){this._model.hasTeam()?UIMgr.showUI(UIConst.CopyTeamInfo):this._thread.requestTeamList().then(function(){UIMgr.showUI(UIConst.CopyTeamBuild)})},i.prototype.createTeamView=function(){this._thread.createTeam().then(function(){UIMgr.showUI(UIConst.CopyTeamInfo)})},i.prototype.levelTeam=function(){var t=this;common.AlertBox.showAlert({text:"是否要离开队伍?",confirmCb:function(){t._thread.leaveTeam().then(function(){UIMgr.showUI(UIConst.CopyTeamBuild)})},parm:null})},i.prototype.setPosTeam=function(t){var e=this;this._thread.swapMember(t).then(function(t){e.teamCopyInfoView&&e.teamCopyInfoView.refreshOpt()})},i.prototype.applyJoinTeam=function(t){var e=this;App.IsSysOpen(ModuleConst.TEAM_COPY)?this._thread.applyJoinTeam(t).then(function(t){e.teamCopyInfoView&&e.teamCopyInfoView.refreshOpt()}):showToast(tb.TB_sys_open.get_TB_sys_openById(ModuleConst.TEAM_COPY).prompt)},i.prototype.showApplyPanel=function(){this._thread.getApplyList().then(function(t){UIMgr.showUI(UIConst.CopyTeamApply)})},i.prototype.disevtJoinTeam=function(){showToast(LanMgr.getLan("",10261,this._model.getLeaderName())),this.teamCopyView&&this.teamCopyView.startTime()},i.prototype.disevtExitTeam=function(){this.teamCopyView&&this.teamCopyView.stopTime()},i.prototype.updateTeamFloor=function(){this.teamCopyView&&this.teamCopyView.delayScroll()},i.prototype.agreedApply=function(t){var e=this;this._thread.applyOpt(t.playerId,t.state).then(function(t){e.teamCopyApplyView&&e.teamCopyApplyView.updateList()})},i.prototype.kickOutMember=function(t){var e=this;common.AlertBox.showAlert({text:"确定要将玩家名字踢出队伍吗?",confirmCb:function(){e._thread.kickoutMember(t).then(function(t){e.teamCopyInfoView&&e.teamCopyInfoView.refreshOpt()})},parm:null})},i.prototype.teamCopyBattle=function(t){var e=this,i={};i[Protocol.friend_groupCopy_startBattle.args.id]=t,PLC.request(Protocol.friend_groupCopy_startBattle,i,function(t){t&&(e._model.updateGroupState(t.myGroup),e.playReport(t))})},i.prototype.playReport=function(t){var e=new a.FightVo;e.copyType=CopyType.teamCopy,e.copyTeamFightVo=new a.CopyTeamFightVo(t.copyFloor,t.memberInfo);var i=new a.ServerPage;if(i.initPage(t.battleReport.reportData),i.result=1==t.winCamp?playState.VICTORY:playState.FAILURE,e.fightPageControl=i,t.copyFloor>=this._model.myFloor){var n=tb.TB_team_copy.getTB_team_copyById(t.copyFloor);t.extReward=n.getRewardList()}var o={vo:e,event:new a.CopyTeamEvent(a.CopyTeamEvent.SHOW_MAIN_PANEL),responseData:t};dispatchEvt(new a.FightsEvent(a.FightsEvent.ENTER_FIGHT_EVENT),o)},i.prototype.showInviteView=function(){this._thread.requestInviteList().then(function(){UIMgr.showUI(UIConst.CopyTeamInvite)})},i.prototype.sendInvite=function(t){this._thread.requestInviteList().then(function(){})},i.prototype.hideTransferPanel=function(){this.teamCopyTransferView&&UIMgr.hideUIByName(UIConst.CopyTeamTransfer)},i.prototype.showTransferPanel=function(){this._model.getOtherMembers().length<=0?showToast(LanMgr.getLan("",10262)):this.teamCopyTransferView||UIMgr.showUI(UIConst.CopyTeamTransfer)},Object.defineProperty(i.prototype,"teamCopyTransferView",{get:function(){return UIMgr.hasStage(UIConst.CopyTeamTransfer)?UIMgr.getUIByName(UIConst.CopyTeamTransfer):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"teamCopyApplyView",{get:function(){return UIMgr.hasStage(UIConst.CopyTeamApply)?UIMgr.getUIByName(UIConst.CopyTeamApply):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"teamCopyInfoView",{get:function(){return UIMgr.hasStage(UIConst.CopyTeamInfo)?UIMgr.getUIByName(UIConst.CopyTeamInfo):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"teamCopyView",{get:function(){return UIMgr.hasStage(UIConst.Copy_TeamMainView)?UIMgr.getUIByName(UIConst.Copy_TeamMainView):null},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=a.CopyTeamModel.getInstance(),t._thread=a.CopyTeamThread.getInstance(),t}a.CopyTeamProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"CopyTeamModule"},n.prototype.listProcessors=function(){return[new t.CopyTeamProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.CopyTeamModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_MAIN_PANEL="SHOW_MAIN_PANEL",r.SHOW_TEAMBUILD="SHOW_TEAMBUILD",r.SHOW_RANK_VIEW="SHOW_RANK_VIEW",r.SHOW_REWARD_VIEW="SHOW_REWARD_VIEW",r.REWARD_SUCC="REWARD_SUCC",r.SHOW_RULE_VIEW="SHOW_RULE_VIEW",r.CREATE_TEAM_VIEW="CREATE_TEAM_VIEW",r.SHOW_INVITE_VIEW="SHOW_INVITE_VIEW",r.JOIN_TEAM="JOIN_TEAM",r.APPLY_JOIN_TEAM="APPLY_JOIN_TEAM",r.LEAVE_TEAM="LEAVE_TEAM",r.SET_POS_TEAM="SET_POS_TEAM",r.APPLY_TEAM_PANEL="APPLY_TEAM_PANEL",r.AGREED_APPLY="AGREED_APPLY",r.KICK_OUT_MEMBER="KICK_OUT_MEMBER",r.TEAM_COPY_BATTLE="TEAM_COPY_BATTLE",r.DISEVT_JOIN_TEAM="DISEVT_JOIN_TEAM",r.DISEVT_EXIT_TEAM="DISEVT_EXIT_TEAM",r.DISEVT_JOIN_OTHER_TEAM="DISEVT_JOIN_OTHER_TEAM",r.PLAY_REPORT="PLAY_REPORT",r.SEND_INVITE="SEND_INVITE",r.HIDE_TRANSFER_PANEL="HIDE_TRANSFER_PANEL",r.SHOW_TRANSFER_PANEL="SHOW_TRANSFER_PANEL",r.UPDATE_MEMBERLIST="UPDATE_MEMBERLIST",r.UPDATE_GROUP_INFO="UPDATE_GROUP_INFO",r.UPDATE_APPLY_RP="UPDATE_APPLY_RP",r.UPDATE_TEAM_FLOOR="UPDATE_TEAM_FLOOR",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.CopyTeamEvent=a}(game=game||{}),function(o){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.initTeamTab=function(){this.teamTabObj={};var t=TableData.getInstance().getTableByName(TableData.tb_team_copy),e=0;for(var i in t.data)e=Math.floor(Number(t.data[i].copy)/10),this.teamTabObj[e]||(this.teamTabObj[e]=[],this.MaxChapter=e),this.teamTabObj[e].push(t.data[i])},e.prototype.getTeamAryByChapter=function(t){return this.teamTabObj?this.teamTabObj[t]:null},e.prototype.hasTeam=function(){return this.groupId&&""!=this.groupId},e.prototype.setTeamList=function(t){this._teamList=[];for(var e=0;e<t.length;e++){t[e];var i=new o.CopyTeamListVo;i.setSvo(t[e]),this._teamList.push(i)}},e.prototype.getTeamList=function(){return this._teamList?this._teamList:[]},e.prototype.getLeaderName=function(){var e=this;if(!this.memberList)return"";if(!this.leaderId||""==this.leaderId)return"";var t=this.memberList.find(function(t){return t.playerId==e.leaderId});return t?t.name:""},e.prototype.updateTeamInfo=function(t,e){if(t){var i=0;!this.hasTeam()&&t.groupCopyId&&(i=1),this.hasTeam()&&!t.groupCopyId&&(i=2),this.hasTeam()&&t.groupCopyId&&t.groupCopyId!==this.groupId&&(i=3),this.updateGroupState(t),this.updateMemberList(e),1==i?dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.DISEVT_JOIN_TEAM)):2==i?(this._applyList=[],this._inviteList=[],dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.UPDATE_APPLY_RP)),dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.DISEVT_EXIT_TEAM))):3==i&&dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.DISEVT_JOIN_OTHER_TEAM))}},e.prototype.initGroupData=function(t){t&&(this.myFloor=Number(t.groupCopyFloor),this.groupId=t.groupCopyId||"",this.groupCopyChapterAward=t.groupCopyChapterAward,this.hasTeam()&&o.CopyTeamThread.getInstance().getApplyList())},e.prototype.updateGroupState=function(t){if(t){this.myFloor=Number(t.groupCopyFloor);var e=this.captainFloor;this.captainFloor=Number(t.captainCopyFloor)||0,this.groupId=t.groupCopyId,this.captainFloor!=e&&dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.UPDATE_TEAM_FLOOR)),dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.UPDATE_GROUP_INFO))}},e.prototype.delMember=function(e){if(e&&""!=e&&this.memberList){var t=this.memberList.findIndex(function(t){return t.playerId==e});-1!=t&&this.memberList.splice(t,1)}},e.prototype.updateMemberList=function(t){this.memberList=t||[],this.teamAllForce=0,this.leaderId="";var e=null;for(var i in this.memberList)(e=this.memberList[i])&&(Number(e.job)==iface.tb_prop.groupJobTypeKey.captain&&(this.leaderId=e.playerId),this.teamAllForce+=e.force);dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.UPDATE_MEMBERLIST))},e.prototype.setInviteList=function(t){this._inviteList=t||[]},e.prototype.getInviteList=function(){return this._inviteList||[]},e.prototype.setApplyList=function(t){this._applyList=t||[],dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.UPDATE_APPLY_RP))},e.prototype.getApplyList=function(){return this._applyList||[]},e.prototype.hasApplyRedPoint=function(){return!!this._applyList&&this.hasTeam()&&0<this._applyList.length},e.prototype.clearApplyList=function(t){for(var e=null,i=-1;t&&0<t.length;)e=t.shift(),-1!=(i=this._applyList.findIndex(function(t){return t.playerId==e}))&&this._applyList.splice(i,1);dispatchEvt(new o.CopyTeamEvent(o.CopyTeamEvent.UPDATE_APPLY_RP))},e.prototype.getNextId=function(t){var e=TableData.getInstance().getTableByName(TableData.tb_team_copy),i=Object.keys(e.data);return Math.min(i.length,t+1)},e.prototype.getMyNextId=function(){return this.getNextId(this.myFloor)},e.prototype.IsLeader=function(){return this.leaderId===App.hero.playerId},e.prototype.getTeamAllForce=function(){return this.teamAllForce},e.prototype.getMemberById=function(t){var e=null;for(var i in this.memberList)if((e=this.memberList[i])&&Number(e.pos)==t)return e;return{pos:t,playerId:null}},e.prototype.swapMember=function(t){if(t){var e=null,i=-1;for(var n in this.memberList)(e=this.memberList[n])&&-1!=(i=t.indexOf(e.pos))&&(i=(i+1)%2,e.pos=t[i])}},e.prototype.getRewardList=function(t){if(void 0===t&&(t=!1),!this._rewardList){this._rewardList=[];for(var e=0,i=tb.TB_team_target.getList();e<i.length;e++){var n=i[e];this._rewardList.push(new o.CopyRewardVo(n))}}return t&&(this._rewardList.forEach(function(t){t.sortNum=t.isCanReward()?t.tbData.ID:t.isFinish()?t.tbData.ID+1e4:t.tbData.ID+1e3}),this._rewardList.sort(function(t,e){return t.sortNum-e.sortNum})),this._rewardList},e.prototype.isCanReward=function(){return this.getRewardList().some(function(t){return t.isCanReward()})},e.prototype.getOtherMembers=function(){if(!this.memberList)return[];var t=[];for(var e in this.memberList)this.memberList[e].playerId!=App.hero.playerId&&t.push(this.memberList[e]);return t},e);function e(){this.leaderId="",this.teamAllForce=0,this.memberList=[],this.initTeamTab()}o.CopyTeamModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var o,t=(o=ui.dailycopy.DailyCopyUI,__extends(e,o),e.prototype.createChildren=function(){o.prototype.createChildren.call(this),this.bgPanel.addChildAt(this.img_bg,3)},e.prototype.show=function(t,e){o.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){o.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(t,e,i){void 0===i&&(i=!0),o.prototype.close.call(this,t,e,i)},e.prototype.onClosed=function(){o.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.btnBuy.off(Laya.Event.CLICK,this,this.onClick),this.list.array=null,tl3d.ModuleEventManager.removeEvent(n.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateCount,this),tl3d.ModuleEventManager.removeEvent(n.ResEvent.LIMIT_VALUE_CHANGE,this.updateCount,this)},e.prototype.initView=function(){this.btnBuy.on(Laya.Event.CLICK,this,this.onClick),this._curType=this.dataSource?this.dataSource:iface.tb_prop.dailyCopyTypeKey.gold,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:n.DailyCopyModel.COPY_NAME[this._curType]},this.updateView(),tl3d.ModuleEventManager.addEvent(n.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateCount,this),tl3d.ModuleEventManager.addEvent(n.ResEvent.LIMIT_VALUE_CHANGE,this.updateCount,this)},e.prototype.updateView=function(){var t=n.DailyCopyModel.getInstance().getCopyListByType(this._curType);if(t&&!(t.length<=0)){this.list.array=t,this.updateCount();var e=this.getMaxOpenIndex(t);this.list.scrollTo(e-3)}},e.prototype.getMaxOpenIndex=function(t){if(!t||0==t.length)return 0;for(var e=0,i=0;i<t.length;i++){if(t[i].isLvLimit())return e;e=i}return e},e.prototype.updateCount=function(){var t=App.hero.getOverplusValue(this._overPlusTypeKey[this._curType-1]);if(t<=0){var e=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum),i=n.DailyCopyModel.getInstance().getLimitType(this._curType);t=e-App.hero.getlimitValue(i),this.lbCount.text=LanMgr.getLan("可购买次数:{0}",-1,t)}else this.lbCount.text=LanMgr.getLan("",10081,t)},e.prototype.onClick=function(t){switch(t.target){case this.btnBuy:var e=n.DailyCopyModel.getInstance().getCopyListByType(this._curType);dispatchEvt(new n.DailyEvent(n.DailyEvent.SHOW_BUY_VIEW,e[0].type))}},e);function e(){var t=o.call(this)||this;return t._overPlusTypeKey=[iface.tb_prop.overplusTypeKey.dailyCopyNum1,iface.tb_prop.overplusTypeKey.dailyCopyNum2,iface.tb_prop.overplusTypeKey.dailyCopyNum3],t.isModelClose=!0,t}n.DailyCopyView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.dailycopy.DailyCopyMainUI,__extends(o,n),o.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.boxCopy0.on(Laya.Event.CLICK,this,this.onClickBox,[0]),this.boxCopy1.on(Laya.Event.CLICK,this,this.onClickBox,[1]),this.boxCopy2.on(Laya.Event.CLICK,this,this.onClickBox,[2]),this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.DAILY_COPY),this.uiScene=new Base2dSceneLayerExt,this.imgBg.addChild(this.uiScene),this.itemPanel.hScrollBarSkin="",this.itemPanel.hScrollBar&&this.itemPanel.hScrollBar.on(Laya.Event.CHANGE,this,this.onScrollChange)},o.prototype.setSize=function(t,e){n.prototype.setSize.call(this,t,e),this.itemPanel.width=t,this.itemPanel.height=e,this.lbDesc.y=GameUtil.isFullScreen()?i.HudModel.TOP_ADD_HEIGHT+140:140},o.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},o.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},o.prototype.onClosed=function(){n.prototype.onClosed.call(this),Laya.timer.clearAll(this);for(var t=0;t<o.BOX_NUM;t++){var e=this["ui_red_"+t];e&&e.onDispose()}this.ani1.stop(),UIMgr.hideUIByName(UIConst.SysTopView),this.itemPanel.hScrollBar.value=0,this.uiScene.onExit()},o.prototype.initView=function(){var t=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:t,funList:null,closeCallback:this.onFanHui.bind(this)});for(var e=0;e<o.BOX_NUM;e++){var i=this["ui_red_"+e];i&&i.setRedPointName("dailyCoyp_tab"+this._overPlusTypeKey[e])}this.itemPanel.hScrollBar.value=0,Laya.timer.frameOnce(2,this,this.delayScroll),this.ani1.play(0,!0),this.uiScene.onShow()},o.prototype.delayScroll=function(){var t=this;this.addGuangEff(),Laya.timer.frameOnce(1,this,function(){t.itemPanel.scrollTo(180)})},o.prototype.onClickBox=function(t){var e=iface.tb_prop.dailyCopyTypeKey.gold;1==t?e=iface.tb_prop.dailyCopyTypeKey.exp:2==t&&(e=iface.tb_prop.dailyCopyTypeKey.chip),UIMgr.showUI(UIConst.Copy_DailyView,e)},o.prototype.onFanHui=function(){dispatchEvt(new i.HudEvent(i.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_LILIAN))},o.prototype.addGuangEff=function(){var e=this,t=this.img_box_0.localToGlobal(new Laya.Point(0,0)),i=this.uiScene.get3dPos(t.x+150-Launch.offsetX,t.y+120-Launch.offsetY);this.uiScene.addEffect(this,1000008,i,3,30,function(t){e._coinEff1&&e.uiScene.removeEffect(e._coinEff1),e._coinEff1=t}),t=this.img_box_1.localToGlobal(new Laya.Point(0,0)),i=this.uiScene.get3dPos(t.x+150-Launch.offsetX,t.y+120-Launch.offsetY),this.uiScene.addEffect(this,1000008,i,3,30,function(t){e._coinEff2&&e.uiScene.removeEffect(e._coinEff2),e._coinEff2=t}),t=this.img_box_2.localToGlobal(new Laya.Point(0,0)),i=this.uiScene.get3dPos(t.x+150-Launch.offsetX,t.y+120-Launch.offsetY),this.uiScene.addEffect(this,1000008,i,3,30,function(t){e._coinEff3&&e.uiScene.removeEffect(e._coinEff3),e._coinEff3=t})},o.prototype.onScrollChange=function(){this.itemPanel.hScrollBar&&(this.uiScene.x=-this.itemPanel.hScrollBar.value)},o.BOX_NUM=3,o);function o(){var t=n.call(this)||this;return t._overPlusTypeKey=[iface.tb_prop.overplusTypeKey.dailyCopyNum1,iface.tb_prop.overplusTypeKey.dailyCopyNum2,iface.tb_prop.overplusTypeKey.dailyCopyNum3],t.group=UIConst.hud_group,t}i.DailyCopyMainView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.dailycopy.DailyCopyIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.lb_difficulty.text=t.tbCopy.name,this.lb_difficulty.color=ColorConst.getDailyCopyColor(t.subType),this.list_items.array=t.tbCopy.getRewardList(),this.btn_fight.skin=SkinUtil.buttonNormal,this.lab_cost.strokeColor=ColorConst.ORANGE_FILTER,t.isLvLimit()?(this.btn_fight.gray=!0,this.box_cost.visible=!1,this.btn_fight.labelPadding=null,this.btn_fight.label=LanMgr.getLan("",10104),this.btn_fight.labelStrokeColor=ColorConst.getDailyCopyBtnStroke(!0),this.lb_limit.visible=!0,this.lb_limit.text=LanMgr.getLan("",12493,t.tbCopy.level),tl3d.ModuleEventManager.removeEvent(e.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateCount,this)):(App.hero.isPassDailyCopy(t.tbCopy.ID)?(this.btn_fight.skin=SkinUtil.buttonGreen,this.btn_fight.labelStrokeColor=ColorConst.GREEN_FILTER,this.lab_cost.strokeColor=ColorConst.GREEN_FILTER,this.btn_fight.label=LanMgr.getLan("",12494)):(this.btn_fight.label=LanMgr.getLan("",12292),this.btn_fight.labelStrokeColor=ColorConst.getDailyCopyBtnStroke(!1)),this.btn_fight.gray=!1,this.lb_limit.visible=!1,this.updateCount(),tl3d.ModuleEventManager.addEvent(e.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateCount,this)),this.btn_fight.on(Laya.Event.CLICK,this,this.onClick)):tl3d.ModuleEventManager.removeEvent(e.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateCount,this)},n.prototype.updateCount=function(){if(App.hero.getOverplusValue(this.dataSource.getOverplusType())<=0){this.box_cost.visible=!0;var t=e.DailyCopyModel.getInstance().getBuyCost(this.dataSource.getLimitType());this.lab_cost.text=t+"",99<t?(this.btn_fight.labelPadding="0,0,0,36",this.box_cost.x=453):(this.btn_fight.labelPadding="0,0,0,28",this.box_cost.x=457)}else this.box_cost.visible=!1,this.btn_fight.labelPadding=null},n.prototype.onClick=function(){dispatchEvt(new e.DailyEvent(e.DailyEvent.CHALLENGE_BOSS,this.dataSource))},n);function n(){return t.call(this)||this}e.DailyCopyIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.dailycopy.DailyCopyBuyUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this)},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.btnBuy.off(Laya.Event.CLICK,this,this.onBuy),this.btnCancel.off(Laya.Event.CLICK,this,this.onCancel)},e.prototype.initView=function(){var t=o.DailyCopyModel.getInstance(),e=this.dataSource;this.bgPanel.dataSource={uiName:UIConst.Copy_DailyBuyView,closeOnSide:this.isModelClose};var i=t.getLimitType(e);this.btnBuy.on(Laya.Event.CLICK,this,this.onBuy),this.btnCancel.on(Laya.Event.CLICK,this,this.onCancel),this.lbCost.text=t.getBuyCost(i).toString();var n=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum)-App.hero.getlimitValue(i);this.lbCount.text=LanMgr.getLan("",10106,n)},e.prototype.onBuy=function(){dispatchEvt(new o.DailyEvent(o.DailyEvent.BUY_DAILY_COPY_COUNT,this.dataSource))},e.prototype.onCancel=function(){UIMgr.hideUIByName(UIConst.Copy_DailyBuyView)},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t}o.DailyCopyBuyView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"DailyCopyProcessor"},i.prototype.listenModuleEvents=function(){return[new s.DailyEvent(s.DailyEvent.SHOW_DAILY_COPY_VIEW),new s.DailyEvent(s.DailyEvent.CHALLENGE_BOSS),new s.DailyEvent(s.DailyEvent.CHALLENGE_BOSS_AGAIN),new s.DailyEvent(s.DailyEvent.SHOW_BUY_VIEW),new s.DailyEvent(s.DailyEvent.BUY_DAILY_COPY_COUNT)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof s.DailyEvent)switch(t.type){case s.DailyEvent.SHOW_DAILY_COPY_VIEW:this.showMainView(t.data);break;case s.DailyEvent.CHALLENGE_BOSS:case s.DailyEvent.CHALLENGE_BOSS_AGAIN:this.challengeBoss(t.data);break;case s.DailyEvent.SHOW_BUY_VIEW:this.showBuyView(t.data);break;case s.DailyEvent.BUY_DAILY_COPY_COUNT:}},i.prototype.showMainView=function(t){UIMgr.showUI(UIConst.Copy_DailyMainView,t)},i.prototype.challengeBoss=function(t){var e=this;if(!UIUtil.checkUnableToEnterFight())if(t.isLvLimit())showToast(LanMgr.getLan("",10104));else{if(App.hero.getOverplusValue(t.getOverplusType())<=0){if(UIUtil.checkNotEnough(iface.tb_prop.resTypeKey.diamond,s.DailyCopyModel.getInstance().getBuyCost(t.getLimitType())))return void showToast(LanMgr.getLan("",10105));if(App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum)-App.hero.getlimitValue(t.getLimitType())<=0)return void(App.hero.vip<tb.TB_vip.getMaxVip()?showToast(LanMgr.getLan("",10082)):showToast(LanMgr.getLan("",10260)))}if(App.hero.isPassDailyCopy(t.tbCopy.ID)){var i={};i[Protocol.game_copy_dailyCopySweep.args.copyId]=t.tbCopy.ID,i[Protocol.game_copy_dailyCopySweep.args.num]=1,PLC.request(Protocol.game_copy_dailyCopySweep,i,function(t){t&&(e.dailyCopyView&&e.dailyCopyView.updateView(),UIUtil.showRewardView(t.commonData))})}else this.doFight(t)}},i.prototype.doFight=function(n){var o=this,a=new s.FightVo;a.copyType=CopyType.dailycopy,a.dailyCopyInfo=n;var t=new battle.BattleScenePve(a.copyType);t.init([a.getOwnTeam()],a.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.monster,a.getAllRound(),a.getTeamHp()),t.start();var e=t.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",e,"战报：",t.battleReport);var i=new s.NewClientPage;i.result=e?playState.VICTORY:playState.FAILURE,i.initPage(t.battleReport),i.defType=iface.tb_prop.battleObjTypeKey.monster,a.fightPageControl=i;var r={};r[Protocol.game_copy_dailyCopyBattle.args.copyId]=n.tbCopy.ID,r[Protocol.game_copy_dailyCopyBattle.args.isWin]=e,PLC.request(Protocol.game_copy_dailyCopyBattle,r,function(t,e){if(t){a.resultData=t,o.dailyCopyView&&o.dailyCopyView.updateView();var i={vo:a,event:new s.DailyEvent(s.DailyEvent.SHOW_DAILY_COPY_VIEW),eventdata:n.getCopyType()};dispatchEvt(new s.FightsEvent(s.FightsEvent.ENTER_FIGHT_EVENT),i)}})},i.prototype.showBuyView=function(i){var n=this,t=s.DailyCopyModel.getInstance(),e=t.getLimitType(i);UIUtil.checkNotEnough(iface.tb_prop.resTypeKey.diamond,t.getBuyCost(e))?showToast(LanMgr.getLan("",10105)):App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum)-App.hero.getlimitValue(e)<=0?App.hero.vip<tb.TB_vip.getMaxVip()?showToast(LanMgr.getLan("",10082)):showToast(LanMgr.getLan("",10260)):UIMgr.showUI(UIConst.BuyBattleCount,{type:t.getBuyBattleType(i),callback:function(t){var e={};e[Protocol.game_common_buyDailyCopyBattleCnt.args.type]=i,e[Protocol.game_common_buyDailyCopyBattleCnt.args.count]=t,PLC.request(Protocol.game_common_buyDailyCopyBattleCnt,e,function(t){t&&(n.dailyCopyView&&n.dailyCopyView.updateView(),UIMgr.hideUIByName(UIConst.Copy_DailyBuyView))})}})},Object.defineProperty(i.prototype,"dailyCopyView",{get:function(){return UIMgr.getUIByName(UIConst.Copy_DailyView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}s.DailyCopyProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"DailyCopyModule"},n.prototype.listProcessors=function(){return[new t.DailyCopyProcessor]},n.prototype.onRegister=function(){t.DailyCopyModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.DailyCopyModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_DAILY_COPY_VIEW="SHOW_DAILY_COPY_VIEW",r.SHOW_BUY_VIEW="SHOW_BUY_VIEW",r.CHALLENGE_BOSS="CHALLENGE_DAILY_BOSS",r.CHALLENGE_BOSS_AGAIN="CHALLENGE_BOSS_AGAIN",r.BUY_DAILY_COPY_COUNT="BUY_DAILY_COPY_COUNT",r.DAILY_COPY_ID_CHANGE="DAILY_COPY_ID_CHANGE",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.DailyEvent=a}(game=game||{});var copymodule;__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(o){var t=(a.getInstance=function(){return this._instance||(this._instance=new a),this._instance},a.prototype.initModel=function(){this._copyList=[];var t=TableData.getInstance().getTableByName(TableData.tb_daily_copy).data;for(var e in t)this._copyList.push(new o.DailyCopyInfoVo(t[e]));for(var e in iface.tb_prop.dailyCopyTypeKey){var i=Number(e);if(!isNaN(i)){var n=this.getCopyListByType(i);n[0].isFirst=!0,n[n.length-1].isLast=!0}}a.COPY_NAME[iface.tb_prop.dailyCopyTypeKey.gold]=LanMgr.getLan("",12490),a.COPY_NAME[iface.tb_prop.dailyCopyTypeKey.exp]=LanMgr.getLan("",12491),a.COPY_NAME[iface.tb_prop.dailyCopyTypeKey.chip]=LanMgr.getLan("",12492)},a.prototype.getCopyList=function(){return this._copyList},a.prototype.getCopyListByType=function(e){var t=this._copyList.filter(function(t){return t.type==e});return(t=__spreadArrays(t)).forEach(function(t){t.sortNum=t.tbCopy.ID}),t.sort(function(t,e){return t.sortNum-e.sortNum}),t},a.prototype.canRedPoint=function(t){return!!App.IsSysOpen(ModuleConst.DAILY_COPY)&&!!App.IsSysOpen(ModuleConst.DAILY_COPY)&&0<App.hero.getOverplusValue(t)},a.prototype.getCopyById=function(e){return this._copyList.find(function(t){return t.tbCopy.ID==e})},a.prototype.getNextCopy=function(t){var e=this.getCopyListByType(t.type),i=e.indexOf(t);return e[i+1]},a.prototype.getPrevCopy=function(t){var e=this.getCopyListByType(t.type),i=e.indexOf(t);return e[i-1]},a.prototype.getBuyCost=function(t){var e=tb.TB_copy_set.getCopySet().daily_copy_cost,i=App.hero.getlimitValue(t);return i>=e.length?e[e.length-1]:e[i]},a.prototype.isHasChallenge=function(t){var e=tb.TB_copy_set.getCopySet().daily_copy_num;return App.hero.getOverplusValue(a.getInstance().getOverplusType(iface.tb_prop.dailyCopyTypeKey.gold))<e},a.prototype.getOverplusType=function(t){return t==iface.tb_prop.dailyCopyTypeKey.gold?iface.tb_prop.overplusTypeKey.dailyCopyNum1:t==iface.tb_prop.dailyCopyTypeKey.exp?iface.tb_prop.overplusTypeKey.dailyCopyNum2:iface.tb_prop.overplusTypeKey.dailyCopyNum3},a.prototype.getLimitType=function(t){return t==iface.tb_prop.dailyCopyTypeKey.gold?iface.tb_prop.limitTypeKey.buyDailyCopyNum1:t==iface.tb_prop.dailyCopyTypeKey.exp?iface.tb_prop.limitTypeKey.buyDailyCopyNum2:iface.tb_prop.limitTypeKey.buyDailyCopyNum3},a.prototype.getBuyBattleType=function(t){return t==iface.tb_prop.dailyCopyTypeKey.gold?common.BuyBattleCountView.TYPE_DAILYCOPY_ONE:t==iface.tb_prop.dailyCopyTypeKey.exp?common.BuyBattleCountView.TYPE_DAILYCOPY_TWO:common.BuyBattleCountView.TYPE_DAILYCOPY_THREE},a.COPY_NAME={},a);function a(){}o.DailyCopyModel=t}(game=game||{}),function(t){var e=(i.prototype.isLvLimit=function(){return App.hero.level<this.tbCopy.level},i.prototype.getCopyName=function(){return t.DailyCopyModel.COPY_NAME[this.type]+"："+this.tbCopy.name},i.prototype.getOverplusType=function(){return this.type==iface.tb_prop.dailyCopyTypeKey.gold?iface.tb_prop.overplusTypeKey.dailyCopyNum1:this.type==iface.tb_prop.dailyCopyTypeKey.exp?iface.tb_prop.overplusTypeKey.dailyCopyNum2:iface.tb_prop.overplusTypeKey.dailyCopyNum3},i.prototype.getLimitType=function(){return this.type==iface.tb_prop.dailyCopyTypeKey.gold?iface.tb_prop.limitTypeKey.buyDailyCopyNum1:this.type==iface.tb_prop.dailyCopyTypeKey.exp?iface.tb_prop.limitTypeKey.buyDailyCopyNum2:iface.tb_prop.limitTypeKey.buyDailyCopyNum3},i.prototype.getCopyType=function(){return this.type},i);function i(t){this.isFirst=!1,this.isLast=!1,this.tbCopy=t,this.type=Math.floor(t.ID/100),this.subType=t.ID%10}t.DailyCopyInfoVo=e}(game=game||{}),function(t){var e=(i.copyOpen=function(t,e){if(t.length<=0)return{isopen:!1,info:LanMgr.getLan("",10316),condition:null};for(var i=0;t&&i<t.length;i++){var n=t[i];if(n[0]==CopyConditionType.id){if(e<n[1])return{isopen:!1,info:LanMgr.getLan("",11001),condition:n}}else if(n[0]==CopyConditionType.level){if(n[1]>App.hero.level)return{isopen:!1,info:LanMgr.getLan("",11002,n[1]),condition:n}}else if(n[0]==CopyConditionType.power&&n[1]>App.hero.force)return{isopen:!1,info:LanMgr.getLan("",11004,n[1]),condition:n}}return{isopen:!0,info:"",condition:null}},i);function i(){}t.CopyUtils=e}(copymodule=copymodule||{}),function(l){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initStorage=function(){var t=Laya.LocalStorage.getJSON(l.ChatModel.STORAGE_KEY);if(t){var e=l.FriendModel.getInstance();for(var i in l.ChatModel.getInstance(),t)e.isMyFriend(i)?this.parseStorage(i,t[i]):(t[i]=null,delete t[i]);Laya.LocalStorage.setJSON(l.ChatModel.STORAGE_KEY,t)}},e.prototype.delStorage=function(t){var e=Laya.LocalStorage.getJSON(l.ChatModel.STORAGE_KEY);e&&e[t]&&(e[t]=null,delete e[t],Laya.LocalStorage.setJSON(l.ChatModel.STORAGE_KEY,e))},e.prototype.resetStorage=function(){for(var t=[],e=0,i=l.ChatModel.getInstance().getPrivateChatMap().values;e<i.length;e++)(r=i[e]).hasChat()&&r.isMyFriend()&&t.push(r);t.sort(function(t,e){return e.lastTime-t.lastTime}),t.length>l.ChatModel.SAVE_PEOPLE_COUNT&&(t=t.slice(0,l.ChatModel.SAVE_PEOPLE_COUNT));for(var n={},o=0,a=t;o<a.length;o++){var r;n[(r=a[o]).playerId]=this.createStorageData(r.getChatList())}Laya.LocalStorage.setJSON(l.ChatModel.STORAGE_KEY,n)},e.prototype.createStorageData=function(t){for(var e=[],i=t.length-1,n=1;0<=i&&!(n>l.ChatModel.SAVE_CHAT_COUNT);i--,n++){var o=t[i],a=o.isSelf()?1:2;e.push([a,o.svo.content,o.svo.time])}return e},e.prototype.parseStorage=function(t,e){for(var i=l.ChatModel.getInstance().createPrivateChatInfo(t),n=l.FriendModel.getInstance().getFriendById(t),o=0,a=e;o<a.length;o++){var r=a[o],s=1==r[0],u={senderName:s?App.hero.name:n.name,senderId:s?App.hero.playerId:n.playerId,receiveId:s?n.playerId:App.hero.playerId,receiveName:s?n.name:App.hero.name,senderLevel:s?App.hero.level:n.level,senderHead:s?App.hero.getHeadId():n.head,senderHeadFrame:s?App.hero.headFrame:n.headFrame,time:r[2],content:r[1],city:LanMgr.getLan("",12230),type:iface.tb_prop.chatTypeKey.text},h=new l.ChatInfoVo(u,iface.tb_prop.chatChannelTypeKey.whisper);i.addStorageChat(h)}},e);function e(){}l.PrivateChatStorage=t}(game=game||{}),function(e){var t=(i.prototype.addStorageChat=function(t){this._chatList.push(t),this.lastTime=t.svo.time,this._chatList.sort(function(t,e){return t.svo.time-e.svo.time})},i.prototype.addChat=function(t){this._chatList.push(t),this.lastTime=t.svo.time,t.isSelf()||this.newNum++,dispatchEvt(new e.ChatEvent(e.ChatEvent.ADD_PRIVATE_CHAT,[this.playerId,t]))},i.prototype.resetNewNum=function(t){this.newNum=0,dispatchEvt(new e.ChatEvent(e.ChatEvent.UPDATE_PRIVATE_CHAT))},i.prototype.getChatList=function(){return this._chatList},i.prototype.hasChat=function(){return 0<this._chatList.length},i.prototype.isMyFriend=function(){return e.FriendModel.getInstance().isMyFriend(this.playerId)},i.prototype.isExitChat=function(e,i){return this._chatList.some(function(t){return t.svo.senderId==e&&t.svo.time==i})},i);function i(t){this.newNum=0,this.playerId=t,this._chatList=[],this.lastTime=(new Date).getTime()}e.PrivateChatInfoVo=t}(game=game||{}),function(i){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.startAutoRequest=function(t,e){void 0===e&&(e=!1),Laya.timer.clear(this,this.onRequest),Laya.timer.loop(5e3,this,this.onRequest,[t]),e&&this.onRequest(t)},e.prototype.onRequest=function(t){if((t!=iface.tb_prop.chatChannelTypeKey.guild||i.GuildModel.getInstance().isHasGuild())&&(t!=iface.tb_prop.chatChannelTypeKey.group||i.GodDomainModel.getInstance().isOpen())){var e={};e[Protocol.chat_chat_list.args.channel]=t,PLC.request(Protocol.chat_chat_list,e,function(t){t&&i.ChatModel.getInstance().updateChatList(t)},!1)}},e.prototype.stopRequest=function(){Laya.timer.clear(this,this.onRequest)},e);function e(){}i.ChatThread=t}(game=game||{}),function(u){var t=(e.prototype.getContent=function(){if(!this._content){if(this.svo.type==iface.tb_prop.chatTypeKey.notice){var t=u.ChatNoticeMgr.getInstance().getNoticeText(JSON.parse(this.content),!0);this._content=this.formatHtmlText(t)}else this._content=this.formatHtmlText(this.content);this._htmlReg.test(this._content)||0!=this._content.indexOf("<")||(this._content="*"+this._content.slice(1))}return this._content},e.prototype.getSimpleCt=function(t){if(void 0===t&&(t=20),!this._simpleCt){if(this.svo.type==iface.tb_prop.chatTypeKey.notice){var e=u.ChatNoticeMgr.getInstance().getNoticeText(JSON.parse(this.content),!1),i=e.replace(/<\/?.+?\/?>/gi,"");if(i.length>t){for(var n=i.slice(t),o=n.length-1;0<=o;o--)if(127<n.charCodeAt(o)){var a=e.lastIndexOf(n[o]);-1!=a&&(e=e.substring(0,a)+e.substring(a+1))}e+="..."}return this._simpleCt=this.formatHtmlText(e),this._simpleCt}this._simpleCt=this.formatHtmlText(this.content,!0),this._simpleCt=this._simpleCt.length>=t?this._simpleCt.slice(0,t)+"...":this._simpleCt,this._htmlReg.test(this._simpleCt)||0!=this._simpleCt.indexOf("<")||(this._simpleCt="*"+this._simpleCt.slice(1))}return this._simpleCt},e.prototype.getChannelColor=function(){if(this.isSystem())return ColorConst.RED;switch(this.channel){case iface.tb_prop.chatChannelTypeKey.world:return ColorConst.CHAT_WORLD;case iface.tb_prop.chatChannelTypeKey.guild:return ColorConst.CHAT_GUILD;case iface.tb_prop.chatChannelTypeKey.province:return ColorConst.CHAT_PROVINCE;case iface.tb_prop.chatChannelTypeKey.crossServer:return ColorConst.CHAT_CROSS_SVR;default:return ColorConst.RED}},e.prototype.getName=function(){return this.isSystem()?LanMgr.getLan("",10040):this.svo.senderName},e.prototype.getFriendId=function(){return this.channel!=iface.tb_prop.chatChannelTypeKey.whisper?"":this.svo.senderId==App.hero.playerId?this.svo.receiveId:this.svo.senderId},e.prototype.getCity=function(){return this.svo.city||LanMgr.getLan("",12230)},e.prototype.isSelf=function(){return this.svo.senderId==App.hero.playerId},e.prototype.isSystem=function(){return!this.svo.senderId||""==this.svo.senderId},e.prototype.getTitleColor=function(){return ColorConst.normalFont},e.prototype.getContentColor=function(){return ColorConst.normalFont},e.prototype.formatHtmlText=function(t,e){void 0===e&&(e=!1);var i=this.formatStrToArr(t,new RegExp("##[0-9]{2}","g")),n=[];this.hasImg=1<i.length;for(var o=0,a=i.length;o<a;o++)n.push(i[o]);var r="";for(o=0,a=n.length;o<a;o++){var s=n[o];e?u.ChatModel.isExpression(s)?r+="["+LanMgr.getLan("",12497)+"]":r+=s:u.ChatModel.isExpression(s)?r+="<img style='padding:-10px -3px 0 -3px;' src='"+u.ChatModel.getExpressionUrl(s)+"' ></img>":r+=""+s}return r},e.prototype.formatStrToArr=function(t,e){for(var i,n=[],o=[];i=e.exec(t);)n.push(i);for(var a=0,r=0,s=n.length;r<s;r++){var u=n[r],h=u.index,l=u[0].length;a<h&&o.push(t.substring(a,h)),o.push(t.substring(h,h+l)),a=h+l}return t.length>a&&o.push(t.substring(a)),o},e);function e(t,e){this._htmlReg=/<\/?.+?\/?>/gi,this.hasImg=!1,this.svo=t,this.channel=e;var i=this.isSystem();this.content=i?t.content:doShield1(t.content),this.channelName="",this.channelName=i?LanMgr.getLan("",12496):LanMgr.channelNames[this.channel],this.headVo=i?null:new UserHeadVo(t.senderHead,t.senderLevel,t.senderHeadFrame)}u.ChatInfoVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.chat.PrivateChatUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._buffList=new common.BuffRenderList(this.chatBox.width,this.chatBox.height,null,50,2,!1),this._buffList.isAutoScroll=!0,this._buffList.spaceY=10,this._buffList.itemRender=e.ChatIR,this._buffList.itemRenderWidth=this.chatBox.width,this.chatBox.addChild(this._buffList),this.friendList.mouseHandler=new Handler(this,this.onSelect),this.friendList.renderHandler=new Handler(this,this.onRender)},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._buffList.removeAll(),this._curPrivateChat=null,this._curIdx=-1,this.friendList.selectedIndex=-1,this.friendList.array=null,this.faceUI.onExit(),dispatchEvt(new e.ChatEvent(e.ChatEvent.STOP_REQUEST_PRIVATE_CHAT)),tl3d.ModuleEventManager.removeEvent(e.ChatEvent.ADD_PRIVATE_CHAT,this.addNewChat,this),tl3d.ModuleEventManager.removeEvent(e.ChatEvent.NEW_PERSON_PRIVATE_CHAT,this.addNewPersonChat,this),this.btnFace.off(Laya.Event.CLICK,this,this.onFace),this.btnSend.off(Laya.Event.CLICK,this,this.onSend),this.textInput.off(Laya.Event.ENTER,this,this.onSend),this.bgPanel.dataSource=null},n.prototype.initView=function(){var t=e.ChatModel.getInstance().getPrivateChatList();0<(this.friendList.array=t).length&&this.renderePrivateChat(0,t[0]),this.bgPanel.dataSource={uiName:UIConst.Chat_SiliaoView,closeOnSide:this.isModelClose,closeOnButton:!1,title:LanMgr.getLan("",12498)},this.faceUI.onEnter(this.clickFaceCb.bind(this)),this.btnFace.on(Laya.Event.CLICK,this,this.onFace),this.btnSend.on(Laya.Event.CLICK,this,this.onSend),this.textInput.on(Laya.Event.ENTER,this,this.onSend),tl3d.ModuleEventManager.addEvent(e.ChatEvent.ADD_PRIVATE_CHAT,this.addNewChat,this),tl3d.ModuleEventManager.addEvent(e.ChatEvent.NEW_PERSON_PRIVATE_CHAT,this.addNewPersonChat,this),dispatchEvt(new e.ChatEvent(e.ChatEvent.START_REQUEST_PRIVATE_CHAT))},n.prototype.onSelect=function(t,e){if(t.type==Laya.Event.CLICK){if(this._curIdx==e)return;this.renderePrivateChat(e)}},n.prototype.renderePrivateChat=function(t,e){void 0===e&&(e=null);var i=this.friendList.getCell(t);i&&(this._curIdx=t,this.friendList.selectedIndex=t,this._curPrivateChat=i.dataSource?i.dataSource:e,this._curPrivateChat&&(this._curPrivateChat.resetNewNum(!1),i.updateRedPoint(),this._buffList.dataSource=[].concat(this._curPrivateChat.getChatList()),this._buffList.isAutoScroll=!0,this._buffList.updateScrollMaxForce()))},n.prototype.addNewChat=function(t){if(this._curPrivateChat){var e=t.data[0],i=t.data[1];if(i&&this._curPrivateChat&&this._curPrivateChat.playerId==e)this._curPrivateChat.resetNewNum(!1),this._buffList.addItem(i),this._buffList.isAutoScroll&&this._buffList.updateScrollMaxForce();else for(var n=0,o=this.friendList.cells;n<o.length;n++)o[n].updateRedPoint()}},n.prototype.addNewPersonChat=function(t){for(var e=0,i=t.data;e<i.length;e++){var n=i[e];this.friendList.addItem(n)}this.friendList.refresh(),this._curIdx&&this.renderePrivateChat(this._curIdx)},n.prototype.delItem=function(e){var t=this.friendList.cells.findIndex(function(t){return e==t});-1!=t&&(this.friendList.deleteItem(t),t==this._curIdx&&(this._buffList.removeAll(),this._curIdx=-1,this.friendList.selectedIndex=-1,this._curPrivateChat=null)),0==this.friendList.length&&this.close()},n.prototype.clickFaceCb=function(t){this.textInput.text+=t.id},n.prototype.onFace=function(){this.faceUI.onOpenOrHide()},n.prototype.onRender=function(t,e){e>this.friendList.length||(t.btn_select.selected=e==this.friendList.selectedIndex)},n.prototype.onSend=function(){this._curPrivateChat&&dispatchEvt(new e.ChatEvent(e.ChatEvent.SEND_PRIVATE_CHAT,[this._curPrivateChat.playerId,this.textInput.text]))},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}e.PrivateChatView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.chat.PrivateChatIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;if(t){var e=i.FriendModel.getInstance().getFriendById(t.playerId);e&&(this.headBox.dataSource=new UserHeadVo(e.head,e.level,e.headFrame),this.lab_name.text=e.name),this.updateRedPoint(),this.btnDel.on(Laya.Event.CLICK,this,this.onDel)}else this.btnDel.off(Laya.Event.CLICK,this,this.onDel)},n.prototype.updateRedPoint=function(){var t=this.dataSource;t&&(this.redpoint.visible=0<t.newNum)},n.prototype.onDel=function(){dispatchEvt(new i.ChatEvent(i.ChatEvent.DEL_PRIVATE_CHAT,this))},n);function n(){return t.call(this)||this}i.PrivateChatIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.chat.FaceUI,__extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.faceList.array=null,this.faceList.renderHandler=new Handler(this,this.onBqRender),this.faceList.mouseHandler=new Handler(this,this.onBqClick)},n.prototype.onEnter=function(t,e){void 0===e&&(e=null),this.faceList.array=i.ChatModel.getInstance().getBqList(),this.visible=!1,(this._selectSp=e)&&(e.visible=!1),this._callback=t},n.prototype.onBqRender=function(t,e){var i=t.dataSource;t.skin=i?i.url:null},n.prototype.onBqClick=function(t){var e=t.currentTarget.dataSource;t.type==Laya.Event.CLICK&&(this._callback&&this._callback(e),this.onOpenOrHide())},n.prototype.onOpenOrHide=function(){var t=this;this.visible=!this.visible,this.visible?(Laya.timer.callLater(this,function(){t.stage.on(Laya.Event.CLICK,t,t.onClickView)}),this._selectSp&&(this._selectSp.visible=!0)):(this.stage.off(Laya.Event.CLICK,this,this.onClickView),this._selectSp&&(this._selectSp.visible=!1))},n.prototype.onClickView=function(t){t.target!=this&&this.onOpenOrHide()},n.prototype.onExit=function(){this.faceList.array=null,this._callback=null,this.stage.off(Laya.Event.CLICK,this,this.onClickView)},n);function n(){return t.call(this)||this}i.FaceView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var i,t=(i=ui.chat.ChatUI,__extends(e,i),e.prototype.initialize=function(){i.prototype.initialize.call(this);var t=DialogExt.manager;this.popupEffect=t.leftPopupEffHandler,this.closeEffect=t.leftCloseEffHandler,this.popupCenter=!1,this.centerY=-60,this.isModelClose=!0},e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this._openType=-1,this.width=this.bg.width=Math.min(Laya.stage.width,910);var t=this.bg.width-this.chatBox.left-this.chatBox.right;this._buffList=new common.BuffRenderList(t,this.chatBox.height,null,50,2,!1),this._buffList.isAutoScroll=!0,this._buffList.spaceY=10,this._buffList.itemRender=r.ChatIR,this._buffList.itemRenderWidth=t-20<580?580:t-20,this._buffList.setScrollChangeHandler(this.onScrollChange,this),this.chatBox.addChild(this._buffList),this.tabList.selectHandler=new Handler(this,this.onTabSelect),this.tabList.renderHandler=new Handler(this,this.onTabRender),this.tabList.selectedIndex=-1,this.btnClose.on(Laya.Event.CLICK,this,this.onExit),this.btnFace.on(Laya.Event.CLICK,this,this.onFaceOpenOrHide),this.btnQuick.on(Laya.Event.CLICK,this,this.onQuickOpenOrHide),this.btnSend.on(Laya.Event.CLICK,this,this.onSend),this.imgScroll.on(Laya.Event.CLICK,this,this.scrollToBottom),this.textInput.on(Laya.Event.ENTER,this,this.onSend)},e.prototype.close=function(){i.prototype.close.call(this),this._openType=-1,this.tabList.array=null,this.tabList.selectedIndex=-1,this.faceUI.onExit(),this.quickUI.onExit()},e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){this.faceUI.onEnter(this.clickFaceCb.bind(this),this.imgFace),this.quickUI.onEnter(this.clickQuickCb.bind(this),this.imgQuick),this.imgScroll.visible=!1;var t=this.dataSource?this.dataSource:[];this._openType=isNaN(t[0])?r.OpenType.common:t[0];var e=isNaN(t[1])?0:t[1],i=r.ChatModel.getInstance(),n=i.getIndexByChannel(e);n=0<=n?n:0,this.tabList.array=i.getTabbarDatas(this._openType),this.tabList.selectedIndex=n},e.prototype.onTabSelect=function(t){if(-1!=t){this.imgScroll.visible=!1,this._buffList.removeAll();var e=r.ChatModel.getInstance(),i=e.getChannelByIndex(this.tabList.selectedIndex),n=e.getChatListByType(i);this._buffList.dataSource=n.concat(),this._buffList.isAutoScroll=!0,this._buffList.updateScrollMaxForce();var o=App.getOpenValue(ModuleConst.CHAT);this.textInput.prompt=0==t||1==t?App.hero.level>=o?this.defaultText:LanMgr.getLan("",11017,o):this.defaultText,e.resetNewNum(i);var a=i==iface.tb_prop.chatChannelTypeKey.system;this.btnQuick.visible=this.btnFace.visible=this.btnSend.visible=this.bgInput.visible=!a,this.imgFace.visible=this.imgQuick.visible=!1,this.tabList.refresh()}},e.prototype.addNewChats=function(t){if(this._buffList&&t&&0!=t.length){for(var e=t.length,i=0;i<e;i++)this._buffList.addItem(t[i]);this._buffList.isAutoScroll?this._buffList.updateScrollMaxForce():this.imgScroll.visible=!0}},e.prototype.onTabRender=function(t,e){if(t){var i=this.tabList.selectedIndex,n=t.btnChannel;n.selected=e==i,n.labelSize=e==i?26:22,n.labelColors=e==i?"#7e5336,#7e5336,#7e5336":"#e6ca91,#e6ca91,#e6ca91"}},e.prototype.updateNewChatNum=function(){var t=r.ChatModel.getInstance(),e=t.getChannelByIndex(this.tabList.selectedIndex);t.resetNewNum(e),this.tabList.refresh()},e.prototype.afterSend=function(){this._buffList.isAutoScroll=!0,this.imgScroll.visible=!1,this.textInput.text=""},e.prototype.onScrollChange=function(t,e){t>=this._buffList.scrollBar.max?(this._buffList.isAutoScroll=!0,this.imgScroll.visible=!1):this._buffList.isAutoScroll=!1},e.prototype.scrollToBottom=function(){this._buffList.isAutoScroll=!0,this.imgScroll.visible=!1,this._buffList.updateScrollMaxForce()},e.prototype.onSend=function(){dispatchEvt(new r.ChatEvent(r.ChatEvent.SEND_CHAT_TEXT,[this.textInput.text,this.tabList.selectedIndex]))},e.prototype.clickFaceCb=function(t){this.textInput.text+=t.id},e.prototype.clickQuickCb=function(t){t&&(4!=t.ID||r.GuildModel.getInstance().isHasGuild()?dispatchEvt(new r.ChatEvent(r.ChatEvent.SEND_CHAT_TEXT,[t.desc,this.tabList.selectedIndex])):showToast(LanMgr.getLan("",10259)))},e.prototype.onFaceOpenOrHide=function(){this.faceUI.onOpenOrHide()},e.prototype.onQuickOpenOrHide=function(){this.quickUI.onOpenOrHide(),dispatchEvt(new r.ChatEvent(r.ChatEvent.SHORTCUTS_OPEN_OR_HIDE))},e.prototype.onExit=function(){UIMgr.hideUIByName(UIConst.ChatView)},e);function e(){var t=i.call(this)||this;return t.defaultText="                    "+LanMgr.getLan("",12499),t}r.ChatView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.chat.ChatTabIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;if(t){this.btnChannel.label=LanMgr.channelNames[t];var e=this._model.getNewNum(t);this.lbNum.visible=this.imgNum.visible=0<e,this.lbNum.text=e>i.ChatModel.MAX_COUNT?i.ChatModel.MAX_COUNT+"+":""+e}else this.lbNum.visible=this.imgNum.visible=!1},n);function n(){var t=e.call(this)||this;return t._model=i.ChatModel.getInstance(),t}i.ChatTabIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.chat.ChatQuickUI,__extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.lanList.renderHandler=new Handler(this,this.onRender),this.lanList.mouseHandler=new Handler(this,this.onClick)},n.prototype.onEnter=function(t,e){this.forbitHide=!1,this.visible=!1,(this._selectSp=e)&&(e.visible=!1),this._callback=t,this.lanList.array=tb.TB_chat_quick.getList()},n.prototype.onRender=function(t,e){var i=t.getChildByName("lbContent"),n=t.dataSource;n&&(i.text=n.desc)},n.prototype.onClick=function(t){var e=t.currentTarget,i=e.getChildByName("lbContent"),n=e.dataSource;t.type==Laya.Event.CLICK?(this._callback&&this._callback(n),this.onOpenOrHide()):t.type==Laya.Event.MOUSE_OVER||t.type==Laya.Event.ROLL_OVER?i.color=ColorConst.TASK_ORANGE:t.type!=Laya.Event.MOUSE_OUT&&t.type!=Laya.Event.ROLL_OUT||(i.color=ColorConst.WHITE)},n.prototype.onOpenOrHide=function(){var t=this;this.forbitHide&&this.visible||(this.visible=!this.visible,this.visible?(Laya.timer.callLater(this,function(){t.stage.on(Laya.Event.CLICK,t,t.onClickView)}),this._selectSp&&(this._selectSp.visible=!0)):(this.stage.off(Laya.Event.CLICK,this,this.onClickView),this._selectSp&&(this._selectSp.visible=!1)))},n.prototype.onClickView=function(t){t.target!=this.lanList&&this.onOpenOrHide()},n.prototype.onExit=function(){this.lanList.array=null,this._callback=null,this._selectSp&&(this._selectSp.visible=!1),this.stage.off(Laya.Event.CLICK,this,this.onClickView),this.forbitHide=!1},n);function n(){var t=e.call(this)||this;return t.forbitHide=!1,t}t.ChatQuickView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=ui.chat.ChatIRUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),i.prototype.refreshView=function(){var t=this.dataSource;if(t){if(this.lbName.color=t.getTitleColor(),this._htmlText.style.color=t.getContentColor(),this.lbChannel.text="【"+(t.channel==iface.tb_prop.chatChannelTypeKey.province?t.getCity():t.channelName)+"】",this.lbChannel.color=t.getChannelColor(),t.isSystem())this.lbName.text="",this.headBox.dataSource=null,this.imgBg.visible=this.headBox.visible=!1,this.lbChannel.x=10,this._htmlText.x=this.lbChannel.x+this.lbChannel.width,this._htmlText.y=this.lbChannel.y,this._htmlText.style.wordWrap=!0,this._htmlText.width=500,this._htmlText.innerHTML=t.getContent(),this.height=this._htmlText.y+this._htmlText.contextHeight+10;else{this.lbName.text=t.getName(),this.imgBg.visible=this.headBox.visible=!0,this.headBox.dataSource=t.headVo,this._htmlText.style.wordWrap=!1,this._htmlText.innerHTML=t.getContent();var e,i=this.width-145;this._htmlText.contextWidth>i&&(this._htmlText.style.wordWrap=!0,this._htmlText.width=i),this.imgBg.width=this._htmlText.contextWidth+30,e=(t.isSelf()?(this.headBox.x=this.width-this.headBox.width,this.imgBg.scaleX=-1,this.imgBg.skin=SkinUtil.chatBg2,this.imgBg.x=this.headBox.x-10,this.lbChannel.x=this.headBox.x-this.lbChannel.width,t.channel==iface.tb_prop.chatChannelTypeKey.whisper?(this.lbChannel.text="",this.lbName.x=this.headBox.x-this.lbName.width-10):this.lbName.x=this.lbChannel.x-this.lbName.width,this._htmlText.x=this.imgBg.x-this._htmlText.contextWidth-20):(this.headBox.x=0,this.imgBg.scaleX=1,this.imgBg.skin=SkinUtil.chatBg1,this.imgBg.x=this.lbChannel.x=this.headBox.x+this.headBox.width,t.channel==iface.tb_prop.chatChannelTypeKey.whisper?(this.lbChannel.text="",this.lbName.x=this.lbChannel.x):this.lbName.x=this.lbChannel.x+this.lbChannel.width,this._htmlText.x=this.imgBg.x+20),this._htmlText.y=this.imgBg.y+10,this.imgBg.height=this._htmlText.y+this._htmlText.contextHeight+5-this.imgBg.y,(e=this.imgBg.y+this.imgBg.height+5)>this.headBox.height?e:this.headBox.height),this.height=e}this.headBox.on(Laya.Event.CLICK,this,this.onShowPlayer)}else this.headBox.dataSource=null,this._htmlText.innerHTML="",this.headBox.off(Laya.Event.CLICK,this,this.onShowPlayer)},i.prototype.onLink=function(t){var i=JSON.parse(t),e=i.type;if(e==NoticeParamType.item)UIUtil.showItemTip(new ItemVo(i.id,i.num));else if(e==NoticeParamType.god){var n=tb.TB_item.get_TB_itemById(i.id);n&&UIUtil.showTip(n,0<i.num?{degree:i.num,starLevel:i.num}:null)}else if(e==NoticeParamType.rarityGod){var o=tb.TB_god.get_TB_godById(i.id);o&&UIUtil.showTip(o,{degree:i.num,starLevel:i.num})}else if(e==NoticeParamType.gotoGuildHelp)UIMgr.hideUIByName(UIConst.ChatView),dispatchEvt(new r.GuildEvent(r.GuildEvent.SHOW_GUILD_HELP_VIEW),1);else if(e==NoticeParamType.joinGuild){if(r.GuildModel.getInstance().isHasGuild())return void showToast(LanMgr.getLan("",10256));var a={};a[Protocol.guild_guild_apply.args.guildId]=i.guildId,PLC.request(Protocol.guild_guild_apply,a,function(t,e){if(t)return t.addMember?(showToast(LanMgr.getLan("",10257),i.guildName),UIMgr.hideUIByName(UIConst.ChatView),void dispatchEvt(new r.GuildEvent(r.GuildEvent.SHOW_GUILD_PANEL))):void showToast(LanMgr.getLan("",10258))})}else e==NoticeParamType.joinTeamGroup&&dispatchEvt(new r.CopyTeamEvent(r.CopyTeamEvent.APPLY_JOIN_TEAM),i.teamGroupId)},i.prototype.onShowPlayer=function(){var t=this.dataSource;if(t){var e=-1!=[iface.tb_prop.chatChannelTypeKey.province,iface.tb_prop.chatChannelTypeKey.crossServer].indexOf(t.channel);dispatchEvt(new r.HudEvent(r.HudEvent.SHOW_PLAYER_INFO_VIEW),{playerId:t.svo.senderId,hideAllBtn:e,isCrossSvr:e})}},i);function i(){var t=e.call(this)||this;return t.lbName.autoSize=!0,t.lbChannel.autoSize=!0,t._htmlText=new Laya.HTMLDivElement,t._htmlText.style.align="left",t._htmlText.style.fontSize=23,t._htmlText.style.wordWrap=!0,t._htmlText.style.leading=5,t._htmlText.autoSize=!0,t.addChild(t._htmlText),t._htmlText.on(Laya.Event.LINK,t,t.onLink),t}r.ChatIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"PrivateChatProcessor"},i.prototype.listenModuleEvents=function(){return[new r.ChatEvent(r.ChatEvent.SHOW_PRIVATE_CHAT_VIEW),new r.ChatEvent(r.ChatEvent.SEND_PRIVATE_CHAT),new r.ChatEvent(r.ChatEvent.DEL_PRIVATE_CHAT)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof r.ChatEvent)switch(t.type){case r.ChatEvent.SHOW_PRIVATE_CHAT_VIEW:this.showPrivateChat(t.data);break;case r.ChatEvent.SEND_PRIVATE_CHAT:this.onSendPrivateChat(t.data);break;case r.ChatEvent.DEL_PRIVATE_CHAT:this.delPrivateChat(t.data)}},i.prototype.showPrivateChat=function(t){var e=r.ChatModel.getInstance();if(t){if(!r.FriendModel.getInstance().isMyFriend(t))return void showToast(LanMgr.getLan("",10138));e.createPrivateChatInfo(t).lastTime=(new Date).getTime()}else if(!e.hasPrivateChat())return void showToast(LanMgr.getLan("",10141));UIMgr.showUI(UIConst.Chat_SiliaoView,t)},i.prototype.onSendPrivateChat=function(t){var e=this,i=t[0],n=t[1];if(!n||""==n||n.trim().length<=0)showToast(LanMgr.getLan("",10012));else if(r.FriendModel.getInstance().isMyFriend(i)){var o=App.getOpenValue(ModuleConst.CHAT);if(App.IsSysOpen(ModuleConst.CHAT)){var a={};a[Protocol.chat_chat_send.args.channel]=iface.tb_prop.chatChannelTypeKey.whisper,a[Protocol.chat_chat_send.args.type]=iface.tb_prop.chatTypeKey.text,a[Protocol.chat_chat_send.args.content]=n,a[Protocol.chat_chat_send.args.receiveId]=i,PLC.request(Protocol.chat_chat_send,a,function(t){t&&(r.ChatThread.getInstance().onRequest(iface.tb_prop.chatChannelTypeKey.whisper),e.privateChatView.textInput.text="")})}else showToast(LanMgr.getLan("",11017,o))}else showToast(LanMgr.getLan("",10133))},i.prototype.delPrivateChat=function(t){var e=this,i=t.dataSource;common.AlertBox.showAlert({text:LanMgr.getLan("",10140),confirmCb:function(){r.ChatModel.getInstance().delPrivateChat(i.playerId),e.privateChatView.delItem(t)}})},Object.defineProperty(i.prototype,"privateChatView",{get:function(){return UIMgr.getUIByName(UIConst.Chat_SiliaoView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}r.PrivateChatProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(p){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"ChatProcessor"},i.prototype.listenModuleEvents=function(){return[new p.ChatEvent(p.ChatEvent.SHOW_CHAT_PANEL),new p.ChatEvent(p.ChatEvent.SEND_CHAT_TEXT),new p.ChatEvent(p.ChatEvent.SEND_CHAT_VOICE),new p.ChatEvent(p.ChatEvent.ADD_ALL_CHAT),new p.ChatEvent(p.ChatEvent.ADD_WORLD_CHAT),new p.ChatEvent(p.ChatEvent.ADD_GUILD_CHAT),new p.ChatEvent(p.ChatEvent.ADD_GROUP_CHAT),new p.ChatEvent(p.ChatEvent.ADD_PROVINCE_CHAT),new p.ChatEvent(p.ChatEvent.ADD_CROSS_CHAT),new p.ChatEvent(p.ChatEvent.ADD_SYSTEM_CHAT)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof p.ChatEvent)switch(t.type){case p.ChatEvent.SHOW_CHAT_PANEL:this.showChatPanel(t.data);break;case p.ChatEvent.SEND_CHAT_TEXT:this.onSendText(t.data);break;case p.ChatEvent.SEND_CHAT_VOICE:this.onSendVoice(t.data);break;case p.ChatEvent.ADD_ALL_CHAT:this.addNewChat(t.data,iface.tb_prop.chatChannelTypeKey.all);break;case p.ChatEvent.ADD_WORLD_CHAT:this.addNewChat(t.data,iface.tb_prop.chatChannelTypeKey.world);break;case p.ChatEvent.ADD_GUILD_CHAT:this.addNewChat(t.data,iface.tb_prop.chatChannelTypeKey.guild);break;case p.ChatEvent.ADD_GROUP_CHAT:this.addNewChat(t.data,iface.tb_prop.chatChannelTypeKey.group);break;case p.ChatEvent.ADD_PROVINCE_CHAT:this.addNewChat(t.data,iface.tb_prop.chatChannelTypeKey.province);break;case p.ChatEvent.ADD_CROSS_CHAT:this.addNewChat(t.data,iface.tb_prop.chatChannelTypeKey.crossServer);break;case p.ChatEvent.ADD_SYSTEM_CHAT:this.addNewChat(t.data,iface.tb_prop.chatChannelTypeKey.system)}},i.prototype.showChatPanel=function(e){var i=this,t={};t[Protocol.chat_chat_list.args.channel]=iface.tb_prop.chatChannelTypeKey.all,PLC.request(Protocol.chat_chat_list,t,function(t){t&&(i._model.updateChatList(t),UIMgr.showUI(UIConst.ChatView,e))})},i.prototype.onSendText=function(t){var i=this._model,e=t[0],n=i.getChannelByIndex(t[1]);n==iface.tb_prop.chatChannelTypeKey.all&&(n=iface.tb_prop.chatChannelTypeKey.world);var o=App.getOpenValue(ModuleConst.CHAT);if(n!=iface.tb_prop.chatChannelTypeKey.world||App.IsSysOpen(ModuleConst.CHAT))if(n!=iface.tb_prop.chatChannelTypeKey.province||App.IsSysOpen(ModuleConst.CHAT_PROVI))if(n!=iface.tb_prop.chatChannelTypeKey.crossServer||App.IsSysOpen(ModuleConst.CHAT_CROSSSRV))if(n!=iface.tb_prop.chatChannelTypeKey.guild||App.hero.guildId)if(n!=iface.tb_prop.chatChannelTypeKey.group||p.GodDomainModel.getInstance().hasTeam())if(!e||""==e||e.trim().length<=0)showToast(LanMgr.getLan("",10012));else if(e!=this.gmKey)if(e!=this.debugKey){var a=i.getCdTime(n),r=Math.ceil(a-App.serverTimeSecond);if(n==iface.tb_prop.chatChannelTypeKey.world&&App.serverTimeSecond<a)showToast(LanMgr.getLan("",10013,r));else if(n==iface.tb_prop.chatChannelTypeKey.province&&App.serverTimeSecond<a){var s=Math.ceil(a-App.serverTimeSecond);showToast(LanMgr.getLan("",10254,s))}else if(n==iface.tb_prop.chatChannelTypeKey.crossServer&&App.serverTimeSecond<a){var u=Math.ceil(a-App.serverTimeSecond);showToast(LanMgr.getLan("",10255,u))}else{var h={};h[Protocol.chat_chat_send.args.channel]=n,h[Protocol.chat_chat_send.args.type]=iface.tb_prop.chatTypeKey.text,h[Protocol.chat_chat_send.args.content]=e,PLC.request(Protocol.chat_chat_send,h,function(t){if(t){i.setCdTime(t.cdTime,n),p.ChatThread.getInstance().onRequest(n);var e=UIMgr.getUIByName(UIConst.ChatView);e&&e.afterSend(),dispatchEvt(new p.ChatEvent(p.ChatEvent.CHAT_SEND_SUCCESS))}});var l=App.hero,c=window.platform.serverInfo;BingoSDK.gameReport("chat",l.playerId,l.accountName,c.serverId,c.srv_name,{chatTo:n,content:e,level:l.level,vip:l.vip,charge:l.welfare.rechargeSum})}}else p.PlayerDetailsView.debugLock=!1;else p.PlayerDetailsView.gmLock=!1;else showToast(LanMgr.getLan("",10253));else showToast(LanMgr.getLan("",10071));else showToast(LanMgr.getLan("",10252,App.getOpenValue(ModuleConst.CHAT_CROSSSRV)));else showToast(LanMgr.getLan("",10251,App.getOpenValue(ModuleConst.CHAT_PROVI)));else showToast(LanMgr.getLan("",11017,o))},i.prototype.onSendVoice=function(t){},i.prototype.addNewChat=function(t,e){if(t&&!(t.length<=0)){if(UIMgr.hasStage(UIConst.ChatView)){var i=UIMgr.getUIByName(UIConst.ChatView);this._model.getChannelByIndex(i.tabList.selectedIndex)==e&&i.addNewChats(t)}UIMgr.hasStage(UIConst.Main3DView)&&e==iface.tb_prop.chatChannelTypeKey.all&&UIMgr.getUIByName(UIConst.Main3DView).updateChatList(),UIMgr.hasStage(UIConst.ChatView)&&e==iface.tb_prop.chatChannelTypeKey.all&&UIMgr.getUIByName(UIConst.ChatView).updateNewChatNum()}},i);function i(){var t=e.call(this)||this;return t.gmKey="nbhero",t.debugKey="debughero",t._model=p.ChatModel.getInstance(),t}p.ChatProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"ChatModule"},n.prototype.listProcessors=function(){return[new t.ChatProcessor,new t.PrivateChatProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.ChatModule=i;var o,a,r=(o=tl3d.BaseEvent,__extends(s,o),s.SHOW_CHAT_PANEL="SHOW_CHAT_PANEL",s.SEND_CHAT_TEXT="SEND_CHAT_TEXT",s.SEND_CHAT_VOICE="SEND_CHAT_VOICE",s.ADD_ALL_CHAT="ADD_ALL_CHAT",s.ADD_WORLD_CHAT="ADD_WORLD_CHAT",s.ADD_GUILD_CHAT="ADD_GUILD_CHAT",s.ADD_GROUP_CHAT="ADD_GROUP_CHAT",s.ADD_PROVINCE_CHAT="ADD_PROVINCE_CHAT",s.ADD_CROSS_CHAT="ADD_CROSS_CHAT",s.ADD_SYSTEM_CHAT="ADD_SYSTEM_CHAT",s.UPDATE_NEW_CHAT_COUNT="UPDATE_NEW_CHAT_COUNT",s.UPDATE_WORLD_CHAT="UPDATE_WORLD_CHAT",s.UPDATE_CLUB_CHAT="UPDATE_CLUB_CHAT",s.SHOW_PRIVATE_CHAT_VIEW="SHOW_PRIVATE_CHAT_VIEW",s.SEND_PRIVATE_CHAT="SEND_PRIVATE_CHAT",s.DEL_PRIVATE_CHAT="DEL_PRIVATE_CHAT",s.ADD_PRIVATE_CHAT="ADD_PRIVATE_CHAT",s.NEW_PERSON_PRIVATE_CHAT="NEW_PERSON_PRIVATE_CHAT",s.START_REQUEST_PRIVATE_CHAT="START_REQUEST_PRIVATE_CHAT",s.STOP_REQUEST_PRIVATE_CHAT="STOP_REQUEST_PRIVATE_CHAT",s.UPDATE_PRIVATE_CHAT="UPDATE_PRIVATE_CHAT",s.SHORTCUTS_OPEN_OR_HIDE="SHORTCUTS_OPEN_OR_HIDE",s.CHAT_SEND_SUCCESS="CHAT_SEND_SUCCESS",s);function s(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.ChatEvent=r,(a=t.OpenType||(t.OpenType={}))[a.common=0]="common",a[a.godDm=1]="godDm"}(game=game||{}),function(w){var t=(E.getInstance=function(){return this._instance||(this._instance=new E),this._instance},E.prototype.initModel=function(){this._storage=w.PrivateChatStorage.getInstance(),this._storage.initStorage(),this.addCustomChat(LanMgr.getLan("",12495))},E.prototype.addCustomChat=function(t,e,i){void 0===e&&(e=iface.tb_prop.chatChannelTypeKey.world),void 0===i&&(i=iface.tb_prop.chatTypeKey.text);var n={type:i,time:App.getServerTime(),content:t},o=new w.ChatInfoVo(n,e);e==iface.tb_prop.chatChannelTypeKey.guild?this._guildChatList.push(o):this._worldChatList.push(o),dispatchEvt(new w.ChatEvent(w.ChatEvent.ADD_ALL_CHAT,[o]))},E.prototype.loginVoice=function(){if(!this.main){var t={appid:1003447,environment:0,isRecognize:1,complate:function(t){var e=this;console.log("初始化成功",t),setTimeout(function(){e.loginVoice()},100)}};this.main=new IMblend(t);var e={roomId:"1"};e.userId=App.hero.playerId,e.complate=function(t){0==t.result&&console.log("登陆成功",t)},this.main.loginRoom(e)}},E.prototype.startRecord=function(){this.main?this.main.startRecords({ext:(new Date).getTime(),start:function(){console.log("录音开始")},finish:function(t){console.log("录音结束，在此处调用发送信息接口可以将语音发送给同房间的其他用户"),console.log(t),dispatchEvt(new w.ChatEvent(w.ChatEvent.SEND_CHAT_TEXT,[t.voiceFilePath,1]))},recognitionFinish:function(t){console.log("语音识别回调成功"),console.log(t)}}):showToast(LanMgr.getLan("",10250))},E.prototype.stopRecord=function(){this.main?this.main.stopRecord():showToast(LanMgr.getLan("",10250))},E.prototype.playChatVoice=function(t){this.main?this.main.playOnlineAudio({voiceFilePath:t.voiceFilePath,start:function(){console.log("播放开始")},error:function(){console.log("播放出错")},stop:function(t){console.log("播放完成")}}):showToast(LanMgr.getLan("",10250))},E.prototype.stopChatVoice=function(){this.main?this.main.stopPlayAudio():showToast(LanMgr.getLan("",10250))},E.prototype.setRecognize=function(){this.main?(this.main.setRecognize(1),this.main.setRecognize(0)):showToast(LanMgr.getLan("",10250))},E.getExpressionUrl=function(t){var e=parseInt(t.substring(2));return SkinUtil.getExpressionUrl(e)},E.isExpression=function(t){if(4!=t.length)return!1;if("#"!=t[0]&&"#"!=t[1])return!1;var e=parseInt(t.substring(2));return 0<=e&&e<E.ExpressionNum},E.prototype.getBqList=function(){if(!this._bqList){this._bqList=[];for(var t=0;t<E.ExpressionNum;t++){var e=t<10?"##0"+t:"##"+t;this._bqList.push({url:SkinUtil.getExpressionUrl(t),id:e,index:t})}}return this._bqList},E.prototype.getChatListByType=function(t,e){if(void 0===e&&(e=0),t==iface.tb_prop.chatChannelTypeKey.world)return this._worldChatList;if(t==iface.tb_prop.chatChannelTypeKey.guild)return this._guildChatList;if(t==iface.tb_prop.chatChannelTypeKey.group)return this._groupChatList;if(t==iface.tb_prop.chatChannelTypeKey.province)return this._provinceChatList;if(t==iface.tb_prop.chatChannelTypeKey.crossServer)return this._crossChatList;if(t==iface.tb_prop.chatChannelTypeKey.system)return this._systemList;var i=this._worldChatList.concat(this._guildChatList).concat(this._provinceChatList).concat(this._crossChatList);if(i.sort(function(t,e){return t.svo.time-e.svo.time}),0<e&&0<i.length){var n=i.length-e;n=n<0?0:n,i=i.slice(n,i.length)}return i},E.prototype.updateChatList=function(t){if(t){var e,i=[],n=[],o=t.worldList||[];if(o&&0<o.length){o.sort(function(t,e){return t.time-e.time});for(var a=[],r=0,s=0,u=o.length;s<u;s++)(b=o[s]).senderId&&App.hero.isInBlockList(b.senderId)||((e=new w.ChatInfoVo(b,iface.tb_prop.chatChannelTypeKey.world)).svo.type==iface.tb_prop.chatTypeKey.notice&&e.isSystem()&&n.push(b),a.push(e),this._worldChatList.push(e),i.push(e),e.isSelf()||r++);this.addNewNum(iface.tb_prop.chatChannelTypeKey.world,r),this._worldChatList.length>E.MAX_COUNT&&this._worldChatList.slice(0,E.MAX_COUNT),dispatchEvt(new w.ChatEvent(w.ChatEvent.ADD_WORLD_CHAT,[].concat(a)))}var h=t.guildList||[];if(0<h.length){h.sort(function(t,e){return t.time-e.time});var l=[];for(s=r=0,u=h.length;s<u;s++)(b=h[s]).senderId&&App.hero.isInBlockList(b.senderId)||(e=new w.ChatInfoVo(b,iface.tb_prop.chatChannelTypeKey.guild),l.push(e),this._guildChatList.push(e),i.push(e),e.isSelf()||r++);this.addNewNum(iface.tb_prop.chatChannelTypeKey.guild,r),this._guildChatList.length>E.MAX_COUNT&&this._guildChatList.slice(0,E.MAX_COUNT),dispatchEvt(new w.ChatEvent(w.ChatEvent.ADD_GUILD_CHAT,[].concat(l)))}var c=t.groupList||[];if(0<c.length){c.sort(function(t,e){return t.time-e.time});var p=[];for(s=r=0,u=c.length;s<u;s++)e=new w.ChatInfoVo(c[s],iface.tb_prop.chatChannelTypeKey.group),p.push(e),this._groupChatList.push(e),i.push(e),e.isSelf()||r++;this.addNewNum(iface.tb_prop.chatChannelTypeKey.group,r),this._groupChatList.length>E.MAX_COUNT&&this._groupChatList.slice(0,E.MAX_COUNT),dispatchEvt(new w.ChatEvent(w.ChatEvent.ADD_GROUP_CHAT,[].concat(p)))}var d=t.provinceList||[];if(0<d.length){d.sort(function(t,e){return t.time-e.time});var _=[];for(s=r=0,u=d.length;s<u;s++)e=new w.ChatInfoVo(d[s],iface.tb_prop.chatChannelTypeKey.province),_.push(e),this._provinceChatList.push(e),i.push(e),e.isSelf()||r++;this.addNewNum(iface.tb_prop.chatChannelTypeKey.province,r),this._provinceChatList.length>E.MAX_COUNT&&this._provinceChatList.slice(0,E.MAX_COUNT),dispatchEvt(new w.ChatEvent(w.ChatEvent.ADD_PROVINCE_CHAT,[].concat(_)))}var f=t.crossList||[];if(0<f.length){for(f.sort(function(t,e){return t.time-e.time}),p=[],s=r=0,u=f.length;s<u;s++)e=new w.ChatInfoVo(f[s],iface.tb_prop.chatChannelTypeKey.crossServer),p.push(e),this._crossChatList.push(e),i.push(e),e.isSelf()||r++;this.addNewNum(iface.tb_prop.chatChannelTypeKey.crossServer,r),this._crossChatList.length>E.MAX_COUNT&&this._crossChatList.slice(0,E.MAX_COUNT),dispatchEvt(new w.ChatEvent(w.ChatEvent.ADD_CROSS_CHAT,[].concat(p)))}var g=t.systemList||[];if(0<n.length||0<g.length){(g=n.concat(g)).sort(function(t,e){return t.time-e.time});var y=[];for(s=0,u=g.length;s<u;s++)e=new w.ChatInfoVo(g[s],iface.tb_prop.chatChannelTypeKey.system),y.push(e),this._systemList.push(e),i.push(e);this._systemList.length>E.MAX_COUNT&&this._systemList.slice(0,E.MAX_COUNT),dispatchEvt(new w.ChatEvent(w.ChatEvent.ADD_SYSTEM_CHAT,[].concat(y)))}var m=t.whisperList||[];if(0<m.length){m.sort(function(t,e){return t.time-e.time});var v=[];for(s=0,u=m.length;s<u;s++){var b;if(!(b=m[s]).senderId||!App.hero.isInBlockList(b.senderId)){var I=(e=new w.ChatInfoVo(b,iface.tb_prop.chatChannelTypeKey.whisper)).getFriendId(),T=this._privateChatMap.get(I);T||(T=this.createPrivateChatInfo(I),v.push(T)),T.isExitChat(e.svo.senderId,e.svo.time)||T.addChat(e)}}this._storage.resetStorage(),0<v.length&&dispatchEvt(new w.ChatEvent(w.ChatEvent.NEW_PERSON_PRIVATE_CHAT,v)),dispatchEvt(new w.ChatEvent(w.ChatEvent.UPDATE_PRIVATE_CHAT))}0<i.length&&(i.sort(function(t,e){return t.svo.time-e.svo.time}),dispatchEvt(new w.ChatEvent(w.ChatEvent.ADD_ALL_CHAT,i)))}},E.prototype.setCdTime=function(t,e){t&&0<t&&(this._cdDic[e]=t)},E.prototype.getCdTime=function(t){return this._cdDic[t]||0},E.prototype.clearCdTime=function(){this._cdDic={}},E.prototype.addNewNum=function(t,e){0!=e&&(this._newNumMap.hasOwnProperty(t)||(this._newNumMap[t]=0),this._newNumMap[t]+=e,dispatchEvt(new w.ChatEvent(w.ChatEvent.UPDATE_NEW_CHAT_COUNT)))},E.prototype.resetNewNum=function(t){this._newNumMap[t]=0,dispatchEvt(new w.ChatEvent(w.ChatEvent.UPDATE_NEW_CHAT_COUNT))},E.prototype.getNewNum=function(t){return this._newNumMap[t]||0},E.prototype.hasNewNum=function(){var t=0;for(var e in this._newNumMap)t+=this.getNewNum(Number(e));return 0<t},E.prototype.hasNewPrivateChat=function(){return this._privateChatMap.values.some(function(t){return 0<t.newNum})},E.prototype.createPrivateChatInfo=function(t){return this._privateChatMap.get(t)||this._privateChatMap.set(t,new w.PrivateChatInfoVo(t)),this._privateChatMap.get(t)},E.prototype.getPrivateChatMap=function(){return this._privateChatMap},E.prototype.hasPrivateChat=function(){return 0<this._privateChatMap.values.length},E.prototype.getPrivateChatList=function(){for(var t=[],e=0,i=this._privateChatMap.values;e<i.length;e++){var n=i[e];w.FriendModel.getInstance().isMyFriend(n.playerId)&&t.push(n)}return t.sort(function(t,e){return e.lastTime-t.lastTime}),t},E.prototype.delPrivateChat=function(t){this._privateChatMap.remove(t),this._storage.delStorage(t),dispatchEvt(new w.ChatEvent(w.ChatEvent.UPDATE_PRIVATE_CHAT))},E.prototype.getTabbarDatas=function(t){t=isNaN(t)?0:t;var e=[iface.tb_prop.chatChannelTypeKey.world,iface.tb_prop.chatChannelTypeKey.guild,iface.tb_prop.chatChannelTypeKey.province,iface.tb_prop.chatChannelTypeKey.crossServer,iface.tb_prop.chatChannelTypeKey.system];return t==w.OpenType.godDm&&e.push(iface.tb_prop.chatChannelTypeKey.group),e},E.prototype.getChannelByIndex=function(t){return this.channelMap[t]},E.prototype.getIndexByChannel=function(t){return this.channelMap.indexOf(t)},E.MAX_COUNT=50,E.SAVE_PEOPLE_COUNT=10,E.SAVE_CHAT_COUNT=20,E.STORAGE_KEY="slqy_chat",E.ExpressionNum=26,E);function E(){this._newNumMap={},this._worldChatList=[],this._guildChatList=[],this._privateChatMap=new Laya.Dictionary,this._groupChatList=[],this._provinceChatList=[],this._crossChatList=[],this._systemList=[],this._cdDic={},this.channelMap=[iface.tb_prop.chatChannelTypeKey.world,iface.tb_prop.chatChannelTypeKey.guild,iface.tb_prop.chatChannelTypeKey.province,iface.tb_prop.chatChannelTypeKey.crossServer,iface.tb_prop.chatChannelTypeKey.system,iface.tb_prop.chatChannelTypeKey.group]}w.ChatModel=t}(game=game||{}),function(t){var e=(i.prototype.setSvo=function(t){this.svo=t,this.isOpen()?this.sortNum=-this.tbBoss.level:this.sortNum=1e4+this.tbBoss.level},i.prototype.getRewardList=function(){return this._rewardList||(this._rewardList=[],this._rewardList.push(new AwardRankData(1,"1",this.getItemList(this.tbBoss.rank_1))),this._rewardList.push(new AwardRankData(2,"2",this.getItemList(this.tbBoss.rank_2))),this._rewardList.push(new AwardRankData(3,"3",this.getItemList(this.tbBoss.rank_2))),this._rewardList.push(new AwardRankData(4,"4-10",this.getItemList(this.tbBoss.rank_3))),this._rewardList.push(new AwardRankData(5,LanMgr.getLan("",12501)+"10",this.getItemList(this.tbBoss.rank_4)))),this._rewardList},i.prototype.getItemList=function(t){var e=[];return t.forEach(function(t){e.push(new ItemVo(Number(t[0]),Number(t[1])))}),e},i.prototype.isOpen=function(){return App.hero.level>=this.tbBoss.level},i.prototype.isDead=function(){return this.svo.bossReviveTime>App.serverTimeSecond},i.prototype.getBossTotalHp=function(){return this.tbMonster.getPropValByType(1)},i.prototype.getBossHp=function(){return this.svo.bossHp},i.prototype.getMonstersHp=function(){for(var t=[],e=0;e<this.tbBoss.monster.length;e++)0!=Number(this.tbBoss.monster[e])?t.push(this.svo.bossHp):t.push(0);return t},i.prototype.getCurDamage=function(){return this.enemyLossHp},i.prototype.getTotalDamage=function(){var t=this.battleEndData.totalDamage?this.battleEndData.totalDamage:0;return Math.floor(t)},i.prototype.getRank=function(){return this.battleEndData.rank?this.battleEndData.rank:0},i.prototype.setRankList=function(t){this.rankList=[];for(var e=0;e<3;e++){var i=t[e]||{};i.rank=e,this.rankList.push(i)}},i);function i(t){this.sortNum=0,this.quality=1,this.tbBoss=t;var e=this.tbBoss.monster.find(function(t){return 0!=Number(t)});this.tbMonster=tb.TB_monster.get_TB_monsterById(e),this.quality=t.ID<=2?1:t.ID<=5?2:3}t.BossInfoVo=e;function n(t,e){this.svo=t,this.rank=e,this.head=t.head,this.headVo=new UserHeadVo(t.head,t.playerLevel,t.headFrame)}t.BossRankInfo=n}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(h){var n,t=(n=ui.boss.WorldBossUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.uiScene=new Base2dSceneLayer,this.boxRole.addChild(this.uiScene),this.uiScene.setModelBox(this,this.lbName,this.roleBottom),this.bossList.array=null,this.itemList.array=null,this.bossList.selectedIndex=-1,this.bossList.selectHandler=new Handler(this,this.onSelect),this.bossList.renderHandler=new Handler(this,this.onBossRender),this.lbCount.autoSize=!0,this.btnChallege.on(Laya.Event.CLICK,this,this.onChallenge),this.btnAdd.on(Laya.Event.CLICK,this,this.onAdd),this.lbPeople.on(Laya.Event.CLICK,this,this.onRank),this.btnPrev.on(Laya.Event.CLICK,this,this.onPrev),this.btnNext.on(Laya.Event.CLICK,this,this.onNext),this.btn_rotateleft.on(Laya.Event.CLICK,this,this.rotateModel,[1]),this.btn_rotateright.on(Laya.Event.CLICK,this,this.rotateModel,[2]),this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.WORLD_BOSS)},e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this),this.initView()},e.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this,t,e,i)},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.uiScene.onExit(),this._curBossVo=null,this.bossList.array=null,this.bossList.selectedIndex=-1,this.itemList.array=null,Laya.timer.clearAll(this),h.BossModel.getInstance().stopInterval(),Laya.timer.clear(this,this.updateCount),tl3d.ModuleEventManager.removeEvent(h.BossEvent.UPDATE_BOSS_INFO,this.refreshView,this),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var e=this,t=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_jiangli,callback:this.onJiangli.bind(this)}],i=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:i,funList:t,closeCallback:this.onFanhui.bind(this)}),this.uiScene.onShow(),tl3d.ModuleEventManager.addEvent(h.BossEvent.UPDATE_BOSS_INFO,this.refreshView,this),Laya.timer.loop(1e3,this,this.updateCount),this.updateCount();var n=h.BossModel.getInstance();n.startInterval();var o=n.getBossList();this.bossList.array=o;var a=this.dataSource,r=-1;if(a&&!isNaN(a)&&(r=o.findIndex(function(t){return t.tbBoss.ID==a&&t.isOpen()&&!t.isDead()})),-1==r)for(var s=o.length-1;0<=s;s--){var u=o[s];if(u.isOpen()&&!u.isDead()){r=s;break}}r=-1!=r?r:0,this.bossList.selectedIndex=r,Laya.timer.callLater(this,function(){var t=2<=r?r-2:0;e.bossList.scrollTo(t)})},e.prototype.onSelect=function(t){if(-1!=t&&(this._curBossVo=this.bossList.selectedItem,this._curBossVo)){var e=this._curBossVo;this.lbName.text=e.tbMonster.name+LanMgr.getLan("",10157,e.tbBoss.boss_level.toString());var i=e.tbBoss.getRewardList();this.itemList.array=i,this.itemList.width=100*i.length+(i.length-1)*this.itemList.spaceX,Laya.timer.once(300,this,this.delayShow,[e.tbMonster.model]),this.updateBossInfo()}},e.prototype.updateBossInfo=function(){if(this._curBossVo){var t=this._curBossVo;this.lbBlood.text=Math.ceil(t.getBossHp()/t.getBossTotalHp()*100)+"%",this.pbBlood.value=t.getBossHp()/t.getBossTotalHp(),this.btnChallege.gray=!t.isOpen(),this.btnChallege.label=t.isDead()?LanMgr.getLan("",12502):t.isOpen()?LanMgr.getLan("",10021):LanMgr.getLan("",10157,t.tbBoss.level),this.lbPeople.text=LanMgr.getLan("",12503,t.svo.bossRankNum)}},e.prototype.refreshView=function(){this.updateBossInfo(),this.bossList.refresh();for(var t=0,e=this.bossList.cells;t<e.length;t++)e[t].updateBlood()},e.prototype.updateCount=function(){var t=App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.worldBossNum);if(tb.TB_boss_set.getSet().max_time<=t)this.lbCount.text=LanMgr.getLan("",10081,t);else{var e=tb.TB_boss_set.getSet().reply_time-(App.serverTimeSecond-App.hero.worldBossReplyTime);this.lbCount.text=LanMgr.getLan("",10142,t)+LanMgr.getLan("",12504,GameUtil.toCountdown(e,"mm:ss"))}this.btnAdd.x=this.lbCount.x+this.lbCount.width+30;for(var i=0,n=this.bossList.cells;i<n.length;i++)n[i].updateBtn()},e.prototype.onBossRender=function(t,e){t&&(e==this.bossList.selectedIndex?t.ani1.play(0,!0):t.ani1.gotoAndStop(0))},e.prototype.onChallenge=function(){var t=this.bossList.selectedItem;t&&t instanceof h.BossInfoVo&&dispatchEvt(new h.BossEvent(h.BossEvent.CHALLENGE_BOSS,t))},e.prototype.onRule=function(){dispatchEvt(new h.BossEvent(h.BossEvent.SHOW_RULE_VIEW))},e.prototype.onAdd=function(){dispatchEvt(new h.BossEvent(h.BossEvent.SHOW_BUY_VIEW))},e.prototype.onJiangli=function(){var t=this.bossList.selectedItem;t&&t instanceof h.BossInfoVo&&dispatchEvt(new h.BossEvent(h.BossEvent.SHOW_REWARD_VIEW,t))},e.prototype.onRank=function(){var t=this.bossList.selectedItem;t&&t instanceof h.BossInfoVo&&dispatchEvt(new h.BossEvent(h.BossEvent.SHOW_RANK_VIEW,t))},e.prototype.onNext=function(){this.bossList.scrollTo(this.bossList.selectedIndex+3)},e.prototype.onPrev=function(){this.bossList.scrollTo(this.bossList.selectedIndex-3)},e.prototype.onFanhui=function(){dispatchEvt(new h.HudEvent(h.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_MAOXIAN))},e.prototype.delayShow=function(t){var e=this.boxRole.localToGlobal(new Laya.Point(0,0));this.uiScene.addModelChar(t,e.x+this.boxRole.width/2-Launch.offsetX,e.y-Launch.offsetY,180,.8),this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_02,2)},e.prototype.rotateModel=function(t){this.uiScene.sceneChar.rotationY=1==t?this.uiScene.sceneChar.rotationY-15:this.uiScene.sceneChar.rotationY+15},e);function e(){var t=n.call(this)||this;return t.group=UIConst.hud_group,t}h.WorldBossView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.boss.RewardUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.rewardList.array=null,this.bgPanel.dataSource=null},n.prototype.initView=function(){this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12261)};var t=this.dataSource;this.rewardList.array=t.getRewardList()},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}t.BossRewardView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var i,t=(i=ui.boss.RankUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.listRank.array=null,this.bgPanel.dataSource=null},e.prototype.initView=function(){this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12505)},this.listRank.array=null,this.lbDamage.text="",this.requestRank()},e.prototype.requestRank=function(){var r=this,t=this.dataSource,e={};e[Protocol.center_boss_getRankList.args.id]=t.tbBoss.ID,PLC.request(Protocol.center_boss_getRankList,e,function(t){if(t){for(var e=t.WorldBossRankList,i=[],n=0;n<e.length;n++)i.push(new s.BossRankInfo(e[n],n+1));var o=t.myRank,a=0==o?LanMgr.getLan("",10028):LanMgr.getLan("",10029,o);r.lbDamage.text=LanMgr.getLan("",10080,t.rankValue)+"    "+a,r.listRank.array=i,r.empty.visible=0==i.length}})},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t}s.BossRankView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var o,t=(o=ui.boss.FightRankUI,__extends(e,o),e.prototype.setSize=function(t,e){o.prototype.setSize.call(this,t,e);var i=GameUtil.isFullScreen();this.lbTitle.y=i?241+n.HudModel.TOP_ADD_HEIGHT:241,this.rankList.y=i?258+n.HudModel.TOP_ADD_HEIGHT:258},e.prototype.show=function(t,e){o.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){o.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){o.prototype.onClosed.call(this),this.rankList.array=null},e.prototype.initView=function(){this.rankList.array=this.dataSource},e);function e(){var t=o.call(this)||this;return t.isModelClose=!1,t.mouseThrough=!0,t.isModal=!1,t.width=Laya.stage.width,t.height=Laya.stage.height,t}n.BossFightRankView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.boss.BossRewardIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t?(this.ui_item.dataSource=t.itemData,this.lab_info.text=1==t.type?LanMgr.getLan("",12506):LanMgr.getLan("",12507),this.img_infobg.skin=1==t.type?SkinUtil.redBg:SkinUtil.greenBg):(this.ui_item.dataSource=null,this.lab_info.text="",this.img_infobg.skin=null)},n);function n(){return e.call(this)||this}t.BossRewardIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.boss.RankIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;t?(this.headBox.dataSource=new UserHeadVo(t.svo.head,t.svo.playerLevel,t.svo.headFrame),this.lbName.text=t.svo.playerName,this.lbDamage.text=t.svo.value.toString(),this.headBox.on(Laya.Event.CLICK,this,this.onShowInfo),this.ui_view.dataSource={rank:t.rank}):(this.headBox.dataSource=null,this.headBox.off(Laya.Event.CLICK,this,this.onShowInfo))},n.prototype.onShowInfo=function(){var t=this.dataSource;t&&t.svo&&t.svo.playerId&&UIUtil.showPlayerLineupInfo(t.svo.playerId)},n);function n(){return e.call(this)||this}t.BossRankIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.boss.BossIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initView()},enumerable:!0,configurable:!0}),n.prototype.initView=function(){var t=this.dataSource;t?(this.imgQuality.skin=SkinUtil.getWorldBossQuality(t.quality),this.imgHead.skin=SkinUtil.getMonsterCircleIcon(t.tbMonster.icon),this.lbLevel.text=LanMgr.getLan("",10157,t.tbBoss.boss_level.toString()),this.updateBlood(),this.imgHead.gray=!t.isOpen()||t.isDead(),this.imgSuo.visible=!t.isOpen(),this.imgDi.gray=!t.isOpen(),this.ani_select.loadAnimation(ResConst.anim_circle_select,Handler.create(this,function(){this.ani_select.play()}),ResConst.atlas_circle_select)):(this.ani_select.gotoAndStop(0),this.ani1.gotoAndStop(0))},n.prototype.updateBlood=function(){this.dataSource&&this.updateBtn()},n.prototype.updateBtn=function(){var t=this.dataSource;if(t)if(this.lbTime.visible=!1,t.isOpen())if(t.isDead()||t.getBossHp()<=0){this.lbTime.visible=!0;var e=t.svo.bossReviveTime-App.serverTimeSecond;e=e<=0?0:e,Math.ceil(e/60),this.lbTime.text=GameUtil.toCountdown(e,"hh:mm:ss"),e<=0&&i.BossModel.getInstance().requestBossInfo()}else this.renderBlood(t);else this.renderBlood(t)},n.prototype.renderBlood=function(t){},n);function n(){return t.call(this)||this}i.BossIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.boss.FightRankIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.getIconMask=function(){return this._iconmask||(this._iconmask=new Laya.Sprite),this._iconmask.graphics.clear(),this._iconmask.graphics.drawCircle(55,55,46,"#f16712",null,.01),this._iconmask},n.prototype.refreshView=function(){var t=this.dataSource;if(this.clearTimer(this,this.addMask),this.icon.mask=null,t){this.frameOnce(3,this,this.addMask),this.icon.skin=SkinUtil.getHeroIcon(t.head),this.imgRank.skin=SkinUtil.getRankSkin(t.rank+1);var e=!!t.playerId;this.lbName.text=e?t.playerName:LanMgr.getLan("",12508),this.lbName.y=e?42:52,this.lbDamage.visible=e,this.lbDamage.value=t.value+"",this.icon.on(Laya.Event.CLICK,this,this.onShow)}else this.icon.skin="",this.imgRank.skin="",this.icon.off(Laya.Event.CLICK,this,this.onShow)},n.prototype.addMask=function(){this.icon.mask=this.getIconMask()},n.prototype.onShow=function(){var t=this.dataSource;t&&t.playerId&&UIUtil.showPlayerLineupInfo(t.playerId)},n);function n(){return e.call(this)||this}t.BossFightRankIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(_){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"BossProcessor"},i.prototype.listenModuleEvents=function(){return[new _.BossEvent(_.BossEvent.SHOW_BOSS_VIEW),new _.BossEvent(_.BossEvent.SHOW_RANK_VIEW),new _.BossEvent(_.BossEvent.SHOW_REWARD_VIEW),new _.BossEvent(_.BossEvent.SHOW_RULE_VIEW),new _.BossEvent(_.BossEvent.SHOW_BUY_VIEW),new _.BossEvent(_.BossEvent.CHALLENGE_BOSS)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof _.BossEvent)switch(t.type){case _.BossEvent.SHOW_BOSS_VIEW:this.showBossView(t.data);break;case _.BossEvent.SHOW_RANK_VIEW:this.showRankView(t.data);break;case _.BossEvent.SHOW_REWARD_VIEW:this.showRewardView(t.data);break;case _.BossEvent.SHOW_RULE_VIEW:this.showRuleView();break;case _.BossEvent.SHOW_BUY_VIEW:this.showBuyView();break;case _.BossEvent.CHALLENGE_BOSS:this.challengeBoss(t.data)}},i.prototype.showBossView=function(e){PLC.request(Protocol.center_boss_getWorldBossInfo,null,function(t){_.BossModel.getInstance().updateBossInfo(t),UIMgr.showUI(UIConst.WorldBoss_BossView,e)})},i.prototype.showRankView=function(t){t.svo.bossRankNum<=0?showToast(LanMgr.getLan("",10147)):UIMgr.showUI(UIConst.WorldBoss_RankView,t)},i.prototype.showRewardView=function(t){t&&UIMgr.showUI(UIConst.WorldBoss_RewardView,t)},i.prototype.showRuleView=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20008))},i.prototype.showBuyView=function(){var i=this;UIUtil.checkLimitEnough(iface.tb_prop.limitTypeKey.buyWorldBossNum,iface.tb_prop.vipPrivilegeTypeKey.worldBossNum)&&UIMgr.showUI(UIConst.BuyBattleCount,{type:common.BuyBattleCountView.TYPE_BOSS,callback:function(t){var e={};e[Protocol.game_common_buyWorldBossBattleCnt.args.count]=t,PLC.request(Protocol.game_common_buyWorldBossBattleCnt,e,function(t){t&&i.newBossView.updateCount()})}})},i.prototype.challengeBoss=function(e){var i=this;if(!UIUtil.checkUnableToEnterFight())if(e.isOpen()){if(App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.worldBossNum)<=0)return App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyWorldBossNum)<App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.worldBossNum)&&this.showBuyView(),void showToast(LanMgr.getLan("",10084));if(e.isDead()){var t=e.svo.bossReviveTime-App.serverTimeSecond;showToast(LanMgr.getLan("",10101,Math.ceil(t/60)))}else{var n={};n[Protocol.center_boss_worldBossBattleStart.args.id]=e.tbBoss.ID,PLC.request(Protocol.center_boss_worldBossBattleStart,n,function(t){t&&(_.BossModel.getInstance().updateBossInfo(t.WorldBossInfo),e.setRankList(t.damageRankInfo),i.newBossView&&i.newBossView.updateCount(),i.doFight(e,t.bossRecords))})}}else showToast(LanMgr.getLan("",10035,e.tbBoss.level))},i.prototype.doFight=function(n,t){var o=new _.FightVo;o.copyType=CopyType.worldboss,o.worldBossInfo=n;var e=new battle.BattleScenePve(o.copyType);e.init([o.getOwnTeam()],o.getEnemyTeam(),iface.tb_prop.battleObjTypeKey.monster,o.getAllRound(),o.getTeamHp()),e.start();var i=e.winCamp===battle.BatteConsts.BATTLE_CAMPATK;logfight("战斗结果：",i,"战报：",e.battleReport);var a=new _.ServerPage;if(a.result=i?playState.VICTORY:playState.FAILURE,a.initPage(e.battleReport),o.fightPageControl=a,t&&t instanceof Array){for(var r=[],s=0;s<t.length;s++){var u=t[s],h=new BarrageVo;h.barrageText=LanMgr.getLan("",12500,u.name,u.damage),r.push(h)}o.barrageList=r}var l=0,c=e.getLossHpObj(battle.BatteConsts.BATTLE_CAMPDEF);for(var p in c)l+=Number(c[p]);n.enemyLossHp=Math.floor(l),loghgy("世界boss：",n.tbBoss.ID,n.tbMonster.ID,n.getBossHp(),n.getBossTotalHp(),i,"伤害：",n.enemyLossHp);var d={};d[Protocol.center_boss_worldBossBattleEnd.args.id]=n.tbBoss.ID,d[Protocol.center_boss_worldBossBattleEnd.args.damage]=n.enemyLossHp,PLC.request(Protocol.center_boss_worldBossBattleEnd,d,function(t){n.battleEndData=t||{};var e=t.WorldBossBattleInfo;n.battleEndData.rank=e?e.myRank:0,n.battleEndData.totalDamage=e?e.totalDamage:0;var i={vo:o,event:new _.BossEvent(_.BossEvent.SHOW_BOSS_VIEW),eventdata:n.tbBoss.ID};dispatchEvt(new _.FightsEvent(_.FightsEvent.ENTER_FIGHT_EVENT),i)})},Object.defineProperty(i.prototype,"newBossView",{get:function(){return UIMgr.getUIByName(UIConst.WorldBoss_BossView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}_.BossProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"BossModule"},n.prototype.listProcessors=function(){return[new t.BossProcessor]},n.prototype.onRegister=function(){t.BossModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.BossModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_BOSS_VIEW="SHOW_BOSS_PANEL",r.SHOW_RANK_VIEW="SHOW_RANK_VIEW",r.SHOW_REWARD_VIEW="SHOW_REWARD_VIEW",r.SHOW_RULE_VIEW="SHOW_RULE_VIEW",r.SHOW_BUY_VIEW="WB_SHOW_BUY_VIEW",r.UPDATE_BOSS_INFO="UPDATE_WORLD_BOSS_INFO",r.CHALLENGE_BOSS="CHALLENGE_BOSS",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.BossEvent=a}(game=game||{}),function(a){var t=(e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initModel=function(){var t=TableData.getInstance().getTableByName(TableData.tb_worldboss).data;for(var e in t)this._bossList.push(new a.BossInfoVo(t[e]));this.refreshInterval()},e.prototype.refreshInterval=function(){if(App.IsSysOpen(ModuleConst.WORLD_BOSS)){var t=App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.worldBossNum),e=tb.TB_boss_set.getSet().max_time;Laya.timer.clear(this,this.updateCount),t<e&&(Laya.timer.loop(1e3,this,this.updateCount),this.updateCount())}},e.prototype.updateCount=function(){var t=App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.worldBossNum),e=tb.TB_boss_set.getSet().max_time,i=tb.TB_boss_set.getSet().reply_time,n=App.serverTimeSecond-App.hero.worldBossReplyTime;if(e<=t)Laya.timer.clear(this,this.updateCount);else if(i<=n){var o=Math.floor(n/i),a=Math.min(t+o,e);App.hero.setOverplusValue(iface.tb_prop.overplusTypeKey.worldBossNum,a),App.hero.worldBossReplyTime=App.hero.worldBossReplyTime+n*o}},e.prototype.startInterval=function(){clearInterval(this._tickId),this._tickId=setInterval(this.requestBossInfo.bind(this),1e4)},e.prototype.stopInterval=function(){clearInterval(this._tickId)},e.prototype.requestBossInfo=function(){var e=this;PLC.request(Protocol.center_boss_getWorldBossInfo,null,function(t){t&&e.updateBossInfo(t)})},e.prototype.updateBossInfo=function(t){if(t){var e=[];for(var i in t.WorldBossInfo){var n=t.WorldBossInfo[i],o=this.getBossInfo(n.bossId);o.setSvo(n),e.push(o.sortNum)}dispatchEvt(new a.BossEvent(a.BossEvent.UPDATE_BOSS_INFO))}},e.prototype.getBossList=function(){return this._bossList},e.prototype.getBossInfo=function(e){return this._bossList.find(function(t){return t.tbBoss.ID==e})},e);function e(){this._bossList=[],this._sortAry=[]}a.BossModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.bag.UseUI,__extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.Bag_UseView,closeOnSide:this.isModelClose},this._counterBar=new common.CounterBar,this._counterBar.setComponent(this.btn_add,this.btn_addTen,this.btn_del,this.btn_delTen,this.lab_num)},i.prototype.close=function(){e.prototype.close.call(this,"",!0),this.bgPanel.dataSource=null},i.prototype.popup=function(){e.prototype.popup.call(this,!1,!0);var t=tb.TB_item.get_TB_itemById(this.dataSource.id);this.img_icon.skin=SkinUtil.getItemIcon(t),this.img_quality.skin=SkinUtil.getBoxQulityIcon(t.quality),this.lab_name.text=t.name,this.lab_count.text=String(this.dataSource.count),this.lab_info.text="("+t.desc+")",this.vo=this.dataSource,6==this.dataSource.type?(iface.tb_prop.itemTypeKey.chip,this.total=Math.floor(this.dataSource.count/t.using_effect[1])):this.total=this.dataSource.count,this.num=1,this._counterBar.setInitData(this.num,this.total,this.updateCount.bind(this)),this.updateCount()},i.prototype.updateCount=function(){this.num=this._counterBar.getCurNum(),this.lab_num.text=this.num.toString()},i.prototype.onQueding=function(){var t=this;if(this.dataSource.type_name==LanMgr.getLan("",12509)&&App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum)<=n.GodUtils.getGodsNum()+this.num){var e=LanMgr.getLan("",10226);common.AlertBox.showAlert({text:e,confirmCb:function(){t.close(),dispatchEvt(new n.FenjieEvent(n.FenjieEvent.SHOW_FENJIE_VIEW))}})}else{var i=new n.BagEvent(n.BagEvent.USE_MANY_ITEM);i.data=new Array,i.data[0]=this.vo,i.data[1]=this.num,dispatchEvt(i)}},i);function i(){var t=e.call(this)||this;return t.num=1,t.total=0,t.btn_quxiao.on(Laya.Event.CLICK,t,t.close),t.btn_queding.on(Laya.Event.CLICK,t,t.onQueding),t}n.UseView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.bag.RewardSelectUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.RewardSelectView,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12510)},this._counterBar=new common.CounterBar,this._counterBar.setComponent(this.btn_add,this.btn_add_ten,this.btn_del,this.btn_del_ten,this.lab_num)},e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this),this.btn_queding.off(Laya.Event.CLICK,this,this.onclick),this._itemVo=null,this._tbOptional=null},e.prototype.initView=function(){this.btn_queding.on(Laya.Event.CLICK,this,this.onclick),this.list_reward.renderHandler=new Handler(this,this.onItemRender),this._itemVo=this.dataSource,this._itemVo?(this._curNum=1,this._selectIdx=-1,this._tbOptional=tb.TB_optional.get_TB_ById(this._itemVo.using[1]),this.list_reward.array=ary2prop(this._tbOptional.option),this.list_reward.repeatX=5<this.list_reward.array.length?5:this.list_reward.array.length,2==this.list_reward.repeatX?this.list_reward.spaceX=100:3==this.list_reward.repeatX?this.list_reward.spaceX=40:this.list_reward.spaceX=5,this.list_reward.width=4<this.list_reward.repeatX?640:this.list_reward.repeatX*(149+this.list_reward.spaceX)-this.list_reward.spaceX,this.list_reward.x=(this.width-this.list_reward.width)/2,this.onChkItem(this._selectIdx),this._maxNum=this._itemVo.getNum(),this._counterBar.setInitData(this._curNum,this._maxNum,this.updateRewardNum.bind(this)),this.updateRewardNum()):this.close()},e.prototype.updateRewardNum=function(){this._curNum=this._counterBar.getCurNum(),this.lab_num.text=this._curNum.toFixed(0)},e.prototype.onclick=function(t){switch(t.currentTarget){case this.btn_queding:if(this._curNum<1)return;if(-1==this._selectIdx)return void showToast(LanMgr.getLan("",10249));var e={};e[Protocol.game_item_useItem.args.itemId]=this._itemVo.id,e[Protocol.game_item_useItem.args.count]=this._curNum,e[Protocol.game_item_useItem.args.optionId]=this._selectIdx,PLC.request(Protocol.game_item_useItem,e,function(t,e){t&&(UIUtil.showRewardView(t.commonData),dispatchEvt(new i.BagEvent(i.BagEvent.USE_ITEM_SUCCESS)),UIMgr.hideUIByName(UIConst.RewardSelectView))})}},e.prototype.onItemRender=function(t,e){if(t){t.img_chk.on(Laya.Event.CLICK,this,this.onChkItem,[e]);var i=t.dataSource,n=tb.TB_item.get_TB_itemById(i.id);t.ui_item.dataSource=i,t.lab_name.text=i.getName(),t.lab_name.color=ItemVo.ITEM_QUALITY_COLORS[n.quality]}},e.prototype.onChkItem=function(t){this._selectIdx==t?this._selectIdx=-1:this._selectIdx=t;for(var e=0;e<this.list_reward.cells.length;e++)this.list_reward.cells[e].img_chk.selected=e==this._selectIdx},e);function e(){var t=n.call(this)||this;return t.num=1,t.count=0,t._selectIdx=-1,t._curNum=1,t._maxNum=1,t}i.RewardSelectView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=ui.bag.RecycleUI,__extends(i,e),i.prototype.close=function(){e.prototype.close.call(this,"",!0),this.list_equips.array=null},i.prototype.popup=function(){e.prototype.popup.call(this,!1,!0),this.init()},i.prototype.init=function(){this.equchange(),this.pingzhi(),this.changImg(),this.chooseItem(QualityConst.WHITE),this.chooseItem(QualityConst.GREEN),this._clickflag=!0},i.prototype.chooseItem=function(t){0<this._numAry[t-1]&&(this["img_"+t].visible||this.onChoose(t))},i.prototype.equchange=function(){this.list_equips.array=this._model.getEquList()},i.prototype.onRecycle=function(){var t=this;if(this._clickflag){this._clickflag=!1,Laya.timer.once(200,this,function(){t._clickflag=!0});for(var e=new Array,i=0;i<this.list_equips.array.length;i++){var n=this.list_equips.array[i];n.selected&&e.push(n)}e.length<=0?showToast(LanMgr.getLan("",11011)):dispatchEvt(new o.BagEvent(o.BagEvent.FENJIE_EQUIPS),e)}else showToast(LanMgr.getLan("",11012))},i.prototype.pingzhi=function(){this._numAry=o.BagModel.getInstance().countQuality(this.list_equips.array),this.showQualityNum(this._numAry)},i.prototype.showQualityNum=function(t){this.btn_white.label="X"+t[0],this.btn_green.label="X"+t[1],this.btn_blue.label="X"+t[2],this.btn_purple.label="X"+t[3]},i.prototype.onChoose=function(t){if(0<this._numAry.length&&0<this._numAry[t-1]){var e=this["img_"+t];e.visible=!e.visible;for(var i=0;i<this.list_equips.array.length;i++){var n=this.list_equips.array[i];n.quality==t&&n.selected!=e.visible&&(n.selected=e.visible,this.list_equips.setItem(i,n))}}else showToast(LanMgr.getLan("",11013))},i.prototype.changImg=function(){for(var t=0,e=0,i=0,n=0,o=0;o<this.list_equips.array.length;o++){var a=this.list_equips.array[o];a.selected&&(a.quality==QualityConst.WHITE?t++:a.quality==QualityConst.GREEN?e++:a.quality==QualityConst.BLUE?i++:a.quality==QualityConst.PURPLE&&n++)}this.img_1.visible=this._numAry&&0!=t&&0<this._numAry.length&&this._numAry[0]==t,this.img_2.visible=this._numAry&&0!=e&&0<this._numAry.length&&this._numAry[1]==e,this.img_3.visible=this._numAry&&0!=i&&0<this._numAry.length&&this._numAry[2]==i,this.img_4.visible=this._numAry&&0!=n&&0<this._numAry.length&&this._numAry[3]==n},i);function i(){var t=e.call(this)||this;return t.isModelClose=!0,t.btn_recycle.on(Laya.Event.CLICK,t,t.onRecycle),t.btn_white.on(Laya.Event.CLICK,t,t.onChoose,[QualityConst.WHITE]),t.btn_green.on(Laya.Event.CLICK,t,t.onChoose,[QualityConst.GREEN]),t.btn_blue.on(Laya.Event.CLICK,t,t.onChoose,[QualityConst.BLUE]),t.btn_purple.on(Laya.Event.CLICK,t,t.onChoose,[QualityConst.PURPLE]),t.bgPanel.dataSource={uiName:UIConst.Bag_RecycleView,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12591)},t._model=o.BagModel.getInstance(),t}o.RecycleView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.bag.BagUI,__extends(i,e),i.prototype.initUi=function(){this.bagItemList=new common.BagRenderList(600,598),this.bagItemList.itemRender=a.BagIR,this.bagItemList.spaceY=1,this.bagItemList.x=47,this.bagItemList.y=158,this.bagItemList.max=1e6,this.boxContent.addChildAt(this.bagItemList,5),this.list_buttons.selectHandler=new Handler(this,this.onSelect),this.list_buttons.renderHandler=new Handler(this,this.onRender),this.btn_decomposition.on(Laya.Event.CLICK,this,this.onDecomposition),this.raceList.selectHandler=new Handler(this,this.onRaceSelect),this.raceList.selectedIndex=-1,this.godList.array=null,this.godList.mouseHandler=new Handler(this,this.onMouseHandler),this.raceList.array=[0,1,2,3,4,5],this.btnFenjie.on(Laya.Event.CLICK,this,this.onFenjie),this.treasureList.array=null,this.treasureList.mouseHandler=new Handler(this,this.onClickTreasure),this.btnTreasureRebirth.on(Laya.Event.CLICK,this,this.onTreasureRebirth),this.btnTreasureTujian.on(Laya.Event.CLICK,this,this.onTreasureTujian),this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.BEIBAO)},i.prototype.show=function(){e.prototype.show.call(this,!1,!1),this.list_buttons.dataSource=SkinUtil.bagButtons,this.list_buttons.selectedIndex=-1==this.dataSource?0:this.dataSource,UIUtil.boxScaleTween(this.boxContent,.5,1,310,.05)},i.prototype.onSelect=function(t){-1!=t&&(this.delayListSetData(t),this.img_racebg.visible=0==t)},i.prototype.equchange=function(){var t=this.list_buttons.selectedIndex;t!=a.TABTYPE.HERO&&t!=a.TABTYPE.EQU||this.delayListSetData(t)},i.prototype.materialChange=function(){var t=this.list_buttons.selectedIndex;t==a.TABTYPE.CAILIAO&&this.delayListSetData(t)},i.prototype.onFenjie=function(){dispatchEvt(new a.FenjieEvent(a.FenjieEvent.SHOW_FENJIE_VIEW))},i.prototype.delayListSetData=function(t){Laya.timer.frameOnce(2,this,this.updateData,[t])},i.prototype.updateData=function(t){var e=null==t?this.list_buttons.selectedIndex:t,i=e==a.TABTYPE.HERO,n=e==a.TABTYPE.TREASURE;if(this.lbGodCount.visible=this.godList.visible=this.raceList.visible=i,this.treasureList.visible=this.btnTreasureRebirth.visible=this.btnTreasureTujian.visible=n,this.bagItemList.visible=!i&&!n,this.btn_decomposition.visible=e==a.TABTYPE.EQU,this.btnFenjie.visible=e==a.TABTYPE.HERO,i)this.raceList.selectedIndex=-1!=this.raceList.selectedIndex?this.raceList.selectedIndex:0;else if(n){this.raceList.selectedIndex=-1;var o=a.TreasureModel.getInstance().getBagViewList();this.treasureList.array=o,this.lab_empty.visible=0==o.length}else this.raceList.selectedIndex=-1,this.bagItemList.dataSource=this._model.getListByType(e),this.lab_empty.visible=!this.bagItemList.dataSource||0==this.bagItemList.dataSource.length},i.prototype.onRaceSelect=function(e){if(-1!=e){var t=App.hero.getGodArr().filter(function(t){return!t.isInLinuep(iface.tb_prop.lineupTypeKey.attack)});(t=0==e?t:t.filter(function(t){return t.getRaceType()==e})).forEach(function(t){t.sortNum=1e5*-t.starLevel-100*t.level-10*t.tab_god.quality+t.tab_god.race_type}),t.sort(function(t,e){return t.sortNum-e.sortNum});var i=t.map(function(t){var e=GodItemVo.getData(t,t.uuid);return e.levelStr=""+e.level,e});this.godList.array=i,this.updateCount(),this.list_buttons.selectedIndex==a.TABTYPE.HERO&&(this.lab_empty.visible=0==i.length)}},i.prototype.updateCount=function(){if(this.list_buttons.selectedIndex==a.TABTYPE.HERO){var t=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum)-App.hero.getLineUpTeamIds(iface.tb_prop.lineupTypeKey.attack,!1).length;this.lbGodCount.text=LanMgr.getLan("",12350)+"："+this.godList.array.length+"/"+t}else a.TABTYPE.TREASURE},i.prototype.onMouseHandler=function(t,e){if(t.type==Laya.Event.CLICK){var i=this.godList.array.map(function(t){return t.uuid});dispatchEvt(new a.GodEvent(a.GodEvent.SHOW_GOD_CULTURE_VIEW),[e,i])}},i.prototype.onClickTreasure=function(t,e){if(t.type==Laya.Event.CLICK){var i=this.treasureList.getItem(e);i&&a.TreasureTipsView.popupTip(i,null,!1,{showStrengthBtn:!0,showStarBtn:!0})}},i.prototype.onTreasureRebirth=function(){dispatchEvt(new a.TreasureEvent(a.TreasureEvent.SHOW_REBIRTH_VIEW))},i.prototype.onTreasureTujian=function(){dispatchEvt(new a.TreasureEvent(a.TreasureEvent.SHOW_TUJIAN_VIEW))},i.prototype.onRender=function(t,e){if(t.dataSource){t.btn_type.skin=t.dataSource,t.btn_zhuobu.selected=e==this.list_buttons.selectedIndex;var i=a.BagModel.bagTypeName[e];t.redPoint.redpointName!=i&&t.redPoint.setRedPointName(i)}},i.prototype.stopScroll=function(){this.bagItemList&&this.bagItemList.stopScroll()},i.prototype.updateItem=function(t){if(this.belongTab(t)){var e=this.bagItemList.dataSource;if(e){for(var i=0;i<e.length;i++)for(var n=e[i],o=0;o<n.length;o++){var a=n[o];if(a instanceof ItemVo&&t instanceof ItemVo){if(t.id==a.id){if(t.count<=0)return void this.delayListSetData();t.selectid=a.selectid,t.indexid=a.indexid,t.countFromBag=!0,n.splice(o,1,t);var r=Math.floor(a.indexid/6);return void((s=this.bagItemList.getCell(r))&&s.updataItem(o))}}else if(a instanceof EquipItemVo&&t instanceof EquipItemVo&&t.uuid==a.uuid){var s;return t.selectid=a.selectid,t.indexid=a.indexid,n.splice(o,1,t),r=Math.floor(a.indexid/6),void((s=this.bagItemList.getCell(r))&&s.updataItem(o))}}this.delayListSetData()}}},i.prototype.belongTab=function(t){var e=this.list_buttons.selectedIndex;return e==a.TABTYPE.HERO||t instanceof ItemVo&&e==a.TABTYPE.SUIPIAN&&t.type==iface.tb_prop.itemTypeKey.chip||t instanceof ItemVo&&e==a.TABTYPE.CAILIAO&&t.type==iface.tb_prop.itemTypeKey.materials||t instanceof ItemVo&&e==a.TABTYPE.CAILIAO&&t.type==iface.tb_prop.itemTypeKey.gift||t instanceof ItemVo&&e==a.TABTYPE.CAILIAO&&t.type==iface.tb_prop.itemTypeKey.optionalCard||t instanceof EquipItemVo&&e==a.TABTYPE.EQU||t instanceof LimitItemVo&&e==a.TABTYPE.CAILIAO||t.type==iface.tb_prop.itemTypeKey.optionalCard&&e==a.TABTYPE.CAILIAO},i.prototype.onDecomposition=function(){dispatchEvt(new a.BagEvent(a.BagEvent.OPEN_SELL_VIEW))},i.prototype.refreshGod=function(){var t=this.raceList.selectedIndex;this.raceList.selectedIndex=-1,this.raceList.selectedIndex=t},i.prototype.refreshTreasure=function(t){if(void 0===t&&(t=!1),this.list_buttons.selectedIndex==a.TABTYPE.TREASURE)if(t){var e=a.TreasureModel.getInstance().getBagViewList();this.treasureList.array=e,this.lab_empty.visible=0==e.length}else this.treasureList.refresh()},i.prototype.close=function(){e.prototype.close.call(this,null,!1),this.list_buttons.selectedIndex=-1,this.raceList.selectedIndex=-1,this.godList.array=null,this.bagItemList.dataSource=null,this.treasureList.array=null,Laya.timer.clearAll(this)},i);function i(){var t=e.call(this)||this;return t.recycleVisible=!1,t.group=UIConst.hud_group,t._model=a.BagModel.getInstance(),t.initUi(),t}a.BagView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.bag.RecycBoxUI,__extends(n,e),n.prototype.onClick=function(){this._dataSource&&(this._dataSource.selected=!this._dataSource.selected,this.boxGouxuan.visible=this._dataSource.selected,this._dataSource.quality>=QualityConst.WHITE&&this._dataSource.quality<=QualityConst.PURPLE&&dispatchEvt(new t.BagEvent(t.BagEvent.SELECT_RECYCLE_ITEM)))},Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){t?(this.ui_base.dataSource=t,this.boxGouxuan.visible=t.selected,this.ui_base.anim_select.visible=!1):this.ui_base.dataSource=null},n);function n(){var t=e.call(this)||this;return t.on(Laya.Event.CLICK,t,t.onClick),t}t.RecycIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=ui.bag.DetailsUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.btn_equipWear.off(Laya.Event.CLICK,this,this.equipWear),this.closeTime(),this._dataSource instanceof EquipItemVo?this.refreshEquip(this._dataSource):this.refreshItem()},enumerable:!0,configurable:!0}),i.prototype.refreshItem=function(){if(this._dataSource){this.box_item.visible=!0,this.box_equip.visible=!1;var t=this._dataSource;if(t instanceof ItemVo){var e=tb.TB_item.get_TB_itemById(t.id);this.lab_itemname.text=e.name,this.lab_info.text=String(e.desc),this.lab_get.text=e.way,this.btn_shiyong.visible=t.type==iface.tb_prop.itemTypeKey.gift||t.type==iface.tb_prop.itemTypeKey.timeItem||t.type==iface.tb_prop.itemTypeKey.optionalCard,this.btn_quanbushiyong.visible=t.type==iface.tb_prop.itemTypeKey.gift,this.btn_qianwangshiyong.visible=!(t.type==iface.tb_prop.itemTypeKey.gift||t.type==iface.tb_prop.itemTypeKey.chip||t.type==iface.tb_prop.itemTypeKey.timeItem||t.type==iface.tb_prop.itemTypeKey.optionalCard),this.btn_hecheng.visible=t.type==iface.tb_prop.itemTypeKey.chip,this.btn_quanbuhecheng.visible=t.type==iface.tb_prop.itemTypeKey.chip,this.lab_time.visible=t.type==iface.tb_prop.itemTypeKey.timeItem,this.lab_time.visible&&(t.limitTime>App.getServerTime()?this.startTime():this.lab_time.text=""),this.vo=t}}},i.prototype.startScrollText=function(t){this.prevY=this.lab_info.mouseY,dispatchEvt(new r.BagEvent(r.BagEvent.STOP_SCROLL)),this.lab_info.on(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.finishScrollText)},i.prototype.finishScrollText=function(t){this.lab_info.off(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.finishScrollText)},i.prototype.scrollText=function(t){dispatchEvt(new r.BagEvent(r.BagEvent.STOP_SCROLL));var e=this.lab_info.mouseY;this.lab_info.textField.scrollY+=this.prevY-e,this.prevY=e},i.prototype.closeTime=function(){Laya.timer.clear(this,this.updateTime),this.lab_time.text=""},i.prototype.startTime=function(){this.updateTime(),Laya.timer.loop(1e3,this,this.updateTime)},i.prototype.updateTime=function(){var t=this._dataSource.limitTime;t>App.getServerTime()?this.lab_time.text=LanMgr.getLan("",12511)+GameUtil.toCountdown(t-App.getServerTime(),"hh:mm:ss"):this.closeTime()},i.prototype.onUseone=function(){if(this.vo.type==iface.tb_prop.itemTypeKey.optionalCard)UIMgr.showUI(UIConst.RewardSelectView,this.vo);else if(1==this.vo.count){if(this.lab_time.visible&&0<this.lab_time.text.length){var t=this._dataSource.limitTime;return void showToast(LanMgr.getLan("",10247,activityTime(t,App.getServerTime())))}var e={};this.vo.type==iface.tb_prop.itemTypeKey.timeItem?(e[Protocol.game_item_useTimeItem.args.timeKey]=this.vo.uuid,PLC.request(Protocol.game_item_useTimeItem,e,function(t,e){t&&(UIUtil.showRewardView(t.commonData),dispatchEvt(new r.BagEvent(r.BagEvent.USE_ITEM_SUCCESS)))})):(e[Protocol.game_item_useItem.args.itemId]=this.vo.id,e[Protocol.game_item_useItem.args.count]=1,PLC.request(Protocol.game_item_useItem,e,function(t,e){t&&(UIUtil.showRewardView(t.commonData),dispatchEvt(new r.BagEvent(r.BagEvent.USE_ITEM_SUCCESS)))}))}else UIMgr.showUI(UIConst.Bag_UseView,this.vo)},i.prototype.onUseall=function(){if(this.vo.count){var t={};t[Protocol.game_item_useItem.args.itemId]=this.vo.id,t[Protocol.game_item_useItem.args.count]=this.vo.count,PLC.request(Protocol.game_item_useItem,t,function(t,e){t&&(UIUtil.showRewardView(t.commonData),dispatchEvt(new r.BagEvent(r.BagEvent.USE_ITEM_SUCCESS)))})}},i.prototype.onGotouse=function(){var t=tb.TB_item.get_TB_itemById(this.vo.id);dispatchEvt(new r.HudEvent(r.HudEvent.SHOW_MODULE_VIEW,t.link)),UIMgr.hideUIByName(UIConst.ItemDetailView)},i.prototype.onHecheng=function(){var t=tb.TB_item.get_TB_itemById(this.vo.id);if(this.vo.count<2*t.using_effect[1]){if(Math.floor(this.vo.count/t.using_effect[1])<1)return void showToast(LanMgr.getLan("",10248));if(t.type==iface.tb_prop.itemTypeKey.chip&&2==t.defined[0]&&App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum)<=r.GodUtils.getGodsNum()+1){var e=LanMgr.getLan("",10226);return void common.AlertBox.showAlert({text:e,confirmCb:function(){dispatchEvt(new r.FenjieEvent(r.FenjieEvent.SHOW_FENJIE_VIEW))}})}var i={};i[Protocol.game_item_useItem.args.itemId]=this.vo.id,i[Protocol.game_item_useItem.args.count]=t.using_effect[1],PLC.request(Protocol.game_item_useItem,i,function(t,e){t&&(UIUtil.showRewardView(t.commonData),dispatchEvt(new r.BagEvent(r.BagEvent.USE_ITEM_SUCCESS)))})}else UIMgr.showUI(UIConst.Bag_UseView,this.vo)},i.prototype.onHechengAll=function(){var t=tb.TB_item.get_TB_itemById(this.vo.id);if(0<this.vo.count){var e=Math.floor(this.vo.count/t.using_effect[1]);if(e<1)return void showToast(LanMgr.getLan("",10248));var i=e*t.using_effect[1];if(2==t.defined[0]){var n=App.hero.getGodsNum()+e;if(App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum)<=n){var o=LanMgr.getLan("",10226);return void common.AlertBox.showAlert({text:o,confirmCb:function(){dispatchEvt(new r.FenjieEvent(r.FenjieEvent.SHOW_FENJIE_VIEW))}})}}else if(1==t.defined[0]&&(n=App.hero.getEqusNum()+e,tb.TB_game_set.get_TB_game_setById(1).limit_equip<=n))return void showToast(LanMgr.getLan("",11014));var a={};a[Protocol.game_item_useItem.args.itemId]=this.vo.id,a[Protocol.game_item_useItem.args.count]=i,PLC.request(Protocol.game_item_useItem,a,function(t,e){t&&(UIUtil.showRewardView(t.commonData),dispatchEvt(new r.BagEvent(r.BagEvent.USE_ITEM_SUCCESS)))})}},i.prototype.refresh=function(t){this.vo.count-=t},i.prototype.refreshEquip=function(t){this.box_item.visible=!1,this.box_equip.visible=!0;var e=this.getEquipTyoe(t);this.lab_equipName.text=t.tab_item.name,this.lab_equipName.event(Laya.Event.RESIZE),this.lab_godName.text=t.getWearGodName(),this.lab_symbol.visible=0!=t.getStrengthLv(),this.lab_strengthLv.visible=0!=t.getStrengthLv(),this.lab_refineLv.text=t.getRefineLevel().toString(),this.list_proprety.dataSource=t.getAttributeByValue(1,0),this.lab_strengthLv.text=t.getStrengthLv().toString(),this.btn_equipWear.on(Laya.Event.CLICK,this,this.equipWear,[e]);var i=r.EquipModel.getInstance().arrOpertionName;this.btn_equipWear.label=i[e],this.btn_equipRefine.selected=this.btn_equipRefine.gray=!App.IsSysOpen(ModuleConst.EQUIP_JINGLIAN),this.btn_equipStrength.selected=this.btn_equipStrength.gray=!App.IsSysOpen(ModuleConst.EQUIP_STRENGTH),this.btn_equipStrength.visible=this.btn_equipRefine.visible=!1},i.prototype.equipRefine=function(){dispatchEvt(new r.EquipEvent(r.EquipEvent.SHOW_EQUIPREFINE_PANEL),this._dataSource)},i.prototype.equipStrength=function(){dispatchEvt(new r.EquipEvent(r.EquipEvent.SHOW_EQUIP_STH_PANEL),this._dataSource)},i.prototype.equipWear=function(t){dispatchEvt(new r.EquipEvent(r.EquipEvent.EQUIP_OPERATION),[this._dataSource,t])},i.prototype.getEquipTyoe=function(t){var e=r.EquipModel.getInstance(),i=e.showEquipByView;if(this.btn_equipWear.visible=!0,i==EquipType.BAG_VIEW){if(!t.isExsitGod())return 0;this.btn_equipWear.visible=!1}else{if(i==EquipType.EQUIP_VIEW){var n=e.curPointEquipData;return t.uuid==n.uuid?t.godId?3:2:t.godId||n.godId?1:2}if(i==EquipType.SHENLING_VIEW||i==EquipType.SHENLING_BAOSHI_VIEW)return t.getGodName()?1:2}},i);function i(){var t=e.call(this)||this;return t.btn_shiyong.on(Laya.Event.CLICK,t,t.onUseone),t.btn_quanbushiyong.on(Laya.Event.CLICK,t,t.onUseall),t.btn_qianwangshiyong.on(Laya.Event.CLICK,t,t.onGotouse),t.btn_hecheng.on(Laya.Event.CLICK,t,t.onHecheng),t.btn_quanbuhecheng.on(Laya.Event.CLICK,t,t.onHechengAll),t.btn_equipRefine.on(Laya.Event.CLICK,t,t.equipRefine),t.btn_equipStrength.on(Laya.Event.CLICK,t,t.equipStrength),t.lab_info.mouseEnabled=!0,t.lab_info.mouseThrough=!1,t.lab_info.on(Laya.Event.MOUSE_DOWN,t,t.startScrollText),t}r.DetailIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.bag.ItemBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){if(this._dataSource){var t=this._dataSource,e=(this.ui_base.dataSource=t).isChip();(this.img_suipian.visible=e)&&GameUtil.isFunction(t.getChipSkin)&&(this.img_suipian.skin=t.getChipSkin());var i=Number(t.getStar());this.list_star.visible=0!=i,this.drawStar(i);var n=Number(t.showRace());this.img_race.visible=0!=n,this.img_race.visible&&(this.img_race.skin=SkinUtil.getGodRaceSkin(n)),this.img_zhizhen.visible=t.selectid==t.indexid,t instanceof ItemVo?t.type==iface.tb_prop.itemTypeKey.gift||t.type==iface.tb_prop.itemTypeKey.optionalCard?this.redpoint.setRedPointName("bag_material_"+t.id):t.type==iface.tb_prop.itemTypeKey.chip?this.redpoint.setRedPointName("bag_suipian_"+t.id):t.type==iface.tb_prop.itemTypeKey.timeItem?this.redpoint.setRedPointName("bag_timeItem_"+t.uuid):this.redpoint.onDispose():this.redpoint.onDispose()}else this.ui_base.dataSource=null,this.img_suipian.visible=!1,this.list_star.visible=!1,this.img_race.skin="",this.img_zhizhen.visible=!1,this.redpoint.onDispose()},n.prototype.drawStar=function(t){if(this.list_star.visible){for(var e=new Array,i=5<t,n=i?t-5:t,o=0;o<n;o++)e.push(i?SkinUtil.superXing:SkinUtil.iconxing);this.list_star.dataSource=e}},n.prototype.onStarRender=function(t){t.skin=t.dataSource},n);function n(){var t=e.call(this)||this;return t.list_star.renderHandler=new Handler(t,t.onStarRender),t}t.BoxIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.bag.BaseBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){if(t){if(this.label_number.text="",this.lab_equiprefine.text="",this.img_icon.skin=t.getIconUrl(),this.img_qulity.skin=t.getQulity(),this.lbLevel.visible=!1,GameUtil.isFunction(t.getLvStr)){var e=t.getLvStr();this.lbLevel.visible=e&&""!=e,this.lbLevel.text=e}if(t instanceof ItemVo||t instanceof tb.TB_item){var i=Number(t.getNum());this.label_number.visible=0<i,this.label_number.text="x"+Snums(i)}else if(t instanceof EquipItemVo){var n=Number(t.getRefineLevel());this.lab_equiprefine.text="+"+n;var o=Number(t.getStrengthLv());this.label_number.visible=0!=o,this.label_number.text="+"+o}this.anim_select.visible=t.selectid==t.indexid,this.anim_select.play()}else this.img_icon.skin="",this.img_qulity.skin="",this.label_number.text="",this.lab_equiprefine.text="",this.anim_select.gotoAndStop(0)},n);function n(){return e.call(this)||this}t.BaseBox=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.bag.ItemRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){if(this._dataSource){var t=this._dataSource[0].bag?6:7,e=this._dataSource;if(Math.floor(e[0].indexid/t)==(-1==e[0].selectid?-1:Math.floor(e[0].selectid/t))){for(var i=void 0,n=0;n<e.length;n++)e[n].indexid==e[n].selectid&&(i=e[n]);logdebug(i),this.onShow(i)}else this.onHide();this.list_lineitem.array=e}else this.onHide(),this.list_lineitem.array=null},n.prototype.updataItem=function(t){var e=this.list_lineitem.array[t];this.list_lineitem.setItem(t,e),!this.isShow()||this.ui_detail.dataSource.id==e.id&&(this.ui_detail.dataSource=e)},n.prototype.clickAchi=function(t,e){t.type==Laya.Event.CLICK&&this.showDetail(this.list_lineitem.array[e])},n.prototype.showDetail=function(t){dispatchEvt(new common.TreeEvent(common.TreeEvent.SELECT_TAB,t))},n.prototype.onShow=function(t){this.ui_detail.visible=!0,this.ui_detail.dataSource=t,this.height=360,this.ui_detail.img_di.width=t.bag?590:620},n.prototype.onHide=function(){this.ui_detail.visible=!1,this.ui_detail.dataSource=null,this.height=115},n.prototype.isShow=function(){return this.ui_detail.visible},n);function n(){var t=e.call(this)||this;return t.list_lineitem.mouseHandler=new Handler(t,t.clickAchi),t}t.BagIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=tl3d.Processor,__extends(n,t),n.prototype.getName=function(){return"BagProcessor"},n.prototype.listenModuleEvents=function(){return[new e.BagEvent(e.BagEvent.SHOW_BAG_PANEL),new e.BagEvent(e.BagEvent.USE_MANY_ITEM),new e.BagEvent(e.BagEvent.OPEN_SELL_VIEW),new e.BagEvent(e.BagEvent.CHANGE_ITEM),new e.BagEvent(e.BagEvent.STOP_SCROLL),new e.BagEvent(e.BagEvent.SELECT_RECYCLE_ITEM),new e.BagEvent(e.BagEvent.FENJIE_EQUIPS),new e.BagEvent(e.BagEvent.CHANGE_EQUIP_ITEM),new e.GodEvent(e.GodEvent.ADD_GODS),new e.GodEvent(e.GodEvent.GOD_CHANGE),new e.GodEvent(e.GodEvent.GOD_PORP_CHANGE),new e.GemstoneEvent(e.GemstoneEvent.ADD_GEMTONE),new e.GemstoneEvent(e.GemstoneEvent.MODIFY_GEMTONE)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.BagEvent)switch(t.type){case e.BagEvent.SHOW_BAG_PANEL:this.show_BagView(t.data);break;case e.BagEvent.STOP_SCROLL:this.stopScroll();break;case e.BagEvent.USE_MANY_ITEM:this.useManyItem(t.data);break;case e.BagEvent.OPEN_SELL_VIEW:this.openSell();break;case e.BagEvent.FENJIE_EQUIPS:this.fenjie(t.data);break;case e.BagEvent.CHANGE_EQUIP_ITEM:this.equChange(t.data);break;case e.BagEvent.CHANGE_ITEM:this.viewHasStage&&this.changeItemVo(t.data);break;case e.BagEvent.SELECT_RECYCLE_ITEM:this.reCycleHasStage&&this.reCycleview.changImg()}if(t instanceof e.GodEvent)switch(t.type){case e.GodEvent.ADD_GODS:case e.GodEvent.GOD_CHANGE:UIMgr.hasStage(UIConst.BagView)&&UIMgr.getUIByName(UIConst.BagView).refreshGod();break;case e.GodEvent.GOD_PORP_CHANGE:UIMgr.hasStage(UIConst.BagView)&&UIMgr.hasStage(UIConst.God_GodCultureView)&&UIMgr.getUIByName(UIConst.BagView).refreshGod()}if(t instanceof e.GemstoneEvent)switch(t.type){case e.GemstoneEvent.ADD_GEMTONE:case e.GemstoneEvent.MODIFY_GEMTONE:UIMgr.hasStage(UIConst.BagView)&&UIMgr.getUIByName(UIConst.BagView).materialChange()}},n.prototype.equChange=function(t){this.viewHasStage&&(t.type==e.EQUTYPE.MODIFY?this.bagview.updateItem(t.vo):this.bagview.equchange()),this.reCycleHasStage&&t.type==e.EQUTYPE.DEL&&(this.reCycleview.equchange(),this.reCycleview.pingzhi(),this.reCycleview.changImg())},n.prototype.showSummonPanel=function(t){UIMgr.showUI(UIConst.ZH_ResultView,t)},n.prototype.fenjie=function(t){0<t.length?UIMgr.showUI(UIConst.Equip_Recycle,t):showToast(LanMgr.getLan("",11011))},n.prototype.show_BagView=function(t){this.viewHasStage||(e.EquipModel.getInstance().showEquipByView=EquipType.BAG_VIEW,UIMgr.showUI(UIConst.BagView,t))},n.prototype.stopScroll=function(){this.viewHasStage&&this.bagview.stopScroll()},n.prototype.useManyItem=function(t){var e=t[0],i=t[1],n=0;if(e.count>=i){var o={};o[Protocol.game_item_useItem.args.itemId]=e.id,e.type==iface.tb_prop.itemTypeKey.chip?1==Number(e.using[0])&&(n=i*Number(e.using[1])):n=i,o[Protocol.game_item_useItem.args.count]=n,PLC.request(Protocol.game_item_useItem,o,function(t,e){t&&(UIUtil.showRewardView(t.commonData),UIMgr.hideUIByName(UIConst.Bag_UseView))})}},n.prototype.changeItemVo=function(t){t.show=!1,t.bag=!0,this.bagview.updateItem(t)},n.prototype.openSell=function(){UIMgr.showUI(UIConst.Bag_RecycleView)},Object.defineProperty(n.prototype,"bagview",{get:function(){return UIMgr.getUIByName(UIConst.BagView)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewHasStage",{get:function(){return UIMgr.hasStage(UIConst.BagView)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reCycleview",{get:function(){return UIMgr.getUIByName(UIConst.Bag_RecycleView)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reCycleHasStage",{get:function(){return UIMgr.hasStage(UIConst.Bag_RecycleView)},enumerable:!0,configurable:!0}),n);function n(){return t.call(this)||this}e.BagProcessor=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"BagModule"},n.prototype.listProcessors=function(){return[new t.BagProcessor]},n.prototype.onRegister=function(){t.BagModel.getInstance()},n);function n(){return e.call(this)||this}t.BagModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_BAG_PANEL="SHOW_BAG_PANEL",r.USE_MANY_ITEM="USE_MANY_ITEM",r.OPEN_SELL_VIEW="OPEN_SELL_VIEW",r.FENJIE_EQUIPS="FENJIE_EQUIPS",r.CHANGE_ITEM="CHANGE_ITEM",r.CHANGE_EQUIP_ITEM="CHANGE_EQUIP_ITEM",r.SELECT_RECYCLE_ITEM="SELECT_RECYCLE_ITEM",r.STOP_SCROLL="STOP_SCROLL",r.USE_ITEM_SUCCESS="USE_ITEM_SUCCESS",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.BagEvent=a}(game=game||{}),function(c){var o,t,a,e,i,n;(t=o=c.LIMITTIMETYPE||(c.LIMITTIMETYPE={}))[t.DEL=0]="DEL",t[t.ADD=1]="ADD",(e=a=c.EQUTYPE||(c.EQUTYPE={}))[e.DEL=0]="DEL",e[e.ADD=1]="ADD",e[e.MODIFY=2]="MODIFY",(n=i=c.TABTYPE||(c.TABTYPE={}))[n.HERO=0]="HERO",n[n.SUIPIAN=1]="SUIPIAN",n[n.CAILIAO=2]="CAILIAO",n[n.EQU=3]="EQU",n[n.TREASURE=4]="TREASURE";var r=(h.getInstance=function(){return h._instance||(h._instance=new h),h._instance},h.prototype.countQuality=function(t){for(var e=0,i=0,n=0,o=0,a=0;a<t.length;a++){var r=t[a];if(!r.godId||""==r.godId)switch(r.quality){case QualityConst.WHITE:e++;break;case QualityConst.GREEN:i++;break;case QualityConst.BLUE:n++;break;case QualityConst.PURPLE:o++}}return[e,i,n,o]},h.prototype.getAllSuipian=function(){for(var t=new Array,e=tb.TB_item.get_TB_item("type","6"),i=0;i<e.length;i++)6==e[i].type&&t.push(e[i]);return t},h.prototype.getListByType=function(t){var e=[];return t==i.HERO||(t==i.EQU?e=this.getEquList():t==i.SUIPIAN?(e=this.getBagObjByType(iface.tb_prop.itemTypeKey.chip),this.sortBagObj(e)):t==i.CAILIAO&&(e=(e=(e=(e=(e=this.getBagObjByType(iface.tb_prop.itemTypeKey.gift)).concat(this.getBagObjByType(iface.tb_prop.itemTypeKey.optionalCard))).concat(this.getBagTimeObj())).concat(this.getBagObjByType(iface.tb_prop.itemTypeKey.materials))).concat(this.getBagObjByType(iface.tb_prop.itemTypeKey.gemstone)),this.sortBagObj(e))),this.changeArry(e)},h.prototype.changeArry=function(t){for(var e=new Array,i=0;i<t.length;i++){var n=t[i];n.selectid=-1,n.indexid=i}for(var o=t.length,a=h.line_num,r=o%a==0?o/a:Math.floor(o/a+1),s=0;s<r;s++){var u=t.slice(s*a,s*a+a);e.push(u)}return e},h.prototype.getBagObjByType=function(t){for(var e=new Array,i=this.getBagObj(),n=0;n<i.length;n++){var o=i[n];o.type==t&&e.push(o)}return this.sortBagObj(e),e},h.prototype.insertResVo=function(t,e,i){var n=tb.TB_item.get_TB_itemById(t);if(n&&n.type!=iface.tb_prop.itemTypeKey.resource&&0!=e){var o=App.hero.createItemVo(e,t);o.show=!1,o.bag=!0,o.countFromBag=!0,o.lvStr=i,this._resList.push(o)}},h.prototype.getBagObj=function(){if(this._resList)return this._resList;this._resList=new Array;var t=App.hero.bagItemsObj;for(var e in t){var i=t[e];this.insertResVo(Number(e),i)}return this.updateGemstones(),this._resList},h.prototype.updateBagObj=function(t,e){if(this._resList){for(var i=0;i<this._resList.length;i++){var n=this._resList[i];if(n.id==t)return void(e<=0?this._resList.splice(i,1):n.count=e)}this.insertResVo(t,e)}},h.prototype.updateGemstones=function(){if(this._resList){for(var t=this._resList.length,e=c.GemstoneModel.getInstance(),i=[],n=t-1;0<=n;n--){var o=this._resList[n];if(o.type==iface.tb_prop.itemTypeKey.gemstone){var a=e.getGemstoneByTbID(o.id);!a||a.num<=0?this._resList.splice(n,1):(o.count=a.num,i.push(o.id))}}var r=App.hero.gemstones;for(var s in r){var u=r[s],h=tb.TB_item.get_TB_itemById(u.templateId),l=h?tb.TB_gemstone_new.getTBOneById(h.defined[0]):null;l&&!u.godId&&0<u.num&&-1==i.indexOf(u.templateId)&&this.insertResVo(u.templateId,u.num,"Lv."+l.getLevel())}}},h.prototype.getBagTimeObj=function(){if(this._timeresList)return this._timeresList;this._timeresList=new Array;var t=App.hero.bagTimeItemsObj;for(var e in t){var i=t[e];this.insertLimitTimeResVo(Number(e),i)}return this._timeresList},h.prototype.insertLimitTimeResVo=function(t,e){var i=tb.TB_item.get_TB_itemById(Number(e.templateId));if(i){var n=new LimitItemVo(t,Number(e.limitTime),i.ID,1,i.type);n.show=!1,n.bag=!0,this._timeresList.push(n)}},h.prototype.updateLimitTimeRes=function(t,e,i){if(this._timeresList)if(e!=o.ADD){if(e==o.DEL)for(var n=0;n<this._timeresList.length;n++)if(this._timeresList[n].uuid==t){this._timeresList.splice(n,1);break}}else this.insertLimitTimeResVo(t,i)},h.prototype.updateEquObj=function(t,e,i){if(this._queList){if(e==a.ADD)return i.bag=!0,void this._queList.push(i);for(var n=0;n<this._queList.length;n++)if(this._queList[n].uuid==t){if(e==a.DEL){this._queList.splice(n,1);break}if(e==a.MODIFY){i&&this._queList.splice(n,1,i);break}}}},h.prototype.getEquList=function(){var t=this.getNoEquObj();return t.sort(function(t,e){return t.quality-e.quality}),t},h.prototype.getNoEquObj=function(){for(var t=new Array,e=this.getEquObj(),i=0;i<e.length;i++){var n=e[i];n.isExsitGod()||t.push(n)}return t},h.prototype.getEquObj=function(){if(this._queList)return this.sortEquObj(this._queList),this._queList;this._queList=App.hero.getEquips(0,!0);for(var t=0;t<this._queList.length;t++)this._queList[t].bag=!0;return this._queList},h.prototype.sortBagObj=function(t){t.sort(function(t,e){var i=0<t.using.length&&1==Number(t.using[0])?Number(t.using[1]):1,n=0<e.using.length&&1==Number(e.using[0])?Number(e.using[1]):1,o=App.hero.getBagItemNum(t.id)>=i;if(o!=App.hero.getBagItemNum(e.id)>=n)return o?-1:1;if(t.type==e.type)return t.id-e.id;var a=2==t.type?100:10==t.type?90:t.type;return(2==e.type?100:10==e.type?90:e.type)-a})},h.prototype.sortEquObj=function(t){t.sort(function(t,e){var i=t.isExsitGod();return i==e.isExsitGod()?t.tab_item.quality==e.tab_item.quality?t.strengthLv==e.strengthLv?e.refineLv-t.refineLv:e.strengthLv-t.strengthLv:e.tab_item.quality-t.tab_item.quality:i?-1:1})},h.line_num=5,h.bagTypeName=["","bag_group_suipian","bag_group_cailiao","bag_group_zhuangbei",""],h);function h(){}c.BagModel=r}(game=game||{}),function(t){var e=(i.prototype.addItem=function(t){this.objList.push(t)},i.prototype.getNum=function(){return this.objList.length},i.prototype.getTotalVal=function(t){for(var e=0,i=0;i<this.objList.length;i++)e+=this.objList[i].getAttrValByKeyOnBaseAttr(t);return e},i);function i(){this.objList=[]}t.TabBaptizeVo=e}(game=game||{}),function(i){var t=(e.prototype.add=function(t){var e=t.getRaceType();this.map.hasOwnProperty(e)||(this.map[e]=new i.TabBaptizeVo),this.map[e].addItem(t)},e.prototype.getNumByRaceType=function(t){var e=0;if(0==t)for(var i in this.map)e+=this.map[i].getNum();else this.map.hasOwnProperty(t)&&(e+=this.map[t].getNum());return e},e.prototype.getValByRaceType=function(t,e){var i=0;for(var n in this.map)0!=t&&t!=Number(n)||(i+=this.map[n].getTotalVal(e));return i},e);function e(){this.map={}}i.TabBaptizeMap=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.artifact.ArtifactUnLockUI,__extends(n,e),n.prototype.close=function(){e.prototype.close.call(this),this.uiScene.onExit(),Laya.timer.clearAll(this)},n.prototype.show=function(){e.prototype.show.call(this,!1,!1),this.uiScene.onShow(),this.initView(this.dataSource)},n.prototype.initView=function(t){var e=this;t&&(this.lab_text.text=LanMgr.getLan("",12512,t.name),this.lab_text.centerX=0,Laya.Tween.to(this.img_bg,{alpha:0},500,null,Handler.create(this,function(){e.uiScene.addEffect(e,10000016,new tl3d.Vector3D(180,0,-350),7,3,null,180),Laya.timer.frameOnce(60,e,function(){e.refreshModel(t)}),Laya.Tween.to(e.lab_text,{alpha:1},500),Laya.Tween.to(e.lab_close,{alpha:1},800,null,Handler.create(e,function(){e.isModelClose=!0,dispatchEvt(new i.ArtifactEvent(i.ArtifactEvent.SHOW_VISIBLE_TRUE))}))})))},n.prototype.refreshModel=function(t){var e=t.location;this.uiScene.addModelChar(t.model.toString(),(Laya.stage.width>>1)+Number(e[0])-Launch.offsetX,Number(e[1]+150),Number(e[2]),Number(e[3]),Number(e[4]))},n.prototype.onExit=function(){this.isModelClose&&(this.img_bg.alpha=1,this.lab_text.alpha=0,this.lab_text.text="",this.lab_close.alpha=0,this.isModelClose=!1,this.close())},n);function n(){var t=e.call(this)||this;return t.lab_text.text="",t.lab_text.alpha=0,t.lab_close.alpha=0,t.isModelClose=!1,t.img_bg.zOrder=100,t.uiScene=new Base2dSceneLayer,t.addChild(t.uiScene),t.img_zhezhao.on(Laya.Event.CLICK,t,t.onExit),t}i.UnLockView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var o,t=(o=ui.artifact.ArtifactUI,__extends(s,o),s.prototype.initHtmlText=function(){this._htmlText.style.fontSize=this.lab_skilldesc.fontSize,this._htmlText.style.leading=this.lab_skilldesc.leading,this._htmlText.style.height=this.lab_skilldesc.height,this._htmlText.style.width=this.lab_skilldesc.width,this._htmlText.style.color=this.lab_skilldesc.color,this._htmlText.style.font=this.lab_skilldesc.font,this._htmlText.x=this.lab_skilldesc.x,this._htmlText.y=this.lab_skilldesc.y,this._htmlText.style.wordWrap=!0,this.jineng.addChild(this._htmlText)},s.prototype.setSize=function(t,e){o.prototype.setSize.call(this,t,e),this.boxTop.y=GameUtil.isFullScreen()?5+r.HudModel.TOP_ADD_HEIGHT:5},s.prototype.show=function(){if(this.uiScene.onShow(),o.prototype.show.call(this,!1,!1),this._artifactSet=tb.TB_artifact_set.get_TB_artifact_setById(),this.dataSource&&(this.dataSource.id?this._curArtifactID=this.dataSource.id:this._curArtifactID=App.hero.getArtifactIDByLineType(),this.dataSource.index)){this._curTabIdx=this.dataSource.index;var t=this._model.getUnlockArtifactNum(),e=this._artifactSet.artifact_unlock;this._curTabIdx<e.length&&t<e[this._curTabIdx]&&(this._curTabIdx=0)}this.showShenQiList(),this.updateArtifactNum(),tl3d.ModuleEventManager.addEvent(r.ArtifactEvent.ARTIFACT_ACTIVE,this.onArtifactActive,this),tl3d.ModuleEventManager.addEvent(r.ArtifactEvent.ADJUST_LINEUP_ARTIFACT_SUCCESS,this.onArtifactWearChange,this),tl3d.ModuleEventManager.addEvent(r.ArtifactEvent.ARTIFACT_STRENGTH_LV_CHANGE,this.onArtifactStrengthChange,this),tl3d.ModuleEventManager.addEvent(r.ArtifactEvent.ARTIFACT_SKILL_LV_CHANGE,this.onArtifactSkillChange,this),tl3d.ModuleEventManager.addEvent(r.ArtifactEvent.ARTIFACT_BAPTIZE_CHANGE,this.onArtifactBaptizeChange,this),tl3d.ModuleEventManager.addEvent(r.ArtifactEvent.ARTIFACT_STAR_CHANGE,this.onArtifactStarChange,this),tl3d.ModuleEventManager.addEvent(r.ResEvent.PROP_CHANGE,this.onResoureChange,this),this.btn_lookup.on(Laya.Event.CLICK,this,this.lookup),this.btnObatin.on(Laya.Event.CLICK,this,this.showObtain),this.btn_artifact.on(Laya.Event.CLICK,this,this.artifact);var i=GameUtil.isFullScreen()?5+r.HudModel.TOP_ADD_HEIGHT:5;UIUtil.boxUpDownTween(this.boxTop,-this.boxTop.height,i,!1,310,.1);var n=this.height-this.boxBottom.height-82;UIUtil.boxUpDownTween(this.boxBottom,n+this.boxBottom.height,n,!0,310,.05)},s.prototype.onArtifactActive=function(){if(this.updateArtifactNum(),this.updateShenQiList(),this.viewStack.visible)switch(this.updateTab(),this._curTabIdx){case s.TAB_SHENGJI:this.updateStrengthCost();break;case s.TAB_JINENG:this.updateSkillCost()}},s.prototype.onArtifactWearChange=function(){this.list_shenqi.refresh(),this.btn_artifact.visible&&this.updateXiexiaBtn()},s.prototype.onArtifactStrengthChange=function(){if(this.viewStack.visible)switch(this.updateStrengthCommon(),this._curTabIdx){case s.TAB_SHENGJI:this.updateStrength();break;case s.TAB_JINENG:this.updateSkill()}},s.prototype.onArtifactSkillChange=function(){if(this.viewStack.visible)switch(this.updateSkillCommon(),this._curTabIdx){case s.TAB_JINENG:this.updateSkill()}},s.prototype.onArtifactBaptizeChange=function(){},s.prototype.onArtifactStarChange=function(){this.viewStack.visible&&(App.hero.artifactStarLv>this._starLv&&this.addStartAction(App.hero.artifactStarLv),this.updateStarCommon())},s.prototype.onResoureChange=function(){if(this.viewStack.visible)switch(this._curTabIdx){case s.TAB_SHENGJI:this.updateStrengthCost();break;case s.TAB_JINENG:this.updateSkillCost()}else this.updateNoActiveCost()},s.prototype.updateArtifactNum=function(){this.lab_unlock.text=LanMgr.getLan("",12515,this._model.getUnlockArtifactNum())},s.prototype.showShenQiList=function(){this.list_shenqi.renderHandler=Handler.create(this,this.shenqilistRender,null,!1),this.list_shenqi.selectHandler=Handler.create(this,this.shenqilistselect,null,!1),this._artifactTempArr=tb.TB_artifact.get_TB_artifact(),this.updateShenQiList()},s.prototype.selectShenQiById=function(t){for(var e=-1,i=0;i<this._artifactTempArr.length;i++)if(this._artifactTempArr[i].ID==t){e=i;break}-1!=e&&this.shenqilistselect(e)},s.prototype.updateShenQiList=function(){this._artifactTempArr&&0<this._artifactTempArr.length?(this._artifactTempArr.sort(function(t,e){var i=100*t.ID,n=100*e.ID;return App.hero.isActiveArtifact(t.ID)&&(i=10*t.ID),App.hero.isWearArtifact(e.ID)?n=e.ID:App.hero.isActiveArtifact(e.ID)&&(n=10*e.ID),i-n}),0==this._curArtifactID?(this._curArtifactID=this._artifactTempArr[0].ID,this.showShenQi(this._artifactTempArr[0])):this.showShenQi(this._curArtifactT),this.list_shenqi.dataSource=this._artifactTempArr):(this.list_shenqi.dataSource=null,this._curArtifactID=0)},s.prototype.shenqilistRender=function(t,e){var i=t.dataSource;i?(t.img_icon.skin=SkinUtil.getEquipIcon(i.icon),t.img_quality.skin=SkinUtil.getBoxQulityIcon(5),t.img_shangzhen.visible=App.hero.isWearArtifact(i.ID),t.redPoint.setRedPointName("artifact_activate_"+i.ID),t.img_icon.gray=!App.hero.isActiveArtifact(i.ID),i.ID==this._curArtifactID&&e!=this.list_shenqi.selectedIndex&&(this.list_shenqi.selectedIndex=e),t.anim_select.play()):(t.redPoint.onDispose(),t.anim_select.gotoAndStop(0))},s.prototype.shenqilistselect=function(t){var e=this.list_shenqi.dataSource[t];e&&e.ID!=this._curArtifactID&&(this._curArtifactID=e.ID,this.showShenQi(e),dispatchEvt(new r.ArtifactEvent(r.ArtifactEvent.SWITCH_ARTIFACT)))},s.prototype.clearShenQiList=function(){this.list_shenqi.renderHandler&&(this.list_shenqi.renderHandler.recover(),this.list_shenqi.renderHandler=null),this.list_shenqi.selectHandler&&(this.list_shenqi.selectHandler.recover(),this.list_shenqi.selectHandler=null),this.list_shenqi.dataSource=null,this._artifactTempArr=null,this._curArtifactID=0},s.prototype.showShenQi=function(t){(t=t||tb.TB_artifact.get_TB_artifactById(this._curArtifactID))&&(this._curArtifactT=t,this.refreshModel(t),App.hero.isActiveArtifact(t.ID)?(this.clearArtifactNoActive(),this.showArtifactActive()):(this.clearArtifactActive(),this.showArtifactNoActive()))},s.prototype.refreshModel=function(t){if(this._lastmodel!=t.model){var e=t.location;this.uiScene.addModelChar(t.model+"",360+Number(e[0]),Number(e[1])+80,Number(e[2]),Number(e[3]),Number(e[4])),this._lastmodel=t.model}},s.prototype.showArtifactActive=function(){if(this._curArtifactT){this.box_star.visible=!0,this.viewStack.visible=!0,this.btn_artifact.visible=!0,this.lab_share.visible=!0,this.tab.selectHandler=Handler.create(this,this.onTab,null,!1),this.btn_strength.on(Laya.Event.CLICK,this,this.artifactOperation,[Artifact.STRENGTH]),this.btn_skillUp.on(Laya.Event.CLICK,this,this.artifactOperation,[Artifact.SKILLUPGRADE]),this.lab_unlock_unlock.on(Laya.Event.CLICK,this,this.onClickUnlock);for(var t=["artifact_shengjiGroup_"+this._curArtifactT.ID,"artifact_jinengGroup_"+this._curArtifactT.ID,"artifact_baptizeGroup_"+this._curArtifactT.ID,"artifact_enchantGroup_"+this._curArtifactT.ID],e=0;e<this.tab.cells.length;e++){var i=this.tab.cells[e];i&&i.tabRedPoint.setRedPointName(t[e])}this.lab_name.text=""+this._curArtifactT.name,this.lab_name.event(Laya.Event.RESIZE),this.updateTab(),this.updateXiexiaBtn(),this.updateStrengthCommon(),this.updateSkillCommon(),this.updateStarCommon(),this._curTabIdx=this._curTabIdx<0?0:this._curTabIdx,this.tab.selectedIndex=this._curTabIdx,this.onTab(this.tab.selectedIndex,!0)}},s.prototype.updateTab=function(){for(var t=this._model.getUnlockArtifactNum(),e=this._artifactSet.artifact_unlock,i=0;i<this.tab.cells.length;i++){var n=!1;1<i&&i<e.length&&(n=t<e[i]);var o=this.tab.cells[i];o&&(o.img_suo.visible=n)}},s.prototype.updateXiexiaBtn=function(){App.hero.isWearArtifact(this._curArtifactID,iface.tb_prop.lineupTypeKey.attack)?this.btn_artifact.skin="shenqi/xiexia.png":this.btn_artifact.skin="shenqi/peidai.png"},s.prototype.updateStrengthCommon=function(){var t=App.hero.artifactStrengthLv;this.lab_Lv.text="Lv："+t,this.lab_Lv.event(Laya.Event.RESIZE)},s.prototype.updateSkillCommon=function(){var t=App.hero.artifactSkillLv;this.lab_skillLv.text="+"+t,this.lab_skillLv.event(Laya.Event.RESIZE)},s.prototype.updateStarCommon=function(){this._starLv=App.hero.artifactStarLv,this.list_star.repeatX=this._starLv,this.list_star.visible=0<this._starLv},s.prototype.onTab=function(n,t){if(void 0===t&&(t=!1),-1!=n&&(this._curTabIdx!=n||t)){if(1<n){var e=this._model.getUnlockArtifactNum(),i=this._artifactSet.artifact_unlock;if(n<i.length&&e<i[n]){var o=n==s.TAB_XILIAN?LanMgr.getLan("",12514):LanMgr.getLan("",12346);return showToast(LanMgr.getLan("",10244,i[n],o)),void(this.tab.selectedIndex=this._curTabIdx)}}this._curTabIdx=n,this.viewStack.selectedIndex=n,this.img_maxLv.visible=this.lab_maxLv.visible=!1;for(var a=0;a<this._closeFun.length;a++)a==n||this._closeFun[a].call(this);this._showFun[n]&&this._showFun[n].call(this),this.tab.cells.forEach(function(t,e){var i=t;i.btn_name.labelSize=n==e?24:22,i.btn_name.selected=n==e,i.btn_name.labelColors=n==e?"#7e5336,#7e5336,#7e5336":"#e6ca91,#e6ca91,#e6ca91"}),dispatchEvt(new r.ArtifactEvent(r.ArtifactEvent.SELECT_TABBAR))}},s.prototype.showStrength=function(){this.jichu.visible=!0,this.list_sj_attr.renderHandler=Handler.create(this,this.jichuRender,null,!1),this.strengthRP.setRedPointName("artifact_strength_"+this._curArtifactT.ID),this.updateStrength()},s.prototype.jichuRender=function(t,e){var i=t.dataSource;if(i){var n=t.getChildByName("box_img").getChildByName("img_jichu"),o=t.getChildByName("lab_value");o.color=e%2==0?"#7e5336":"#058623",n.skin=SkinUtil.getAttrSkin(i.key),o.text=""+i.value,t.refresh()}},s.prototype.updateStrength=function(){for(var t=App.hero.artifactStrengthLv,e=this.getStrengthAttrDesc(t),i=this.getStrengthAttrDesc(t+1),n=0;n<3;n++){var o=n<i.length?i[n]:null;e.splice(2*n+1,0,o)}this.list_sj_attr.dataSource=e,this.updateStrengthCost(t)},s.prototype.updateStrengthCost=function(t){if(void 0===t&&(t=-1),-1==t&&(t=App.hero.artifactStrengthLv),this._model.getUnlockArtifactNum()<this._artifactSet.artifact_unlock[0])this.lab_maxLv.visible=!1,this.img_maxLv.visible=!1,this.box_cost_all.visible=!1,this.btn_strength.visible=!1,this.lab_unlock_guanqia.visible=!0,this.lab_unlock_unlock.visible=!0,this.lab_unlock_guanqia.text=LanMgr.getLan("",12516,this._artifactSet.artifact_unlock[0]);else if(t>=this._artifactSet.max_strength_level)this.lab_maxLv.visible=!0,this.img_maxLv.visible=!0,this.box_cost_all.visible=!1,this.btn_strength.visible=!1,this.lab_unlock_guanqia.visible=!1,this.lab_unlock_unlock.visible=!1;else{this.lab_maxLv.visible=!1,this.img_maxLv.visible=!1,this.box_cost_all.visible=!0,this.lab_unlock_guanqia.visible=!1,this.lab_unlock_unlock.visible=!1,this.btn_strength.visible=!0,this.img_cost.skin=SkinUtil.xingcheng;var e=tb.TB_artifact_strength.get_TB_artifact_strengthById(t),i=e.cost[0][0],n=e.cost[0][1],o=App.hero.getBagItemNum(i);this.lab_has.text=Snums(o),this.lab_need.text="/"+Snums(n),this._isHasCost=n<=o,this.lab_has.event(Laya.Event.RESIZE),this.box_cost.event(Laya.Event.RESIZE),this.lab_has.stroke=this._isHasCost?0:2,this.lab_has.color=this._isHasCost?ColorConst.normalFont:"#f62e08"}},s.prototype.closeStrength=function(){this.box_cost_all.visible=!1,this.lab_maxLv.visible=!1,this.jichu.visible=!1,this.lab_unlock_guanqia.visible=!1,this.lab_unlock_unlock.visible=!1,this.list_sj_attr.renderHandler&&(this.list_sj_attr.renderHandler.recover(),this.list_sj_attr.renderHandler=null),this.list_sj_attr.dataSource=null,this.strengthRP.onDispose()},s.prototype.showSkill=function(){this.jineng.visible=!0,this.skillUpRP.setRedPointName("artifact_skillUp_"+this._curArtifactT.ID),this.updateSkill()},s.prototype.updateSkill=function(){var t=App.hero.artifactSkillLv,e=1e3*this._curArtifactID+t,i=tb.TB_artifact_skill.get_TB_artifact_skillById(e),n=tb.TB_skill.get_TB_skillById(i.skill);this.ui_skillBox.dataSource={skill:n,isShow:!1,isShowlist:!1,openDgLv:0,dgLv:0},this.lab_skillName.text=n.name.replace(/[0-9+]/gi,""),this.lab_skillName.event(Laya.Event.RESIZE),this.lab_skillLevel.text="+"+t;var o=i.next?FormatStr(n.info,i.next).replace(/[\\]/gi,""):n.info;this._htmlText.innerHTML=o;var a=App.hero.artifactStrengthLv,r=tb.TB_artifact_skillcost.get_TB_artifact_skillcostById(t);this._isCanUp=a>=r.need_level,this.btn_skillUp.gray=!this._isCanUp,this.btn_skillUp.label=this._isCanUp?LanMgr.getLan("",12517):LanMgr.getLan("",12518,r.need_level),this.updateSkillCost(t,r)},s.prototype.updateSkillCost=function(t,e){if(void 0===t&&(t=-1),void 0===e&&(e=null),-1==t&&(t=App.hero.artifactSkillLv),this._model.getUnlockArtifactNum()<this._artifactSet.artifact_unlock[1])this.lab_maxLv.visible=!1,this.img_maxLv.visible=!1,this.box_cost_all.visible=!1,this.btn_skillUp.visible=!1,this.lab_unlock_guanqia.visible=!0,this.lab_unlock_unlock.visible=!0,this.lab_unlock_guanqia.text=LanMgr.getLan("",12519,this._artifactSet.artifact_unlock[1]);else if(t>=this._artifactSet.max_skill_level)this.lab_maxLv.visible=!0,this.img_maxLv.visible=!0,this.box_cost_all.visible=!1,this.btn_skillUp.visible=!1,this.lab_unlock_guanqia.visible=!1,this.lab_unlock_unlock.visible=!1;else{this.lab_maxLv.visible=!1,this.img_maxLv.visible=!1,this.box_cost_all.visible=!0,this.lab_unlock_guanqia.visible=!1,this.lab_unlock_unlock.visible=!1,this.btn_skillUp.visible=!0,this.img_cost.skin=SkinUtil.gang;var i=(e=e||tb.TB_artifact_skillcost.get_TB_artifact_skillcostById(t)).cost[0][0],n=e.cost[0][1],o=App.hero.getBagItemNum(i);this.lab_has.text=Snums(o),this.lab_need.text="/"+Snums(n),this._isHasCost=n<=o,this.lab_has.event(Laya.Event.RESIZE),this.box_cost.event(Laya.Event.RESIZE),this.lab_has.stroke=this._isHasCost?0:2,this.lab_has.color=this._isHasCost?ColorConst.normalFont:"#f62e08"}},s.prototype.closeSkill=function(){this.box_cost_all.visible=!1,this.lab_maxLv.visible=!1,this.img_maxLv.visible=!1,this.jineng.visible=!1,this.lab_unlock_guanqia.visible=!1,this.lab_unlock_unlock.visible=!1,this.skillUpRP.onDispose(),this.ui_skillBox.dataSource=null},s.prototype.showBaptize=function(){this.tab_baptize.show(this._curArtifactT)},s.prototype.closeBaptize=function(){this.tab_baptize.close()},s.prototype.showStar=function(){this.tab_enchant.show(this._curArtifactT)},s.prototype.closeStar=function(){this.tab_enchant.close()},s.prototype.clearArtifactActive=function(){this.btn_artifact.visible=!1,this.lab_Lv.text="",this.lab_skillLv.text="",this.lab_Lv.x=0,this.lab_skillLv.x=0,this.box_star.visible=!1,this.viewStack.visible=!1,this.lab_share.visible=!1;for(var t=0;t<this._closeFun.length;t++)this._closeFun[t].call(this);this.tab.selectHandler&&(this.tab.selectHandler.recover(),this.tab.selectHandler=null),this.btn_strength.off(Laya.Event.CLICK,this,this.artifactOperation),this.btn_skillUp.off(Laya.Event.CLICK,this,this.artifactOperation),this.lab_unlock_unlock.off(Laya.Event.CLICK,this,this.onClickUnlock)},s.prototype.showArtifactNoActive=function(){if(this._curArtifactT){this.img_weijiesuo.visible=!0,this.box_jiesuo.visible=!0,this.lab_artifaceinfo.text="        "+this._curArtifactT.desc,this.btn_unlock.on(Laya.Event.CLICK,this,this.onClickUnlockBtn),this.attrList.renderHandler=Handler.create(this,this.jichuRender1,null,!1),this.lab_name.text=""+this._curArtifactT.name,this.lab_name.event(Laya.Event.RESIZE),this.lab_jiesuoname.text=LanMgr.getLan("",10434),this.attrList.array=this.getStrengthAttrDesc();var t=tb.TB_artifact_skill.get_TB_artifact_skillById(1e3*this._curArtifactID+this._artifactSet.max_skill_level),e=tb.TB_skill.get_TB_skillById(t.skill);this.lbskill.text=e.name,this.lbskilldesc.text=e.info,this.ui_maxskill.dataSource={skill:e,isShow:!1,isShowlist:!1,openDgLv:0,dgLv:0},this.updateNoActiveCost(),this.btn_unlock_red.setRedPointName("artifact_activate_"+this._curArtifactT.ID)}},s.prototype.updateNoActiveCost=function(){var t=this._curArtifactT.cost[0][0],e=this._curArtifactT.cost[0][1],i=App.hero.getBagItemNum(t);this.ui_item_cost.dataSource=this._curArtifactT.getConstItems()[0];var n=e<=i?ColorConst.normalFont:ColorConst.redFont;this.lab_cost_has.text=""+Snums(i),this.lab_cost_has.color=n,this.lab_cost_has.event(Laya.Event.RESIZE),this.lab_cost_need.text="/"+e,this.btn_unlock.gray=i<e},s.prototype.jichuRender1=function(t,e){var i=t.dataSource;if(i){var n=t.getChildByName("box_img").getChildByName("img_jichu"),o=t.getChildByName("lab_value");n.skin=SkinUtil.getAttrSkin(i.key),o.text=""+i.value,t.refresh()}},s.prototype.clearArtifactNoActive=function(){this.img_weijiesuo.visible=!1,this.box_jiesuo.visible=!1,this.btn_unlock.off(Laya.Event.CLICK,this,this.onClickUnlockBtn),this.attrList.renderHandler&&(this.attrList.renderHandler.recover(),this.attrList.renderHandler=null),this.attrList.array=null,this.ui_maxskill.dataSource=null,this.ui_item_cost.dataSource=null,this.btn_unlock_red.onDispose()},s.prototype.onClickUnlock=function(){UIMgr.showUI(UIConst.GuajiView),UIMgr.showUI(UIConst.UpRoadView)},s.prototype.onClickUnlockBtn=function(){this.artifactOperation(Artifact.ACTIVATE)},s.prototype.lookup=function(){this._curArtifactT&&UIUtil.showCommonTipView([[LanMgr.getLan("",12520),this._curArtifactT.desc]])},s.prototype.showObtain=function(){UIMgr.showUI(UIConst.Artifact_ObtainTip)},s.prototype.artifact=function(){if(this._curArtifactT){var t={id:App.hero.isWearArtifact(this._curArtifactT.ID,iface.tb_prop.lineupTypeKey.attack)?0:this._curArtifactT.ID,type:iface.tb_prop.lineupTypeKey.attack};dispatchEvt(new r.ArtifactEvent(r.ArtifactEvent.ARTIFACT_OPERATION),[t,Artifact.WEAR_OR_TAKEOFF])}},s.prototype.getStrengthAttrDesc=function(t){void 0===t&&(t=-1);var e=[];(-1==t||t>this._artifactSet.max_strength_level)&&(t=this._artifactSet.max_strength_level);var i=tb.TB_artifact_strength.get_TB_artifact_strengthById(t).strength_attr;for(var n in i){var o={key:0,name:"",value:""};o.value="+"+i[n][1],o.name=LanMgr.attrName[i[n][0]],o.key=i[n][0],e.push(o)}return e},s.prototype.artifactOperation=function(t){if(t==Artifact.SKILLUPGRADE){if(!this._isCanUp){var e=tb.TB_artifact_skillcost.get_TB_artifact_skillcostById(App.hero.artifactSkillLv);return void showToast(LanMgr.getLan("",10245,e.need_level))}if(!this._isHasCost)return void showToast(LanMgr.getLan("",Lans.cost,406))}else{if(t==Artifact.RECYCLE)return;if(t==Artifact.ACTIVATE){var i=this._curArtifactT.cost;if(App.hero.getBagItemNum(i[0][0])<i[0][1])return void showToast(LanMgr.getLan("",10246));var n=tb.TB_sys_open.get_TB_sys_openById(ModuleConst.ARTIFACT);if(n&&!App.IsSysOpen(ModuleConst.ARTIFACT))return void showToast(n.prompt)}else if(t==Artifact.STRENGTH&&!this._isHasCost)return void showToast(LanMgr.getLan("",Lans.cost,405))}t!=Artifact.ACTIVATE&&this.uiScene.scene.playLyf(getEffectUrl("1000004"),new tl3d.Vector3D(180,0,-440),20,4),dispatchEvt(new r.ArtifactEvent(r.ArtifactEvent.ARTIFACT_OPERATION),[this._curArtifactID,t])},s.prototype.addStartAction=function(t){var e=this;if(!this._imgStar){this._imgStar=new Laya.Image(SkinUtil.xingxing);var i=this.tab_enchant.startPos,n=this.globalToLocal(i);this._imgStar.pos(n.x,n.y),this._imgStar.anchorY=.5,this.addChild(this._imgStar),this._imgStar.scale(2,2)}Laya.Tween.to(this._imgStar,{x:218+48*t,y:702,scaleX:.5,scaleY:.5},1500,Laya.Ease.quintInOut,Handler.create(this,function(){e._imgStar.destroy(),e._imgStar=null}))},s.prototype.onClosed=function(){o.prototype.onClosed.call(this),tl3d.ModuleEventManager.removeEvent(r.ArtifactEvent.ARTIFACT_ACTIVE,this.onArtifactActive,this),tl3d.ModuleEventManager.removeEvent(r.ArtifactEvent.ADJUST_LINEUP_ARTIFACT_SUCCESS,this.onArtifactWearChange,this),tl3d.ModuleEventManager.removeEvent(r.ArtifactEvent.ARTIFACT_STRENGTH_LV_CHANGE,this.onArtifactStrengthChange,this),tl3d.ModuleEventManager.removeEvent(r.ArtifactEvent.ARTIFACT_SKILL_LV_CHANGE,this.onArtifactSkillChange,this),tl3d.ModuleEventManager.removeEvent(r.ArtifactEvent.ARTIFACT_BAPTIZE_CHANGE,this.onArtifactBaptizeChange,this),tl3d.ModuleEventManager.removeEvent(r.ArtifactEvent.ARTIFACT_STAR_CHANGE,this.onArtifactStarChange,this),tl3d.ModuleEventManager.removeEvent(r.ResEvent.PROP_CHANGE,this.onResoureChange,this),this.btn_lookup.off(Laya.Event.CLICK,this,this.lookup),this.btnObatin.off(Laya.Event.CLICK,this,this.showObtain),this.btn_artifact.off(Laya.Event.CLICK,this,this.artifact),this.clearShenQiList(),this.clearArtifactActive(),this.clearArtifactNoActive(),this._curArtifactT=null,this._curTabIdx=-1,this._lastmodel=null,this.uiScene.onExit()},s.TAB_SHENGJI=0,s.TAB_JINENG=1,s.TAB_XILIAN=2,s.TAB_SHENGXING=3,s.TAB_NUM=4,s);function s(){var t=o.call(this)||this;return t._htmlText=new Laya.HTMLDivElement,t._curArtifactID=0,t._curTabIdx=-1,t.initHtmlText(),t.uiScene=new Base2dSceneLayer,t.addChildAt(t.uiScene,1),t.group=UIConst.hud_group,t.tab.array=[[LanMgr.getLan("",10304)],[LanMgr.getLan("",12513)],[LanMgr.getLan("",12514)],[LanMgr.getLan("",12346)]],t._showFun=[],t._closeFun=[],t._showFun[s.TAB_SHENGJI]=t.showStrength,t._closeFun[s.TAB_SHENGJI]=t.closeStrength,t._showFun[s.TAB_JINENG]=t.showSkill,t._closeFun[s.TAB_JINENG]=t.closeSkill,t._showFun[s.TAB_XILIAN]=t.showBaptize,t._closeFun[s.TAB_XILIAN]=t.closeBaptize,t._showFun[s.TAB_SHENGXING]=t.showStar,t._closeFun[s.TAB_SHENGXING]=t.closeStar,t._model=r.ArtifactModel.getInstance(),t.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.ARTIFACT),t}r.ArtifactView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.artifact.ArtifactListUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12521)},this.addChild(this.bgPanel.btnClose)},n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.zOrder=UI_DEPATH_VALUE.TOP+3,this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.zOrder=UI_DEPATH_VALUE.TOP+3,this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.listShenqi.array=null},n.prototype.initView=function(){this.listShenqi.array=tb.TB_artifact.get_TB_artifact()},n);function n(){return i.call(this)||this}t.ArtifactListView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=ui.artifact.itemRender.ArtifactListIRUI,__extends(i,e),i.prototype.initHtmlText=function(){this._htmlText.style.fontSize=this.lbDesc.fontSize,this._htmlText.style.leading=this.lbDesc.leading,this._htmlText.style.height=this.lbDesc.height,this._htmlText.style.width=this.lbDesc.width,this._htmlText.style.color=this.lbDesc.color,this._htmlText.style.font=this.lbDesc.font,this._htmlText.x=this.lbDesc.x,this._htmlText.y=this.lbDesc.y,this._htmlText.style.wordWrap=!0,this.lbDesc.visible=!1,this.addChild(this._htmlText)},Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),i.prototype.refreshView=function(){var t=this.dataSource;if(t){this.imgShenqi.skin=SkinUtil.getArtifCircleIcon(t.icon),this.lbName.text=t.name;var e=u.ArtifactModel.getInstance().isUnlock(t.ID),i=App.hero.isWearArtifact(t.ID,iface.tb_prop.lineupTypeKey.attack);this.imgSuo.visible=this.imgShenqi.gray=this.btnOperate.gray=!e,this.imgSuo.visible=!e,this.btnOperate.label=e?i?LanMgr.getLan("",12522):LanMgr.getLan("",12366):LanMgr.getLan("",10434),this.btnOperate.on(Laya.Event.CLICK,this,this.onOperate);var n=App.hero.artifactSkillLv,o=1e3*t.ID+n,a=tb.TB_artifact_skill.get_TB_artifact_skillById(o),r=tb.TB_skill.get_TB_skillById(a.skill),s=a.next?FormatStr(r.info,a.next).replace(/[\\]/gi,""):r.info;this._htmlText.innerHTML=s}else this.btnOperate.off(Laya.Event.CLICK,this,this.onOperate)},i.prototype.onOperate=function(){if(this.btnOperate.gray)showToast(LanMgr.getLan("",10243));else{var t=this.dataSource;if(t){var e={id:App.hero.isWearArtifact(t.ID,iface.tb_prop.lineupTypeKey.attack)?0:t.ID,type:iface.tb_prop.lineupTypeKey.attack};dispatchEvt(new u.ArtifactEvent(u.ArtifactEvent.ARTIFACT_OPERATION),[e,Artifact.WEAR_OR_TAKEOFF])}}},i);function i(){var t=e.call(this)||this;return t._htmlText=new Laya.HTMLDivElement,t.initHtmlText(),t}u.ArtifactListIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=ui.artifact.tip.ObtainTipUI,__extends(i,e),i.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},i.prototype.initView=function(){var t=u.ArtifactModel.getInstance(),e="",i=(u.ArtifactModel.getArtObtain(),t.getUnlockArtifactNum());this.lbhas.text=LanMgr.getLan("",12515,i);var n=tb.TB_artifact_obtain.get_TB_artifact_obtain();for(var o in n){var a=~~n[o].ID<=i?ColorConst.TASK_GREEN:ColorConst.normalFont;for(var r in e+="<span style='color:"+a+";'>"+n[o].ID+LanMgr.getLan("",12524)+"：</span>",n[o].attr){var s=n[o].attr[r];e+="<span style='color:"+a+";'>"+LanMgr.attrName[s[0]]+(1<=Number(s[2])?"+"+s[2]:"+"+100*s[2]+"%")+"</span><span></span>&nbsp;",2==~~r&&3<n[o].attr.length&&(e+="<br/><span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")}e+="<br/><br/><br/>"}this._htmlText.innerHTML=e},i.prototype.initHtmlText=function(){this._htmlText.style.fontSize=this.lab_details.fontSize,this._htmlText.style.leading=this.lab_details.leading,this._htmlText.style.color=ColorConst.GRAY,this._htmlText.style.width=this.width,this._htmlText.style.valign="center",this._htmlText.y=this.lab_details.y+10,this._htmlText.x=this.lab_details.x-25,this._htmlText.style.wordWrap=!0,this.addChild(this._htmlText)},i.prototype.onClosed=function(){},i);function i(){var t=e.call(this)||this;return t._htmlText=new Laya.HTMLDivElement,t.initHtmlText(),t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.Artifact_ObtainTip,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12523)},t}u.ObtainTip=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var u,e=(u=ui.artifact.tip.EnchantTipUI,__extends(i,u),i.prototype.popup=function(){u.prototype.popup.call(this);var t=App.hero.artifactStarLv;this.lab_explain.text=LanMgr.getLan("",12526),this.lab_lv.text=LanMgr.getLan("",12529,t),this.lab_tips.text=LanMgr.getLan("",12527);var e=TableData.getInstance().getTableByName(TableData.tb_artifact_enchant);for(var i in e.data){var n=e.data[i].ID;if(!(n<2)){var o=n<=t?this.lab_details:this.lab_details_no;o.text+=""+n+LanMgr.getLan("",12528)+"：";var a=e.data[i].enchant_special;for(var r in a)0<Number(r)&&Number(r)<2&&(o.text+=","),o.text+=LanMgr.attrName[a[r][0]]+"+",o.text+=4<a[r][0]?Math.floor(100*a[r][2])+"%":""+a[r][2],0<Number(r)&&Number(r)<2&&3<=a.length&&(o.text+="\n");o.text+="\n"}}var s=this.lab_details.text;this.lab_details.text=s.substring(0,s.length-1),this.lab_details_no.y=this.lab_details.y+this.lab_details.height},i.prototype.onClosed=function(){u.prototype.onClosed.call(this),this.lab_details.text="",this.lab_details_no.text=""},i);function i(){var t=u.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.Artifact_EnchantTip,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12525)},t}t.EnchantTip=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.artifact.tip.BaptizeTipUI,__extends(n,i),n.prototype.popup=function(){i.prototype.popup.call(this);var t=App.hero.artifactBaptizeLv,e=App.hero.artifactBaptizeExp;this.lab_Lv.text=LanMgr.getLan("",12531,t),this.lab_Exp.text=LanMgr.getLan("",12532)+"："+e+"/"+tb.TB_artifact_baptize.get_TB_artifact_baptizeById(t).exp},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.lab_Lv.text="",this.lab_Exp.text=""},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.Artifact_BaptizeTip,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12530)},t}t.BaptizeTip=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=ui.artifact.tab.ArtifactEnchantUI,__extends(i,e),i.prototype.show=function(t){t&&(this._tbSet=tb.TB_artifact_set.get_TB_artifact_setById(),this._curArtifactT=t,this._curStarLv=App.hero.artifactStarLv,this._curStarExp=App.hero.artifactStarExp,this._curArtifactEnchant=tb.TB_artifact_enchant.get_TB_artifact_enchantById(this._curStarLv),this.btn_auto.on(Laya.Event.CLICK,this,this.onAuto),this.btn_fumo.on(Laya.Event.CLICK,this,this.enchant),this.btn_lookup.on(Laya.Event.CLICK,this,this.lookup),this.list_teshu.renderHandler=Handler.create(this,this.teshuRender,null,!1),tl3d.ModuleEventManager.addEvent(o.ArtifactEvent.ARTIFACT_STAR_CHANGE,this.onStarChange,this),tl3d.ModuleEventManager.addEvent(o.ResEvent.PROP_CHANGE,this.updateCost,this),this.setAutoBtnLabel(!1),this.fumoRP.setRedPointName("artifact_enchant_"+this._curArtifactT.ID),this.updateView())},i.prototype.onStarChange=function(){var t=!1,e=App.hero.artifactStarExp;if(e!=this._curStarExp){var i=e-this._curStarExp;i<0&&(i+=this._curArtifactEnchant.plan),this._curStarExp=e,t=!0,0<i&&this.addEffectText(i)}var n=App.hero.artifactStarLv;n!=this._curStarLv&&(this._curStarLv=n,this._curArtifactEnchant=tb.TB_artifact_enchant.get_TB_artifact_enchantById(this._curStarLv),t=!0),t?(this.updateView(),this._auto&&Laya.timer.once(200,this,this.enchant)):this.setAutoBtnLabel(!1)},i.prototype.updateView=function(){for(var t=App.hero.artifactStarExp,e=t/this._tbSet.enchant_plan,i=o.ArtifactModel.getInstance().getEnchantAtttri(this._curArtifactEnchant,e,!0),n=1;n<4;n++)this["lab_value"+n].text="+"+i[0][n-1],this["img_jichu"+n].skin=SkinUtil.getAttrSkin(n),this["hbox_"+n].event(Laya.Event.RESIZE);this.list_teshu.dataSource=this._curArtifactEnchant.enchant_special,this.list_teshu.visible=0<=this._curArtifactEnchant.enchant_special.length,this.lab_info.visible=!this.list_teshu.visible,1==this._curArtifactEnchant.enchant_special.length?this.list_teshu.x=275:2==this._curArtifactEnchant.enchant_special.length?this.list_teshu.x=165:this.list_teshu.x=80,this.lab_exp.text=0==this._curArtifactEnchant.plan?"Max":t+"/"+this._curArtifactEnchant.plan,this.exp_progressBar.value=0==this._curArtifactEnchant.plan?1:t/this._curArtifactEnchant.plan,this.lab_chance.text=this._curArtifactEnchant.getOddStrByOdds(t),this.btn_fumo.label=0!=this._curArtifactEnchant.plan?LanMgr.getLan("",12346):LanMgr.getLan("",12533),this.updateCost()},i.prototype.updateCost=function(){var t=this._curArtifactEnchant.cost[0],e=this._curArtifactEnchant.cost[1],i=App.hero.getBagItemNum(t);0==this._curArtifactEnchant.plan?(this.box_cost.visible=!1,this.img_cost_bg.visible=!1):(this.box_cost.visible=!0,this.img_cost_bg.visible=!0,this._isEnchant=e<=i,this.lab_has.color=this._isEnchant?ColorConst.normalFont:"#f62e08",this.lab_need.text="/"+e,this.lab_has.stroke=this._isEnchant?0:2,this.lab_has.text=""+i,this.lab_has.event(Laya.Event.RESIZE),this.box_cost.event(Laya.Event.RESIZE))},i.prototype.setAutoBtnLabel=function(t){this._auto=t,this.btn_auto.label=this._auto?LanMgr.getLan("",12535):LanMgr.getLan("",12534),this.btn_auto.skin=this._auto?SkinUtil.buttonRed:SkinUtil.buttonNormal,this.btn_auto.labelStrokeColor=this._auto?ColorConst.RED_FILTER:ColorConst.ORANGE_FILTER,this._auto?(o.GuideMask.show(this.btn_auto,o.DirectionType.none,null,!0,null,0,!1),this.enchant()):o.GuideMask.hide()},i.prototype.teshuRender=function(t,e){var i=t.getChildByName("lab_teshu"),n=t.getChildByName("lab_value"),o=t.dataSource;o?(n.text=4<o[0]?"+"+Math.floor(100*o[2])+"%":"+"+o[2],i.text=""+LanMgr.attrName[o[0]],i.event(Laya.Event.RESIZE),t.event(Laya.Event.RESIZE)):(i.text="",n.text="")},i.prototype.lookup=function(){UIMgr.showUI(UIConst.Artifact_EnchantTip)},i.prototype.onAuto=function(){Laya.timer.currTimer<this._clickAutoTime||(this._clickAutoTime=Laya.timer.currTimer+500,this.setAutoBtnLabel(!this._auto))},i.prototype.enchant=function(){this.isCanEnchant()?dispatchEvt(new o.ArtifactEvent(o.ArtifactEvent.ARTIFACT_OPERATION),[this._curArtifactT.ID,Artifact.ENCHANT]):this._auto&&this.setAutoBtnLabel(!1)},i.prototype.isCanEnchant=function(){return 5<=this._curStarLv?(showToast(LanMgr.getLan("",10242)),!1):!!this._isEnchant||(showToast(LanMgr.getLan("",Lans.cost,this._curArtifactEnchant.cost[0])),!1)},i.prototype.addEffectText=function(t){var e=this,i=Laya.Pool.getItemByClass("EffectText",a);i.pos(this.exp_progressBar.x+this.exp_progressBar.width/2+10,this.exp_progressBar.y),i.text="+"+t,i.setProprety(),this.addChild(i),Laya.Tween.to(i,{y:i.y-100,alpha:0},700,null,new Handler(i,function(){Laya.Pool.recover("EffectText",i),e.removeChild(i)}))},Object.defineProperty(i.prototype,"startPos",{get:function(){return this.exp_progressBar.localToGlobal(new Laya.Point(this.exp_progressBar.width,0))},enumerable:!0,configurable:!0}),i.prototype.close=function(){this.btn_auto.off(Laya.Event.CLICK,this,this.onAuto),this.btn_fumo.off(Laya.Event.CLICK,this,this.enchant),this.btn_lookup.off(Laya.Event.CLICK,this,this.lookup),tl3d.ModuleEventManager.removeEvent(o.ArtifactEvent.ARTIFACT_STAR_CHANGE,this.onStarChange,this),tl3d.ModuleEventManager.removeEvent(o.ResEvent.PROP_CHANGE,this.updateCost,this),this.list_teshu.renderHandler&&(this.list_teshu.renderHandler.recover(),this.list_teshu.renderHandler=null),this.list_teshu.array=null,this.setAutoBtnLabel(!1),this.fumoRP.onDispose(),this._tbSet=null,this._curArtifactT=null,this._curStarLv=0,this._curStarExp=0,this._curArtifactEnchant=null,this.list_teshu.array=null,Laya.timer.clearAll(this)},i);function i(){var t=e.call(this)||this;return t._clickAutoTime=0,t}o.TabEnchant=t;var n,a=(n=Laya.Label,__extends(r,n),r.prototype.setProprety=function(t){this.alpha=1},r);function r(){var t=n.call(this)||this;return t.anchorY=.5,t.fontSize=25,t.color="#058623",t}}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=ui.artifact.tab.ArtifactBaptizeUI,__extends(i,e),i.prototype.initRaceNum=function(){if(!this._raceMap){this._raceMap=new u.TabBaptizeMap;for(var t=App.hero.getLineUpTeam(iface.tb_prop.lineupTypeKey.attack),e=0;e<t.length;e++)this._raceMap.add(t[e])}},i.prototype.getTotalForce=function(t){var e=0;for(var i in t){var n=t[i];e+=this.getForce(n[3],n[0],n[2])}return Math.floor(e)},i.prototype.getForce=function(t,e,i){var n=0,o=0,a=tb.TB_game_set.get_TB_game_setById(1);return o=4<e||1<=i?this._raceMap.getNumByRaceType(t):this._raceMap.getValByRaceType(t,e),n=4<e?o*i:Math.floor(o*i),n*=Number(a.attr_para[e-1][1])},i.prototype.show=function(t){t&&(this._clickflag=!0,this.initRaceNum(),this._curArtifactTemp=t,this._tbSet=tb.TB_artifact_set.get_TB_artifact_setById(),this._attriLvSum=this._tmpAttriLvSum=0,this._maxAttriLv=null,this.btn_lookup.on(Laya.Event.CLICK,this,this.lookup),this.btn_change.on(Laya.Event.CLICK,this,this.change),this.btn_pBaptize.on(Laya.Event.CLICK,this,this.baptize,[Artifact.PBAPTIZE]),this.btn_gBaptize.on(Laya.Event.CLICK,this,this.baptize,[Artifact.GBAPTIZE]),this.list_attri.renderHandler=Handler.create(this,this.onRender,null,!1),tl3d.ModuleEventManager.addEvent(u.ResEvent.PROP_CHANGE,this.setCostText,this),tl3d.ModuleEventManager.addEvent(u.ArtifactEvent.ARTIFACT_BAPTIZE_CHANGE,this.updateBaptize,this),this.updateView(),this._hasTempAttr=isEmptyObject(App.hero.artifactBaptizeTempAttr))},i.prototype.updateBaptize=function(t){var e=this;if(t.data==Artifact.GBAPTIZE){this._clickflag=!1;var i=this.lab_nextforce.localToGlobal(new Laya.Point(0,0)),n=this.uiScenes.get3dPos(i.x-30-Launch.offsetX,i.y+80-Launch.offsetY);this.uiScenes.addEffect(this,10000029,n,4,30,function(t){e._clickflag=!0},0,0,!0),clearTimeout(this.updateBaptizeTick),this.updateBaptizeTick=setTimeout(function(){if(e._hasTempAttr)return e.updateView(),void(e._hasTempAttr=!1);e.updateView()},300)}else this.updateView()},i.prototype.updateView=function(){var t=App.hero.artifactBaptizeLv;this.lab_Lv.text=t+LanMgr.getLan("",10031),this.updateAttr(),this.setCostText()},i.prototype.updateAttr=function(){this.lab_isNull.visible=isEmptyObject(App.hero.artifactBaptizeTempAttr),this.baseUpdateAttr()},i.prototype.baseUpdateAttr=function(){this.list_attri.dataSource=App.hero.artifactBaptizeAttrs?[[],[],[]]:null;var t=App.hero.artifactBaptizeAttrs;this._nextForce=0,this._curForce=this.getTotalForce(t),this.lab_force.text=LanMgr.getLan("",10117,this._curForce);var e=isEmptyObject(App.hero.artifactBaptizeTempAttr);this.lab_nextforce.visible=!e,this.lab_arrow.visible=!e,this.lab_nextforce.visible&&(this._nextForce=this.getTotalForce(App.hero.artifactBaptizeTempAttr),this.lab_nextforce.text=LanMgr.getLan("",10117,this._nextForce)),this.lab_arrow.text=this._curForce>this._nextForce?" ↓":this._curForce<this._nextForce?" ↑":"",this.lab_arrow.x=this.lab_nextforce.x+this.lab_nextforce.width/2+5,this.lab_arrow.color=this._curForce>this._nextForce?"#ff0000":"#319c28"},i.prototype.onRender=function(e,t){var i=this,n=(u.ArtifactModel.getInstance(),t+1),o=App.hero.artifactBaptizeAttrs,a=App.hero.artifactBaptizeTempAttr;if(o.hasOwnProperty(n)){e.lab_curValue.text=1<=o[n][2]?"+"+o[n][2]:"+"+100*o[n][2]+"%",e.lab_curAttri.text=LanMgr.GOD_RACE_NAME[o[n][3]]+LanMgr.attrName[o[n][0]];var r=this._tbs.findIndex(function(t){return t.isOnScope(o[n])});e.lab_curValue.color="#"+this._qualityColors[r],this._attriLvSum+=r}else e.lab_curValue.text="",e.lab_curAttri.text="";if(a&&a.hasOwnProperty(n)){e.lab_nextValue.text=1<=a[n][2]?"+"+a[n][2]:"+"+100*a[n][2]+"%",e.lab_nextAttri.text=LanMgr.GOD_RACE_NAME[a[n][3]]+LanMgr.attrName[a[n][0]];var s=this._tbs[this._tbs.length-1].isMaxAttr(a[n]);r=this._tbs.findIndex(function(t){return t.isOnScope(a[n])}),this.maxArrtiLv={Lv:r+2,index:n,isMaxAttr:~~s},e.lab_nextValue.color="#"+this._qualityColors[r],this._tmpAttriLvSum+=r}else e.lab_nextValue.text="",e.lab_nextAttri.text="";e.img_false.hasListener(Laya.Event.CLICK)||e.img_false.on(Laya.Event.CLICK,this,function(){var t=App.hero.artifactBaptizeAttrs;2<=i._suodingNum?showToast(LanMgr.getLan("",10238)):t.hasOwnProperty(n)?(i.setsuodingNum(!0),e.img_false.visible=!e.img_false.visible,e.img_true.visible=!e.img_false.visible):showToast(LanMgr.getLan("",10239))}),e.img_true.hasListener(Laya.Event.CLICK)||e.img_true.on(Laya.Event.CLICK,this,function(){0<i._suodingNum&&i.setsuodingNum(!1),e.img_true.visible=!e.img_true.visible,e.img_false.visible=!e.img_true.visible}),e.lab_nextAttri.event(Laya.Event.RESIZE),e.lab_curAttri.event(Laya.Event.RESIZE)},i.prototype.setsuodingNum=function(t){var e=this;if(t?this._suodingNum++:this._suodingNum--,0<this._suodingNum){var i=this._tbSet.lock_cost.findIndex(function(t){return t[0]==e._suodingNum});-1!=i&&(this.lab_suo.text=LanMgr.getLan("",12537,this._suodingNum,this._tbSet.lock_cost[i][2]))}else this.lab_suo.text=LanMgr.getLan("",12536)},i.prototype.setCostText=function(){var t=App.hero.getBagItemNum(this._tbSet.general_baptize[0][0]),e=App.hero.getBagItemNum(this._tbSet.rare_baptize[0][0]);this._ispBaptize=t>=this._tbSet.general_baptize[0][1],this._isgBaptize=e>=this._tbSet.rare_baptize[0][1],this.lab_pHas.color=this._ispBaptize?ColorConst.normalFont:"#f62e08",this.lab_gHas.color=this._isgBaptize?ColorConst.normalFont:"#f62e08",this.lab_pNeed.text="/"+this._tbSet.general_baptize[0][1],this.lab_gNeed.text="/"+this._tbSet.rare_baptize[0][1],this.lab_pHas.stroke=this._ispBaptize?0:2,this.lab_gHas.stroke=this._isgBaptize?0:2,this.lab_pHas.text=""+t,this.lab_gHas.text=""+e,this.lab_pHas.event(Laya.Event.RESIZE),this.lab_gHas.event(Laya.Event.RESIZE)},Object.defineProperty(i.prototype,"maxArrtiLv",{set:function(t){(!this._maxAttriLv||t.Lv>this._maxAttriLv.Lv)&&(this._maxAttriLv={Lv:t.Lv,index:t.index}),this._maxAttriLv.isMaxAttr||(this._maxAttriLv.isMaxAttr=0),this._maxAttriLv.isMaxAttr+=t.isMaxAttr},enumerable:!0,configurable:!0}),i.prototype.lookup=function(){UIMgr.showUI(UIConst.Artifact_BaptizeTip,this.dataSource)},i.prototype.change=function(){var t=this;this._clickflag&&(isEmptyObject(App.hero.artifactBaptizeTempAttr)?showToast(LanMgr.getLan("",10240)):this._nextForce<this._curForce?common.AlertBox.showAlert({text:LanMgr.getLan("",10241),confirmCb:function(){dispatchEvt(new u.ArtifactEvent(u.ArtifactEvent.ARTIFACT_OPERATION),[t._curArtifactTemp.ID,Artifact.CHANGE])},parm:null}):dispatchEvt(new u.ArtifactEvent(u.ArtifactEvent.ARTIFACT_OPERATION),[this._curArtifactTemp.ID,Artifact.CHANGE]))},i.prototype.baptize=function(t){if(this._clickflag)if(t!=Artifact.PBAPTIZE||this._ispBaptize)if(t!=Artifact.GBAPTIZE||this._isgBaptize)if(this._nextForce>this._curForce){var e=this;common.AlertBox.showAlert({text:LanMgr.getLan("",10495),confirmCb:function(){e.onSurebaptize(t)},parm:null})}else this.onSurebaptize(t);else showToast(LanMgr.getLan("",Lans.cost,this._tbSet.rare_baptize[0][0]));else showToast(LanMgr.getLan("",Lans.cost,this._tbSet.general_baptize[0][0]))},i.prototype.onSurebaptize=function(e){var i=this,n=[];if(e=e==Artifact.PBAPTIZE?iface.tb_prop.baptizeTypeKey.normal:iface.tb_prop.baptizeTypeKey.advanced,this.list_attri.cells.forEach(function(t,e){t.img_true.visible&&n.push(e+1)}),0<n.length){var t=this._tbSet.lock_cost.findIndex(function(t){return t[0]==i._suodingNum});if(-1!=t&&App.hero.diamond<this._tbSet.lock_cost[t][2])return void showToast(LanMgr.getLan("",10005))}if(isEmptyObject(this._maxAttriLv)||n.some(function(t){return t==i._maxAttriLv.index})||!(5<=this._maxAttriLv.Lv)||u.ArtifactModel.getInstance().hint){if(!ExtConfig.RELEASE&&123==ExtConfig.LOG_LEVEL){if(!isEmptyObject(this._maxAttriLv)&&0<this._maxAttriLv.isMaxAttr-this._suodingNum&&6==this._maxAttriLv.Lv)return void(this._maxAttriLv.isMaxAttr=0);Laya.timer.frameOnce(5,this,this.baptize,[Artifact.GBAPTIZE])}this.startOperation(),dispatchEvt(new u.ArtifactEvent(u.ArtifactEvent.ARTIFACT_OPERATION),[{id:this._curArtifactTemp.ID,type:e,lockFlag:n},Artifact.PBAPTIZE])}else common.TishiView.showTishi({text:LanMgr.getLan("",12538),confirmCb:function(t){i.startOperation(),dispatchEvt(new u.ArtifactEvent(u.ArtifactEvent.ARTIFACT_OPERATION),[{id:i._curArtifactTemp.ID,type:e,hint:t,lockFlag:n},Artifact.PBAPTIZE])},parm:null})},i.prototype.startOperation=function(){App.hero.artifactBaptizeTempAttr={},this.lab_isNull.visible=!1,this.baseUpdateAttr()},i.prototype.close=function(){this._raceMap=null,this.pxilianRP.onDispose(),this.gxilianRP.onDispose(),this.btn_lookup.off(Laya.Event.CLICK,this,this.lookup),this.btn_change.off(Laya.Event.CLICK,this,this.change),this.btn_pBaptize.off(Laya.Event.CLICK,this,this.baptize),this.btn_gBaptize.off(Laya.Event.CLICK,this,this.baptize),this.list_attri.renderHandler&&(this.list_attri.renderHandler.recover(),this.list_attri.renderHandler=null),tl3d.ModuleEventManager.removeEvent(u.ResEvent.PROP_CHANGE,this.setCostText,this),tl3d.ModuleEventManager.removeEvent(u.ArtifactEvent.ARTIFACT_BAPTIZE_CHANGE,this.updateBaptize,this),clearTimeout(this.updateBaptizeTick),this.uiScenes.onExit()},i);function i(){var t=e.call(this)||this;return t._attriLvSum=0,t._suodingNum=0,t._tmpAttriLvSum=0,t._tbs=tb.TB_baptize.get_TB_baptize(),t._curForce=0,t._nextForce=0,t._qualityColors=["46a035","21a1dc","c23cf3","f26b01","ff1726"],t.uiScenes=new Base2dSceneLayer,t.addChild(t.uiScenes),t}u.TabBaptize=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"ArtifactProcessor"},i.prototype.listenModuleEvents=function(){return[new a.ArtifactEvent(a.ArtifactEvent.SHOW_ARTIFACT_PANEL),new a.ArtifactEvent(a.ArtifactEvent.SHOW_ARTIFACT_LIST_PANEL),new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_OPERATION)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof a.ArtifactEvent)switch(t.type){case a.ArtifactEvent.SHOW_ARTIFACT_PANEL:this.showArtifactPanel(t.data);break;case a.ArtifactEvent.SHOW_ARTIFACT_LIST_PANEL:this.showArtifactListView();break;case a.ArtifactEvent.ARTIFACT_OPERATION:this.artifactOpertion(t.data)}},i.prototype.showArtifactPanel=function(t){var e=t&&1<t.length?t[1]:0,i=t&&0<t.length?t[0]:0;UIMgr.hasStage(UIConst.ArtifactView)?(0<e&&this.artifactView.selectShenQiById(e),this.artifactView.tab.selectedIndex=i||0):UIMgr.showUI(UIConst.ArtifactView,{id:e,index:i})},i.prototype.showArtifactListView=function(){UIMgr.showUI(UIConst.ArtifactListView)},i.prototype.artifactOpertion=function(t){switch(t[1]){case Artifact.RECYCLE:this.onProtocolRecycle(t[0]);break;case Artifact.ENCHANT:this.onProtocolEnchant(t[0]);break;case Artifact.PBAPTIZE:case Artifact.GBAPTIZE:this.onProtocolBaptize(t[0]);break;case Artifact.STRENGTH:this.onProtocolStrength(t[0]);break;case Artifact.ACTIVATE:this.onProtocolActivate(t[0]);break;case Artifact.CHANGE:this.onProtocolChange(t[0]);break;case Artifact.SKILLUPGRADE:this.onProtocolSkillUpGrade(t[0]);break;case Artifact.WEAR_OR_TAKEOFF:this.onProtocolWearOrTakeoff(t[0])}},i.prototype.onProtocolActivate=function(o){var t={};t[Protocol.game_artifact_artifactActivate.args.id]=o,PLC.request(Protocol.game_artifact_artifactActivate,t,function(t,e){if(t){var i={id:o};App.hero.artifactInfo[o]=i,dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_ACTIVE),[o]),dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_OPERATION_SUCCESS)),dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_UNLOCK_SUCCESS));var n=tb.TB_artifact.get_TB_artifactById(o);UIMgr.showUI(UIConst.Artifact_UnLockView,n)}})},i.prototype.onProtocolStrength=function(t){var e={};e[Protocol.game_artifact_artifactStrength.args.id]=t,PLC.request(Protocol.game_artifact_artifactStrength,e,function(t,e){t&&(dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_STRENGTH_SUCCESS)),dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_OPERATION_SUCCESS)))})},i.prototype.onProtocolEnchant=function(t){var e={};e[Protocol.game_artifact_artifactStrength.args.id]=t,PLC.request(Protocol.game_artifact_enchant,e,function(t,e){t&&dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_OPERATION_SUCCESS))})},i.prototype.onProtocolBaptize=function(t){var e={};t.hasOwnProperty("hint")&&(a.ArtifactModel.getInstance().hint=t.hint),e[Protocol.game_artifact_baptize.args.id]=t.id,e[Protocol.game_artifact_baptize.args.type]=t.type,e[Protocol.game_artifact_baptize.args.lockFlag]=t.lockFlag,PLC.request(Protocol.game_artifact_baptize,e,function(t,e){t&&dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_OPERATION_SUCCESS))})},i.prototype.onProtocolChange=function(t){var e={};e[Protocol.game_artifact_baptizeSave.args.id]=t,PLC.request(Protocol.game_artifact_baptizeSave,e,function(t,e){t&&dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_OPERATION_SUCCESS))})},i.prototype.onProtocolSkillUpGrade=function(t){var e={};e[Protocol.game_artifact_artifactSkillUpgrade.args.id]=t,PLC.request(Protocol.game_artifact_artifactSkillUpgrade,e,function(t,e){t&&dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ARTIFACT_OPERATION_SUCCESS))})},i.prototype.onProtocolRecycle=function(t){},i.prototype.onProtocolWearOrTakeoff=function(t){var e={};e[Protocol.game_artifact_ajustLineupArtifact.args.id]=t.id,e[Protocol.game_artifact_ajustLineupArtifact.args.type]=t.type,PLC.request(Protocol.game_artifact_ajustLineupArtifact,e,function(t,e){if(t){for(var i in t.lineupArtifactInfo)App.hero.lineupArtifactInfo[i]=t.lineupArtifactInfo[i];UIMgr.hasStage(UIConst.BuzhenView)&&UIMgr.getUIByName(UIConst.BuzhenView).updateShenqi(),UIMgr.hideUIByName(UIConst.ArtifactListView),dispatchEvt(new a.ArtifactEvent(a.ArtifactEvent.ADJUST_LINEUP_ARTIFACT_SUCCESS)),dispatchEvt(new a.GodEvent(a.GodEvent.BUZHEN_COMPLETE))}})},Object.defineProperty(i.prototype,"artifactView",{get:function(){return UIMgr.hasStage(UIConst.ArtifactView)?UIMgr.getUIByName(UIConst.ArtifactView):null},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}a.ArtifactProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"ArtifactModule"},n.prototype.listProcessors=function(){return[new t.ArtifactProcessor]},n);function n(){return e.call(this)||this}t.ArtifactModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_ARTIFACT_PANEL="SHOW_ARTIFACT_PANEL",r.SHOW_ARTIFACT_LIST_PANEL="SHOW_ARTIFACT_LIST_PANEL",r.ARTIFACT_OPERATION="ARTIFACT_OPERATION",r.ARTIFACT_OPERATION_SUCCESS="ARTIFACT_OPERATION_SUCCESS",r.ARTIFACT_UNLOCK_SUCCESS="ARTIFACT_UNLOCK_SUCCESS",r.ARTIFACT_STRENGTH_SUCCESS="ARTIFACT_STRENGTH_SUCCESS",r.ADJUST_LINEUP_ARTIFACT_SUCCESS="ADJUST_LINEUP_ARTIFACT_SUCCESS",r.ARTIFACT_STRENGTH_LV_CHANGE="ARTIFACT_STRENGTH_LV_CHANGE",r.ARTIFACT_SKILL_LV_CHANGE="ARTIFACT_SKILL_LV_CHANGE",r.ARTIFACT_BAPTIZE_CHANGE="ARTIFACT_BAPTIZE_CHANGE",r.ARTIFACT_STAR_CHANGE="ARTIFACT_STAR_CHANGE",r.ARTIFACT_ACTIVE="ARTIFACT_ACTIVE",r.SWITCH_ARTIFACT="SWITCH_ARTIFACT",r.SELECT_TABBAR="SELECT_TABBAR",r.SHOW_VISIBLE_TRUE="SHOW_ARTIFACT_VISIBLE_TRUE",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.ArtifactEvent=a}(game=game||{}),function(t){var e=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.isSysOpen=function(){return 1<=App.hero.tasks.advanceLevel},i.prototype.getUnlockArtifactNum=function(){var t=0;if(App.hero.artifactInfo)for(var e in App.hero.artifactInfo)t++;return t},i.prototype.isCanUnlock=function(t){var e=tb.TB_artifact.get_TB_artifactById(t);return App.hero.getBagItemNum(e.cost[0][0])>=e.cost[0][1]&&!this.isUnlock(e.ID)},i.prototype.isUnlock=function(t){return App.hero.artifactInfo[t]},i.prototype.isCanActivit=function(t){return!this.isUnlock(t)&&this.isCanUnlock(t)},i.getArtObtain=function(){var t=i.getInstance().getUnlockArtifactNum();return tb.TB_artifact_obtain.get_TB_artifact_obtainById(t)},i.getArtAttr=function(){var t=this.getArtObtain();if(t){for(var e=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],i=0,n=t.attr;i<n.length;i++){var o=n[i],a=o[0];e[o[1]][a-1]+=o[2]}return e}return null},i.prototype.getEnchantAtttri=function(t,e,i,n){if(void 0===n&&(n=!1),n&&App.hero.getArtifactIDByLineType()<=0)return null;t=t||tb.TB_artifact_enchant.get_TB_artifact_enchantById(App.hero.artifactStarLv),0==e&&(e=App.hero.artifactStarExp/tb.TB_artifact_set.get_TB_artifact_setById().enchant_plan);var o=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]];for(var a in t.enchant_basic)t.enchant_basic[a][0]<=8&&(o[0][t.enchant_basic[a][0]-1]+=Number(t.enchant_basic[a][1]));if(!i)for(var a in t.enchant_special)t.enchant_special[a][0]<=8&&(o[t.enchant_special[a][1]][t.enchant_special[a][0]-1]+=Number(t.enchant_special[a][2]));for(var a in t.temporary_attr)t.temporary_attr[a][0]<=8&&(o[0][t.temporary_attr[a][0]-1]+=Number(t.temporary_attr[a][1])*e);return o},i.prototype.getBapAttri=function(t,e){var i=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]];if(App.hero.getArtifactIDByLineType()<=0)return i;var n=App.hero.artifactBaptizeAttrs;for(var o in n)n[o][3]!=t&&0!=n[o][3]||n[o][1]!=e&&2!=e||(i[n[o][1]][n[o][0]-1]+=Number(n[o][2]));return i},i.prototype.getStrengthAttr=function(){if(App.hero.getArtifactIDByLineType()<=0)return null;var t=tb.TB_artifact_strength.get_TB_artifact_strengthById(App.hero.artifactStrengthLv);return t?t.getAttr():null},i.prototype.getArtifactAllAttr=function(){var t={attr:{},buff:{}};if(App.hero.getArtifactIDByLineType()<=0)return t;for(var e=0,i=tb.TB_artifact_strength.get_TB_artifact_strengthById(App.hero.artifactStrengthLv).strength_attr;e<i.length;e++){var n=i[e];t.attr.hasOwnProperty(n[0])?t.attr[n[0]]+=Number(n[1]):t.attr[n[0]]=Number(n[1])}for(var o=App.hero.artifactStarLv,a=App.hero.artifactStarExp,r=tb.TB_artifact_set.get_TB_artifact_setById(),s=tb.TB_artifact_enchant.get_TB_artifact_enchantById(o),u=a/r.enchant_plan,h=0,l=s.enchant_special;h<l.length;h++){var c=l[h];9<=c[0]&&(t.attr.hasOwnProperty(c[0])?t.attr[c[0]]+=Number(c[2]):t.attr[c[0]]=Number(c[2]))}for(var p=0,d=s.temporary_attr;p<d.length;p++){var _=d[p];9<=_[0]&&(t.attr.hasOwnProperty(_[0])?t.attr[_[0]]+=Number(_[1])*u:t.attr[_[0]]=Number(_[1])*u)}return t},i.prototype.getArtifactRedPoint=function(t,e){if(!App.IsSysOpen(ModuleConst.ARTIFACT))return!1;if(!App.hero.isActiveArtifact(t)){if(e!=Artifact.ACTIVATE)return!1;var i=tb.TB_artifact.get_TB_artifactById(t),n=i.cost[0][0],o=i.cost[0][1];return App.hero.getBagItemNum(n)>=o}var a=this.getUnlockArtifactNum(),r=tb.TB_artifact_set.get_TB_artifact_setById();if(e==Artifact.SKILLUPGRADE){if(a<r.artifact_unlock[1])return!1;var s=App.hero.artifactSkillLv;if(s>=r.max_skill_level)return!1;var u=tb.TB_artifact_skillcost.get_TB_artifact_skillcostById(s);return u.cost,App.hero.artifactStrengthLv>=u.need_level&&App.hero.getBagItemNum(u.cost[0][0])>=u.cost[0][1]}if(e==Artifact.STRENGTH){if(a<r.artifact_unlock[0])return!1;var h=App.hero.artifactStrengthLv;if(h>=r.max_strength_level)return!1;var l=tb.TB_artifact_strength.get_TB_artifact_strengthById(h);return App.hero.getBagItemNum(l.cost[0][0])>=l.cost[0][1]}if(e==Artifact.GBAPTIZE)return!(a<r.artifact_unlock[2])&&!(1<App.hero.welfare.loginCount)&&App.hero.getBagItemNum(r.rare_baptize[0][0])>=r.rare_baptize[0][1];if(e!=Artifact.ENCHANT)return e==Artifact.PBAPTIZE?!(a<r.artifact_unlock[2])&&!(1<App.hero.welfare.loginCount)&&App.hero.getBagItemNum(r.general_baptize[0][0])>=r.general_baptize[0][1]:void 0;if(a<r.artifact_unlock[3])return!1;var c=tb.TB_artifact_enchant.get_TB_artifact_enchantById(App.hero.artifactStarLv);return App.hero.getBagItemNum(c.cost[0])>=c.cost[1]},i);function i(){}t.ArtifactModel=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.fight.GloryFightResultUI,__extends(n,i),n.prototype.popup=function(){i.prototype.popup.call(this,!1,!1),this.initView()},n.prototype.show=function(){i.prototype.show.call(this,!1,!1),this.initView()},n.prototype.initView=function(){this._again=!1;var t=this.dataSource.vo,e=t.copyType==CopyType.arenaMatch?t.arenaMatchVo:t.arenaReportVo.arenaRecordVo;if(e){this.bgPanel.showTitle(!0,"zhandoubiaoxian/duizhanjieguo.png",!0,!0,!0,null,this);var i=App.hero,n=e.isWin;this.lbName1.text=i.name,this.clip_force1.visible=this.img_flag1.visible=this.img_flag11.visible=!1,this.headBox1.dataSource=new UserHeadVo(i.getHeadId(),i.level,i.headFrame),n?(this.bg1.skin="zhandoubiaoxian/hongse.png",this.lbResult1.skin="zhandoubiaoxian/sheng.png",this.bg1.scaleY=1):(this.bg1.skin="zhandoubiaoxian/lanse.png",this.lbResult1.skin="zhandoubiaoxian/bai.png",this.bg1.scaleY=-1),this.lbName2.text=e.name,this.clip_force2.visible=this.img_flag2.visible=this.img_flag22.visible=!1,this.headBox2.dataSource=new UserHeadVo(e.head,e.level,e.headFrame),n?(this.bg2.skin="zhandoubiaoxian/lanse.png",this.lbResult2.skin="zhandoubiaoxian/bai.png",this.bg2.scaleY=1):(this.bg2.skin="zhandoubiaoxian/hongse.png",this.lbResult2.skin="zhandoubiaoxian/sheng.png",this.bg2.scaleY=-1)}else logerror("result error")},n.prototype.onClosed=function(){i.prototype.onClosed.call(this)},n.prototype.close=function(){this._again||dispatchEvt(new e.FightsEvent(e.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource),i.prototype.close.call(this),this.bgPanel.closeTitle()},n.prototype.onPlay=function(){this._again=!0;var t=this.copyData();this.close(),dispatchEvt(new e.FightsEvent(e.FightsEvent.REPLAY_GAME_EVENT),t)},n.prototype.copyData=function(){var t=this.dataSource;return t.vo.fightPageControl.initState(),t},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.closeEffect=null,t.btnClose.on(Laya.Event.CLICK,t,t.close),t.btnReplay.on(Laya.Event.CLICK,t,t.onPlay),t}e.ArenaResultView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.arena.arena.ArenaRecordUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},n.prototype.initView=function(){this.recordList.array=this.dataSource,this.lab_norecord.visible=!this.dataSource||0==this.dataSource.length},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.recordList.array=null},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12539)},t.bgPanel.addChildAt(t.img_bg,3),t}t.ArenaRecordView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.arena.arena.render.ArenaRecordIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;if(t){this.lbname.text=t.name,this.lbtime.text=t.beforeTime(),this.headbox.dataSource=new UserHeadVo(t.head,t.level,t.headFrame),this.lbtype.text=""+(t.isChallenge()?LanMgr.getLan("",12540):LanMgr.getLan("",12541))+(t.isWin?LanMgr.getLan("",12542):LanMgr.getLan("",12405)),this.lbVal.color=t.isWin?ColorConst.TASK_GREEN:ColorConst.RED,this.lbValPre.text=t.getChgValuePrev();var e=t.getChgValue();this.lbVal.text=0<e?"+"+e:""+e,this.imgrank.skin=t.getChangeTypeSkin(),this.lbVal.event(Laya.Event.RESIZE),this.hbox.refresh(),this.lbNone.visible=t.isNotChange(),this.hbox.visible=!this.lbNone.visible,this.btnplay.visible=!t.isNpc(),this.btnplay.on(Laya.Event.CLICK,this,this.onPlayback)}else this.btnplay.off(Laya.Event.CLICK,this,this.onPlayback)},n.prototype.onPlayback=function(){var t=this.dataSource;t&&dispatchEvt(t.getEvent(),this.dataSource)},n);function n(){return e.call(this)||this}t.ArenaRecordIR=i}(game=game||{}),function(a){var t=(e.getInsatnce=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.requestMatchInfo=function(){return new Promise(function(i,t){App.IsSysOpen(ModuleConst.MATCH_FIGHT)?PLC.request(Protocol.game_match_getMatchInfo,null,function(t){if(t){var e=a.MatchModel.getInstance();e.score=t.score,e.benfuRank=t.rank,e.setMatchList(t.clgList),i()}}):i()})},e.prototype.refreshList=function(){return new Promise(function(i,t){PLC.request(Protocol.game_match_refreshClgList,null,function(t){if(t){var e=a.MatchModel.getInstance();e.lastRefreshTime=t.clgListTime,e.score=t.score,e.benfuRank=t.rank,e.setMatchList(t.clgList),i()}})})},e.prototype.rewardBaoxiang=function(n){return new Promise(function(e,t){var i={};i[Protocol.game_match_getMatchChest.args.chestId]=n.tbBox.ID,PLC.request(Protocol.game_match_getMatchChest,i,function(t){t&&(UIUtil.showRewardView(t.commonData),a.MatchModel.getInstance().doneMatchChests=t.doneMatchChests,dispatchEvt(new a.ArenaEvent(a.ArenaEvent.MATCH_REWARD_BOX_SUCC)),e())})})},e.prototype.requestLineup=function(n){return new Promise(function(e,t){var i={};i[Protocol.center_match_observePlayer.args.obPlayerId]=n.playerId,PLC.request(Protocol.center_match_observePlayer,i,function(t){t&&(n.setDetailData(t.defInfo),e())})})},e.prototype.requestRankList=function(n){return new Promise(function(e,t){var i=a.MatchModel.getInstance();n?PLC.request(Protocol.center_match_getLocalRankList,null,function(t){t&&(t.hasOwnProperty("rank")&&(i.benfuRank=t.rank),e(t.localRankList))}):PLC.request(Protocol.center_match_getWorldRankList,null,function(t){t&&(t.hasOwnProperty("rank")&&(i.kuafuRank=t.rank),e(t.worldRankList))})})},e.prototype.requestBattleStart=function(o){return new Promise(function(n,t){var e={};e[Protocol.game_match_battleStart.args.targetIdx]=o.index,PLC.request(Protocol.game_match_battleStart,e,function(t){if(t){var e=a.MatchModel.getInstance();e.challengeCount=t.clgMatchNum;var i=t.battleEndInfo;e.score=i.selfScore,o.score=i.tarScore,n(t)}})})},e.prototype.requestRecordList=function(){return new Promise(function(e,t){PLC.request(Protocol.game_match_getBattleRecords,null,function(t){t&&(a.MatchModel.getInstance().setRecordList(t.battleRecords),e())})})},e);function e(){}a.MatchThread=t}(game=game||{}),function(t){var e=(i.prototype.beforeTime=function(){return logindifference(this.battleTime,App.serverTimeSecond)},i.prototype.isChallenge=function(){return 1==this.battleType},i.prototype.getChgValue=function(){return this.chgScore},i.prototype.getChgValuePrev=function(){return LanMgr.getLan("",12543)},i.prototype.getChangeTypeSkin=function(){return""},i.prototype.isNotChange=function(){return!1},i.prototype.isNpc=function(){return!1},i.prototype.getEvent=function(){return new t.ArenaEvent(t.ArenaEvent.MATCH_PLAYBACK)},i.prototype.isRecord=function(){return!0},i.prototype.getForce=function(){return this.force},i.prototype.getTagForce=function(){return this.targetForce},i);function i(t,e){this.playerId,t.playerId,this.name=t.name,this.level=t.level,this.head=t.head,this.headFrame=t.headFrame,this.battleTime=t.battleTime,this.chgScore=t.chgScore,this.battleType=t.battleType,this.isWin=t.isWin,this.index=e,this.force=t.force,this.targetForce=t.targetForce}t.MatchRecordVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=common.RankVo,__extends(n,e),n.prototype.getValue=function(){return t.MatchModel.getInstance().getGradeName(this.score)},n.prototype.getValueDesc=function(){return LanMgr.getLan("",12544)},n.prototype.isShowMid=function(){return!0},n.prototype.getMidDesc=function(){return LanMgr.getLan("",12543)},n.prototype.getMid=function(){return this.score},n.prototype.isShowBottom=function(){return!0},n);function n(){return e.call(this)||this}t.MatchRankVo=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(__extends(i,n=BaseFightVo),i.prototype.setSvo=function(t){this.playerId!=t.playerId&&n.prototype.clearLineupInfo.call(this),this.playerId=t.playerId,this.name=t.name,this.sex=t.sex,this.level=t.level,this.force=t.forceNum,this.score=t.score,this.head=t.head,this.headFrame=t.headFrame,this.guildName=t.guildName,this.headVo.setLevel(t.level),this.headVo.setHead(t.head),this.headVo.setHeadFrame(t.headFrame),t.defInfo&&n.prototype.setLineupInfo.call(this,t.defInfo)},i.prototype.setDetailData=function(t){n.prototype.setLineupInfo.call(this,t)},i.prototype.isRobot=function(){return!this.playerId||""==this.playerId},i.prototype.isRecord=function(){return!1},i.prototype.getForce=function(){return App.hero.force},i.prototype.getTagForce=function(){return this.force},i);function i(t,e){var i=n.call(this)||this;return i.headVo=new UserHeadVo(0,0),i.setSvo(t),i.index=e,i}t.MatchPlayerVo=e}(game=game||{}),function(t){var e=(i.prototype.getRewardSkin=function(){return""},i.prototype.getCount=function(){return this.tbBox.need_num},i.prototype.getSkin=function(){return SkinUtil.getTaskBaoxiang(this.tbBox.box_model,this.isReward())},i.prototype.isCanReward=function(){return this.isFinish()&&!this.isReward()},i.prototype.isReward=function(){return-1!=t.MatchModel.getInstance().doneMatchChests.indexOf(this.tbBox.ID)},i.prototype.isFinish=function(){return t.MatchModel.getInstance().challengeCount>=this.getCount()},i.prototype.getRewardList=function(){return this.tbBox.getRewardList()},i.prototype.getEvent=function(){return new t.ArenaEvent(t.ArenaEvent.MATCH_REWARD_BOX)},i);function i(t){this.tbBox=t}t.BaoxiangVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.arena.match.render.MatchIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;t?(this.headBox.dataSource=t.headVo,this.lbName.text=t.name,this.lbForce.text=LanMgr.getLan("",10117,t.force),this.lbScore.text=LanMgr.getLan("",12543)+"："+t.score,this.btnChallenge.on(Laya.Event.CLICK,this,this.onChallenge),this.headBox.on(Laya.Event.CLICK,this,this.onCheck)):(this.headBox.dataSource=null,this.btnChallenge.off(Laya.Event.CLICK,this,this.onChallenge),this.headBox.off(Laya.Event.CLICK,this,this.onCheck))},n.prototype.onChallenge=function(){dispatchEvt(new t.ArenaEvent(t.ArenaEvent.MATCH_CHALLENGE),this.dataSource)},n.prototype.onCheck=function(){dispatchEvt(new t.ArenaEvent(t.ArenaEvent.SHOW_PLAYER_LINEUP),this.dataSource)},n);function n(){return e.call(this)||this}t.MatchIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.arena.match.render.KuafuRewardIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){var t=this.dataSource;t?(this.lbName.text=t.name,this.lbRank.text=t.getRankText(),this.rewardList.array=t.getRewardList(),this.lbName.color=this.lbRank.color=ColorConst.getGradeColor(t.type)):this.rewardList.array=null},n);function n(){return e.call(this)||this}t.KuafuRewardIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var r,t=(r=ui.arena.match.MatchMainUI,__extends(e,r),e.prototype.createChildren=function(){r.prototype.createChildren.call(this),this._model=a.MatchModel.getInstance(),this._boxItems=[];for(var t=this._model.getBoxList(),e=t.length,i=this.box.width,n=0;n<e;n++){var o=new common.BaoxiangBox;o.anchorX=.5,o.x=t[n].getCount()/this._model.maxTbCount*i,o.y-=20,this.box.addChild(o),this._boxItems.push(o)}this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.MATCH_FIGHT),this.btnAdd.on(Laya.Event.CLICK,this,this.onClick),this.btnRefresh.on(Laya.Event.CLICK,this,this.onClick)},e.prototype.show=function(t,e){r.prototype.show.call(this,t,e),this.initView()},e.prototype.onClosed=function(){r.prototype.onClosed.call(this);for(var t=0,e=this._boxItems;t<e.length;t++)e[t].dataSource=null;this.matchList.array=null,Laya.timer.clearAll(this),tl3d.ModuleEventManager.removeEvent(a.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateSYCount,this),UIMgr.hideUIByName(UIConst.SysTopView)},e.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_rule,callback:this.onRule.bind(this)},{btnSkin:SkinUtil.btn_jiangli,callback:this.onAward.bind(this)},{btnSkin:SkinUtil.btn_rank,callback:this.onRank.bind(this)},{btnSkin:SkinUtil.btn_record,callback:this.onRecord.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.onFanHui.bind(this)}),this.updateBox(),this.lbName.text=App.hero.name,this.lbScore.text=LanMgr.getLan("",12543)+"："+this._model.score,this.lbGrade.text=LanMgr.getLan("",12544)+"："+this._model.getGradeName(this._model.score),this.lbCount.text=LanMgr.getLan("",12540)+this._model.challengeCount+LanMgr.getLan("",12108),this.refreshList(),this.updateSYCount(),this.resetRefreshInterval(),this.resetMatchInterval(),tl3d.ModuleEventManager.addEvent(a.ResEvent.OVERPLUS_VALUE_CHANGE,this.updateSYCount,this)},e.prototype.updateBox=function(){for(var t=this._model,e=t.getBoxList(),i=0,n=this._boxItems.length;i<n;i++)this._boxItems[i].dataSource=e[i];this.imgPb.value=t.challengeCount/t.maxTbCount},e.prototype.refreshList=function(){this.matchList.array=this._model.getMatchList()},e.prototype.resetMatchInterval=function(){Laya.timer.clear(this,this.updateMatchTime),Laya.timer.loop(1e3,this,this.updateMatchTime),this.updateMatchTime()},e.prototype.updateMatchTime=function(){var t=this._model.roundEndTime-App.serverTimeSecond;0<t?this.lbTime.text=LanMgr.getLan("",12545)+GameUtil.getTimeStr(t):this._model.updateEndTime()},e.prototype.resetRefreshInterval=function(){Laya.timer.clear(this,this.updateRefreshTime),App.serverTimeSecond-this._model.lastRefreshTime<tb.TB_match_set.getSet().refresh_interval?(Laya.timer.loop(1e3,this,this.updateRefreshTime),this.updateRefreshTime()):(this.btnRefresh.label=LanMgr.getLan("",10172),this.btnRefresh.gray=!1)},e.prototype.updateRefreshTime=function(){var t=App.serverTimeSecond-this._model.lastRefreshTime,e=Math.ceil(tb.TB_match_set.getSet().refresh_interval-t);0<e?(this.btnRefresh.label=e+LanMgr.getLan("",12093),this.btnRefresh.gray=!0):(this.btnRefresh.label=LanMgr.getLan("",10172),this.btnRefresh.gray=!1,Laya.timer.clear(this,this.updateRefreshTime))},e.prototype.updateSYCount=function(){this.lbSYCount.text=LanMgr.getLan("",10081,App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.matchNum))},e.prototype.onClick=function(t){var e=t.target;if(e==this.btnAdd)dispatchEvt(new a.ArenaEvent(a.ArenaEvent.SHOW_BUY_VIEW));else if(e==this.btnRefresh){if(this.btnRefresh.gray)return void showToast(LanMgr.getLan("",11015));dispatchEvt(new a.ArenaEvent(a.ArenaEvent.REFRESH_MATCH_LIST))}},e.prototype.onRule=function(){dispatchEvt(new a.ArenaEvent(a.ArenaEvent.SHOW_NOTICE_VIEW))},e.prototype.onAward=function(){dispatchEvt(new a.ArenaEvent(a.ArenaEvent.SHOW_AWARD_VIEW))},e.prototype.onRank=function(){dispatchEvt(new a.ArenaEvent(a.ArenaEvent.SHOW_RANK_VIEW))},e.prototype.onRecord=function(){dispatchEvt(new a.ArenaEvent(a.ArenaEvent.SHOW_RECORD_VIEW))},e.prototype.onFanHui=function(){dispatchEvt(new a.HudEvent(a.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_KUAFU))},e);function e(){var t=r.call(this)||this;return t.group=UIConst.hud_group,t}a.MatchView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.arena.match.MatchRewardUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12261)},this.tabBar.selectHandler=Handler.create(this,this.onSelected,null,!1)},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.tabBar.selectedIndex=-1,this.benfuList.array=null,this.kuafuList.array=null},n.prototype.initView=function(){this.tabBar.selectedIndex=0;var t=e.MatchModel.getInstance();this.lbScore.text=t.score+"",this.lbRank.text=t.benfuRank+"",this.lbGrade.text=t.getGradeName(t.score)},n.prototype.onSelected=function(t){-1!=t&&(this.viewStack.selectedIndex=t,e.MatchModel.getInstance(),0==t?this.benfuList.array=tb.TB_match.getItemList():this.kuafuList.array=tb.TB_match_score.getItemList())},n);function n(){return i.call(this)||this}e.MatchRewardView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var o,e=(o=ui.arena.match.MatchResultUI,__extends(i,o),i.prototype.createChildren=function(){o.prototype.createChildren.call(this),this.isModelClose=!0,this.lbSelfScore.autoSize=this.lbSelfChg.autoSize=!0,this.lbTarScore.autoSize=this.lbTarChg.autoSize=!0,this.rewardList.renderHandler=Handler.create(this,this.renderItem,null,!1)},i.prototype.popup=function(t,e){var i=this.dataSource,n=0<(i?i.responseData:{}).battleEndInfo.selfChgScore;this.height=n?520:700,this.lbBlank.y=n?550:730,n?AudioMgr.playSound("sound/victory.mp3"):AudioMgr.playSound("sound/defeated.mp3"),this.bgPanel.showTitle(n,n?SkinUtil.title_shengli:SkinUtil.title_shibai,!1,!0,!1,null,this),o.prototype.popup.call(this,t,!1),this.initView()},i.prototype.close=function(){o.prototype.close.call(this),dispatchEvt(new t.FightsEvent(t.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource)},i.prototype.onClosed=function(){o.prototype.onClosed.call(this),this.rewardList.array=null},i.prototype.initView=function(){var t=this,e=this.dataSource,i=e.vo.arenaMatchVo;if(i){var n=e.responseData,o=n.battleEndInfo,a=0<o.selfChgScore,r=n.commonData,s=[];UIUtil.getRewardItemVoList(s,r),this.rewardList.array=s,this.selfHeadBox.dataSource=new UserHeadVo(App.hero.getHeadId(),App.hero.level,App.hero.headFrame),this.lbSelfName.text=App.hero.name,this.lbSelfScore.text=o.selfScore,this.lbSelfChg.text=0<o.selfChgScore?"(+"+o.selfChgScore+")":"("+o.selfChgScore+")",this.lbSelfChg.color=a?"#40ff7c":"#94b4e3",this.lbSelfScore.event(Laya.Event.RESIZE),this.tarHeadBox.dataSource=new UserHeadVo(i.head,i.level,i.headFrame),this.lbTarName.text=i.name,this.lbTarScore.text=o.tarScore,this.lbTarChg.text=0<o.tarChgScore?"(+"+o.tarChgScore+")":"("+o.tarChgScore+")",this.lbTarChg.color=a?"#94b4e3":"#40ff7c",this.lbTarScore.event(Laya.Event.RESIZE),this._isTz=!1,this.channel.visible=this.imgForce.visible=!a,this.channel.callback=function(){t._isTz=!0,t.close()}}else logerror("fight result error")},i.prototype.renderItem=function(t,e){var i=t.dataSource,n=t.getChildByName("lbName"),o=t.getChildByName("imgRes"),a=t.getChildByName("lbValue");if(i){var r=tb.TB_item.get_TB_itemById(i.id);n.text=LanMgr.getLan("",12546)+r.name,a.text="+"+i.count,o.skin=SkinUtil.getCostSkin(r.ID)}},i);function i(){var t=o.call(this)||this;return t._isTz=!1,t.isModelClose=!0,t}t.MatchResultView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.arena.match.MatchRankUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12324)},this.tabBar.selectHandler=Handler.create(this,this.onSelected,null,!1),this.lbScore.autoSize=this.lbRank.autoSize=this.lbGrade.autoSize=!0},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.tabBar.selectedIndex=-1,this.rankList.array=null,this._benfuList=null,this._kuafuList=null},e.prototype.initView=function(){this.tabBar.selectedIndex=0},e.prototype.onSelected=function(t){var n=this;-1!=t&&(0==t?this._benfuList?this.setBenfuList():(this._benfuList=[],this.rankList.array=null,o.MatchThread.getInsatnce().requestRankList(!0).then(function(t){for(var e in t){var i=new o.MatchRankVo;i.setSvo(t[e]),i.rank=Number(e),i.score=t[e].score,n._benfuList.push(i)}n.setBenfuList()})):this._kuafuList?this.setKuafuList():(this._kuafuList=[],this.rankList.array=null,o.MatchThread.getInsatnce().requestRankList(!1).then(function(t){for(var e in t){var i=new o.MatchRankVo;i.setSvo(t[e]),i.rank=Number(e),i.score=t[e].score,i.rankSvrType=common.RankSvrType.matchCrossSvr,n._kuafuList.push(i)}n.setKuafuList()})))},e.prototype.setBenfuList=function(){if(0==this.tabBar.selectedIndex){this.rankList.array=this._benfuList,this.rankList.scrollTo(0);var t=o.MatchModel.getInstance();this.lbScore.text=t.score+"",this.lbRankDesc.text="   "+LanMgr.getLan("",12547),this.lbRank.text=t.benfuRank+"",this.lbGrade.text=t.getGradeName(t.score),this.lbRank.event(Laya.Event.RESIZE)}},e.prototype.setKuafuList=function(){if(1==this.tabBar.selectedIndex){this.rankList.array=this._kuafuList,this.rankList.scrollTo(0);var t=o.MatchModel.getInstance();this.lbScore.text=t.score+"",this.lbRankDesc.text="   "+LanMgr.getLan("",12548),this.lbRank.text=t.kuafuRank+"",this.lbGrade.text=t.getGradeName(t.score),this.lbRank.event(Laya.Event.RESIZE)}},e);function e(){return i.call(this)||this}o.MatchRankView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"MatchProcessor"},i.prototype.listenModuleEvents=function(){return[new u.ArenaEvent(u.ArenaEvent.SHOW_MATCH_PANEL),new u.ArenaEvent(u.ArenaEvent.SHOW_BUY_VIEW),new u.ArenaEvent(u.ArenaEvent.SHOW_NOTICE_VIEW),new u.ArenaEvent(u.ArenaEvent.SHOW_AWARD_VIEW),new u.ArenaEvent(u.ArenaEvent.SHOW_RANK_VIEW),new u.ArenaEvent(u.ArenaEvent.SHOW_RECORD_VIEW),new u.ArenaEvent(u.ArenaEvent.SHOW_PLAYER_LINEUP),new u.ArenaEvent(u.ArenaEvent.MATCH_REWARD_BOX),new u.ArenaEvent(u.ArenaEvent.REFRESH_MATCH_LIST),new u.ArenaEvent(u.ArenaEvent.MATCH_CHALLENGE),new u.ArenaEvent(u.ArenaEvent.MATCH_PLAYBACK),new u.ArenaEvent(u.ArenaEvent.FIGHT_BACK_TO_RECORD)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof u.ArenaEvent)switch(t.type){case u.ArenaEvent.SHOW_MATCH_PANEL:this.showMatchView();break;case u.ArenaEvent.SHOW_BUY_VIEW:this.showBuyView();break;case u.ArenaEvent.SHOW_NOTICE_VIEW:this.showNoticeView();break;case u.ArenaEvent.SHOW_AWARD_VIEW:this.showRewardView();break;case u.ArenaEvent.SHOW_RANK_VIEW:this.showRankView();break;case u.ArenaEvent.SHOW_RECORD_VIEW:this.showRecordView();break;case u.ArenaEvent.SHOW_PLAYER_LINEUP:this.showLineupView(t.data);break;case u.ArenaEvent.MATCH_REWARD_BOX:this.rewardBox(t.data);break;case u.ArenaEvent.REFRESH_MATCH_LIST:this.refreshList();break;case u.ArenaEvent.MATCH_CHALLENGE:this.matchChallenge(t.data);break;case u.ArenaEvent.MATCH_PLAYBACK:this.recordPlayback(t.data);break;case u.ArenaEvent.FIGHT_BACK_TO_RECORD:this.backToRecord()}},i.prototype.showMatchView=function(t){void 0===t&&(t=!0),t?this._request.requestMatchInfo().then(function(){UIMgr.showUI(UIConst.ArenaMatchView)}):UIMgr.showUI(UIConst.ArenaMatchView)},i.prototype.showBuyView=function(){var i=this;UIUtil.checkLimitEnough(iface.tb_prop.limitTypeKey.buyMatchNum,iface.tb_prop.vipPrivilegeTypeKey.matchBuyNum)&&UIMgr.showUI(UIConst.BuyBattleCount,{type:common.BuyBattleCountView.TYPE_MATCH,callback:function(t){var e={};e[Protocol.game_match_buyBattleCnt.args.count]=t,PLC.request(Protocol.game_match_buyBattleCnt,e,function(t){t&&i.matchView.updateSYCount()})}})},i.prototype.showNoticeView=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20015))},i.prototype.showRewardView=function(){UIMgr.showUI(UIConst.MatchRewardView)},i.prototype.showRankView=function(){UIMgr.showUI(UIConst.MatchRankView)},i.prototype.showRecordView=function(t){var e=this;void 0===t&&(t=!0),t?this._request.requestRecordList().then(function(){var t=e._model.getRecordList();t&&0!=t.length?UIMgr.showUI(UIConst.ArenaRecordView,t):showToast(LanMgr.getLan("",10070))}):UIMgr.showUI(UIConst.ArenaRecordView,this._model.getRecordList())},i.prototype.showLineupView=function(t){t.isHasLineup()?UIMgr.showUI(UIConst.PlayerLineupInfoView,t):this._request.requestLineup(t).then(function(){UIMgr.showUI(UIConst.PlayerLineupInfoView,t)})},i.prototype.rewardBox=function(t){var e=this;t.isCanReward()&&this._request.rewardBaoxiang(t).then(function(){e.matchView.updateBox()})},i.prototype.refreshList=function(){var t=this;App.serverTimeSecond-this._model.lastRefreshTime<tb.TB_match_set.getSet().refresh_interval?showToast(LanMgr.getLan("",11015)):this._request.refreshList().then(function(){t.matchView.refreshList(),t.matchView.resetRefreshInterval()})},i.prototype.matchChallenge=function(e){var i=this;App.hero.getOverplusValue(iface.tb_prop.overplusTypeKey.matchNum)<=0?this.showBuyView():this._request.requestBattleStart(e).then(function(t){i.doChallenge(e,t)})},i.prototype.doChallenge=function(t,e){var i=e.battleEndInfo,n=e.battleReport.reportData;logzhanbao(n);var o=0<i.selfChgScore;t.isWin=o;var a=new u.FightVo;a.copyType=CopyType.arenaMatch,a.arenaMatchVo=t;var r=new u.ServerPage;r.initPage(n),r.result=o?playState.VICTORY:playState.FAILURE,a.fightPageControl=r;var s={vo:a,event:new u.ArenaEvent(u.ArenaEvent.SHOW_MATCH_PANEL),responseData:e};dispatchEvt(new u.FightsEvent(u.FightsEvent.ENTER_FIGHT_EVENT),s)},i.prototype.recordPlayback=function(i){var n=this,t={};t[Protocol.center_match_getBattleReport.args.idx]=i.index,PLC.request(Protocol.center_match_getBattleReport,t,function(t,e){t&&t.battleReport.reportData&&n.doPlayback(t,i)})},i.prototype.doPlayback=function(t,e){var i=t.battleReport.reportData;logzhanbao(i);var n=new u.FightVo;n.copyType=CopyType.arenaMatch,n.arenaMatchVo=e;var o=new u.ServerPage;o.initPage(i),o.result=e.isWin?playState.VICTORY:playState.FAILURE,n.fightPageControl=o;var a={vo:n,event:new u.ArenaEvent(u.ArenaEvent.FIGHT_BACK_TO_RECORD)};dispatchEvt(new u.FightsEvent(u.FightsEvent.ENTER_FIGHT_EVENT),a)},i.prototype.backToRecord=function(){this.showMatchView(!1),this.showRecordView(!1)},Object.defineProperty(i.prototype,"matchView",{get:function(){return UIMgr.getUIByName(UIConst.ArenaMatchView)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=u.MatchModel.getInstance(),t._request=u.MatchThread.getInsatnce(),t}u.MatchProcessor=t}(game=game||{}),function(u){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.initModel=function(){this._boxList=[];var t=TableData.getInstance().getTableByName(TableData.tb_match_box).data;for(var e in t){var i=t[e];i.need_num>this.maxTbCount&&(this.maxTbCount=i.need_num),this._boxList.push(new u.BaoxiangVo(i))}for(var n=tb.TB_match_score.getItemList(),o=-1,a=0,r=n.length;a<r;a++){var s=n[a];s.max_score=o,o=s.score}this.updateEndTime()},e.prototype.updateEndTime=function(){this.roundEndTime=GameUtil.getFormatTime(7,23,59,59)+1},e.prototype.getBoxList=function(){return this._boxList?this._boxList:[]},e.prototype.getMatchList=function(){return this._matchList?this._matchList:[]},e.prototype.setMatchList=function(t){this._matchList||(this._matchList=[]);for(var e=0,i=t.length;e<i;e++)this._matchList[e]?this._matchList[e].setSvo(t[e]):this._matchList.push(new u.MatchPlayerVo(t[e],e))},e.prototype.getMatchVo=function(e){return this.getMatchList().find(function(t){return t.playerId==e})},e.prototype.setRecordList=function(t){this._recordList=[];for(var e=0,i=t.length;e<i;e++)this._recordList.push(new u.MatchRecordVo(t[e],e));this._recordList.sort(function(t,e){return e.battleTime-t.battleTime})},e.prototype.getRecordList=function(){return this._recordList?this._recordList:[]},e.prototype.getGradeName=function(t){var e=this.getTbGrade(t);return e?e.name:""},e.prototype.getTbGrade=function(t){var e=TableData.getInstance().getTableByName(TableData.tb_match_score).data;for(var i in e){var n=e[i];if(t>=n.score)return n}return null},e.prototype.isCanReward=function(){return this._boxList.some(function(t){return t.isCanReward()})},e);function e(){this.score=0,this.benfuRank=0,this.lastRefreshTime=0,this.challengeCount=0,this.doneMatchChests=[],this.kuafuRank=0,this.maxTbCount=0}u.MatchModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"ArenaModule"},n.prototype.onRegister=function(){t.MatchModel.getInstance().initModel()},n.prototype.listProcessors=function(){return[new t.ArenaProcessor,new t.MatchProcessor]},n);function n(){return e.call(this)||this}t.ArenaModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_ARENA_PANEL="SHOW_ARENA_PANEL",r.SHOW_MATCH_PANEL="SHOW_MATCH_PANEL",r.TURN_OVER_CAED="TURN_OVER_CAED",r.LOOK_REPORT_END="LOOK_REPORT_END",r.CLEAN_ARENA_TIME="CLEAN_ARENA_TIME",r.GET_ARENA_BAGTTLE="GET_ARENA_BAGTTLE",r.UPDATE_ARENA_RANK="UPDATE_ARENA_RANK",r.SHOW_RECORD_PANLE="SHOW_RECORD_PANLE",r.ARENA_BUY_CARDITEM="ARENA_BUY_CARDITEM",r.SHOW_LINUEUP_PANLE="SHOW_LINUEUP_PANLE",r.ARENA_BATTEL_START="ARENA_BATTEL_START",r.ARENA_BATTEL_SWEEP="ARENA_BATTEL_SAODANG",r.UPDATE_MYSELF_FORCE="UPDATE_MYSELF_FORCE",r.ARENA_CHALLENGE_END="ARENA_CHALLENGE_END",r.BUY_ARENA_CHALLENGE="BUY_ARENA_CHALLENGE",r.SHOW_ARENARANK_PANEL="SHOW_ARENARANK_PANEL",r.UPDATE_ZHANDOU_JILU_DATA="UPDATE_ZHANDOU_JILU_DATA",r.SHOW_BUY_VIEW="SHOW_BUY_VIEW",r.SHOW_NOTICE_VIEW="SHOW_NOTICE_VIEW",r.SHOW_AWARD_VIEW="SHOW_AWARD_VIEW",r.SHOW_RANK_VIEW="SHOW_RANK_VIEW",r.SHOW_RECORD_VIEW="SHOW_RECORD_VIEW",r.SHOW_PLAYER_LINEUP="SHOW_PLAYER_LINEUP",r.MATCH_CHALLENGE="MATCH_CHALLENGE",r.MATCH_REWARD_BOX="MATCH_REWARD_BOX",r.MATCH_REWARD_BOX_SUCC="MATCH_REWARD_BOX_SUCC",r.REFRESH_MATCH_LIST="REFRESH_MATCH_LIST",r.MATCH_PLAYBACK="MATCH_PLAYBACK",r.FIGHT_BACK_TO_RECORD="FIGHT_BACK_TO_RECORD",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.ArenaEvent=a}(game=game||{}),function(t){var e=(i.prototype.getRewards=function(){return map2ary(this.addResource)},i.prototype.isLookReport=function(){return isEmptyObject(this.addResource)},i.prototype.isHistoryTop=function(){return!!this.topRank&&!!this.chgTopRank&&!!this.topRankDiamond},i);function i(t,e){for(var i in this.rank=0,this.name="",this.isWin=!1,this.chgRank=0,this.topRank=0,this.chgTopRank=0,this.addResource={},this.topRankDiamond=0,this)t[i]&&(this[i]=t[i]);t.commonData&&t.commonData.addResource&&(this.addResource=t.commonData.addResource),this.arenaRecordVo=e}t.ArenaReportVo=e}(game=game||{}),function(t){var e,i,n=(o.parseRecord=function(t){for(var e=[],i=t.length-1;0<=i;i--){var n=new o(t[i]);n.id=~~i,e.push(n)}return e},o.prototype.initData=function(){if(this.isNpc()){var t=this.tbData=tb.TB_arena_new_npc.getTB_arena_newById(this.targetRank);this.level=t.level,this.name=t.name,this.head=t.head,this.headFrame=0}},o.prototype.getChangeTypeSkin=function(){return SkinUtil.getUpOrDownSkinUrl(this.getRankChangeType())},o.prototype.isChallenge=function(){return 1==this.battleType},o.prototype.getChgValue=function(){return this.chgRank},o.prototype.getChgValuePrev=function(){return LanMgr.getLan("",12549)},o.prototype.getRankChangeType=function(){return 0<this.chgRank?e.Up:0==this.chgRank?e.None:e.Down},o.prototype.isNotChange=function(){return this.getRankChangeType()==e.None},o.prototype.beforeTime=function(){return logindifference(this.battleTime,App.serverTimeSecond)},o.prototype.getEvent=function(){return new t.ArenaEvent(t.ArenaEvent.GET_ARENA_BAGTTLE)},o.prototype.isRecord=function(){return!0},o.prototype.getForce=function(){return this.force},o.prototype.isNpc=function(){return!this.playerId},o.prototype.getTagForce=function(){return this.targetForce},o);function o(t){for(var e in this.playerId=null,this.targetRank=0,this.battleTime=0,this.battleType=0,this.isWin=!1,this.chgRank=0,this.level=0,this.name="",this.id=0,this.force=0,this.targetForce=0,t)this[e]=t[e];this.initData()}t.ArenaRecordVo=n,(i=e=e||{})[i.Up=1]="Up",i[i.None=0]="None",i[i.Down=-1]="Down"}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=common.RankVo,__extends(n,e),n.prototype.getValue=function(){return this.force+""},n.prototype.getValueDesc=function(){return"神力"},n.prototype.isShowMid=function(){return!1},n.prototype.isShowBottom=function(){return!0},n.prototype.initNpcData=function(){if(this.isNpc()){var t=tb.TB_arena_new_npc.getTB_arena_newById(this.rank);this.force=t.power,this.level=t.level,this.name=t.name,this.head=1==t.head?-1:-2}},n.prototype.isNpc=function(){return!this.playerId},n);function n(){return e.call(this)||this}t.ArenaRankVo=i}(game=game||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};!function(n){var t=(Object.defineProperty(e.prototype,"force",{get:function(){return this._force},set:function(t){this._force=t},enumerable:!0,configurable:!0}),e.prototype.initData=function(){if(this.isNpc()){var t=this.tbData=tb.TB_arena_new_npc.getTB_arena_newById(this.rank);this.force=t.power,this.level=t.level,this.name=t.name,this.sex=t.head,this.head=t.head,this.headFrame=0,this.maxForceGodId=t.getModelId(),this.maxForceGodModel=n.GodUtils.getShowGodModel(this.maxForceGodId,0)}else this.maxForceGodModel=n.GodUtils.getShowGodModel(this.maxForceGodId,this.skinId);this.guildName||(this.guildName=LanMgr.getLan("",12561))},e.prototype.setDataAtAppHero=function(){if(this.defInfo[0]=__spreadArrays(App.hero.getLineUpTeam(iface.tb_prop.lineupTypeKey.attack)),0==this.defInfo[0].length){var t=new GodItemVo(tb.TB_god.get_TB_godById(3002));this.defInfo[0].push(t)}var e=App.hero.lineupArtifactInfo[iface.tb_prop.lineupTypeKey.attack]||0;this.defInfo[1]=[e];var i=this.getDefLinueupFirst();this.maxForceGodId=i.tab_god.model,this.maxForceGodModel=i.getModel(),this.guildName=App.hero.guildName,this.playerId=App.hero.playerId,this.level=App.hero.level,this.name=App.hero.name,this.head=App.hero.getHeadId(),this.sex=App.hero.sex,this.headFrame=App.hero.headFrame,this.force=n.GodModel.getInstance().getForce(iface.tb_prop.lineupTypeKey.attack),this.tbData=null},e.prototype.setDefInfo=function(t){for(var e in this.defInfo=[[]],t[0]){var i=t[0][e];if(i){var n=tb.TB_god.get_TB_godById(i[0]),o=new GodItemVo(n);o&&(o.level=i[2],o.starLevel=i[1],o.templateId=i[0],o.degree=i[4],o.awakenLv=i[5],o.skinId=i[6],o.iSeverAttri=map2ary(i[3]),o.iSeverAttri.forEach(function(t){return t[0]--})),this.defInfo[0].push(o)}else this.defInfo[0].push(null)}this.defInfo[1]=t[1]},e.prototype.getLineupGods=function(){var t=this.getLinueUpAry();return t||[this.getDefLinueupFirst()]},e.prototype.getShenqiAry=function(){return this.defInfo[1]},e.prototype.getDefLinueupFirst=function(){return this.defInfo[0]?this.defInfo[0].find(function(t){return!!t}):new GodItemVo(tb.TB_god.get_TB_godById(3002))},e.prototype.getLinueUpAry=function(){return this.isNpc()?this.tbData.getMonsters():this.defInfo[0]},e.prototype.isMySelf=function(){return this.playerId==App.hero.playerId},e.prototype.isNpc=function(){return!this.playerId},e.prototype.isBeforeThree=function(){return this.rank<=3},e);function e(t,e){if(this.defInfo=[],this.playerId=null,this.godIcon="","number"==typeof t)this.rank=t;else for(var i in t)this[i]=t[i];this.initData(),this.type=common.LinuepType.arena,this.myRank=e}n.ArenaInfoVo=t}(game=game||{}),function(r){var t=(e.prototype.parseClg=function(t,e){var i=[];for(var n in t){var o=new r.ArenaInfoVo(t[n],e);2e3==o.rank&&2e3==this.rank&&o.setDataAtAppHero(),i.push(o)}return i},e.prototype.parseRank=function(t){for(var e=[],i=1;i<51;i++){var n=!0;for(var o in t)if(~~o==i){var a;(a=new r.ArenaRankVo).setSvo(t[o]),a.rank=i,e.push(a),n=!1;break}n&&((a=new r.ArenaRankVo).rank=i,a.initNpcData(),e.push(a))}return e},e);function e(t){this.rank=t.rank,this.topRank=t.topRank,t.clgList&&(this.clgInfoList=this.parseClg(t.clgList,t.rank)),t.rankList&&(this.rankInfoList=this.parseRank(t.rankList))}r.ArenaInfo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=Laya.HBox,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)&&this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=this._childs,i=tb.TB_item.get_TB_itemById(t[0]);e[1].text="+"+t[1],e[0].skin=SkinUtil.getCostSkin(i.ID),e[0].size(36,36),this.refresh()}},n);function n(){return e.call(this)||this}t.ClgRewardIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.arena.arena.render.ArenaIRUI,__extends(n,i),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)&&this.refreshView()},enumerable:!0,configurable:!0}),n.prototype.refreshView=function(){this.setForceLabel();var t=this.dataSource;this.lbname.text=t.name,this.lbguild.text=t.guildName,this.lbrank.text=t.rank+"",this.imgmyself.visible=t.isMySelf(),this.imgRank.skin=SkinUtil.getArenaRankBg(t.rank),this.lbrank.fontSize=e.ArenaModel.getClgRankLbSize(t.rank)},n.prototype.setForceLabel=function(){this.lbshenli.text=this.dataSource.force+""},n.prototype.onLinueUp=function(){this.dataSource.isMySelf()?showToast(LanMgr.getLan("",10208)):dispatchEvt(new e.ArenaEvent(e.ArenaEvent.SHOW_LINUEUP_PANLE),this.dataSource)},n);function n(){var t=i.call(this)||this;return t.on(Laya.Event.CLICK,t,t.onLinueUp),t}e.ArenaIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.arena.arena.render.ArenaBrandIRUI,__extends(n,i),n.prototype.getIndex=function(){return this._index},n.prototype.setVis=function(t){this.box.visible=t},n.prototype.setChildData=function(t,e){this._dataAry=t,this._index=e;var i=t[1];this.setBuyNodeVisible(i);var n=tb.TB_arena_draw.getDataById(t[0]);this.itemBox.dataSource=new ItemVo(n.item[0],n.item[1]),i&&(this.imgcost.skin=SkinUtil.getCostSkin(n.cost[0]),this.lbdiscount.text=LanMgr.getLan("",12169,n.discount),this.lbcost.text=n.cost[1]+""),this.setVis(!0)},n.prototype.setBuyNodeVisible=function(t){this.lbdiscount.visible=this.imgdiscount.visible=this.btnbuy.visible=this.lbcost.visible=this.imgcost.visible=t},n.prototype.onBuyArenaItem=function(){if(this._dataAry&&!(this._dataAry.length<2)){var t=tb.TB_arena_draw.getDataById(this._dataAry[0]);UIUtil.checkNotEnough(t.cost[0],t.cost[1])||dispatchEvt(new e.ArenaEvent(e.ArenaEvent.ARENA_BUY_CARDITEM),this._index)}},n);function n(){var t=i.call(this)||this;return t.btnbuy.on(Laya.Event.CLICK,t,t.onBuyArenaItem),t}e.ArenaBrandIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.arena.arena.ArenaUI,__extends(i,e),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.uiScene=new Base2dSceneLayer,this.panel.addChild(this.uiScene),this.btnbuynum.on(Laya.Event.CLICK,this,this.onClick),this.imgBg.skin=SkinUtil.getSysMapSkin(ModuleConst.JINGJI),this.rankList.array=null,this.rankList.selectedIndex=-1,this.rankList.selectEnable=!0,this.rankList.renderHandler=new Handler(this,this.onRender),this.rankList.scrollBar&&this.rankList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollChange)},i.prototype.popup=function(){e.prototype.popup.call(this,!1,!1),this.initView()},i.prototype.show=function(){e.prototype.show.call(this,!1,!1),this.initView()},Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t},enumerable:!0,configurable:!0}),i.prototype.initView=function(){var t=[{btnSkin:SkinUtil.btn_shop,callback:this.onShop.bind(this)},{btnSkin:SkinUtil.btn_rank,callback:this.onRank.bind(this)},{btnSkin:SkinUtil.btn_record,callback:this.onRecord.bind(this)},{btnSkin:SkinUtil.btn_refresh,callback:this.onRefresh.bind(this)}],e=[iface.tb_prop.resTypeKey.gold,iface.tb_prop.resTypeKey.diamond,iface.tb_prop.resTypeKey.arena];UIUtil.showSysTopView({viewName:this.dialogInfo.uiname,resAry:e,funList:t,closeCallback:this.toClose.bind(this)}),this.setArenaInfo(),this.setChallengeNum(),tl3d.ModuleEventManager.addEvent(n.ArenaEvent.UPDATE_MYSELF_FORCE,this.updateMyselfForce,this),tl3d.ModuleEventManager.addEvent(n.ResEvent.OVERPLUS_VALUE_CHANGE,this.setChallengeNum,this)},i.prototype.setArenaInfo=function(){var t=this.dataSource;this.lbmyrank.changeText(""+LanMgr.getLan("",12265)+t.rank),this.lbrankmax.changeText(""+LanMgr.getLan("",12550)+t.topRank);var e=t.clgInfoList||[];this.rankList.array=e;var i=this.rankList.array.findIndex(function(t){return t.isMySelf()});-1!=i&&this.rankList.scrollTo(i),n.ArenaModel.getInstance().loads(this.uiScene,e)},i.prototype.updateMyselfForce=function(){dispatchEvt(new n.ArenaEvent(n.ArenaEvent.UPDATE_ARENA_RANK))},i.prototype.getChallengeFailCD=function(){return App.hero.arenaFailTime+tb.TB_arena_new_set.getArenaNewSet().fail_cd-App.serverTimeSecond},i.prototype.setChallengeNum=function(){this.lbhasnum.changeText("奖励次数："+App.hero.arenaNum)},i.prototype.onRender=function(t,e){t.x=e%2==0||0==e?0:400},i.prototype.onClick=function(t){t.target===this.btnbuynum&&dispatchEvt(new n.ArenaEvent(n.ArenaEvent.BUY_ARENA_CHALLENGE))},i.prototype.toClose=function(){this.close(),dispatchEvt(new n.HudEvent(n.HudEvent.SHOW_ENTRANCE_VIEW,tb.TB_function.TYPE_JINGJI))},i.prototype.onShop=function(){dispatchEvt(new n.ShopEvent(n.ShopEvent.SHOW_SHOP_VIEW),ShopType.jingjichang)},i.prototype.onRank=function(){dispatchEvt(new n.ArenaEvent(n.ArenaEvent.SHOW_ARENARANK_PANEL))},i.prototype.onRecord=function(){dispatchEvt(new n.ArenaEvent(n.ArenaEvent.SHOW_RECORD_PANLE))},i.prototype.onRefresh=function(){this._clickRefreshTime+3>=App.getServerTime()?showToast(LanMgr.getLan("",11012)):(this._clickRefreshTime=App.getServerTime(),dispatchEvt(new n.ArenaEvent(n.ArenaEvent.UPDATE_ARENA_RANK)))},i.prototype.addChildModel=function(){var n=this;this.uiScene.onExit(),this.rankList.array.forEach(function(t,e){var i=e%2==0||0==e?0:400;n.addModelChar(t.maxForceGodId+"",i,e*(311+n.rankList.spaceY))})},i.prototype.onScrollChange=function(){this.rankList.scrollBar&&(this.uiScene.y=255-this.rankList.scrollBar.value-Launch.offsetY)},i.prototype.addModelChar=function(t,e,i,n,o){void 0===n&&(n=180),void 0===o&&(o=1.4);var a=new GameUIChar;this.uiScene.scene.addMovieDisplay(a),a.setRoleUrl(getRoleUrl(t)),a.play(tl3d.CharAction.STANAD),a.forceRotationY=n,a.set2dPos(e,i),a.scale=o},i.prototype.onClosed=function(){e.prototype.onClosed.call(this),n.ArenaModel.getInstance().clearAllChar(),this.uiScene.onExit(),this.rankList.array=null,tl3d.ModuleEventManager.removeEvent(n.ArenaEvent.UPDATE_MYSELF_FORCE,this.updateMyselfForce,this),tl3d.ModuleEventManager.removeEvent(n.ResEvent.OVERPLUS_VALUE_CHANGE,this.setChallengeNum,this),UIMgr.hideUIByName(UIConst.SysTopView)},i);function i(){var t=e.call(this)||this;return t._failCD=0,t._clickRefreshTime=0,t.group=UIConst.hud_group,t}n.ArenaView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.arena.arena.ArenaTopRankUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this,!1,!1),this.initView()},n.prototype.initView=function(){this.bgPanel.showTitle(!0,"zhandoubiaoxian/lisizuigao.png");var t=this.dataSource;this.lbreward.changeText("+"+t.topRankDiamond),this.lbup.text="("+t.chgRank,this.lbmax.changeText(""+t.topRank),this.lbrank.text=""+t.rank,this.lbrank.event(Laya.Event.RESIZE),this.lbup.event(Laya.Event.RESIZE),this.hbox.refresh()},n.prototype.close=function(){e.prototype.close.call(this),this.bgPanel.closeTitle()},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t}t.ArenaTopRankView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.arena.arena.ArenaSuccUI,__extends(n,e),n.prototype.popup=function(){this.initView(),e.prototype.popup.call(this,!1,!1)},n.prototype.initView=function(){var t=this;AudioMgr.playSound("sound/victory.mp3"),this.itemList.selectHandler=new Handler(this,this.onSelect);var e=this.dataSource.eventdata;this.rewardList.array=e.getRewards(),isEmptyObject(e.addResource)?(this.itemList.visible=this.lbbox.visible=this.box_chou.visible=this.box_reward.visible=!1,this.setModelClose(!0),this.uiScene.onExit(),this.setLayout(!1)):(this.itemList.visible=this.lbbox.visible=this.box_chou.visible=this.box_reward.visible=!0,this.setModelClose(!1),this.addChildModel(),this.setLayout(!0)),this.bgPanel.showTitle(!0,e.type!=i.ArenaBattleType.SWEEP?"zhandoubiaoxian/shengli.png":"comp/title/saodangchenggong.png",!0,!0,!0,new Handler(this,function(){t.setModelClose(!1)}),this),this.lab_rank_title.visible=this.lbrank.visible=e.type!=i.ArenaBattleType.SWEEP,this.lbup.text="("+e.chgRank,this.lbrank.text=""+e.rank,this.lbrank.event(Laya.Event.RESIZE),this.lbup.event(Laya.Event.RESIZE),this.hbox.event(Laya.Event.RESIZE),this.lbup.visible=this.imgchg.visible=this.lbright.visible=0!=e.chgRank},n.prototype.onSelect=function(t){this.lbbox.visible=!1,this.itemList.selectHandler=null,dispatchEvt(new i.ArenaEvent(i.ArenaEvent.TURN_OVER_CAED),t+1)},n.prototype.setItemListCells=function(n){var o=this,a=this.itemList.cells;a.forEach(function(t,e){t.setVis(!1)}),this._cards.forEach(function(t,e){var i=e+1;o.charPlaySkill(t,function(){t.play(tl3d.CharAction.WALK,1,!1)}),o.timer.once(500,o,function(){a[e].setChildData(n[i],i)})}),Laya.timer.frameOnce(31,this,function(){o.setModelClose(!0)})},n.prototype.setItemListCellById=function(e){var t=this.itemList.cells.find(function(t){return t.getIndex()==e});t&&t.setBuyNodeVisible(!1)},n.prototype.setModelClose=function(t){this.isModelClose=this.lbclose.visible=t},n.prototype.addChildModel=function(){var n=this;this.uiScene.onExit(),this.itemList.array.forEach(function(t,e){var i=n.itemList.getCell(e);i.box.visible=!1,n.addModelChar("100002",i.x,0)})},n.prototype.addModelChar=function(t,e,i,n,o){void 0===n&&(n=180),void 0===o&&(o=1.1);var a=new GameUIChar;this.uiScene.scene.addMovieDisplay(a),a.setRoleUrl(getRoleUrl(t)),a.play(tl3d.CharAction.STANAD),a.forceRotationY=n,a.set2dPos(e,i),a.scale=o,this._cards.push(a)},n.prototype.charPlaySkill=function(t,e){var i=this;void 0===e&&(e=null),this._guajiskill=this.uiScene.scene.skillMgr.getSkill(getSkillUrl("100002"),"skill_01",function(){i.charPlaySkill(t,e)}),this._guajiskill.keyAry&&(this._guajiskill&&(this._guajiskill.reset(),this._guajiskill.isDeath=!1),t&&t.onStage&&(this._guajiskill.configFixEffect(t,e),this._guajiskill.needShock=!1,this.uiScene.scene.skillMgr.playSkill(this._guajiskill)))},n.prototype.setLayout=function(t){t?(this.lab_rank_title.y=this.hbox.y=76,this.bgPanel.height=610):(this.bgPanel.height=200,this.lab_rank_title.y=this.hbox.y=100),this.height=this.bgPanel.height},n.prototype.close=function(){this.isModelClose?(e.prototype.close.call(this),this.bgPanel.closeTitle(),this._cards=[],this.uiScene.onExit(),this.lbbox.visible=!0,this.itemList.selectedIndex=-1,this.itemList.cells.forEach(function(t,e){t.box.visible=!1}),dispatchEvt(new i.FightsEvent(i.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource)):showToast(LanMgr.getLan("",10237))},n);function n(){var t=e.call(this)||this;return t._cards=[],t.itemList.array=[[],[],[]],t.itemList.zOrder=t._childs.length-1,t.uiScene=new Base2dSceneLayer,t.uiScene.setPosition(137,803),t.box_content.addChild(t.uiScene),t}i.ArenaSuccView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.arena.arena.ArenaRankUI,__extends(n,i),n.prototype.popup=function(){i.prototype.popup.call(this),this.initView()},n.prototype.initView=function(){var t=this.dataSource;this._myRank=t.rank,this.tab.selectedIndex=0,this.rankList.array=t.rankInfoList,this.onTabSelect(0)},n.prototype.onTabSelect=function(t){this.viewstack.selectedIndex=t,this.lbtime.text=1==t?LanMgr.getLan("",12552,this._rewardTime):""+LanMgr.getLan("",12265)+this._myRank},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.rankList.array=null},n);function n(){var t=i.call(this)||this;t.isModelClose=!0,t.rewardList.array=tb.TB_arena_new.get_TB_arena_new(),t.tab.selectHandler=new Handler(t,t.onTabSelect);var e=tb.TB_arena_new_set.getArenaNewSet().daily_reward;return t._rewardTime=e[0]+":"+buquan(e[1],2),t.bgPanel.dataSource={uiName:UIConst.ArenaRankView,closeOnSide:!0,closeOnButton:!0,title:LanMgr.getLan("",12551)},t}t.ArenaRankView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.arena.arena.ArenaFailUI,__extends(n,e),n.prototype.popup=function(){this.initView(),e.prototype.popup.call(this,!1,!1)},n.prototype.initView=function(){AudioMgr.playSound("sound/defeated.mp3");var t=this.dataSource.eventdata;this.lbrank.text=""+t.rank,this.rewardList.array=t.getRewards(),this.lbdoem.text="("+t.chgRank,this.hbox.refresh(),this.lbdoem.visible=this.imgchg.visible=this.lbright.visible=0!=t.chgRank,this.rewardList.array&&0<this.rewardList.array.length?(this.box_reward.visible=!0,this.box_force.y=this.box_reward.y+80):(this.box_reward.visible=!1,this.box_force.y=this.box_reward.y),this.channel.y=this.box_force.y+43,this.height=this.bgPanel.height=this.channel.y+this.channel.height+40,this.lab_empty.y=this.height+60,this.bgPanel.showTitle(!1,"zhandoubiaoxian/shibai.png",!1,!0,!1,null,this)},n.prototype.close=function(){e.prototype.close.call(this),dispatchEvt(new t.FightsEvent(t.FightsEvent.EXIT_FIGHT_EVENT),this.dataSource)},n);function n(){var t=e.call(this)||this;return t.isModelClose=!0,t.channel.callback=function(){t.dataSource.flag=!0,UIMgr.hasStage(UIConst.Main3DView)||UIMgr.showUI(UIConst.Main3DView),t.close()},t}t.ArenaFailView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"ArenaProcessor"},i.prototype.listenModuleEvents=function(){return[new s.ArenaEvent(s.ArenaEvent.SHOW_ARENA_PANEL),new s.ArenaEvent(s.ArenaEvent.SHOW_ARENARANK_PANEL),new s.ArenaEvent(s.ArenaEvent.BUY_ARENA_CHALLENGE),new s.ArenaEvent(s.ArenaEvent.UPDATE_MYSELF_FORCE),new s.ArenaEvent(s.ArenaEvent.ARENA_CHALLENGE_END),new s.ArenaEvent(s.ArenaEvent.SHOW_LINUEUP_PANLE),new s.ArenaEvent(s.ArenaEvent.ARENA_BUY_CARDITEM),new s.ArenaEvent(s.ArenaEvent.ARENA_BATTEL_SWEEP),new s.ArenaEvent(s.ArenaEvent.ARENA_BATTEL_START),new s.ArenaEvent(s.ArenaEvent.SHOW_RECORD_PANLE),new s.ArenaEvent(s.ArenaEvent.GET_ARENA_BAGTTLE),new s.ArenaEvent(s.ArenaEvent.UPDATE_ARENA_RANK),new s.ArenaEvent(s.ArenaEvent.CLEAN_ARENA_TIME),new s.ArenaEvent(s.ArenaEvent.LOOK_REPORT_END),new s.ArenaEvent(s.ArenaEvent.TURN_OVER_CAED)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof s.ArenaEvent)switch(t.type){case s.ArenaEvent.SHOW_ARENA_PANEL:this.showArenaView();break;case s.ArenaEvent.LOOK_REPORT_END:this.lookReportEnd();break;case s.ArenaEvent.TURN_OVER_CAED:this.turnOverCard(t.data);break;case s.ArenaEvent.CLEAN_ARENA_TIME:this.clearArenaCd();break;case s.ArenaEvent.UPDATE_ARENA_RANK:this.updateClgList();break;case s.ArenaEvent.GET_ARENA_BAGTTLE:this.getBattleReport(t.data);break;case s.ArenaEvent.SHOW_RECORD_PANLE:this.showRecordView();break;case s.ArenaEvent.ARENA_BATTEL_START:this.battleStart(t.data);break;case s.ArenaEvent.ARENA_BATTEL_SWEEP:this.battleSweep(t.data);break;case s.ArenaEvent.ARENA_BUY_CARDITEM:this.buyCardItems(t.data);break;case s.ArenaEvent.SHOW_LINUEUP_PANLE:this.showLinueView(t.data);break;case s.ArenaEvent.BUY_ARENA_CHALLENGE:this.buyBattleCnt();break;case s.ArenaEvent.ARENA_CHALLENGE_END:this.challengeEnd(t.data);break;case s.ArenaEvent.SHOW_ARENARANK_PANEL:this.showRankView()}},i.prototype.showArenaView=function(){this.refreshClgList().then(function(t){t&&UIMgr.showUI(UIConst.ArenaView,t)})},i.prototype.updateClgList=function(){var e=this;this.refreshClgList().then(function(t){t&&e.ArenaViewHasStage&&(e.ArenaView.dataSource=t,e.ArenaView.setArenaInfo())})},i.prototype.challengeEnd=function(t){this.showArenaView(),t.isHistoryTop()&&UIMgr.showUI(UIConst.ArenaTopRankView,t)},i.prototype.showRankView=function(){this.getArenaRankList().then(function(t){t&&UIMgr.showUI(UIConst.ArenaRankView,t)})},i.prototype.showRecordView=function(){this.getBattleRecords().then(function(t){t&&UIMgr.showUI(UIConst.ArenaRecordView,t)})},i.prototype.lookReportEnd=function(){var e=this;this.refreshClgList().then(function(t){t&&UIMgr.showUI(UIConst.ArenaView,t),e.getBattleRecords().then(function(t){t&&UIMgr.showUI(UIConst.ArenaRecordView,t)})})},i.prototype.refreshClgList=function(){return new Promise(function(n,t){PLC.request(Protocol.center_arena_refreshClgList,null,function(t,e){if(t){var i=new s.ArenaInfo(t);n(i)}else n(null)})})},i.prototype.getArenaRankList=function(){return new Promise(function(i,t){PLC.request(Protocol.center_arena_getArenaRankList,null,function(t,e){i(t?new s.ArenaInfo(t):null)})})},i.prototype.getBattleRecords=function(){return new Promise(function(i,t){PLC.request(Protocol.center_arena_getBattleRecords,null,function(t,e){i(t?s.ArenaRecordVo.parseRecord(t.battleRecords):null)})})},i.prototype.battleSweep=function(n){var o=this,t={};t[Protocol.game_arena_arenaSweep.args.targetId]=n.playerId,t[Protocol.game_arena_arenaSweep.args.targetRank]=n.rank,t[Protocol.game_arena_arenaSweep.args.selfRank]=n.myRank,PLC.request(Protocol.game_arena_arenaSweep,t,function(t,e){if(t){t.name=n.name;var i=o.getVo(t,null,null,n);i.eventdata.type=s.ArenaBattleType.SWEEP,UIMgr.showUI(UIConst.ArenaSuccView,i)}})},i.prototype.battleStart=function(i){var n=this,t={};t[Protocol.game_arena_battleStart.args.targetId]=i.playerId,t[Protocol.game_arena_battleStart.args.targetRank]=i.rank,t[Protocol.game_arena_battleStart.args.selfRank]=i.myRank,PLC.request(Protocol.game_arena_battleStart,t,function(t,e){t&&t.battleReport.reportData&&(t.name=i.name,n.doPlayback(t,new s.ArenaEvent(s.ArenaEvent.ARENA_CHALLENGE_END),null,i))})},i.prototype.getBattleReport=function(i){var n=this,t={};t[Protocol.center_arena_getBattleReport.args.idx]=i.id,PLC.request(Protocol.center_arena_getBattleReport,t,function(t,e){t&&t.battleReport.reportData&&(t.name=i.name,n.doPlayback(t,new s.ArenaEvent(s.ArenaEvent.LOOK_REPORT_END),i,null))})},i.prototype.getVo=function(t,e,i,n){var o=new s.FightVo;o.arenaReportVo=new s.ArenaReportVo(t,i),n?(o.arenaReportVo.head=n.head,o.arenaReportVo.level=n.level,o.arenaReportVo.force=n.force,o.arenaReportVo.targetforce=0,o.arenaReportVo.headFrame=n.headFrame):i&&(o.arenaReportVo.head=i.head,o.arenaReportVo.level=i.level,o.arenaReportVo.force=i.getForce(),o.arenaReportVo.targetforce=i.getTagForce(),o.arenaReportVo.headFrame=i.headFrame),e&&e.type==s.ArenaEvent.LOOK_REPORT_END?o.copyType=CopyType.jingji_record:o.copyType=CopyType.jingji_pve;var a=new s.ServerPage;t.battleReport&&(a.initPage(t.battleReport.reportData),logzhanbao(t.battleReport.reportData));var r=i?i.isWin:o.arenaReportVo.isWin;return a.result=r?playState.VICTORY:playState.FAILURE,o.fightPageControl=a,{vo:o,event:e,eventdata:o.arenaReportVo}},i.prototype.doPlayback=function(t,e,i,n){var o=this.getVo(t,e,i,n);o.eventdata.type=s.ArenaBattleType.BATTLE,dispatchEvt(new s.FightsEvent(s.FightsEvent.ENTER_FIGHT_EVENT),o)},i.prototype.buyBattleCnt=function(){var i=this;App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyArenaNum)>=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.arenaBuyNum)?App.hero.vip>=tb.TB_vip.getMaxVip()?showToast(LanMgr.getLan("",10360)):(showToast(LanMgr.getLan("",10361)),dispatchEvt(new s.TopUpEvent(s.TopUpEvent.SHOW_CHONGZHI_PANEL),[1])):UIMgr.showUI(UIConst.BuyBattleCount,{type:common.BuyBattleCountView.TYPE_ARENA,callback:function(t){var e={};e[Protocol.game_arena_buyBattleCnt.args.count]=t,PLC.request(Protocol.game_arena_buyBattleCnt,e,function(t,e){t&&i.ArenaView.setChallengeNum()})}})},i.prototype.clearArenaCd=function(){},i.prototype.showLinueView=function(i){if(i.isNpc()&&i.tbData)UIMgr.showUI(UIConst.PlayerLineupInfoView,i);else{var t={};t[Protocol.center_arena_observeArenaPlayer.args.obPlayerId]=i.playerId,PLC.request(Protocol.center_arena_observeArenaPlayer,t,function(t,e){t&&(i.setDefInfo(t.targetDefInfo),UIMgr.showUI(UIConst.PlayerLineupInfoView,i))})}},i.prototype.turnOverCard=function(t){var i=this,e={};e[Protocol.game_arena_turnOverCard.args.idx]=t,PLC.request(Protocol.game_arena_turnOverCard,e,function(t,e){t&&(Laya.timer.frameOnce(50,i,function(){UIUtil.showRewardView(t.commonData)}),i.ArenaSuccView.setItemListCells(t.cardInfos))})},i.prototype.buyCardItems=function(i){var n=this,t={};t[Protocol.game_arena_turnOverCard.args.idx]=i,PLC.request(Protocol.game_arena_buyCardItems,t,function(t,e){t&&(UIUtil.showRewardView(t.commonData),n.ArenaSuccView.setItemListCellById(i))})},Object.defineProperty(i.prototype,"ArenaView",{get:function(){return UIMgr.getUIByName(UIConst.ArenaView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ArenaViewHasStage",{get:function(){return UIMgr.hasStage(UIConst.ArenaView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ArenaSuccView",{get:function(){return UIMgr.getUIByName(UIConst.ArenaSuccView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}s.ArenaProcessor=e}(game=game||{}),function(e){var t;(t=e.ArenaBattleType||(e.ArenaBattleType={}))[t.SWEEP=0]="SWEEP",t[t.BATTLE=1]="BATTLE";var i=(n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.getClgRankLbSize=function(t){return 0<t&&t<100?45:100<=t&&t<1e3?35:30},n.getRewardRankLbSize=function(t){switch(t){case 5:return 45;case 6:return 38;case 7:return 32;case 8:return 28;case 9:return 25;default:return 50}},n.prototype.loads=function(t,e){this._baseScene=t,this._infolist=e,this._total=e?e.length:0,this._curIdx=0,this.queueOpt()},n.prototype.queueOpt=function(){Laya.timer.frameOnce(2,this,this.Load.bind(this))},n.prototype.Load=function(){this._curIdx>this._infolist.length-1?this._curIdx=0:this.loadRole()},n.prototype.loadRole=function(){if(this._curLoadVo=this._infolist[this._curIdx],this._curLoadVo&&this._curLoadVo.maxForceGodModel){var t=getRoleUrl(this._curLoadVo.maxForceGodModel.toString());tl3d.MeshDataManager.getInstance().getMeshData(t,this.onRoleLoaded.bind(this))}else this.onRoleLoaded(null)},n.prototype.onRoleLoaded=function(t){if(t)if(this._sceneRoleMap||(this._sceneRoleMap=new Map),this._sceneRoleMap.has(this._curIdx)){var e=this._sceneRoleMap.get(this._curIdx);e.char?e.char.setRoleUrl(getRoleUrl(String(this._curLoadVo.maxForceGodModel))):e.char=this.CreateRoleView()}else this._curLoadVo.char=this.CreateRoleView(),this._sceneRoleMap.set(this._curIdx,this._curLoadVo);this._curIdx++,this.queueOpt()},n.prototype.CreateRoleView=function(){var t=this._curIdx%2==0||0==this._curIdx?150:550;return this.addModelChar(this._curLoadVo.maxForceGodModel.toString(),t,173*this._curIdx+Launch.offsetY)},n.prototype.addModelChar=function(t,e,i,n,o){if(void 0===n&&(n=180),void 0===o&&(o=1.4),this._baseScene){var a=new GameUIChar;return this._baseScene.scene.addMovieDisplay(a),a.setRoleUrl(getRoleUrl(t)),a.play(tl3d.CharAction.STANAD),a.forceRotationY=n,a.set2dPos(e,i),a.scale=o,a}},n.prototype.clearAllChar=function(){this._baseScene=null,this._infolist=[],this._sceneRoleMap&&(this._sceneRoleMap.forEach(function(t,e,i){t.char&&(t.char.removeSelf(),t.char=null)}),this._sceneRoleMap.clear())},n.prototype.setNewRecordFlag=function(t){this._hasNewRecord=t,dispatchEvt(new e.ArenaEvent(e.ArenaEvent.UPDATE_ZHANDOU_JILU_DATA))},n.prototype.isHasNewRecord=function(){return this._hasNewRecord},n);function n(){this._total=0,this._curIdx=0,this._hasNewRecord=!1}e.ArenaModel=i}(game=game||{});var OperateActivityVo=function(){function t(){this.redopt=!1}return t.prototype.setData=function(t){this.id=t.id,this.condCount=t.condCount,this.condValue=t.condValue,this.otherInfo=t.otherInfo,this.rewardInfo=t.rewardInfo,this.rewardCount=t.rewardCount,this.tbActivity=tb.TB_operate_activity.get_TB_operate_activityById(t.id),this.sort()},t.prototype.getDesc=function(){return LanMgr.getLan(this.tbActivity.desc,-1,this.condValue,this.condCount)},t.prototype.setCondCount=function(t){this.condCount=t},t.prototype.getCondCount=function(){return this.condCount},t.prototype.setCondValue=function(t){this.condValue=t},t.prototype.getCondValue=function(){return this.condValue},t.prototype.setOtherInfo=function(t){this.otherInfo=t},t.prototype.getOtherInfoLen=function(){return this.otherInfo?this.otherInfo.length:0},t.prototype.getOtherInfo=function(){return this.otherInfo||[[]]},t.prototype.setRewardInfo=function(t){this.rewardInfo=t},t.prototype.getRewardInfo=function(){return this.rewardInfo||[[]]},t.prototype.setRewardCount=function(t){this.rewardCount=t},t.prototype.getRewardCount=function(){return this.rewardCount},t.prototype.getChongZhiIndex=function(){return this.tbActivity?this.tbActivity.index:-1},t.prototype.isReceive=function(){return!1},t.prototype.getChangeNum=function(){var t=0;if(this.tbActivity.type==iface.tb_prop.operateActivityTypeKey.exchange){for(var e=9999999,i=0;this.otherInfo&&i<this.otherInfo.length;i++){var n=this.otherInfo[i],o=App.hero.getBagItemNum(n[0]);e=Math.min(e,Math.floor(o/n[1]))}t=e}return t},t.prototype.isCanReward=function(){return!!this.tbActivity&&(this.tbActivity.type==iface.tb_prop.operateActivityTypeKey.giftPacks||this.tbActivity.type==iface.tb_prop.operateActivityTypeKey.singleRecharge?1<=this.condCount:this.tbActivity.type==iface.tb_prop.operateActivityTypeKey.exchange?this.exchangeIsComplete()&&!this.redopt:this.condValue<=this.condCount&&0==this.rewardCount)},t.prototype.exchangeIsComplete=function(){if(this.tbActivity.type!=iface.tb_prop.operateActivityTypeKey.exchange)return!1;for(var t=this.condValue-this.rewardCount,e=!0,i=0;this.otherInfo&&i<this.otherInfo.length;i++){var n=this.otherInfo[i];if(App.hero.getBagItemNum(n[0])<n[1]){e=!1;break}}return e&&0<t},t.prototype.isOverdue=function(){return App.getServerTime()>=this.endtime},t.prototype.sort=function(){var t=tb.TB_operate_activity.get_TB_operate_activityById(this.id);if(t)if(t.link==iface.tb_prop.operateActivityTypeKey.arenaSum||t.link==iface.tb_prop.operateActivityTypeKey.goundSum||t.link==iface.tb_prop.operateActivityTypeKey.dailyCopy||t.link==iface.tb_prop.operateActivityTypeKey.expeditionMax||t.link==iface.tb_prop.operateActivityTypeKey.mineOccupyNum||t.link==iface.tb_prop.operateActivityTypeKey.escortCount||t.link==iface.tb_prop.operateActivityTypeKey.robCount||t.link==iface.tb_prop.operateActivityTypeKey.mineRobNum||t.link==iface.tb_prop.operateActivityTypeKey.guildCopy||t.link==iface.tb_prop.operateActivityTypeKey.advtDispatch||t.link==iface.tb_prop.operateActivityTypeKey.employ||t.link==iface.tb_prop.operateActivityTypeKey.door||t.link==iface.tb_prop.operateActivityTypeKey.runeCopy||t.link==iface.tb_prop.operateActivityTypeKey.worldBoss||t.link==iface.tb_prop.operateActivityTypeKey.consumeSum||t.link==iface.tb_prop.operateActivityTypeKey.dailyRecharge||t.link==iface.tb_prop.operateActivityTypeKey.loginSum||t.link==iface.tb_prop.operateActivityTypeKey.rechargeSum){var e=0!=this.rewardCount,i=this.condCount>=this.condValue;this.sortNum=e?this.id+1e5:i?this.id:this.id+1e3}else if(t.link==iface.tb_prop.operateActivityTypeKey.exchange){var n=this.condValue-this.rewardCount,o=App.hero.getBagItemNum(this.otherInfo[0][0])>=this.otherInfo[0][1]&&0<n;this.sortNum=o?this.id:1e3*this.id}else if(t.link==iface.tb_prop.operateActivityTypeKey.giftPacks){var a=this.endtime<=App.getServerTime();0<this.condCount?this.sortNum=this.id:this.otherInfo[0]<=this.rewardCount||a?this.sortNum=this.id+1e5:this.sortNum=this.id+1e3}else if(t.link==iface.tb_prop.operateActivityTypeKey.singleRecharge){e=this.otherInfo[0][1]-this.rewardCount<=0,i=0<this.condCount;this.sortNum=e?this.id+1e5:i?this.id:this.id+1e3}},t.prototype.modifyData=function(t){if(t.modifyCondCount)for(var e in t.modifyCondCount)t.modifyCondCount.hasOwnProperty(e)&&(this.condCount=t.modifyCondCount[e]);if(t.modifyRewardCount)for(var e in t.modifyRewardCount)t.modifyRewardCount.hasOwnProperty(e)&&(this.rewardCount=t.modifyRewardCount[e]);if(t.openSvrGroupBuyAward)for(var e in t.openSvrGroupBuyAward)t.openSvrGroupBuyAward.hasOwnProperty(e)&&(App.hero.welfare.openSvrGroupBuyAward[e]=t.openSvrGroupBuyAward[e])},t}(),GroupBuyActivityVo=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){this.id=t.id,this.endtime=t.endtime,this.tbActivity=t.tabvo,this.sort()},e.prototype.isCanReward=function(){if(this.isOverdue())return!1;if(this.isReceive())return!1;var t=App.hero.rechargePlayerNum>=this.tbActivity.condition[1],e=App.hero.welfare.openSvrRechargeSum>=this.tbActivity.condition[0];return t&&e},e.prototype.isReceive=function(){return App.hero.welfare.openSvrGroupBuyAward.hasOwnProperty(this.tbActivity.ID)},e.prototype.getRewardInfo=function(){return this.tbActivity.reward||[[]]},e.prototype.getDesc=function(){return this.tbActivity.desc},e.prototype.sort=function(){var t=this.isReceive(),e=App.hero.rechargePlayerNum>=this.tbActivity.condition[1],i=App.hero.welfare.openSvrRechargeSum>=this.tbActivity.condition[0],n=e&&i;this.sortNum=t?this.tbActivity.ID+1e5:n?this.tbActivity.ID:this.tbActivity.ID+1e3},e}(OperateActivityVo));__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.activity.timelimitactivity.WeekFundUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},e.prototype.onOpened=function(){i.prototype.onOpened.call(this)},e.prototype.init=function(){this.setTab(),this.onTabSelect(0),this.timeTick(),this.timerLoop(1e3,this,this.timeTick),this.btn_use.on(Laya.Event.CLICK,this,this.jump),this.btn_wenhao.on(Laya.Event.CLICK,this,this.onClickWH)},e.prototype.setTab=function(){var t=[],e=TableData.getInstance().getTableByName(TableData.tb_fund).data;for(var i in App.getOpenServerTime(),App.getServerTime(),e)t.push(e[i]);this.btnList.repeatX=5<t.length?5:t.length,this.btnList.dataSource=t,this.btnList.centerX=0,this.btnList.anchorX=.5},e.prototype.hasNoReceiveWeekFund=function(t){if(App.hero.welfare.weekFund&&-1!=App.hero.welfare.weekFund.indexOf(t))for(var e=tb.TB_fund_reward.getFundListByType(t),i=0;i<e.length;i++)if(-1==App.hero.welfare.weekFundAward.indexOf(e[i].ID))return!0;return!1},e.prototype.onTabSelect=function(t){this._selectTabNum=t,this.btnList.selectedIndex=t,this.showSelectTab()},e.prototype.onTabRender=function(t,e){t.btn_tab.selected=e==this._selectTabNum},e.prototype.showSelectTab=function(){var t=this.btnList.dataSource[this._selectTabNum],e=-1!=App.hero.welfare.weekFund.indexOf(t.ID),i=tb.TB_fund_reward.getFundListByType(t.ID);i.sort(function(t,e){return(-1==App.hero.welfare.weekFundAward.indexOf(t.ID)?t.value:t.value+1e3)-(-1==App.hero.welfare.weekFundAward.indexOf(e.ID)?e.value:e.value+1e3)}),this.list_reward.dataSource=i,this.btn_use.label="￥"+t.recharge_num,this.btn_use.visible=!e,1==t.ID?(this.img_type.skin="kaifujijin/188.png",this.lab_sw_open.visible=!1):(this.img_type.skin="kaifujijin/288.png",this.lab_sw_open.visible=!App.IsSysOpen(ModuleConst.TREASURE))},e.prototype.onClickWH=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20003))},e.prototype.jump=function(){if(this.btn_use.gray)showToast(LanMgr.getLan("",10224));else{var t=this.btnList.dataSource[this._selectTabNum],e=Number(window.platform.pid);if(n.ChongzhiModel.isRealPay(e)){var i=tb.TB_recharge.get_TB_rechargeById(t.recharge_id);n.ChongzhiModel.pay(i)}else this.test(t)}},e.prototype.test=function(t){var e=this;UIUtil.payDebug(t.recharge_id,null,function(){e.showSelectTab()})},e.prototype.timeTick=function(){var t=this.btnList.dataSource[this._selectTabNum],e=App.getOpenServerTime()+86400*t.openserver_time,i=App.getServerTime();this.lab_activity_title.x=e<=i?299:276,e<=i?(this.clearTimer(this,this.timeTick),this.btn_use.gray=!0,this.btn_use.label=LanMgr.getLan("",12554),this.box_time.visible=!1,this.lab_activity_title.text=LanMgr.getLan("",12554)):(this.btn_use.gray=!1,this.box_time.visible=!0,this.lab_activity_title.text=LanMgr.getLan("",12555),this.lab_time.text=activityTime(e,i))},e.prototype.close=function(){i.prototype.close.call(this)},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.clearTimer(this,this.timeTick),this.btn_use.off(Laya.Event.CLICK,this,this.jump),this.btn_wenhao.off(Laya.Event.CLICK,this,this.onClickWH)},e.prototype.getTimeLab=function(){var t=this.btnList.dataSource[this._selectTabNum],e=App.getOpenServerTime()+86400*t.openserver_time,i=e;return App.getServerTime()>=e?LanMgr.getLan("",10224):""+activityTime(i,App.getServerTime())},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t.btnList.selectHandler=new Handler(t,t.onTabSelect),t.btnList.renderHandler=new Handler(t,t.onTabRender),t.bgPanel.dataSource={uiName:UIConst.WeekFundView,closeOnSide:t.isModelClose,title:LanMgr.getLan("",12553)},t}n.WeekFundView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.activity.timelimitactivity.TimeLimitActivityUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},e.prototype.onOpened=function(){i.prototype.onOpened.call(this)},e.prototype.init=function(){this.img_bg.height=this.height-365,this.list_item.height=Math.min(this.height-651,781),this.setTab(this._model.getTabMap()),this.onTabSelect(0),this.btnClose.on(Laya.Event.CLICK,this,this.close),tl3d.ModuleEventManager.addEvent(o.ResEvent.PROP_CHANGE,this.onItemChange,this),tl3d.ModuleEventManager.addEvent(o.ResEvent.RESOURCE_CHANGE,this.onUpdateRes,this)},e.prototype.setTab=function(t){this.list_tab.dataSource=map2ary(t),this.list_tab.selectedIndex=0,this.list_tab.array.length},e.prototype.onUpdateRes=function(){var t=this.list_tab.dataSource[this._selectTabNum][0],e=this.list_tab.dataSource[this._selectTabNum][1].link||0;if(this.lab_has2.visible=-1!=[o.TimelimitModel.ACTIVITY_OPENBUY_ID].indexOf(t),this.box_cost.visible=!0,this.boxRes.width=471,99==t||e==iface.tb_prop.operateActivityTypeKey.exchange){var i=this._model.getTabActivity(t);i&&i[0]&&(this._xianshiItem=o.TimelimitModel.getChangeItem(i[0].tbActivity.time_index)),this._xianshiItem&&(this.imgCost.skin=SkinUtil.getExchangeConsume(this._xianshiItem.id),this.lbNum.text=App.hero.getBagItemNum(this._xianshiItem.id)+"")}else this.lbNum.text="",this.box_cost.visible=!1,this.boxRes.width=312;this.lab_zuanshi.text=Snums(App.hero.diamond),this.lab_money.text=Snums(App.hero.gold)},e.prototype.onTabSelect=function(t){this._selectTabNum!=t&&(this._selectTabNum=t,this.showSelectTab(!0))},e.prototype.onTabRender=function(t,e){t.selectBox.selected=e==this._selectTabNum},e.prototype.hideXianshi=function(){this._xianshiIR&&this._xianshiIR.parent&&(this._xianshiIR.onExit(),this._xianshiIR.removeSelf())},e.prototype.onItemChange=function(){this.list_tab.dataSource[this._selectTabNum]&&this.list_tab.dataSource[this._selectTabNum][1].link==iface.tb_prop.operateActivityTypeKey.exchange&&(this.refreshExchangeSort(),this.updateList()),this.onUpdateRes()},e.prototype.refreshExchangeSort=function(){var t=this._model.getTabActivity(this.list_tab.array[this._selectTabNum][0]);if(t)for(var e=0;e<t.length;e++)t[e].sort()},e.prototype.showSelectTab=function(t){var e=this;if(this.list_tab.array&&this.list_tab.array[this._selectTabNum]){var i=this.list_tab.dataSource[this._selectTabNum][0],n=this.list_tab.dataSource[this._selectTabNum][1].link;this.lab_time.text=this.getTimeLab(),this.imgShalou.x=this.lab_time.x-25,this.hideXianshi(),99==i&&(this._xianshiIR||(this._xianshiIR=new o.xianshiIR,this._xianshiIR.centerX=0,this._xianshiIR.y=294),this.addChildAt(this._xianshiIR,1),this._xianshiIR.onAdd(this.lab_time.text)),this.onUpdateRes(),this.box_chongzhi.visible=99!=i&&i!=o.TimelimitModel.ACTIVITY_JIJIN_ID,this.box_chongzhi.visible&&(n==iface.tb_prop.operateActivityTypeKey.exchange&&(this.refreshExchangeSort(),this.redPointStateOpt()),this.updateList(),this.img_title.skin="huoyuehuodong/timeActTitle"+n+".png",i==o.TimelimitModel.ACTIVITY_OPENBUY_ID?(this.setRechargePlayerNum(0),this.lab_info.text=LanMgr.getLan("",20020),this.updateList(),this.lab_has2.x=18):(this.lab_info.text="      "+tb.TB_activity_time.getTabInfo(i),this.lab_has2.x=54)),this.timerLoop(5e3,this,this.timeTick),t&&Laya.timer.callLater(this,function(){UIUtil.playListEff(e.list_item.cells)})}},e.prototype.redPointStateOpt=function(){var t=this._model.getTabActivity(this.list_tab.array[this._selectTabNum][0]);for(var e in t){var i=t[e];i.redopt||!i.exchangeIsComplete()||i.isOverdue()||(i.redopt=!0)}},e.prototype.setRechargePlayerNum=function(t){var i=this;this.list_tab.dataSource[this._selectTabNum][0]==o.TimelimitModel.ACTIVITY_OPENBUY_ID&&(this.lab_has2.text=LanMgr.getLan("",12556,0),PLC.request(Protocol.game_activity_getRechargePlayerNum,null,function(t,e){t&&(i.lab_has2.text=LanMgr.getLan("",12556,t.rechargePlayerNum),App.hero.rechargePlayerNum=Number(t.rechargePlayerNum))}))},e.prototype.timeTick=function(){this.lab_time.text=this.getTimeLab(),this.imgShalou.x=this.lab_time.x-25,this._xianshiIR&&this._xianshiIR.parent&&this._xianshiIR.setTime(this.lab_time.text),this.list_item.refresh()},e.prototype.updateList=function(){if(this.list_tab.array&&this.list_tab.array[this._selectTabNum]){var t=this._model.getTabActivity(this.list_tab.array[this._selectTabNum][0]);if(t[0].sortNum){this.list_item.dataSource=null;var e=t.sort(function(t,e){return t.sortNum-e.sortNum});this.list_item.dataSource=e}else this.list_item.dataSource=t}},e.prototype.close=function(){i.prototype.close.call(this),dispatchEvt(new o.HudEvent(o.HudEvent.SHOW_MODULE_VIEW,[ModuleConst.MAIN]))},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._selectTabNum=-1,this.hideXianshi(),this.btnClose.off(Laya.Event.CLICK,this,this.close),this.clearTimer(this,this.timeTick),tl3d.ModuleEventManager.removeEvent(o.ResEvent.PROP_CHANGE,this.onItemChange,this),tl3d.ModuleEventManager.removeEvent(o.ResEvent.RESOURCE_CHANGE,this.onUpdateRes,this),this._xianshiItem=null},e.prototype.getTimeLab=function(){var t="",e=this.list_tab.dataSource[this._selectTabNum][1];return App.getServerTime()>=e.endTime?App.getServerTime()>=e.rewardTime?(t=LanMgr.getLan("",12557),this.clearTimer(this,this.timeTick)):t=LanMgr.getLan("",12558,activityTime(e.rewardTime,App.getServerTime())):t=LanMgr.getLan("",12555)+activityTime(e.rewardTime,App.getServerTime()),t},e.prototype.onclick=function(t){switch(t.currentTarget){case this.btn_add_zuanshi:dispatchEvt(new o.TopUpEvent(o.TopUpEvent.SHOW_CHONGZHI_PANEL));break;case this.btn_addgold:UIMgr.showUI(UIConst.ExchangeGoldView)}},e);function e(){var t=i.call(this)||this;return t._model=o.TimelimitModel.getInstance(),t.isModelClose=!0,t.list_tab.selectHandler=new Handler(t,t.onTabSelect),t.list_tab.renderHandler=new Handler(t,t.onTabRender),t.lab_time.autoSize=!0,t.width=Laya.stage.width,t.height=Laya.stage.height,t.btn_add_zuanshi.on(Laya.Event.CLICK,t,t.onclick),t.btn_addgold.on(Laya.Event.CLICK,t,t.onclick),t}o.TimeLimitView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.activity.timelimitactivity.xianshiViewUI,__extends(n,i),n.prototype.init=function(){var t=tb.TB_operate_activity.get_TB_operate_activity("time_index",e.TimelimitModel.getInstance().xianshiTimeIdx+"");t&&0<t.length&&(this._xianshiItem=new ItemVo(t[0].defined[0][0],0),this.lab_xianshi.text=LanMgr.getLan("活动期间，领取挂机\n奖励有概率额外获得{0}。",-1,this._xianshiItem.getName()),this.item_xianshi.dataSource=this._xianshiItem)},n.prototype.onAdd=function(t){this.setTime(t)},n.prototype.onExit=function(){this.close()},n.prototype.setTime=function(t){this.lab_time1.text=t},n);function n(){var t=i.call(this)||this;return t.init(),t}e.xianshiIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.box.TabIR2UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){if(t){var e=t[1].link;99!=t[0]&&t[0]<i.TimelimitModel.ACTIVITY_JIJIN_ID?(this.btn_tab.skin=SkinUtil.getTabBtnSkin("tabicon"+e),this.redpoint.setRedPointName("timeActivity"+t[0])):(this.btn_tab.skin=SkinUtil.getTabBtnSkin("tabicon"+t[0]),t[0]>=i.TimelimitModel.ACTIVITY_JIJIN_ID&&this.redpoint.setRedPointName("timeActivity"+t[0]))}else this.redpoint.onDispose()},n.prototype.setSelect=function(t){this._isSelect!=t&&(this._isSelect=t,this.selectBox.selected=t)},n);function n(){var t=e.call(this)||this;return t._isSelect=!1,t}i.TlTabIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var e,t=(e=ui.activity.timelimitactivity.HuodongRenderUI,__extends(i,e),i.prototype.onClick=function(t){var i=this,e=t.target,n=e.dataSource;if(e.gray)return e.label==LanMgr.getLan("",12557)&&showToast(LanMgr.getLan("",10095)),e.label==LanMgr.getLan("",12603)&&(n.endtime<=App.getServerTime()?showToast(LanMgr.getLan("",10224)):n.condValue<=n.rewardCount?showToast(LanMgr.getLan("",10097)):showToast(LanMgr.getLan("",10234))),void(-1!=e.label.indexOf("￥")&&showToast(LanMgr.getLan("",10126)));if(e.label!=LanMgr.getLan("",10090))if(e.label!=LanMgr.getLan("",12603)){var o=tb.TB_operate_activity.get_TB_operate_activityById(n.id);if(e.label!=LanMgr.getLan("",12604))if(e.label!=LanMgr.getLan("",12605))if(-1==e.label.indexOf("￥")){if(n.id==s.TimelimitModel.ACTIVITY_OPENBUY_ID){var a={};return a[Protocol.game_activity_getOpenSvrGroupBuyAward.args.id]=n.tbActivity.ID,void PLC.request(Protocol.game_activity_getOpenSvrGroupBuyAward,a,function(t){t&&(n.modifyData(t),UIUtil.showRewardView(t.commonData),dispatchEvt(new s.TimelimitEvent(s.TimelimitEvent.GROUP_RED_EVENT))),n.sort(),UIMgr.getUIByName(UIConst.TimeLimitView).updateList()})}var r={};r[Protocol.game_activity_getActivityReward.args.id]=n.id,r[Protocol.game_activity_getActivityReward.args.num]=1,PLC.request(Protocol.game_activity_getActivityReward,r,function(t,e){t&&(n.modifyData(t),UIUtil.showRewardView(t.commonData),dispatchEvt(new s.TimelimitEvent(s.TimelimitEvent.RED_EVENT),o.time_index)),i.refreshData(n),UIMgr.getUIByName(UIConst.TimeLimitView).updateList()})}else this.chongzhi(n);else dispatchEvt(new s.HudEvent(s.HudEvent.SHOW_MODULE_VIEW,[ModuleConst.CHONGZHI]));else o.way_link&&(logdebug("限时活动跳转:",o.way_link),dispatchEvt(new s.HudEvent(s.HudEvent.SHOW_MODULE_VIEW,o.way_link)))}else UIMgr.showUI(UIConst.ExchangeItemView,n);else showToast(LanMgr.getLan("",10096))},i.prototype.chongzhi=function(t){var e=t.getChongZhiIndex();if(-1!=e){var i=Number(window.platform.pid);if(s.ChongzhiModel.isRealPay(i)){var n=tb.TB_recharge.get_TB_rechargeById(e);s.ChongzhiModel.pay(n)}else UIUtil.payDebug(e)}else logerror("充值id异常",e)},Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(t){if(t){if(this.img_bg1.visible=this.lab_times.visible=this.img_bg2.visible=this.ui_duihuan.visible=this.lab_title.visible=this.btn_receive.visible=!0,t.id==s.TimelimitModel.ACTIVITY_OPENBUY_ID)return void this.drawGroupRecharge(t);var e=tb.TB_operate_activity.get_TB_operate_activityById(t.id);this.lab_times.color="#fff9b7",this.lab_times.align="right",this.imgYilingqu.visible=!1,-1!=this.GoundSunKey.indexOf(e.type)?this.drawGoundSum(e,t):e.type==iface.tb_prop.operateActivityTypeKey.exchange?this.drawExchange(e,t):e.type==iface.tb_prop.operateActivityTypeKey.giftPacks?this.drawGiftPacks(e,t):e.type==iface.tb_prop.operateActivityTypeKey.singleRecharge&&this.drawSingleRecharge(e,t)}},i.prototype.drawGroupRecharge=function(t){this.ui_duihuan.visible=this.img_bg2.visible=this.img_bg1.visible=!1,this.lab_times.color="#7e5336",this.lab_times.align="center",this.lab_title.text=t.getDesc();for(var e=[],i=t.getRewardInfo(),n=0;n<i.length;n++)e.push(new ItemVo(i[n][0],i[n][1]));this.list_reward.dataSource=e,this.list_reward.x=11;var o=t.isReceive(),a=t.isOverdue(),r=t.isCanReward();this.btn_receive.dataSource=t,this.btn_receive.gray=o||a,this.btn_receive.label=o?LanMgr.getLan("",10043):r?LanMgr.getLan("",10476):a?LanMgr.getLan("",12554):LanMgr.getLan("",12605),this.imgYilingqu.visible=o,this.lab_times.visible=!o,this.btn_receive.visible=!o,this.btn_receive.skin=!o&&r?SkinUtil.buttonGreen:SkinUtil.buttonNormal,this.btn_receive.selected=this.btn_receive.gray,this.btn_receive.labelStrokeColor=!o&&r?ColorConst.GREEN_FILTER:ColorConst.ORANGE_FILTER,this.lab_times.text=LanMgr.getLan("",12606)+(App.hero.welfare.openSvrRechargeSum+"/")+t.tbActivity.condition[0],t.sort()},i.prototype.drawSingleRecharge=function(t,e){this.img_bg2.visible=this.ui_duihuan.visible=!1,this.lab_title.text=LanMgr.getLan(t.desc,-1,e.getCondValue());for(var i=[],n=e.getRewardInfo(),o=0;o<n.length;o++)i.push(new ItemVo(n[o][0],n[o][1]));this.list_reward.dataSource=i,this.list_reward.x=11;var a=e.getOtherInfo()[0][1]-e.getRewardCount();this.lab_times.text=LanMgr.getLan("",12607,a);var r=a<=0,s=e.endtime<=App.getServerTime(),u=0<e.getCondCount();this.btn_receive.dataSource=e,this.btn_receive.gray=r||s,this.btn_receive.label=r?LanMgr.getLan("",10043):u?LanMgr.getLan("",10476):s?LanMgr.getLan("",12554):LanMgr.getLan("",12604),this.imgYilingqu.visible=r,this.btn_receive.visible=!r,e.sortNum=r?1e5+e.id:u?e.id:1e3+e.id,this.btn_receive.skin=!r&&u?SkinUtil.buttonGreen:SkinUtil.buttonNormal,this.btn_receive.selected=this.btn_receive.gray,this.btn_receive.labelStrokeColor=!r&&u?ColorConst.GREEN_FILTER:ColorConst.ORANGE_FILTER},i.prototype.drawExchange=function(t,e){this.lab_title.visible=!1;for(var i=[],n=e.getRewardInfo(),o=0;o<n.length;o++)i.push(new ItemVo(n[o][0],n[o][1]));this.list_reward.dataSource=i,this.list_reward.x=160;var a=App.hero.getBagItemNum(e.getOtherInfo()[0][0]);this.ui_duihuan.dataSource=new ItemVo(e.getOtherInfo()[0][0],e.getOtherInfo()[0][1]);var r=e.getCondValue()-e.getRewardCount();this.lab_times.text=LanMgr.getLan("",12607,r),this.btn_receive.label=e.endtime<=App.getServerTime()?LanMgr.getLan("",12557):LanMgr.getLan("",12603),this.btn_receive.gray=a<e.getOtherInfo()[0][1]||r<=0||e.endtime<=App.getServerTime(),this.btn_receive.selected=this.btn_receive.gray,this.btn_receive.dataSource=e,this.btn_receive.skin=SkinUtil.buttonNormal,this.btn_receive.labelStrokeColor=ColorConst.ORANGE_FILTER},i.prototype.drawGiftPacks=function(t,e){this.lab_title.visible=this.img_bg2.visible=this.ui_duihuan.visible=!1;for(var i=[],n=e.getRewardInfo(),o=0;o<n.length;o++)i.push(new ItemVo(n[o][0],n[o][1]));var a=e.endtime<=App.getServerTime();this.list_reward.dataSource=i,this.list_reward.x=11,this.btn_receive.gray=e.getOtherInfo()[0]<=e.rewardCount||a,this.btn_receive.selected=this.btn_receive.gray,this.btn_receive.dataSource=e,this.btn_receive.label=a?LanMgr.getLan("",12557):"￥"+e.condValue,0<e.condCount?e.sortNum=e.id:this.btn_receive.gray?e.sortNum=e.id+1e5:e.sortNum=e.id+1e3,this.lab_times.text=LanMgr.getLan("",12608,e.getOtherInfo()[0]-e.rewardCount),this.btn_receive.skin=0<e.condCount?SkinUtil.buttonGreen:SkinUtil.buttonNormal,this.btn_receive.labelStrokeColor=0<e.condCount?ColorConst.GREEN_FILTER:ColorConst.ORANGE_FILTER},i.prototype.drawGoundSum=function(t,e){this.img_bg1.visible=this.lab_times.visible=this.img_bg2.visible=this.ui_duihuan.visible=!1,this.lab_title.text=LanMgr.getLan(t.desc,-1,e.condValue,e.condCount);for(var i=[],n=e.getRewardInfo(),o=0;o<n.length;o++)i.push(new ItemVo(n[o][0],n[o][1]));this.list_reward.dataSource=i,this.list_reward.x=11;var a=0!=e.rewardCount,r=e.endtime<=App.getServerTime(),s=e.condCount>=e.condValue;s&&(this.lab_title.text=LanMgr.getLan(t.desc,-1,e.condValue,e.condValue)),this.btn_receive.dataSource=e,this.btn_receive.gray=a||r,2==e.tbActivity.type||7==e.tbActivity.type||23==e.tbActivity.type?this.btn_receive.label=a?LanMgr.getLan("",10043):s?LanMgr.getLan("",10476):r?LanMgr.getLan("",12554):LanMgr.getLan("",10090):this.btn_receive.label=a?LanMgr.getLan("",10043):s?LanMgr.getLan("",10476):r?LanMgr.getLan("",12554):LanMgr.getLan("",12604),this.imgYilingqu.visible=a,this.btn_receive.visible=!a,e.sortNum=a?e.id+1e5:s?e.id:e.id+1e3,this.btn_receive.skin=!a&&s?SkinUtil.buttonGreen:SkinUtil.buttonNormal,this.btn_receive.selected=this.btn_receive.gray,this.btn_receive.labelStrokeColor=!a&&s?ColorConst.GREEN_FILTER:ColorConst.ORANGE_FILTER},i);function i(){var t=e.call(this)||this;return t.GoundSunKey=[iface.tb_prop.operateActivityTypeKey.arenaSum,iface.tb_prop.operateActivityTypeKey.dailyRecharge,iface.tb_prop.operateActivityTypeKey.dailyConsumeSum,iface.tb_prop.operateActivityTypeKey.consumeSum,iface.tb_prop.operateActivityTypeKey.goundSum,iface.tb_prop.operateActivityTypeKey.dailyCopy,iface.tb_prop.operateActivityTypeKey.expeditionMax,iface.tb_prop.operateActivityTypeKey.mineOccupyNum,iface.tb_prop.operateActivityTypeKey.escortCount,iface.tb_prop.operateActivityTypeKey.robCount,iface.tb_prop.operateActivityTypeKey.mineRobNum,iface.tb_prop.operateActivityTypeKey.guildCopy,iface.tb_prop.operateActivityTypeKey.advtDispatch,iface.tb_prop.operateActivityTypeKey.employ,iface.tb_prop.operateActivityTypeKey.door,iface.tb_prop.operateActivityTypeKey.runeCopy,iface.tb_prop.operateActivityTypeKey.worldBoss,iface.tb_prop.operateActivityTypeKey.loginSum,iface.tb_prop.operateActivityTypeKey.rechargeSum,iface.tb_prop.operateActivityTypeKey.dailyRechargeSum],t.btn_receive.on(Laya.Event.CLICK,t,t.onClick),t}s.TlInfoIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.TabIR1UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){t?(this.redpoint.setRedPointName("FundActivity"+t.ID),this.btn_tab.label=t.recharge_num+LanMgr.getLan("",12609)):this.redpoint.onDispose()},n);function n(){return e.call(this)||this}t.FundTabIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.timelimitactivity.JiJinIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){if(t){this.visible=!0,this.itemList.dataSource=ary2prop(t.reward),this.lbday.text=LanMgr.getLan("",12610,t.value);var e=0;-1!=App.hero.welfare.weekFundAward.indexOf(t.ID)?(e=2,this.btn_receive.visible=!1,this.img_hasreceive.visible=!0):(App.getServerTime()>App.getOpenServerTime()+86400*(t.value-1)?(e=1,this.btn_receive.label=LanMgr.getLan("",10476),this.btn_receive.gray=!1):(e=0,this.btn_receive.label=LanMgr.getLan("",10090),this.btn_receive.gray=!0),this.btn_receive.visible=!0,this.img_hasreceive.visible=!1),this.btn_receive.on(Laya.Event.CLICK,this,this.onClickReceive,[e]),this.img_hasreceive.on(Laya.Event.CLICK,this,this.onClickReceive,[e])}else this.visible=!1,this.btn_receive.off(Laya.Event.CLICK,this,this.onClickReceive),this.img_hasreceive.off(Laya.Event.CLICK,this,this.onClickReceive)},n.prototype.onClickReceive=function(t){var i=this;if(1==t){if(-1==App.hero.welfare.weekFund.indexOf(this._dataSource.type))return void showToast(LanMgr.getLan("",10235));var e={};e[Protocol.game_welfare_getWeekFundAward.args.id]=this._dataSource.ID,PLC.request(Protocol.game_welfare_getWeekFundAward,e,function(t,e){t&&(UIUtil.showRewardView(t.commonData),i.refreshData(i._dataSource))})}else showToast(0==t?LanMgr.getLan("",10236):LanMgr.getLan("",10220))},n);function n(){return e.call(this)||this}t.FundRewardIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var n,t=(n=ui.activity.timelimitactivity.ExchangeItemUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={uiName:UIConst.ExchangeItemView,closeOnSide:this.isModelClose,title:LanMgr.getLan("",12559)},this._counterBar=new common.CounterBar,this._counterBar.setComponent(this.btn_add,this.btn_addTen,this.btn_red,this.btn_redTen,this.are_putin),this.btn_buy.on(Laya.Event.CLICK,this,this.buy)},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.init()},e.prototype.show=function(t,e){n.prototype.popup.call(this,t,e),this.init()},e.prototype.onClosed=function(t){n.prototype.onClosed.call(this,t)},e.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this),Laya.timer.clearAll(this),this._exchangeData=null,tl3d.ModuleEventManager.removeEvent(o.ResEvent.PROP_CHANGE,this.updateView,this)},e.prototype.init=function(){this._exchangeData=this.dataSource,this.img_type2.visible=this.lab_sum.visible=this.img_bg.visible=1==this._exchangeData.getOtherInfoLen();var t=this._exchangeData.getRewardInfo();if(1==this._exchangeData.getOtherInfoLen()){var e=this._exchangeData.getOtherInfo()[0];this.img_type2.skin=SkinUtil.getExchangeConsume(e[0])}this.lab_rouyu.text=LanMgr.getLan("",12177)+App.hero.getBagItemNum(t[0][0]);var i=new ItemVo(t[0][0],t[0][1]);this.itembox.dataSource=i,this.lab_name.text=i.getName(),tl3d.ModuleEventManager.addEvent(o.ResEvent.PROP_CHANGE,this.updateView,this),this.updateView()},e.prototype.updateView=function(){this._buymaxnum=this._exchangeData.getChangeNum();var t=this._exchangeData.condValue-this._exchangeData.rewardCount;this._buyNum=1,this._counterBar.setInitData(this._buyNum,Math.min(this._buymaxnum,t),this.setBuySumMoney.bind(this)),this.lab_overplus.text=LanMgr.getLan("",12602,t),this.setBuySumMoney()},e.prototype.setBuySumMoney=function(){if(this._buyNum=this._counterBar.getCurNum(),this.are_putin.text=this._buyNum.toString(),1==this._exchangeData.getOtherInfoLen()){var t=this._exchangeData.getOtherInfo()[0];this._buysumMoney=this._buyNum*t[1];var e=App.hero.getBagItemNum(t[0]);this.lab_sum.text=Snums(e)+"/"+Snums(this._buysumMoney)}},e.prototype.buy=function(){var n=this;if(0!=this._exchangeData.getChangeNum())if(this._exchangeData.endtime<=App.getServerTime())showToast(LanMgr.getLan("",10224));else if(this._exchangeData.condValue<=this._exchangeData.rewardCount)showToast(LanMgr.getLan("",10097));else{var t={};t[Protocol.game_activity_getActivityReward.args.id]=this._exchangeData.id,t[Protocol.game_activity_getActivityReward.args.num]=this._buyNum,PLC.request(Protocol.game_activity_getActivityReward,t,function(t,e){if(t){n._exchangeData.modifyData(t),n._exchangeData.sort(),UIUtil.showRewardView(t.commonData);var i=tb.TB_operate_activity.get_TB_operate_activityById(n._exchangeData.id);dispatchEvt(new o.TimelimitEvent(o.TimelimitEvent.RED_EVENT),i.time_index)}UIMgr.hasStage(UIConst.TimeLimitView)&&UIMgr.getUIByName(UIConst.TimeLimitView).updateList(),n.close()})}else showToast(LanMgr.getLan("",10234))},e);function e(){var t=n.call(this)||this;return t._buyNum=1,t._buymaxnum=0,t._buysumMoney=0,t}o.ExchangeItemView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=tl3d.Processor,__extends(n,i),n.prototype.getName=function(){return"TimelimitProcessor"},n.prototype.listenModuleEvents=function(){return[new e.TimelimitEvent(e.TimelimitEvent.SHOW_TIMELIMIT_ACTIVITY),new e.TimelimitEvent(e.TimelimitEvent.GET_TAB_EVENT),new e.TimelimitEvent(e.TimelimitEvent.SELECTED_TAB_DATA_EVENT),new e.TimelimitEvent(e.TimelimitEvent.RED_EVENT),new e.TimelimitEvent(e.TimelimitEvent.GROUP_RED_EVENT),new e.TimelimitEvent(e.TimelimitEvent.FUND_EVENT),new e.TimelimitEvent(e.TimelimitEvent.FUND_RED_EVENT)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.TimelimitEvent)switch(t.type){case e.TimelimitEvent.SHOW_TIMELIMIT_ACTIVITY:this.showUi();break;case e.TimelimitEvent.GET_TAB_EVENT:this.getTabEvent(t.data);break;case e.TimelimitEvent.SELECTED_TAB_DATA_EVENT:case e.TimelimitEvent.RED_EVENT:case e.TimelimitEvent.GROUP_RED_EVENT:this.selectedTabData();break;case e.TimelimitEvent.FUND_EVENT:case e.TimelimitEvent.FUND_RED_EVENT:this.refreshFund()}},n.prototype.showUi=function(){this._model.clearActicity(),this._model.hasActivity()?UIMgr.showUI(UIConst.TimeLimitView):showToast(LanMgr.getLan("",10125))},n.prototype.selectedTabData=function(){this.timelimitactivityview&&this.timelimitactivityview.showSelectTab(!1)},n.prototype.refreshFund=function(){this.weekFundView&&this.weekFundView.showSelectTab()},n.prototype.getTabEvent=function(t){this.timelimitactivityview&&this.timelimitactivityview.setTab(t)},Object.defineProperty(n.prototype,"timelimitactivityview",{get:function(){return UIMgr.getUIByName(UIConst.TimeLimitView)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"weekFundView",{get:function(){return UIMgr.getUIByName(UIConst.WeekFundView)},enumerable:!0,configurable:!0}),n);function n(){var t=i.call(this)||this;return t._model=e.TimelimitModel.getInstance(),t}e.TimelimitProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"TimelimitModule"},n.prototype.listProcessors=function(){return[new t.TimelimitProcessor]},n.prototype.onRegister=function(){t.TimelimitModel.getInstance().getActicity()},n);function n(){return e.call(this)||this}t.TimelimitModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_TIMELIMIT_ACTIVITY="SHOW_TIMELIMIT_ACTIVITY",r.GET_TAB_EVENT="GET_TAB_EVENT",r.SELECTED_TAB_DATA_EVENT="SELECTED_TAB_DATA_EVENT",r.RED_EVENT="RED_EVENT",r.GROUP_RED_EVENT="GROUP_RED_EVENT",r.FUND_EVENT="FUND_EVENT",r.FUND_RED_EVENT="FUND_RED_EVENT",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.TimelimitEvent=a}(game=game||{}),function(g){var t=(y.getInstance=function(){return y._instance||(y._instance=new y),y._instance},y.prototype.clearActicity=function(){if(!isEmptyObject(this._tabMap))for(var t in this._tabMap)if(this._tabMap.hasOwnProperty(t)){var e=this._tabMap[t];e.rewardTime<=App.getServerTime()&&(e.id==y.ACTIVITY_JIJIN_ID&&this.hasNoReceiveWeekFund()||delete this._tabMap[t])}},y.prototype.getTabMap=function(){return this._tabMap},y.prototype.refreshActivity=function(){this._tabMap=null,this.getActicity()},y.prototype.getActicity=function(){var f=this;isEmptyObject(this._tabMap)?(this._tabMap={},this._acticityMap={},PLC.request(Protocol.game_activity_getActivityList,{},function(t){if(t){for(var e=0;e<t.activityList.length;e++){var i=t.activityList[e],n=i.id,o=tb.TB_operate_activity.getLinkByIdx(n);if(-1!=o&&(i.link=o,f._tabMap[n]=i,o==iface.tb_prop.operateActivityTypeKey.exchange)){var a={endTime:i.endTime,id:99,rewardTime:i.endTime,startTime:i.startTime,link:o};f._tabMap[a.id]=a,f.xianshiTimeIdx=n}}for(var r=t.activityAllInfo,s=0;s<r.length;s++)if((d=new OperateActivityVo).setData(r[s]),d&&d.tbActivity){var u=d.tbActivity.time_index;f._tabMap[u]&&(d.endtime=f._tabMap[u].rewardTime,f._acticityMap[u]||(f._acticityMap[u]=[]),f._acticityMap[u].push(d),d.isCanReward()&&!d.isOverdue()&&dispatchEvt(new g.TimelimitEvent(g.TimelimitEvent.RED_EVENT),u))}}var h=tb.TB_activity_set.getTabSet().group_buy_time,l=App.hero.openSvrTime+h;if(l>App.getServerTime()){a={endTime:l,id:y.ACTIVITY_OPENBUY_ID,rewardTime:l,startTime:App.hero.openSvrTime},f._tabMap[a.id]=a,f._tabMap[a.id].link=y.ACTIVITY_OPENBUY_ID,f._acticityMap[a.id]||(f._acticityMap[a.id]=[]),tb.TB_group_buy.get_TB_group_buy();var c=TableData.getInstance().getTableByName(TableData.tb_group_buy);for(var p in c.data){var d,_=c.data[p];(d=new GroupBuyActivityVo).setData({id:y.ACTIVITY_OPENBUY_ID,endtime:l,tabvo:_}),f._acticityMap[a.id].push(d)}dispatchEvt(new g.TimelimitEvent(g.TimelimitEvent.GROUP_RED_EVENT))}dispatchEvt(new g.TimelimitEvent(g.TimelimitEvent.GET_TAB_EVENT),f._tabMap)})):dispatchEvt(new g.TimelimitEvent(g.TimelimitEvent.GET_TAB_EVENT),this._tabMap)},y.prototype.canGroupBuyRedPoint=function(){for(var t=this._acticityMap[y.ACTIVITY_OPENBUY_ID],e=0;t&&e<t.length;e++)if(t[e].isCanReward())return!0;return!1},y.getChangeItem=function(t){var e=tb.TB_operate_activity.getChangeTemplate("time_index",String(t));return e?new ItemVo(e.defined[0][0],0):null},y.prototype.hasNoReceiveWeekFund=function(){if(App.hero.welfare.weekFund&&0<App.hero.welfare.weekFund.length)for(var t=0;t<App.hero.welfare.weekFund.length;t++)for(var e=App.hero.welfare.weekFund[t],i=tb.TB_fund_reward.getFundListByType(e),n=0;n<i.length;n++)if(-1==App.hero.welfare.weekFundAward.indexOf(i[n].ID))return!0;return!1},y.prototype.isShowWeekFundActivity=function(){var t=App.getServerTime();return tb.TB_fund.fundStartTime()<=t&&(t<=tb.TB_fund.fundEndTime()||this.hasNoReceiveWeekFund())},y.prototype.updateData=function(t){if(t)for(var e in t){var i=Number(e),n=tb.TB_operate_activity.get_TB_operate_activityById(i);if(this._acticityMap.hasOwnProperty(n.time_index))for(var o=this._acticityMap[n.time_index],a=0;a<o.length;a++){var r=o[a];if(r.id==i){r.setCondCount(Number(t[e])),r.isCanReward()&&!r.isOverdue()&&dispatchEvt(new g.TimelimitEvent(g.TimelimitEvent.RED_EVENT),n.time_index);break}}}},y.prototype.canRedPoint=function(t){return!(isEmptyObject(this._acticityMap)||!this._acticityMap.hasOwnProperty(t))&&this._acticityMap[t].some(function(t){return t.isCanReward()&&!t.isOverdue()})},y.prototype.getActivityVoById=function(t){for(var e in this._acticityMap){var i=this._acticityMap[e];if(i)for(var n=0;n<i.length;n++){var o=i[n];if(o.id==t)return o}}return null},y.prototype.hasActivity=function(){return!isEmptyObject(this._tabMap)},y.prototype.getTabActivity=function(t){return this._acticityMap[t]},y.prototype.refreshActivityByTab=function(t){var n=this,e=this.getActivityIdByProp(t),i={};i[Protocol.game_activity_updateActivityCondCount.args.id]=e,PLC.request(Protocol.game_activity_updateActivityCondCount,i,function(t){if(t){for(var e in t.modifyCondInfo)(i=n.getActivityVoById(Number(e)))&&(i.setCondCount(t.modifyCondInfo[e]),dispatchEvt(new g.TimelimitEvent(g.TimelimitEvent.RED_EVENT),i.tbActivity.time_index));for(var e in t.modifyRewardCount){var i;(i=n.getActivityVoById(Number(e)))&&(i.setRewardCount(t.modifyRewardCount[e]),dispatchEvt(new g.TimelimitEvent(g.TimelimitEvent.RED_EVENT),i.tbActivity.time_index))}}})},y.prototype.getActivityIdByProp=function(t){return this._propMap||(this._propMap={},this._propMap[iface.tb_prop.redPointTypeKey.rechargeSum]=iface.tb_prop.operateActivityTypeKey.rechargeSum,this._propMap[iface.tb_prop.redPointTypeKey.consumeSum]=iface.tb_prop.operateActivityTypeKey.consumeSum,this._propMap[iface.tb_prop.redPointTypeKey.singleRecharge]=iface.tb_prop.operateActivityTypeKey.singleRecharge,this._propMap[iface.tb_prop.redPointTypeKey.dailyRecharge]=iface.tb_prop.operateActivityTypeKey.dailyRecharge,this._propMap[iface.tb_prop.redPointTypeKey.giftPacks]=iface.tb_prop.operateActivityTypeKey.giftPacks,this._propMap[iface.tb_prop.redPointTypeKey.exchange]=iface.tb_prop.operateActivityTypeKey.exchange,this._propMap[iface.tb_prop.redPointTypeKey.loginSum]=iface.tb_prop.operateActivityTypeKey.loginSum,this._propMap[iface.tb_prop.redPointTypeKey.dailyRechargeSum]=iface.tb_prop.operateActivityTypeKey.dailyRechargeSum),this._propMap[t]},y.ACTIVITY_JIJIN_ID=1e4,y.ACTIVITY_OPENBUY_ID=10001,y);function y(){this.xianshiTimeIdx=0}g.TimelimitModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.activity.testrebate.TestRebateUI,__extends(e,n),e.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.btnClose.on(Laya.Event.CLICK,this,this.close),this.btnLingqu.on(Laya.Event.CLICK,this,this.onReward)},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){n.prototype.onClosed.call(this)},e.prototype.initView=function(){var t=tb.TB_recharge_rebate.getTBItemById(App.hero.accountName),e=t?t.recharge_total:0;this.lbRecharge.text=LanMgr.getLan("",12611,e),this.lbRebate.text=LanMgr.getLan("",12612,20*e);var i=0<App.hero.welfare.rechargeRebate;this.imgYilingqu.visible=i,this.btnLingqu.visible=!i},e.prototype.onReward=function(){var e=this;i.HuodongModel.getInstance().canRewardTestRebate()?PLC.request(Protocol.game_welfare_getRechargeRebate,null,function(t){t&&(App.hero.welfare.rechargeRebate=t.rechargeRebate,UIUtil.showRewardView(t.commonData),e.initView(),dispatchEvt(new i.HuodongEvent(i.HuodongEvent.TEST_REBATE_RP)),dispatchEvt(new i.HudEvent(i.HudEvent.UPDATE_MAINVIEW_BUTTON)))}):showToast(LanMgr.getLan("",10233))},e);function e(){var t=n.call(this)||this;return t.isModelClose=!0,t}i.TestRebateView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.activity.supervip.SuperVipUI,__extends(o,n),o.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12613)}},o.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},o.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.btnReward.off(Laya.Event.CLICK,this,this.onReward),this.imgReward.off(Laya.Event.CLICK,this,this.onShow),tl3d.ModuleEventManager.removeEvent(i.ResEvent.VIP_LEVEL_CHANGE,this.updateView,this)},o.prototype.initView=function(){tl3d.ModuleEventManager.addEvent(i.ResEvent.VIP_LEVEL_CHANGE,this.updateView,this),this.updateView(),this.btnReward.on(Laya.Event.CLICK,this,this.onReward),this.imgReward.on(Laya.Event.CLICK,this,this.onShow)},o.prototype.updateView=function(){this.lbTitle1.text=LanMgr.getLan("",12614,o.dayValue),this.lbValue1.text=App.hero.welfare.dailyRechargeSum+"/"+o.dayValue,this.lbTitle2.text=LanMgr.getLan("",12615,o.allValue),this.lbValue2.text=App.hero.welfare.rechargeSum+"/"+o.allValue;var t=1==App.hero.welfare.superVip;this.lbQQ.text=t?o.QQ:"*********";var e=1==App.hero.welfare.superVipAward;this.btnReward.disabled=!t||e,this.btnReward.label=t?e?LanMgr.getLan("",10043):LanMgr.getLan("",10476):LanMgr.getLan("",10090)},o.prototype.onReward=function(){var e=this;PLC.request(Protocol.game_welfare_getSuperVipAward,null,function(t){t&&(UIUtil.showRewardView(t.commonData),App.hero.welfare.superVipAward=t.superVipAward,e.updateView(),dispatchEvt(new i.HuodongEvent(i.HuodongEvent.SUPER_VIP_RP)))})},o.prototype.onShow=function(){UIMgr.showUI(UIConst.ManyItemsTip,{data:tb.TB_activity_set.getTabSet().getVipGiftList()})},o.QQ="3048553263",o.dayValue=2e3,o.allValue=1e4,o);function o(){return n.call(this)||this}i.SuperVipView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=ui.activity.share.mainIRUI,__extends(i,e),i.prototype.onRecive=function(){this.btn_recive.gray?showToast(this.btn_recive.label):dispatchEvt(new o.ShareEvent(o.ShareEvent.SEND_RECIVE_REWARD),{id:this._dataSource.id,tabid:this._dataSource.tab.ID})},Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(t){if(t){var e=1==t.tab.type?o.ShareModel.todayNum():o.ShareModel.totalNum(),i=e>=t.tab.share_num;this.list_reward.array=ary2prop(t.tab.reward);var n=FormatStr(t.tab.desc,[t.tab.share_num,e]).split("(");this.lab_title.text=n[0],this.lbProgress.text="("+n[1],this.lbProgress.color=i?"#40fe00":"#f76768",this.btn_recive.skin=i&&!t.recive?SkinUtil.buttonGreen:SkinUtil.buttonNormal,this.btn_recive.labelStrokeColor=i&&!t.recive?ColorConst.GREEN_FILTER:ColorConst.ORANGE_FILTER,this.btn_recive.label=t.recive?LanMgr.getLan("",10043):i?LanMgr.getLan("",10476):LanMgr.getLan("",11009),this.btn_recive.gray=!i||t.recive,this.btn_recive.selected=this.btn_recive.gray,this.redpoint.setRedPointName("shareActivity"+t.tab.ID)}else this.list_reward.array=[],this.lab_title.text="",this.btn_recive.skin=null,this.redpoint.onDispose()},i);function i(){var t=e.call(this)||this;return t.btn_recive.on(Laya.Event.CLICK,t,t.onRecive),t}o.ShareMainIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.activity.share.mainPageUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},e.prototype.init=function(){this.bgPanel.dataSource={uiName:UIConst.MainShare,closeOnSide:this.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12616)},this.btn_invite.on(Laya.Event.CLICK,this,this.onInvite),this.list_item.array=n.ShareModel.getInstance().getItemList(),this.cdLoop()},e.prototype.cdLoop=function(){var t=App.getServerTime()-n.ShareModel.shareTime;this._canOpt=t>=this._sharecd,t<this._sharecd&&(this.onCdChange(),this.lab_cd.timerLoop(1e3,this,this.onCdChange))},e.prototype.onCdChange=function(){var t=App.getServerTime()-n.ShareModel.shareTime;t>this._sharecd?(this._canOpt=!0,this.lab_cd.clearTimer(this,this.onCdChange),this.lab_cd.text=""):this.lab_cd.text="CD:"+Math.floor(this._sharecd-t)},e.prototype.onInvite=function(){var e=this;this._canOpt?Number(window.platform.pid)==iface.tb_prop.platformTypeKey.changyu?BingoSDK.share(LanMgr.getLan("",12617),LanMgr.getLan("",12618),"https://h5.binnet/test/bingo.jpg",function(t){0==t.code?e.requestReward():showToast(-1==t.code?LanMgr.getLan("",10231):LanMgr.getLan("",10232,t.message,t.showMessage))}):this.requestReward():showToast(LanMgr.getLan("",11008))},e.prototype.requestReward=function(){var i=this;n.ShareModel.shareTime=App.getServerTime(),this._canOpt=!1,this.onCdChange(),this.lab_cd.timerLoop(1e3,this,this.onCdChange),PLC.request(Protocol.game_activity_shareSucc,null,function(t,e){t&&(App.hero.welfare.shareNumTotal=t.shareNumTotal,App.hero.welfare.shareNumToday=t.shareNumToday,i.list_item.refresh(),dispatchEvt(new n.ShareEvent(n.ShareEvent.RED_POINT_CHANGE)))})},e.prototype.updateItem=function(t){var e=this.list_item.array[t];t==e.id&&(e.recive=n.ShareModel.receiveState(e.tab.ID),this.list_item.setItem(t,e))},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btn_invite.off(Laya.Event.CLICK,this,this.onInvite),this.lab_cd.clearTimer(this,this.onCdChange),this.lab_cd.text="",this.list_item.array=[],this.bgPanel.dataSource=null},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t._sharecd=tb.TB_activity_set.getTabSet().share_cd,t}n.ShareMainPage=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.activity.share.firstPageUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},e.prototype.init=function(){this._clickflag=!0;var t=tb.TB_activity_set.getTabSet();this.btn_recive.on(Laya.Event.CLICK,this,this.onRecive),this.list_reward.dataSource=ary2prop(t.share_rewrad),listAtCenter(this.list_reward,86,this.list_reward.repeatX,this.list_reward.dataSource.length),this.refreshState()},e.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.uiScene||(this.uiScene=new Base2dSceneLayer,this.addChild(this.uiScene)),this.uiScene.onShow();var t=tb.TB_god.get_TB_godById(tb.TB_activity_set.getTabSet().model);this.uiScene.addModelChar(String(t.model),520,680,180,2.3)},e.prototype.refreshState=function(){var t=1==n.ShareModel.totalNum(),e=n.ShareModel.isReceiveFirst(),i=t&&!e;this.btn_recive.skin=i?SkinUtil.buttonGreen:SkinUtil.buttonNormal,this.btn_recive.labelStrokeColor=i?ColorConst.GREEN_FILTER:ColorConst.ORANGE_FILTER,this.btn_recive.label=e?LanMgr.getLan("",10043):t?LanMgr.getLan("",10476):LanMgr.getLan("",12619),this.btn_recive.gray=e,this.btn_recive.selected=this.btn_recive.gray},e.prototype.onRecive=function(){var i=this;if(this._clickflag){this._clickflag=!1;var t=1==n.ShareModel.totalNum(),e=n.ShareModel.isReceiveFirst();t&&!e?PLC.request(Protocol.game_activity_getFirstShareAward,null,function(t,e){i._clickflag=!0,t&&(App.hero.welfare.doneShares=t.doneShares,i.refreshState(),UIUtil.showRewardView(t.commonData),dispatchEvt(new n.ShareEvent(n.ShareEvent.RED_POINT_CHANGE)))}):t?this._clickflag=!0:Number(window.platform.pid)==iface.tb_prop.platformTypeKey.changyu?BingoSDK.share(LanMgr.getLan("",12617),LanMgr.getLan("",12618),"https://h5.binnet/test/bingo.jpg",function(t){0==t.code?i.requestReward():(i._clickflag=!0,showToast(-1==t.code?LanMgr.getLan("",10231):LanMgr.getLan("",10232,t.message,t.showMessage)))}):this.requestReward()}},e.prototype.requestReward=function(){var i=this;PLC.request(Protocol.game_activity_shareSucc,null,function(t,e){i._clickflag=!0,t&&(App.hero.welfare.shareNumTotal=t.shareNumTotal,App.hero.welfare.shareNumToday=t.shareNumToday,n.ShareModel.shareTime=App.getServerTime(),i.refreshState(),dispatchEvt(new n.ShareEvent(n.ShareEvent.RED_POINT_CHANGE)))})},e.prototype.close=function(){i.prototype.close.call(this),this.uiScene&&(this.uiScene.onExit(),this.uiScene=null)},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btn_recive.off(Laya.Event.CLICK,this,this.onRecive)},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t}n.FirstPage=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"ShareProcessor"},i.prototype.listenModuleEvents=function(){return[new o.ShareEvent(o.ShareEvent.SEND_RECIVE_REWARD)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof o.ShareEvent)switch(t.type){case o.ShareEvent.SEND_RECIVE_REWARD:this.sendrecivereward(t.data)}},i.prototype.sendrecivereward=function(i){var n=this,t={};t[Protocol.game_activity_getShareAward.args.id]=i.tabid,PLC.request(Protocol.game_activity_getShareAward,t,function(t,e){t&&(App.hero.welfare.doneShares=t.doneShares,UIUtil.showRewardView(t.commonData),dispatchEvt(new o.ShareEvent(o.ShareEvent.RED_POINT_CHANGE)),n.viewHasStage&&n.view.updateItem(i.id))})},Object.defineProperty(i.prototype,"view",{get:function(){return UIMgr.getUIByName(UIConst.MainShare)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewHasStage",{get:function(){return UIMgr.hasStage(UIConst.MainShare)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=o.ShareModel.getInstance(),t}o.ShareProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"ShareModule"},n.prototype.listProcessors=function(){return[new t.ShareProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.ShareModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SEND_RECIVE_REWARD="SEND_RECIVE_REWARD",r.RED_POINT_CHANGE="RED_POINT_CHANGE",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.ShareEvent=a}(game=game||{}),function(o){var t=(a.getInstance=function(){return a._instance||(a._instance=new a),a._instance},a.totalNum=function(){return App.hero.welfare.hasOwnProperty("shareNumTotal")?App.hero.welfare.shareNumTotal:(logerror("share data error!(1)"),0)},a.todayNum=function(){return App.hero.welfare.hasOwnProperty("shareNumToday")?App.hero.welfare.shareNumToday:(logerror("share data error!(2)"),0)},a.isReceiveFirst=function(){return App.hero.welfare.hasOwnProperty("doneShares")?-1!=App.hero.welfare.doneShares.indexOf(0):(logerror("share data error!(3)"),!1)},a.prototype.getItemList=function(){for(var t=tb.TB_share.getTB_share(),e=new Array,i=0;i<t.length;i++){var n=new o.ShareItemVo;n.tab=t[i],n.id=i,n.recive=a.receiveState(n.tab.ID),e.push(n)}return e},a.receiveState=function(t){var e=[];return App.hero.welfare.hasOwnProperty("doneShares")&&(e=App.hero.welfare.doneShares),-1!=e.indexOf(t)},a.redPointVisiable=function(t){var e=this.todayNum(),i=this.totalNum();if(0==t)return 1==i&&!this.isReceiveFirst();var n=tb.TB_share.getTB_shareById(t),o=1==n.type?e:i;return n.share_num<=o&&!this.receiveState(n.ID)},a.shareTime=0,a);function a(){}o.ShareModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var i,t=(i=ui.activity.sevendays.sevendaysUI,__extends(e,i),e.prototype.popup=function(){i.prototype.popup.call(this);var t,e=o.SevendaysModel.getInstance();this.list_days.selectedIndex=-1,2==tb.TB_sevendays_times.getActivityOpenId()?(t=JSON.parse(JSON.stringify(e.arr2Days)),this.btn_sevenDay.skin="huodong/qingdian714/14tian.png",this.img_ani.skin="huodong/qingdian714/14tian.png"):(t=JSON.parse(JSON.stringify(e.arrDays)),this.btn_sevenDay.skin="huodong/qingdian714/haidisi.png",this.img_ani.skin="huodong/qingdian714/haidisi.png"),this.btn_sevenDay.dataSource=t.pop(),this.list_days.dataSource=t,this.playEff(),Laya.timer.loop(3500,this,this.playEff),this.init()},e.prototype.playEff=function(){this.ani1.play(0,!1),this.startAnim()},e.prototype.init=function(){this._curOpenId=tb.TB_sevendays_times.getActivityOpenId(),this.img_title.skin=1==this._curOpenId?"huodong/qingdian714/qirikuanghuan.png":"huodong/qingdian714/banyueqingdian.png";var t=Math.floor((App.serverTime-App.hero.getCreateDayTiem())/TimeConst.ONE_DAY_MILSEC)+1,e=tb.TB_sevendays_times.getIdx(t);this.selectDaysNum=-1!=e?e:0,6!=this.selectDaysNum&&(this.list_days.selectedIndex=this.selectDaysNum),this.initView(this.selectDaysNum),this.refreshProgressBar(),this.list_days.refresh()},e.prototype.initView=function(t){var e=o.SevendaysModel.getInstance();this.list_today.dataSource=e.getArrProJect(t),this.lab_finish.text=e.getFinishTaskNum()+"个",this.dataSource=e.arrSevendaysTb[t],e.UpdateSevendayByday(t,this.selectTodayNum),this.list_item.dataSource=this.dataSource[this.selectTodayNum],this.onListTodaysSelect(this.selectTodayNum),Laya.timer.clear(this,this.setEndTime),Laya.timer.loop(1e3,this,this.setEndTime)},e.prototype.setEndTime=function(){var t=o.SevendaysModel.getInstance();this.lab_endTime.text=LanMgr.getLan("",12172,t.getRemainingTime());var e=tb.TB_sevendays_times.getActivityOpenId();this._curOpenId!=e&&(-1!=e&&(t.initArr(),this.init(),this.initExtList()),dispatchEvt(new o.SevendaysEvent(o.SevendaysEvent.SEVENDAYS_RED_EVENT)))},e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.initExtList()},e.prototype.initExtList=function(){this._boxItems||(this._boxItems=[]);for(var t=o.SevendaysModel.getInstance().getSevendaysExtList(),e=t.length,i=0;i<e;i++)if(this._boxItems[i])this._boxItems[i].dataSource=t[i];else{var n=new o.TaskBaoxiangIR;n.dataSource=t[i],n.x=565/e*(i+1)-40,n.y-=30,n.scale(.8,.8),this.boxLiveness.addChild(n),this._boxItems.push(n)}},e.prototype.startAnim=function(){for(var t=0,e=this._boxItems;t<e.length;t++)e[t].startAni()},e.prototype.refreshProgressBar=function(){var t=o.SevendaysModel.getInstance(),e=t.getSevendaysExtList()[t.getSevendaysExtList().length-1];this.progressBar.value=t.getFinishTaskNum()/e.tbReward.need_num},e.prototype.refreshLiveness=function(){for(var t=0,e=this._boxItems;t<e.length;t++)e[t].refreshView();this.refreshProgressBar()},e.prototype.onClick=function(){6!=this.selectDaysNum&&(this.list_days.cells[this.selectDaysNum].btn_tab.selected=!1,this.list_days.selection=null,this.selectDaysNum=6,this.initView(6))},e.prototype.onListDaysSelect=function(t){-1!=t&&(this.selectDaysNum=t,this.initView(this.selectDaysNum))},e.prototype.onListDaysRender=function(t,e){t.btn_tab.selected=e!=this.selectDaysNum},e.prototype.onListTodaysSelect=function(t){if(-1!=t&&(this.selectTodayNum=t,this.list_item.dataSource=this.dataSource[this.selectTodayNum],3==t)){var e=this.list_today.getCell(t);e.refreshData(this.list_today.array[t]),o.RedPointManager.removeRule(e.redpoint.redpointName),e.redpoint.visible=!1,e.redpoint.onDispose()}},e.prototype.onListTodaysRender=function(t,e){t.btn_tab.selected=e==this.selectTodayNum},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),Laya.timer.clearAll(this),this.ani1.stop()},e);function e(){var t=i.call(this)||this;return t.selectTodayNum=0,t.selectDaysNum=0,t.list_today.selectHandler=new Handler(t,t.onListTodaysSelect),t.list_today.renderHandler=new Handler(t,t.onListTodaysRender),t.list_days.selectHandler=new Handler(t,t.onListDaysSelect),t.list_days.renderHandler=new Handler(t,t.onListDaysRender),t.btn_sevenDay.on(Laya.Event.CLICK,t,t.onClick),t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.SevendaysView,closeOnSide:t.isModelClose,closeOnButton:!0},t.bgPanel.addChildAt(t.img_bg,3),t}o.SevendaysView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"sevendaysProcessor"},i.prototype.listenModuleEvents=function(){return[new n.SevendaysEvent(n.SevendaysEvent.UPDATE_SEVENDAYS_PANEL),new n.SevendaysEvent(n.SevendaysEvent.DRAW_SEVENDAYS_REWARD),new n.SevendaysEvent(n.SevendaysEvent.SHOW_SEVENDAYS_PANEL),new n.SevendaysEvent(n.SevendaysEvent.SEVENDAYS_RED_EVENT)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof n.SevendaysEvent)switch(t.type){case n.SevendaysEvent.UPDATE_SEVENDAYS_PANEL:this.SevendaysView.refreshLiveness();var e=this.SevendaysView.selectDaysNum,i=this.SevendaysView.selectTodayNum;n.SevendaysModel.getInstance().UpdateSevendayByday(e,i),this.SevendaysView.initView(e);break;case n.SevendaysEvent.DRAW_SEVENDAYS_REWARD:this.drawReward(t.data);break;case n.SevendaysEvent.SHOW_SEVENDAYS_PANEL:UIMgr.showUI(UIConst.SevendaysView)}},i.prototype.drawReward=function(t){var e=this;if(!t.isReward()&&t.isFinish()){var i={};i[Protocol.game_activity_getSevenDayExtraReward.args.id]=t.tbReward.ID,PLC.request(Protocol.game_activity_getSevenDayExtraReward,i,function(t){t&&(UIUtil.showRewardView(t.commonData),e.SevendaysView.refreshLiveness(),dispatchEvt(new n.SevendaysEvent(n.SevendaysEvent.SEVENDAYS_RED_EVENT)))})}},Object.defineProperty(i.prototype,"SevendaysView",{get:function(){return UIMgr.getUIByName(UIConst.SevendaysView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}n.SevendaysProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"SevendaysModule"},n.prototype.listProcessors=function(){return[new t.SevendaysProcessor]},n);function n(){return e.call(this)||this}t.SevendaysModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.UPDATE_SEVENDAYS_PANEL="UPDATE_SEVENDAYS_PANEL",r.DRAW_SEVENDAYS_REWARD="DRAW_SEVENDAYS_REWARD",r.SHOW_SEVENDAYS_PANEL="SHOW_SEVENDAYS_PANEL",r.SEVENDAYS_RED_EVENT="RED_EVENT",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.SevendaysEvent=a}(game=game||{}),function(t){var e=(i.prototype.getDay=function(t){return LanMgr.getLan("",12624,t)},i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.initArr=function(){this.isOnActivityTime()&&this.initArrSevendaysTb()},i.prototype.isOnActivityTime=function(t){var e=tb.TB_sevendays_times.getActivityOpenId();return null==t?-1!=e:e==t},i.prototype.getArrProJect=function(t){var e=JSON.parse(JSON.stringify(this.arrProJect));for(var i in e)e[i][1]+=t;return e},i.prototype.UpdateSevendayByday=function(t,e){this.arrSevendaysTb[t]&&this.arrSevendaysTb[t][e]&&this.arrSevendaysTb[t][e].sort(function(t,e){return t.sortNum()-e.sortNum()})},i.prototype.getRemainingTime=function(){var t=Math.floor((App.serverTime-App.hero.getCreateDayTiem())/TimeConst.ONE_DAY_MILSEC)+1,e=tb.TB_sevendays_times.getEndTime(t);if(-1==e)return LanMgr.getLan("",10224);var i=new Date(App.serverTimeSecond).getTime(),n=this.getLoginDaysTime(e);return i<n?activityTime(n,i):LanMgr.getLan("",10224)},i.prototype.getLoginDaysTime=function(t){var e=new Date(App.hero.createTime);return e.setHours(0,0,0,0),e.getTime()/1e3+t*TimeConst.ONE_DAY_SEC},i.prototype.getFinishTaskNum=function(){var t=0,e=tb.TB_sevendays_times.getActivityOpenId();if(-1!=e){var i=void 0;for(var n in App.hero.welfare.sevendayInfo)(i=tb.TB_activity_sevendays.get_TB_operate_activityById(Number(n)))&&e==i.time_type&&0<App.hero.welfare.sevendayInfo[n].rewardCount&&t++}return t},i.prototype.getSevendaysExtList=function(){var t=[],e=tb.TB_sevendays_times.getActivityOpenId();if(-1!=e){var i=TableData.getInstance().getTableByName(TableData.tb_sevendays_reward).data;for(var n in i)i[n].type==e&&t.push(new o(i[n]));t.sort(function(t,e){return t.tbReward.ID-e.tbReward.ID})}return t},i.prototype.getSevendaysList=function(t,e){var i=tb.TB_activity_sevendays.get_TB_operate_activityByDay(t,e),n=new Array;for(var o in i){var a=[];for(var r in i[o])a.push(new s(i[o][r]));a.sort(function(t,e){return t.sortNum()-e.sortNum()}),n.push(a)}return n},i.prototype.initArrSevendaysTb=function(){var t=tb.TB_sevendays_times.getActivityOpenId();if(-1!=t){this.arrSevendaysTb=new Array;for(var e=1;e<8;e++)this.arrSevendaysTb.push(this.getSevendaysList(t,7*(t-1)+e))}},i.prototype.canRedPoint=function(t,e){var i=this;return!!this.isOnActivityTime()&&!!(this.arrSevendaysTb&&this.arrSevendaysTb[t]&&this.arrSevendaysTb[t][e])&&this.arrSevendaysTb[t][e].some(function(t){return t.canReward()&&App.serverTimeSecond>=i.getLoginDaysTime(t.tbReward.day-1)})},i);function i(){this.initArr(),this.arrImage=[[1,11],[1,11],[2,22],[2,22],[3,33],[3,33]],this.arrProJect=[[LanMgr.getLan("",12620),"today_fuli"],[LanMgr.getLan("",12621),"today_mubiao"],[LanMgr.getLan("",12622),"today_renwu"],[LanMgr.getLan("",12623),"today_qianggou"]],this.arrDays=[[this.getDay(1),"first_day"],[this.getDay(2),"second_day"],[this.getDay(3),"third_day"],[this.getDay(4),"forth_day"],[this.getDay(5),"fifth_day"],[this.getDay(6),"sixth_day"],[this.getDay(7),"seventh_day"]],this.arr2Days=[[this.getDay(8),"first_day"],[this.getDay(9),"second_day"],[this.getDay(10),"third_day"],[this.getDay(11),"forth_day"],[this.getDay(12),"fifth_day"],[this.getDay(13),"sixth_day"],[this.getDay(14),"seventh_day"]]}t.SevendaysModel=e;var o=(n.prototype.isFinish=function(){return e.getInstance().getFinishTaskNum()>=this.tbReward.need_num},n.prototype.isReward=function(){return!!App.hero.welfare.sevendayExtraAward[this.tbReward.ID]},n.prototype.getRewardList=function(){var t=[];for(var e in this.tbReward.reward)t.push(new ItemVo(this.tbReward.reward[e][0],this.tbReward.reward[e][1]));return t},n.prototype.isCanReward=function(){return this.isFinish()&&!this.isReward()},n.prototype.getCount=function(){return this.tbReward.need_num},n.prototype.getSkin=function(){return""},n.prototype.getRewardSkin=function(){switch(this.getCount()){case 18:case 22:return SkinUtil.getTaskBaoxiang(1,this.isReward());case 36:case 45:return SkinUtil.getTaskBaoxiang(1,this.isReward());case 54:case 67:return SkinUtil.getTaskBaoxiang(2,this.isReward());case 72:case 90:return SkinUtil.getTaskBaoxiang(2,this.isReward());case 112:case 90:return SkinUtil.getTaskBaoxiang(3,this.isReward());default:return SkinUtil.getTaskBaoxiang(4,this.isReward())}},n.prototype.getEvent=function(){return new t.SevendaysEvent(t.SevendaysEvent.DRAW_SEVENDAYS_REWARD)},n);function n(t){this.tbReward=t}t.SevenDaysExtData=o;var s=(a.prototype.sortNum=function(){return this.isFinish()?this.canReward()?0:2:1},a.prototype.isBuy=function(){return this.tbReward.type==iface.tb_prop.activityTypeKey.sellItem},a.prototype.isReward=function(){return App.hero.welfare.sevendayInfo[this.tbReward.ID]&&1==App.hero.welfare.sevendayInfo[this.tbReward.ID].rewardCount},a.prototype.isFinish=function(){return!!App.hero.welfare.sevendayInfo[this.tbReward.ID]&&(this.tbReward.type==iface.tb_prop.activityTypeKey.arenaTopRank?0!=App.hero.welfare.sevendayInfo[this.tbReward.ID].condCount&&App.hero.welfare.sevendayInfo[this.tbReward.ID].condCount<=this.tbReward.value:App.hero.welfare.sevendayInfo[this.tbReward.ID].condCount>=this.tbReward.value)},a.prototype.canReward=function(){return(this.isFinish()||this.isBuy())&&!this.isReward()},a.prototype.getDesc=function(){var t=this.tbReward.value,e=App.hero.welfare.sevendayInfo[this.tbReward.ID]?App.hero.welfare.sevendayInfo[this.tbReward.ID].condCount:0;return this.tbReward.type==iface.tb_prop.activityTypeKey.towerCopy&&(t=tb.TB_copy_info.get_TB_copy_infoById(t).area_number,e=0==e?0:tb.TB_copy_info.get_TB_copy_infoById(e).area_number),LanMgr.getLan(this.tbReward.desc,-1,Snums(e),Snums(t))},a);function a(t){this.tbReward=t}t.SevenDaysData=s}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.activity.sevendays.render.SevendaysRenderUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(t){if(t){var e=t.tbReward,i=new Date(App.serverTimeSecond).getTime()>=a.SevendaysModel.getInstance().getLoginDaysTime(e.day-1),n=[];for(var o in e.reward)n.push(new ItemVo(e.reward[o][0],e.reward[o][1]));this.lab_level.text=t.getDesc(),this.img_labbg.width=Math.max(this.lab_level.width+100,237),this.list_item.dataSource=n,this.img_already.visible=t.isReward(),this.btn_buy.label=e.value.toString(),this.box_yuanjia.visible=t.isBuy()&&!t.isReward(),this.btn_lingqu.visible=!t.isReward()&&!t.isBuy(),this.lab_zuanshi.text=e.defined[0]&&e.defined[0][0]?e.defined[0][0]+"":"",this.btn_lingqu.selected=this.btn_lingqu.gray=!t.isFinish()||!i,this.box_yuanjia.gray=this.btn_buy.gray=this.btn_buy.selected=t.isReward()||!i,this.btn_lingqu.label=i?t.isFinish()?LanMgr.getLan("",10476):LanMgr.getLan("",10045):LanMgr.getLan("",10143),this.btn_lingqu.skin=SkinUtil.buttonGreen,this.btn_lingqu.labelStrokeColor=ColorConst.GREEN_FILTER,e.way_link&&0<e.way_link.length&&this.btn_lingqu.label==LanMgr.getLan("",10045)&&(this.btn_lingqu.selected=this.btn_lingqu.gray=!1,this.btn_lingqu.label=LanMgr.getLan("",12604),this.btn_lingqu.skin=SkinUtil.buttonNormal,this.btn_lingqu.labelStrokeColor=ColorConst.ORANGE_FILTER)}},i.prototype.linqu=function(t){var i=this;if("buy"==t){if(this.btn_buy.gray)return void showToast(LanMgr.getLan("",10229));var e=this.dataSource;if(App.hero.diamond<e.tbReward.value)return void showToast(LanMgr.getLan("",10005));if(App.hero.vip<e.tbReward.defined[0][1])return void showToast(LanMgr.getLan("",10156))}else{if(this.btn_lingqu.gray){var n=LanMgr.getLan("",10229);return this.btn_lingqu.label==LanMgr.getLan("",10045)&&(n=LanMgr.getLan("",10230)),void showToast(n)}if(this.btn_lingqu.label==LanMgr.getLan("",12604))return e=this.dataSource,void dispatchEvt(new a.HudEvent(a.HudEvent.SHOW_MODULE_VIEW,e.tbReward.way_link))}var o={};o[Protocol.game_activity_getSevenDayReward.args.num]=1,o[Protocol.game_activity_getSevenDayReward.args.id]=this.dataSource.tbReward.ID,PLC.request(Protocol.game_activity_getSevenDayReward,o,function(t,e){t&&(UIUtil.showRewardView(t.commonData),dispatchEvt(new a.SevendaysEvent(a.SevendaysEvent.SEVENDAYS_RED_EVENT),i.dataSource.tbReward),dispatchEvt(new a.SevendaysEvent(a.SevendaysEvent.UPDATE_SEVENDAYS_PANEL)))})},i);function i(){var t=e.call(this)||this;return t.btn_buy.on(Laya.Event.CLICK,t,t.linqu,["buy"]),t.btn_lingqu.on(Laya.Event.CLICK,t,t.linqu,["linqu"]),t}a.SevendaysIR=t;var n,o=(n=ui.activity.sevendays.render.tabItemRenderUI,__extends(r,n),Object.defineProperty(r.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),r.prototype.refreshData=function(t){t?(this.btn_tab.label=t[0],""!=t[1]?this.redpoint.setRedPointName(t[1]):this.redpoint.onDispose()):this.redpoint.onDispose()},r);function r(){return n.call(this)||this}a.tabIR=o}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.activity.realName.realNameUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},e.prototype.init=function(){this.btnSure.gray=this.btnSure.selected=1==App.hero.welfare.autonymAwardNum,this.btnSure.label=0==App.hero.welfare.autonymAwardNum&&0==App.hero.isCertification?LanMgr.getLan("",12626):1==App.hero.welfare.autonymAwardNum?LanMgr.getLan("",10043):LanMgr.getLan("",12627),this.itemList.dataSource=tb.TB_activity_set.getTabSet().autonym_rewrad.map(function(t){return new ItemVo(t[0],t[1])}),listAtCenter(this.itemList,319,3,this.itemList.dataSource.length)},e.prototype.refresh=function(){this.init()},e.prototype.onClick=function(){var i=this;logyhj("实名认证结果：%d %d",App.hero.isCertification,App.hero.isIndulge,App.hero.welfare.autonymAwardNum),0==App.hero.welfare.autonymAwardNum&&0==App.hero.isCertification?BingoSDK.doExtraAction("realNameAuth",function(t){logyhj("实名认证结果回调"),0==t.code?n.RealNameModel.RealNameOpt(t.data.status):showToast(t.message)}):0==App.hero.welfare.autonymAwardNum?PLC.request(Protocol.game_welfare_getAutonymAward,null,function(t,e){t&&(i.btnSure.label=LanMgr.getLan("",10043),UIUtil.showRewardView(t.commonData),i.btnSure.gray=i.btnSure.selected=!0,dispatchEvt(new n.HudEvent(n.HudEvent.UPDATE_MAINVIEW_BUTTON)))}):showToast(LanMgr.getLan("",10228))},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.RealNameView,closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12625)},t.btnSure.on(Laya.Event.CLICK,t,t.onClick),tl3d.ModuleEventManager.addEvent(n.ResEvent.ISCERTIFICATION_EVENT,t.refresh,t),t}n.RealNameView=t}(game=game||{}),function(o){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.RealNameOpt=function(t){var e=0,i=0;if(2==t&&(e=i=1),1==t&&(i=1,e=0),i!=App.hero.isCertification||e!=App.hero.isIndulge){App.hero.isCertification=i,App.hero.isIndulge=e;var n={};n[Protocol.game_welfare_updateRealName.args.fcm]=e,n[Protocol.game_welfare_updateRealName.args.shiming]=i,PLC.request(Protocol.game_welfare_updateRealName,n,function(){dispatchEvt(new o.ResEvent(o.ResEvent.ISCERTIFICATION_EVENT))})}},e);function e(){}o.RealNameModel=t}(game=game||{}),function(t){var e=(n.prototype.copyInfo=function(t){t&&t.hasPerson?(this.playerID=t.playerID,this.name=t.name,this.level=t.level,this.head=t.head,this.headFrame=t.headFrame,this.guild=t.guild,this.power=t.power,this.shenlingid=t.shenlingid,this.slShenLi=t.slShenLi,this.hasPerson=!0):this.clear()},n.prototype.clear=function(){this.playerID="",this.name="",this.level=0,this.head=null,this.headFrame=0,this.guild="",this.power=0,this.shenlingid=0,this.slShenLi=0,this.hasPerson=!1},n.prototype.getTitle=function(){switch(this.id){case n.ID_FUBEN:return LanMgr.getLan("",10148);case n.ID_LEVEL:return LanMgr.getLan("",12179);case n.ID_SHENLING:return LanMgr.getLan("",12081);case n.ID_SHILIAN:return LanMgr.getLan("",12183);case n.ID_ZHANLI:return LanMgr.getLan("",12081);default:return""}},n.prototype.getConditionTitle=function(){switch(this.id){case n.ID_FUBEN:return LanMgr.getLan("",10148);case n.ID_LEVEL:return LanMgr.getLan("",12179);case n.ID_SHENLING:return LanMgr.getLan("",12629);case n.ID_SHILIAN:return LanMgr.getLan("",12183);case n.ID_ZHANLI:return LanMgr.getLan("",12081);default:return""}},n.prototype.getConditionDesc=function(){switch(this.id){case n.ID_FUBEN:return LanMgr.getLan("",12628)+t.GuajiModel.getInstance().getCopyRankDesc(this.reward.score);case n.ID_LEVEL:return LanMgr.getLan("",12501)+this.reward.score+LanMgr.getLan("",10031);case n.ID_SHENLING:return LanMgr.getLan("",12501)+this.reward.score+LanMgr.getLan("",12528);case n.ID_SHILIAN:return LanMgr.getLan("",12628)+t.TowerModel.getInstance().getCopyRankDesc(this.reward.score);case n.ID_ZHANLI:return LanMgr.getLan("",12501)+this.reward.score;default:return""}},n.prototype.getShenLingName=function(){var t=tb.TB_god.get_TB_godById(this.shenlingid);return t?t.name:""},n.prototype.getValueDesc=function(){switch(this.id){case n.ID_FUBEN:return t.GuajiModel.getInstance().getCopyRankDesc(this.power);case n.ID_LEVEL:return this.power+LanMgr.getLan("",10031);case n.ID_SHENLING:return this.slShenLi+"";case n.ID_SHILIAN:return t.TowerModel.getInstance().getCopyRankDesc(this.power);case n.ID_ZHANLI:return this.power+"";default:return""}},n.ID_ZHANLI=1,n.ID_FUBEN=2,n.ID_LEVEL=3,n.ID_SHILIAN=4,n.ID_SHENLING=5,n);function n(t,e,i){this.id=t,this.index=e,this.rank=String(e+1),this.hasPerson=null!=i,this.hasPerson?this.id==n.ID_SHENLING?(this.playerID=i[0],this.name=i[4],this.level=i[6],this.head=i[5],this.guild=i[7],this.power=i[1],this.slShenLi=i[2],this.shenlingid=i[3],this.headFrame=i[8]):(this.playerID=i[0],this.name=i[2],this.level=i[4],this.head=i[3],this.guild=i[5],this.power=i[1],this.headFrame=i[6]):this.clear()}t.PrRankVo=e}(game=game||{}),function(a){var t=(e.prototype.syncData=function(t){this.godInfo=t.godInfo||{},this.firstRankGodId=this.godInfo[1]?this.godInfo[1][0]:0,this.firstAwakenLv=this.godInfo[1]?this.godInfo[1][1]:0,this.firstSkinId=this.godInfo[1]?this.godInfo[1][2]:0,this.secondRankGodId=this.godInfo[2]?this.godInfo[2][0]:0,this.secondAwakenLv=this.godInfo[2]?this.godInfo[2][1]:0,this.secondSkinId=this.godInfo[2]?this.godInfo[2][2]:0,this.thirdRankGodId=this.godInfo[3]?this.godInfo[3][0]:0,this.thirdAwakenLv=this.godInfo[3]?this.godInfo[2][1]:0,this.thirdSkinId=this.godInfo[3]?this.godInfo[3][2]:0,this.myRank=t.myRank,this.rankValue=t.rankValue,this.forceRankList=[];for(var e=0;e<this.maxRank;e++){var i=t.forceRankList[e+1];this.forceRankList[e]=new a.PrRankVo(this.id,e,i),this.forceRankList[e].reward=this.getReward(e+1)}for(e=0;e<this.rewardList.length;e++)this.rewardList[e].reward.rank[0]==this.rewardList[e].reward.rank[1]&&this.rewardList[e].copyInfo(this.forceRankList[this.rewardList[e].reward.rank[0]-1])},e.prototype.getModelId=function(t){return 1==t?a.GodUtils.getShowGodModel(this.firstRankGodId,this.firstSkinId):2==t?a.GodUtils.getShowGodModel(this.secondRankGodId,this.secondSkinId):a.GodUtils.getShowGodModel(this.thirdRankGodId,this.thirdSkinId)},e.prototype.getReward=function(t){for(var e=0;e<this.rewardList.length;e++)if(this.rewardList[e].reward.rank[0]<=t&&t<=this.rewardList[e].reward.rank[1])return this.rewardList[e].reward;return null},e.prototype.getMyRankDesc=function(){var t=this.forceRankList.find(function(t){return t.playerID==App.hero.playerId});switch(this.id){case a.PrRankVo.ID_ZHANLI:return LanMgr.getLan("",12178)+"："+Snums(t?t.power:App.hero.maxHistoryForce);case a.PrRankVo.ID_FUBEN:var e=a.GuajiModel.getInstance();return LanMgr.getLan("",12181)+"："+e.getCopyRankDesc(t?t.power:e.getMaxLev());case a.PrRankVo.ID_LEVEL:return LanMgr.getLan("",12180)+"："+(t?t.power:App.hero.level);case a.PrRankVo.ID_SHENLING:var i=0;if(t)i=t.power;else{var n=App.hero.getGodAry();n&&1<n.length&&(i=n[0].starLevel)}return LanMgr.getLan("",12630,i);case a.PrRankVo.ID_SHILIAN:var o=App.hero.towerCopyInfo[2]?App.hero.towerCopyInfo[2]:App.hero.towerCopyInfo[1];return LanMgr.getLan("",12183)+"："+a.TowerModel.getInstance().getCopyRankDesc(t?t.power:o);default:return""}},e.prototype.getMyValueDesc=function(){return LanMgr.getLan("",12265)+(this.myRank?this.myRank:LanMgr.getLan("",12187))},e.prototype.getTitle=function(){switch(this.id){case a.PrRankVo.ID_FUBEN:return LanMgr.getLan("",12181);case a.PrRankVo.ID_LEVEL:return LanMgr.getLan("",12179);case a.PrRankVo.ID_SHENLING:return LanMgr.getLan("",12629);case a.PrRankVo.ID_SHILIAN:return LanMgr.getLan("",12183);case a.PrRankVo.ID_ZHANLI:return LanMgr.getLan("",12081);default:return""}},e);function e(t){this.id=0,this.myRank=0,this.rankValue=0,this.forceRankList=[],this.maxRank=50,this.firstRankGodId=0,this.firstAwakenLv=0,this.secondRankGodId=0,this.secondAwakenLv=0,this.thirdRankGodId=0,this.thirdAwakenLv=0,this.id=t,this.rankType=tb.TB_rank_type.getSet(t);var e=tb.TB_rank_reward.getRewardListByType(this.rankType.type);this.rewardList=[];for(var i=0;i<e.length;i++)this.rewardList[i]=new a.PrRankVo(this.id,i,null),this.rewardList[i].reward=e[i],this.rewardList[i].rank=e[i].rank[0]==e[i].rank[1]?String(e[i].rank[0]):e[i].rank[0]+"~"+e[i].rank[1]}a.RankListVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.activity.powerrank.rankIRUI,__extends(i,e),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;if(t)if(t.index<3?(this.lb_rank.visible=!1,this.img_rank.visible=!0,this.img_rank.skin=SkinUtil.getRankingSkin(t.index)):(this.lb_rank.visible=!0,this.img_rank.visible=!1,this.lb_rank.text=t.rank),t.hasPerson){this.ui_head.visible=!0;var e=new UserHeadVo(t.head,t.level,t.headFrame,!1);if(this.ui_head.dataSource=e,this.lb_name.text=t.name,this.lab_type.text=t.getTitle(),this.lb_power.text=t.getValueDesc(),t.id==a.PrRankVo.ID_SHENLING){this.lab_god.text=t.getShenLingName(),this.lb_guild.text="",this.starlist.visible=!0;for(var i=new Array,n=5<t.power?t.power-5:t.power,o=0;o<n;o++)i[o]=6<=t.power;this.starlist.dataSource=i}else this.lab_god.text="",this.lb_guild.text=t.guild&&""!=t.guild?t.guild:LanMgr.getLan("",12084),this.starlist.visible=!1;this.ui_head.on(Laya.Event.CLICK,this,this.onShowInfo)}else this.ui_head.visible=!1,this.lab_god.text=LanMgr.getLan("",12508),this.lb_name.text="",this.lb_guild.text="",this.lb_power.text=t.getConditionDesc(),this.lab_type.text=t.getConditionTitle(),this.starlist.visible=!1,this.starlist.dataSource=null,this.ui_head.off(Laya.Event.CLICK,this,this.onShowInfo);else this.ui_head.off(Laya.Event.CLICK,this,this.onShowInfo)},i.prototype.onShowInfo=function(){var t=this.dataSource;t&&UIUtil.showPlayerLineupInfo(t.playerID)},i.prototype.onStarRender=function(t,e){var i=t.dataSource;t.skin=i?SkinUtil.superXing:SkinUtil.xingxing},i);function i(){var t=e.call(this)||this;return t.starlist.renderHandler=new Handler(t,t.onStarRender),t}a.PrRankIR=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.powerrank.itemIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){if(t){this.lab_condition.text=t.getConditionTitle()+t.getConditionDesc();var e=[];t.reward.special_reward&&0<t.reward.special_reward.length&&(e=e.concat.apply(e,ary2prop(t.reward.special_reward))),e=e.concat.apply(e,ary2prop(t.reward.reward)),this.list_reward.array=e,t.index<3?(this.lbRank.visible=!1,this.imgRank.visible=!0,this.imgRank.skin=SkinUtil.getRankingSkin(t.index)):(this.lbRank.visible=!0,this.imgRank.visible=!1,this.lbRank.text=t.rank)}},n);function n(){return e.call(this)||this}t.PowerAwardIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=ui.activity.powerrank.powerRankUI,__extends(i,n),i.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},i.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},i.prototype.close=function(t,e,i){n.prototype.close.call(this,t,e,i)},i.prototype.onClosed=function(){n.prototype.onClosed.call(this)},i.prototype.initView=function(){var t=this.dataSource;this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:t.getTitle()+LanMgr.getLan("",12631)},this.list_rank.array=t.forceRankList,this.lab_title.text=t.getTitle(),this.lb_myrank.text=t.getMyValueDesc()+"   "+t.getMyRankDesc()},i);function i(){var t=n.call(this)||this;return t.isModelClose=!0,t}t.PowerRank=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.activity.powerrank.mainTabPageUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},n.prototype.onOpened=function(){i.prototype.onOpened.call(this)},n.prototype.close=function(){this.listRank.array=null,this._list=null,this.uiScene1.onExit(),this.lab_time.clearTimer(this,this.onLoop)},n.prototype.init=function(){this._data=this.dataSource;for(var t=[],e=0;e<this._data.rewardList.length;e++)t.push(this._data.rewardList[e]);this._list=t,this.listRank.array=this._list,this.lab_mypower.text=this._data.getMyRankDesc(),this.lab_myrank.text=this._data.getMyValueDesc(),Laya.timer.clearAll(this),this.lab_time.timerLoop(1e4,this,this.onLoop),this.onLoop(),this.drawRank()},n.prototype.onLoop=function(){var t=App.getOpenServerTime()+this._data.rankType.time[1]*TimeConst.ONE_DAY_SEC;0<t-App.getServerTime()?this.lab_time.text=LanMgr.getLan("",12632)+activityTime(t,App.getServerTime()):(this.lab_time.text=LanMgr.getLan("",11010),this.lab_time.clearTimer(this,this.onLoop))},n.prototype.drawRank=function(){var t=this._list[0];t.hasPerson&&(this.lbFirstName.text=t.name,this.lbFisrtDesc.text=t.getTitle()+":"+t.getValueDesc()),this.lbFirstName.visible=this.lbFisrtDesc.visible=t.hasPerson,this.lbFirstEmpty.visible=this.imgFirstEmpty.visible=!t.hasPerson;var e=this._list[1];e.hasPerson&&(this.lbSecondName.text=e.name,this.lbSecondDesc.text=e.getTitle()+":"+e.getValueDesc()),this.lbSecondName.visible=this.lbSecondDesc.visible=e.hasPerson,this.lbSecondEmpty.visible=this.imgSecondEmpty.visible=!e.hasPerson;var i=this._list[2];i.hasPerson&&(this.lbThirdName.text=i.name,this.lbThirdDesc.text=i.getTitle()+":"+i.getValueDesc()),this.lbThirdName.visible=this.lbThirdDesc.visible=i.hasPerson,this.lbThirdEmpty.visible=this.imgThirdEmpty.visible=!i.hasPerson,this.uiScene1.onShow();var n=t.hasPerson?this._data.getModelId(1):0;Laya.timer.once(300,this,this.showmodel1,[n]),n=e.hasPerson?this._data.getModelId(2):0,Laya.timer.once(350,this,this.showmodel2,[n]),n=i.hasPerson?this._data.getModelId(3):0,Laya.timer.once(400,this,this.showmodel3,[n])},n.prototype.showmodel1=function(t){if(this.removeUIChar(1),0!=t){var e=this.imgFirstTY,i=e.localToGlobal(new Laya.Point(0,0));this._uiChar1=this.uiScene1.addModelChar(String(t),i.x+e.width*e.scaleX/2-Launch.offsetX,i.y+40-Launch.offsetY,180,1.8)}},n.prototype.showmodel2=function(t){if(this.removeUIChar(2),0!=t){var e=this.imgSecondTY,i=e.localToGlobal(new Laya.Point(0,0));this._uiChar2=this.uiScene1.addModelChar(String(t),i.x+e.width*e.scaleX/2-Launch.offsetX,i.y+40-Launch.offsetY,180,1.8)}},n.prototype.showmodel3=function(t){if(this.removeUIChar(3),0!=t){var e=this.imgThirdTY,i=e.localToGlobal(new Laya.Point(0,0));this._uiChar3=this.uiScene1.addModelChar(String(t),i.x+e.width*e.scaleX/2-Launch.offsetX,i.y+40-Launch.offsetY,180,1.8)}},n.prototype.removeUIChar=function(t){1==t&&this._uiChar1?(this._uiChar1.removeSelf(),this._uiChar1=null):2==t&&this._uiChar2?(this._uiChar2.removeSelf(),this._uiChar2=null):3==t&&this._uiChar3&&(this._uiChar3.removeSelf(),this._uiChar3=null)},n.prototype.onClick=function(){dispatchEvt(new t.PowerrankEvent(t.PowerrankEvent.OPEN_DETAIL_PANEL))},n.prototype.onShowInfo=function(t){var e=this._list?this._list[t]:null;e&&UIUtil.showPlayerLineupInfo(e.playerID)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.uiScene1=new Base2dSceneLayerExt,t.boxRole.addChild(t.uiScene1),t.btnRank.on(Laya.Event.CLICK,t,t.onClick),t.boxFirst.on(Laya.Event.CLICK,t,t.onShowInfo,[0]),t.boxSecond.on(Laya.Event.CLICK,t,t.onShowInfo,[1]),t.boxThird.on(Laya.Event.CLICK,t,t.onShowInfo,[2]),t}t.MainTabPage=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.activity.powerrank.mainPageUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},n.prototype.init=function(){this.list_tab.dataSource=this.getTabList(),this.setSelectTabNum(~~this.list_tab.dataSource.findIndex(function(t){return t[2].ID==e.PowerrankModel.getInstance().curRankID})),Laya.timer.clearAll(this);var t=App.getServerTime()%TimeConst.ONE_DAY_SEC;t+=10,Laya.timer.once(1e3*t,this,this.init)},n.prototype.getTabList=function(){var t=[],e=TableData.getInstance().getTableByName(TableData.tb_rank_type).data;for(var i in e)if(e[i]){var n=e[i],o=App.getServerTime()-App.getOpenServerTime();if(n.isShowActivityBtn(o)){var a=[];a[0]=this.getTabName(n.ID),a[1]="shenjie"+n.ID,a[2]=n,t.push(a)}}return t.sort(function(t,e){return e[2].time[0]-t[2].time[0]}),t},n.prototype.getTabName=function(t){switch(t){case e.PrRankVo.ID_FUBEN:return LanMgr.getLan("",12634);case e.PrRankVo.ID_LEVEL:return LanMgr.getLan("",12635);case e.PrRankVo.ID_SHENLING:return LanMgr.getLan("",12636);case e.PrRankVo.ID_SHILIAN:return LanMgr.getLan("",12183);case e.PrRankVo.ID_ZHANLI:return LanMgr.getLan("",12637);default:return""}},n.prototype.setSelectTabNum=function(t){this.list_tab.selectedIndex=t,this.list_tab.refresh()},n.prototype.onTabSelect=function(t){t<0||dispatchEvt(new e.PowerrankEvent(e.PowerrankEvent.SHOW_VIEW_EVENT),this.list_tab.dataSource[t][2].ID)},n.prototype.onTabRender=function(t,e){t.btn_tab.selected=e==this.list_tab.selectedIndex},n.prototype.updateData=function(t){this.mainview.dataSource=t,this.mainview.init()},n.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.updateData(this.dataSource)},n.prototype.close=function(){i.prototype.close.call(this),this.mainview.close()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.mainview.close(),e.PowerrankModel.getInstance().rankingList={},Laya.timer.clearAll(this)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={uiName:UIConst.PowerRank,closeOnSide:t.isModelClose,closeOnButton:!0,title:LanMgr.getLan("",12633)},t.list_tab.selectHandler=new Handler(t,t.onTabSelect),t.list_tab.renderHandler=new Handler(t,t.onTabRender),t}e.MainPage=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"PowerrankProcessor"},i.prototype.listenModuleEvents=function(){return[new a.PowerrankEvent(a.PowerrankEvent.SHOW_VIEW_EVENT),new a.PowerrankEvent(a.PowerrankEvent.OPEN_DETAIL_PANEL),new a.PowerrankEvent(a.PowerrankEvent.SHOW_RANKVIEW_EVENT)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof a.PowerrankEvent)switch(t.type){case a.PowerrankEvent.SHOW_VIEW_EVENT:this.showview(t.data);break;case a.PowerrankEvent.OPEN_DETAIL_PANEL:this.opendetail();break;case a.PowerrankEvent.SHOW_RANKVIEW_EVENT:this.openRankView(t.data)}},i.prototype.opendetail=function(){var t=this._model,e=t.rankingList[t.curRankID];this.openRankView(e)},i.prototype.showview=function(i){var n=this,o=this._model;if(o.visiableView())if(i=i||this.getFirstRankId(),o.curRankID=i,this.viewHasStage&&o.rankingList.hasOwnProperty(i))this.view.updateData(o.rankingList[i]);else{var t={};t[Protocol.center_global_getRankList.args.id]=i,PLC.request(Protocol.center_global_getRankList,t,function(t,e){t&&(o.firstLogin=!1,o.rankingList.hasOwnProperty(i)||(o.rankingList[i]=new a.RankListVo(i)),o.rankingList[i].syncData(t),dispatchEvt(new a.PowerrankEvent(a.PowerrankEvent.UPDATE_REDPOINT)),n.viewHasStage?n.view.updateData(o.rankingList[i]):UIMgr.showUI(UIConst.PowerRank,o.rankingList[i]))})}else showToast(LanMgr.getLan("",10095))},i.prototype.getFirstRankId=function(){var t=TableData.getInstance().getTableByName(TableData.tb_rank_type).data,e=1;for(var i in t)if(t[i]){var n=t[i],o=App.getServerTime()-App.getOpenServerTime();if(n.isShowActivityBtn(o))return n.ID;e=n.ID}return e},i.prototype.openRankView=function(t){UIMgr.showUI(UIConst.Pow_List,t)},Object.defineProperty(i.prototype,"view",{get:function(){return UIMgr.getUIByName(UIConst.PowerRank)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewHasStage",{get:function(){return UIMgr.hasStage(UIConst.PowerRank)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=a.PowerrankModel.getInstance(),t}a.PowerrankProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"PowerrankModule"},n.prototype.listProcessors=function(){return[new t.PowerrankProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.PowerrankModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_VIEW_EVENT="SHOW_VIEW_EVENT",r.OPEN_DETAIL_PANEL="OPEN_DETAIL_PANEL",r.SHOW_RANKVIEW_EVENT="SHOW_RANKVIEW_EVENT",r.UPDATE_REDPOINT="UPDATE_REDPOINT",r);function r(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.PowerrankEvent=a}(game=game||{}),function(t){var e=(i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i.prototype.visiableView=function(){return 0<App.getOpenServerTime()+(tb.TB_rank_type.getPowerRanKEndTime()+1)*TimeConst.ONE_DAY_SEC-App.getServerTime()},i);function i(){this.rankingList={},this.firstLogin=!1}t.PowerrankModel=e}(game=game||{}),function(t){var e=(i.prototype.analysisTime=function(){switch(this._timeTemp.type){case 0:case 1:break;case 2:var t=App.getOpenServerTime();this._startTime=t+(this._timeTemp.time[0]-1)*TimeConst.ONE_DAY_SEC,this._endTime=t+this._timeTemp.time[1]*TimeConst.ONE_DAY_SEC}},i.prototype.addGift=function(t){t&&this._giftList.push(t)},i.prototype.getStartTime=function(){return this._startTime},i.prototype.getEndTime=function(){return this._endTime},i.prototype.isActivityTime=function(){var t=App.getServerTime();return this._startTime<t&&t<=this._endTime},i.prototype.getRemainTime=function(){if(!this.isActivityTime())return 0;var t=App.getServerTime();return this._endTime-t},i.prototype.getGiftList=function(){return this._giftList},i);function i(t){this._startTime=0,this._endTime=Number.MAX_VALUE,this._timeTemp=t,this._giftList=[],this.analysisTime()}t.OpenServerGiftVo=e}(game=game||{}),function(o){var t=(e.prototype.isopen=function(){var t=App.serverTime;return App.hero.getCreateDayTiem()+TimeConst.ONE_DAY_MILSEC*(this.id-1)<=t},e.prototype.canBuy=function(){var t=App.serverTime,e=App.hero.getCreateDayTiem(),i=e+TimeConst.ONE_DAY_MILSEC*(this.id-1),n=e+TimeConst.ONE_DAY_MILSEC*o.OpenserverModel.getInstance().allday;return i<=t&&t<n},e.prototype.isbuy=function(){var t=App.hero.welfare;return!(!t.hasOwnProperty("doneOpenGifts")||-1==t.doneOpenGifts.indexOf(this.id))},e.prototype.isReceive=function(){return this.isbuy()},e);function e(){}o.DayVo=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var e,t=(e=ui.activity.openserver.tabPageUI,__extends(i,e),i.prototype.onClick=function(){var t=this;if(this.btn_buy.gray)showToast(this.btn_buy.label);else if(!this.dataSource.isbuy()){var e=this.dataSource.tab.charge_id,i=Number(window.platform.pid);if(a.ChongzhiModel.isRealPay(i)){var n=tb.TB_recharge.get_TB_rechargeById(e);a.ChongzhiModel.pay(n)}else UIUtil.payDebug(e,{text:LanMgr.getLan("",12638),yes:LanMgr.getLan("",12639)},function(){a.OpenserverModel.getInstance().addpay(t.dataSource.id),t.updateBtn(t.dataSource)})}},Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),i.prototype.showmodel=function(t,e){this.uiScene.onShow(),this._lastmodel!=t&&(this.uiScene.clearSceneChar(),this.uiScene.addModelChar(String(t),200,700,180,e),this._lastmodel=t)},i.prototype.closePanel=function(){this.uiScene&&this.uiScene.onExit(),this._lastmodel=-1},i.prototype.refreshData=function(t){t?(this.list_reward.dataSource=ary2prop(t.tab.reward),listAtCenter(this.list_reward,15,5,this.list_reward.dataSource.length),this.callLater(this.showmodel,[t.tab.model_show,t.tab.model_multiple]),this.updateBtn(t)):this.list_reward.dataSource=null},i.prototype.updateBtn=function(t){var e=t.isReceive(),i=t.isbuy(),n=t.canBuy();this.redpoint.visible=i&&!e;var o=a.OpenserverModel.getInstance().hasPay(t.id);this.btn_buy.gray=!1,e||i?(this.btn_buy.label=LanMgr.getLan("",10036),this.btn_buy.gray=!0):o?(this.btn_buy.label=LanMgr.getLan("",10473),this.btn_buy.gray=!0):n?this.btn_buy.label=LanMgr.getLan("",10475)+t.tab.recharge_num:(this.btn_buy.label=LanMgr.getLan("",10474),this.btn_buy.gray=!0)},i);function i(){var t=e.call(this)||this;return t.btn_buy.on(Laya.Event.CLICK,t,t.onClick),t.uiScene=new Base2dSceneLayer,t.addChild(t.uiScene),t}a.TabPage=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.TabIR1UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){t?(this.btn_tab.label=LanMgr.getLan("",12624,num2ChiNum(t.tab.ID)),this.img_lock.visible=!t.isopen(),this.redpoint.setRedPointName("openRewardActivity"+t.id)):this.redpoint.onDispose()},n);function n(){return e.call(this)||this}t.TabIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.activity.openserver.openServerGiftIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(t){if(t){this.visible=!0;var e=App.hero.welfare.openSvrGiftAwardNums[t.ID]?App.hero.welfare.openSvrGiftAwardNums[t.ID]:0;this.lab_num.text=LanMgr.getLan("{0}/{1}",-1,e,t.num),this.lab_title.text=LanMgr.getLan("",12640,t.recharge_num),this.itemList.dataSource=ary2prop(t.reward),this.btnSure.on(Laya.Event.CLICK,this,this.onClickBuy)}else this.visible=!1,this.btnSure.off(Laya.Event.CLICK,this,this.onClickBuy)},i.prototype.onClickBuy=function(){var t=this,e=this.dataSource;if((App.hero.welfare.openSvrGiftAwardNums[e.ID]?App.hero.welfare.openSvrGiftAwardNums[e.ID]:0)>=e.num)showToast(LanMgr.getLan("",10146));else{var i=Number(window.platform.pid);if(o.ChongzhiModel.isRealPay(i)){var n=tb.TB_recharge.get_TB_rechargeById(e.charge_id);o.ChongzhiModel.pay(n)}else UIUtil.payDebug(e.charge_id,null,function(){t.refreshData(e)})}},i);function i(){return t.call(this)||this}o.OpenServerGiftIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.activity.openserver.openServerGiftUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e)},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e)},n.prototype.onOpened=function(){i.prototype.onOpened.call(this),this.initVo(),this.btn_close.on(Laya.Event.CLICK,this,this.onClickClose),tl3d.ModuleEventManager.addEvent(t.OpenserverEvent.OS_GIFT_CHANGE,this.refreshData,this),Laya.timer.loop(1e3,this,this.updateTime),this.updateTime()},n.prototype.initVo=function(){this._curGiftVo=t.OpenserverModel.getInstance().getCurOpenServerGiftVo(),this.listitem.dataSource=this._curGiftVo?this._curGiftVo.getGiftList():[]},n.prototype.refreshData=function(){this.listitem.refresh()},n.prototype.updateTime=function(){if(this._curGiftVo){var t=this._curGiftVo.getRemainTime();t=Math.floor(t),this.lab_time.text=LanMgr.getLan("",12172,this.getTimeStr(t)),t<=0&&this.initVo()}else this.lab_time.text="",UIMgr.hideUIByName(UIConst.OpenServerGift)},n.prototype.getTimeStr=function(t){var e="",i=float2int(t/TimeUtil.dayTime);0<i&&(t-=i*TimeUtil.dayTime,e+=i+LanMgr.getLan("",10025));var n=float2int(t/TimeUtil.HourTime);if(0<n&&(t-=n*TimeUtil.HourTime,e+=n+LanMgr.getLan("",10026)),0<i)return e;var o=float2int(t/TimeUtil.MinuteTime);return 0<o&&(t-=o*TimeUtil.MinuteTime,e+=o+LanMgr.getLan("",10027)),e},n.prototype.onClickClose=function(){UIMgr.hideUIByName(UIConst.OpenServerGift)},n.prototype.close=function(){i.prototype.close.call(this),Laya.timer.clearAll(this),this.btn_close.off(Laya.Event.CLICK,this,this.onClickClose),tl3d.ModuleEventManager.removeEvent(t.OpenserverEvent.OS_GIFT_CHANGE,this.refreshData,this),this._curGiftVo=null},n.prototype.onClosed=function(){i.prototype.onClosed.call(this)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}t.OpenServerGiftView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.activity.openserver.mainPageUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},n.prototype.init=function(){this._selectTabNum=-1,this.list_tab.array=this.model.getList(),this.list_tab.selectedIndex=0,this.list_tab.scrollTo(0),this.onLoop(),this.lab_time.timerLoop(1e4,this,this.onLoop)},n.prototype.onLoop=function(){this.model.needtime()?(this.lab_time.text=this.model.onTime(),this.list_tab.refresh()):(this.lab_time.text=LanMgr.getLan("",11010),this.lab_time.clearTimer(this,this.onLoop))},n.prototype.onOpened=function(){i.prototype.onOpened.call(this)},n.prototype.onData=function(t){this.ui_tab.dataSource=t},n.prototype.onTabSelect=function(t){if(-1!=t&&this._selectTabNum!=t){var e=this.list_tab.array[t];e.isopen()?(this._selectTabNum=t,this.onData(e),this.list_tab.selectedIndex=-1):showToast(LanMgr.getLan("",10143))}},n.prototype.onTabRender=function(t,e){t.btn_tab.selected=e==this._selectTabNum},n.prototype.updateTab=function(){var t=this.list_tab.array[this._selectTabNum];this.onData(t)},n.prototype.close=function(){i.prototype.close.call(this),this._selectTabNum=-1,this.ui_tab.dataSource=null,this.ui_tab.closePanel(),this.lab_time.clearTimer(this,this.onLoop)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t.list_tab.selectHandler=new Handler(t,t.onTabSelect),t.list_tab.renderHandler=new Handler(t,t.onTabRender),t.model=e.OpenserverModel.getInstance(),t.btn_close.on(Laya.Event.CLICK,t,t.close),t}e.OsMainPage=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=tl3d.Processor,__extends(n,i),n.prototype.getName=function(){return"OpenserverProcessor"},n.prototype.listenModuleEvents=function(){return[new e.OpenserverEvent(e.OpenserverEvent.CLICK_TAB),new e.OpenserverEvent(e.OpenserverEvent.VIEW_CHANGE)]},n.prototype.receivedModuleEvent=function(t){if(t instanceof e.OpenserverEvent)switch(t.type){case e.OpenserverEvent.CLICK_TAB:this.clickTab(t.data);break;case e.OpenserverEvent.VIEW_CHANGE:this.viewchange()}},n.prototype.viewchange=function(){this.viewHasStage&&this.view.updateTab()},n.prototype.clickTab=function(t){this.viewHasStage&&this.view.onData(t)},Object.defineProperty(n.prototype,"view",{get:function(){return UIMgr.getUIByName(UIConst.OpenReward)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewHasStage",{get:function(){return UIMgr.hasStage(UIConst.OpenReward)},enumerable:!0,configurable:!0}),n);function n(){var t=i.call(this)||this;return t._model=e.OpenserverModel.getInstance(),t}e.OpenserverProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"OpenserverModule"},n.prototype.listProcessors=function(){return[new t.OpenserverProcessor]},n.prototype.onRegister=function(){t.OpenserverModel.getInstance().init()},n);function n(){return e.call(this)||this}t.OpenserverModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.CLICK_TAB="CLICK_TAB",r.RED_CHANGE="RED_CHANGE",r.VIEW_CHANGE="VIEW_CHANGE",r.OS_GIFT_CHANGE="OS_GIFT_CHANGE",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.OpenserverEvent=a}(game=game||{}),function(a){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.initOpenServerGift=function(){this._openServerGiftVoArr=[];var t=TableData.getInstance().getTableByName(TableData.tb_openservice_gift).data;for(var e in t){var i=t[e];if(i){if(!this._openServerGiftVoArr[i.time_index-1]){var n=tb.TB_gift_time.getSet(i.time_index),o=new a.OpenServerGiftVo(n);this._openServerGiftVoArr[i.time_index-1]=o,(0==this._osGiftStartTime||this._osGiftStartTime>o.getStartTime())&&(this._osGiftStartTime=o.getStartTime()),o.getEndTime()>this._osGiftEndTime&&(this._osGiftEndTime=o.getEndTime())}this._openServerGiftVoArr[i.time_index-1].addGift(i)}}},e.prototype.getOpenServerGiftVoArr=function(){return this._openServerGiftVoArr},e.prototype.getCurOpenServerGiftVo=function(t){void 0===t&&(t=!1);for(var e=0;e<this._openServerGiftVoArr.length;e++)if(this._openServerGiftVoArr[e].isActivityTime())return this._openServerGiftVoArr[e];return t&&0<this._openServerGiftVoArr.length?this._openServerGiftVoArr[this._openServerGiftVoArr.length-1]:null},e.prototype.getOsGiftStartTime=function(){return this._osGiftStartTime},e.prototype.getOsGiftEndTime=function(){return this._osGiftEndTime},e.prototype.hasOsGiftActivity=function(){var t=App.getServerTime();return this._osGiftStartTime<t&&t<this._osGiftEndTime},e.prototype.getOsGiftByRechargeid=function(t){for(var e=0;e<this._openServerGiftVoArr.length;e++)if(this._openServerGiftVoArr[e].isActivityTime())for(var i=this._openServerGiftVoArr[e].getGiftList(),n=0;n<i.length;n++)if(i[n].charge_id==t)return i[n];return null},e.prototype.init=function(){var t=TableData.getInstance().getTableByName(TableData.tb_openservice),e=Object.keys(t.data);this.allday=Number(e[e.length-1]),this._payList=[]},e.prototype.getList=function(){if(this._list)return this._list;this._list=new Array;for(var t=tb.TB_openservice.getTB_openservice(),e=0;e<t.length;e++){var i=new a.DayVo;i.tab=t[e],i.id=i.tab.ID,this._list.push(i)}return this._list},e.prototype.addpay=function(t){-1==this._payList.indexOf(t)&&this._payList.push(t)},e.prototype.delpay=function(t){var e=this._payList.indexOf(t);-1!=e&&this._payList.splice(e,1)},e.prototype.hasPay=function(t){return-1!=this._payList.indexOf(t)},e.prototype.visiableView=function(){var t=TableData.getInstance().getTableByName(TableData.tb_openservice),e=Object.keys(t.data);this.allday=Number(e[e.length-1]);for(var i=this.getList(),n=0;n<i.length;n++){var o=i[n];if(o.canBuy())return!0;if(o.isbuy()&&!o.isReceive())return!0}return!1},e.prototype.needtime=function(){return App.serverTime<App.hero.getCreateDayTiem()+TimeConst.ONE_DAY_MILSEC*e.getInstance().allday},e.prototype.onTime=function(){var t=App.hero.getCreateDayTiem()+TimeConst.ONE_DAY_MILSEC*e.getInstance().allday;return LanMgr.getLan("",12632)+activityTime(t/1e3,App.getServerTime())},e);function e(){this._osGiftStartTime=0,this._osGiftEndTime=0,this.initOpenServerGift()}a.OpenserverModel=t}(game=game||{}),function(t){var e=(i.prototype.canReceive=function(){var t=App.getServerTime()-App.hero.onlineEndTime;return(t+=App.hero.totalOnlineTime)>=this.needtime},i.prototype.isReceive=function(){return!!App.hero.welfare.hasOwnProperty("onlineTimeAward")&&!!App.hero.welfare.onlineTimeAward.hasOwnProperty(this.tab.ID)&&1==App.hero.welfare.onlineTimeAward[this.tab.ID]},i.prototype.onRedPoint=function(){return this.canReceive()&&!this.isReceive()},i.prototype.onTime=function(){var t=App.getServerTime()-App.hero.onlineEndTime;return(t+=App.hero.totalOnlineTime)>=this.needtime?"":GameUtil.toCountdown(Math.floor(this.needtime-t),"mm:ss",2)},i);function i(){}t.BoxVo=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.activity.online.itemIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){t?(this.ui_item.gray=this.img_receivebg.visible=t.isReceive(),this.ui_item.dataSource=new ItemVo(t.tab.reward[0],t.tab.reward[1]),e.OnlineModel.curId==t.id?this.lab_time.text=t.onTime():this.lab_time.text=this.ui_item.gray?"":t.canReceive()?LanMgr.getLan("",12242):t.tab.time+LanMgr.getLan("",10027),this.lab_time.color=t.canReceive()?"#ffe10a":"#ffffff",this.anim_select.visible=t.canReceive()&&!t.isReceive(),this.anim_select.play(),this.img_guang.visible=t.onRedPoint(),this.img_guang.visible?(this.img_guang.frameLoop(5,this,this.onLoop),this.on(Laya.Event.CLICK,this,this.onClick),this.ui_item.mouseEnabled=!1):(this.img_guang.clearTimer(this,this.onLoop),this.off(Laya.Event.CLICK,this,this.onClick),this.ui_item.mouseEnabled=!0)):(this.anim_select.gotoAndStop(0),this.ui_item.dataSource=null,this.img_guang.clearTimer(this,this.onLoop),this.off(Laya.Event.CLICK,this,this.onClick))},n.prototype.onLoop=function(){this.img_guang.rotation++},n.prototype.onClick=function(){dispatchEvt(new e.OnlineEvent(e.OnlineEvent.SEND_RECEIVE_EVENT),{id:this.dataSource.id,tabid:this.dataSource.tab.ID})},n);function n(){return t.call(this)||this}e.ItemIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var i,t=(i=ui.activity.online.mainPageUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},e.prototype.init=function(){n.OnlineModel.curId=999,this._lastid=-1;for(var t=n.OnlineModel.getInstance().getList(),e=0;e<t.length;e++){var i=t[e];i.canReceive()||(n.OnlineModel.curId=Math.min(n.OnlineModel.curId,i.id))}this.list_item.renderHandler=Handler.create(this,this.onItemRender,null,!1),this.list_item.dataSource=t,this.tickLoop()},e.prototype.onItemRender=function(t,e){t.anim_select.scale(.9,.9)},e.prototype.needTick=function(){for(var t=this.list_item.dataSource,e=0;e<t.length;e++)if(!t[e].canReceive())return!0;return!1},e.prototype.tickLoop=function(){this.needTick()?this.timerLoop(1e3,this,this.onLoop):(n.OnlineModel.curId=999,this.clearTimer(this,this.onLoop))},e.prototype.onLoop=function(){for(var t=-1,e=this.list_item.dataSource,i=0;i<e.length;i++)if(!e[i].canReceive()){t=i,n.OnlineModel.curId!=i&&(n.OnlineModel.curId=i),this.list_item.setItem(i,e[i]);break}t!=this._lastid&&(-1==this._lastid||this.updateLast(),this._lastid=t),this.tickLoop()},e.prototype.updateLast=function(){-1!=this._lastid&&this.list_item.setItem(this._lastid,this.list_item.dataSource[this._lastid])},e.prototype.updateItem=function(t){this.list_item.setItem(t,this.list_item.dataSource[t])},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.list_item.renderHandler&&(this.list_item.renderHandler.recover(),this.list_item.renderHandler=null),this.list_item.dataSource=null,this.clearTimer(this,this.onLoop)},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t}n.OnlineMainPage=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=tl3d.Processor,__extends(i,e),i.prototype.getName=function(){return"OnlineProcessor"},i.prototype.listenModuleEvents=function(){return[new r.OnlineEvent(r.OnlineEvent.SEND_RECEIVE_EVENT)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof r.OnlineEvent)switch(t.type){case r.OnlineEvent.SEND_RECEIVE_EVENT:this.sendReceiveEvent(t.data)}},i.prototype.sendReceiveEvent=function(o){var a=this,t={};t[Protocol.game_welfare_getOnlineAward.args.id]=o.tabid,PLC.request(Protocol.game_welfare_getOnlineAward,t,function(t,e){if(t){var i=App.hero.welfare;if(t.onlineTimeAward)for(var n in i.hasOwnProperty("onlineTimeAward")||(i.onlineTimeAward={}),t.onlineTimeAward)i.onlineTimeAward[n]=t.onlineTimeAward[n];t.commonData&&UIUtil.showRewardView(t.commonData),a.viewHasStage&&a.view.updateItem(o.id),dispatchEvt(new r.OnlineEvent(r.OnlineEvent.RED_CHANGE_EVENT))}})},Object.defineProperty(i.prototype,"view",{get:function(){return UIMgr.getUIByName(UIConst.OnLineReward)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewHasStage",{get:function(){return UIMgr.hasStage(UIConst.OnLineReward)},enumerable:!0,configurable:!0}),i);function i(){var t=e.call(this)||this;return t._model=r.OnlineModel.getInstance(),t}r.OnlineProcessor=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"OnlineModule"},n.prototype.listProcessors=function(){return[new t.OnlineProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.OnlineModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SEND_RECEIVE_EVENT="SEND_RECEIVE_EVENT",r.RED_CHANGE_EVENT="RED_CHANGE_EVENT",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.OnlineEvent=a}(game=game||{}),function(n){var t=(e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.getList=function(){if(this._list)return this._list;this._list=new Array;for(var t=tb.TB_online.getTB_share(),e=0;e<t.length;e++){var i=new n.BoxVo;i.id=e,i.tab=t[e],i.needtime=60*i.tab.time,this._list.push(i)}return this._list},e.prototype.visiableView=function(){for(var t=this.getList(),e=0;e<t.length;e++)if(!t[e].isReceive())return!0;return!1},e.prototype.lastItemState=function(){for(var t=this.getList(),e=0;e<t.length;e++){var i=t[e];if(!i.isReceive())return{istime:!i.canReceive(),vo:i}}return null},e);function e(){}n.OnlineModel=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.activity.notice.GameNoticeUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btnClose.off(Laya.Event.CLICK,this,this.onBtnClick)},n.prototype.onBtnClick=function(){this.dataSource.openFlag&&t.HuodongModel.getInstance().autoOpenLoginGift(),this.close()},n.prototype.initView=function(){this.isModelClose=!this.dataSource.openFlag,this.btnClose.on(Laya.Event.CLICK,this,this.onBtnClick),this.clearNotice();for(var t=0;t<this.NOTICE_INFOS.length;t++)this.addNotice(this.NOTICE_INFOS[t]);this.layout()},n.prototype.addNotice=function(t){if(t){var e=new ui.activity.notice.NoticeIRUI;e.img_show.skin=t.img,e.img_show.height=t.img_h,e.lab_content.text=t.content,e.lab_content.y=e.img_show.height+10,e.height=e.lab_content.y+e.lab_content.height+10,this._list.push(e),this.panel_list.addChild(e)}},n.prototype.clearNotice=function(){for(var t=0;t<this._list.length;t++)this._list[t].destroy();this._list.length=0},n.prototype.layout=function(){for(var t=0,e=0;e<this._list.length;e++){var i=this._list[e];i.y=t,t+=i.height}},n.noticeVersion="v1",n);function n(){var t=i.call(this)||this;return t._list=[],t.panel_list.vScrollBarSkin="",t.NOTICE_INFOS=[{img:"huodong/gonggao1.jpg",img_h:224,content:LanMgr.getLan("",20021)},{img:"huodong/gonggao2.jpg",img_h:224,content:LanMgr.getLan("",20022)}],t}t.GameNoticeView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.activity.logingift.logingiftUI,__extends(o,n),o.prototype.createChildren=function(){n.prototype.createChildren.call(this),this._uiDayArr=[];for(var t=0;t<o.DAY_NUM;t++)this._uiDayArr[t]=this["ui_day_"+t];for(this._uiItemArr=[],t=0;t<o.ITEM_NUM;t++)this._uiItemArr[t]=this["ui_item_"+t]},o.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},o.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},o.prototype.onClosed=function(){if(n.prototype.onClosed.call(this),this._uiDayArr)for(var t=0;t<this._uiDayArr.length;t++)this._uiDayArr[t].off(Laya.Event.CLICK,this,this.onClickDay);for(this.btn_receive.off(Laya.Event.CLICK,this,this.onClickReceive),tl3d.ModuleEventManager.removeEvent(i.HuodongEvent.TOTAL_LOGIN_DAY,this.onLoginDayChange,this),tl3d.ModuleEventManager.removeEvent(i.HuodongEvent.LOGIN_GIFT_RECEIVE,this.onReceiveChange,this),t=0;t<this._uiItemArr.length;t++)this._uiItemArr[t].dataSource=null;i.HuodongModel.getInstance().checkOpenLoginGift()},o.prototype.initView=function(){this._type=this.dataSource?this.dataSource:o.TYPE_ONE,this._firstDay=(this._type-1)*tb.TB_sevendays.TYPE_DAYS+1;for(var t=0;t<this._uiDayArr.length;t++)this._uiDayArr[t].on(Laya.Event.CLICK,this,this.onClickDay,[t]);this.btn_receive.on(Laya.Event.CLICK,this,this.onClickReceive),tl3d.ModuleEventManager.addEvent(i.HuodongEvent.TOTAL_LOGIN_DAY,this.onLoginDayChange,this),tl3d.ModuleEventManager.addEvent(i.HuodongEvent.LOGIN_GIFT_RECEIVE,this.onReceiveChange,this),this.updateTitleImg(),this.initDay();var e=this.getCanReceiveIdx();this.setSelectIdx(e)},o.prototype.onLoginDayChange=function(){this.updateTitleImg(),this.updateReceiveBtn(),this.updateDay()},o.prototype.onReceiveChange=function(){this.updateDay();var t=this.getCanReceiveIdx();this.setSelectIdx(t)},o.prototype.updateTitleImg=function(){var t="",e=this._curIdx+this._firstDay;t=this._type==o.TYPE_ONE?e<=2?"2tian":e<=3?"3tian":"7tian":e<=10?"10tian":"14tian",this.img_title.skin=LanMgr.getLan("huodong/logingift/{0}.png",-1,t)},o.prototype.initDay=function(){for(var t=0;t<this._uiDayArr.length;t++){var e=this._uiDayArr[t];e.img_icon.skin=LanMgr.getLan("huodong/logingift/{0}.png",-1,this.getDayIcon(this._firstDay+t)),e.lab_day.text=LanMgr.getLan("第{0}天",-1,this._firstDay+t)}this.updateDay()},o.prototype.updateDay=function(){for(var t=App.hero.welfare.totalLoginDay,e=0;e<this._uiDayArr.length;e++){var i=this._uiDayArr[e],n=this._firstDay+e;i.img_gou.visible=this.isReceive(this._firstDay+e),i.img_red.visible=n<=t&&!this.isReceive(n)}},o.prototype.setSelectIdx=function(t){t<0?t=0:t>=this._uiDayArr.length&&(t=this._uiDayArr.length-1),this._curIdx=t;for(var e=0;e<this._uiDayArr.length;e++)this._uiDayArr[e].img_select.visible=this._curIdx==e;var i=this._firstDay+this._curIdx;this.lab_day.text=i+"";var n=tb.TB_sevendays.get_TB_sevendaysById(i);if(n)for(e=0;e<this._uiItemArr.length;e++){var o=this._uiItemArr[e];if(e<n.reward.length){var a=new ItemVo(n.reward[e][0],n.reward[e][1]);o.dataSource=a}else o.dataSource=null}this.updateReceiveBtn(),this.updateTitleImg()},o.prototype.updateReceiveBtn=function(){var t=App.hero.welfare.totalLoginDay,e=this._firstDay+this._curIdx;t<e?(this.btn_receive.label="未达到",this.btn_receive.gray=!0,this.img_red.visible=!1):this.isReceive(e)?(this.btn_receive.label="已领取",this.btn_receive.gray=!0,this.img_red.visible=!1):(this.btn_receive.label="领取",this.btn_receive.gray=!1,this.img_red.visible=!0)},o.prototype.onClickDay=function(t){this._curIdx!=t&&this.setSelectIdx(t)},o.prototype.onClickReceive=function(){if(this.btn_receive.gray)"已领取"==this.btn_receive.label?showToast(LanMgr.getLan("",10220)):showToast(LanMgr.getLan("",10227));else{var t=this._firstDay+this._curIdx,e={};e[Protocol.game_welfare_loginGiftPack.args.id]=t,PLC.request(Protocol.game_welfare_loginGiftPack,e,function(t,e){t&&UIUtil.showRewardView(t.commonData)})}},o.prototype.getCanReceiveIdx=function(){for(var t=App.hero.welfare.totalLoginDay,e=0;e<this._uiDayArr.length;e++){var i=this._firstDay+e;if(t<i)return e;if(!this.isReceive(i))return e}return this._uiDayArr.length-1},o.prototype.isReceive=function(t){return App.hero.welfare.loginGiftPack.hasOwnProperty(t)},o.prototype.getDayIcon=function(t){return 9==t?4:11==t?6:14==t?7:t},o.TYPE_ONE=1,o.TYPE_TWO=2,o.DAY_NUM=7,o.ITEM_NUM=4,o);function o(){var t=n.call(this)||this;return t.isModelClose=!0,t}i.LoginGiftView=t}(game=game||{}),function(n){var t=(e.prototype.getFreeCount=function(){return this.tbSummonTime.free_num},e.prototype.getBuyCost=function(){return this.tbSummonTime.buy_cost},e.prototype.getModelID=function(){return this.tbSummonTime.model_show},e.prototype.getRankScoreByRank=function(t){for(var e=0,i=this.tbSummonRank;e<i.length;e++){var n=i[e];if(n.rank[0]<=t&&n.rank[1]>=t)return n.score}return 0},e.prototype.isinTime=function(){if(0==this.type)return!0;if(1==this.type){if(new Date(this.tbSummonTime.time[1]).getTime()/1e3>App.serverTimeSecond)return!0}else if(2==this.type&&Number(this.tbSummonTime.time[1])*TimeConst.ONE_DAY_SEC+App.getOpenServerTime()>App.serverTimeSecond)return!0;return!1},e.prototype.getRemainTime=function(){return this.isinTime()?"剩余时间："+this._model.getSummonRemainTime(this.tbSummonTime.ID):"活动已结束"},e);function e(t,e,i){this.type=t.type,this.tbSummonTime=t,this.tbSummonBox=i.sort(function(t,e){return t.score-e.score}),this.tbSummonRank=e.sort(function(t,e){return t.score-e.score}),this._model=n.LimiteBuyModel.getInstance()}n.limiteSummonVo=t;var i=(o.prototype.isinTime=function(){var t=tb.TB_group_buying_time.TB_group_buying_timeById(this.type);if(0==t.type)return!0;if(1==t.type){if(new Date(t.time[1]).getTime()/1e3>App.serverTimeSecond)return!0}else if(2==t.type&&Number(t.time[1])*TimeConst.ONE_DAY_SEC+App.getOpenServerTime()>App.serverTimeSecond)return!0;return!1},o.prototype.getRemainTime=function(){return this.isinTime&&this.tbGroup?"剩余时间："+this._model.getGroupRemainTime(this.tbGroup.type):"活动已结束"},o.prototype.getZheKouCount=function(){var t=this._model.getgrpBuyTotalNums(this.tbGroup.ID);return 0<t?t<this.tbGroup.total_buy_num[0]?0:t>=this.tbGroup.total_buy_num[0]&&t<this.tbGroup.total_buy_num[1]?1:t>=this.tbGroup.total_buy_num[1]&&t<this.tbGroup.total_buy_num[2]?2:t>=this.tbGroup.total_buy_num[2]&&t<this.tbGroup.total_buy_num[3]?3:t>=this.tbGroup.total_buy_num[3]?4:void 0:0},o.prototype.getCurZheKouList=function(){return[this.tbGroup.price[this.getZheKouCount()],this.tbGroup.discount_show[this.getZheKouCount()]]},o.prototype.getZheKouList=function(){var t=[],e=this.tbGroup;t.push([e.discount_show[0],0]);for(var i=1;i<e.discount_show.length;i++)t.push([e.discount_show[i],e.total_buy_num[i-1]]);return t},o.prototype.getAllBuyNum=function(){return this._model.getgrpBuyTotalNums(this.tbGroup.ID)},o.prototype.getBuyNum=function(){return this._model.getgrpBuyTodayNums(this.tbGroup.ID)},o.prototype.getRemainNum=function(){var t=this._model.getgrpBuyTodayNums(this.tbGroup.ID);return this.tbGroup.buy_num-t},o);function o(t){this.tbGroup=t,this.type=t.type,this._model=n.LimiteBuyModel.getInstance()}n.limiteGroupVo=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var o,t=(o=ui.activity.limitebuy.LimiteBuyUI,__extends(e,o),e.prototype.show=function(t,e){o.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){o.prototype.popup.call(this,t,e),this.initView()},e.prototype.close=function(t,e,i){this.list_tab.array=null,this._view_summon&&(this._view_summon.uiScene.onExit(),this._view_summon.dataSource=null,Laya.timer.clearAll(this._view_summon)),this._view_group&&(Laya.timer.clearAll(this._view_group),this._view_group.dataSource=null),o.prototype.close.call(this,t,e,i)},e.prototype.initView=function(){this._tabTypes=[];var t=n.LimiteBuyModel.getInstance();t.isOpenLimiteSummon()?(t.isOpenLimiteGroup()?this._tabTypes=[n.LimiteBuyType.summon,n.LimiteBuyType.group]:this._tabTypes=[n.LimiteBuyType.summon],this.list_tab.array=this._tabTypes):t.isOpenLimiteGroup()?(this._tabTypes=[n.LimiteBuyType.group],this.list_tab.array=this._tabTypes):(this.list_tab.array=null,UIMgr.getUIByName(UIConst.LimiteBuyView)&&(UIMgr.hideUIByName(UIConst.LimiteBuyView),showToast(LanMgr.getLan("",10223)))),this.list_tab.selectedIndex=0,this.onTabSelect(0)},e.prototype.onTabSelect=function(t){if(-1!=t&&this._tabTypes&&0!=this._tabTypes.length){var e=this._tabTypes[t],i=n.LimiteBuyModel.getInstance();this._view_summon&&this._view_summon.removeSelf(),this._view_group&&this._view_group.removeSelf(),e==n.LimiteBuyType.summon?(this._view_summon||(this._view_summon=new n.TabSummon,this._view_summon.x=31,this._view_summon.y=228),this.setViewSummonData(i.getCurSummonList()),this.addChild(this._view_summon),i.Lim_Summon_Rp=!1):e==n.LimiteBuyType.group?(this._view_group||(this._view_group=new n.TabGroup,this._view_group.x=19,this._view_group.y=229),this.setViewGroupData(i.getCurGroupList()),this.addChild(this._view_group),i.Lim_Group_Rp=!1):UIMgr.hideUIByName(UIConst.LimiteBuyView),this.list_tab.refresh(),dispatchEvt(new n.LimiteBuyEvent(n.LimiteBuyEvent.UPDATE_RP))}},e.prototype.setViewGroupData=function(t){this._view_group&&(this._view_group.dataSource=t)},e.prototype.setViewSummonData=function(t){this._view_summon&&(this._view_summon.dataSource=t)},e);function e(){var t=o.call(this)||this;return t.isModelClose=!0,t.bgPanel.dataSource={closeOnSide:t.isModelClose,closeOnButton:!0,title:"限时热购"},t.list_tab.selectHandler=new Handler(t,t.onTabSelect),t}n.LimiteBuyView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var n,e=(n=ui.activity.limitebuy.JiangLiUI,__extends(i,n),i.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},i.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},i.prototype.close=function(t,e,i){n.prototype.close.call(this,t,e,i)},i.prototype.onClosed=function(){n.prototype.onClosed.call(this)},i.prototype.initView=function(){this.bgPanel.dataSource={closeOnSide:this.isModelClose,closeOnButton:!0,title:"排名奖励"},this.list_jiangli.array=this.dataSource},i);function i(){var t=n.call(this)||this;return t.isModelClose=!0,t}t.JiangLiView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.activity.limitebuy.tab.TabSummonUI,__extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._baoxiangList=[];for(var t=1;t<=4;t++)this._baoxiangList.push(this["item"+t]);this.uiScene=new Base2dSceneLayer,this.addChild(this.uiScene)},Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.dataSource&&(this.initData(),Laya.timer.loop(1e4,this,this.refresh))},enumerable:!0,configurable:!0}),n.prototype.initData=function(){var t=this.dataSource;this.lb_time.text=t.getRemainTime();var e=tb.TB_god.get_TB_godById(t.tbSummonTime.model_show);this.lb_name.text=e.name,this.list_starts.repeatX=e.star[0],this.uiScene.onShow(),Laya.timer.once(400,this,this.delayShow,[e]);var i=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.summonFreeNum);0<t.getFreeCount()-i?(this.img_cost.visible=!1,this.lb_costone.text="免费",this.img_redpoint.visible=!0):(this.img_cost.visible=!0,this.lb_costone.text=t.getBuyCost()[0]+"",this.img_redpoint.visible=!1),this.lb_costten.text=t.getBuyCost()[1]+"";var n=10-App.hero.summonScore%100/10;this.lb_cishu.text="还有"+n+"次必出四星";var o=t.tbSummonBox[t.tbSummonBox.length-1];if(o){for(var a=o.score,r=0;r<this._baoxiangList.length;r++){var s=t.tbSummonBox[r],u=this._baoxiangList[r];u.dataSource=s,u.img_baoxiang.on(Laya.Event.CLICK,this,this.reward,[r]),u.x=s.score/a*this.img_progress.width,s.score>a/2?u.y=(a-s.score)/(a/2)*this.img_progress.height+this.img_progress.y+20:u.y=s.score/(a/2)*this.img_progress.height+this.img_progress.y+20,3==r&&(u.x=570,u.y=584)}var h=App.hero.summonScore/a;this._probarmask||(this._probarmask=new Laya.Sprite),this.img_progress.mask=this._probarmask,this._probarmask.graphics.clear(),this._probarmask.graphics.drawRect(0,0,this.img_progress.width*h,this.img_progress.height,"#ff0000","#00ff00",0)}this.box_btn_more.y=200,this.list_rank.repeatY=4,this.img_more.rotation=90,this.img_more.y=218,this.img_di.height=230,this.img_moredi.y=200,this.lb_more.y=200,this.lb_more.text="查看更多排行",this.doRequest()},n.prototype.delayShow=function(t){this.uiScene.addModelChar(String(t.model),this.box_model.x+55,this.box_model.y+315,180,2),this.uiScene.sceneChar.play(tl3d.CharAction.ATTACK_02,2)},n.prototype.doRequest=function(){var o=this;PLC.request(Protocol.center_activity_getSummonRankList,{},function(t){if(t){var e=[];if(o.dataSource){for(var i=1;i<=10;i++)t.summonRankList[i]?e.push([i,o.dataSource.getRankScoreByRank(i),t.summonRankList[i]]):e.push([i,o.dataSource.getRankScoreByRank(i)]);o.list_rank.array=e;var n=0==t.mySummonRank?"未上榜":t.mySummonRank;o.lb_mymess.text="我的积分："+App.hero.summonScore+"    我的排名："+n}}})},n.prototype.refresh=function(){this.lb_time.text=this.dataSource.getRemainTime(),this.doRequest()},n.prototype.jiangli=function(){var t=this.dataSource.tbSummonRank;t.sort(function(t,e){return t.ID-e.ID}),dispatchEvt(new i.LimiteBuyEvent(i.LimiteBuyEvent.SHOW_RANK_VIEW),t)},n.prototype.moreRank=function(){90==this.img_more.rotation?(this.box_btn_more.y+=150,this.list_rank.repeatY=9,this.img_more.rotation=270,this.img_more.y+=150,this.img_di.height+=150,this.img_moredi.y+=150,this.lb_more.y+=150,this.lb_more.text="返回"):(this.box_btn_more.y-=150,this.list_rank.repeatY=4,this.img_more.rotation=90,this.img_more.y-=150,this.img_di.height-=150,this.img_moredi.y-=150,this.lb_more.y-=150,this.lb_more.text="查看更多排名")},n.prototype.reward=function(t){if(App.hero.summonScore>=this.dataSource.tbSummonBox[t].score&&!i.LimiteBuyModel.getInstance().isReward(this.dataSource.tbSummonBox[t].ID))dispatchEvt(new i.LimiteBuyEvent(i.LimiteBuyEvent.LIMITESUMMON_REWARD),this.dataSource.tbSummonBox[t].ID);else{var e=[];this.dataSource.tbSummonBox[t].reward.forEach(function(t){e.push(new ItemVo(Number(t[0]),Number(t[1])))}),UIMgr.showUI(UIConst.ManyItemsTip,{data:e})}},n.prototype.buy=function(t){1==t?dispatchEvt(new i.LimiteBuyEvent(i.LimiteBuyEvent.LIMITESUMMON_BUY),{summonId:1,num:0}):10==t&&dispatchEvt(new i.LimiteBuyEvent(i.LimiteBuyEvent.LIMITESUMMON_BUY),{summonId:2,num:1})},n);function n(){var t=e.call(this)||this;return t.btn_shuaxin.on(Laya.Event.CLICK,t,t.refresh),t.btn_jiangli.on(Laya.Event.CLICK,t,t.jiangli),t.btn_buyone.on(Laya.Event.CLICK,t,t.buy,[1]),t.btn_buyten.on(Laya.Event.CLICK,t,t.buy,[10]),t.box_btn_more.on(Laya.Event.CLICK,t,t.moreRank),t}i.TabSummon=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.limitebuy.tab.TabGroupUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.initData()},enumerable:!0,configurable:!0}),n.prototype.initData=function(){var t=this.dataSource;if(t){for(var e=[],i=0,n=t;i<n.length;i++){var o=n[i],a=new ItemVo(o.tbGroup.item[0],o.tbGroup.item[1]);a.show=!1,e.push(a)}this.list_item.array=e,this.list_item.selectedIndex<0&&(this.list_item.selectedIndex=0),this.onSelect(this.list_item.selectedIndex),Laya.timer.loop(6e4,this,this.Timer)}else this.list_item.selectedIndex=-1},n.prototype.onSelect=function(t){if(!(t<0)){this.list_item.selectedIndex=t,this._curIndex=t;var e=this.dataSource[t];if(e){this.lb_time.text=e.getRemainTime(),this.lb_buy.text=LanMgr.getLan("今日可购买{0}次",-1,e.getRemainNum()),this.lb_allbuy.text=LanMgr.getLan("全服已购买{0}次",-1,e.getAllBuyNum()),this.lb_cost.text=e.getCurZheKouList()[0]+"",this.list_zhekou.array=e.getZheKouList();var i=e.getAllBuyNum()/e.tbGroup.total_buy_num[e.tbGroup.total_buy_num.length-1];this.pg_zhekou.value=i,this.view_item.dataSource=new ItemVo(e.tbGroup.item[0],e.tbGroup.item[1])}}},n.prototype.Timer=function(){var t=this.dataSource[this._curIndex];this.lb_time.text=t.getRemainTime()},n.prototype.onClick=function(){dispatchEvt(new t.LimiteBuyEvent(t.LimiteBuyEvent.LIMITEGROUP_BUY),this.dataSource[this._curIndex])},n);function n(){var t=e.call(this)||this;return t.list_item.selectHandler=new Handler(t,t.onSelect),t.btn_buy.on(Laya.Event.CLICK,t,t.onClick),t}t.TabGroup=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.limitebuy.render.ZheKouIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this._dataSource;t&&(7<=t[0]?(this.lb_zhe.color="#e691f6",this.lb_zhe.color=ColorConst.getLimiteBuyZheKouColor(1),this.lb_zhe.stroke=2,this.lb_zhe.strokeColor="#830072",this.lb_zhe.strokeColor=ColorConst.getLimiteBuyZheKouColor(2)):(this.lb_zhe.color=ColorConst.getLimiteBuyZheKouColor(3),this.lb_zhe.stroke=2,this.lb_zhe.strokeColor=ColorConst.getLimiteBuyZheKouColor(4)),this.lb_zhe.text=t[0]+"折",0==t[1]?this.lb_num.text="":this.lb_num.text=t[1]+"")},n);function n(){return e.call(this)||this}t.ZheKouIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.box.TabIR2UI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this._dataSource;if(t){var e=i.LimiteBuyModel.getInstance();t==i.LimiteBuyType.summon?(this.btn_tab.skin=SkinUtil.lim_summon,e.Lim_Summon_Rp||e.haveBoxReward()||e.haveFreeTimes()?this.redpoint.visible=!0:this.redpoint.visible=!1):t==i.LimiteBuyType.group&&(this.btn_tab.skin=SkinUtil.lim_group,e.Lim_Group_Rp?this.redpoint.visible=!0:this.redpoint.visible=!1)}},n);function n(){return t.call(this)||this}i.LbTabIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var t,e=(t=ui.activity.limitebuy.render.ScoreIRUI,__extends(n,t),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;if(t){var e=i.LimiteBuyModel.getInstance();e.isReward(t.ID)?(this.img_baoxiang.skin=SkinUtil.getTaskBaoxiang(4,!0),this.img_guang.visible=!1,this.img_redpoint.visible=!1,Laya.timer.clearAll(this)):e.isCanReward(t.ID)?(this.img_baoxiang.skin=SkinUtil.getTaskBaoxiang(4,!1),this.img_guang.visible=!0,this.img_redpoint.visible=!0,Laya.timer.loop(50,this,this.guangxiao)):(this.img_baoxiang.skin=SkinUtil.getTaskBaoxiang(4,!1),this.img_guang.visible=!1,this.img_redpoint.visible=!1,Laya.timer.clearAll(this)),this.lb_costscore.text=t.score+""}else this.img_baoxiang.skin=SkinUtil.getTaskBaoxiang(4,!0),this.img_guang.visible=!1,this.lb_costscore.text="",Laya.timer.clearAll(this)},n.prototype.guangxiao=function(){this.img_guang.rotation+=5},n);function n(){return t.call(this)||this}i.ScoreIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.limitebuy.render.RankIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;this.lb_rank.text=t[0],t[2]?(this.lb_name.text=t[2][2],this.lb_score.text=t[2][1]):(this.lb_name.text="虚位以待",this.lb_score.text=0==t[1]?"":"大于"+t[1])},n);function n(){return e.call(this)||this}t.LbRankIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.limitebuy.render.JiangliIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t&&(t.rank[0]==t.rank[1]?(this.img_first.visible=!0,this.lb_rank.visible=!1):(this.img_first.visible=!1,this.lb_rank.visible=!0,this.lb_rank.text=t.rank[0]+"-"+t.rank[1]),this.lb_score.text=t.score+"分",this.list_items.array=[new ItemVo(t.reward[0][0],t.reward[0][1])])},n);function n(){return e.call(this)||this}t.JiangliIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.limitebuy.render.ItemSelectBoxUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t?(this.ui_item.dataSource=t,this.anim_select.play()):(this.ui_item.dataSource=null,this.anim_select.gotoAndStop(0))},n);function n(){return e.call(this)||this}t.ItemSelectBox=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"LimiteBuyProcessor"},i.prototype.listenModuleEvents=function(){return[new a.LimiteBuyEvent(a.LimiteBuyEvent.SHOW_LIMITEBUY_VIEW),new a.LimiteBuyEvent(a.LimiteBuyEvent.LIMITESUMMON_BUY),new a.LimiteBuyEvent(a.LimiteBuyEvent.LIMITESUMMON_REWARD),new a.LimiteBuyEvent(a.LimiteBuyEvent.SHOW_RANK_VIEW),new a.LimiteBuyEvent(a.LimiteBuyEvent.LIMITEGROUP_BUY)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof a.LimiteBuyEvent)switch(t.type){case a.LimiteBuyEvent.SHOW_LIMITEBUY_VIEW:this.showMainView();break;case a.LimiteBuyEvent.LIMITESUMMON_BUY:this.limiteSummonBuy(t.data);break;case a.LimiteBuyEvent.LIMITEGROUP_BUY:this.limiteGroupBuy(t.data);break;case a.LimiteBuyEvent.LIMITESUMMON_REWARD:this.rewardBox(t.data);break;case a.LimiteBuyEvent.SHOW_RANK_VIEW:this.showRankJiangliView(t.data)}},i.prototype.showMainView=function(){var e=a.LimiteBuyModel.getInstance(),t=e.isOpenLimiteGroup(),i=e.isOpenLimiteSummon();t||i?t?PLC.request(Protocol.game_activity_getGroupBuyInfo,null,function(t){t&&(e.grpBuyTodayNums=t.grpBuyTodayNums,e.grpBuyTotalNums=t.grpBuyTotalNums,UIMgr.showUI(UIConst.LimiteBuyView))}):UIMgr.showUI(UIConst.LimiteBuyView):showToast(LanMgr.getLan("",10223))},i.prototype.limiteGroupBuy=function(t){if(t.isinTime()){if(t.getRemainNum()<=0)showToast(LanMgr.getLan("",10225));else if(!UIUtil.checkNotEnough(iface.tb_prop.resTypeKey.diamond,t.getCurZheKouList()[0])){var n=a.LimiteBuyModel.getInstance(),e={};e[Protocol.game_activity_groupBuy.args.tpltId]=t.tbGroup.ID,PLC.request(Protocol.game_activity_groupBuy,e,function(t){if(t){for(var e in t.grpBuyTodayNums)n.grpBuyTodayNums[e]=t.grpBuyTodayNums[e];for(var e in t.grpBuyTotalNums)n.grpBuyTotalNums[e]=t.grpBuyTotalNums[e];var i=UIMgr.getUIByName(UIConst.LimiteBuyView);i&&i.setViewGroupData(n.getCurGroupList()),UIUtil.showRewardView(t.commonData)}})}}else showToast(LanMgr.getLan("",10224))},i.prototype.limiteSummonBuy=function(t){var i=a.LimiteBuyModel.getInstance();if(i.getCurSummonList().isinTime()){var e=0==t.num?1:10;if(App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum)<=a.GodUtils.getGodsNum()+e){var n=LanMgr.getLan("",10226);common.AlertBox.showAlert({text:n,confirmCb:function(){dispatchEvt(new a.FenjieEvent(a.FenjieEvent.SHOW_FENJIE_VIEW)),UIMgr.getUIByName(UIConst.LimiteBuyView),UIMgr.hasStage(UIConst.LimiteBuyView)&&UIMgr.hideUIByName(UIConst.LimiteBuyView)}})}else if(i.haveFreeTimes()||!UIUtil.checkNotEnough(iface.tb_prop.resTypeKey.diamond,i.getCurSummonList().getBuyCost()[t.num])){var o={};o[Protocol.game_activity_summonBuy.args.type]=Number(t.summonId),PLC.request(Protocol.game_activity_summonBuy,o,function(t){if(t){var e=UIMgr.getUIByName(UIConst.LimiteBuyView);e&&(e.setViewSummonData(i.getCurSummonList()),e.list_tab.refresh()),dispatchEvt(new a.LimiteBuyEvent(a.LimiteBuyEvent.UPDATE_RP)),UIUtil.showRewardView(t.commonData)}})}}else showToast(LanMgr.getLan("",10224))},i.prototype.rewardBox=function(t){var e={};e[Protocol.game_activity_getSummonChests.args.id]=t,PLC.request(Protocol.game_activity_getSummonChests,e,function(t){if(t){UIUtil.showRewardView(t.commonData);var e=UIMgr.getUIByName(UIConst.LimiteBuyView);e&&(e.setViewSummonData(a.LimiteBuyModel.getInstance().getCurSummonList()),e.list_tab.refresh()),dispatchEvt(new a.LimiteBuyEvent(a.LimiteBuyEvent.UPDATE_RP))}})},i.prototype.showRankJiangliView=function(t){UIMgr.showUI(UIConst.Lim_JiangLiView,t)},i);function i(){return t.call(this)||this}a.LimiteBuyProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"LimiteBuyModule"},n.prototype.listProcessors=function(){return[new t.LimiteBuyProcessor]},n.prototype.onRegister=function(){t.LimiteBuyModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.LimiteBuyModule=i;var o,a,r=(o=tl3d.BaseEvent,__extends(s,o),s.UPDATE_RP="UPDATE_RP",s.SHOW_LIMITEBUY_VIEW="SHOW_SUMMON_VIEW",s.LIMITEGROUP_BUY="LIMITEGROUP_BUY",s.UPDATE_LIMITEGROUPDATA="UPDATE_LIMITEGROUPDATA",s.LIMITESUMMON_BUY="LIMITESUMMON_BUY",s.LIMITESUMMON_REWARD="LIMITESUMMON_REWARD",s.SHOW_RANK_VIEW="SHOW_RANK_VIEW",s);function s(t,e){void 0===e&&(e=null);var i=o.call(this,t)||this;return i.data=e,i}t.LimiteBuyEvent=r,(a=t.TabType||(t.TabType={}))[a.summon=0]="summon",a[a.group=1]="group"}(game=game||{}),function(s){var t;(t=s.LimiteBuyType||(s.LimiteBuyType={}))[t.summon=1]="summon",t[t.group=2]="group";var e=(i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.getgrpBuyTodayNums=function(t){return this.grpBuyTodayNums[t]||0},i.prototype.getgrpBuyTotalNums=function(t){return this.grpBuyTotalNums[t]||0},i.prototype.initModel=function(){this.type=this.getCurSummonType(),this.CurGroupType=this.getCurGroupType(),this.Lim_Group_Rp=!!this.isOpenLimiteGroup(),this.Lim_Summon_Rp=!!this.isOpenLimiteSummon(),dispatchEvt(new s.LimiteBuyEvent(s.LimiteBuyEvent.UPDATE_RP))},i.prototype.isOpen=function(){return this.isOpenLimiteGroup()||this.isOpenLimiteSummon()},i.prototype.isVisible=function(){return this.isOpen()&&(this.Lim_Group_Rp||this.Lim_Summon_Rp||this.haveBoxReward()||this.haveFreeTimes())},i.prototype.isOpenLimiteSummon=function(){return null!=this.getCurSummonType()},i.prototype.getCurSummonType=function(){for(var t=[],e=tb.TB_limit_time.get_TB_limit_time(),i=App.getServerTime(),n=App.getOpenServerTime(),o=0,a=e;o<a.length;o++){var r=a[o];if(0!=r.type){if(1==r.type){var s=(h=new Date(r.time[0])).getTime(),u=new Date(r.time[1]).getTime();if(s<App.serverTime&&u>App.serverTime){t.push(r.ID);continue}}else if(2==r.type){var h=Number(r.time[0])-1;if(i<n+Number(r.time[1])*TimeConst.ONE_DAY_SEC&&i>=n+h*TimeConst.ONE_DAY_SEC){t.push(r.ID);continue}}}else t.push(r.ID)}return t[0]},i.prototype.getCurSummonSetList=function(){this.type||(this.type=this.getCurSummonType());var t=tb.TB_limit_time.get_TB_limit_timeById(this.type);return t||((t=new tb.TB_limit_time).ID=0,t.type=0,t.time=new Array,t.free_num=0,t.buy_cost=new Array,t.guaranteed_num=0,t.buy_cost=new Array,t.model_show=0,logdebug("TB_limit_time 为空",this,this.type)),t},i.prototype.getCurSummonRankList=function(){return this.type||(this.type=this.getCurSummonType()),tb.TB_summon_rank.get_TB_summon_rankByType(this.type)},i.prototype.getCurSummonBoxList=function(){return this.type||(this.type=this.getCurSummonType()),tb.TB_summon_box.get_TB_summon_boxByType(this.type)},i.prototype.getCurSummonList=function(){return new s.limiteSummonVo(this.getCurSummonSetList(),this.getCurSummonRankList(),this.getCurSummonBoxList())},i.prototype.getSummonRemainTime=function(t){var e=tb.TB_limit_time.get_TB_limit_timeById(t);return e&&1==e.type?activityTime(new Date(e.time[1]).getTime()/1e3,App.serverTimeSecond):e&&2==e.type?activityTime(Number(e.time[1])*TimeConst.ONE_DAY_SEC+App.getOpenServerTime(),App.serverTimeSecond):""},i.prototype.isCanReward=function(t){return!this.isReward(t)&&tb.TB_summon_box.get_TB_summon_boxById(t).score<=App.hero.summonScore},i.prototype.isReward=function(t){return-1!=App.hero.doneSummonChests.indexOf(t)},i.prototype.haveFreeTimes=function(){var t=this.getCurSummonSetList(),e=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.summonFreeNum);return 0<t.free_num-e},i.prototype.haveBoxReward=function(){for(var t=0,e=this.getCurSummonBoxList();t<e.length;t++){var i=e[t];if(this.isCanReward(i.ID))return!0}return!1},i.prototype.isOpenLimiteGroup=function(){return 0!=this.getCurGroupType().length},i.prototype.getCurGroupType=function(){for(var t=[],e=tb.TB_group_buying_time.get_TB_group_buying_time(),i=App.getServerTime(),n=App.getOpenServerTime(),o=0,a=e;o<a.length;o++){var r=a[o];if(0!=r.type){if(1==r.type){var s=(h=new Date(r.time[0])).getTime(),u=new Date(r.time[1]).getTime();if(s<App.serverTime&&u>App.serverTime){t.push(r.ID);continue}}else if(2==r.type){var h=Number(r.time[0])-1;if(i<n+Number(r.time[1])*TimeConst.ONE_DAY_SEC&&i>=n+h*TimeConst.ONE_DAY_SEC){t.push(r.ID);continue}}}else t.push(r.ID)}return t},i.prototype.getCurGroupList=function(){for(var t=[],e=this.CurGroupType?this.CurGroupType:this.getCurGroupType(),i=0,n=tb.TB_group_buying.get_TB_group_buying();i<n.length;i++)for(var o=n[i],a=0,r=e;a<r.length;a++)r[a]==o.type&&t.push(new s.limiteGroupVo(o));return t},i.prototype.getGroupRemainTime=function(t){var e=tb.TB_group_buying_time.get_TB_group_buying_time();for(var i in e)if(e[i].ID==t)return 1!=e[i].type?2!=e[i].type?"":activityTime(Number(e[i].time[1])*TimeConst.ONE_DAY_SEC+App.getOpenServerTime(),App.serverTimeSecond):activityTime(new Date(e[i].time[1]).getTime()/1e3,App.serverTimeSecond);return""},i);function i(){this.grpBuyTodayNums=null,this.grpBuyTotalNums=null}s.LimiteBuyModel=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var n,t=(n=ui.activity.huodong.welfare.welfareUI,__extends(e,n),e.prototype.show=function(t,e){n.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){this.bgPanel.dataSource={uiName:UIConst.WelfareView,closeOnSide:this.isModelClose,closeOnButton:!0,title:"福利大厅"},this._selectTabNum=0,this.list_btn.array=i.HuodongModel.getInstance().welfareTabItemLabel;var t=!isNaN(this.dataSource)&&0<=this.dataSource?this.dataSource:0;this.list_btn.selectedIndex=t,this.onTabSelect(this.list_btn.selectedIndex),this.list_btn.scrollTo(0),this.btn_left.on(Laya.Event.CLICK,this,this.onLeft),this.btn_right.on(Laya.Event.CLICK,this,this.onRight),this.btnClose.on(Laya.Event.CLICK,this,this.close)},e.prototype.onTabRender=function(t,e){t.eff_select.visible=e==this._selectTabNum,e==this._selectTabNum?t.eff_select.play(0,!0):t.eff_select.stop()},e.prototype.onTabSelect=function(t){this._selectTabNum=t,this.hideAll();var e=this.list_btn.getItem(t);switch(e?e[0]:-1){case i.WelfareType.daySign:this._tosignView||(this._tosignView=new i.ToSignView,this._tosignView.x=29,this._tosignView.y=246),this.addChild(this._tosignView),this._tosignView.onAdd();break;case i.WelfareType.monthSign:this._signView||(this._signView=new i.SignView,this._signView.x=28,this._signView.y=272),this.addChild(this._signView),this._signView.onAdd();break;case i.WelfareType.xuyuan:this._xuyuanView||(this._xuyuanView=new i.XuyuanView,this._xuyuanView.x=30,this._xuyuanView.y=275),this.addChild(this._xuyuanView),this._xuyuanView.onAdd();break;case i.WelfareType.dengjiLibao:this._dengjiView||(this._dengjiView=new i.DengjiView,this._dengjiView.centerX=0,this._dengjiView.y=281),this.addChild(this._dengjiView),this._dengjiView.onAdd();break;case i.WelfareType.duihuan:this._duihuanView||(this._duihuanView=new i.DuihuanView,this._duihuanView.x=47,this._duihuanView.y=270),this.addChild(this._duihuanView),this._duihuanView.onAdd()}this.addChild(this.btnClose)},e.prototype.hideAll=function(){this._tosignView&&this._tosignView.parent&&(this._tosignView.onExit(),this._tosignView.removeSelf()),this._signView&&this._signView.parent&&(this._signView.onExit(),this._signView.removeSelf()),this._xuyuanView&&this._xuyuanView.parent&&(this._xuyuanView.onExit(),this._xuyuanView.removeSelf()),this._dengjiView&&this._dengjiView.parent&&(this._dengjiView.onExit(),this._dengjiView.removeSelf()),this._duihuanView&&this._duihuanView.parent&&(this._duihuanView.onExit(),this._duihuanView.removeSelf())},e.prototype.onLeft=function(){this.list_btn.selectedIndex-1<0||this.list_btn.scrollTo(--this.list_btn.selectedIndex)},e.prototype.onRight=function(){this.list_btn.selectedIndex+1>this.list_btn.array.length-1||this.list_btn.scrollTo(++this.list_btn.selectedIndex)},e.prototype.setwishNums=function(){this._xuyuanView&&this._xuyuanView.setwishNums()},e.prototype.startLucik=function(t,e){this._xuyuanView&&this._xuyuanView.startAction(t,e)},e.prototype.initSignViewData=function(){this._signView&&this._signView.initView()},e.prototype.initDengjiView=function(){this._dengjiView&&this._dengjiView.listRender()},e.prototype.onClosed=function(){n.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.btnClose.off(Laya.Event.CLICK,this,this.close),this.btn_left.off(Laya.Event.CLICK,this,this.onLeft),this.btn_right.off(Laya.Event.CLICK,this,this.onRight),this.hideAll()},e);function e(){var t=n.call(this)||this;return t.isModelClose=!0,t.list_btn.selectHandler=new Handler(t,t.onTabSelect),t.list_btn.renderHandler=new Handler(t,t.onTabRender),t}i.WelfareView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(s){var e,t=(e=ui.activity.huodong.welfare.tab.XuyuanUI,__extends(i,e),i.prototype.onAdd=function(){this.initView()},i.prototype.onExit=function(){this.close()},i.prototype.initView=function(){this.CalculationTimeDifference(),this.img_one.on(Laya.Event.CLICK,this,this.onXuyuan,[0]),this.img_ten.on(Laya.Event.CLICK,this,this.onXuyuan,[1]),this.chk_jump.on(Laya.Event.CHANGE,this,this.onJump),this.chk_jump.selected=this._IS_JUMP,this.btn_tip.on(Laya.Event.CLICK,this,this.onClickTip),Laya.timer.loop(1e3,this,this.CalculationTimeDifference),this.setwishNums(),Laya.timer.loop(1,this,this.updateAction)},i.prototype.onJump=function(){this._IS_JUMP=this.chk_jump.selected},i.prototype.initData=function(){var t=s.HuodongModel.getBoxTb(TURNTABLE.WISH);t.sort(function(t,e){return t.location-e.location});for(var e=0;e<t.length;e++){var i=this["item"+e];if(i){var n=new ItemVo(t[e].item[0],t[e].item[1]);n.isShowEff=1==t[e].is_show_effect,i.dataSource=n}}},i.prototype.updateCost=function(){var t=tb.TB_wish_set.get_TB_wish_set(),e=App.hero.diamond,i=t.cost_diamond;App.hero.getlimitValue(iface.tb_prop.limitTypeKey.wishFreeNum)<t.free_num?(this.lab_cost_one.text="免费",this.lab_cost_one.color="#ffffff",this.lab_cost_one.stroke=4,this.img_cost_one.visible=!1,this.lab_cost_one.x=41):(this.lab_cost_one.x=59,this.lab_cost_one.text=i+"",this.img_cost_one.visible=!0,e<i?(this.lab_cost_one.color="#ff0000",this.lab_cost_one.stroke=0):(this.lab_cost_one.color="#ffffff",this.lab_cost_one.stroke=4));var n=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.wishNum)-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.wishMaxNum);i*=n=0==n?10:Math.min(n,10),this.lab_cost_ten.text=i+"",this.lab_morenum.text=num2ChiNum(n)+"次",e<i?(this.lab_cost_ten.color="#ff0000",this.lab_cost_ten.stroke=0):(this.lab_cost_ten.color="#ffffff",this.lab_cost_ten.stroke=4)},i.prototype.onXuyuan=function(t){if(!this._isPlayTurnAni){var e=tb.TB_wish_set.get_TB_wish_set(),i=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.wishNum);if(App.hero.getlimitValue(iface.tb_prop.limitTypeKey.wishMaxNum)>=i)showToast(LanMgr.getLan("",10222));else{var n=App.hero.diamond,o=0,a=!0,r=e.cost_diamond;0==t?(App.hero.getlimitValue(iface.tb_prop.limitTypeKey.wishFreeNum)>=e.free_num&&(a=r<=n),o=1):(o=i-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.wishMaxNum),a=r*(o=Math.min(o,10))<=n),a?dispatchEvt(new s.HuodongEvent(s.HuodongEvent.MAKE_PROMISE_SUCCESS),{count:o}):showToast(LanMgr.getLan("",10005))}}},i.prototype.removeMask=function(){s.GuideMask.hide()},i.prototype.addMask=function(){s.GuideMask.show(this.box_center,s.DirectionType.none,"",!0,function(){},0,!1)},i.prototype.startAction=function(t,e){if(this._serverData=t,this._IS_JUMP)this.showReward();else{var i=-45*(tb.TB_wish.get_TB_wishById(t.wishId[0]).location-1)-22.5+2160;this.startTurnAni(i),UIMgr.hasStage(UIConst.TurnRewardView)&&UIMgr.hideUIByName(UIConst.TurnRewardView)}},i.prototype.updateAction=function(){var t=Laya.timer.currTimer;this.updateTurnAni(t),!this._isPlayXXAni&&t>=this._turnStartTime+i.TURN_WEEK_TIME+2e3&&this.startXXAni(),this.updateXXANI(t)},i.prototype.startTurnAni=function(t){this._turnStartAng=this.itemBoxs.rotation%360,this._turnTotalAng=t-this._turnStartAng,this._turnStartTime=Laya.timer.currTimer,this._isPlayTurnAni=!0,this.endXXAni(),this.addMask()},i.prototype.updateTurnAni=function(t){if(this._isPlayTurnAni){var e=this.getTurnAngle(this._turnStartAng,this._turnTotalAng,t-this._turnStartTime,i.TURN_WEEK_TIME);this.itemBoxs.rotation=e%360,t>=this._turnStartTime+i.TURN_WEEK_TIME&&(this.endTurnAni(),this.showReward())}},i.prototype.showReward=function(){if(this._serverData){var t=s.HuodongModel.getRewards(TURNTABLE.WISH,this._serverData.wishId);if(UIMgr.hasStage(UIConst.TurnRewardView)){var e=UIMgr.getUIByName(UIConst.TurnRewardView);e.dataSource={type:TURNTABLE.WISH,items:t.data},e.initView()}else UIMgr.showUI(UIConst.TurnRewardView,{type:TURNTABLE.WISH,items:t.data})}},i.prototype.getTurnAngle=function(t,e,i,n){if(n<=i)return t+e;var o=i/n-1;return-e*(o*o*o*o-1)+t},i.prototype.endTurnAni=function(){this._isPlayTurnAni=!1,this.removeMask()},i.prototype.startXXAni=function(){this._isPlayXXAni=!0,this._xxEndTime=0},i.prototype.updateXXANI=function(t){if(this._isPlayXXAni)if(t<=this._xxEndTime)this.itemBoxs.rotation+=this._xxSpeed;else if(t>this._xxEndTime+i.XX_ANI_STOP_TIME){var e=Math.random();this._xxSpeed=(.7<e?-1:1)*i.XX_ANI_SPEED,this._xxEndTime=t+i.XX_ANI_WEEK_TIME}},i.prototype.endXXAni=function(){this._isPlayXXAni=!1},i.prototype.setwishNums=function(){this.updateCost(),this.label_vowcount.text=LanMgr.getLan("今日许愿次数：",-1)+App.hero.getlimitValue(iface.tb_prop.limitTypeKey.wishMaxNum)+"/"+App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.wishNum)},i.prototype.CalculationTimeDifference=function(){var t=new Date(1e3*App.serverTimeSecond),e=3600*t.getHours()+60*t.getMinutes()+t.getSeconds(),i=StringToTime((TimeConst.ONE_DAY_SEC-e).toString());this.label_freetime.text=LanMgr.getLan("下次免费时间 : {0}",-1,i)},i.prototype.onClickTip=function(){UIUtil.showCommonTipView(LanMgr.getLanArr(20004))},i.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.btn_tip.off(Laya.Event.CLICK,this,this.onClickTip),this.chk_jump.off(Laya.Event.CHANGE,this,this.onJump),this.img_one.off(Laya.Event.CLICK,this,this.onXuyuan),this.img_ten.off(Laya.Event.CLICK,this,this.onXuyuan),Laya.timer.clear(this,this.CalculationTimeDifference),Laya.timer.clearAll(this),this.endTurnAni(),this.endXXAni(),this._serverData=null},i.TURN_WEEK_TIME=6e3,i.XX_ANI_STOP_TIME=1e3,i.XX_ANI_WEEK_TIME=7800,i.XX_ANI_SPEED=.1,i);function i(){var t=e.call(this)||this;return t._IS_JUMP=!1,t._turnStartAng=0,t._turnTotalAng=0,t._turnStartTime=0,t._isPlayTurnAni=!1,t._xxSpeed=0,t._xxEndTime=0,t._isPlayXXAni=!1,t.initData(),t}s.XuyuanView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t,i=(t=ui.activity.huodong.welfare.tab.toSignUI,__extends(n,t),n.prototype.onAdd=function(){this.lab_totalday.text=LanMgr.getLan("累计登入{0}天",-1,App.hero.welfare.totalLoginDay);var t=e.HuodongModel.getInstance().getSignTb();this.itemList.array=t.rewardArr},n.prototype.onExit=function(){this.close()},n.prototype.refresh=function(){this.itemList.refresh()},n.prototype.onClosed=function(){t.prototype.onClosed.call(this),this.itemList.array=null},n);function n(){return t.call(this)||this}e.ToSignView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(l){var e,t=(e=ui.activity.huodong.welfare.tab.SignUI,__extends(i,e),i.prototype.onAdd=function(){this.initView()},i.prototype.onExit=function(){this.close()},i.prototype.initView=function(){l.HuodongModel.getInstance().initCanBuQianDate();var t=tb.TB_day_sign.get_TB_day_sign(),e=getMonthDays(App.serverTimeSecond);t.length=e;var i=l.HuodongModel.getBuqianNum();this.list_item.dataSource=t;var n=l.HuodongModel.getTotalSignNum(),o=n/e;this.progress.value=o;var a=tb.TB_game_set.get_TB_game_setById(1).add_sign-i;this.lab_buqian.text=a+LanMgr.getLan("次",-1),this.lab_totalSign.text=n+"/"+e;var r=new Date(1e3*App.serverTimeSecond).getDate(),s=r==App.hero.welfare.todaySignIn,u=0<a;if(this.btn_sign.disabled=s&&!u,this.btn_sign.label=s?u?"补签":"已签到":"签到",this.lab_resetDays.text=e-r+LanMgr.getLan("天后重置",-1),this.imgcost.visible=this.lbcost.visible=s&&u,this.list_totalsign.dataSource=tb.TB_total_sign.get_TB_total_sign(),this.imgcost.visible){var h=l.HuodongModel.getSignCost();this.imgcost.skin=SkinUtil.getCostSkin(h[0]),this.lbcost.text="X"+h[1]}},i.prototype.onTotalsign=function(t,e){var i=t.dataSource;t.x=this.list_totalsign.width*(i.total_day/30)-t.width/2},i.prototype.sign=function(){var i=this;l.HuodongModel.isTodaySign()?this.Replacement():PLC.request(Protocol.game_welfare_dailySignIn,null,function(t,e){logdebug(t),t&&(UIUtil.showRewardView(t.commonData),i.initView())})},i.prototype.Replacement=function(){var i=this;common.AlertBox.showAlert({text:LanMgr.getLan("",10494,l.HuodongModel.getSignCost()[1]),confirmCb:function(){PLC.request(Protocol.game_welfare_dailySignInSupply,null,function(t,e){t&&(i.initView(),UIUtil.showRewardView(t.commonData))})},parm:null})},i);function i(){var t=e.call(this)||this;return t.initView(),t.btn_sign.on(Laya.Event.CLICK,t,t.sign),t.list_totalsign.renderHandler=new Handler(t,t.onTotalsign),t}l.SignView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.huodong.welfare.tab.DuihuanUI,__extends(n,e),n.prototype.onAdd=function(){},n.prototype.onExit=function(){this.close()},n.prototype.duiHuang=function(){if(""!=this.input_duihuanma.text){var t={};t[Protocol.game_welfare_activationCode.args.code]=this.input_duihuanma.text,PLC.request(Protocol.game_welfare_activationCode,t,function(t,e){logdebug(t),t&&UIUtil.showRewardView(t.commonData)})}else showToast(LanMgr.getLan("",10221))},n);function n(){var t=e.call(this)||this;return t.btn_duihuan.on(Laya.Event.CLICK,t,t.duiHuang),t}t.DuihuanView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.huodong.welfare.tab.DengjiUI,__extends(n,e),n.prototype.onAdd=function(){this.listRender()},n.prototype.onExit=function(){this.close()},n.prototype.listRender=function(){var t=tb.TB_level.get_TB_level();t.sort(function(t,e){var i=t.ID in App.hero.welfare.levelGiftPack?t.ID+1e3:App.hero.level<t.level?t.ID+100:t.ID+10,n=e.ID in App.hero.welfare.levelGiftPack?e.ID+1e3:App.hero.level<e.level?e.ID+100:e.ID+10;return n<i?1:i<n?-1:0}),this.list_jiangli.dataSource=t},n);function n(){var t=e.call(this)||this;return t.listRender(),t}t.DengjiView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.TabIR4UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refresh()},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){var t=this.dataSource;t?(this.btn_tab.skin=SkinUtil.getTabBtnSkin(t[2]),t[1]&&""!=t[1]?this.redpoint.setRedPointName(t[1]):this.redpoint.onDispose()):this.redpoint.onDispose()},n);function n(){return e.call(this)||this}t.WelfareIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.activity.huodong.welfare.render.TotalsignRenderUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this,e=this._dataSource;if(e){var i=o.HuodongModel.getTotalSignNum(),n=new ItemVo(e.reward[0],e.reward[1]);e.total_day<=i&&e.ID in App.hero.welfare.totalSignIn||e.total_day>i?(this.off(Laya.Event.CLICK,this,this.getGift),this.imgBg.visible=!1,Laya.timer.clearAll(this),n.show=!0):(n.show=!1,Laya.timer.clearAll(this),this.imgBg.visible=!0,this.on(Laya.Event.CLICK,this,this.getGift),Laya.timer.frameLoop(5,this,function(){t.imgBg.rotation++})),this.itemBox.dataSource=n,this.img_already.visible=e.ID in App.hero.welfare.totalSignIn,this.lab_days.text=e.total_day+LanMgr.getLan("天",-1)}else Laya.timer.clearAll(this)},i.prototype.showTip=function(t){UIUtil.showItemTip(t)},i.prototype.getGift=function(){var i=this,t={};t[Protocol.game_welfare_totalSignIn.args.id]=this._dataSource.ID,PLC.request(Protocol.game_welfare_totalSignIn,t,function(t,e){logdebug(t),t&&(i.refreshData(),t.commonData.addGods||UIUtil.showRewardView(t.commonData))})},i);function i(){return t.call(this)||this}o.TotalsignIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.activity.huodong.welfare.render.toSignIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refresh()},enumerable:!0,configurable:!0}),i.prototype.refresh=function(){if(this.dataSource){this.itemList.array=this.dataSource;var t=this.parent.getChildIndex(this),e=o.HuodongModel.getInstance().getSignTb();this.lbLv.text=o.HuodongModel.getRewardsInfo(t,e.tb.vip_level),e.canReward(t)?(this.btnSure.label="领取",this.btnSure.labelStrokeColor=ColorConst.GREEN_FILTER,this.btnSure.skin=SkinUtil.buttonGreen,this.img_receive.visible=!1,this.btnSure.visible=!0):e.isReward(t)?(this.img_receive.visible=!0,this.btnSure.visible=!1):(this.img_receive.visible=!1,this.btnSure.visible=!0,this.btnSure.skin=SkinUtil.buttonNormal,this.btnSure.labelStrokeColor=ColorConst.ORANGE_FILTER,this.btnSure.label="未达成"),this.btnSure.gray=this.btnSure.selected=!e.canReward(t),this.btnSure.on(Laya.Event.CLICK,this,this.sure,[t+1])}else this.btnSure.off(Laya.Event.CLICK,this,this.sure),this.lbLv.text="",this.itemList.array=null},i.prototype.sure=function(t){var n=this,e=o.HuodongModel.getInstance().getSignTb();if(e.canReward(t-1)){var i={};i[Protocol.game_welfare_everyDaySignIn.args.id]=e.tb.ID,i[Protocol.game_welfare_everyDaySignIn.args.type]=t,PLC.request(Protocol.game_welfare_everyDaySignIn,i,function(t,e){if(t){UIUtil.showRewardView(t.commonData),n.img_receive.visible=!0,n.btnSure.visible=!1;var i=UIMgr.getUIByName(UIConst.WelfareView);i&&i.list_btn.refresh()}})}else showToast(e.isReward(t-1)?LanMgr.getLan("",10220):o.HuodongModel.getRewardsInfo(t-1,e.tb.vip_level))},i);function i(){return t.call(this)||this}o.TosignIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=ui.activity.huodong.welfare.render.QiandaoRenderUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this._dataSource;if(t){this.img_repair.visible=n.HuodongModel.getInstance().canBuqianDate==t.ID;var e=new ItemVo(t.reward[0],t.reward[1]);e.show=!0;var i=t.ID in App.hero.welfare.dailySignIn;this.img_already.visible=i,this.box_item.dataSource=e,this.lbday.text=t.ID+"天"}},i);function i(){return t.call(this)||this}n.SignInIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.huodong.welfare.render.DengjilibaoRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this._dataSource;if(t){var e=new Array;for(var i in t.reward)e.push(new ItemVo(t.reward[i][0],t.reward[i][1]));this.list_item.dataSource=e;var n=App.hero.welfare.totalLoginDay>=t.ID;this.lab_level.text=t.ID+LanMgr.getLan("日礼包:",-1),this.btn_lingqu.disabled=App.hero.welfare.totalLoginDay<t.ID,this.btn_lingqu.label=n?LanMgr.getLan("领取",-1):LanMgr.getLan("未达到",-1),this.img_already.visible=t.ID in App.hero.welfare.loginGiftPack,this.btn_lingqu.visible=!this.img_already.visible}},n.prototype.getGigft=function(){var i=this,t={};t[Protocol.game_welfare_loginGiftPack.args.id]=this._dataSource.ID,PLC.request(Protocol.game_welfare_loginGiftPack,t,function(t,e){logdebug(t),t&&(i.img_already.visible=!0,i.btn_lingqu.visible=!1,UIUtil.showRewardView(t.commonData))})},n);function n(){var t=e.call(this)||this;return t.btn_lingqu.on(Laya.Event.CLICK,t,t.getGigft),t}t.SevenDayIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.huodong.welfare.render.DengjilibaoRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this._dataSource;if(t){var e=new Array;for(var i in t.reward)e.push(new ItemVo(t.reward[i][0],t.reward[i][1]));this.list_item.dataSource=e;var n=App.hero.level<t.level;this.btn_lingqu.on(Laya.Event.CLICK,this,this.linquDengjiLiBao);var o=t.ID in App.hero.welfare.levelGiftPack;this.img_already.visible=App.hero.welfare.totalLoginDay>=t.ID,this.lab_level.text=t.level+LanMgr.getLan("级奖励:",-1),this.btn_lingqu.skin="comp/button/btn_qianwang.png",this.btn_lingqu.labelStrokeColor="#538901",this.btn_lingqu.label=n?LanMgr.getLan("未达到",-1):LanMgr.getLan("领取",-1),this.btn_lingqu.disabled=n,this.img_already.visible=o,this.btn_lingqu.visible=!this.img_already.visible}else this.btn_lingqu.off(Laya.Event.CLICK,this,this.linquDengjiLiBao)},n.prototype.linquDengjiLiBao=function(){var i=this,t={};t[Protocol.game_welfare_levelGiftPack.args.id]=this._dataSource.ID,PLC.request(Protocol.game_welfare_levelGiftPack,t,function(t,e){t&&(i.img_already.visible=!0,i.btn_lingqu.visible=!1,UIUtil.showRewardView(t.commonData),UIMgr.hasStage(UIConst.WelfareView)&&UIMgr.getUIByName(UIConst.WelfareView).initDengjiView())})},n);function n(){return e.call(this)||this}t.LvGiftIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var i,t=(i=ui.activity.huodong.welfare.payActivityUI,__extends(e,i),e.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.initView=function(){tl3d.ModuleEventManager.addEvent(a.ResEvent.PROP_CHANGE,this.onUpdateRes,this),tl3d.ModuleEventManager.addEvent(a.ResEvent.RESOURCE_CHANGE,this.onUpdateRes,this),this.onUpdateRes(),this.list_btn.array=a.HuodongModel.getInstance().payTabItemLabel;var t=!isNaN(this.dataSource)&&0<=this.dataSource?this.dataSource:0;this.list_btn.selectedIndex=t,this.onTabSelect(this.list_btn.selectedIndex),this.list_btn.scrollTo(0),this.btnClose.on(Laya.Event.CLICK,this,this.close)},e.prototype.onTabRender=function(t,e){t.selectBox.selected=e==this._selectTabNum},e.prototype.onTabSelect=function(t){if(this._selectTabNum!=t){var e=null;this._selectTabNum=t,this.hideAll();var i=this.list_btn.getItem(t),n=i?i[0]:-1;switch(n){case a.WelfareType.dayLibao:case a.WelfareType.weekLibao:case a.WelfareType.monthLibao:this._xiangouLibaoView||(this._xiangouLibaoView=new a.XiangouLibaoView,this._xiangouLibaoView.centerX=0,this._xiangouLibaoView.y=456),this.addChildAt(this._xiangouLibaoView,2),this._xiangouLibaoView.onEnter(n),e=SkinUtil.getWelfareTitle(n);break;case a.WelfareType.yueka:this._yuekaView||(this._yuekaView=new a.YuekaView,this._yuekaView.centerX=0,this._yuekaView.y=460),this.addChildAt(this._yuekaView,2),this._yuekaView.onAdd(),e="fuli/yuekainfo.jpg";break;case a.WelfareType.dengjiJijin:this._jijinView||(this._jijinView=new a.JijinView,this._jijinView.centerX=0,this._jijinView.y=107),this.addChildAt(this._jijinView,2),this._jijinView.onAdd(),e="fuli/guanggaotu2.jpg"}this.imgTitle.skin=e,Laya.Tween.clearTween(this.imgTitle),this.imgTitle.x=0;var o=this.imgTitle.x+720;Laya.Tween.from(this.imgTitle,{x:o},500,Laya.Ease.backOut)}},e.prototype.hideAll=function(){this._xiangouLibaoView&&this._xiangouLibaoView.parent&&(this._xiangouLibaoView.onExit(),this._xiangouLibaoView.removeSelf()),this._yuekaView&&this._yuekaView.parent&&(this._yuekaView.onExit(),this._yuekaView.removeSelf()),this._jijinView&&this._jijinView.parent&&(this._jijinView.onExit(),this._jijinView.removeSelf())},e.prototype.setBtnLabel=function(){this._jijinView&&this._jijinView.setBtnLabel()},e.prototype.initJijinlist=function(){this._jijinView&&this._jijinView.initView()},e.prototype.initYuekaView=function(){this._yuekaView&&this._yuekaView.initView()},e.prototype.updateXiangouLibao=function(){this._xiangouLibaoView&&this._xiangouLibaoView.initView()},e.prototype.close=function(){i.prototype.close.call(this),dispatchEvt(new a.HudEvent(a.HudEvent.SHOW_MODULE_VIEW,[ModuleConst.MAIN]))},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btnClose.off(Laya.Event.CLICK,this,this.close),this.hideAll(),this._selectTabNum=-1,tl3d.ModuleEventManager.removeEvent(a.ResEvent.PROP_CHANGE,this.onUpdateRes,this),tl3d.ModuleEventManager.removeEvent(a.ResEvent.RESOURCE_CHANGE,this.onUpdateRes,this)},e.prototype.onUpdateRes=function(){this.boxRes.width=312,this.lab_zuanshi.text=Snums(App.hero.diamond),this.lab_money.text=Snums(App.hero.gold)},e);function e(){var t=i.call(this)||this;return t.isModelClose=!0,t.list_btn.selectHandler=new Handler(t,t.onTabSelect),t.list_btn.renderHandler=new Handler(t,t.onTabRender),t}a.payActivityView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(r){var e,t=(e=ui.activity.huodong.welfare.tab.YuekaUI,__extends(i,e),i.prototype.onAdd=function(){var t=this;this._cells&&Laya.timer.callLater(this,function(){UIUtil.playListEff(t._cells)})},i.prototype.onExit=function(){this.close(),this.box_card1.y=this._initCard1Y,this.box_card2.y=this._initCard2Y,UIUtil.clearListEff(this._cells)},i.prototype.initView=function(){this._cells=[this.box_card1,this.box_card2],tl3d.ModuleEventManager.addEvent(r.TopUpEvent.SHOW_CHONGZHISUCC_PANEL,this.initView,this);var e=App.hero.welfare.monthCardEndTime>App.getServerTime(),t=tb.TB_month_card.getTbMonthCardById(1);if(this.btn_getyueka.skin="comp/button/button.png",this.btn_getyueka.labelStrokeColor="#ca7005",e){var i=(parseInt(App.hero.welfare.monthCardEndTime)-App.getServerTime())/86400;this.lab_time.text=LanMgr.getLan("剩余{0}天",-1,String(Math.ceil(i))),1!=App.hero.welfare.monthCardAward?(this.btn_getyueka.label="领取",this.btn_getyueka.gray=!1):(this.btn_getyueka.label="已领取",this.btn_getyueka.gray=!0),this.btn_getyueka.skin="comp/button/btn_qianwang.png",this.btn_getyueka.labelStrokeColor="#538901",this.img_yk_receive.visible=!1}else this.btn_getyueka.gray=!1,this.lab_time.text="",this.btn_getyueka.label="￥"+t.recharge_count,this.img_yk_receive.visible=!1;var n=ary2prop(t.item_gift);this.list_yueka.dataSource=n.map(function(t){return{item:t,show:e}});var o=1==App.hero.welfare.lifelongCard,a=tb.TB_month_card.getTbMonthCardById(2);this.btn_zhongsheng.skin="comp/button/button.png",this.btn_zhongsheng.labelStrokeColor="#ca7005",o?1!=App.hero.welfare.lifelongCardAward?(this.btn_zhongsheng.label="领取",this.btn_zhongsheng.gray=!1,this.btn_zhongsheng.skin="comp/button/btn_qianwang.png",this.btn_zhongsheng.labelStrokeColor="#538901",this.img_zs_receive.visible=!1):(this.img_zs_receive.visible=!1,this.btn_zhongsheng.label="已领取",this.btn_zhongsheng.gray=!0,this.btn_zhongsheng.skin="comp/button/btn_qianwang.png",this.btn_zhongsheng.labelStrokeColor="#538901"):(this.btn_zhongsheng.gray=!1,this.btn_zhongsheng.label="￥"+a.recharge_count,this.img_zs_receive.visible=!1),n=ary2prop(a.item_gift),this.list_zhonghsenka.dataSource=n.map(function(t){return{item:t,show:o}}),this.yuekaRP.onDispose(),this.yuekaRP.setRedPointName("month_reward"),this.lifeRP.onDispose(),this.lifeRP.setRedPointName("life_reward")},i.prototype.lingqu=function(t){var i=this;if(1==t)if(App.hero.welfare.monthCardEndTime>App.getServerTime())1!=App.hero.welfare.monthCardAward?PLC.request(Protocol.game_welfare_getMonthCardAward,null,function(t,e){t&&UIUtil.showRewardView(t.commonData),i.initView()}):showToast(LanMgr.getLan("",10219));else{var e=tb.TB_month_card.getTbMonthCardById(1);this.jump(e.recharge_id)}else 1==App.hero.welfare.lifelongCard?1!=App.hero.welfare.lifelongCardAward?PLC.request(Protocol.game_welfare_getLifelongCardAward,null,function(t,e){t&&UIUtil.showRewardView(t.commonData),i.initView()}):showToast(LanMgr.getLan("",10219)):(e=tb.TB_month_card.getTbMonthCardById(2),this.jump(e.recharge_id))},i.prototype.jump=function(t){var e=Number(window.platform.pid);if(r.ChongzhiModel.isRealPay(e)){var i=tb.TB_recharge.get_TB_rechargeById(t);r.ChongzhiModel.pay(i)}else this.test(t)},i.prototype.test=function(t){var e=this;UIUtil.payDebug(t,null,function(){e.initView()})},i);function i(){var t=e.call(this)||this;return t._cells=null,t.initView(),t.btn_getyueka.on(Laya.Event.CLICK,t,t.lingqu,[1]),t.btn_zhongsheng.on(Laya.Event.CLICK,t,t.lingqu,[2]),t._initCard1Y=t.box_card1.y,t._initCard2Y=t.box_card2.y,t}r.YuekaView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=ui.activity.huodong.welfare.tab.XianGouLibaoUI,__extends(i,t),i.prototype.onEnter=function(t){var e=this;this._curType=t,this.initView(),Laya.timer.callLater(this,function(){UIUtil.playListEff(e.listLibao.cells)})},i.prototype.onExit=function(){this.close(),UIUtil.clearListEff(this.listLibao.cells)},i.prototype.close=function(){this._curType=0,Laya.timer.clearAll(this)},i.prototype.initView=function(){if(-1!=[o.WelfareType.dayLibao,o.WelfareType.weekLibao,o.WelfareType.monthLibao].indexOf(this._curType)){var t=[],e=new Date;if(e.setTime(App.serverTime),this._curType==o.WelfareType.dayLibao)t=tb.TB_daily_recharge.getAllTB(),e.setDate(e.getDate()+1),e.setHours(0,0,0,0),this._endTime=e.getTime()/1e3;else if(this._curType==o.WelfareType.weekLibao){t=tb.TB_week_recharge.getAllTB();var i=e.getDay(),n=i==WeekNum.Sun?1:7-i+1;e.setDate(e.getDate()+n),e.setHours(0,0,0,0),this._endTime=e.getTime()/1e3}else this._curType==o.WelfareType.monthLibao&&(t=tb.TB_month_recharge.getAllTB(),e.setMonth(e.getMonth()+1),e.setDate(1),e.setHours(0,0,0,0),this._endTime=e.getTime()/1e3);this.listLibao.array=t,Laya.timer.loop(1e3,this,this.updateTime),this.updateTime()}},i.prototype.updateTime=function(){var t=Math.ceil(this._endTime-App.serverTimeSecond);if(0<t){var e=Math.floor(t/TimeConst.ONE_DAY_SEC);t-=e*TimeConst.ONE_DAY_SEC;var i=Math.floor(t/TimeConst.ONE_HOURS_SEC);t-=i*TimeConst.ONE_HOURS_SEC;var n=Math.ceil(t/60);this.lbTime.text=0<e?"倒计时："+e+"天"+i+"时":"倒计时："+i+"时"+n+"分"}else this.lbTime.text="倒计时：0时0分",Laya.timer.clearAll(this);this.img_time.x=this.lbTime.x-25},i);function i(){return t.call(this)||this}o.XiangouLibaoView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.huodong.welfare.tab.JijinUI,__extends(n,e),n.prototype.onAdd=function(){var t=this;this.listRender(),Laya.timer.callLater(this,function(){UIUtil.playListEff(t.list_itemJijin.cells)}),this.ani1.play(0,!0)},n.prototype.onExit=function(){this.close(),this.ani1.stop(),UIUtil.clearListEff(this.list_itemJijin.cells)},n.prototype.initView=function(){this.setBtnLabel(),this.listRender();var t=tb.TB_activity_set.getTabSet().level_fund_buy;this.lab_vip.text=LanMgr.getLan("VIP{0}可购买",-1,t[0])},n.prototype.setBtnLabel=function(){this.list_itemJijin.refresh(),this.btn_recharge.disabled=1==App.hero.welfare.buyLevelFund,this.btn_recharge.disabled?(this.btn_recharge.skin="comp/button/btn_qianwang.png",this.btn_recharge.labelStrokeColor="#538901",this.btn_recharge.label=LanMgr.getLan("已购买",-1)):(this.btn_recharge.skin="comp/button/button.png",this.btn_recharge.labelStrokeColor="#ca7005",this.btn_recharge.label=LanMgr.getLan("购买",-1));var t=tb.TB_activity_set.getTabSet().level_fund_buy;this.redpoint.visible=0==App.hero.welfare.buyLevelFund&&App.hero.vip>=t[0]&&App.hero.diamond>=t[1]},n.prototype.listRender=function(){var t=tb.TB_level_fund.get_TB_level_fund();t.sort(function(t,e){var i=App.hero.level>=t.level?App.hero.welfare.levelFundAward[t.ID]?t.ID+1e3:t.ID+10:t.ID+100,n=App.hero.level>=e.level?App.hero.welfare.levelFundAward[e.ID]?e.ID+1e3:e.ID+10:e.ID+100;return n<i?1:i<n?-1:0}),this.list_itemJijin.dataSource=t},n.prototype.recharge=function(){var e=this,t=tb.TB_activity_set.getTabSet().level_fund_buy;App.hero.vip<t[0]?showToast(LanMgr.getLan("",10214,t[0])):App.hero.diamond<t[1]?showToast(LanMgr.getLan("",10005)):PLC.request(Protocol.game_activity_buyLevelFund,null,function(t){t&&(App.hero.welfare.buyLevelFund=t.buyLevelFund,e.setBtnLabel())})},n);function n(){var t=e.call(this)||this;return t.initView(),t.btn_recharge.on(Laya.Event.CLICK,t,t.recharge),t}t.JijinView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.huodong.welfare.render.YueKaItemIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refresh()},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){this.dataSource&&(this.img_receivebg.visible=this.dataSource.show,this.ui_item.dataSource=this.dataSource.item,this.gray=this.dataSource.show)},n);function n(){return e.call(this)||this}t.YueKaItemIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=ui.activity.huodong.welfare.render.LibaoIRUI,__extends(i,t),Object.defineProperty(i.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),i.prototype.refreshData=function(){var t=this.dataSource;t?(this.renderView(t),this.btnBuy.on(Laya.Event.CLICK,this,this.onBuy)):(this.listItem.array=null,this.btnBuy.off(Laya.Event.CLICK,this,this.onBuy))},i.prototype.renderView=function(t){this.btnBuy.label="￥"+t.recharge_num,this.listItem.array=t.getRewardList(),this.imgDiscount.visible=this.lbDiscount.visible=0<t.discount,this.lbDiscount.text=t.discount+"折";var e=0;t instanceof tb.TB_daily_recharge?e=App.hero.welfare.dayRechargeLimit&&App.hero.welfare.dayRechargeLimit[t.ID]||0:t instanceof tb.TB_week_recharge?e=App.hero.welfare.weekRechargeLimit&&App.hero.welfare.weekRechargeLimit[t.ID]||0:t instanceof tb.TB_month_recharge&&(e=App.hero.welfare.monthRechargeLimit&&App.hero.welfare.monthRechargeLimit[t.ID]||0),e=Math.max(0,t.limit_num-e),this.lbNum.text="剩余次数："+e+"/"+t.limit_num,this.btnBuy.visible=0<e,this.imgYigoumai.visible=e<=0},i.prototype.onBuy=function(){var t=this.dataSource;if(t){var e=Number(window.platform.pid);if(n.ChongzhiModel.isRealPay(e)){var i=tb.TB_recharge.get_TB_rechargeById(t.recharge_id);n.ChongzhiModel.pay(i)}else UIUtil.payDebug(t.recharge_id,{text:"付款成功，等待奖励中..."})}},i);function i(){return t.call(this)||this}n.XiangouLibaoIR=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.box.TabIR2UI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refresh()},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){var t=this.dataSource;t?(this.btn_tab.skin=SkinUtil.getTabBtnSkin(t[2]),t[1]&&""!=t[1]?this.redpoint.setRedPointName(t[1]):this.redpoint.onDispose()):this.redpoint.onDispose()},n);function n(){return e.call(this)||this}t.PayActivityTabIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.huodong.welfare.render.RatingfundRenderUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this._dataSource;if(t){var e=[];for(var i in t.reward)e.push(new ItemVo(t.reward[i][0],t.reward[i][1]));this.list_item.dataSource=e;var n=App.hero.level>=t.level&&0<App.hero.welfare.buyLevelFund,o=App.hero.welfare.levelFundAward[t.ID]&&0<App.hero.welfare.levelFundAward[t.ID];this.lab_level.text=LanMgr.getLan("达到"+t.level+"级  ("+App.hero.level+"/"+t.level+")",-1),o?(this.img_already.visible=!0,this.btn_lingqu.visible=!1):n?(this.img_already.visible=!1,this.btn_lingqu.visible=!0,this.btn_lingqu.disabled=!1,this.btn_lingqu.label=LanMgr.getLan("领取",-1)):(this.img_already.visible=!1,this.btn_lingqu.visible=!0,this.btn_lingqu.disabled=!0,this.btn_lingqu.label=LanMgr.getLan("未达到",-1)),this.btn_lingqu.skin="comp/button/btn_qianwang.png",this.btn_lingqu.labelStrokeColor="#538901"}else this.list_item.dataSource=null},n.prototype.gift=function(){dispatchEvt(new t.HuodongEvent(t.HuodongEvent.GET_LEVELFUND_REWARD),this._dataSource.ID)},n);function n(){var t=e.call(this)||this;return t.btn_lingqu.on(Laya.Event.CLICK,t,t.gift),t}t.FundIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var e,t=(e=ui.activity.huodong.luckyturn.luckyturnUI,__extends(a,e),a.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},Object.defineProperty(a.prototype,"tabIdx",{get:function(){return this.tab.selectedIndex},enumerable:!0,configurable:!0}),a.prototype.initView=function(){this.bgPanel.dataSource={uiName:UIConst.LuckyTurnView,closeOnSide:!1,closeOnButton:!1,title:"幸运转盘"},this.tab.selectHandler=Handler.create(this,this.onTab,null,!1),this.tab.array=this._turnTypeArr,this.lab_title.visible=this.lab_title1.visible=App.serverTimeSecond<=App.hero.openSvrTime+7*TimeConst.ONE_DAY_SEC,Laya.timer.loop(1,this,this.update),this.img_one.on(Laya.Event.CLICK,this,this.onCLickBuy,[0]),this.img_ten.on(Laya.Event.CLICK,this,this.onCLickBuy,[1]),this.img_record.on(Laya.Event.CLICK,this,this.onClickRecord),this.img_sw_box.on(Laya.Event.CLICK,this,this.onClickTreasure),this.chk_jump.on(Laya.Event.CHANGE,this,this.onJump);for(var t=0;t<4;t++)this["ui_equip_item_"+t].on(Laya.Event.CLICK,this,this.onClickEquipReward,[t]);tl3d.ModuleEventManager.addEvent(o.ResEvent.RESOURCE_CHANGE,this.updateCost,this),tl3d.ModuleEventManager.addEvent(o.ResEvent.LIMIT_VALUE_CHANGE,this.updateCost,this),tl3d.ModuleEventManager.addEvent(o.HuodongEvent.LUCK_GOD_VALUE_CHANGE,this.onGodValueChange,this),tl3d.ModuleEventManager.addEvent(o.HuodongEvent.LUCK_EQUIP_VALUE_CHANGE,this.onEquipValueChange,this),tl3d.ModuleEventManager.addEvent(o.HuodongEvent.LUCK_TREASURE_VALUE_CHANGE,this.onTreasureValueChange,this),tl3d.ModuleEventManager.addEvent(o.HuodongEvent.LUCK_EQUIP_REWARD_CHANGE,this.updateEquipReward,this),this.updateTab(),this.update(),this.chk_jump.selected=a.IS_JUMP,this.ani_point.play(),this.isModelClose=!0},a.prototype.onGodValueChange=function(){this._curType==TURNTABLE.GOD&&this.updateProgress()},a.prototype.onEquipValueChange=function(){this._curType==TURNTABLE.EQUIP&&(this.updateProgress(),this.updateEquipReward())},a.prototype.onTreasureValueChange=function(){this._curType==TURNTABLE.TREASURE&&(this.updateProgress(),this.updateTreasureBox())},a.prototype.updateTab=function(){this.initTab(),-1!=this._firstType?this.onTab(this._firstType):this.close()},a.prototype.initTab=function(){this._firstType=-1;for(var t=0,e=0;e<this.tab.cells.length;e++){var i=this._turnTypeArr[e];0<o.HuodongModel.getLuckIdByType(i)?(this.tab.addChild(this.tab.cells[e]),this.tab.cells[e].x=123*t,t++,-1==this._firstType&&(this._firstType=e)):this.tab.removeChild(this.tab.cells[e])}},a.prototype.onTab=function(t){if(!this._isPlayTurnAni&&!((this.tab.selectedIndex=t)<0||t>=this.tab.cells.length)){for(var e=0;e<this.tab.cells.length;e++){var i=this.tab.cells[e].getChildByName("selectBox");i.visible=t==e,i.visible&&i.play(0,!0)}var n;switch(this._curType=this._turnTypeArr[t],this._curType){case TURNTABLE.GOD:n=App.hero.welfare.luckGodId,this._curTimeTemp=tb.TB_luck_god_time.get_TB_luck_god_timeById(n),this._curRewardTemp=tb.TB_luck_god.get_TB_luck_god("type",n+"");break;case TURNTABLE.EQUIP:n=App.hero.welfare.luckEquipId,this._curTimeTemp=tb.TB_luck_equip_time.get_TB_luck_equip_timeById(n),this._curRewardTemp=tb.TB_luck_equip.get_TB_luck_equip("type",n+"");break;case TURNTABLE.TREASURE:n=App.hero.welfare.luckTreasureId,this._curTimeTemp=tb.TB_luck_treasure_time.getTempById(n),this._curRewardTemp=tb.TB_luck_treasure.get_TB_luck_Treasure("type",n+"")}this.updateTurnItem(),this.updateCost(),this.updateRemainTime(),this.updateTabView()}},a.prototype.update=function(){0<this._remainTimeS&&this.updateRemainTimeStr(),this.updateAction()},a.prototype.updateTurnItem=function(){if(this._curRewardTemp&&!(this._curRewardTemp.length<a.TURN_ITEM_NUM)){this._curRewardTemp.sort(function(t,e){return t.location-e.location});for(var t=0;t<this._curRewardTemp.length;t++){var e=this["ui_item_"+t];if(!e)break;var i=this._curRewardTemp[t],n=new ItemVo(i.item[0],i.item[1]);n.isShowEff=1==i.is_show_effect,e.dataSource=n}}},a.prototype.updateCost=function(){if(this._curTimeTemp){var t=o.HuodongModel.getLuckFreeCount(this._curType),e=App.hero.diamond;if(this.ui_red.setRedPointName(o.HuodongModel.LuckRedNames[this._curType]),0<t)this._isFree=!0,this.lab_cost_one.text="免费",this.lab_cost_one.color="#ffffff",this.lab_cost_one.stroke=4,this.img_cost_one.visible=!1;else{this._isFree=!1;var i=this._curTimeTemp.buy_cost[0];this.lab_cost_one.text=i+"",this.img_cost_one.visible=!0,e<this._curTimeTemp.buy_cost[0]?(this.lab_cost_one.color="#ff0000",this.lab_cost_one.stroke=0,this._isCanOne=!1):(this.lab_cost_one.color="#ffffff",this.lab_cost_one.stroke=4,this._isCanOne=!0)}var n=this._curTimeTemp.buy_cost[1];this.lab_cost_ten.text=n+"",e<n?(this.lab_cost_ten.color="#ff0000",this.lab_cost_ten.stroke=0,this._isCanTen=!1):(this.lab_cost_ten.color="#ffffff",this.lab_cost_ten.stroke=4,this._isCanTen=!0)}},a.prototype.updateRemainTime=function(){this._curTimeTemp&&(this._remainTimeS=o.HuodongModel.getRemainTimeByTemp(this._curTimeTemp.type,this._curTimeTemp.time),this._curTimeMs=Laya.timer.currTimer,this.updateRemainTimeStr(!0))},a.prototype.updateRemainTimeStr=function(t){void 0===t&&(t=!1);var e=Laya.timer.currTimer,i=e-this._curTimeMs;(t||1e3<=i)&&(this._remainTimeS-=i/1e3,this._curTimeMs=e,this._remainTimeS<=0?this.lab_time.text=LanMgr.getLan("该活动已结束",-1):this.lab_time.text=LanMgr.getLan("剩余:{0}",-1,activityTime(this._remainTimeS,0)))},a.prototype.updateTabView=function(){if(this._curTimeTemp){switch(this.clearTabView(),this._curType){case TURNTABLE.GOD:this.lab_god.visible=!0,this.lab_luck_title.text="幸运值",this.lab_title.text="整只传说英雄概率翻倍";break;case TURNTABLE.EQUIP:this.box_equip.visible=!0,this.lab_luck_title.text="幸运值",this._equipMaxValue=0,this._equipRewards=tb.TB_luck_equip_reward.get_TB_luck_equip_reward("type",this._curTimeTemp.ID);for(var t=0;t<10;t++){var e=this["ui_equip_item_"+t];if(!e)break;if(this._equipRewards[t]){var i=new ItemVo(this._equipRewards[t].reward[0][0],this._equipRewards[t].reward[0][1]);i.show=!1,e.dataSource=i,this._equipRewards[t].lucky>this._equipMaxValue&&(this._equipMaxValue=this._equipRewards[t].lucky)}}this.lab_title.text="橙装概率翻倍";break;case TURNTABLE.TREASURE:this.box_sw.visible=!0,this.lab_luck_title.text="充能",this.lab_title.text="红色圣物概率翻倍"}var n=this.lab_title.width+this.lab_title1.width+5;this.lab_title1.x=(this.width-n)/2,this.lab_title.x=this.lab_title1.x+this.lab_title1.width+5,this.updateProgress(),this.updateEquipReward(),this.updateTreasureBox()}},a.prototype.updateProgress=function(){if(this._curTimeTemp){var t=0,e=0;switch(this._curType){case TURNTABLE.GOD:t=App.hero.welfare.luckGodNum,e=this._curTimeTemp.luck_reward[0];break;case TURNTABLE.EQUIP:t=App.hero.welfare.luckEquipNum,e=this._equipMaxValue;break;case TURNTABLE.TREASURE:e=this._curTimeTemp.luck_value,t=App.hero.welfare.luckTreasureNum}this._curType==TURNTABLE.EQUIP?this.lab_luck_val.text="":this.lab_luck_val.text=t+"/"+e,this.pro_luck.value=t/e}},a.prototype.updateEquipReward=function(){if(this._equipRewards)for(var t=0;t<4;t++){var e=App.hero.welfare.luckEquipAward&&null!=App.hero.welfare.luckEquipAward[this._equipRewards[t].ID];this["img_equip_receive_"+t].visible=e,this["img_equip_light_"+t].visible=!e&&this._equipRewards[t].lucky<=this.pro_luck.value*this._equipMaxValue}},a.prototype.updateTreasureBox=function(){var t=this;this._curType==TURNTABLE.TREASURE&&(1<=this.pro_luck.value?(this.ani_sw_eff.visible=!0,this.ani_sw_eff.loadAnimation(ResConst.anim_baoxiang,Handler.create(null,function(){t.ani_sw_eff.play(0,!0)}),ResConst.atlas_baoxiang)):(this.ani_sw_eff.visible=!1,this.ani_sw_eff.stop()),this.img_sw_box.skin="comp/flag/task_baoxiang4.png")},a.prototype.clearTabView=function(){this.box_equip.visible=!1,this.box_sw.visible=!1,this.lab_god.visible=!1;for(var t=0;t<10;t++){var e=this["ui_equip_item_"+t];if(!e)break;e.dataSource=null}this.ani_sw_eff.visible=!1,this.ani_sw_eff.stop(),this._equipRewards=null},a.prototype.onClickRecord=function(t){UIMgr.showUI(UIConst.LuckRecordView,this._curType)},a.prototype.onCLickBuy=function(t){var i=this;if(!(this._isPlayTurnAni||this._remainTimeS<=0)){var e=0;if(0==t){if(!this._isFree&&!this._isCanOne)return void showToast(LanMgr.getLan("",10005));e=1}else{if(!this._isCanTen)return void showToast(LanMgr.getLan("",10005));e=10}var n,o={_0:this._curTimeTemp.ID,_1:e};switch(this._curType){case TURNTABLE.GOD:n=Protocol.game_luck_buyluckGod;break;case TURNTABLE.EQUIP:n=Protocol.game_luck_buyluckEquip;break;case TURNTABLE.TREASURE:n=Protocol.game_luck_buyluckTreasure}PLC.request(n,o,function(t,e){t&&(e&&0<e.length?showToast(e):i.startAction(t,e))})}},a.prototype.onClickEquipReward=function(t,e){if(this._equipRewards&&this._equipRewards[t])if(this["img_equip_light_"+t].visible){if(!(this._remainTimeS<=0)){var i={};i[Protocol.game_activity_getLevelFundReward.args.id]=this._equipRewards[t].ID,PLC.request(Protocol.game_luck_getluckEquipAward,i,function(t,e){t&&UIUtil.showRewardView(t.commonData)})}}else UIUtil.showTip(this["ui_equip_item_"+t].dataSource)},a.prototype.onClickTreasure=function(){var e=this;if(this._curTimeTemp){if(this.pro_luck.value<1){var t=[];return t.push(new ItemVo(this._curTimeTemp.luck_reward[0],this._curTimeTemp.luck_reward[1])),void UIMgr.showUI(UIConst.ManyItemsTip,{data:t})}this._remainTimeS<=0||(this.img_sw_box.skin="comp/flag/task_baoxiang444.png",Laya.timer.once(100,this,function(){var t={};t[Protocol.game_luck_getluckTreasureAward.args.id]=e._curTimeTemp.ID,PLC.request(Protocol.game_luck_getluckTreasureAward,t,function(t,e){t&&UIUtil.showRewardView(t.commonData)})}))}},a.prototype.onJump=function(){a.IS_JUMP=this.chk_jump.selected},a.prototype.startAction=function(t,e){var i,n=this;switch(this._serverData=t,this._curType){case TURNTABLE.GOD:t.luckGodIds&&0<t.luckGodIds.length&&(i=tb.TB_luck_god.get_TB_luck_godById(t.luckGodIds[0]),this._ids=t.luckGodIds);break;case TURNTABLE.EQUIP:t.luckEquipIds&&0<t.luckEquipIds.length&&(i=tb.TB_luck_equip.get_TB_luck_equipById(t.luckEquipIds[0]),this._ids=t.luckEquipIds);break;case TURNTABLE.TREASURE:t.luckTreasureIds&&0<t.luckTreasureIds.length&&(i=tb.TB_luck_treasure.getTempById(t.luckTreasureIds[0]),this._ids=t.luckTreasureIds)}if(i){var o=-45*(i.location-1)-22.5+2160;a.IS_JUMP?(this.box_turn.rotation=o,this._turnStartTime=Laya.timer.currTimer-a.TURN_WEEK_TIME,this._isPlayXXAni=!1,this._serverData&&Laya.timer.once(100,this,function(){n.showQuickPage(n._curType,n._ids)})):(this.startTurnAni(o),UIMgr.hideUIByName(UIConst.TurnRewardView))}},a.prototype.showQuickPage=function(t,e){for(var i=[],n=0;n<e.length;n++)switch(t){case TURNTABLE.GOD:var o=tb.TB_luck_god.get_TB_luck_godById(e[n]);i.push(new ItemVo(o.item[0],o.item[1]));break;case TURNTABLE.EQUIP:var a=tb.TB_luck_equip.get_TB_luck_equipById(e[n]);i.push(new ItemVo(a.item[0],a.item[1]));break;case TURNTABLE.TREASURE:var r=tb.TB_luck_treasure.getTempById(e[n]);i.push(new ItemVo(r.item[0],r.item[1]))}if(UIMgr.hasStage(UIConst.TurnRewardView)){var s=UIMgr.getUIByName(UIConst.TurnRewardView);s.dataSource={type:t,items:i},s.initView()}else UIMgr.showUI(UIConst.TurnRewardView,{type:t,items:i})},a.prototype.updateAction=function(){var t=Laya.timer.currTimer;this.updateTurnAni(t),!this._isPlayXXAni&&t>=this._turnStartTime+a.TURN_WEEK_TIME+2e3&&this.startXXAni(),this.updateXXANI(t)},a.prototype.startTurnAni=function(t){this._turnStartAng=this.box_turn.rotation%360,this._turnTotalAng=t-this._turnStartAng,this._turnStartTime=Laya.timer.currTimer,this._isPlayTurnAni=!0,this.isModelClose=!1,this.endXXAni()},a.prototype.updateTurnAni=function(t){var e=this;if(this._isPlayTurnAni){var i=this.getTurnAngle(this._turnStartAng,this._turnTotalAng,t-this._turnStartTime,a.TURN_WEEK_TIME);this.box_turn.rotation=i%360,t>=this._turnStartTime+a.TURN_WEEK_TIME&&(this.endTurnAni(),this._serverData&&Laya.timer.once(100,this,function(){e.showQuickPage(e._curType,e._ids)}))}},a.prototype.getTurnAngle=function(t,e,i,n){if(n<=i)return t+e;var o=i/n-1;return-e*(o*o*o*o-1)+t},a.prototype.endTurnAni=function(){this._isPlayTurnAni=!1,this.isModelClose=!0},a.prototype.startXXAni=function(){this._isPlayXXAni=!0,this._xxEndTime=0},a.prototype.updateXXANI=function(t){if(this._isPlayXXAni)if(t<=this._xxEndTime)this.box_turn.rotation+=this._xxSpeed;else if(t>this._xxEndTime+a.XX_ANI_STOP_TIME){var e=Math.random();this._xxSpeed=(.7<e?-1:1)*a.XX_ANI_SPEED,this._xxEndTime=t+a.XX_ANI_WEEK_TIME}},a.prototype.endXXAni=function(){this._isPlayXXAni=!1},a.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.bgPanel.dataSource=null,this.endTurnAni(),this.endXXAni(),Laya.timer.clearAll(this),this.img_one.off(Laya.Event.CLICK,this,this.onCLickBuy),this.img_ten.off(Laya.Event.CLICK,this,this.onCLickBuy),this.img_record.off(Laya.Event.CLICK,this,this.onClickRecord),this.img_sw_box.off(Laya.Event.CLICK,this,this.onClickTreasure),this.chk_jump.off(Laya.Event.CHANGE,this,this.onJump);for(var t=0;t<4;t++)this["ui_equip_item_"+t].off(Laya.Event.CLICK,this,this.onClickEquipReward);tl3d.ModuleEventManager.removeEvent(o.ResEvent.RESOURCE_CHANGE,this.updateCost,this),tl3d.ModuleEventManager.removeEvent(o.ResEvent.LIMIT_VALUE_CHANGE,this.updateCost,this),tl3d.ModuleEventManager.removeEvent(o.HuodongEvent.LUCK_GOD_VALUE_CHANGE,this.onGodValueChange,this),tl3d.ModuleEventManager.removeEvent(o.HuodongEvent.LUCK_EQUIP_VALUE_CHANGE,this.onEquipValueChange,this),tl3d.ModuleEventManager.removeEvent(o.HuodongEvent.LUCK_TREASURE_VALUE_CHANGE,this.onTreasureValueChange,this),tl3d.ModuleEventManager.removeEvent(o.HuodongEvent.LUCK_EQUIP_REWARD_CHANGE,this.updateEquipReward,this)},a.TURN_ITEM_NUM=8,a.IS_JUMP=!1,a.TURN_WEEK_TIME=6e3,a.XX_ANI_STOP_TIME=1e3,a.XX_ANI_WEEK_TIME=7800,a.XX_ANI_SPEED=.1,a);function a(){var t=e.call(this)||this;return t._turnTypeArr=[TURNTABLE.GOD,TURNTABLE.EQUIP,TURNTABLE.TREASURE],t._isFree=!1,t._isCanOne=!1,t._isCanTen=!1,t._remainTimeS=0,t._curTimeMs=0,t.Number=0,t._turnStartAng=0,t._turnTotalAng=0,t._turnStartTime=0,t._isPlayTurnAni=!1,t._xxSpeed=0,t._xxEndTime=0,t._isPlayXXAni=!1,t.isModelClose=!0,t.bgPanel.box_Content.addChild(t.img_bg),t}o.LuckyTurnView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.activity.huodong.luckyturn.luckyRecordUI,__extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0,this.bgPanel.dataSource={closeOnButton:!0,closeOnSide:this.isModelClose,title:"记录"},this.bgPanel.addChildAt(this.img_bg,3),this._model=t.HuodongModel.getInstance()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},n.prototype.close=function(){i.prototype.close.call(this),this.recordList.renderHandler&&(this.recordList.renderHandler.recover(),this.recordList.renderHandler=null),this.recordList.array=null;var t=this._model;t.godRecord=null,t.equipRecord=null,t.treasureRecord=null},n.prototype.initView=function(){this.recordList.renderHandler=Handler.create(this,this.recordListIR,null,!1),tl3d.ModuleEventManager.addEvent(t.HuodongEvent.LUCK_RECORD_CHANGE,this.updateRecordList,this),this.updateRecordList()},n.prototype.updateRecordList=function(){this.recordList.array=this._model.getRecordByType(this.dataSource)},n.prototype.recordListIR=function(t,e){var i=t.dataSource;if(i){t._childs[0].text=i[0],t._childs[0].event(Laya.Event.RESIZE);var n=tb.TB_item.get_TB_itemById(i[1]);t._childs[2].text=n.name+"X"+Snums(i[2]),t.event(Laya.Event.RESIZE)}},n);function n(){return i.call(this)||this}t.LuckyRecordView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=Laya.Image,__extends(n,i),Object.defineProperty(n.prototype,"arrpos",{set:function(t){this._arrpos=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bigSize",{set:function(t){this._isSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"smallSize",{set:function(t){this._originalSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"endIndex",{set:function(t){this._endIdx=t,this._randIdx=t+2,this._randIdx>this._arrpos.length-1&&(this._randIdx=this._randIdx+1-this._arrpos.length)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"posindex",{get:function(){return this._posIdx},set:function(t){this._posIdx=t,this._posIdx>this._arrpos.length-1&&(this._posIdx=0),this._posIdx===this._startIdx&&this._cir++,3<=this._cir&&this._posIdx==this._randIdx&&(this._endCir=!0),this.setSize(),this.setSpeed(),this.setPosition()},enumerable:!0,configurable:!0}),n.prototype.setPosition=function(){this.pos(this._arrpos[this._posIdx][0]+this.offposX,this._arrpos[this._posIdx][1]+this.offposY)},n.prototype.setSize=function(){var t=this._isSize&&this._posIdx%3==0?this._isSize:this._originalSize;this.size(t.width,t.height)},n.prototype.setSpeed=function(){this._endCir?this._speed=this._speed+=50:this._speed=this._speed<60?60:this._speed-=80},n.prototype.isEnd=function(){return!!(this._endCir&&3<=this._cir&&this._posIdx==this._endIdx)&&(Laya.timer.once(500,this,this.stopIt),Dialog.manager.mouseEnabled=!0)},n.prototype.stopIt=function(){""!=this._msg?showToast(this._msg):(this._callback(),App.hero.refreshData(this._data),this._data.items?UIMgr.showUI(UIConst.TurnRewardView,this._data.items):UIUtil.showRewardView(this._data.items?this._data.items:this._data.commonData))},n.prototype.startTurn=function(t,e,i,n){this.posindex=this._posIdx,this._cir=0,this._msg=e,this._data=t,this._speed=450,this.endIndex=i,this._callback=n,this._startIdx=this._posIdx,this.visible||(this.visible=!0),Laya.timer.once(this._speed,this,this.startAction),Dialog.manager.mouseEnabled=this._endCir=!1},n.prototype.startAction=function(){this.posindex=this._posIdx+1,AudioMgr.playSound("sound/xuyuan.mp3"),this.isEnd()||Laya.timer.once(this._speed,this,this.startAction)},n);function n(t){var e=i.call(this)||this;return e._cir=0,e.offposX=-5,e.offposY=-6,e._endIdx=0,e._posIdx=0,e._randIdx=0,e._speed=300,e._startIdx=0,e._endCir=!1,e.visible=!1,e._arrpos=t,e.sizeGrid="20,20,20,20",e.skin=SkinUtil.box_xuanzhong,e._originalSize={width:105,height:105},e}t.LightBox=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.activity.huodong.luckyturn.Tip.TurnRewardUI,__extends(n,e),n.prototype.popup=function(){this.btnBuy.offAll(),this.initView(),e.prototype.popup.call(this)},n.prototype.initView=function(){var t;switch(this.bgPanel.dataSource={title:"comp/title/huodejiangli.png"},tl3d.ModuleEventManager.addEvent(i.ResEvent.RESOURCE_CHANGE,this.setCostText,this),this.btnBuy.on(Laya.Event.CLICK,this,this.onClickBuy),this._curType=this.dataSource.type,this._count=this.dataSource.items.length,this._costdiamong=0,this._curType){case TURNTABLE.GOD:t=App.hero.welfare.luckGodId,this._curTimeTemp=tb.TB_luck_god_time.get_TB_luck_god_timeById(t),this._costdiamong=1==this._count?this._curTimeTemp.buy_cost[0]:this._curTimeTemp.buy_cost[1];break;case TURNTABLE.EQUIP:t=App.hero.welfare.luckEquipId,this._curTimeTemp=tb.TB_luck_equip_time.get_TB_luck_equip_timeById(t),this._costdiamong=1==this._count?this._curTimeTemp.buy_cost[0]:this._curTimeTemp.buy_cost[1];break;case TURNTABLE.TREASURE:t=App.hero.welfare.luckTreasureId,this._curTimeTemp=tb.TB_luck_treasure_time.getTempById(t),this._costdiamong=1==this._count?this._curTimeTemp.buy_cost[0]:this._curTimeTemp.buy_cost[1];break;case TURNTABLE.WISH:this._curTimeTemp=tb.TB_wish_set.get_TB_wish_set(),1<this._count&&(this._count=App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.wishNum)-App.hero.getlimitValue(iface.tb_prop.limitTypeKey.wishMaxNum),this._count=Math.min(this._count,10)),this._costdiamong=this._count*this._curTimeTemp.cost_diamond}this.setCostText(),this.itemList.array=this.dataSource.items},n.prototype.setCostText=function(){this.btn_close.x=0!=this._count?144:280,this.btnBuy.visible=this.box_cost.visible=0!=this._count;var t=i.HuodongModel.getLuckFreeCount(this._curType),e=App.hero.diamond;this._isFree=!1,this._isCanOne=!1,this._isCanTen=!1,1==this._count?0<t?(this.btnBuy.label="免费",this.lbCost.text="0",this.lbCost.color=ColorConst.normalFont,this._isFree=!0):(this.btnBuy.label="购买1次",this.lbCost.text=String(this._costdiamong),e<this._costdiamong?this.lbCost.color=ColorConst.RED:(this.lbCost.color=ColorConst.normalFont,this._isCanOne=!0)):(this.btnBuy.label="购买"+this._count+"次",this.lbCost.text=String(this._costdiamong),e<this._costdiamong?this.lbCost.color=ColorConst.RED:(this.lbCost.color=ColorConst.normalFont,this._isCanTen=!0))},n.prototype.onClickBuy=function(){if(1==this._count){if(!this._isFree&&!this._isCanOne)return void showToast(LanMgr.getLan("",10005))}else if(!this._isCanTen)return void showToast(LanMgr.getLan("",10005));if(this._curType!=TURNTABLE.WISH){var t,e={_0:this._curTimeTemp.ID,_1:this._count};switch(this._curType){case TURNTABLE.GOD:t=Protocol.game_luck_buyluckGod;break;case TURNTABLE.EQUIP:t=Protocol.game_luck_buyluckEquip;break;case TURNTABLE.TREASURE:t=Protocol.game_luck_buyluckTreasure}PLC.request(t,e,function(t,e){t&&(e&&0<e.length?showToast(e):UIMgr.getUIByName(UIConst.LuckyTurnView).startAction(t,e))})}else dispatchEvt(new i.HuodongEvent(i.HuodongEvent.MAKE_PROMISE_SUCCESS),{count:this._count})},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.itemList.array=null,this.bgPanel.dataSource=null,tl3d.ModuleEventManager.removeEvent(i.ResEvent.RESOURCE_CHANGE,this.setCostText,this),this.btnBuy.off(Laya.Event.CLICK,this,this.onClickBuy)},n);function n(){var t=e.call(this)||this;return t._isFree=!1,t._isCanOne=!1,t._isCanTen=!1,t.isModelClose=!0,t}i.TurnRewardView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"HuodongProcessor"},i.prototype.listenModuleEvents=function(){return[new n.HuodongEvent(n.HuodongEvent.MAKE_PROMISE_SUCCESS),new n.HuodongEvent(n.HuodongEvent.UPDATE_QIANDAO_PANEL),new n.HuodongEvent(n.HuodongEvent.GET_LEVELFUND_REWARD),new n.HuodongEvent(n.HuodongEvent.GET_LUCKEQUIP_REWARD),new n.HuodongEvent(n.HuodongEvent.REFRESH_YUEKA_PANEL),new n.HuodongEvent(n.HuodongEvent.RECHARGE_LAVEL_FUND),new n.HuodongEvent(n.HuodongEvent.LUCK_DRWA_OPERATION),new n.HuodongEvent(n.HuodongEvent.SHOW_HUODONG_PANEL),new n.HuodongEvent(n.HuodongEvent.GET_LUCKY_RECORD),new n.HuodongEvent(n.HuodongEvent.AWARD_EVENT)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof n.HuodongEvent)switch(t.type){case n.HuodongEvent.SHOW_HUODONG_PANEL:this.showHuodongPanel(t.data);break;case n.HuodongEvent.MAKE_PROMISE_SUCCESS:this.seconedSure(t.data);break;case n.HuodongEvent.UPDATE_QIANDAO_PANEL:this.updateQianDaoPanel();break;case n.HuodongEvent.RECHARGE_LAVEL_FUND:this.onProtocolRecharge();break;case n.HuodongEvent.GET_LEVELFUND_REWARD:this.onProtocolGift(t.data);break;case n.HuodongEvent.LUCK_DRWA_OPERATION:this.onProtocolLuckdraw(t.data);break;case n.HuodongEvent.GET_LUCKY_RECORD:this.onProtocolLuckRecord(t.data);break;case n.HuodongEvent.GET_LUCKEQUIP_REWARD:this.onProtocolLuckEquipReward(t.data);break;case n.HuodongEvent.REFRESH_YUEKA_PANEL:case n.HuodongEvent.AWARD_EVENT:this.refreshYueka()}},i.prototype.showHuodongPanel=function(t){var e=t[0],i=t[1]||0;if(e==UIConst.WelfareView)UIMgr.showUI(UIConst.WelfareView,i);else if(e==UIConst.PayActivityView)UIMgr.showUI(UIConst.PayActivityView,i);else if(e==UIConst.LuckyTurnView){if(!n.HuodongModel.isOnActivatyTime())return void showToast(LanMgr.getLan("",10218));UIMgr.showUI(UIConst.LuckyTurnView)}else e==UIConst.RealNameView&&UIMgr.showUI(UIConst.RealNameView)},i.prototype.updateQianDaoPanel=function(){this.HuodongView.initSignViewData()},i.prototype.onProtocolRecharge=function(){var t=tb.TB_activity_set.getTabSet().level_recharge,e=Number(window.platform.pid);if(n.ChongzhiModel.isRealPay(e)){var i=tb.TB_recharge.get_TB_rechargeById(t);n.ChongzhiModel.pay(i)}else UIUtil.payDebug(t)},i.prototype.onProtocolGift=function(t){var i=this,e={};e[Protocol.game_activity_getLevelFundReward.args.id]=t,PLC.request(Protocol.game_activity_getLevelFundReward,e,function(t,e){t&&(i.hasPayActivity()&&i.payActivityView.initJijinlist(),UIUtil.showRewardView(t.commonData))})},i.prototype.onProtocolLuckEquipReward=function(t){var e={};e[Protocol.game_activity_getLevelFundReward.args.id]=t,PLC.request(Protocol.game_luck_getluckEquipAward,e,function(t,e){t&&UIUtil.showRewardView(t.commonData)})},i.prototype.onProtocolLuckdraw=function(t){var i=this,e=n.HuodongModel.getInstance().getProtocol(this.LuckyTurnView.tabIdx);PLC.request(e,t,function(t,e){!t||t.hasOwnProperty("luckGodIds")||t.hasOwnProperty("luckEquipIds")||t.hasOwnProperty("luckArtIds")?t&&i.LuckyTurnView&&Laya.timer.once(600,i,function(){i.LuckyTurnView.startAction(t,e)}):showToast(e)})},i.prototype.onProtocolLuckRecord=function(t){var e;switch(t){case TURNTABLE.EQUIP:e=Protocol.center_luck_getLuckEquipRecord;break;case TURNTABLE.TREASURE:e=Protocol.center_luck_getLuckTreasureRecord;break;default:e=Protocol.center_luck_getLuckGodRecord}PLC.request(e,null,function(t,e){if(t){var i=n.HuodongModel.getInstance();t.hasOwnProperty("luckEquipRecord")?i.equipRecord=t.luckEquipRecord:t.hasOwnProperty("luckGodRecord")?i.godRecord=t.luckGodRecord:t.hasOwnProperty("luckTreasureRecord")&&(i.treasureRecord=t.luckTreasureRecord),dispatchEvt(new n.HuodongEvent(n.HuodongEvent.LUCK_RECORD_CHANGE))}})},i.prototype.seconedSure=function(t){var i=this,e={};e[Protocol.game_common_wish.args.count]=Number(t.count),PLC.request(Protocol.game_common_wish,e,function(t,e){logdebug("许愿",t),t&&(i.HuodongView.setwishNums(),i.HuodongView.startLucik(t,e))})},i.prototype.refreshYueka=function(){this.hasPayActivity()&&this.payActivityView.initYuekaView()},Object.defineProperty(i.prototype,"HuodongView",{get:function(){return UIMgr.getUIByName(UIConst.WelfareView)},enumerable:!0,configurable:!0}),i.prototype.hasWelfareView=function(){return UIMgr.hasStage(UIConst.WelfareView)},i.prototype.hasPayActivity=function(){return UIMgr.hasStage(UIConst.PayActivityView)},Object.defineProperty(i.prototype,"payActivityView",{get:function(){return UIMgr.getUIByName(UIConst.PayActivityView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LuckyTurnView",{get:function(){return UIMgr.getUIByName(UIConst.LuckyTurnView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}n.HuodongProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"HuodongModule"},n.prototype.listProcessors=function(){return[new t.HuodongProcessor]},n.prototype.onRegister=function(){t.HuodongModel.getInstance()},n);function n(){return e.call(this)||this}t.HuodongModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.AWARD_EVENT="AWARD_EVENT",r.SHOW_HUODONG_PANEL="SHOW_QIANDAO_PANEL",r.MAKE_PROMISE_SUCCESS="MAKE_PROMISE_SUCCESS",r.UPDATE_QIANDAO_PANEL="UPDATE_QIANDAO_PANEL",r.REFRESH_YUEKA_PANEL="REFRESH_YUEKA_PANEL",r.LUCK_DRWA_OPERATION="LUCK_DRWA_OPERATION",r.RECHARGE_LAVEL_FUND="RECHARGE_LAVEL_FUND",r.GET_LEVELFUND_REWARD="GET_LEVELFUND_REWARD",r.GET_LUCKEQUIP_REWARD="GET_LUCKEQUIP_REWARD",r.GET_LUCKY_RECORD="GET_LUCKY_RECORD",r.BIND_PHONE_EVENT="BIND_PHONE_EVENT",r.SUPER_VIP_RP="SUPER_VIP_RP",r.TEST_REBATE_RP="TEST_REBATE_RP",r.LUCK_GOD_VALUE_CHANGE="LUCK_GOD_VALUE_CHANGE",r.LUCK_EQUIP_VALUE_CHANGE="LUCK_EQUIP_VALUE_CHANGE",r.LUCK_TREASURE_VALUE_CHANGE="LUCK_TREASURE_VALUE_CHANGE",r.LUCK_EQUIP_REWARD_CHANGE="LUCK_EQUIP_REWARD_CHANGE",r.LUCK_RECORD_CHANGE="LUCK_RECORD_CHANGE",r.TOTAL_LOGIN_DAY="TOTAL_LOGIN_DAY",r.LOGIN_GIFT_RECEIVE="LOGIN_GIFT_RECEIVE",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.HuodongEvent=a}(game=game||{}),function(s){var t,e;(e=t=s.WelfareType||(s.WelfareType={}))[e.daySign=1]="daySign",e[e.dayLibao=2]="dayLibao",e[e.weekLibao=3]="weekLibao",e[e.monthLibao=4]="monthLibao",e[e.monthSign=5]="monthSign",e[e.xuyuan=6]="xuyuan",e[e.yueka=7]="yueka",e[e.dengjiJijin=8]="dengjiJijin",e[e.dengjiLibao=9]="dengjiLibao",e[e.duihuan=10]="duihuan";var i=(o.getRewardsInfo=function(t,e){return 1==t?LanMgr.getLan("",10469,e):this.rewards[t]},o.getInstance=function(){return this._instance||(this._instance=new o),this._instance},o.getTotalSignNum=function(){var t=0;for(var e in App.hero.welfare.dailySignIn)0!=App.hero.welfare.dailySignIn[e]&&t++;return t},o.getBuqianNum=function(){var t=0;for(var e in App.hero.welfare.dailySignIn)App.hero.welfare.dailySignIn[e]==iface.tb_prop.signInTypeKey.supplement&&t++;return t},o.isTodaySign=function(){return new Date(1e3*App.serverTimeSecond).getDate()==App.hero.welfare.todaySignIn},o.getSignCost=function(){return tb.TB_game_set.get_TB_game_setById(1).sign_cost},o.getMaxEquipLucky=function(){return tb.TB_luck_equip_reward.get_TB_luck_equip_reward().pop().lucky},o.isOnActivatyTime=function(){return 0<App.hero.welfare.luckEquipId||0<App.hero.welfare.luckGodId||0<App.hero.welfare.luckTreasureId},o.getBoxTb=function(t){switch(t){case TURNTABLE.ART:return tb.TB_luck_artifact_time.get_TB_luck_artifact_timeById();case TURNTABLE.EQUIP:return tb.TB_luck_equip.get_TB_luck_equip();case TURNTABLE.GOD:return tb.TB_luck_god.get_TB_luck_god();case TURNTABLE.WISH:return tb.TB_wish.get_TB_wish();default:return tb.TB_luck_god.get_TB_luck_god()}},o.getRewards=function(e,t){if(t){var i=t.map(function(t){return o.getTbBytype(e,t)});return{data:i.map(function(t){return new ItemVo(t.item[0],t.item[1])}),location:i[0].location}}},o.getTbBytype=function(t,e){switch(t){case TURNTABLE.ART:return tb.TB_luck_artifact.get_TB_luck_artifactById(e);case TURNTABLE.EQUIP:return tb.TB_luck_equip.get_TB_luck_equipById(e);case TURNTABLE.GOD:return tb.TB_luck_god.get_TB_luck_godById(e);case TURNTABLE.WISH:return tb.TB_wish.get_TB_wishById(e);default:return tb.TB_luck_god.get_TB_luck_godById(e)}},o.prototype.getSignTb=function(){var t=Math.floor((App.getServerTime()-App.hero.signInStartTime)/TimeConst.ONE_DAY_SEC)%tb.TB_activity_set.getTabSet().sign_cycle+1;return t=Math.max(1,t),new n(t)},o.prototype.getProtocol=function(t){switch(t){case 0:return Protocol.game_luck_buyluckGod;case 1:return Protocol.game_luck_buyluckEquip;case 2:return Protocol.game_luck_buyluckArt}return null},o.prototype.getLuckEquipExtList=function(){if(!this._LuckEquipExtList){this._LuckEquipExtList=[];var t=tb.TB_luck_equip_reward.get_TB_luck_equip_reward();for(var e in t)this._LuckEquipExtList.push(new r(t[e]));this._LuckEquipExtList.sort(function(t,e){return t.tbReward.ID-e.tbReward.ID})}return this._LuckEquipExtList},o.prototype.getTimeLb=function(t,e){var i=new Date(1e3*App.hero.openSvrTime);i.setHours(0,0,0,0);var n=Math.floor(i.getTime()/1e3),o={startTime:0,endTime:0,rewardTime:""};return 0===t?(o.startTime=0,o.endTime=2544183919,null!=e[2]&&(o.rewardTime="1")):2===t?(o.startTime=n+86400*(e[0]-1),o.endTime=n+86400*e[1],o.rewardTime=activityTime(App.getServerTime(),o.endTime)):1===t&&(o.startTime=new Date(e[0].toString()).getTime()/1e3,o.endTime=new Date(e[1].toString()).getTime()/1e3,o.rewardTime=new Date(e[0].toString()).toLocaleString()),o.rewardTime},o.getRemainTimeByTemp=function(t,e){var i=0,n=App.getServerTime();switch(t){case this.TYPE_TIME_ZERO:case this.TYPE_TIME_ONE:break;case this.TYPE_TIME_TWO:if(e&&1<e.length){var o=new Date(1e3*App.hero.openSvrTime);o.setHours(0,0,0,0);var a=Math.floor(o.getTime()/1e3);i=86400*e[1]+a-n}}return i},o.prototype.getRecordByType=function(t){return t==TURNTABLE.GOD&&this.godRecord?this.godRecord:t==TURNTABLE.EQUIP&&this.equipRecord?this.equipRecord:t==TURNTABLE.TREASURE&&this.treasureRecord?this.treasureRecord:void dispatchEvt(new s.HuodongEvent(s.HuodongEvent.GET_LUCKY_RECORD),t)},o.getLuckIdByType=function(t){switch(t){case TURNTABLE.GOD:return App.hero.welfare.luckGodId;case TURNTABLE.EQUIP:return App.hero.welfare.luckEquipId;case TURNTABLE.ART:return App.hero.welfare.luckArtId;case TURNTABLE.TREASURE:return App.hero.welfare.luckTreasureId;default:return 0}},o.getLuckValueByType=function(t){switch(t){case TURNTABLE.GOD:return App.hero.welfare.luckGodNum;case TURNTABLE.EQUIP:return App.hero.welfare.luckEquipNum;case TURNTABLE.ART:return 0;case TURNTABLE.TREASURE:return App.hero.welfare.luckTreasureNum;default:return 0}},o.getLuckFreeCount=function(t){var e,i=0,n=this.getLuckIdByType(t);switch(t){case TURNTABLE.GOD:i=iface.tb_prop.limitTypeKey.luckGodFreeNum,e=tb.TB_luck_god_time.get_TB_luck_god_timeById(n);break;case TURNTABLE.EQUIP:i=iface.tb_prop.limitTypeKey.luckEquipFreeNum,e=tb.TB_luck_equip_time.get_TB_luck_equip_timeById(n);break;case TURNTABLE.ART:i=iface.tb_prop.limitTypeKey.luckArtFreeNum,e=tb.TB_luck_artifact_time.get_TB_luck_artifact_timeById(n);break;case TURNTABLE.TREASURE:i=iface.tb_prop.limitTypeKey.luckTreasureFreeNum,e=tb.TB_luck_treasure_time.getTempById(n);break;case TURNTABLE.WISH:i=iface.tb_prop.limitTypeKey.wishFreeNum,e=tb.TB_wish_set.get_TB_wish_set()}return 0!=i&&e?(e&&e.free_num?e.free_num:0)-App.hero.getlimitValue(i):0},o.prototype.initCanBuQianDate=function(){var t=new Date(1e3*App.serverTimeSecond).getDate(),e=t==App.hero.welfare.todaySignIn,i=tb.TB_game_set.get_TB_game_setById(1).add_sign-o.getBuqianNum();if(t==Object.keys(App.hero.welfare.dailySignIn).length||!e||i<=0)this.canBuqianDate=0;else for(var n=1;n<=t;n++)if(!(n in App.hero.welfare.dailySignIn)){this.canBuqianDate=n;break}},o.prototype.sevenDaysPackIsAllGet=function(){for(var t=1;t<App.hero.welfare.totalLoginDay+1;t++)if(!App.hero.welfare.loginGiftPack.hasOwnProperty(t))return!0;return!1},o.prototype.isShowLoginGift=function(t){return this._isShowLoginGift[t-1]},o.prototype.initLoginGift=function(){tl3d.ModuleEventManager.addEvent(s.HuodongEvent.TOTAL_LOGIN_DAY,this.updateLoginGift,this),tl3d.ModuleEventManager.addEvent(s.HuodongEvent.LOGIN_GIFT_RECEIVE,this.updateLoginGift,this),this._allTypeLoginGiftTemps=[];for(var t=0;t<tb.TB_sevendays.TYPE_NUM;t++)this._allTypeLoginGiftTemps[t]=tb.TB_sevendays.get_TB_sevendays(t+1);this.updateLoginGift()},o.prototype.updateLoginGift=function(){for(var t=App.hero.welfare.totalLoginDay?App.hero.welfare.totalLoginDay:0,e=App.hero.welfare.loginGiftPack?App.hero.welfare.loginGiftPack:{},i=0;i<tb.TB_sevendays.TYPE_NUM;i++){var n=(i+1)*tb.TB_sevendays.TYPE_DAYS;if(t<i*tb.TB_sevendays.TYPE_DAYS+1)this._isShowLoginGift[i]=!1;else if(t<n)this._isShowLoginGift[i]=!0;else{var o=!1,a=this._allTypeLoginGiftTemps[i];if(a&&0<a.length)for(var r=0;r<a.length;r++){var s=a[r];if(s.ID<=t&&!e.hasOwnProperty(s.ID)){o=!0;break}}this._isShowLoginGift[i]=o}}},o.prototype.autoOpenLoginGift=function(){if(!s.GuideManager.isExecuteGuide()){for(var t=App.hero.welfare.totalLoginDay?App.hero.welfare.totalLoginDay:0,e=App.hero.welfare.loginGiftPack?App.hero.welfare.loginGiftPack:{},i=0;i<tb.TB_sevendays.TYPE_NUM;i++)for(var n=0;n<tb.TB_sevendays.TYPE_DAYS;n++){var o=i*tb.TB_sevendays.TYPE_DAYS+1+n;if(o<=t&&!e.hasOwnProperty(o)){var a=UIConst.LoginGiftView;this._queueDialog.push({uiname:a,data:[i+1],isAlert:!1});break}}if(0!=App.hero.lastGetAfkTime){var r=App.getServerTime()-App.hero.lastGetAfkTime;App.hero.baseAddVipNum(iface.tb_prop.vipPrivilegeTypeKey.offlineIncomeTime)<=r&&this._queueDialog.push({data:{info:LanMgr.getLan("",10493),yesstr:LanMgr.getLan("",10042),type:1},isAlert:!0})}this.checkOpenLoginGift()}},o.prototype.checkOpenLoginGift=function(){var t=this;if(0<this._queueDialog.length){var e=this._queueDialog.shift();e.isAlert?common.AlertBox.showAlert({text:e.data.info,confirmCb:function(){1==e.data.type&&dispatchEvt(new s.HudEvent(s.HudEvent.SHOW_MODULE_VIEW,[ModuleConst.FIGHT]))},closeCb:function(){Laya.timer.callLater(t,t.checkOpenLoginGift)},yes:e.data.yesstr}):UIMgr.showUI(e.uiname,e.data)}},o.prototype.levelPackIsAllGet=function(){var t=tb.TB_level.get_TB_level();for(var e in t)if(App.hero.level>=t[e].level&&!App.hero.welfare.levelGiftPack.hasOwnProperty(t[e].ID))return!0;return!1},o.prototype.ratingFundRedPoint=function(){if(0==App.hero.welfare.buyLevelFund){var t=tb.TB_activity_set.getTabSet().level_fund_buy;return App.hero.vip>=t[0]&&App.hero.diamond>=t[1]}var e=tb.TB_level_fund.get_TB_level_fund();for(var i in e)if(App.hero.level>=e[i].level&&!App.hero.welfare.levelFundAward.hasOwnProperty(e[i].ID))return!0;return!1},o.prototype.everyDaySignRP=function(){for(var t=o.getInstance().getSignTb(),e=0;e<3;e++){if(t.canReward(e)&&2!=e)return!0;if(t.canReward(e)&&2==e&&3<=App.hero.vip)return!0}return!1},o.prototype.luckyEquipExtRewardRP=function(){return 0!=App.hero.welfare.luckEquipId&&o.getInstance().getLuckEquipExtList().some(function(t){return t.canReward()})},o.prototype.refreshActivity=function(){if(UIMgr.hasStage(UIConst.LuckyTurnView)){var t=UIMgr.getUIByName(UIConst.LuckyTurnView);t&&t.updateTab()}},o.prototype.canRewardTestRebate=function(){var t=tb.TB_recharge_rebate.getTBItemById(App.hero.accountName);return t&&0<t.recharge_total&&0==App.hero.welfare.rechargeRebate},o.rewards=[LanMgr.getLan("",10470),LanMgr.getLan("",10471),LanMgr.getLan("",10472)],o.TYPE_TIME_ZERO=0,o.TYPE_TIME_ONE=1,o.TYPE_TIME_TWO=2,o.LuckRedNames=["lucky_god","lucky_equip_free","lucky_art","","lucky_treasure_free"],o);function o(){this.canBuqianDate=0,this._isShowLoginGift=[],this._queueDialog=[],this.welfareTabItemLabel=[[t.daySign,"fuli_meiri","mrqd_fl_icon","每日签到"],[t.monthSign,"fuli_qiandao","myqd_fl_icon","每月签到"],[t.dengjiLibao,"fili_dengji","djlb_fl_icon","等级礼包"],[t.xuyuan,"fuli_xuyuan","xy_fl_icon","许愿"],[t.duihuan,"","dh_fl_icon","兑换"]],this.payTabItemLabel=[[t.dayLibao,"fuli_daylibao","meiri","每日礼包"],[t.weekLibao,"fuli_weeklibao","meizhou","每周礼包"],[t.monthLibao,"fuli_monthlibao","meiyue","每月礼包"],[t.dengjiJijin,"fuli_jijin","djjj_fl_icon","等级基金"],[t.yueka,"fuli_yueka","yk_fl_icon","月卡"]],this.initLoginGift()}s.HuodongModel=i;var n=(Object.defineProperty(a.prototype,"tb",{get:function(){return tb.TB_recharge_sign.get_TB_recharge_signById(this._id)},enumerable:!0,configurable:!0}),a.prototype.initReward=function(){var t=this.tb.reward.map(function(t){return new ItemVo(t[0],t[1])}),e=this.tb.vip_reward.map(function(t){return new ItemVo(t[0],t[1])}),i=this.tb.recharge_reward.map(function(t){return new ItemVo(t[0],t[1])});this.rewardArr.push(t,e,i)},a.prototype.isReward=function(t){return 1==t?1==App.hero.welfare.signInVipCount:0==t?1==App.hero.welfare.signInLoginCount:2==t?1==App.hero.welfare.signInRechargeCount:void 0},a.prototype.isFinish=function(t){return 1==t?App.hero.vip>=this.tb.vip_level:0==t?!(1==App.hero.welfare.signInLoginCount):2==t?App.hero.welfare.dailyRechargeSum>=this.tb.recharge_num:void 0},a.prototype.canReward=function(t){return!this.isReward(t)&&this.isFinish(t)},a);function a(t){this.rewardArr=[],this._id=t,this.initReward()}s.ToSignVo=n;var r=(u.prototype.isFinish=function(){return App.hero.welfare.luckEquipNum>=this.tbReward.lucky},u.prototype.isReward=function(){return!!App.hero.welfare.luckEquipAward[this.tbReward.ID]},u.prototype.getReward=function(){return this.tbReward.reward.map(function(t){return new ItemVo(t[0],t[1])})},u.prototype.canReward=function(){return this.isFinish()&&!this.isReward()},u);function u(t){var e=this;this.tbReward=t,this.event=function(){dispatchEvt(new s.HuodongEvent(s.HuodongEvent.GET_LUCKEQUIP_REWARD),e.tbReward.ID)}}s.LuckEquipExtData=r}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var i,e=(i=ui.activity.download.WeiDuanXiaZaiViewUI,__extends(n,i),n.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.init()},n.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.init()},n.prototype.init=function(){this.btn_download.on(Laya.Event.CLICK,this,this.onDownload),this.btnClose.on(Laya.Event.CLICK,this,this.onExit);var t=tb.TB_activity_set.getTabSet();this.itemlists.dataSource=ary2prop(t.micro_download_reward),listAtCenter(this.itemlists,244,this.itemlists.repeatX,this.itemlists.dataSource.length),this.refreshState()},n.prototype.refreshState=function(){var t=1==App.hero.downClient,e=App.hero.isReceiveWDXZ;t?e?(this.btn_download.disabled=!0,this.btn_download.label="已领取"):(this.btn_download.disabled=!1,this.btn_download.label="领取",this.btn_download.skin="comp/button/btn_qianwang.png",this.btn_download.labelStrokeColor="#2f7806"):(this.btn_download.disabled=!1,this.btn_download.label="立即下载",this.btn_download.skin="comp/button/btn_dengluyouxi.png",this.btn_download.labelStrokeColor="#ca7005")},n.prototype.onDownload=function(){0==App.hero.downClient?dispatchEvt(new t.DownloadeEvent(t.DownloadeEvent.DOWNLOAD_WEIDUAN)):App.hero.isReceiveWDXZ||dispatchEvt(new t.DownloadeEvent(t.DownloadeEvent.SEND_RECEIVE_EVENT))},n.prototype.onExit=function(){UIMgr.hideUIByName(UIConst.WeiDuanXiaZaiView)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.btn_download.off(Laya.Event.CLICK,this,this.onDownload),this.btnClose.off(Laya.Event.CLICK,this,this.onExit)},n);function n(){var t=i.call(this)||this;return t.isModelClose=!0,t}t.WeiDuanXiaZaiView=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"DownloadProcessor"},i.prototype.listenModuleEvents=function(){return[new o.DownloadeEvent(o.DownloadeEvent.SEND_RECEIVE_EVENT),new o.DownloadeEvent(o.DownloadeEvent.SHOW_WDXZ_VIEW),new o.DownloadeEvent(o.DownloadeEvent.DOWNLOAD_WEIDUAN)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof o.DownloadeEvent)switch(t.type){case o.DownloadeEvent.SEND_RECEIVE_EVENT:this.sendReceiveEvent(t.data);break;case o.DownloadeEvent.SHOW_WDXZ_VIEW:this.openWeiDuanXiaZaiView();break;case o.DownloadeEvent.DOWNLOAD_WEIDUAN:this.downloadWD()}},i.prototype.sendReceiveEvent=function(t){var n=this;PLC.request(Protocol.game_welfare_getDownloadApkAward,null,function(t,e){if(t){App.hero.isReceiveWDXZ=0!=t.downloadApkAward,t.commonData&&UIUtil.showRewardView(t.commonData),dispatchEvt(new o.DownloadeEvent(o.DownloadeEvent.RED_CHANGE_EVENT));var i=n.weiDuanXiaZaiView;i&&i.refreshState()}})},i.prototype.openWeiDuanXiaZaiView=function(){UIMgr.showUI(UIConst.WeiDuanXiaZaiView)},i.prototype.downloadWD=function(){BingoSDK.doExtraAction("client",function(t){logyhj("微端下载结果回调"),0==t.code?showToast(LanMgr.getLan("",10217)):showToast(t.message)})},Object.defineProperty(i.prototype,"weiDuanXiaZaiView",{get:function(){return UIMgr.getUIByName(UIConst.WeiDuanXiaZaiView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}o.DownloadProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"DownloadModule"},n.prototype.listProcessors=function(){return[new t.DownloadProcessor]},n.prototype.onRegister=function(){},n);function n(){return e.call(this)||this}t.DownloadModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SEND_RECEIVE_EVENT="SEND_RECEIVE_EVENT",r.RED_CHANGE_EVENT="RED_CHANGE_EVENT",r.SHOW_WDXZ_VIEW="SHOW_WDXZ_VIEW",r.DOWNLOAD_WEIDUAN="DOWNLOAD_WEIDUAN",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.DownloadeEvent=a}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var n,t=(n=ui.activity.shouchong.ShouchongUI,__extends(e,n),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t},enumerable:!0,configurable:!0}),e.prototype.popup=function(t,e){n.prototype.popup.call(this,t,e),this.initView(),this.initAllReward()},e.prototype.initView=function(){var t=this._model.getCurData().tb.ID;if(this.onTabSelect(t-1),this._listItems)for(var e=0;e<this._listItems.length;e++)this._listItems[e].btnsure.on(Laya.Event.CLICK,this,this.onSure);for(e=0;e<3;e++)this.listitem_1["equip"+e].on(Laya.Event.CLICK,this,this.onClickEquip,[e]);dispatchEvt(new o.GuajiEvent(o.GuajiEvent.CLOSE_SHOUCHONG_TIPS))},e.prototype.onTabSelect=function(t){-1!=t&&((t<0||2<t)&&(t=0),this._selectTabNum=t,this.tabBar.selectedIndex=t,this.viewStack.selectedIndex=t,this._listItems[t].visible=!0,this.setViewData(t))},e.prototype.initAllReward=function(){for(var t=this._model.firstRechargeData,e=0;e<t.length;e++)this._listItems[e].list_item.dataSource=t[e].allrewards,2==t[e].tb.show_type&&(this._equipList=t[e].tb.show.map(function(t){var e=new EquipItemVo(tb.TB_item.get_TB_itemById(t[0]));return e.show=!0,e}))},e.prototype.updateView=function(){this.setViewData(this._selectTabNum)},e.prototype.setViewData=function(t,e){e=e||this._model.getDataById(t),(this.dataSource=e).tb;var i=this._listItems[t];i.img_gou0.visible=e.rewards[0].isReward(),i.img_gou1.visible=e.rewards[1].isReward(),i.img_gou2.visible=e.rewards[2].isReward(),i.lab_chong.text="已充值:"+App.hero.welfare.rechargeSum,i.imgRp.visible=!1,e.canReward()?(i.imgRp.visible=!0,i.btnsure.gray=!1,i.btnsure.label="领取",i.btnsure.skin="shouchong/shouchong02.png",i.btnsure.labelColors="#137d47"):e.isReward()?(i.btnsure.gray=!0,i.btnsure.label="已领取",i.btnsure.skin="shouchong/shouchong02.png",i.btnsure.labelColors="#137d47"):e.isAfterRewardday()?(i.btnsure.gray=!0,i.btnsure.label="明日领取",i.btnsure.skin="shouchong/shouchong02.png",i.btnsure.labelColors="#137d47"):(i.btnsure.gray=!1,i.btnsure.label="前往充值",i.btnsure.skin="shouchong/shouchong01.png",i.btnsure.labelColors="#ad4606")},e.prototype.onClickEquip=function(t){this._equipList&&this._equipList[t]&&UIUtil.showTip(this._equipList[t])},e.prototype.onSure=function(){switch(this._listItems[this._selectTabNum].btnsure.label){case"领取":this.send();break;case"前往充值":this.recharge();break;case"已领取":showToast(LanMgr.getLan("",10215));break;case"明日领取":showToast(LanMgr.getLan("",10216))}},e.prototype.send=function(){var t=this.dataSource;dispatchEvt(new o.TopUpEvent(o.TopUpEvent.GET_FIRSTRECHARGE_REWARD),{id:t.tb.ID,day:t.getCanReardId()})},e.prototype.recharge=function(){this.close(),dispatchEvt(new o.TopUpEvent(o.TopUpEvent.SHOW_CHONGZHI_PANEL))},e.prototype.lookGod=function(){var t=this.dataSource.tb.show[0][0],e=tb.TB_god.get_TB_godById(t),i={templateId:e.ID,starLevel:5,level:100,skill:e.skill,degree:5},n=new GodItemVo(i);n.tab_god=e,dispatchEvt(new o.TujianEvent(o.TujianEvent.SHOW_GUAIWUXINXI_PANEL),n)},e.prototype.lookAwakenGod=function(){var t=tb.TB_god.get_TB_godById(3101),e={templateId:t.ID,starLevel:5,level:100,skill:t.skill,degree:5},i=new GodItemVo(e);i.tab_god=t,dispatchEvt(new o.TujianEvent(o.TujianEvent.SHOW_GUAIWUXINXI_PANEL),i)},e.prototype.close=function(t,e,i){void 0===i&&(i=!0),n.prototype.close.call(this,t,e,i)},e.prototype.onClosed=function(){if(n.prototype.onClosed.call(this),this.tabBar.selectedIndex=-1,this.viewStack.selectedIndex=-1,this._listItems)for(var t=0;t<this._listItems.length;t++)this._listItems[t].btnsure.off(Laya.Event.CLICK,this,this.onSure);for(t=0;t<3;t++)this.listitem_1["equip"+t].off(Laya.Event.CLICK,this,this.onClickEquip,[t])},e);function e(){var t=n.call(this)||this;return t._listItems=[],t.tabBar.selectHandler=new Laya.Handler(t,t.onTabSelect),t.isModelClose=!0,t._listItems[0]=t.listitem_0,t._listItems[1]=t.listitem_1,t._listItems[2]=t.listitem_2,t._model=o.ChongzhiModel.getInstance(),t}o.ShouchongView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var i,t=(i=ui.activity.shouchong.ShouchongtishiUI,__extends(n,i),n.prototype.show=function(){i.prototype.show.call(this,!1,!1)},Object.defineProperty(n.prototype,"dataSource",{set:function(t){this.initView(t)},enumerable:!0,configurable:!0}),n.prototype.initHtmlText=function(){this._htmlText.style.color=ColorConst.normalFont,this._htmlText.style.wordWrap=!0,this._htmlText.mouseEnabled=!1,this._htmlText.style.align="left",this._htmlText.style.fontSize=20,this._htmlText.style.leading=5,this._htmlText.style.width=170,this.addChild(this._htmlText),this._htmlText.y=22,this._htmlText.x=36},n.prototype.initView=function(t){this.uiScene.onShow(),this.uiScene.setPos(0,Launch.offsetY),this._htmlText.innerHTML=this.getContext(t),this.refreshModel(1004)},n.prototype.getContext=function(t){switch(t){case 1:return"<span style='color:#f66217;'>首充</span>送<span style='color:#ff0000;'>6星雅典娜</span>，强力输出，颜值担当！";case 2:return"<span style='color:#f66217;'>累充98</span>送<span style='color:#ff0000;'>无畏套装</span>，套装激活，属性飞升！";default:return"<span style='color:#f66217;'>累充198</span>送<span style='color:#ff0000;'>传说托尔</span>，雷神降临，毁天灭地！"}},n.prototype.showShouchong=function(){dispatchEvt(new e.TopUpEvent(e.TopUpEvent.SHOW_SHOUCHONG_PANEL))},n.prototype.refreshModel=function(t){this.uiScene.addModelChar(t,this.x+50,this.y+230,180,2),this.uiScene.sceneChar.play("idea",0)},n.prototype.updateModulePos=function(){this.uiScene&&this.uiScene.sceneChar&&this.uiScene.sceneChar.set2dPos(this.x-20,this.y+230)},n.prototype.onClosed=function(){i.prototype.onClosed.call(this),this.uiScene.onExit()},n);function n(){var t=i.call(this)||this;return t._htmlText=new Laya.HTMLDivElement,t.uiScene=new Base2dSceneLayer,t.addChild(t.uiScene),t.uiScene.zOrder=5,t.initHtmlText(),t.btn_close.on(Laya.Event.CLICK,t,function(){dispatchEvt(new e.GuajiEvent(e.GuajiEvent.CLOSE_SHOUCHONG_TIPS))}),t.img_bg.on(Laya.Event.CLICK,t,t.showShouchong),t}e.ShouchongtishiView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.chongzhi.RechargeSuccUI,__extends(n,e),n.prototype.popup=function(){var t=this.dataSource;this._data=tb.TB_recharge.get_TB_rechargeById(t),!this._data||1<this._data.recharge_type?this.height=310:this.height=450,e.prototype.popup.call(this),this.initView()},n.prototype.initView=function(){var t=this.dataSource;this._addScore=10*this._data.recharge_count,this.box_yueka.visible=0==this._data.recharge_type,this.box_zhonshen.visible=1==this._data.recharge_type;var e=1==App.hero.welfare.goodsRechargeCount[t];this.box_extra.visible=!this.box_yueka.visible&&!this.box_zhonshen.visible,this.lab_score.text=Snums(10*this._data.recharge_count),this.lab_diamonds.text=Snums(10*this._data.recharge_count),this.lab_extra.text=e?(10*this._data.recharge_count).toString():this._data.extra_reward.toString(),this.initItem()},n.prototype.onOpened=function(){e.prototype.onOpened.call(this),this.eff_guang.play()},n.prototype.initItem=function(){if(this.imgLeft.visible=this.imgRight.visible=this.lab_gift_title.visible=!1,this._data&&!(1<this._data.recharge_type)){var t=ary2prop(tb.TB_month_card.getTbMonthCardById(this._data.ID).item_gift);for(var e in t)t[e].show=!0,t[e].startAction=!0;this.imgLeft.visible=this.imgRight.visible=this.lab_gift_title.visible=!0,this.list.repeatX=4<t.length?4:t.length,this.list.width=100*this.list.repeatX+(t.length-1)*this.list.spaceX,this.list.height=100,this.list.y=this.y+247,this.list.x=Laya.stage.width/2-this.list.width/2,this.listVo.initData(this.list),this.listVo._dataSource=t,this.listVo.setZorder(this.zOrder),this.listVo.setWidth(this.list.width),this.listVo.setHeight(this.list.height);var i=this.localToGlobal(new Laya.Point(0,247));this.listVo.setPosition(this.list.x,i.y+15),this._efflist=common.EffectList.showEffectList(this.listVo)}},n.prototype.close=function(){e.prototype.close.call(this),this.dataSource&&this.dataSource.callback&&this.dataSource.callback.call(null),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null,AudioMgr.playSound("sound/getreward.mp3")),this.eff_guang.stop()},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),this.height=310,this.imgLeft.visible=this.imgRight.visible=this.lab_gift_title.visible=!1,t.ChongzhiModel.getInstance().arrPop(),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),this.list.array=null},n);function n(){var t=e.call(this)||this;return t.isModelClose=!1,t.list.visible=!1,t.listVo=new ListVo(t.list),t.btnComfirnm.on(Laya.Event.CLICK,t,t.close),t}t.RechargeSuccView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(u){var i,t=(i=ui.activity.chongzhi.RechargeGiftSuccUI,__extends(h,i),h.prototype.show=function(t,e){i.prototype.show.call(this,t,e),this.initView()},h.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},h.prototype.initView=function(){this.eff_guang.play();var t=this.dataSource,e=tb.TB_recharge.get_TB_rechargeById(t);this.lab_score.text=Snums(10*e.recharge_count);var i=[];if(-1!=h.OPENSERVER_GIFT_ID.indexOf(t)){var n=u.OpenserverModel.getInstance().getOsGiftByRechargeid(t);n&&(i=ary2prop(n.reward))}else if(-1!=h.OPENSERVER_HAOLI_GIFT_ID.indexOf(t)){var o=tb.TB_openservice.getTB_openserviceByChargeid(t);o&&(i=ary2prop(o.reward))}else if(-1!=h.CHAOZHI_GIFT_ID.indexOf(t)){var a=tb.TB_operate_activity.get_TB_operate_activity("index",t+"");a[0]&&(i=ary2prop(a[0].reward))}else if(-1!=tb.TB_daily_recharge.getAllRecharges().indexOf(t))(r=tb.TB_daily_recharge.getTBByRechargeId(t))&&(i=ary2prop(r.reward));else if(-1!=tb.TB_week_recharge.getAllRecharges().indexOf(t))(r=tb.TB_week_recharge.getTBByRechargeId(t))&&(i=ary2prop(r.reward));else if(-1!=tb.TB_month_recharge.getAllRecharges().indexOf(t))(r=tb.TB_month_recharge.getTBByRechargeId(t))&&(i=ary2prop(r.reward));else{if(-1!=h.FUND_GIFT_ID.indexOf(t))return this.lab_tq.text=LanMgr.getLan("激活{0}基金",-1,e.recharge_count),void(this.height=300);if(-1!=h.LEVEL_FUND_GIFT_ID.indexOf(t))return this.lab_tq.text=LanMgr.getLan("激活等级基金特权",-1),void(this.height=300);var r;-1!=tb.TB_warrior_cycle.getAllRecharges().indexOf(t)&&(this.lab_tq.text=LanMgr.getLan("解锁勇者之证进阶奖励",-1),(r=u.WarriorProveModel.getInstance().curTabCycle)&&(i=ary2prop(r.activate_reward)))}for(var s in this.lab_tq.text="",i)i[s].show=!0,i[s].startAction=!0;this.list.repeatX=4<i.length?4:i.length,this.list.width=100*this.list.repeatX,this.list.height=100,this.list.y=this.y-20,this.list.x=Laya.stage.width/2-45-(this.list.repeatX-1)*((90+this.list.spaceX)/2),this.listVo.initData(this.list),this.listVo._dataSource=i,this.listVo.setZorder(this.zOrder),this.listVo.setWidth(this.list.width),this.listVo.setHeight(this.list.height),this.listVo.setPosition(this.list.x,this.list.y),this._efflist=common.EffectList.showEffectList(this.listVo),this.height=350},h.prototype.close=function(){i.prototype.close.call(this),this.dataSource&&this.dataSource.callback&&this.dataSource.callback.call(null),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),this.eff_guang.stop(),AudioMgr.playSound("sound/getreward.mp3")},h.prototype.onClosed=function(){i.prototype.onClosed.call(this),this._efflist&&(this._efflist.stratEndAction(),this._efflist=null),this.list.array=null,u.ChongzhiModel.getInstance().showVipupPanel()},h.OPENSERVER_GIFT_ID=[26,27,28,29,30,31,32],h.FUND_GIFT_ID=[24,25],h.OPENSERVER_HAOLI_GIFT_ID=[17,18,19,20,21,22,23],h.LEVEL_FUND_GIFT_ID=[16],h.CHAOZHI_GIFT_ID=[10,11,12,13,14,15],h);function h(){var t=i.call(this)||this;return t.isModelClose=!1,t.list.visible=!1,t.listVo=new ListVo(t.list),t.btnComfirnm.on(Laya.Event.CLICK,t,t.close),t}u.RechargeGiftSuccView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var e,t=(e=ui.activity.chongzhi.ChongzhiUI,__extends(i,e),i.prototype.popup=function(){e.prototype.popup.call(this),this.refreshData(),this.dataSource?this.onTequan():this.onChongzhi(),this.bgPanel.dataSource={uiName:UIConst.ChongzhiView,closeOnSide:!1,closeOnButton:!1,title:"充 值"},this.btnClose.on(Laya.Event.CLICK,this,this.onCLickClose)},i.prototype.refreshData=function(){var t;this.exp();for(var e=new Array,i=1;i<10;i++)1!=i&&2!=i&&(t=tb.TB_recharge.get_TB_rechargeById(i),e.push(t));e.sort(function(t,e){return t.rank-e.rank}),this.list_item.dataSource=e,this.list_item.selectedIndex=-1,this.lbl_vip.text=App.hero.vip.toString()},i.prototype.exp=function(){var t=App.getMaxVipLv(),e=App.hero.vip==t?tb.TB_vip.get_TB_vipById(t):tb.TB_vip.get_TB_vipById(App.hero.vip+1),i=App.hero.vipScore,n=1;e&&(n=i/(10*e.recharge)),this.probar_exp.value=n,this.explabui.text=i+"/"+10*e.recharge,this.box_nextlv.visible=15!=App.hero.vip,this.lab_more.text=Snums(Math.floor(10*e.recharge-i)),this.lab_nextlv.text="VIP"+(App.hero.vip+1)},i.prototype.onSelect=function(t){if(-1!=t){var e=this.list_item.dataSource[t],i=Number(window.platform.pid);n.ChongzhiModel.isRealPay(i)?n.ChongzhiModel.pay(e):this.test(e),this.list_item.selectedIndex=-1}},i.prototype.onMouse=function(t,e){switch(t.type){case Laya.Event.MOUSE_DOWN:AudioMgr.playSound(),t.target.scaleX=.9,t.target.scaleY=.9;break;case Laya.Event.MOUSE_OUT:case Laya.Event.MOUSE_UP:t.target.scaleX=1,t.target.scaleY=1}},i.prototype.test=function(t){var e=this;UIUtil.payDebug(t.ID,null,function(){dispatchEvt(new n.HuodongEvent(n.HuodongEvent.REFRESH_YUEKA_PANEL)),e.refreshData(),e.list_item.selectedIndex=-1})},i.prototype.onTequan=function(){var t;t=0<App.hero.vip?tb.TB_vip.get_TB_vipById(App.hero.vip):tb.TB_vip.get_TB_vipById(1),this.list_item.visible=!1,this.box_cz.visible=!1,this.btn_chongzhi.visible=!0,this.btn_tequan.visible=!1,this.view_tequan.visible=!0,this.view_tequan.dataSource=t},i.prototype.onCLickClose=function(){UIMgr.hideUIByName(UIConst.ChongzhiView)},i.prototype.onChongzhi=function(){this.list_item.visible=!0,this.box_cz.visible=!0,this.btn_chongzhi.visible=!1,this.btn_tequan.visible=!0,this.view_tequan.visible=!1,this.view_tequan.dataSource=null},i.prototype.close=function(){e.prototype.close.call(this),this.btnClose.off(Laya.Event.CLICK,this,this.onCLickClose),this.bgPanel.dataSource=null,this.list_item.dataSource=null,this.view_tequan.dataSource=null},i);function i(){var t=e.call(this)||this;return t.isModelClose=!0,t.btn_tequan.on(Laya.Event.CLICK,t,t.onTequan),t.btn_chongzhi.on(Laya.Event.CLICK,t,t.onChongzhi),t.list_item.selectHandler=new Handler(t,t.onSelect),t.list_item.mouseHandler=new Handler(t,t.onMouse),t.bgPanel.box_Content.addChild(t.img_bg),t}n.ChongzhiView=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.chongzhi.BuySuccUI,__extends(n,e),n.prototype.popup=function(){e.prototype.popup.call(this),this.initView()},n.prototype.initView=function(){var t=this.dataSource;tb.TB_recharge.get_TB_rechargeById(t)},n.prototype.onClosed=function(){e.prototype.onClosed.call(this),t.ChongzhiModel.getInstance().arrPop()},n);function n(){return e.call(this)||this}t.BuySuccView=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=ui.activity.chongzhi.TabTequanUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData()},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(){var t=this.dataSource;t&&(this.lab_yuanjia.text=String(t.original_price),this.lab_xianjia.text=String(t.now_price),this.now=t.ID,this.updateBtn(),this.controls(),this.tequaninfo(t),this.icondata(t),this.updateRedPoint())},n.prototype.updateBtn=function(){this.btn_right.gray=this.now==App.getMaxVipLv(),this.btn_left.gray=1==this.now},n.prototype.tequaninfo=function(t){for(var e=new Array,i=tb.TB_vip_privilege.get_TB_vip_privilege("vip_level",this.now+""),n=0;n<i.length;n++)e.push({desc:i[n].desc,isspecial:i[n].is_show_special,rank:0});if(1==this.now)e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum,t.god_limit)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.arenaBuyNum,t.arena_buy)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.quickBattleNum,t.fast_fighting)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.wishNum,t.wish_limit)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.hangupIncome,t.hang_up)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.guildCopyBuyNum,t.guildcopy_buy)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum,t.daily_copy)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.goldBuyNum,t.gold_exchange)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.worldBossNum,t.worldboss)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.runeCopyExtraNum,t.match_buy)),e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.godDmRewardNum,t.fight_goddomain));else{var o=tb.TB_vip.get_TB_vipById(this.now-1);o.god_limit!=t.god_limit&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.godMaxNum,t.god_limit)),o.arena_buy!=t.arena_buy&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.arenaBuyNum,t.arena_buy)),o.fast_fighting!=t.fast_fighting&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.quickBattleNum,t.fast_fighting)),o.wish_limit!=t.wish_limit&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.wishNum,t.wish_limit)),o.hang_up!=t.hang_up&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.hangupIncome,t.hang_up)),o.guildcopy_buy!=t.guildcopy_buy&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.guildCopyBuyNum,t.guildcopy_buy)),o.daily_copy!=t.daily_copy&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.dailyCopyBuyNum,t.daily_copy)),o.gold_exchange!=t.gold_exchange&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.goldBuyNum,t.gold_exchange)),o.worldboss!=t.worldboss&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.worldBossNum,t.worldboss)),o.match_buy!=t.match_buy&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.runeCopyExtraNum,t.match_buy)),o.fight_goddomain!=t.fight_goddomain&&e.push(this.getTeQuanInfo(iface.tb_prop.vipPrivilegeTypeKey.godDmRewardNum,t.fight_goddomain)),e.push({desc:LanMgr.getLan("包含VIP{0}所有特权",-1,this.now-1),isspecial:0,rank:1e5})}e.sort(function(t,e){return t.rank-e.rank}),this.list_tequaninfo.dataSource=e},n.prototype.getTeQuanInfo=function(t,e){var i=tb.TB_vip_desc.get_TB_vip_descById(t);if(!i)return{desc:e,isspecial:0,rank:99999};var n="";return t==iface.tb_prop.vipPrivilegeTypeKey.offlineIncomeTime&&(e/=3600),t==iface.tb_prop.vipPrivilegeTypeKey.hangupIncome&&(n="%"),{desc:LanMgr.getLan(i.desc+n,-1,e),isspecial:0,rank:i.rank}},n.prototype.icondata=function(t){for(var e=new Array,i=0;i<t.item_gift.length;i++){var n;n=App.hero.createItemVo(t.item_gift[i][1],t.item_gift[i][0]),e.push({item:n,play:i<t.flash_num})}this.list_icon.dataSource=e,this.list_icon.repeatX=5<e.length?5:e.length,this.list_icon.centerX=.5},n.prototype.onInfoRender=function(t,e){t.text=e+1+"."+this.list_tequaninfo.dataSource[e].desc,1==this.list_tequaninfo.dataSource[e].isspecial?t.color="#c26939":t.color="#72503f"},n.prototype.updateRedPoint=function(){var t=i.ChongzhiModel.getInstance();this.img_rpbuy.visible=this.img_rpleft.visible=this.img_rpright.visible=!1;for(var e=0;e<this.now;e++)t.isVisibleByid(e)&&(this.img_rpleft.visible=!0);for(e=this.now+1;e<=16;e++)t.isVisibleByid(e)&&(this.img_rpright.visible=!0);t.isVisibleByid(this.now)&&(this.img_rpbuy.visible=!0),dispatchEvt(new i.TopUpEvent(i.TopUpEvent.UPDATE_TEQUANRED_EVEN))},n.prototype.onRight=function(){var t=App.getMaxVipLv();if(this.now<t){this.now++;var e=tb.TB_vip.get_TB_vipById(this.now);this.dataSource=e,this.refreshData(),this.controls(),this.updateBtn()}},n.prototype.onLeft=function(){if(1<this.now){this.now--;var t=tb.TB_vip.get_TB_vipById(this.now);this.dataSource=t,this.refreshData(),this.controls(),this.updateBtn()}},n.prototype.controls=function(){this.img_vip.text="VIP"+this.now.toString()+"特权",this.lab_vip.text="VIP"+this.now+"尊享礼包",App.hero.welfare.privilegeGiftPack[this.now]?(this.img_hasbuy.visible=!0,this.btn_buy.visible=!1):(this.img_hasbuy.visible=!1,this.btn_buy.visible=!0)},n.prototype.onBuy=function(){var i=this;if(this.now>App.hero.vip)showToast(LanMgr.getLan("",10214,this.now));else{var t={};t[Protocol.game_welfare_privilegeGiftPack.args.id]=this.now,PLC.request(Protocol.game_welfare_privilegeGiftPack,t,function(t,e){t&&(UIUtil.showRewardView(t.commonData,null,!1,UI_DEPATH_VALUE.TOP),App.hero.welfare.privilegeGiftPack[i.now]=t.privilegeGiftPack[i.now],i.controls(),i.updateRedPoint())})}},n);function n(){var t=e.call(this)||this;return t.list_tequaninfo.renderHandler=new Handler(t,t.onInfoRender),t.btn_left.on(Laya.Event.CLICK,t,t.onLeft),t.btn_right.on(Laya.Event.CLICK,t,t.onRight),t.btn_buy.on(Laya.Event.CLICK,t,t.onBuy),t}i.TabTequan=t}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.chongzhi.teQuanItemIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){var e=this;t?(this.visible=!0,this.ui_item.dataSource=t.item,t.play?(this.eff.visible=!0,this.eff.loadAnimation(ResConst.anim_teshutishi,Handler.create(null,function(){e.eff.play(1,!0)}),ResConst.atlas_teshutishi)):(this.eff.visible=!1,this.eff.stop())):(this.visible=!1,this.eff.stop())},n);function n(){return e.call(this)||this}t.TeQuanItemIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.shouchong.RewardIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){(this._dataSource=t)&&this.refresh()},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){var t=this.dataSource,e=(t.isFinish(),t.isReward());this.itemList.array=t.reward,this.imgAlready.visible=e,this._day=this.parent.getChildIndex(this)+1,this.lbday.changeText("第"+this._day+"天免费领"),this.itemList.x=31+(4-this.itemList.length)*(90+this.itemList.spaceX)/2},n);function n(){return e.call(this)||this}t.RewardIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=ui.activity.chongzhi.ChongzhiIRUI,__extends(n,e),Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},set:function(t){this._dataSource=t,this.refreshData(t)},enumerable:!0,configurable:!0}),n.prototype.refreshData=function(t){t?(this.location(t.ID),this.lab_money.text="￥"+t.recharge_count,this.img_bg.skin="chongzhitequan/xiaokuang.png",this.img_type.skin=SkinUtil.getZuanshiUrl(t.recharge_count),this.panduan(t.ID),this.lab_extra.color="#f66217"):logdebug("置空")},n.prototype.panduan=function(t){var e="获得"+10*this._dataSource.recharge_count+"钻石\n";this.lab_extra.text=LanMgr.getLan(e,-1),0<App.hero.welfare.goodsRechargeCount[t]?(this.img_info.visible=3!=t,this.img_info.skin=SkinUtil.getChongzhiUrl("chaozhi"),this.lab_extra_1.text=0<this._dataSource.extra_reward?LanMgr.getLan("额外送"+this._dataSource.extra_reward+"钻石",-1):""):(this.img_info.skin=SkinUtil.getChongzhiUrl("shuangbei"),this.lab_extra_1.text=LanMgr.getLan("首充送"+10*this._dataSource.recharge_count+"钻石",-1))},n.prototype.location=function(t){switch(t){case 3:this.img_type.x=98,this.img_type.y=32;break;case 4:this.img_type.x=89,this.img_type.y=32;break;case 5:this.img_type.x=68,this.img_type.y=25;break;case 6:this.img_type.x=91,this.img_type.y=14;break;case 7:this.img_type.x=84,this.img_type.y=13;break;default:this.img_type.x=69,this.img_type.y=13}},n);function n(){return e.call(this)||this}t.ChongzhiIR=i}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(n){var t,e=(t=tl3d.Processor,__extends(i,t),i.prototype.getName=function(){return"ChongzhiProcessor"},i.prototype.listenModuleEvents=function(){return[new n.TopUpEvent(n.TopUpEvent.SHOW_CHONGZHI_PANEL),new n.TopUpEvent(n.TopUpEvent.SHOW_SHOUCHONG_PANEL),new n.TopUpEvent(n.TopUpEvent.SHOW_CHONGZHISUCC_PANEL),new n.TopUpEvent(n.TopUpEvent.GET_FIRSTRECHARGE_REWARD),new n.ResEvent(n.ResEvent.RESOURCE_CHANGE),new n.ResEvent(n.ResEvent.VIP_LEVEL_CHANGE),new n.HuodongEvent(n.TopUpEvent.XIANGOU_LIBAO_CHANGE)]},i.prototype.receivedModuleEvent=function(t){if(t instanceof n.TopUpEvent)switch(t.type){case n.TopUpEvent.SHOW_CHONGZHI_PANEL:this.show_ChongzhiView(t.data);break;case n.TopUpEvent.SHOW_CHONGZHISUCC_PANEL:this.show_ChongzhiSuccView(t.data);break;case n.TopUpEvent.SHOW_SHOUCHONG_PANEL:this.showShouchongPanel();break;case n.TopUpEvent.GET_FIRSTRECHARGE_REWARD:this.getRewardById(t.data);break;case n.TopUpEvent.XIANGOU_LIBAO_CHANGE:this.onLibaoUpdate()}else if(t instanceof n.ResEvent)switch(t.type){case n.ResEvent.RESOURCE_CHANGE:case n.ResEvent.VIP_LEVEL_CHANGE:this.chongzhiview&&this.chongzhiview.refreshData(),this.hudView&&this.hudView.setVip()}},i.prototype.onLibaoUpdate=function(){UIMgr.hasStage(UIConst.PayActivityView)&&UIMgr.getUIByName(UIConst.PayActivityView).updateXiangouLibao()},i.prototype.show_ChongzhiView=function(t){UIMgr.showUI(UIConst.ChongzhiView,t)},i.prototype.show_ChongzhiSuccView=function(t){var e=t.rechargeGoodsIds||[];for(var i in e)3!=tb.TB_recharge.get_TB_rechargeById(e[i]).recharge_type?n.ChongzhiModel.getInstance().arrPushBack(e[i]):UIMgr.showUI(UIConst.Topup_GiftSuccView,e[i]);-1!=e.indexOf(tb.TB_activity_set.getTabSet().level_recharge)&&UIMgr.hasStage(UIConst.PayActivityView)&&UIMgr.getUIByName(UIConst.PayActivityView).setBtnLabel(),UIMgr.hasStage(UIConst.TupUp_FirstView)&&UIMgr.getUIByName(UIConst.TupUp_FirstView).updateView(),UIMgr.hasStage(UIConst.Shop_BuyView)&&UIMgr.getUIByName(UIConst.Shop_BuyView).init(),dispatchEvt(new n.TopUpEvent(n.TopUpEvent.SHOUCHONG_RED_EVEN))},i.prototype.updateShouchongPanel=function(){if(UIMgr.hasStage(UIConst.TupUp_FirstView)){var t=UIMgr.getUIByName(UIConst.TupUp_FirstView);t.setViewData(t._selectTabNum)}},i.prototype.getRewardById=function(t){var i=this,e={};e[Protocol.game_welfare_firstRecharge.args.id]=t.id,e[Protocol.game_welfare_firstRecharge.args.day]=t.day,PLC.request(Protocol.game_welfare_firstRecharge,e,function(t,e){t&&(i.firstview.updateView(),UIUtil.showRewardView(t.commonData),dispatchEvt(new n.TopUpEvent(n.TopUpEvent.SHOUCHONG_RED_EVEN)))})},i.prototype.showShouchongPanel=function(){UIMgr.showUI(UIConst.TupUp_FirstView)},Object.defineProperty(i.prototype,"firstview",{get:function(){return UIMgr.getUIByName(UIConst.TupUp_FirstView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"chongzhiview",{get:function(){return UIMgr.getUIByName(UIConst.ChongzhiView)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hudView",{get:function(){return UIMgr.getUIByName(UIConst.HudView)},enumerable:!0,configurable:!0}),i);function i(){return t.call(this)||this}n.ChongzhiProcessor=e}(game=game||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=tl3d.Module,__extends(n,e),n.prototype.getModuleName=function(){return"ChongzhiModule"},n.prototype.listProcessors=function(){return[new t.ChongzhiProcessor]},n.prototype.onRegister=function(){t.ChongzhiModel.getInstance().initModel()},n);function n(){return e.call(this)||this}t.ChongzhiModule=i;var o,a=(o=tl3d.BaseEvent,__extends(r,o),r.SHOW_CHONGZHI_PANEL="SHOW_CHONGZHI_PANEL",r.SHOW_CHONGZHISUCC_PANEL="SHOW_CHONGZHISUCC_PANEL",r.SHOW_SHOUCHONG_PANEL="SHOW_SHOUCHONG_PANEL",r.GET_FIRSTRECHARGE_REWARD="GET_FIRSTRECHARGE_REWARD",r.SHOUCHONG_RED_EVEN="SHOUCHONG_RED_EVEN",r.UPDATE_TEQUANRED_EVEN="UPDATE_TEQUANRED_EVEN",r.XIANGOU_LIBAO_CHANGE="XIANGOU_LIBAO_CHANGE",r.CHONGZHI_SUCCESS="CHONGZHI_SUCCESS",r);function r(){return null!==o&&o.apply(this,arguments)||this}t.TopUpEvent=a}(game=game||{}),function(t){var e=(i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.isRealPay=function(t){var e=iface.tb_prop.platformTypeKey;return-1!=[e.version,e.buddy,e.lezhong].indexOf(Number(t))},i.pay=function(t,e){void 0===e&&(e=null);var i=Number(window.platform.pid),n={},o=iface.tb_prop.platformTypeKey;if(i==o.buddy){var a=(new Date).getTime(),r=Math.floor(a/1e3),s=String(a)+randomNum(5),u=window.platform.serverInfo.serverId,h=hex_md5("cpOrderId="+s+"&gameId="+BingoSDK.gameId+"&goodsId="+t.ID+"&goodsName="+encodeURIComponent(t.desc)+"&money="+t.recharge_count+"&role="+App.hero.playerId+"&server="+u+"&time="+r+"&uid="+App.hero.puid+"&key="+BingoSDK.payKey);n={gameId:BingoSDK.gameId,uid:App.hero.puid,server:u,role:App.hero.playerId,goodsId:t.ID,goodsName:encodeURIComponent(t.desc),money:t.recharge_count,cpOrderId:s,sign:h,time:r}}else i!=o.lezhong&&i!=o.version||(u=window.platform.serverInfo.serverId,n={money:t.recharge_count,goodsId:t.ID,goodsName:t.desc,goodsDesc:t.desc,playerId:App.hero.playerId,playerName:App.hero.name,playerLevel:App.hero.level,serverId:u,serverName:""});0<Object.keys(n).length&&(BingoSDK.pay(n,function(){logdebug("充值成功！"),e&&e()}),window.platform.reportInfo())},i.prototype.initModel=function(){},i.prototype.initFirstData=function(){var t=tb.TB_first_recharge.get_TB_first_recharge();this.firstRechargeData=t.map(function(t){return new n(t)})},i.prototype.hasShouChongTip=function(){return-1!=this.firstRechargeData.findIndex(function(t){return!t.isFinish()})},i.prototype.getCurData=function(){var t=this.firstRechargeData,e=t.find(function(t){return!t.isFinish()});return e||t[t.length-1]},i.prototype.getDataById=function(t){return this.firstRechargeData[t]},i.prototype.isAllReward=function(){return!this.firstRechargeData.some(function(t){return!t.isReward()})},i.prototype.arrPushBack=function(t){var e=0==this.rechargeSuccLists.length;this.rechargeSuccLists.push(t),e&&this.showPanel(t)},i.prototype.arrPop=function(){if(this.rechargeSuccLists.shift(),0!=this.rechargeSuccLists.length){var t=this.rechargeSuccLists[0];this.showPanel(t)}else this.showVipupPanel()},i.prototype.showPanel=function(t){UIMgr.showUI(UIConst.Topup_SuccView,t)},i.prototype.showVipupPanel=function(){this.chongzhiVipData&&0<Object.keys(this.chongzhiVipData).length&&(UIUtil.showVipupPanel(this.chongzhiVipData),this.chongzhiVipData=null)},i.prototype.canRedPoint=function(t){var e=this.firstRechargeData[t];return!!e&&e.canReward()},i.prototype.isVisibleByid=function(e){return this.isEnoughBuyTequan(),-1!=this._tequanArr.findIndex(function(t){return t==e})},i.prototype.isEnoughBuyTequan=function(){this._tequanArr=[];for(var t=0;t<=App.hero.vip;t++)App.hero.welfare.privilegeGiftPack[t]||this.isEnoughBuyTequanById(t)&&this._tequanArr.push(t);return 0<this._tequanArr.length},i.prototype.isEnoughBuyTequanById=function(t){var e=tb.TB_vip.get_TB_vipById(t);return!(!e||!App.isEnough(iface.tb_prop.resTypeKey.diamond,e.now_price))},i.prototype.tequanRedPoint=function(){return this.isEnoughBuyTequan()},i);function i(){this.rechargeSuccLists=new Array,this.chongzhiVipData={},this._tequanArr=[],this.initFirstData(),this.firstRechargeName=[["超值首充","firstRechage_chaozhi"],["豪华首充","firstRechage_haohua"],["至尊首充","firstRechage_zhixun"]]}t.ChongzhiModel=e;var n=(o.prototype.initReward=function(){for(var t=[],e=this.tb,i=e.ID,n=e.recharge_count,o=1;o<4;o++){var a=e["reward_"+o].map(function(t){return new ItemVo(t[0],t[1])});t.push(new r(i,o,n,a))}return t},o.prototype.isFinish=function(){return App.hero.welfare.rechargeSum>=this.tb.recharge_count},o.prototype.isReward=function(){return!this.rewards.some(function(t){return!t.isReward()})},o.prototype.canReward=function(){return 99!=this.getCanReardId()},o.prototype.redPoint=function(){return!this.rewards[0].isReward()},o.prototype.getCanReardId=function(){var t=this.rewards.find(function(t){return t.canReward()});return t?t.day:99},o.prototype.isAfterRewardday=function(){return this.isFinish()&&99==this.getCanReardId()&&!this.isReward()},o);function o(t){this.tb=t,this.rewards=this.initReward(),this.allrewards=[];for(var e=0;e<this.rewards.length;e++)this.allrewards=this.allrewards.concat(this.rewards[e].reward)}t.FirstRechargeData=n;var r=(a.prototype.getRewardId=function(){return 10*this.id+this.day},a.prototype.getRechargeTime=function(){var t=App.hero.welfare.firstRechargeTime[this.id];if(t){var e=new Date(1e3*t);return e.setHours(0,0,0,0),Math.ceil((Date.now()-e.getTime())/TimeConst.ONE_DAY_MILSEC)}return null},a.prototype.isOutTime=function(){var t=this.getRechargeTime();return t&&t>=this.day},a.prototype.isRechargeCount=function(){return App.hero.welfare.rechargeSum>=this.recharNum},a.prototype.isFinish=function(){return this.isRechargeCount()&&this.isOutTime()},a.prototype.isReward=function(){var t=this.getRewardId();return!!App.hero.welfare.firstRecharge[t]&&1==App.hero.welfare.firstRecharge[t]},a.prototype.canReward=function(){return this.isFinish()&&!this.isReward()},a);function a(t,e,i,n){this.id=t,this.day=e,this.reward=n,this.recharNum=i}t.FirstIRData=r}(game=game||{});var game,tb;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();function traceNoTabelData(){throw new Error("数据表无")}!function(n){var i,t=(i=ui.activity.bindPhone.BindPhoneUI,__extends(e,i),e.prototype.createChildren=function(){i.prototype.createChildren.call(this),this.isModelClose=!0},e.prototype.popup=function(t,e){i.prototype.popup.call(this,t,e),this.initView()},e.prototype.onClosed=function(){i.prototype.onClosed.call(this),tl3d.ModuleEventManager.removeEvent(n.ResEvent.RESOURCE_CHANGE,this.updateView,this),this.bgPanel.dataSource=null},e.prototype.initView=function(){tl3d.ModuleEventManager.addEvent(n.ResEvent.RESOURCE_CHANGE,this.updateView,this),this.bgPanel.dataSource={title:"yunyingxuqiu/bangdingshouji.png"},this.updateView()},e.prototype.updateView=function(){var t=ary2prop(tb.TB_activity_set.getTabSet().phone_bind_reward);this.list_reward.array=t,this.list_reward.width=100*t.length+(t.length-1)*this.list_reward.spaceX,this.refreshState()},e.prototype.refreshState=function(){var t=1==App.hero.bindPhone,e=0!=App.hero.bindMobileAward,i=t&&!e;this.btn_recive.skin=i?SkinUtil.buttonGreen:SkinUtil.buttonNormal,this.btn_recive.labelStrokeColor=i?ColorConst.GREEN_FILTER:ColorConst.ORANGE_FILTER,this.btn_recive.label=e?"已领取":t?"领取":"立即绑定",this.btn_recive.gray=e,this.btn_recive.selected=this.btn_recive.gray},e.prototype.onRecive=function(){var i=this;0!=App.hero.bindMobileAward?showToast(LanMgr.getLan("",10043)):(App.hero.bindPhone,PLC.request(Protocol.game_welfare_getBindMobileAward,null,function(t,e){t&&(App.hero.bindMobileAward=t.bindMobileAward,i.refreshState(),UIUtil.showRewardView(t.commonData),dispatchEvt(new n.HuodongEvent(n.HuodongEvent.BIND_PHONE_EVENT)))}))},e);function e(){var t=i.call(this)||this;return t.btn_recive.on(Laya.Event.CLICK,t,t.onRecive),t}n.BindPhoneView=t}(game=game||{}),function(r){var t=(i.get_TB_hudById=function(t){return TableData.getInstance().getData(TableData.tb_hud,t)},i.get_TB_hudBySysId=function(e){return i.get_TB_hud().find(function(t){return t.system_id==e})},i.get_TB_hud=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_hud);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},i);function i(){}r.TB_hud=t;var e=(n.get_TB_sys_openById=function(t){var e=TableData.getInstance().getData(TableData.tb_sys_open,t);return e||logerror("没有该系统id",t),e},n.get_TB_sys_open=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_sys_open);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},n);function n(){}r.TB_sys_open=e;var o=(a.get_TB_rolenById=function(t){return TableData.getInstance().getData(TableData.tb_role,t)},a.get_TB_role=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_role);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},a);function a(t){t||traceNoTabelData(),this.ID=t.ID,this.exp=t.exp,this.reward=t.reward}r.TB_role=o;var s=(u.get_TB_god_employ_setnById=function(t){return TableData.getInstance().getData(TableData.tb_god_employ_set,t)},u.get_TB_god_employ_set=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_god_employ_set);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},u);function u(){}r.TB_god_employ_set=s;var h=(l.get_TB_god_resolveById=function(t){return TableData.getInstance().getData(TableData.tb_god_resolve,t)},l);function l(){}r.TB_god_resolve=h;var c=(p.get_TB_god_levelnById=function(t){return TableData.getInstance().getData(TableData.tb_god_level,t)},p.get_TB_god_level=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_god_level);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},p);function p(){}r.TB_god_level=c;var d=(_.prototype.getName=function(){return this.name},_.prototype.getLevel=function(){return 1},_.prototype.getStar=function(){return 0},_.prototype.isAwaken=function(){return!1},_.prototype.hasAwakenModel=function(){return 0<this.awake_model&&this.awake_model!=this.model},_.prototype.isMoreThanSix=function(){return 6<=this.quality},_.prototype.getType=function(){return"null"},_.prototype.getDataType=function(){return 1},_.prototype.getRaceType=function(){return!1},_.prototype.getAttrType=function(){return this.type},_.prototype.getQulity=function(){var t=6<=this.quality?6:this.quality;return SkinUtil.getBoxQulityIcon(t)},_.prototype.getIconUrl=function(){return SkinUtil.getHeadIcon(this.icon)},_.prototype.getFrameUrl=function(){var t=this.star?this.star[0]:0;return 6<t&&(t=6),SkinUtil.getBoxQulityIcon(t)},_.prototype.getProperty=function(){return null},_.prototype.jisuanjineng=function(){return null},_.prototype.getSkill=function(){for(var t=[],e=0,i=this.skill;e<i.length;e++){var n=i[e];t.push(n[0])}return t},_.prototype.isCanAwaken=function(){return(this.star[1]||0)>r.TB_god_set.get_TB_god_set().star_evolution},_.get_TB_godById=function(t){return TableData.getInstance().getData(TableData.tb_god,t)},_.get_TB_god=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_god);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},_.prototype.getPropValByType=function(e){var t=this.attr_init.find(function(t){return t[0]==e});return Number(t[1])},_.prototype.getSkillOpenDgLv=function(e){var t=this.skill.find(function(t){return t[0]==e});return t&&(t[1]||0)},_.prototype.getSkillIdByDegree=function(t){for(var e=0,i=this.skill;e<i.length;e++){var n=i[e];if(n[1]==t)return n[0]}return 0},_.prototype.getSkinList=function(){if(!this._skinList&&(this._skinList=[],this._skinList.push(new game.GodSkinVo(this,game.GodSkinType.origin)),this.hasAwakenModel()&&this._skinList.push(new game.GodSkinVo(this,game.GodSkinType.awaken)),this.skin&&0<this.skin.length))for(var t=0,e=this.skin;t<e.length;t++){var i=e[t];this._skinList.push(new game.GodSkinVo(this,i))}return this._skinList},_.prototype.getSkinVo=function(e){return this.getSkinList().find(function(t){return t.skinId==e})},_.prototype.getAllSkill=function(t,e){for(var i=new Array,n=getSkillList(this.skill,t,e),o=0;o<n.length;o++){var a=r.TB_skill.get_TB_skillById(n[o][0]);a&&i.push(a)}return i},_.prototype.getBaseSkill=function(){for(var t=new Array,e=0;e<this.skill.length;e++){var i=r.TB_skill.get_TB_skillById(this.skill[e][0]);i&&t.push(i)}return t},_);function _(){}r.TB_god=d;var f=(g.getTbById=function(t){return TableData.getInstance().getData(TableData.tb_skin,t)},g.prototype.getAttr=function(){if(!this._attrAry&&(this._attrAry=[{},{}],this.attr))for(var t=0,e=this.attr;t<e.length;t++){var i=e[t];i[1]==ValueType.fixed?this._attrAry[0][i[0]]=i[2]:this._attrAry[1][i[0]]=i[2]}return this._attrAry},g);function g(){}r.TB_skin=f;var y=(m.getTbById=function(t){return TableData.getInstance().getData(TableData.tb_awaken_conditions,t)},m);function m(){}r.TB_awaken_conditions=y;var v=(b.getTbById=function(t){return TableData.getInstance().getData(TableData.tb_star_title,t)},b);function b(){}r.TB_star_title=v;var I=(T.getTbById=function(t){return TableData.getInstance().getData(TableData.tb_god_awaken,t)},T.prototype.getMaterialList=function(){var i=this;return this._materialList||(this._materialList=[],this.material&&this.material.forEach(function(t){var e=new ItemVo(t[0],0);e.constNum=t[1],e.countFromBag=!0,i._materialList.push(e)})),this._materialList},T.prototype.getGodMaterialList=function(){var e=this;return this._godMaterialList||(this._godMaterialList=[],this.god_material&&this.god_material.forEach(function(t){e._godMaterialList.push({type:game.ConfigType.race,starLv:t[0],count:t[1],race:t[2]})})),this._godMaterialList},T.prototype.getReturnMaterialList=function(){var e=this;return this._returnMaterialList||(this._returnMaterialList=[],this.return_material&&this.return_material.forEach(function(t){e._returnMaterialList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._returnMaterialList},T.prototype.getAttrValue=function(e){var t=this.attr?this.attr.find(function(t){return t[0]==e}):null;return t?t[1]:0},T);function T(){}r.TB_god_awaken=I;var w=(E.get_TB_god_set=function(){return TableData.getInstance().getData(TableData.tb_god_set,1)},E);function E(){}r.TB_god_set=w;var C=(S.prototype.getIconUrl=function(){return SkinUtil.getSkillIcon(Number(this.icon))},S.prototype.getQulity=function(){return SkinUtil.getBoxQulityIcon(this.type)},S.prototype.getLevel=function(){return this.level},S.prototype.isSkillDmgMultiSection=function(){if(this.effect<=0)return!1;var t=r.TB_skill_effect.get_TB_skill_effectById(this.effect);if(!t)return!1;var e=t.frame;return e&&2<e.length},S.get_TB_skillById=function(t){return TableData.getInstance().getData(TableData.tb_skill,t)},S.get_TB_skill=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_skill);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},S);function S(){}r.TB_skill=C;var L=(x.getTbSkillDesc=function(t){return TableData.getInstance().getData(TableData.tb_skill_desc,t)},x);function x(){}r.TB_skill_desc=L;var A=(M.get_TB_sub_skillById=function(t){return TableData.getInstance().getData(TableData.tb_sub_skill,t)},M.get_TB_sub_skill=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_sub_skill);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},M);function M(){}r.TB_sub_skill=A;var D=(O.replaceSkill=function(t){for(var e,i=!1,n=0;n<t.length;n++){var o=t[n],a=TableData.getInstance().getTableByName(TableData.tb_skill_replace).data[o];if(a){for(var r=0;r<t.length;r++){var s=t[r];if(-1!=(e=a.initial_skill.indexOf(s))&&a.replace_skill[e]){t[r]=a.replace_skill[e],i=!0;break}}if(i)break}}return i},O);function O(){}r.TB_skill_replace=D;var R=(P.get_TB_effectById=function(t){return TableData.getInstance().getData(TableData.tb_effect,t)},P.get_TB_effect=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_effect);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},P);function P(){}r.TB_effect=R;var U=(k.get_TB_msgCodeById=function(t){return TableData.getInstance().getData(TableData.tb_msgCode,t)},k.get_TB_msgCodeByCode=function(t){if(this._codeObj[t])return this._codeObj[t];var e=k.get_TB_msgCode("code",t);return e&&0<e.length?e[0]:null},k.get_TB_msgCode=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_msgCode);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},k._codeObj={},k);function k(t){t||traceNoTabelData(),this.ID=t.ID,this.code=t.code,this.text=t.text,this.region0=t.region0,this.time=t.time,this.onTop=t.onTop}r.TB_msgCode=U;var B=(V.prototype.selectAttrItem=function(t){for(var e=null,i=0;i<this.attr_para.length;i++)if((e=this.attr_para[i])&&e[0]==t)return e[1];return 0},V.get_TB_game_setById=function(t){return TableData.getInstance().getData(TableData.tb_game_set,t)},V.get_TB_game_set=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_game_set);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},V.getBuffByAttr=function(t){for(var e=TableData.getInstance().getData(TableData.tb_game_set,1),i=0;i<e.attr_buff.length;i++){var n=e.attr_buff[i];if(n[0]==t)return n[1]}return logerror("--------tb error-------缺少数据配置"),-1},V.getFriendPonit=function(){var t=TableData.getInstance().getData(TableData.tb_game_set,1).friend_once_reward[0];return parseInt(t[1])},V.getMaxFriendPonit=function(){return TableData.getInstance().getData(TableData.tb_game_set,1).friend_point_max},V.getMaxfriendNum=function(){return TableData.getInstance().getData(TableData.tb_game_set,1).friend_max},V.getMaxGodsNum=function(){return TableData.getInstance().getData(TableData.tb_game_set,1).limit_god},V);function V(){}r.TB_game_set=B;var N=(G.get_TB_buffById=function(t){return TableData.getInstance().getData(TableData.tb_buff,t)},G.get_TB_buff=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_buff);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},G);function G(){}r.TB_buff=N;var H=(j.get_TB_skill_effectById=function(t){return TableData.getInstance().getData(TableData.tb_skill_effect,t)},j.get_TB_skill_effect=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_skill_effect);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},j);function j(){}r.TB_skill_effect=H;var F=(W.getSkillSet=function(){return TableData.getInstance().getData(TableData.tb_skill_set,1)},W);function W(){}r.TB_skill_set=F;var K=(q.get_TB_buff_effectById=function(t){return TableData.getInstance().getData(TableData.tb_buff_effect,t)},q.get_TB_buff_effect=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_buff_effect);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},q);function q(){}r.TB_buff_effect=K;var z=(Y.get_TB_trialById=function(t){return TableData.getInstance().getData(TableData.tb_trial,t)},Y.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},Y);function Y(){}r.TB_trial=z;var X=(J.prototype.getRewardItems=function(){var n=this;return this._rewardItems||(this._rewardItems=new Array,this.reward_preview.forEach(function(t,e,i){n._rewardItems.push(ht.get_TB_itemById(t))})),this._rewardItems},J.initAllCopy=function(){if(!J.zhuxianFuben){J.zhuxianFuben=new Array,J.fuwenFuben=new Array,J.dixiaFuben=new Array,J.shilianFuben=new Array;var t=TableData.getInstance().getTableByName(TableData.tb_copy);for(var e in t.data){var i=t.data[e];switch(i.type){case iface.tb_prop.copyTypeKey.main:J.zhuxianFuben.push(i);break;case iface.tb_prop.copyTypeKey.rune:J.fuwenFuben.push(i);break;case iface.tb_prop.copyTypeKey.underground:2002!=i.ID&&2004!=i.ID||J.dixiaFuben.push(i);break;case iface.tb_prop.copyTypeKey.tower:J.shilianFuben.push(i)}}}},J.get_TB_copyById=function(t){return TableData.getInstance().getData(TableData.tb_copy,t)},J.get_TB_copy=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_copy);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},J);function J(){}r.TB_copy=X;var Q=(Z.prototype.getConditionVal=function(t){for(var e=0,i=this.precondition?this.precondition:[];e<i.length;e++){var n=i[e];if(Number(n[0])==t)return Number(n[1])}return 0},Z.prototype.getRewardShowItems=function(){if(!this._rewardShowItems){this._rewardShowItems=new Array;for(var t=0;this.reward_show&&t<this.reward_show.length;t++){var e=this.reward_show[t],i=App.hero.createItemVo(0,e);this._rewardShowItems.push(i)}}return this._rewardShowItems},Z.prototype.getRewardItems=function(){if(!this._rewardItems&&(this._rewardItems=[],this.reward))for(var t=0;t<this.reward.length;t++){var e=App.hero.createItemVo(this.reward[t][1],this.reward[t][0]);this._rewardItems.push(e)}return this._rewardItems},Z.prototype.getMonsters=function(){if(!this._monsters){this._monsters=new Array,this.monstersModels=new Array;for(var t=0;t<this.monster.length;t++)for(var e=0;e<this.monster[t].length;e++){var i=this.monster[t][e];if(0!=i){var n=dt.get_TB_monsterById(i);this._monsters.push(n),this.monstersModels.push(n.model)}}}return this._monsters},Z.prototype.getAllMonsters=function(){if(!this._allmonster){this._allmonster=new Array;for(var t=0;t<this.monster.length;t++)for(var e=0;e<this.monster[t].length;e++){var i=this.monster[t][e];if(0!=i){var n=dt.get_TB_monsterById(i);this._allmonster.push(n)}else this._allmonster.push(null)}}return this._allmonster},Z.prototype.getIconMonster=function(){if(!this._showIconMonsters){this._showIconMonsters=new Array;for(var t=0;t<this.show_icon.length;t++){var e=this.show_icon[t];if(0!=e){var i=dt.get_TB_monsterById(e);this._showIconMonsters.push(i)}}}return this._showIconMonsters},Z.get_TB_copy_infoById=function(t){return TableData.getInstance().getData(TableData.tb_copy_info,t)},Z.get_TB_copy_info=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_copy_info);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Z.prototype.getChapter=function(){if(-1==this._chapter){var t=r.TB_copy.get_TB_copyById(this.area);this._chapter=t?t.chapter:0}return this._chapter},Z);function Z(){this._chapter=-1}r.TB_copy_info=Q;var $=(tt.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_plot,t)},tt);function tt(){}r.TB_plot=$;var et=(it.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_daily_copy,t)},it.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},it);function it(){}r.TB_daily_copy=et;var nt=(ot.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_expedition,t)},ot.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},ot.prototype.getSpecialList=function(){var e=this;return this._specialList||(this._specialList=[],this.special&&this.special.forEach(function(t){e._specialList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._specialList},ot.prototype.getBoxRewardList=function(){var e=this;return this._boxRewards||(this._boxRewards=[],this.box&&this.box.forEach(function(t){e._boxRewards.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._boxRewards},ot);function ot(){}r.TB_expedition=nt;var at=(rt.getCopySet=function(){return TableData.getInstance().getData(TableData.tb_copy_set,1)},rt);function rt(){}r.TB_copy_set=at;var st=(ut.get_TB_exchangeById=function(t){return TableData.getInstance().getData(TableData.tb_exchange,t)},ut);function ut(){}r.TB_exchange=st;var ht=(lt.prototype.firstFlag=function(){return this.isFirst},lt.prototype.getShow=function(){return this.show},lt.prototype.getStar=function(){return this.icon[3]?this.icon[3]:0},lt.prototype.isMoreThanSix=function(){return!1},lt.prototype.getIconUrl=function(){return SkinUtil.getItemIcon(this)},lt.prototype.isStartAction=function(){return!1},lt.prototype.getQulity=function(){return SkinUtil.getBoxQulityIcon(this.quality)},lt.prototype.getNum=function(){return this.showNum?App.hero.getBagItemNum(this.ID.toString()):0},lt.prototype.getConstNum=function(){return this.constnum},lt.prototype.isChip=function(){return this.icon&&0<this.icon[1]},lt.prototype.getChipSkin=function(){return this.icon&&2==this.icon[1]?SkinUtil.chip_godSkin:SkinUtil.chip_normal},lt.prototype.showRace=function(){return this.icon[2]?this.icon[2]:0},lt.prototype.getExtParm=function(){return null},lt.get_TB_itemById=function(t){return TableData.getInstance().getData(TableData.tb_item,t)},lt.get_TB_item=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_item);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},lt);function lt(){this.isFirst=!1,this.show=!0,this.showNum=!0}r.TB_item=ht;var ct=(pt.get_TB_ById=function(t){return TableData.getInstance().getData(TableData.tb_optional,t)},pt);function pt(){}r.TB_optional=ct;var dt=(_t.prototype.getAttrType=function(){return this.attr_type},_t.prototype.getName=function(){return this.name},_t.prototype.getLevel=function(){return this.level},_t.prototype.getStar=function(){return this.star},_t.prototype.isAwaken=function(){return!1},_t.prototype.isMoreThanSix=function(){return 6<=this.star},_t.prototype.getType=function(){return"null"},_t.prototype.getDataType=function(){return 1},_t.prototype.getRaceType=function(){return this.race_type},_t.prototype.getQulity=function(){var t=6<=this.star?6:this.star;return SkinUtil.getBoxQulityIcon(t)},_t.prototype.getIconUrl=function(){return SkinUtil.getHeadIcon(this.icon)},_t.prototype.getFrameUrl=function(){return SkinUtil.getBoxQulityIcon(this.quality)},_t.prototype.jisuanjineng=function(){for(var t=new Array,e=0;e<this.skill.length;e++)t.push(r.TB_skill.get_TB_skillById(this.skill[e]));return t},_t.prototype.getSkillList=function(){return this.skill.map(function(t){return[t,0]})},_t.prototype.getProperty=function(){return this.attr},_t.prototype.getPropValByType=function(e){var t=this.attr.find(function(t){return t[0]==e});return Number(t[1])},_t.prototype.getShenli=function(){return 0},_t.get_TB_monsterById=function(t){return TableData.getInstance().getData(TableData.tb_monster,t)},_t.get_TB_monster=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_monster);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},_t);function _t(){}r.TB_monster=dt;var ft=(gt.get_TB_god_evolutionById=function(t){return TableData.getInstance().getData(TableData.tb_god_evolution,t)},gt.get_TB_god_evolutionAtMaxID=function(){var t=TableData.getInstance().getTableByName(TableData.tb_god_evolution).data,e=null;for(var i in t)t[i]&&(e=t[i]);return e},gt.get_TB_god_evolution=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_god_evolution);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},gt);function gt(){}r.TB_god_evolution=ft;var yt=(mt.get_TB_god_starById=function(t){return TableData.getInstance().getData(TableData.tb_god_star,t)},mt.get_TB_god_star=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_god_star);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},mt.prototype.getGodMaterialList=function(){var e=this;return this._godMaterialList||(this._godMaterialList=[],this.material&&this.material.forEach(function(t){e._godMaterialList.push({type:t[0],race:t[1],godId:t[1],starLv:t[2],count:t[3]})})),this._godMaterialList},mt);function mt(){}r.TB_god_star=yt;var vt=(bt.get_TB_god_fateById=function(t){return TableData.getInstance().getData(TableData.tb_god_fate,t)},bt.get_TB_god_fate=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_god_fate);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},bt);function bt(){}r.TB_god_fate=vt;var It=(Tt.get_TB_fusion_soulById=function(t){return TableData.getInstance().getData(TableData.tb_fusion_soul,t)},Tt.get_TB_fusion_soul=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_fusion_soul);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Tt.prototype.getOnceCost=function(t){return t==iface.tb_prop.fuseAttrTypeKey.hp?this.cost_hp[0][1]:t==iface.tb_prop.fuseAttrTypeKey.atk?this.cost_atk[0][1]:t==iface.tb_prop.fuseAttrTypeKey.def?this.cost_def[0][1]:0},Tt.prototype.getMaxAttr=function(t){for(var e=0,i=this.attr_max;e<i.length;e++){var n=i[e];if(n[0]==t)return n[1]}return 0},Tt.prototype.getMaxLv=function(t){return t==iface.tb_prop.fuseAttrTypeKey.hp?this.hp_max:t==iface.tb_prop.fuseAttrTypeKey.atk?this.atk_max:t==iface.tb_prop.fuseAttrTypeKey.def?this.def_max:0},Tt.prototype.getOnceAdd=function(t){return t==iface.tb_prop.fuseAttrTypeKey.hp?this.add_hp:t==iface.tb_prop.fuseAttrTypeKey.atk?this.add_atk:t==iface.tb_prop.fuseAttrTypeKey.def?this.add_def:0},Tt);function Tt(){}r.TB_fusion_soul=It;var wt=(Et.get_TB_wishById=function(t){return TableData.getInstance().getData(TableData.tb_wish,t)},Et.get_TB_wish=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_wish);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Et);function Et(){}r.TB_wish=wt;var Ct=(St.get_TB_wish_set=function(){return TableData.getInstance().getData(TableData.tb_wish_set,1)},St.getFreeNum=function(){return r.TB_wish_set.get_TB_wish_set().free_num},St.getMaxNum=function(){return r.TB_wish_set.get_TB_wish_set().max_num},St);function St(){}r.TB_wish_set=Ct;var Lt=(xt.getTaskById=function(t){return TableData.getInstance().getData(TableData.tb_task,t)},xt.getTaskListByType=function(t){var e=TableData.getInstance().getTableByName(TableData.tb_task).data,i=[];for(var n in e){var o=e[n];o.type==t&&i.push(o)}return i},xt.getAchievementListByType=function(t,e){void 0===e&&(e=0);var i=TableData.getInstance().getTableByName(TableData.tb_task).data,n=[];for(var o in i){var a=i[o];a.type==iface.tb_prop.taskTypeKey.achievement&&a.label==t&&a.sub_label==e&&n.push(a)}return n},xt);function xt(){}r.TB_task=Lt;var At=(Mt.getCfgById=function(t){return TableData.getInstance().getData(TableData.tb_task_title,t)},Mt);function Mt(){}r.TB_task_title=At;var Dt=(Ot.getTaskById=function(t){return TableData.getInstance().getData(TableData.tb_daily,t)},Ot);function Ot(){}r.TB_daily=Dt;var Rt=(Pt.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_daily_reward,t)},Pt.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},Pt);function Pt(){}r.TB_daily_reward=Rt;var Ut=(kt.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_market,t)},kt);function kt(){}r.TB_market=Ut;var Bt=(Vt.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_market_set,t)},Vt.getMaxNum=function(){return r.TB_market_set.getItemById(1).max_num},Vt.getCostDiamond=function(){return r.TB_market_set.getItemById(1).cost_diamond},Vt);function Vt(){}r.TB_market_set=Bt;var Nt=(Gt.get_TB_evaluationById=function(t){return TableData.getInstance().getData(TableData.tb_evaluation,t)},Gt);function Gt(){}r.TB_evaluation=Nt;var Ht=(jt.get_TB_runeById=function(t){return TableData.getInstance().getData(TableData.tb_rune,t)},jt);function jt(){}r.TB_rune=Ht;var Ft=(Wt.get_TB_rune_prefixById=function(t){return TableData.getInstance().getData(TableData.tb_rune_prefix,t)},Wt);function Wt(){}r.TB_rune_prefix=Ft;var Kt=(qt.get_TB_rune_strengthById=function(t){return TableData.getInstance().getData(TableData.tb_rune_strength,t)},qt);function qt(){}r.TB_rune_strength=Kt;var zt=(Yt.get_TB_rune_setById=function(t){return TableData.getInstance().getData(TableData.tb_rune_set,t)},Yt);function Yt(){}r.TB_rune_set=zt;var Xt=(Jt.get_TB_rune_suitById=function(t){return TableData.getInstance().getData(TableData.tb_rune_suit,t)},Jt.get_TB_rune=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_rune_suit);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Jt);function Jt(){}r.TB_rune_suit=Xt;var Qt=(Zt.getRandomName=function(t){if(0==this.familyNames.length){var e=TableData.getInstance().getTableByName(TableData.tb_random_name).data;for(var i in e){var n=e[i];""!==n.xing&&Zt.familyNames.push(n.xing),""!==n.boy_name&&Zt.boyNames.push(n.boy_name),""!==n.girl_name&&Zt.girlNames.push(n.girl_name)}}return this.familyNames[utils.random(0,this.familyNames.length-1)]+(0===(t=t||utils.random(0,1))?this.boyNames[utils.random(0,this.boyNames.length-1)]:this.girlNames[utils.random(0,this.girlNames.length-1)])},Zt.familyNames=[],Zt.boyNames=[],Zt.girlNames=[],Zt);function Zt(){}r.TB_random_name=Qt;var $t=(te.get_TB_arena_npcById=function(t){return TableData.getInstance().getData(TableData.tb_arena_npc,t)},te.get_TB_arena_npc=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_arena_npc);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},te);function te(){}r.TB_arena_npc=$t;var ee=(ie.get_TB_arena_rankById=function(t){return TableData.getInstance().getData(TableData.tb_arena_rank,t)},ie.get_TB_arena_rank=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_arena_rank);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},ie);function ie(){}r.TB_arena_rank=ee;var ne=(oe.get_TB_rank_scoreById=function(t){return TableData.getInstance().getData(TableData.tb_rank_score,t)},oe.get_TB_rank_score=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_rank_score);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},oe);function oe(){}r.TB_rank_score=ne;var ae=(re.get_TB_goodsById=function(t){return TableData.getInstance().getData(TableData.tb_goods,t)},re.get_TB_goods=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_goods);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},re.get_TB_goodsByType=function(t,e){void 0===e&&(e=0);var i=TableData.getInstance().getTableByName(TableData.tb_goods).data,n=[];for(var o in i)i[o].type===t&&i[o].label===e&&n.push(i[o]);return n.sort(function(t,e){return t.rank-e.rank}),n},re);function re(){}r.TB_goods=ae;var se=(ue.get_TB_guildById=function(t){return TableData.getInstance().getData(TableData.tb_guild,t)},ue.get_TB_guild=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_guild);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},ue);function ue(){}r.TB_guild=se;var he=(le.get_TB_guild_iconById=function(t){return TableData.getInstance().getData(TableData.tb_guild_icon,t)},le.get_TB_guild_icon=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_guild_icon);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},le);function le(){}r.TB_guild_icon=he;var ce=(pe.get_TB_guild_skillById=function(t){return TableData.getInstance().getData(TableData.tb_guild_skill,t)},pe.getTbByParam=function(t,e,i){return pe.get_TB_guild_skillById(1e3*t+100*e+i)},pe.get_TB_guild_skill=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_guild_skill);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},pe);function pe(){}r.TB_guild_skill=ce;var de=(_e.get_TB_guild_signById=function(t){return TableData.getInstance().getData(TableData.tb_guild_sign,t)},_e.get_TB_guild_signMaxId=function(){return this.get_TB_guild_signById(this.get_TB_guild_sign().length)},_e.get_TB_guild_sign=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_guild_sign);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},_e);function _e(){}r.TB_guild_sign=de;var fe=(ge.getSet=function(){return TableData.getInstance().getData(TableData.tb_guild_set,1)},ge);function ge(){}r.TB_guild_set=fe;var ye=(me.getItemnById=function(t){return TableData.getInstance().getData(TableData.tb_guild_donate,t)},me);function me(){}r.TB_guild_donate=ye;var ve=(be.getItemnById=function(t){return TableData.getInstance().getData(TableData.tb_guild_help,t)},be.prototype.getRewardList=function(){var i=this;return this._rewardList||(this._rewardList=[],this.reward&&this.reward.forEach(function(t){var e=new ItemVo(Number(t[0]),Number(t[1]));e.show=!1,i._rewardList.push(e)})),this._rewardList},be.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_guild_help).data;for(var o in n)null!=t?n[o][t]==e&&i.push(n[o]):i.push(n[o]);return i},be);function be(){}r.TB_guild_help=ve;var Ie=(Te.prototype.getName=function(){return LanMgr.getLan("",10030,this.index+1)},Te.prototype.getMonterId=function(){return this.moster.find(function(t){return 0!=Number(t)})},Te.getItemnById=function(t){return TableData.getInstance().getData(TableData.tb_guild_copy,t)},Te.getListByChapter=function(t){var e=[],i=TableData.getInstance().getTableByName(TableData.tb_guild_copy).data;for(var n in i)Math.floor(parseInt(n)/10)==t&&e.push(i[n]);return e},Te.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_guild_copy).data;for(var o in n)null!=t?n[o][t]==e&&i.push(n[o]):i.push(n[o]);return i},Te);function Te(){}r.TB_guild_copy=Ie;var we=(Ee.getItemnById=function(t){return TableData.getInstance().getData(TableData.tb_copy_reward,t)},Ee);function Ee(){}r.TB_copy_reward=we;var Ce=(Se.get_TB_first_rechargeById=function(t){return TableData.getInstance().getData(TableData.tb_first_recharge,t)},Se.get_TB_first_recharge=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_first_recharge);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Se);function Se(){}r.TB_first_recharge=Ce;var Le=(xe.get_TB_levelById=function(t){return TableData.getInstance().getData(TableData.tb_level,t)},xe.get_TB_level=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_level);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},xe);function xe(){}r.TB_level=Le;var Ae=(Me.get_TB_day_signById=function(t){return TableData.getInstance().getData(TableData.tb_day_sign,t)},Me.get_TB_day_sign=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_day_sign);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Me);function Me(){}r.TB_day_sign=Ae;var De=(Oe.get_TB_total_signById=function(t){return TableData.getInstance().getData(TableData.tb_total_sign,t)},Oe.get_TB_total_sign=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_total_sign);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Oe);function Oe(){}r.TB_total_sign=De;var Re=(Pe.get_TB_ById=function(t){return TableData.getInstance().getData(TableData.tb_daily_recharge,t)},Pe.getTBByRechargeId=function(e){return Pe.getAllTB().find(function(t){return t.recharge_id==e})},Pe.getAllTB=function(){var t=new Array,e=TableData.getInstance().getTableByName(TableData.tb_daily_recharge);for(var i in e.data)t.push(e.data[i]);return t},Pe.getAllRecharges=function(){for(var t=[],e=0,i=Pe.getAllTB();e<i.length;e++){var n=i[e];0<n.recharge_id&&t.push(n.recharge_id)}return t},Pe.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward&&this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},Pe);function Pe(){}r.TB_daily_recharge=Re;var Ue=(ke.get_TB_ById=function(t){return TableData.getInstance().getData(TableData.tb_week_recharge,t)},ke.getTBByRechargeId=function(e){return ke.getAllTB().find(function(t){return t.recharge_id==e})},ke.getAllTB=function(){var t=new Array,e=TableData.getInstance().getTableByName(TableData.tb_week_recharge);for(var i in e.data)t.push(e.data[i]);return t},ke.getAllRecharges=function(){for(var t=[],e=0,i=ke.getAllTB();e<i.length;e++){var n=i[e];0<n.recharge_id&&t.push(n.recharge_id)}return t},ke.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward&&this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},ke);function ke(){}r.TB_week_recharge=Ue;var Be=(Ve.get_TB_ById=function(t){return TableData.getInstance().getData(TableData.tb_month_recharge,t)},Ve.getTBByRechargeId=function(e){return Ve.getAllTB().find(function(t){return t.recharge_id==e})},Ve.getAllTB=function(){var t=new Array,e=TableData.getInstance().getTableByName(TableData.tb_month_recharge);for(var i in e.data)t.push(e.data[i]);return t},Ve.getAllRecharges=function(){for(var t=[],e=0,i=Ve.getAllTB();e<i.length;e++){var n=i[e];0<n.recharge_id&&t.push(n.recharge_id)}return t},Ve.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward&&this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},Ve);function Ve(){}r.TB_month_recharge=Be;var Ne=(Ge.get_TB_sevendaysById=function(t){return TableData.getInstance().getData(TableData.tb_sevendays,t)},Ge.get_TB_sevendays=function(t){if(void 0===t&&(t=1),!this._allSevenTypes){this._allSevenTypes=[];var e=TableData.getInstance().getTableByName(TableData.tb_sevendays);for(var i in e.data){var n=e.data[i],o=Math.floor((n.ID-1)/this.TYPE_DAYS);this._allSevenTypes[o]||(this._allSevenTypes[o]=[]),this._allSevenTypes[o].push(n)}}var a=t-1;return a<0?[]:this._allSevenTypes[a]},Ge.TYPE_DAYS=7,Ge.TYPE_NUM=2,Ge);function Ge(){}r.TB_sevendays=Ne;var He=(je.getActivityOpenId=function(){var t=Math.floor((App.serverTime-App.hero.getCreateDayTiem())/TimeConst.ONE_DAY_MILSEC)+1,e=TableData.getInstance().getTableByName(TableData.tb_sevendays_time);for(var i in e.data){var n=e.data[i];if(t>=n.time[0]&&t<=n.time[1])return n.ID}return-1},je.getIdx=function(t){var e=TableData.getInstance().getTableByName(TableData.tb_sevendays_time);for(var i in e.data){var n=e.data[i];if(t>=n.time[0]&&t<=n.time[1])return t-n.time[0]}return-1},je.getEndTime=function(t){var e=TableData.getInstance().getTableByName(TableData.tb_sevendays_time);for(var i in e.data){var n=e.data[i];if(t>=n.time[0]&&t<=n.time[1])return n.time[1]}return-1},je);function je(){}r.TB_sevendays_times=He;var Fe=(We.get_TB_arena_newById=function(t){return TableData.getInstance().getData(TableData.tb_arena_new,t)},We.get_TB_arena_new=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_arena_new);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},We.prototype.isBeforeThree=function(){return!this.rank.some(function(t){return 3<t})&&this.rank[0]==this.rank[1]},We.prototype.getRankText=function(){return this.isBeforeThree()?"":this.rank[0]+"-"+this.rank[1]},We.prototype.getRankSkin=function(){var t=Number(this.rank[0]);return SkinUtil.getRankingSkin(t-1)},We.prototype.getRank=function(){return Number(this.rank[0])==Number(this.rank[1])?Number(this.rank[0]):999},We.prototype.getRankStr=function(){return this._rankStr||(this._rankStr=this.rank[0]==this.rank[1]?""+this.rank[0]:this.rank[0]+"-"+this.rank[1]),this._rankStr},We.prototype.getRewardList=function(){return this._rewards||(this._rewards=this.reward.map(function(t){return new ItemVo(t[0],t[1])})),this._rewards},We);function We(){}r.TB_arena_new=Fe;var Ke=(qe.getTB_arena_newById=function(t){return TableData.getInstance().getData(TableData.tb_arena_new_npc,t)},qe.prototype.getModelId=function(){return this.getMonsters()[0].model},qe.prototype.getMonsters=function(){return this._monsters||(this._monsters=this.monster.map(function(t){return r.TB_monster.get_TB_monsterById(t)})),this._monsters},qe);function qe(){this.level=1,this.head=Math.ceil(random(2))}r.TB_arena_new_npc=Ke;var ze=(Ye.getDataById=function(t){return TableData.getInstance().getData(TableData.tb_arena_draw,t)},Ye);function Ye(){}r.TB_arena_draw=ze;var Xe=(Je.prototype.getBuyCostDiamond=function(){var t=App.hero.getlimitValue(iface.tb_prop.limitTypeKey.buyArenaNum);return this.buy_cost[t]?this.buy_cost[t]:this.buy_cost[this.buy_cost.length-1]},Je.getArenaNewSet=function(){return TableData.getInstance().getData(TableData.tb_arena_new_set,1)},Je);function Je(){}r.TB_arena_new_set=Xe;var Qe=(Ze.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_escort,t)},Ze.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.escort_reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},Ze.prototype.getLossList=function(){var e=this;return this._lossList||(this._lossList=[],this.escort_loss&&this.escort_loss.forEach(function(t){e._lossList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._lossList},Ze.prototype.getRobList=function(){var e=this;return this._robList||(this._robList=[],this.rob_reward&&this.rob_reward.forEach(function(t){e._robList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._robList},Ze);function Ze(){}r.TB_escort=Qe;var $e=(ti.getSet=function(){return TableData.getInstance().getData(TableData.tb_escort_set,1)},ti);function ti(){}r.TB_escort_set=$e;var ei=(ii.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_forest,t)},ii.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},ii.prototype.getBossRewards=function(){var e=this;return this._boosRewardList||(this._boosRewardList=[],this.first_reward&&0<this.first_reward.length&&this.first_reward.forEach(function(t){e._boosRewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._boosRewardList},ii.prototype.getMonsters=function(){if(!this._monsters){this._monsters=new Array;for(var t=0;t<this.monster.length;t++){var e=parseInt(this.monster[t]);if(0!=e){var i=dt.get_TB_monsterById(e);this._monsters.push(i)}}}return this._monsters},ii);function ii(){}r.TB_forest=ei;var ni=(oi.getSet=function(){return TableData.getInstance().getData(TableData.tb_forest_set,1)},oi);function oi(){}r.TB_forest_set=ni;var ai=(ri.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_island,t)},ri);function ri(){}r.TB_island=ai;var si=(ui.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_island_level,t)},ui.prototype.getRateList=function(){var e=this;return this._rateList||(this._rateList=[],this.rare_reward.forEach(function(t){e._rateList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rateList},ui.prototype.getLossList=function(){var e=this;return this._lossList||(this._lossList=[],this.rare_loss.forEach(function(t){e._lossList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._lossList},ui);function ui(){}r.TB_island_level=si;var hi=(li.getSet=function(){return TableData.getInstance().getData(TableData.tb_island_set,1)},li);function li(){}r.TB_island_set=hi;var ci=(pi.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_worldboss,t)},pi.prototype.getRewardList=function(){var i=this;return this._rewardList||(this._rewardList=[],this.attack_reward.forEach(function(t){var e={itemData:new ItemVo(Number(t[0]),Number(t[1])),type:0};i._rewardList.push(e)}),this.item_show&&this.item_show.forEach(function(t){var e={itemData:new ItemVo(Number(t[0]),Number(t[1])),type:1};i._rewardList.push(e)})),this._rewardList},pi);function pi(){}r.TB_worldboss=ci;var di=(_i.getSet=function(){return TableData.getInstance().getData(TableData.tb_boss_set,1)},_i);function _i(){}r.TB_boss_set=di;var fi=(gi.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_mail,t)},gi);function gi(){}r.TB_mail=fi;var yi=(mi.get_TB_rechargeById=function(t){return TableData.getInstance().getData(TableData.tb_recharge,t)},mi.get_TB_recharge=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_recharge);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},mi);function mi(){}r.TB_recharge=yi;var vi=(bi.getMaxVip=function(){var t=TableData.getInstance().getTableByName(TableData.tb_vip),e=Object.keys(t.data);return Number(e[e.length-1])},bi.get_TB_vipById=function(t){return TableData.getInstance().getData(TableData.tb_vip,t)},bi.get_TB_vip=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_vip);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},bi);function bi(){}r.TB_vip=vi;var Ii=(Ti.getTbMonthCardById=function(t){return TableData.getInstance().getData(TableData.tb_month_card,t)},Ti);function Ti(){}r.TB_month_card=Ii;var wi=(Ei.get_TB_vip_privilegeById=function(t){return TableData.getInstance().getData(TableData.tb_vip_privilege,t)},Ei.get_TB_vip_privilege=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_vip_privilege);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Ei.getPrompt=function(t){var e=TableData.getInstance().getData(TableData.tb_vip_privilege,t);return 0<e.vip_level&&999!=e.general_level?"vip"+e.vip_level+"开启，或玩家等级"+e.general_level+"开启":0<e.vip_level?"vip"+e.vip_level+"开启":"玩家等级"+e.general_level+"开启"},Ei);function Ei(){}r.TB_vip_privilege=wi;var Ci=(Si.get_TB_vip_descById=function(t){return TableData.getInstance().getData(TableData.tb_vip_desc,t)},Si);function Si(){}r.TB_vip_desc=Ci;var Li=(xi.get_TB_equip_strengthById=function(t){return TableData.getInstance().getData(TableData.tb_equip_strength,t)},xi.prototype.getAttr=function(){if(!this._attrObj&&(this._attrObj={},this.strength_attr))for(var t=0,e=this.strength_attr;t<e.length;t++){var i=e[t];this._attrObj[i[0]]=i[1]}return this._attrObj},xi.get_TB_equip_strength=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_equip_strength);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},xi);function xi(){}r.TB_equip_strength=Li;var Ai=(Mi.get_TB_strength_suitById=function(t){return TableData.getInstance().getData(TableData.tb_strength_suit,t)},Mi.prototype.getAttr=function(){if(!this._attrObj&&(this._attrObj={},this.attr))for(var t=0,e=this.attr;t<e.length;t++){var i=e[t];this._attrObj[i[0]]=i[1]}return this._attrObj},Mi.get_TB_strength_suit=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_strength_suit);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Mi.get_TB_strength_suitByLv=function(t){var e=null,i=TableData.getInstance().getTableByName(TableData.tb_strength_suit);for(var n in i.data){var o=i.data[n];e?t>=o.level&&o.level>e.level&&(e=o):t>=o.level&&(e=o)}return e},Mi);function Mi(){}r.TB_strength_suit=Ai;var Di=(Oi.get_TB_refine_suitById=function(t){return TableData.getInstance().getData(TableData.tb_refine_suit,t)},Oi.prototype.getAttr=function(){if(!this._attrObj&&(this._attrObj={},this.attr))for(var t=0,e=this.attr;t<e.length;t++){var i=e[t];this._attrObj[i[0]]=i[1]}return this._attrObj},Oi.get_TB_refine_suit=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_refine_suit);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Oi.get_TB_refine_suitByLv=function(t){var e=null,i=TableData.getInstance().getTableByName(TableData.tb_refine_suit);for(var n in i.data){var o=i.data[n];e?t>=o.level&&o.level>e.level&&(e=o):t>=o.level&&(e=o)}return e},Oi);function Oi(){}r.TB_refine_suit=Di;var Ri=(Pi.get_TB_equip_suitById=function(t){return TableData.getInstance().getData(TableData.tb_equip_suit,t)},Pi.prototype.getQuality=function(){return Math.floor(this.ID/10)},Pi.prototype.getCount=function(){return this.ID%10},Pi.get_TB_equip_suit=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_equip_suit);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Pi.getSuitByQuality=function(t){var e=[],i=TableData.getInstance().getTableByName(TableData.tb_equip_suit);for(var n in i.data){var o=i.data[n];Math.floor(o.ID/10)==t&&e.push(o)}return e},Pi);function Pi(){}r.TB_equip_suit=Ri;var Ui=(ki.get_TB_equip_refineById=function(t){return TableData.getInstance().getData(TableData.tb_equip_refine,t)},ki.prototype.getAttr=function(){if(!this._attrObj&&(this._attrObj={},this.attr))for(var t=0,e=this.attr;t<e.length;t++){var i=e[t];this._attrObj[i[0]]=i[2]}return this._attrObj},ki.get_TB_equip_refine=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_equip_refine);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},ki);function ki(){}r.TB_equip_refine=Ui;var Bi=(Vi.get_TB_equip_recycleById=function(t){return TableData.getInstance().getData(TableData.tb_equip_recycle,t)},Vi.get_TB_equip_recycle=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_equip_recycle);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Vi);function Vi(){}r.TB_equip_recycle=Bi;var Ni=(Gi.get_TB_equip_setById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_equip_set,t)},Gi.get_TB_equip_set=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_equip_set);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Gi.getRefineLimit=function(t){return TableData.getInstance().getData(TableData.tb_equip_set,1).refine_limit[t]||0},Gi);function Gi(){}r.TB_equip_set=Ni;var Hi=(ji.getTBOneById=function(t){return TableData.getInstance().getData(TableData.tb_gemstone_new,t)},ji.getTbGemByType=function(t,e){return ji.getTBOneById(100*t+e)},ji.prototype.getAttr=function(){if(!this._attrObj&&(this._attrObj={},this.attr))for(var t=0,e=this.attr;t<e.length;t++){var i=e[t];this._attrObj[i[0]]=i[1]}return this._attrObj},ji.prototype.getType=function(){return Math.floor(this.ID/100)},ji.prototype.getLevel=function(){return this.ID%100},ji.prototype.getAttrType=function(){return this.attr&&this.attr[0]?this.attr[0][0]:0},ji.prototype.getAttrVal=function(){return this.attr&&this.attr[0]?this.attr[0][1]:0},ji.getTbList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_gemstone_new);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},ji.getTbList2=function(e,i){return ji.getTbList().filter(function(t){return(0==e||t.getType()==e)&&t.getLevel()==i})},ji);function ji(){}r.TB_gemstone_new=Hi;var Fi=(Wi.getTBOneById=function(t){return TableData.getInstance().getData(TableData.tb_gemstone_compound,t)},Wi.prototype.getMaterialList=function(){var e=this;return this._materialList||(this._materialList=[],this.material&&this.material.forEach(function(t){e._materialList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._materialList},Wi.prototype.getObtainList=function(){var e=this;return this._obtainList||(this._obtainList=[],this.obtain&&this.obtain.forEach(function(t){e._obtainList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._obtainList},Wi.getTBList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_gemstone_compound);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Wi);function Wi(){}r.TB_gemstone_compound=Fi;var Ki=(qi.getLinkByIdx=function(t){var e=TableData.getInstance().getTableByName(TableData.tb_operate_activity);for(var i in e.data){var n=e.data[i];if(n&&n.time_index==t)return n.link}return-1},qi.gettimeIdx=function(){var t=[],e=TableData.getInstance().getTableByName(TableData.tb_operate_activity);for(var i in e.data){var n=e.data[i];-1==t.indexOf(n.time_index)&&t.push(n.time_index)}return t},qi.get_TB_operate_activityById=function(t){return TableData.getInstance().getData(TableData.tb_operate_activity,t)},qi.getChangeTemplate=function(t,e){var i=TableData.getInstance().getTableByName(TableData.tb_operate_activity);for(var n in i.data)if(null!=t&&i.data[n][t]==e)return i.data[n];return null},qi.get_TB_operate_activity=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_operate_activity);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},qi);function qi(){}r.TB_operate_activity=Ki;var zi=(Yi.getTabInfo=function(t){return TableData.getInstance().getData(TableData.tb_activity_time,t).desc},Yi);function Yi(){}r.TB_activity_time=zi;var Xi=(Ji.get_TB_group_buy=function(){var t=new Array,e=TableData.getInstance().getTableByName(TableData.tb_group_buy);for(var i in e.data){var n=e.data[i];t.push(n)}return t},Ji);function Ji(){}r.TB_group_buy=Xi;var Qi=(Zi.getRandomTalk=function(t){var e=TableData.getInstance().getData(TableData.tb_model_dialogue,t);if(!e)return"";var i=random(e.dialogue_id.length),n=e.dialogue_id[i];return Nt.get_TB_evaluationById(n).content},Zi);function Zi(){}r.TB_model_dialogue=Qi;var $i=(tn.getTB_riskById=function(t){return TableData.getInstance().getData(TableData.tb_risk,t)},tn.get_TB_risk=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_risk);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},tn);function tn(){}r.TB_risk=$i;var en=(nn.getTB_questionById=function(t){return TableData.getInstance().getData(TableData.tb_question,t)},nn);function nn(){}r.TB_question=en;var on=(an.getTBItemById=function(t){return TableData.getInstance().getData(TableData.tb_recharge_rebate,t)},an.getTBList=function(){var t=new Array,e=TableData.getInstance().getTableByName(TableData.tb_recharge_rebate);for(var i in e.data)t.push(e.data[i]);return t},an);function an(){}r.TB_recharge_rebate=on;var rn=(sn.getTabSet=function(){return TableData.getInstance().getData(TableData.tb_activity_set,1)},sn.prototype.getVipGiftList=function(){var e=this;return this._vipGiftList||(this._vipGiftList=[],this.super_vip_gift.forEach(function(t){e._vipGiftList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._vipGiftList},sn);function sn(){}r.TB_activity_set=rn;var un=(hn.getTabSet=function(){return TableData.getInstance().getData(TableData.tb_risk_set,1)},hn);function hn(){}r.TB_risk_set=un;var ln=(cn.getTB_fight_rank=function(){var t=new Array,e=TableData.getInstance().getTableByName(TableData.tb_fight_rank);for(var i in e.data){var n=e.data[i];t.push(n)}return t},cn);function cn(){}r.TB_fight_rank=ln;var pn=(dn.getTB_openservice=function(){var t=new Array,e=TableData.getInstance().getTableByName(TableData.tb_openservice);for(var i in e.data){var n=e.data[i];t.push(n)}return t},dn.getTB_openserviceByChargeid=function(t){var e=TableData.getInstance().getTableByName(TableData.tb_openservice);for(var i in e.data){var n=e.data[i];if(n.charge_id==t)return n}return null},dn);function dn(){}r.TB_openservice=pn;var _n=(fn.getTB_share=function(){var t=new Array,e=TableData.getInstance().getTableByName(TableData.tb_share);for(var i in e.data){var n=e.data[i];t.push(n)}return t},fn.getTB_shareById=function(t){return TableData.getInstance().getData(TableData.tb_share,t)},fn);function fn(){}r.TB_share=_n;var gn=(yn.getTB_share=function(){var t=new Array,e=TableData.getInstance().getTableByName(TableData.tb_online);for(var i in e.data){var n=e.data[i];t.push(n)}return t},yn);function yn(){}r.TB_online=gn;var mn=(vn.get_TB_operate_activityByDay=function(t,e){var i=TableData.getInstance().getTableByName(TableData.tb_activity_sevendays).data,n=new Array,o=new Array;for(var a in i){var r=i[a];r.time_type==t&&r.day==e&&o.push(i[a])}for(var s=1;s<5;s++){var u=[];for(var h in o)o[h].link==s&&u.push(o[h]);n.push(u)}return n},vn.get_TB_operate_activityById=function(t){return TableData.getInstance().getData(TableData.tb_activity_sevendays,t)},vn.get_TB_operate_activity=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_activity_sevendays);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},vn);function vn(){}r.TB_activity_sevendays=mn;var bn=(In.get_TB_limit_timeById=function(t){return TableData.getInstance().getData(TableData.tb_limit_time,t)},In.get_TB_limit_time=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_limit_time);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},In);function In(){}r.TB_limit_time=bn;var Tn=(wn.get_TB_summon_rankById=function(t){return TableData.getInstance().getData(TableData.tb_summon_rank,t)},wn.get_TB_summon_rank=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_summon_rank);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},wn.get_TB_summon_rankByType=function(t){var e=new Array,i=TableData.getInstance().getTableByName(TableData.tb_summon_rank);for(var n in i.data)if(i.data[n].type==t){var o=i.data[n];e.push(o)}return e},wn);function wn(){}r.TB_summon_rank=Tn;var En=(Cn.get_TB_summon_boxById=function(t){return TableData.getInstance().getData(TableData.tb_summon_box,t)},Cn.get_TB_summon_box=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_summon_box);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Cn.get_TB_summon_boxByType=function(t){var e=new Array,i=TableData.getInstance().getTableByName(TableData.tb_summon_box);for(var n in i.data)if(i.data[n].type==t){var o=i.data[n];e.push(o)}return e},Cn);function Cn(){}r.TB_summon_box=En;var Sn=(Ln.TB_group_buying_timeById=function(t){return TableData.getInstance().getData(TableData.tb_group_buying_time,t)},Ln.get_TB_group_buying_time=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_group_buying_time);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Ln);function Ln(){}r.TB_group_buying_time=Sn;var xn=(An.get_TB_group_buyingById=function(t){return TableData.getInstance().getData(TableData.tb_group_buying,t)},An.get_TB_group_buying=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_group_buying);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},An);function An(){}r.TB_group_buying=xn;var Mn=(Dn.get_TB_divinity_doorById=function(t){return TableData.getInstance().getData(TableData.tb_divinity_door,t)},Dn.get_TB_divinity_door=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_divinity_door);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Dn);function Dn(){}r.TB_divinity_door=Mn;var On=(Rn.get_TB_divinity_set=function(){return TableData.getInstance().getData(TableData.tb_divinity_set,1)},Rn);function Rn(){}r.TB_divinity_set=On;var Pn=(Un.get_TB_divinity_replaceById=function(t){return TableData.getInstance().getData(TableData.tb_divinity_replace,t)},Un);function Un(){}r.TB_divinity_replace=Pn;var kn=(Bn.get_TB_get_TB_level_fundById=function(t){return TableData.getInstance().getData(TableData.tb_level_fund,t)},Bn.get_TB_level_fund=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_level_fund);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);for(var r=[],s=0;s<i.length;)App.hero.welfare.levelFundAward[i[s].ID]?(r.push(i[s]),i.splice(Number(s),1)):s++;return i.concat(r)},Bn);function Bn(){}r.TB_level_fund=kn;var Vn=(Nn.get_TB_get_TB_level_fundById=function(t){return TableData.getInstance().getData(TableData.tb_sevendays_reward,t)},Nn.get_TB_sevendays_reward=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_sevendays_reward);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Nn);function Nn(){}r.TB_sevendays_reward=Vn;var Gn=(Hn.prototype.getConstItems=function(){return this._constitems=this.cost.map(function(t){return r.TB_item.get_TB_itemById(t[0])}),this._constitems},Hn.get_TB_artifactById=function(t){return TableData.getInstance().getData(TableData.tb_artifact,t)},Hn.get_TB_artifact=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_artifact);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Hn.getArtifactByItemId=function(t){if(!this.ItemToArtifacts){this.ItemToArtifacts={};var e=TableData.getInstance().getTableByName(TableData.tb_artifact);for(var i in e.data){var n=e.data[i];if(n)for(var o=0;o<n.cost.length;o++){var a=n.cost[o];this.ItemToArtifacts[a[0]]=n}}}return this.ItemToArtifacts[t]},Hn);function Hn(){}r.TB_artifact=Gn;var jn=(Fn.get_TB_artifact_strengthById=function(t){return TableData.getInstance().getData(TableData.tb_artifact_strength,t)},Fn.prototype.getAttr=function(){if(!this._attrObj&&(this._attrObj={},this.strength_attr))for(var t=0,e=this.strength_attr;t<e.length;t++){var i=e[t];this._attrObj[i[0]]=i[1]}return this._attrObj},Fn.get_TB_artifact_strength=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_artifact_strength);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Fn);function Fn(){}r.TB_artifact_strength=jn;var Wn=(Kn.get_TB_artifact_skillById=function(t){return TableData.getInstance().getData(TableData.tb_artifact_skill,t)},Kn.get_TB_artifact_skills=function(t){void 0===t&&(t=null);var e=new Array,i=TableData.getInstance().getTableByName(TableData.tb_artifact_skill);for(var n in i.data)if(null!=t){if(Number(i.data[n].ID.toString().substring(0,1))==t){var o=i.data[n];e.push(o)}}else o=i.data[n],e.push(o);return e},Kn);function Kn(){}r.TB_artifact_skill=Wn;var qn=(zn.get_TB_artifact_skillcostById=function(t){return TableData.getInstance().getData(TableData.tb_artifact_skillcost,t)},zn);function zn(){}r.TB_artifact_skillcost=qn;var Yn=(Xn.get_TB_artifact_baptizeById=function(t){return TableData.getInstance().getData(TableData.tb_artifact_baptize,t)},Xn.get_TB_artifact_baptize=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_artifact_baptize);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Xn);function Xn(){}r.TB_artifact_baptize=Yn;var Jn=(Qn.prototype.isOnScope=function(e){return this.attr.some(function(t){return t[0]==e[0]&&t[1]==e[1]&&t[2]<=e[2]&&t[3]>=e[2]})},Qn.prototype.isMaxAttr=function(e){return 0==e[3]&&this.attr.some(function(t){return t[3]==e[2]})},Qn.get_TB_baptizeById=function(t){return TableData.getInstance().getData(TableData.tb_baptize,t)},Qn.get_TB_baptize=function(t){void 0===t&&(t=null);var e=new Array,i=TableData.getInstance().getTableByName(TableData.tb_baptize);for(var n in i.data)if(null!=t){if(i.data[n].attr[1]==t){var o=i.data[n];e.push(o)}}else o=i.data[n],e.push(o);return e},Qn);function Qn(){}r.TB_baptize=Jn;var Zn=($n.prototype.getOddStrByOdds=function(t){return t<this.odds_show[0]?"低":t>this.odds_show[1]?"高":"一般"},$n.get_TB_artifact_enchantById=function(t){return TableData.getInstance().getData(TableData.tb_artifact_enchant,t)},$n);function $n(){}r.TB_artifact_enchant=Zn;var to=(eo.get_TB_artifact_obtainById=function(t){return TableData.getInstance().getData(TableData.tb_artifact_obtain,t)},eo.get_TB_artifact_obtain=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_artifact_obtain);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},eo);function eo(){}r.TB_artifact_obtain=to;var io=(no.get_TB_artifact_setById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_artifact_set,t)},no.get_TB_artifact_set=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_artifact_set);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},no);function no(){}r.TB_artifact_set=io;var oo=(ao.get_TB_recommend_squadById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_recommend_squad,t)},ao.get_TB_recommend_squad=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_recommend_squad);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},ao);function ao(){}r.TB_recommend_squad=oo;var ro=(so.get_TB_danById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_dan,t)},so.get_TB_dan=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_dan);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},so);function so(){}r.TB_dan=ro;var uo=(ho.get_TB_luck_artifactById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_luck_artifact,t)},ho.get_TB_luck_artifact=function(t,e){void 0===t&&(t="type"),void 0===e&&(e=App.hero.welfare.luckArtId);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_luck_artifact);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},ho);function ho(){}r.TB_luck_artifact=uo;var lo=(co.get_TB_luck_artifact_timeById=function(t){return void 0===t&&(t=App.hero.welfare.luckArtId),TableData.getInstance().getData(TableData.tb_luck_artifact_time,t)},co.get_TB_luck_artifact_time=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_luck_artifact_time);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},co);function co(){}r.TB_luck_artifact_time=lo;var po=(_o.get_TB_luck_godById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_luck_god,t)},_o.get_TB_luck_god=function(t,e){void 0===t&&(t="type"),void 0===e&&(e=App.hero.welfare.luckGodId);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_luck_god);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},_o);function _o(){}r.TB_luck_god=po;var fo=(go.get_TB_luck_god_timeById=function(t){return void 0===t&&(t=App.hero.welfare.luckGodId),TableData.getInstance().getData(TableData.tb_luck_god_time,t)},go.get_TB_luck_god_time=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_luck_god_time);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},go);function go(){}r.TB_luck_god_time=fo;var yo=(mo.get_TB_luck_equipById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_luck_equip,t)},mo.get_TB_luck_equip=function(t,e){void 0===t&&(t="type"),void 0===e&&(e=App.hero.welfare.luckEquipId);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_luck_equip);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},mo);function mo(){}r.TB_luck_equip=yo;var vo=(bo.get_TB_luck_equip_timeById=function(t){return void 0===t&&(t=App.hero.welfare.luckEquipId),TableData.getInstance().getData(TableData.tb_luck_equip_time,t)},bo.get_TB_luck_equip_time=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_luck_equip_time);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},bo);function bo(){}r.TB_luck_equip_time=vo;var Io=(To.getTempById=function(t){return TableData.getInstance().getData(TableData.tb_luck_treasure,t)},To.get_TB_luck_Treasure=function(t,e){void 0===t&&(t="type");var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_luck_treasure);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},To);function To(){}r.TB_luck_treasure=Io;var wo=(Eo.getTempById=function(t){return TableData.getInstance().getData(TableData.tb_luck_treasure_time,t)},Eo);function Eo(){}r.TB_luck_treasure_time=wo;var Co=(So.get_TB_recharge_signById=function(t){return TableData.getInstance().getData(TableData.tb_recharge_sign,t)},So.get_TB_recharge_sign=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_recharge_sign);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},So);function So(){}r.TB_recharge_sign=Co;var Lo=(xo.get_TB_luck_equip_rewardById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_luck_equip_reward,t)},xo.get_TB_luck_equip_reward=function(t,e){void 0===t&&(t="type"),void 0===e&&(e=App.hero.welfare.luckEquipId);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_luck_equip_reward);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},xo);function xo(){}r.TB_luck_equip_reward=Lo;var Ao=(Mo.get_TB_guild_seasonById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_guild_season,t)},Mo.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.season_reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},Mo.get_TB_guild_season=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_guild_season);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Mo);function Mo(){}r.TB_guild_season=Ao;var Do=(Oo.get_TB_person_seasonById=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_person_season,t)},Oo.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.season_reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},Oo.prototype.getRank=function(){},Oo.prototype.getRankStr=function(){return this._rankStr||(this._rankStr=this.rank[0]==this.rank[1]?""+this.rank[0]:this.rank[0]+"-"+this.rank[1]),this._rankStr},Oo.prototype.getRankSkin=function(){var t=Number(this.rank[0]);return t<=3?SkinUtil.getRankingSkin(t):""},Oo.get_TB_person_season=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=new Array,n=TableData.getInstance().getTableByName(TableData.tb_person_season);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},Oo);function Oo(){}r.TB_person_season=Do;var Ro=(Po.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_guild_war_set,t)},Po);function Po(){}r.TB_guild_war_set=Ro;var Uo=(ko.get_TB_version_ById=function(t){return TableData.getInstance().getData(TableData.tb_version,t)},ko);function ko(){}r.Tb_version=Uo;var Bo=(Vo.get_TB_notice_ById=function(t){return TableData.getInstance().getData(TableData.tb_notice,t)},Vo.prototype.getType=function(t){if(!this.par_click)return-1;for(var e=0,i=this.par_click;e<i.length;e++){var n=i[e];if(Number(n[0])==t)return Number(n[1])}return-1},Vo.prototype.getIndex=function(t){if(!this.par_click)return-1;for(var e=0,i=this.par_click;e<i.length;e++){var n=i[e];if(Number(n[1])==t)return Number(n[0])}return-1},Vo);function Vo(){}r.TB_notice=Bo;var No=(Go.getDataById=function(t){return TableData.getInstance().getData(TableData.tb_gold_exchange,t)},Go);function Go(){}r.TB_gold_exchange=No;var Ho=(jo.getSet=function(){return TableData.getInstance().getData(TableData.tb_exchange_set,1)},jo);function jo(){}r.TB_exchange_set=Ho;var Fo=(Wo.prototype.canAutoTurn=function(){return this.auto_scope&&0<this.auto_scope.length},Wo.prototype.canTurn=function(){return 1==this.turnstate},Wo.get_TB_map_ById=function(t){return TableData.getInstance().getData(TableData.tb_map,t)},Wo);function Wo(){}r.TB_map=Fo;var Ko=(qo.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_honour,t)},qo.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.bet_reward&&this.bet_reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},qo.prototype.getItemList=function(){var e=this;return this._itemList||(this._itemList=[],this.bet_item&&this.bet_item.forEach(function(t){e._itemList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._itemList},qo.prototype.getNotice=function(){var t=r.TB_notice.get_TB_notice_ById(this.notice);return t?t.content:"无内容"},qo);function qo(){}r.TB_honour=Ko;var zo=(Yo.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_honour_reward,t)},Yo.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},Yo.getHonourRewardList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_honour_reward);for(var o in n.data)null!=t?n.data[o][t]==e&&i.push(n.data[o]):i.push(n.data[o]);return i},Yo);function Yo(){}r.TB_honour_reward=zo;var Xo=(Jo.getSet=function(){return TableData.getInstance().getData(TableData.tb_honour_set,1)},Jo);function Jo(){}r.TB_honour_set=Xo;var Qo=(Zo.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_match,t)},Zo.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},Zo.prototype.getRankSkin=function(){var t=Number(this.rank[0]);return SkinUtil.getRankingSkin(t-1)},Zo.prototype.getRank=function(){return Number(this.rank[0])==Number(this.rank[1])?Number(this.rank[0]):999},Zo.prototype.getRankStr=function(){return this._rankStr||(99999999==this.rank[1]?this._rankStr="大于"+this.rank[0]:this._rankStr=this.rank[0]==this.rank[1]?""+this.rank[0]:this.rank[0]+"-"+this.rank[1]),this._rankStr},Zo.getItemList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_match);for(var o in n.data)null!=t?n.data[o][t]==e&&i.push(n.data[o]):i.push(n.data[o]);return i},Zo);function Zo(){}r.TB_match=Qo;var $o=(ta.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_match_score,t)},ta.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},ta.prototype.getRankText=function(){return-1==this.max_score?"大于"+this.score:this.score+"-"+this.max_score},ta.getItemList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_match_score);for(var o in n.data)null!=t?n.data[o][t]==e&&i.push(n.data[o]):i.push(n.data[o]);return i},ta);function ta(){this.max_score=-1}r.TB_match_score=$o;var ea=(ia.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_match_box,t)},ia.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},ia);function ia(){}r.TB_match_box=ea;var na=(oa.getSet=function(t){return TableData.getInstance().getData(TableData.tb_copy_config,t)},oa);function oa(){}r.TB_copy_config=na;var aa=(ra.getSet=function(){return TableData.getInstance().getData(TableData.tb_match_set,1)},ra.prototype.getWinRewardList=function(){var e=this;return this._winRewardList||(this._winRewardList=[],this.win_reward.forEach(function(t){e._winRewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._winRewardList},ra.prototype.getLostRewardList=function(){var e=this;return this._loserRewardList||(this._loserRewardList=[],this.lose_reward.forEach(function(t){e._loserRewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._loserRewardList},ra);function ra(){}r.TB_match_set=aa;var sa=(ua.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_fight_goddomain,t)},ua);function ua(){}r.TB_fight_goddomain=sa;var ha=(la.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_fight_goddomain_reward,t)},la.prototype.getRewardList=function(){var e=this;return this._rewardList||(this._rewardList=[],this.season_reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList},la.prototype.getRank=function(){return this.rank[0]},la.prototype.getRankStr=function(){return this._rankStr||(this._rankStr=this.rank[0]==this.rank[1]?""+this.rank[0]:500<this.rank[0]?"大于500":this.rank[0]+"-"+this.rank[1]),this._rankStr},la.prototype.getRankSkin=function(){var t=Number(this.rank[0]);return t<=3?SkinUtil.getRankingSkin(t-1):""},la.getItemList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_fight_goddomain_reward);for(var o in n.data)null!=t?n.data[o][t]==e&&i.push(n.data[o]):i.push(n.data[o]);return i},la);function la(){}r.TB_fight_goddomain_reward=ha;var ca=(pa.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_fight_goddomain_set,t)},pa.prototype.getWinReward=function(){var e=this;return this._winReward||(this._winReward=[],this.win_reward.forEach(function(t){e._winReward.push(new ItemVo(Number(t[0]),Number(t[1])))}),this.win_reward_bonus.forEach(function(t){e._winReward.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._winReward},pa.prototype.getLoseReward=function(){var e=this;return this._loseReward||(this._loseReward=[],this.lose_reward.forEach(function(t){e._loseReward.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._loseReward},pa);function pa(){}r.TB_fight_goddomain_set=ca;var da=(_a.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_rank_type,t)},_a.getPowerRanKEndTime=function(){if(0==this._powerRankEndTime){var t=TableData.getInstance().getTableByName(TableData.tb_rank_type).data;for(var e in t)t[e]&&2<=t[e].time.length&&t[e].time[1]>this._powerRankEndTime&&(this._powerRankEndTime=t[e].time[1])}return this._powerRankEndTime},_a.prototype.isActivityTime=function(t){return!(this.time.length<2)&&(this.time[0]-1)*TimeConst.ONE_DAY_SEC<=t&&t<=this.time[1]*TimeConst.ONE_DAY_SEC},_a.prototype.isShowActivityBtn=function(t){return!(this.time.length<2)&&(this.time[0]-1)*TimeConst.ONE_DAY_SEC<=t&&t<=(this.time[1]+1)*TimeConst.ONE_DAY_SEC},_a._powerRankEndTime=0,_a);function _a(){}r.TB_rank_type=da;var fa=(ga.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_growth_guide,t)},ga.getGrowthGuideList=function(){if(!this._growthGuideList){this._growthGuideList=[];var t=TableData.getInstance().getTableByName(TableData.tb_growth_guide).data;for(var e in t)t[e]&&this._growthGuideList.push(t[e]);this._growthGuideList.sort(function(t,e){return t.rank-e.rank})}return this._growthGuideList},ga);function ga(){}r.TB_growth_guide=fa;var ya=(ma.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_rank_reward,t)},ma.getRewardListByType=function(t){if(!this._typeRewardList){this._typeRewardList=new Object;var e=TableData.getInstance().getTableByName(TableData.tb_rank_reward).data;for(var i in e)e[i]&&(this._typeRewardList[e[i].type]||(this._typeRewardList[e[i].type]=new Array),this._typeRewardList[e[i].type].push(e[i]))}return this._typeRewardList[t]},ma);function ma(){}r.TB_rank_reward=ya;var va=(ba.getSysids=function(t){switch(t){case ba.TYPE_MAOXIAN:return[ModuleConst.WORLD_BOSS,ModuleConst.FOG_FOREST,ModuleConst.SHILIANTA];case ba.TYPE_LILIAN:return[ModuleConst.DAILY_COPY,ModuleConst.EXPEDITION,ModuleConst.CARAVAN_ESCORT,ModuleConst.TEAM_COPY];case ba.TYPE_JINGJI:return[ModuleConst.JINGJI,ModuleConst.Island];case ba.TYPE_KUAFU:return[ModuleConst.MATCH_FIGHT,ModuleConst.GLORY_FIGHT,ModuleConst.GOD_DOMAIN]}return[]},ba.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_function,t)},ba.getFunctionListByType=function(t){if(!this._functionList){this._functionList=new Object;var e=TableData.getInstance().getTableByName(TableData.tb_function).data;for(var i in e)if(e[i]){var n=e[i].ID,o=n%100,a=n-o;this._functionList[a]||(this._functionList[a]=new Array),0!=o&&this._functionList[a].push(e[i])}}return this._functionList[t]},ba.TYPE_LILIAN=100,ba.TYPE_MAOXIAN=200,ba.TYPE_JINGJI=300,ba.TYPE_KUAFU=400,ba.FUNCTION_REDPOINT={101:"dailycopy_group",102:"yuanzheng_group",103:"escort_group",104:"team_group",201:"",202:"boss_group",203:"forest_group",301:"jingjichang_group",302:"island_group",401:"glory_group",402:"jjc_match_group",403:"godDm_group"},ba.FUNCTION_GROUP_REDPOINT={100:["dailycopy_group","yuanzheng_group","escort_group","team_group"],200:["boss_group","forest_group"],300:["jingjichang_group","island_group"],400:["jjc_match_group","glory_group","godDm_group"]},ba);function ba(){}r.TB_function=va;var Ia=(Ta.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_fund,t)},Ta.init=function(){var t=0,e=TableData.getInstance().getTableByName(TableData.tb_fund).data;for(var i in e)e[i]&&t<e[i].openserver_time&&(t=e[i].openserver_time);this._fundStartTime=App.getOpenServerTime(),this._fundEndTime=this._fundStartTime+86400*t},Ta.fundStartTime=function(){return 0==this._fundStartTime&&this.init(),this._fundStartTime},Ta.fundEndTime=function(){return 0==this._fundEndTime&&this.init(),this._fundEndTime},Ta._fundStartTime=0,Ta._fundEndTime=0,Ta);function Ta(){}r.TB_fund=Ia;var wa=(Ea.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_fund_reward,t)},Ea.getFundListByType=function(t){if(!this._fundList){this._fundList=new Object;var e=TableData.getInstance().getTableByName(TableData.tb_fund_reward).data;for(var i in e)if(e[i]){var n=e[i].type;this._fundList[n]||(this._fundList[n]=new Array),this._fundList[n].push(e[i])}}return this._fundList[t]},Ea.FUND_TYPE_128=1,Ea.FUND_TYPE_228=2,Ea);function Ea(){}r.TB_fund_reward=wa;var Ca=(Sa.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_openservice_gift,t)},Sa);function Sa(){}r.TB_openservice_gift=Ca;var La=(xa.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_gift_time,t)},xa);function xa(){}r.TB_gift_time=La;var Aa=(Ma.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_chat_quick,t)},Ma.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_chat_quick);for(var o in n.data)null!=t?n.data[o][t]==e&&i.push(n.data[o]):i.push(n.data[o]);return i},Ma);function Ma(){}r.TB_chat_quick=Aa;var Da=(Oa.prototype.getAttr=function(){if(!this._attrAry&&(this._attrAry=[{},{}],this.attr))for(var t=0,e=this.attr;t<e.length;t++){var i=e[t];i[1]==ValueType.fixed?this._attrAry[0][i[0]]=i[2]:this._attrAry[1][i[0]]=i[2]}return this._attrAry},Oa.prototype.getQuality=function(){return Math.floor(this.ID/1e5)},Oa.prototype.getSlot=function(){var t=this.getQuality();return Math.floor((this.ID-1e5*t)/1e3)},Oa.prototype.getStrengthLv=function(){var t=this.getQuality(),e=this.getSlot();return this.ID-1e5*t-1e3*e},Oa.getTbItem=function(t,e,i){var n=Oa.getTbId(t,e,i);return r.TB_treasure.getItemById(n)},Oa.getTbId=function(t,e,i){return 1e5*t+1e3*e+i},Oa.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_treasure,t)},Oa.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_treasure);for(var o in n.data)null!=t?n.data[o][t]==e&&i.push(n.data[o]):i.push(n.data[o]);return i},Oa.getList2=function(t,e){var i=[],n=TableData.getInstance().getTableByName(TableData.tb_treasure);for(var o in n.data){var a=n.data[o],r=a.getQuality(),s=a.getSlot();r==t&&s==e&&i.push(n.data[o])}return i},Oa);function Oa(){}r.TB_treasure=Da;var Ra=(Pa.prototype.getAttr=function(){if(!this._attrAry&&(this._attrAry=[{},{}],this.attr))for(var t=0,e=this.attr;t<e.length;t++){var i=e[t];i[1]==ValueType.fixed?this._attrAry[0][i[0]]=i[2]:this._attrAry[1][i[0]]=i[2]}return this._attrAry},Pa.prototype.getMaterialList=function(){var e=this;return this._godMaterialList||(this._godMaterialList=[],this.star_cost&&this.star_cost.forEach(function(t){e._godMaterialList.push({type:t[0],quality:t[1],itemId:t[1],starLv:t[2],count:t[3]})})),this._godMaterialList},Pa.prototype.getQuality=function(){return Math.floor(this.ID/1e4)},Pa.prototype.getSlot=function(){var t=this.getQuality();return Math.floor((this.ID-1e4*t)/100)},Pa.prototype.getStarlv=function(){var t=this.getQuality(),e=this.getSlot();return this.ID-1e4*t-100*e},Pa.getTbItem=function(t,e,i){var n=Pa.getTbId(t,e,i);return r.TB_treasure_star.getItemById(n)},Pa.getTbId=function(t,e,i){return 1e4*t+100*e+i},Pa.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_treasure_star,t)},Pa.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_treasure_star);for(var o in n.data)null!=t?n.data[o][t]==e&&i.push(n.data[o]):i.push(n.data[o]);return i},Pa.getList2=function(t,e){var i=[],n=TableData.getInstance().getTableByName(TableData.tb_treasure_star);for(var o in n.data){var a=n.data[o],r=a.getQuality(),s=a.getSlot();a.attr&&0<a.attr.length&&r==t&&s==e&&i.push(n.data[o])}return i},Pa);function Pa(){}r.TB_treasure_star=Ra;var Ua=(ka.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_treasure_book,t)},ka.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_treasure_book);for(var o in n.data)null!=t?n.data[o][t]==e&&i.push(n.data[o]):i.push(n.data[o]);return i},ka);function ka(){}r.TB_treasure_book=Ua;var Ba=(Va.getTB_team_set=function(){return TableData.getInstance().getData(TableData.tb_team_set,1)},Va);function Va(){}r.TB_team_set=Ba;var Na=(Ga.getTB_team_targetById=function(t){return TableData.getInstance().getData(TableData.tb_team_target,t)},Ga.prototype.getRewardItems=function(){var i=this;return this._rewardItems||(this._rewardItems=[],this.reward&&this.reward.forEach(function(t,e){i._rewardItems.push(new ItemVo(t[0],t[1]))})),this._rewardItems},Ga.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_team_target);for(var o in n.data)null!=t?n.data[o][t]==e&&i.push(n.data[o]):i.push(n.data[o]);return i},Ga);function Ga(){}r.TB_team_target=Na;var Ha=(ja.getTB_team_copyById=function(t){return TableData.getInstance().getData(TableData.tb_team_copy,t)},ja.prototype.getRewardList=function(){var e=this;for(var t in this._rewardList||(this._rewardList=[],this.reward.forEach(function(t){e._rewardList.push(new ItemVo(Number(t[0]),Number(t[1])))})),this._rewardList)this._rewardList[t].extPram=Boolean(game.CopyTeamModel.getInstance().myFloor>=this.ID);return this._rewardList},ja);function ja(){}r.TB_team_copy=Ha;var Fa=(Wa.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_treasure_set,t)},Wa.prototype.getTreasureExp=function(e){var t=this.treasure_exp.find(function(t){return t[0]==e});return t&&t[1]?t[1]:0},Wa.prototype.getQualityExp=function(e){var t=this.be_devour_exp.find(function(t){return t[0]==e});return t&&t[1]?t[1]:0},Wa);function Wa(){}r.TB_treasure_set=Fa;var Ka=(qa.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_advance_road,t)},qa.prototype.getCondition=function(){if(!this._conditionT){this._conditionT=[];for(var t=0;t<this.condition.length;t++){var e=za.getSet(this.condition[t]);e&&this._conditionT.push(e)}}return this._conditionT},qa.getMaxLevel=function(){if(-1==this._maxLevel){this._maxLevel=0;var t=TableData.getInstance().getTableByName(TableData.tb_advance_road).data;for(var e in t)this._maxLevel++}return this._maxLevel},qa._maxLevel=-1,qa);function qa(){}r.TB_advance_road=Ka;var za=(Ya.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_advance_condition,t)},Ya.getAdvanceLevel=function(t){if(!this.ADVANCE_LEVEL){this.ADVANCE_LEVEL=[];var e=TableData.getInstance().getTableByName(TableData.tb_advance_road).data;for(var i in e)for(var n=e[i].condition,o=0;o<n.length;o++)this.ADVANCE_LEVEL[n[o]]=e[i].ID}return this.ADVANCE_LEVEL[t]?this.ADVANCE_LEVEL[t]:0},Ya);function Ya(){}r.TB_advance_condition=za;var Xa=(Ja.getSet=function(t){return void 0===t&&(t=1),TableData.getInstance().getData(TableData.tb_checkpoint_pass,t)},Ja.getTabByTaskId=function(t){void 0===t&&(t=1);var e=TableData.getInstance().getTableByName(TableData.tb_checkpoint_pass).data;for(var i in e)if(e[i].para==t)return e[i];return null},Ja);function Ja(){}r.TB_checkpoint_pass=Xa;var Qa=(Za.getTB=function(t){return TableData.getInstance().getData(TableData.tb_halo,t)},Object.defineProperty(Za.prototype,"raceType",{get:function(){return-1==this._raceType&&(this._raceType=Math.floor(this.type/Za.TYPE_BASE),this._raceType<0&&(this._raceType=-2)),this._raceType},enumerable:!0,configurable:!0}),Object.defineProperty(Za.prototype,"godNum",{get:function(){return-1==this._godNum&&(this._godNum=this.type%Za.TYPE_BASE),this._godNum},enumerable:!0,configurable:!0}),Object.defineProperty(Za.prototype,"conditionStr",{get:function(){if(""==this._conditionStr){var t=Math.floor(this.type/Za.TYPE_BASE),e=this.type%r.TB_halo.TYPE_BASE;this._conditionStr=t==Za.TYPE_ALL?LanMgr.getLan("所有阵营上阵{0}个",-1,e):LanMgr.getLan("上阵{0}个{1}英雄",-1,e,LanMgr.GOD_RACE_NAME[t])}return this._conditionStr},enumerable:!0,configurable:!0}),Za.init=function(){if(!this._isInit){this._isInit=!0,this._typeList=[];var t=TableData.getInstance().getTableByName(TableData.tb_halo).data;for(var e in t){var i=Math.floor(t[e].type/this.TYPE_BASE);this._typeList[i]||(this._typeList[i]=[]),this._typeList[i].push(t[e])}}},Za.getAllType=function(){return this.init(),this._typeList},Za.getType=function(t){return this.init(),this._typeList[t]},Za.TYPE_ALL=0,Za.TYPE_NUM=6,Za.TYPE_BASE=100,Za._isInit=!1,Za);function Za(){this._raceType=-1,this._godNum=-1,this._conditionStr=""}r.TB_halo=Qa;var $a=(tr.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_picture_frame,t)},tr.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_picture_frame);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},tr.prototype.isLock=function(){var t=r.TB_vip_privilege.get_TB_vip_privilegeById(this.activate_condition);return!!t&&App.hero.vip<t.vip_level},tr);function tr(){}r.TB_picture_frame=$a;var er=(ir.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_warrior_cycle,t)},ir.getAllRecharges=function(){for(var t=[],e=0,i=ir.getList();e<i.length;e++){var n=i[e];0<n.recharge_id&&t.push(n.recharge_id)}return t},ir.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_warrior_cycle);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},ir.prototype.getRewardItems=function(){var i=this;return this._rewardItems||(this._rewardItems=[],this.activate_reward&&this.activate_reward.forEach(function(t,e){i._rewardItems.push(new ItemVo(t[0],t[1]))})),this._rewardItems},ir.prototype.getShowItems=function(){var i=this;return this._showItems||(this._showItems=[],this.activate_reward_show&&this.activate_reward_show.forEach(function(t,e){i._showItems.push(new ItemVo(t[0],t[1]))})),this._showItems},ir);function ir(){}r.TB_warrior_cycle=er;var nr=(or.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_warrior_prove,t)},or.getItemByLv=function(e,i){return or.getList().find(function(t){return t.cycle==e&&t.level==i})},or.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_warrior_prove);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},or.prototype.getRewardItems=function(){var i=this;return this._rewardItems||(this._rewardItems=[],this.reward&&this.reward.forEach(function(t,e){i._rewardItems.push(new ItemVo(t[0],t[1]))})),this._rewardItems},or.prototype.getSpecialItems=function(){var i=this;return this._specialItems||(this._specialItems=[],this.special_reward&&this.special_reward.forEach(function(t,e){i._specialItems.push(new ItemVo(t[0],t[1]))})),this._specialItems},or);function or(){}r.TB_warrior_prove=nr;var ar=(rr.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_week_trial,t)},rr.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_week_trial);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},rr);function rr(){}r.TB_week_trial=ar;var sr=(ur.getItemById=function(t){return TableData.getInstance().getData(TableData.tb_month_trial,t)},ur.getList=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=[],n=TableData.getInstance().getTableByName(TableData.tb_month_trial);for(var o in n.data)if(null!=t){if(n.data[o][t]==e){var a=n.data[o];i.push(a)}}else a=n.data[o],i.push(a);return i},ur);function ur(){}r.TB_month_trial=sr;var hr=(lr.getSet=function(){return TableData.getInstance().getData(TableData.tb_warrior_set,1)},lr);function lr(){}r.TB_warrior_set=hr}(tb=tb||{});var ResTabelVo=function(){function t(){this.size=0,this.maxId=0}return t.prototype.parseTable=function(t,e,i,n){if(n){this.name=t,this.field=[],i&&(this.field=i.split(",")),this.typs=[],e&&(this.typs=e.split(","));var o=n.split(String.fromCharCode(1)),a=this.field.length,r=o.length/a,s=0;this.data=new Object;for(var u=0,h=0;h<r;h++){for(var l=TableData.mapCls[t],c=new(l||Object),p=0;p<a;p++){var d=o[s];switch(this.typs[p]){case"int":case"float":c[this.field[p]]=Number(d);break;case"bool":c[this.field[p]]="1"==d;break;case"string":c[this.field[p]]=d;break;case"array":c[this.field[p]]=this.parseAry(d);break;case"array2":c[this.field[p]]=this.parseAry2(d);break;default:c[this.field[p]]=d}s++}(this.data[c.ID]=c).ID>u&&(u=c.ID)}this.size=r,this.maxId=u}},t.prototype.parseAry=function(t){if(""===(t=(t=(t+"").replace(/，/g,",")).trim()))return null;for(var e=t.split(","),i=[],n=0,o=e.length;n<o;n++){var a=e[n].trim();i.push(isNaN(Number(a))?a:Number(a))}return 1===e.length&&0==i[0]&&(i=[]),i},t.prototype.parseAry2=function(t){if(""===(t=(t=((t=(t+"").replace(/，/g,","))+"").replace(/},/g,";").replace(/{/g,"").replace(/}/g,"")).trim()))return null;for(var e=[],i=t.split(";"),n=0,o=i.length;n<o;++n){var a=i[n].trim();""!==a&&e.push(this.parseAry(a))}return 1===i.length&&0===e[0].length&&(e=[]),e},t.prototype.getDataByID=function(t){return this.data[t]},t}(),TableData=function(){function t(){this._iter=0,this._count=0,this.tb=new Object}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.loadGameData=function(t,e,i){var n=this;void 0===e&&(e=null),void 0===i&&(i=null),this._completeFun=e,this._progessFun=i,tl3d.LoadManager.getInstance().load(t,tl3d.LoadManager.XML_TYPE,function(t){n.parseLineByStr(t)})},t.prototype.parseLineByStr=function(t){this._lines=t.split(String.fromCharCode(13)),this._count=this._lines.length/4,Laya.timer.frameLoop(1,this,this.loopAnlysi)},t.prototype.loopAnlysi=function(){for(var t=3;0<t;){if(t--,this._iter>=this._count)return void(this._completeFun&&(this._completeFun(),this._completeFun=null,this._progessFun=null));this._progessFun&&this._progessFun(this._iter/this._count);var e=this._lines[4*this._iter+0],i=this._lines[4*this._iter+1],n=this._lines[4*this._iter+2],o=this._lines[4*this._iter+3],a=new ResTabelVo;a.parseTable(e,n,i,o),this.tb[e]=a,this._iter++}},t.prototype.getData=function(t,e){return this.tb[t]?this.tb[t].getDataByID(e):null},t.prototype.getTabSize=function(t){return this.tb[t]?this.tb[t].size:0},t.prototype.getTabMaxID=function(t){return this.tb[t]?this.tb[t].maxId:0},t.prototype.getTableByName=function(t){return this.tb[t]?this.tb[t]:null},t.tb_hud="tb_hud",t.tb_sys_open="tb_sys_open",t.tb_role="tb_role",t.tb_god="tb_god",t.tb_skin="tb_skin",t.tb_god_set="tb_god_set",t.tb_god_employ_set="tb_god_employ_set",t.tb_awaken_conditions="tb_awaken_conditions",t.tb_god_awaken="tb_god_awaken",t.tb_star_title="tb_star_title",t.tb_msgCode="tb_msgCode",t.tb_game_set="tb_game_set",t.tb_skill="tb_skill",t.tb_skill_desc="tb_skill_desc",t.tb_sub_skill="tb_sub_skill",t.tb_skill_replace="tb_skill_replace",t.tb_effect="tb_effect",t.tb_buff="tb_buff",t.tb_skill_effect="tb_skill_effect",t.tb_buff_effect="tb_buff_effect",t.tb_copy="tb_copy",t.tb_copy_info="tb_copy_info",t.tb_plot="tb_plot",t.tb_daily_copy="tb_daily_copy",t.tb_expedition="tb_expedition",t.tb_copy_set="tb_copy_set",t.tb_item="tb_item",t.tb_monster="tb_monster",t.tb_god_evolution="tb_god_evolution",t.tb_god_star="tb_god_star",t.tb_wish="tb_wish",t.tb_wish_set="tb_wish_set",t.tb_task="tb_task",t.tb_task_title="tb_task_title",t.tb_daily="tb_daily",t.tb_daily_reward="tb_daily_reward",t.tb_market="tb_market",t.tb_market_set="tb_market_set",t.tb_god_level="tb_god_level",t.tb_god_resolve="tb_god_resolve",t.tb_god_fate="tb_god_fate",t.tb_fusion_soul="tb_fusion_soul",t.tb_evaluation="tb_evaluation",t.tb_random_name="tb_random_name",t.tb_rune_suit="tb_rune_suit",t.tb_rune="tb_rune",t.tb_rune_prefix="tb_rune_prefix",t.tb_rune_strength="tb_rune_strength",t.tb_rune_set="tb_rune_set",t.tb_arena_npc="tb_arena_npc",t.tb_rank_score="tb_rank_score",t.tb_arena_rank="tb_arena_rank",t.tb_goods="tb_goods",t.tb_trial="tb_trial",t.tb_guild="tb_guild",t.tb_guild_icon="tb_guild_icon",t.tb_guild_skill="tb_guild_skill",t.tb_guild_sign="tb_guild_sign",t.tb_guild_set="tb_guild_set",t.tb_guild_donate="tb_guild_donate",t.tb_guild_copy="tb_guild_copy",t.tb_guild_help="tb_guild_help",t.tb_copy_reward="tb_copy_reward",t.tb_exchange="tb_exchange",t.tb_first_recharge="tb_first_recharge",t.tb_level="tb_level",t.tb_day_sign="tb_day_sign",t.tb_total_sign="tb_total_sign",t.tb_sevendays="tb_sevendays",t.tb_sevendays_time="tb_sevendays_time",t.tb_arena_new="tb_arena_new",t.tb_arena_new_npc="tb_arena_new_npc",t.tb_arena_draw="tb_arena_draw",t.tb_arena_new_set="tb_arena_new_set",t.tb_recharge="tb_recharge",t.tb_vip="tb_vip",t.tb_month_card="tb_month_card",t.tb_vip_privilege="tb_vip_privilege",t.tb_vip_desc="tb_vip_desc",t.tb_escort_set="tb_escort_set",t.tb_escort="tb_escort",t.tb_adventure="tb_adventure",t.tb_adventure_set="tb_adventure_set",t.tb_forest="tb_forest",t.tb_forest_set="tb_forest_set",t.tb_island_set="tb_island_set",t.tb_island_level="tb_island_level",t.tb_island="tb_island",t.tb_worldboss="tb_worldboss",t.tb_boss_set="tb_boss_set",t.tb_mail="tb_mail",t.tb_equip_strength="tb_equip_strength",t.tb_strength_suit="tb_strength_suit",t.tb_refine_suit="tb_refine_suit",t.tb_equip_suit="tb_equip_suit",t.tb_equip_refine="tb_equip_refine",t.tb_equip_recycle="tb_equip_recycle",t.tb_equip_set="tb_equip_set",t.tb_gemstone="tb_gemstone",t.tb_gemstone_new="tb_gemstone_new",t.tb_gemstone_compound="tb_gemstone_compound",t.tb_accessory="tb_accessory",t.tb_accessory_suit="tb_accessory_suit",t.tb_accessory_set="tb_accessory_set",t.tb_level_fund="tb_level_fund",t.tb_operate_activity="tb_operate_activity",t.tb_risk_set="tb_risk_set",t.tb_activity_set="tb_activity_set",t.tb_model_dialogue="tb_model_dialogue",t.tb_risk="tb_risk",t.tb_group_buy="tb_group_buy",t.tb_question="tb_question",t.tb_activity_sevendays="tb_activity_sevendays",t.tb_limit_time="tb_limit_time",t.tb_summon_rank="tb_summon_rank",t.tb_summon_box="tb_summon_box",t.tb_group_buying_time="tb_group_buying_time",t.tb_group_buying="tb_group_buying",t.tb_divinity_door="tb_divinity_door",t.tb_divinity_set="tb_divinity_set",t.tb_sevendays_reward="tb_sevendays_reward",t.tb_baptize="tb_baptize",t.tb_artifact="tb_artifact",t.tb_artifact_strength="tb_artifact_strength",t.tb_artifact_enchant="tb_artifact_enchant",t.tb_artifact_baptize="tb_artifact_baptize",t.tb_artifact_obtain="tb_artifact_obtain",t.tb_artifact_skill="tb_artifact_skill",t.tb_artifact_skillcost="tb_artifact_skillcost",t.tb_artifact_set="tb_artifact_set",t.tb_divinity_replace="tb_divinity_replace",t.tb_version="tb_version",t.tb_notice="tb_notice",t.tb_exchange_set="tb_exchange_set",t.tb_gold_exchange="tb_gold_exchange",t.tb_map="tb_map",t.tb_skill_set="tb_skill_set",t.tb_shield="tb_shield",t.tb_recommend_squad="tb_recommend_squad",t.tb_dan="tb_dan",t.tb_person_season="tb_person_season",t.tb_guild_season="tb_guild_season",t.tb_guild_war_set="tb_guild_war_set",t.tb_luck_artifact="tb_luck_artifact",t.tb_luck_artifact_time="tb_luck_artifact_time",t.tb_luck_god="tb_luck_god",t.tb_luck_god_time="tb_luck_god_time",t.tb_luck_equip="tb_luck_equip",t.tb_luck_equip_time="tb_luck_equip_time",t.tb_luck_equip_reward="tb_luck_equip_reward",t.tb_luck_treasure="tb_luck_treasure",t.tb_luck_treasure_time="tb_luck_treasure_time",t.tb_recharge_sign="tb_recharge_sign",t.tb_share="tb_share",t.tb_online="tb_online",t.tb_openservice="tb_openservice",t.tb_fight_rank="tb_fight_rank",t.tb_activity_time="tb_activity_time",t.tb_honour="tb_honour",t.tb_honour_reward="tb_honour_reward",t.tb_honour_set="tb_honour_set",t.tb_match="tb_match",t.tb_match_score="tb_match_score",t.tb_match_set="tb_match_set",t.tb_match_box="tb_match_box",t.tb_copy_config="tb_copy_config",t.tb_fight_goddomain="tb_fight_goddomain",t.tb_fight_goddomain_reward="tb_fight_goddomain_reward",t.tb_fight_goddomain_set="tb_fight_goddomain_set",t.tb_rank_type="tb_rank_type",t.tb_growth_guide="tb_growth_guide",t.tb_rank_reward="tb_rank_reward",t.tb_function="tb_function",t.tb_fund="tb_fund",t.tb_fund_reward="tb_fund_reward",t.tb_openservice_gift="tb_openservice_gift",t.tb_gift_time="tb_gift_time",t.tb_optional="tb_optional",t.tb_daily_recharge="tb_daily_recharge",t.tb_week_recharge="tb_week_recharge",t.tb_month_recharge="tb_month_recharge",t.tb_chat_quick="tb_chat_quick",t.tb_treasure_star="tb_treasure_star",t.tb_treasure="tb_treasure",t.tb_treasure_book="tb_treasure_book",t.tb_treasure_set="tb_treasure_set",t.tb_advance_road="tb_advance_road",t.tb_advance_condition="tb_advance_condition",t.tb_checkpoint_pass="tb_checkpoint_pass",t.tb_halo="tb_halo",t.tb_recharge_rebate="tb_recharge_rebate",t.tb_picture_frame="tb_picture_frame",t.tb_warrior_prove="tb_warrior_prove",t.tb_warrior_cycle="tb_warrior_cycle",t.tb_week_trial="tb_week_trial",t.tb_month_trial="tb_month_trial",t.tb_warrior_set="tb_warrior_set",t.tb_team_copy="tb_team_copy",t.tb_team_target="tb_team_target",t.tb_team_set="tb_team_set",t.mapCls={tb_treasure_star:tb.TB_treasure_star,tb_team_copy:tb.TB_team_copy,tb_team_target:tb.TB_team_target,tb_treasure:tb.TB_treasure,tb_treasure_set:tb.TB_treasure_set,tb_skill:tb.TB_skill,tb_map:tb.TB_map,tb_item:tb.TB_item,tb_god:tb.TB_god,tb_copy_info:tb.TB_copy_info,tb_daily_copy:tb.TB_daily_copy,tb_expedition:tb.TB_expedition,tb_copy:tb.TB_copy,tb_god_set:tb.TB_god_set,tb_god_star:tb.TB_god_star,tb_monster:tb.TB_monster,tb_worldboss:tb.TB_worldboss,tb_notice:tb.TB_notice,tb_artifact:tb.TB_artifact,tb_daily_reward:tb.TB_daily_reward,tb_escort:tb.TB_escort,tb_forest:tb.TB_forest,tb_baptize:tb.TB_baptize,tb_island_level:tb.TB_island_level,tb_artifact_enchant:tb.TB_artifact_enchant,tb_guild_season:tb.TB_guild_season,tb_guild_help:tb.TB_guild_help,tb_person_season:tb.TB_person_season,tb_recharge_sign:tb.TB_recharge_sign,tb_group_buying_time:tb.TB_group_buying_time,tb_summon_box:tb.TB_summon_box,tb_summon_rank:tb.TB_summon_rank,tb_limit_time:tb.TB_limit_time,tb_honour:tb.TB_honour,tb_honour_reward:tb.TB_honour_reward,tb_arena_new_set:tb.TB_arena_new_set,tb_arena_new:tb.TB_arena_new,tb_arena_new_npc:tb.TB_arena_new_npc,tb_match:tb.TB_match,tb_match_score:tb.TB_match_score,tb_match_set:tb.TB_match_set,tb_match_box:tb.TB_match_box,tb_trial:tb.TB_trial,tb_fight_goddomain_reward:tb.TB_fight_goddomain_reward,tb_fight_goddomain_set:tb.TB_fight_goddomain_set,tb_activity_set:tb.TB_activity_set,tb_rank_type:tb.TB_rank_type,tb_growth_guide:tb.TB_growth_guide,tb_god_awaken:tb.TB_god_awaken,tb_fusion_soul:tb.TB_fusion_soul,tb_rank_reward:tb.TB_rank_reward,tb_strength_suit:tb.TB_strength_suit,tb_function:tb.TB_function,tb_refine_suit:tb.TB_refine_suit,tb_fund:tb.TB_fund,tb_fund_reward:tb.TB_fund_reward,tb_month_card:tb.TB_month_card,tb_openservice_gift:tb.TB_openservice_gift,tb_gift_time:tb.TB_gift_time,tb_optional:tb.TB_optional,tb_equip_suit:tb.TB_equip_suit,tb_artifact_strength:tb.TB_artifact_strength,tb_equip_refine:tb.TB_equip_refine,tb_equip_strength:tb.TB_equip_strength,tb_game_set:tb.TB_game_set,tb_advance_road:tb.TB_advance_road,tb_advance_condition:tb.TB_advance_condition,tb_checkpoint_pass:tb.TB_checkpoint_pass,tb_luck_treasure:tb.TB_luck_treasure,tb_luck_treasure_time:tb.TB_luck_treasure_time,tb_skin:tb.TB_skin,tb_daily_recharge:tb.TB_daily_recharge,tb_week_recharge:tb.TB_week_recharge,tb_month_recharge:tb.TB_month_recharge,tb_gemstone_new:tb.TB_gemstone_new,tb_gemstone_compound:tb.TB_gemstone_compound,tb_halo:tb.TB_halo,tb_guild_copy:tb.TB_guild_copy,tb_picture_frame:tb.TB_picture_frame,tb_warrior_prove:tb.TB_warrior_prove,tb_warrior_cycle:tb.TB_warrior_cycle,tb_week_trial:tb.TB_week_trial,tb_month_trial:tb.TB_month_trial},t}(),ResUseMgr=function(){function n(){}return n.startTick=function(){Laya.timer.clear(this,this.checkRes),Laya.timer.loop(1e3*n.TICK_TIME,this,this.checkRes)},n.checkRes=function(){var t=(new Date).getTime()/1e3;for(var e in this._resDic){var i=this._resDic[e];i?0==i.num&&0<i.lastTime&&t-i.lastTime>=n.DESTROY_TIME&&(this._resDic[e]=null,delete this._resDic[e],Laya.loader.clearTextureRes(e),loghgy("销毁资源",e)):delete this._resDic[e]}},n.useRes=function(t){if(t)for(var e=0,i=t;e<i.length;e++){var n=i[e];this._resDic[n]||(this._resDic[n]={num:0});var o=this._resDic[n];++o.num,o.lastTime=0,o.num<=0&&logerror("ResUseManager.资源使用错误,次数<=0",n,o.num),loghgy("使用资源",n,o.num)}},n.releaseRes=function(t){if(t)for(var e=0,i=t;e<i.length;e++){var n=i[e],o=this._resDic[n];!o||o.num<=0||(--o.num,o.lastTime=(new Date).getTime()/1e3,loghgy("释放资源",n,o.num))}},n.isExistRes=function(t){var e=this._resDic[t];return e&&0<e.num},n.clearTick=function(){Laya.timer.clear(this,this.checkRes)},n.loadRes=function(o,a){return void 0===a&&(a=!1),new Promise(function(e,t){var i=o.filter(function(t){return!Laya.loader.getRes(t)});if(0!=i.length){var n=UIMgr.getInstance();a&&n.showWaiting(),Laya.loader.load(i,Handler.create(null,function(t){a&&n.hideWaiting(),!1!==t?e():logdebug("资源加载失败：",i)}),Handler.create(null,function(t){a&&n.waitingProgress(t)}))}else e()})},n.hasRes=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.every(function(t){return Laya.loader.getRes(t)})},n._resDic={},n.TICK_TIME=30,n.DESTROY_TIME=180,n}(),DialogQueueMgr=function(){function t(){this._queueList=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setCurDialog=function(t){this._curUiName=t},t.prototype.getCudDialogName=function(){return this._curUiName},t.prototype.push=function(t,e,i){this._queueList.push({uiName:t,dataSource:e,args:i})},t.prototype.showFail=function(t){this._curUiName&&this._curUiName===t&&(this._curUiName=null,this.show())},t.prototype.show=function(){if(0!=this._queueList.length&&!this._curUiName){var t=this._queueList.shift();UIMgr.showUI(t.uiName,t.dataSource)}},t.prototype.hasDialog=function(){return!!this._curUiName},t.prototype.pushNext=function(t){this._curUiName&&this._curUiName===t&&(this._curUiName=null),this.show()},t.prototype.removeByName=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this._queueList.length-1;0<=i;i--){var n=this._queueList[i].uiName;n&&-1!=t.indexOf(n)&&this._queueList.splice(i,1)}},t.prototype.clear=function(){this._queueList.length=0,this._curUiName=null},t}(),DialogExtMgr=(__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),function(e){function t(){var t=e.call(this)||this;return t.leftPopupEffHandler=new Handler(t,t.leftPopupEff),t.leftCloseEffHandler=new Handler(t,t.leftCloseEff),t.maskLayer.offAll(),UIConfig.closeDialogOnSide&&t.maskLayer.on(Laya.Event.CLICK,t,t.closeOnSide),t}return __extends(t,e),t.prototype.closeOnSide=function(t){var e=this.getTopModelDialog();e instanceof DialogExt?e.isModelClose&&(AudioMgr.playSound("sound/close.mp3"),e.close("side")):e instanceof Laya.Dialog&&e.isModal&&(AudioMgr.playSound("sound/close.mp3"),e.close("side"))},t.prototype.getTopModelDialog=function(){for(var t=this.numChildren,e=t-1;0<=e;e--){var i=this.getChildAt(e);if(!i.isIgnore)return i}return this.getChildAt(t-1)},t.prototype._checkMask=function(){this.maskLayer.removeSelf();for(var t=this.numChildren,e=-123456,i=t-1;-1<i;i--){(n=this.getChildAt(i))&&n.isModal&&n.zOrder>e&&(e=n.zOrder)}for(i=t-1;-1<i;i--){var n;if((n=this.getChildAt(i))&&n.isModal&&n.zOrder==e){this.maskLayer.zOrder=n.zOrder,this.addChildAt(this.maskLayer,i);break}}},t.prototype.leftPopupEff=function(t){t.x=-t.width,t.alpha=.3,Laya.Tween.to(t,{x:0,alpha:1},300,Laya.Ease.strongOut,Handler.create(this,this.doOpen,[t]))},t.prototype.leftCloseEff=function(t,e){var i=-t.width;Laya.Tween.to(t,{x:i,alpha:.3},300,Laya.Ease.strongOut,Handler.create(this,this.doClose,[t,e]))},t}(Laya.DialogManager)),BarrageMgr=function(){function t(){this._barrageList=[],this._uiPool=[],this._uiUsePool=[],this._rolling=!1}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.addBarrages=function(t){this._barrageList=this._barrageList.concat(t),this._rolling||this.startTick()},t.prototype.removeBarrageByBox=function(t){for(var e=!0,i=-1;e;)(e=-1!=(i=this.findItemByBox(t)))&&this._barrageList.splice(i,1);for(var n=!0,o=-1;n;)if(n=-1!=(o=this.findUiByBox(t))){var a=this._uiUsePool.splice(o,1);Laya.Tween.clearAll(a[0]),this.uiGC(a[0])}},t.prototype.findUiByBox=function(i){if(!this._uiUsePool||this._uiUsePool.length<=0)return-1;this._uiUsePool.findIndex(function(t){var e=t.dataSource;return!!e&&e.parentBox==i})},t.prototype.findItemByBox=function(e){return!this._barrageList||this._barrageList.length<=0?-1:this._barrageList.findIndex(function(t){return t.parentBox==e})},t.prototype.startTick=function(){this._barrageList&&0<this._barrageList.length?(this._rolling=!0,this.onRoll()):this.stopTick()},t.prototype.stopTick=function(){this._rolling=!1},t.prototype.onRoll=function(){var t=this;if(!this._barrageList||this._barrageList.length<=0)this.stopTick();else{var e=this._barrageList.shift(),i=e.parentBox;if((i=i||Laya.stage)===Laya.stage||i.parent){var n=this.getUI();n.dataSource=e,n.text=e.barrageText,n.x=i.width,this._forNum=0,n.y=this.checkPosY(),i.addChild(n),this._uiUsePool.push(n),Laya.Tween.to(n,{x:-n.width},8e3,null,Handler.create(this,function(){t.uiGC(n)})),Laya.timer.once(2e3,this,this.onRoll)}else this.onRoll()}},t.prototype.checkPosY=function(){this._forNum++;for(var t=utils.random(200,600),e=!1,i=0;i<this._uiUsePool.length;i++){var n=this._uiUsePool[i],o=n.y,a=o+n.height;if(o<=t&&o<=a){e=!0;break}}return e&&this._forNum<=3?this.checkPosY():t},t.prototype.getUI=function(){if(0<this._uiPool.length)return this._uiPool.pop();var t=new Laya.Label;return t.color="#ffefd5",t.fontSize=24,t},t.prototype.uiGC=function(t){t.dataSource=null,t.removeSelf(),this._uiPool||(this._uiPool=[]),this._uiPool.push(t);var e=this._uiUsePool.indexOf(t);-1!=e&&this._uiUsePool.splice(e,1)},t}(),BarrageVo=function(){},SoundManager=Laya.SoundManager,AudioMgr=function(){function e(){}return e.playMusic=function(t){if(void 0===t&&(t="sound/battle_bgm3.mp3"),!e.MUSICPAUSE)try{e._curbgm!=t&&(e._soundChannel&&e._soundChannel.stop(),e._curbgm=t,e._soundChannel=SoundManager.playMusic(t,0))}catch(t){}},e.setPlayRate=function(t){try{SoundManager.playbackRate=t}catch(t){}},e.pauseMusic=function(){e._soundChannel&&(e._soundChannel.pause(),e.MUSICPAUSE=!0)},e.stopMusic=function(){e._soundChannel&&e._soundChannel.stop()},e.resumeMusic=function(){e._soundChannel&&e._soundChannel.resume()},e.playSound=function(t){if(void 0===t&&(t="sound/button.mp3"),!e.SOUNDSTOP)try{SoundManager.playSound(t,1)}catch(t){}},e.StopSound=function(t){if(t&&""!=t&&!e.SOUNDSTOP)try{SoundManager.stopSound(t)}catch(t){}},e.pauseSound=function(){SoundManager.stopAllSound(),e.SOUNDSTOP=!0},e.MUSICPAUSE=!1,e.SOUNDSTOP=!1,e}(),ActionbarMgr=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t}(),utils=function(){function h(){}return h.handleForChgVal=function(t,e){if(!t)return null;var i,n;if(t instanceof Array){i=[];for(var o=0,a=t.length;o<a;o++)n=t[o],i.push(h.getMsgValue(n,e));return i}for(var r in i={},t){if("object"!=typeof(n=t[r])&&!(n instanceof Array))return h.getMsgValue(t,e);null!==(n=this.handleForChgVal(n,e))&&(i[r]=n)}return i},h.random=function(t,e){return Math.round(Math.random()*(e-t))+t},h.strencode=function(t){var e=new Laya.Byte;return e.writeUTFBytes(t),e},h.strdecode=function(t,e){for(var i=new Laya.Byte,n=e,o=t.byteLength||t.length;n<o;n++)i.writeByte(t[n]);return i.pos=0,i.readUTFBytes()},h.copyArray=function(t,e,i,n,o){if(i instanceof ArrayBuffer)for(var a=0;a<o;a++)t[e++]=i[n++];else for(a=0;a<o;a++)t[e++]=i._getUInt8(n++)},h.getMsgValue=function(t,e){if(t&&e)if(t instanceof Array){if(0===t.length)return t;for(var i=0;i<t.length;i++)t[i]=this.getMsgValue(t[i],e)}else{var n=iface.dsConsts[e],o={};for(var a in n){var r=n[a],s=iface.dsRule[e];if(void 0!==t[r])switch(s?1:0){case 0:null!==t[r]&&(o[a]=t[r]);break;case 1:var u;null!==(u=s.__valueChangeMap&&s.__valueChangeMap[a]?h.handleForChgVal(t[r],s[a]):h.getMsgValue(t[r],s[a]))&&(o[a]=u)}}t=o}return t},h}();!function(t){var e=(i.prototype.send=function(t,e,i,n){if(this._tryTime--,0<=this._tryTime&&this._http){var o=["Content-Type",n||"application/x-www-form-urlencoded;charset=UTF-8"],a="";a=e instanceof Object?this.parseParms(e):e,"get"==i&&(t+="/?"+a),this._http.send(t,"get"==i?"":a,i,"text",o)}},i.prototype.tryAgain=function(){},i.prototype.parseParms=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e+=i+"="+t[i]+"&");return e},i.prototype.addCallback=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._requestSuccess=t,this._requestFail=e},i.prototype.showRequestSuccess=function(t){this._requestSuccess&&(this._backArgs?(this._backArgs.unshift(t),this._requestSuccess.apply(this,this._backArgs)):this._requestSuccess(t))},i.prototype.isDone=function(){return this._isDone},i.prototype.requestComplete=function(t){var e=this._http.data;e&&this.showRequestSuccess(e),this.requestClear()},i.prototype.requestError=function(t){this.requestClear(),common.AlertBox.showAlertYes({text:LanMgr.getLan("",10492),confirmCb:function(){BingoSDK.gameRefresh()}})},i.prototype.requestClear=function(){this._isDone=!0,this._tryTime=0,this._reqUrl=null,this._parmData=null,this._requestSuccess&&(this._requestSuccess=null),this._requestFail&&(this._requestFail=null),this.clearHttp()},i.prototype.clearHttp=function(){this._http&&(this._http=null)},i);function i(){this._tryTime=2,this.lastTime=0,this._isDone=!1,this._http=new Laya.HttpRequest,this._http.on(Laya.Event.COMPLETE,this,this.requestComplete),this._http.on(Laya.Event.ERROR,this,this.requestError)}t.SingleHttp=e}(http=http||{});__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<i;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,o++)n[o]=a[r];return n};var SrvState,REALMFLAG=function(){function t(){}return t.REALM_FLAG_CLOSE=0,t.REALM_FLAG_RUNNING=1,t}();!function(t){t[t.NORNAL=0]="NORNAL",t[t.BETTER=1]="BETTER",t[t.HOT=2]="HOT"}(SrvState=SrvState||{});var http,PLC=function(){function s(){this.posturl="",this.RES_OK=200,this.state=!0,this.RES_FAIL=500,this.RES_OLD_CLIENT=501,this.decodeIO_protobuf=null,this.decodeIO_encoder=null,this.decodeIO_decoder=null,this.reqId=0,this.heartbeatInterval=0,this.heartbeatTimeout=0,this.nextHeartbeatTimeout=0,this.gapThreshold=3e3,this.heartbeatId=null,this.heartbeatTimeoutId=null,this.handshakeCallback=null,this.heartbeatTime=0,this.initCallback=null,this.beatinit=!1,this.useCrypto=!1,this.routeMap={},this.dict={},this.abbrs={},this.protobuf=null,this.serverProtos={},this.clientProtos={},this.protoVersion=0,this._callbacks={},this.JS_WS_CLIENT_TYPE="js-http",this.ingoreList=[Protocol.game_guide_getGuideAward.key,Protocol.game_activity_updateActivityCondCount.key,Protocol.game_rank_getRankList.key],this.handlers=new Array,this.handlers[Package.TYPE_HANDSHAKE]=this.handshake.bind(this),this.handlers[Package.TYPE_HEARTBEAT]=this.heartbeat.bind(this),this.handlers[Package.TYPE_DATA]=this.onData.bind(this),this.handlers[Package.TYPE_KICK]=this.onKick.bind(this),this.callbacks=new Array}return s.getInstance=function(){return this._instance||(this._instance=new s),this._instance},s.prototype.on=function(t,e){(this._callbacks[t]=this._callbacks[t]||[]).push(e)},s.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=[].slice.call(arguments,1),o=this._callbacks[t];if(o)for(var a=0,r=(o=o.slice(0)).length;a<r;++a)o[a].apply(this,n);return this},s.prototype.off=function(t,e){this.removeAllListeners(t,e)},s.prototype.removeAllListeners=function(t,e){if(0!==arguments.length){var i=this._callbacks[t];if(i)if(!t||e){var n=this.index(i,e._off||e);~n&&i.splice(n,1)}else delete this._callbacks[t]}else this._callbacks={}},s.prototype.index=function(t,e){if([].indexOf)return t.indexOf(e);for(var i=0;i<t.length;++i)if(t[i]===e)return i;return-1},s.prototype.decode=function(t){var e=Message.decode(t);if(!(0<e.id)||(e.route=this.routeMap[e.id],delete this.routeMap[e.id],e.route))return e.body=this.deCompose(e),e},s.prototype.processPackage=function(t){var e=Package.decode(t);this.handlers[e.type].apply(this,[e.body])},s.prototype.processMessage=function(t,e){if(this.printMsg(e.body),e.id){var i=utils.getMsgValue(e.body.value,e.route.returns);if(i){var n=this.callbacks[e.id];delete this.callbacks[e.id],"function"==typeof n&&n(i)}}else t.emit(e.route.name,e.body)},s.prototype.processMessageBatch=function(t,e){for(var i=0,n=e.length;i<n;i++)this.processMessage(t,e[i])},s.prototype.printMsg=function(t){if(t&&t.msg){var e=t.msg;if("string"==typeof e)t.args?logdebug.apply(void 0,__spreadArrays([e],t.args)):logdebug(e);else if("number"==typeof e){var i=tb.TB_msgCode.get_TB_msgCodeById(e);i&&(t.args?logdebug.apply(void 0,__spreadArrays([i.text],t.args)):logdebug(i.text))}}},s.prototype.deCompose=function(t){var e=t.route&&t.route.name;if(t.compressRoute){if(!this.abbrs[e])return{};e=t.route=this.abbrs[e]}for(var i=new Laya.Byte,n=0,o=t.body.byteLength;n<o;n++)i.writeByte(t.body[n]);i.pos=0;var a=i.readUTFBytes();return this.protobuf&&this.serverProtos[e]?this.protobuf.decode(e,t.body):this.decodeIO_decoder&&this.decodeIO_decoder.lookup(e)?this.decodeIO_decoder.build(e).decode(t.body):JSON.parse(a)},s.prototype.encode=function(t,e,i){var n=t?Message.TYPE_REQUEST:Message.TYPE_NOTIFY;if(this.protobuf&&this.clientProtos[e])i=this.protobuf.encode(e,i);else if(this.decodeIO_encoder&&this.decodeIO_encoder.lookup(e)){i=new(this.decodeIO_encoder.build(e))(i).encodeNB()}else i=utils.strencode(JSON.stringify(i));var o=0;return this.dict&&this.dict[e]&&(e=this.dict[e],o=1),Message.encode(t,n,o,e,i)},s.prototype.sendloginmsg=function(e,t,i,n,o,a){void 0===a&&(a=null);var r=new http.SingleHttp;r.addCallback(function(t){o.call(e,[t])},function(t){logdebug("http错误"),a&&a.call(e,[t])}),r.send(ExtConfig.net_host+t,i,n)},s.prototype.sendServermsg=function(e,t,i,n,o,a){void 0===a&&(a=null);var r=new http.SingleHttp;r.addCallback(function(t){o.call(e,[t])},function(t){logdebug("http错误"),a&&a.call(e,[t])}),r.send(t,i,n)},s.prototype.authEntry=function(i,t,e,n){var o=this;this.queryEntry(t,e,function(t,e){o.entry(t,e,i,n)})},s.prototype.queryEntry=function(i,t,n){var o=this;this.pomeloInit(t.host,t.port,function(){var t=Protocol.gate_gate_queryEntry,e={};e[t.args.uid]=i,o.request(t,e,function(t){t&&(o.disconnect(null),n(t.host,t.httpPort))})})},s.prototype.entry=function(o,a,r,s){var u=this;this.pomeloInit(o,a,function(){var t=Protocol.game_enter_entry,n={};n[t.args.token]=r,logyhj("链接游戏服：",window.platform.serverInfo),n[t.args.sid]=window.platform.serverInfo.srv_id,setTimeout(function(){u.request(t,n,function(t){if(t){if(t.isNew){var e=t.base,i=window.platform.serverInfo;BingoSDK.gameReport("createRole",e.playerId,e.accountName,i.serverId,i.srv_name,{level:1,vip:0,charge:0})}u.on("reconnect",function(){u.entry(o,a,r,null)}),LoginMsgHandler.init(n),GameMsgHandler.init(),s&&s()}else s(null)})},500)})},s.prototype.pomeloInit=function(t,e,i){this.initCallback=i,this.posturl=t;var n={sys:{type:this.JS_WS_CLIENT_TYPE,version:s.JS_WS_CLIENT_VERSION,rsa:{}},user:{}},o=JSON.stringify(n),a=utils.strencode(o),r=Package.encode(Package.TYPE_HANDSHAKE,a);this.send(r)},s.prototype.handshake=function(t){if(t.code===this.RES_OLD_CLIENT)return this.emit("error","client version not fullfill"),logerror("client version not fullfill"),void common.AlertBox.showAlertYes({text:LanMgr.getLan("",10488),confirmCb:function(){BingoSDK.gameRefresh()}});if(t.code!==this.RES_OK)return this.emit("error","handshake fail"),void logerror("handshake fail");this.sid=t.sid,this.handshakeInit(t);var e=Package.encode(Package.TYPE_HANDSHAKE_ACK,utils.strencode(JSON.stringify({sid:this.sid})));this.send(e,!1)},s.prototype.send=function(t,e){void 0===e&&(e=!1);var i=http.NativeHttp.getHttp();i.setData(this.posturl,t.buffer,e),HttpQueueMgr.push(i)},s.prototype.request=function(t,e,i,n){void 0===n&&(n=!0),e=2===arguments.length&&"function"==typeof e?(i=e,{}):e||{};var o=t.key||e.name;if(o){if(this._routeObj||(this._routeObj={}),-1==this.ingoreList.indexOf(o)){var a=Date.now();if(this._routeObj.hasOwnProperty(o)){if(!(80<a-this._routeObj[o]))return;this._routeObj[o]=a}else this._routeObj[o]=a}this.reqId++,this.sendMessage(this.reqId,o,e,n),this.callbacks[this.reqId]=i,this.routeMap[this.reqId]=t}},s.request=function(t,e,i,n){void 0===n&&(n=!0),s.getInstance().request(t,e,i,n)},s.prototype.sendMessage=function(t,e,i,n){if(i.sid=this.sid,this.useCrypto){i=JSON.stringify(i);(i=JSON.parse(i)).__crypto__=""}this.encode&&(i=this.encode(t,e,i));var o=new Laya.Byte(i.length);o.writeArrayBuffer(i,0,i.length);var a=Package.encode(Package.TYPE_DATA,o);this.send(a,n)},s.prototype.handshakeInit=function(t){t.sys&&t.sys.heartbeat?(this.heartbeatInterval=1e3*t.sys.heartbeat,this.heartbeatTimeout=2*this.heartbeatInterval):(this.heartbeatInterval=0,this.heartbeatTimeout=0),this.initData(t),this.state=!0,"function"==typeof this.handshakeCallback&&this.handshakeCallback(t.user)},s.prototype.initData=function(t){if(t&&t.sys&&t.sid){this.sid=t.sid,this.dict=t.sys.dict;var e=t.sys.protos;if(this.dict)for(var i in this.abbrs={},this.dict)this.abbrs[this.dict[i]]=i;e&&(this.protoVersion=e.version||0,this.serverProtos=e.server||{},this.clientProtos=e.client||{},this.protobuf&&this.protobuf.init({encoderProtos:e.client,decoderProtos:e.server}),this.decodeIO_protobuf&&(this.decodeIO_encoder=this.decodeIO_protobuf.loadJson(this.clientProtos),this.decodeIO_decoder=this.decodeIO_protobuf.loadJson(this.serverProtos))),this.decodeIO_protobuf&&(this.decodeIO_encoder=this.decodeIO_protobuf.loadJson(this.clientProtos),this.decodeIO_decoder=this.decodeIO_protobuf.loadJson(this.serverProtos))}},s.prototype.sendHearBeat=function(){var t=Package.encode(Package.TYPE_HEARTBEAT,utils.strencode(JSON.stringify({sid:this.sid})));this.send(t)},s.prototype.heartbeat=function(t){if(t&&t.hasOwnProperty("now")&&(App.serverTime=t.now),0<this.heartbeatTime)Date.now(),this.heartbeatTime;this.heartbeatTime=Date.now(),this.initCallback&&(this.initCallback(),this.initCallback=null),this.heartbeatInterval?(this.beatinit||(this.beatinit=!0,this.sendHearBeat()),this.heartbeatTimeoutId&&(clearTimeout(this.heartbeatTimeoutId),this.heartbeatTimeoutId=null),this.heartbeatId||(this.heartbeatId=setTimeout(function(){this.heartbeatId=null,this.sendHearBeat(),this.nextHeartbeatTimeout=Date.now()+this.heartbeatTimeout,this.heartbeatTimeoutId=setTimeout(this.heartbeatTimeoutCb.bind(this),this.heartbeatTimeout)}.bind(this),this.heartbeatInterval))):logwarn("no heartbeat")},s.prototype.updateName=function(t,e,i){var n=Protocol.game_common_changePlayerData,o={};o[n.args.name]=t,o[n.args.sex]=e,this.request(n,o,function(t){t&&i&&i(t)})},s.prototype.enterGame=function(e){var t=Protocol.game_enter_enterGame;this.request(t,{},function(t){t&&(logdebug("enterGame succ!![%j]",t),Launch.unline=!1,e&&e(t))})},s.prototype.heartbeatTimeoutCb=function(){var t=Math.abs(Date.now()-this.nextHeartbeatTimeout);t<this.gapThreshold?this.heartbeatTimeoutId=setTimeout(this.heartbeatTimeoutCb.bind(this),t):(logerror("heartbeatTimeout"+Date.now(),t,this.nextHeartbeatTimeout,this.gapThreshold),this.disconnect("timeOut"))},s.prototype.onData=function(t){if(t){var e=t;if(this.decode&&(e=this.decode(e)),e)if(e.id){var i=utils.getMsgValue(e.body.value,e.route.returns),n=this.callbacks[e.id];if(delete this.callbacks[e.id],"function"==typeof n){var o="";if("string"==typeof e.body.msg)o=e.body.args?FormatStr(e.body.msg,e.body.args):e.body.msg;else if("number"==typeof e.body.msg){var a=tb.TB_msgCode.get_TB_msgCodeById(e.body.msg);a&&(o=e.body.args?FormatStr(a.text,e.body.args):a.text)}e.route.name!=Protocol.game_common_wish.name&&e.body.msg!=Lans.GroupNotRegTime&&showToast(o),App.hero.refreshData(i,e.route.name),n(i,o,e.body.msg)}}else this.emit(e.route.name,e.body)}},s.prototype.onKick=function(t){if(logwarn("onKick",t),Launch.unline=!0,this.closeheartbeat(),App.offline(),s.needFresh)return s.needFresh=!1,void BingoSDK.gameRefresh();var e=iface.tb_prop.exitType.hasOwnProperty(t)?LanMgr.getLan("",10490,t):LanMgr.getLan("",10491);t==iface.tb_prop.exitTypeKey.accountConflict&&(e=LanMgr.getLan("",10489)),common.AlertBox.showAlertYes({text:LanMgr.getLan(e,-1),confirmCb:function(){BingoSDK.gameRefresh()}})},s.prototype.disconnect=function(t){this._init&&t&&(logwarn("relogin"),dispatchEvt(new game.LoginEvent(game.LoginEvent.SEND_RELOGIN_EVENT))),this._init=!0,this.state=!1,logwarn("disconnect"),this.emit("close",t),this.closeheartbeat()},s.prototype.closeheartbeat=function(){this.heartbeatId&&(clearTimeout(this.heartbeatId),this.heartbeatId=null),this.heartbeatTimeoutId&&(clearTimeout(this.heartbeatTimeoutId),this.heartbeatTimeoutId=null),this.heartbeatTime=null,this.heartbeatInterval=null},s.SSO="/sso",s.SSO_LEZHONG="/sso_lezhong",s.NOTICELIST="/noticelist",s.JS_WS_CLIENT_VERSION="1",s}(),Package=function(){function t(){}return t.encode=function(t,e){var i=e.length,n=new Laya.Byte;n.writeUint8(255&t),n.writeUint8(i>>16&255),n.writeUint8(i>>8&255),n.writeUint8(255&i);for(var o=e.pos=0;o<i;o++)n.writeByte(e._getUInt8(o));return n},t.decode2=function(t){t.pos=0;var e,i=t.readByte(),n=(t.readByte()<<16|t.readByte()<<8|t.readByte())>>>0;if(t.bytesAvailable<=n){e=new Laya.Byte;for(var o=t.pos,a=t.length;o<a;o++)e.writeByte(t._getUInt8(o))}else logdebug("[Package] no enough length for current type:",i),n=0;if(e&&0<n&&4!=i){e.pos=0;var r=e.readUTFBytes();e=JSON.parse(r)}return{type:i,body:e,length:n}},t.decode=function(t){t.pos=0;var e=t.readByte(),i=(t.readByte()<<16|t.readByte()<<8|t.readByte())>>>0;t.bytesAvailable>i&&(logdebug("[Package] no enough length for current type:",e),i=0);var n=t;if(0<i&&4!=e){var o=t.readUTFBytes();n=JSON.parse(o)}return{type:e,body:n,length:i}},t.PKG_HEAD_BYTES=4,t.TYPE_HANDSHAKE=1,t.TYPE_HANDSHAKE_ACK=2,t.TYPE_HEARTBEAT=3,t.TYPE_DATA=4,t.TYPE_KICK=5,t}();!function(t){var e=(i.getHttp=function(){return 0<i._httpPools.length?i._httpPools.shift():new i},i.recyle=function(t){t.clear(),i._httpPools.push(t)},i.prototype.setData=function(t,e,i){this._url=t,this._data=e,this._loadFlag=i},i.prototype.nativesend=function(){var t=this;Launch.online?(this._tryTime--,this._loadFlag&&(this._timeout=setTimeout(function(){UIMgr.getInstance().showWaiting(),t._hasWaiting=!0},1e3)),this._http.open("post",this._url,!0),this._initHead||(this._initHead=!0,this._http.setRequestHeader("Content-Type","application/octet-stream")),this._http.send(this._data)):this.stopRequest()},i.prototype._onloaded=function(t){if(void 0!==this._http.status&&this._http.status,200<=this._http.status&&this._http.status<300||304==this._http.status){var e=new Laya.Byte(this._http.response||t);PLC.getInstance().processPackage(e),this.stopRequest()}else logerror("["+this._http.status+"]"+this._http.statusText+":"+this._http.responseURL),this.tryAgain()},i.prototype._onTimeout=function(t){this.tryAgain()},i.prototype._onError=function(t){logerror("onerror:",t),this.tryAgain()},i.prototype.tryAgain=function(){var t=this;0<=this._tryTime?setTimeout(function(){t.nativesend()},2e3):(showToast(LanMgr.getLan("",10213)),this.stopRequest())},i.prototype.stopRequest=function(){i.recyle(this)},i.prototype.isDone=function(){return this._idDone},i.prototype.clear=function(){this._idDone=!0,this._loadFlag&&(clearTimeout(this._timeout),this._loadFlag=!1),this._hasWaiting&&(UIMgr.getInstance().hideWaiting(),this._hasWaiting=!1),this._tryTime=2,this._url=null,this._data=null,this._timeout=0,HttpQueueMgr.update()},i._httpPools=new Array,i);function i(){this._tryTime=2,this._idDone=!1,this._http=new XMLHttpRequest,this._http.ontimeout=this._onTimeout.bind(this),this._http.timeout=5e3,this._http.responseType="arraybuffer",this._http.onerror=this._onError.bind(this),this._http.onload=this._onloaded.bind(this)}t.NativeHttp=e}(http=http||{});var Message=function(){function _(){}return _.encode=function(t,e,i,n,o,a){void 0===a&&(a=null);var r=this.msgHasId(e)?this.caculateMsgIdBytes(t):0,s=_.MSG_FLAG_BYTES+r;if(this.msgHasRoute(e))if(i){if("number"!=typeof n)throw new Error("error flag for number route!");s+=_.MSG_ROUTE_CODE_BYTES}else if(s+=_.MSG_ROUTE_LEN_BYTES,n){if(255<(n=utils.strencode(n)).length)throw new Error("route maxlength is overflow");s+=n.length}o&&(s+=o.length);var u=new Laya.Byte(s),h=0;return h=this.encodeMsgFlag(e,i,u,h,a),this.msgHasId(e)&&(h=this.encodeMsgId(t,u,h)),this.msgHasRoute(e)&&(h=this.encodeMsgRoute(i,n,u,h)),o&&(h=this.encodeMsgBody(o,u,h)),u},_.decode=function(t){var e=t.length,i=t.pos,n=0,o=null,a=t._getUInt8(i++),r=a&_.MSG_COMPRESS_ROUTE_MASK,s=a>>1&_.MSG_TYPE_MASK,u=a>>4&_.MSG_COMPRESS_GZIP_MASK;if(_.msgHasId(s))for(var h=0,l=0;n+=(127&(h=t._getUInt8(i)))<<7*l,i++,l++,128<=h;);if(_.msgHasRoute(s))if(r)o=t._getUInt8(i++)<<8|t._getUInt8(i++);else{var c=t._getUInt8(i++);o=c?(o=new ArrayBuffer(c),utils.copyArray(o,0,t,i,c),utils.strdecode(o)):"",i+=c}var p=e-i,d=new ArrayBuffer(p);return utils.copyArray(d,0,t,i,p),{id:n,type:s,compressRoute:r,route:o,body:d,compressGzip:u}},_.encodeMsgBody=function(t,e,i){return utils.copyArray(e,i,t,0,t.length),i+t.length},_.encodeMsgRoute=function(t,e,i,n){if(t){if(_.MSG_ROUTE_CODE_MAX<e)throw new Error("route number is overflow");i[n++]=e>>8&255,i[n++]=255&e}else e?(i[n++]=255&e.length,utils.copyArray(i,n,e,0,e.length),n+=e.length):i[n++]=0;return n},_.encodeMsgId=function(t,e,i){do{var n=t%128,o=Math.floor(t/128);0!==o&&(n+=128),e[i++]=n,t=o}while(0!==t);return i},_.encodeMsgFlag=function(t,e,i,n,o){if(t!==_.TYPE_REQUEST&&t!==_.TYPE_NOTIFY&&t!==_.TYPE_RESPONSE&&t!==_.TYPE_PUSH)throw new Error("unkonw message type: "+t);return i[n]=t<<1|(e?1:0),o&&(i[n]=i[n]|_.MSG_COMPRESS_GZIP_ENCODE_MASK),n+_.MSG_FLAG_BYTES},_.msgHasId=function(t){return t===_.TYPE_REQUEST||t===_.TYPE_RESPONSE},_.caculateMsgIdBytes=function(t){for(var e=0;e+=1,0<(t>>=7););return e},_.msgHasRoute=function(t){return t===_.TYPE_REQUEST||t===_.TYPE_NOTIFY||t===_.TYPE_PUSH},_.TYPE_REQUEST=0,_.TYPE_NOTIFY=1,_.TYPE_RESPONSE=2,_.TYPE_PUSH=3,_.MSG_FLAG_BYTES=1,_.MSG_ROUTE_CODE_BYTES=2,_.MSG_ROUTE_LEN_BYTES=1,_.MSG_COMPRESS_GZIP_ENCODE_MASK=16,_.MSG_COMPRESS_ROUTE_MASK=1,_.MSG_COMPRESS_GZIP_MASK=1,_.MSG_TYPE_MASK=7,_.MSG_ROUTE_CODE_MAX=65535,_}(),LoginMsgHandler=function(){function t(){this.reconnect=!1,this.reconncetTimer=null,this.reconnectUrl=null,this.reconnectAttempts=0,this.reconnectionDelay=5e3,this.DEFAULT_MAX_RECONNECT_ATTEMPTS=10,this.maxReconnectAttempts=0}return t.init=function(t){var e=(t=t||{}).reconnect,i=PLC.getInstance();i.on("onKick",function(){logdebug("onKick"),i.disconnect("onKick")}),i.on("disconnect",function(t){logdebug("disconnect:[%s]",t)}),i.on("close",function(t){logdebug("close"),i.emit("disconnect",t),e&&(this.reconncetTimer=setTimeout(function(){i.emit("reconnect"),this.reset()},this.reconnectionDelay),this.reconnectionDelay*=2)}),i.on("onUserLeave",function(t){logdebug("onUserLeave:[%d]",t.playerId)})},t.prototype.reset=function(){this.reconnectionDelay=5e3,clearTimeout(this.reconncetTimer),PLC.getInstance().off()},t}();(iface||(iface={})).tb_prop={godEmployTypeKey:{propOnce:0,propTen:1,friendOnce:2,friendTen:3,diamondOnce:4,diamondTen:5,legend:6},godEmployType:{0:"道具单次召唤",1:"道具十连召唤",2:"友情单次召唤",3:"友情十连召唤",4:"钻石单次召唤",5:"钻石十连召唤",6:"传说召唤"},currencyTypeKey:{gold:0,diamond:1,arena:2,friend:3,godExp:4,guildDonate:5,legendChip:6,soulStone:7,godCrystal:8,darkEssence:9,convertDust:10,honour:11,godDomain:12,vipScore:13},currencyType:{0:"金币",1:"钻石",2:"竞技币",3:"友情点",4:"神灵经验",5:"公会贡献",6:"传说碎片",7:"灵魂石",8:"神界结晶",9:"黑暗精华",10:"转换星尘",11:"荣耀币",12:"神域币",13:"VIP积分"},godUpgradeTypeKey:{oneLv:0,multiLv:1},godUpgradeType:{0:"升一级",1:"升多级"},copyPrecondTypeKey:{copyId:1,playerLevel:2,taskId:3,fightValue:4},copyPrecondType:{1:"关卡ID",2:"主角等级",3:"任务ID",4:"战斗力"},copyTypeKey:{main:1,rune:2,underground:3,tower:4},copyType:{1:"主线",2:"符文副本",3:"地下城",4:"试练塔"},itemTypeKey:{resource:1,gift:2,materials:3,god:5,chip:6,equip:7,treasure:8,timeItem:9,optionalCard:10,gemstone:11},itemType:{1:"资源",2:"礼包",3:"材料",5:"神灵",6:"材料碎片",7:"装备",8:"宝物",9:"限时物品",10:"自选卡",11:"宝石"},resTypeKey:{gold:1,diamond:2,friend:3,arena:4,roleExp:5,godExp:6,arenaNum:7,thew:8,guildExp:9,guildDonate:10,legendChip:11,soulStone:12,godCrystal:13,darkEssence:14,convertDust:15,advtScore:16,honour:17,godDomain:18,rechargeDmd:19,matchNum:20,vipScore:21},resType:{1:"金币",2:"钻石",3:"友情点数",4:"勋章",5:"主角经验",6:"神灵经验",7:"竞技次数",8:"体力",9:"公会经验",10:"公会贡献",11:"传说碎片",12:"灵魂石",13:"神界结晶",14:"黑暗精华",15:"转换星尘",16:"探险积分",17:"荣耀币",18:"神域币",19:"充值的钻石",20:"匹配赛次数",21:"VIP积分"},rewardDropTypeKey:{independence:1,combine:2},rewardDropType:{1:"独立概率掉落",2:"合并概率掉落"},lineupTypeKey:{attack:1,expedition:2},lineupType:{1:"进攻通用",2:"黑暗森林（失落遗迹）"},limitTypeKey:{quickMainNum:1,fastFrightFreeNum:2,friendPoint:3,wishMaxNum:4,wishFreeNum:5,buyMarketRefreshNum:6,guildDonate:7,buyArenaNum:8,buyGuildCopyNum:9,buyDailyCopyNum1:10,buyDailyCopyNum2:11,buyDailyCopyNum3:12,goldBuyNum:13,buyWorldBossNum:14,escortCount:15,robCount:16,buyMineRobNum:17,mineOccupyNum:18,advtFreeNum:19,luckGodFreeNum:20,luckEquipFreeNum:21,luckArtFreeNum:22,summonFreeNum:23,buyMatchNum:24,buyGodDmRewardNum:25,propFreeNum:26,diamondFreeNum:27,goldBuyFreeNum:28,dailyRewardNum:29,luckTreasureFreeNum:30,userQuestionNum:31,dailyFreeHelpNum:32,guildHelpAwardNum:33,guildHelpBuyNum:34,guildRecruitNum:35},limitType:{1:"快速战斗次数",2:"快速战斗免费次数",3:"友情点",4:"许愿最大次数",5:"许愿免费次数",6:"购买集市免费刷新次数",7:"公会捐赠id",8:"购买竞技场次数",9:"购买公会副本挑战次数",10:"购买每日副本金币试炼挑战次数",11:"购买每日副本经验试炼挑战次数",12:"购买每日副本碎片试炼挑战次数",13:"金币兑换购买次数",14:"世界boss挑战购买次数",15:"商队护送次数",16:"商队掠夺次数",17:"神秘岛屿掠夺购买次数",18:"神秘岛屿占领次数",19:"探险免费次数",20:"神灵转盘免费次数",21:"装备转盘免费次数",22:"神器转盘免费次数",23:"限时召唤免费次数",24:"购买匹配赛次数",25:"购买激战神域奖励剩余次数",26:"道具召唤免费次数",27:"钻石召唤免费次数",28:"金币兑换免费次数",29:"每日奖励领取次数",30:"宝物转盘免费次数",31:"用户反馈次数",32:"每日免费公会援助次数",33:"公会援助奖励次数",34:"公会援助购买次数",35:"公会招募次数"},overplusTypeKey:{guildCopyNum:1,dailyCopyNum1:2,worldBossNum:3,dailyCopyNum2:4,dailyCopyNum3:5,mineRobNum:6,arenaNum:7,matchNum:8,godDmRewardNum:9,marketRefreshNum:10},overplusType:{1:"公会挑战剩余次数",2:"每日副本金币试炼挑战剩余次数",3:"世界boss挑战剩余次数",4:"每日副本经验试炼挑战剩余次数",5:"每日副本碎片试炼挑战剩余次数",6:"神秘岛屿掠夺剩余次数",7:"竞技场剩余次数",8:"匹配赛剩余次数",9:"激战神域奖励剩余次数",10:"集市免费刷新剩余次数"},taskTypeKey:{mainLine:1,achievement:2,limitTime:3,experience:4},taskType:{1:"主线",2:"成就",3:"限时活动",4:"历练（符文副本）任务，历练界面显示"},taskSubTypeKey:{employ:1,lineup:2,passCopy:3,quickBattle:4,passCopyByType:5,costThew:6,godNum:9,godLevel:10,awaken:14,wish:17,arenaDefeatNpc:18,item:20,arenaWin:21,arenaWinStreak:22,arenaDefWin:23,playerLevel:24,towerMaxFloor:25,wearEquip:26,stthEquip:27,wearEquipOnSlot:28,rfEquip:29,wearAcc:30,devourAcc:31,diamondEmploy:32,market:33,arenaTopRank:34,expeditionMax:36,dailyCopy:37,worldBoss:38,worldChat:39,friendNum:40,sendPoint:41,getPoint:42,joinGuild:43,guildDonate:44,godUpgrade:46,clgArena:47,applyGuild:48,doorEmploy:49,clgCopyByType:50,stthArtifact:51,recycleEquip:52,skillUpArtifact:53,resolveGod:54,atftMaxStthLv:55,atftMaxSkillLv:56,guildSkillUpgrade:57,occupyMine:58,advtDispatch:59,fuseSoul:60,clgForest:61,maxForest:62,escort:63,atftBaptize:64,gemCompound:65,atftEnchant:66,clgGuildWar:67,openUI:68,wearTreasure:69,qualityGodNum:70,robMine:71,force:72,gemLevel:73,atftQualityNum:74,atftStarLevel:75,starTreasureNum:76,gemCompNum:77,gemWearNum:78},taskSubType:{1:"召唤X只神灵",2:"上阵X只神灵",3:"通关指定副本",4:"快速战斗",5:"通关XX类型副本",6:"消耗X点体力",9:"拥有X只Y星Z级的神灵",10:"X型神灵升到Y级",14:"进行X次胎Y神灵觉醒",17:"许愿X次",18:"竞技场中战胜指定NPC（怪物）",20:"累计获得XX道具",21:"竞技场累计进攻的胜利次数",22:"竞技场连胜次数",23:"竞技场中防御胜利次数",24:"玩家等级",25:"试练塔最高层数",26:"穿戴X件Y品质的装备，且强化+M，精炼+N",27:"强化X次装备",28:"穿戴的Z、M、N……位装备，且强化到+X，精炼+Y",29:"精炼X次装备",30:"穿戴X件Y品质的饰品，且精炼+M",31:"吞噬X件饰品",32:"高级召唤X次",33:"集市购买商品X次",34:"竞技场最高排名X名",36:"黑暗森林最高通关X关",37:"完成每日试炼X次",38:"挑战X次世界BOSS",39:"世界发言X次",40:"拥有X个好友",41:"赠送友情值X次",42:"领取友情值X次",43:"是否加入/创建公会",44:"公会捐献X次",46:"升级神灵X次",47:"竞技场挑战X次",48:"申请/创建公会",49:"神界之门召唤X次",50:"挑战XX类型副本",51:"神器强化X次",52:"分解X件装备",53:"神器技能升级X次",54:"分解X只神灵",55:"神器强化最高升到X级",56:"神器技能最高升到X级",57:"公会技能升级X次",58:"占领X级矿产Y次",59:"探险X次",60:"神灵融魂X次",61:"迷雾森林挑战X次",62:"迷雾森林最高通关X关",63:"护送X品质货物Y次",64:"神器洗练X次",65:"宝石合成X次",66:"神器附魔X次",67:"公会战挑战X次",68:"打开X界面Y次",69:"穿戴X件Y品质的宝物，且强化+M",70:"获得X个Y品质的神灵",71:"神秘岛屿掠夺X次",72:"神力达到X",73:"宝石总等级达到X",74:"神器洗练到X条Y品质属性",75:"神器升到Y星",76:"X个宝物升到Y星",77:"合成X个Y级宝石",78:"穿戴X个Y级宝石"},dailyTypeKey:{devourAcc:1,upgradeGod:2,employ:3,stthEquip:4,friend:5,arena:6,wish:7,guildDonate:8,guildCopy:9,market:10,dailyCopy:11,worldBoss:12,runeCopyWin:13,bgCopyWin:14,expeditionWin:15,occupyMine:16,advtDispatch:17,clgForest:18,escort:19},dailyType:{1:"1=精炼饰品",2:"2=神灵升级",3:"3=召唤神灵（召唤界面中任意召唤）",4:"4=装备强化",5:"5=好友赠送（自己送出去的）",6:"6=参加竞技场",7:"7=许愿次数",8:"8=公会捐献次数",9:"9=挑战公会副本次数",10:"10=集市购买次数",11:"11=每日试炼次数",12:"12=挑战世界BOSS次数",13:"13=挑战历练副本胜利次数",14:"14=挑战地下城胜利次数",15:"15=失落遗迹胜利次数",16:"16=神秘岛屿成功占领次数",17:"17=探险派遣次数",18:"18=迷雾森林挑战次数",19:"19=护送次数"},guildJobTypeKey:{president:1,vicePresident:2,member:3},guildJobType:{1:"会长",2:"副会长",3:"会员"},guildAutoJoinTypeKey:{yes:0,no:1},guildAutoJoinType:{0:"可以自动加入",1:"不可以自动加入"},guildApplyOptTypeKey:{yes:0,no:1},guildApplyOptType:{0:"同意申请",1:"拒绝申请"},mailStateTypeKey:{unread:0,read:1,get:2},mailStateType:{0:"未读",1:"已读",2:"已领取"},sysOpenTypeKey:{battle:100,quickBattle:110,autoBattle:120,chat:130,province:131,crossServer:132,setting:140,mail:150,mainCity:200,employ:210,mine:220,guild:230,guildCopy:231,background:240,tower:250,arena:260,album:270,friend:310,firstCharge:320,task:340,market:350,welfare:360,wish:361,levelAward:362,monthCard:363,payActivity:364,shop:370,activity:380,openGift:381,godRank:382,timeLimitBuy:383,luckTurnTable:384,onlineAward:385,share:386,realNameAuth:387,bindGift:388,superVip:389,microClient:390,weekFund:391,openSvrGift:392,openSvrFund:393,sevenDayLogin:394,fourteenDayLogin:395,rechargeRebate:396,warrior:397,god:400,awaken:401,fuseSoul:402,raiseDegree:403,treasure:410,bag:500,multiRecycle:510,runeCopy:600,sevenDay:710,halfMonth:711,expedition:720,dailyCopy:730,worldBoss:740,rank:750,door:760,raiseStar:770,resolve:780,recharge:790,artifact:800,artifactBaptize:801,artifactEnchant:802,adventure:810,escort:820,forest:830,equip:910,equipStrength:911,equipRefine:912,gem:913,honour:920,match:930,godDomain:940,beStrong:950,groupCopy:960,home:1e3},sysOpenType:{100:"战斗",110:"快速战斗",120:"自动战斗",130:"聊天",131:"同省聊天",132:"跨服聊天",140:"设置",150:"邮件",200:"神界",210:"召唤",220:"神秘岛屿",230:"公会",231:"公会副本",240:"地下城",250:"试练塔",260:"竞技场",270:"图鉴",310:"好友",320:"首充",340:"任务",350:"集市",360:"福利",361:"许愿",362:"等级奖励",363:"月卡",364:"付费活动",370:"商城",380:"活动",381:"开服豪礼",382:"神力排行榜",383:"限时热购",384:"幸运转盘",385:"在线奖励",386:"分享",387:"实名认证",388:"绑定豪礼",389:"超级会员",390:"微端下载",391:"周基金",392:"开服礼包",393:"开服基金",394:"七日登录",395:"十四日登录",396:"内测返利",397:"勇者之证",400:"神灵",401:"神灵觉醒",402:"神灵融魂",403:"神灵进阶",410:"宝物",500:"背包",510:"批量分解（装备）",600:"历练",710:"新手狂欢",711:"半月庆典",720:"失落遗迹",730:"每日副本",740:"世界BOSS",750:"排行榜",760:"神界之门",770:"上古祭坛（神灵升星）",780:"神灵分解",790:"充值",800:"神器",801:"神器洗练",802:"神器附魔",810:"探险",820:"护送",830:"迷雾森林",910:"装备",911:"装备强化",912:"装备精炼",913:"宝石",920:"荣耀之战",930:"匹配赛",940:"激战神域",950:"我要变强",960:"组队副本",1e3:"首页"},chatChannelTypeKey:{all:0,world:1,guild:2,group:3,whisper:4,province:5,crossServer:6,system:7},chatChannelType:{0:"全部聊天",1:"世界聊天",2:"公会聊天",3:"组队聊天",4:"私聊",5:"同省",6:"跨服",7:"系统"},chatTypeKey:{text:1,voice:2,notice:3},chatType:{1:"文本聊天",2:"语音聊天",3:"系统公告"},arenaClgTypeKey:{initiative:1,fightBack:2},arenaClgType:{1:"主动挑战",2:"反击挑战"},useItemTypeKey:{chip:1,gift:2,employTicket:3,optionalCard:4},useItemType:{1:"使用碎片",2:"使用礼包",3:"使用召唤券",4:"自选卡"},speOpeTypeKey:{dmOnceTotalNum:1,rfshMktTotalNum:2,psGtBkTotalNum:3,doorTotalNum:4,doorEmployNum:5},speOpeType:{1:"累计钻石单招次数",2:"累计刷新集市次数",3:"累计通关巨人地下城次数",4:"累计神界之门次数",5:"神界之门召唤次数"},signInTypeKey:{none:0,normal:1,supplement:2},signInType:{0:"未签到",1:"正常签到",2:"补签到"},vipPrivilegeTypeKey:{godMaxNum:1,thewBuyNum:2,arenaBuyNum:3,quickBattleNum:4,wishNum:5,offlineIncomeTime:6,hangupIncome:7,guildCopyBuyNum:8,dailyCopyBuyNum:9,goldBuyNum:10,worldBossNum:11,runeCopyExtraNum:12,matchBuyNum:13,godDmRewardNum:14},vipPrivilegeType:{1:"神灵上限增加",2:"体力购买次数",3:"竞技场购买次数增加",4:"快速战斗次数",5:"许愿次数上限增加",6:"离线收益时间延长",7:"挂机收益提升",8:"公会副本购买次数增加",9:"每日副本购买次数增加",10:"金币兑换购买次数增加",11:"世界boss购买次数增加",12:"历练副本额外次数",13:"匹配赛购买次数增加",14:"激战神域购买次数增加"},levelPrivilegeTypeKey:{thewMaxNum:1,battleSpeed:2,runeCopy:3,oneKeyRefine:4,legendEmploy:5,forest:6,createGuild:10},levelPrivilegeType:{1:"增加体力上限",2:"战斗3倍加速开放",3:"符文副本【扫荡】开启",4:"一键精炼提前开启等级",5:"传说召唤开启",6:"迷雾森林【一键扫荡】开启",10:"创建公会"},recordStateTypeKey:{unread:0,read:1,get:2},recordStateType:{0:"未读",1:"已读",2:"已领取"},mailArgsTypeKey:{none:0,item:1,god:2,honourBet:3,honourAward:4},mailArgsType:{0:"无",1:"物品",2:"神灵",3:"荣耀之战押注",4:"荣耀之战奖励"},equipStthTypeKey:{one:1,five:2},equipStthType:{1:"强化一次",2:"强化五次"},redPointTypeKey:{mail:0,point:1,friend:2,treasure:3,newRecharge:4,newMail:5,newPoint:6,newFriend:7,rechargeSum:8,consumeSum:9,singleRecharge:10,dailyRecharge:11,giftPacks:12,exchange:13,loginSum:14,dailyRechargeSum:15,goundSum:16,newArena:17,sevenDay:18,whisper:19,guildApply:20,guildCopyAward:21,escort:22,mine:23,myMine:24,guildWarAward:25,openGifts:26,matchDef:27,inviteList:28,refuseInvite:29,newCommon:30,inviteCopyList:31,refuseCopyInvite:32,groupCopyChange:33,applyGroupCopy:34,groupCopyKick:35,groupCopyAppoint:36,guildHelpCanGet:37},redPointType:{0:"邮件",1:"友情点",2:"好友申请",3:"宝藏",4:"新充值",5:"新邮件",6:"新友情点",7:"新好友申请",8:"新累计充值",9:"新累计消费",10:"新单笔充值",11:"新每日充值",12:"新超值礼包",13:"新兑换活动",14:"新累计登陆",15:"新每日累计充值",16:"新地下城挑战",17:"新竞技场记录",18:"新手七天活动",19:"有新私聊信息",20:"有新公会申请信息",21:"有可领取公会副本奖励信息",22:"有新商队被劫记录信息",23:"有新岛屿矿点记录信息",24:"有我的矿点变化信息",25:"有我可领取公会战宝箱奖励信息",26:"有可领取的开服豪礼",27:"新匹配赛防守记录",28:"有组队邀请信息",29:"有拒绝邀请信息",30:"有新数据变化信息",31:"有组队副本邀请信息",32:"有拒绝组队副本邀请信息",33:"组队副本有变化",34:"申请加入组队副本",35:"组队副本被踢出",36:"组队副本任命队长",37:"公会援助可领取"},activityTypeKey:{rechargeSum:1,consumeSum:2,singleRecharge:3,dailyRecharge:4,giftPacks:5,exchange:6,loginSum:7,arenaSum:8,goundSum:9,loginday:10,runeCopy:11,friendPoint:12,sellItem:13,towerCopy:14,godEmploy:15,arenaTopRank:16,hasLevelGod:17,mainCopy:18,getStarGod:19,getStarAccessory:20,getStarEquip:21,playerLevel:22,godAwaken:23,refineAccessory:24,strengthenEquip:25,refineEquip:26,fuseGod:27,worldBoss:28,guildCopy:29,maxForest:30,escortCount:31,robCount:32,atftBaptize:33,advtDispatch:34,mineOccupyNum:35,mineRobNum:36,door:37,artifactLevel:38,hasFriend:39,maxForce:40,matchWar:41,godDomain:42,artifactStarLevel:43,artifactBaptize:44,godAwakenLevel:45,gemWearNum:46,dailyCopy:47,expedition:48,qualityTreasureNum:49,starTreasureNum:50},activityType:{1:"累计充值",2:"累计消费",3:"单笔充值",4:"每日充值",5:"超值礼包",6:"兑换活动",7:"累计登陆",8:"竞技场挑战",9:"地下城挑战",10:"登陆可领取",11:"通关作战副本第X关",12:"赠送好友X次友情点",13:"出售道具",14:"试练塔达到第X关",15:"进行X次高级召唤",16:"竞技场最高排名X名",17:"拥有X个达到X等级的神灵",18:"远征通关第X关",19:"获得X个Y星神灵",20:"获得X件Y品质的饰品",21:"获得X件Y品质的装备",22:"玩家等级达到X级",23:"觉醒X次神灵",24:"精炼X件Y品质的饰品到+Z",25:"强化X件Y品质的装备到+Z",26:"精炼X件Y品质的装备到+Z",27:"上古祭坛合成X个Y星神灵",28:"参与击杀X次世界BOSS",29:"公会副本挑战X次",30:"迷雾森林最高关卡",31:"护送次数",32:"掠夺商队次数",33:"神器洗练次数",34:"探险次数",35:"神秘岛屿占领X座岛屿",36:"神秘岛屿掠夺次数",37:"神界之门次数",38:"神器最高等级",39:"拥有X个好友",40:"神力达到X",41:"匹配赛挑战X次",42:"激战神域挑战X次",43:"神器升到Y星",44:"神器洗练到X条Y品质属性",45:"X个神灵觉醒到Y级",46:"镶嵌X个Y级宝石",47:"每日副本挑战成功X次",48:"失落遗迹通关第X关",49:"X件Y品质的宝物",50:"X个宝物升到Y星"},operateActivityTypeKey:{rechargeSum:1,consumeSum:2,singleRecharge:3,dailyRecharge:4,giftPacks:5,exchange:6,loginSum:7,arenaSum:8,goundSum:9,dailyCopy:10,worldBoss:11,expeditionMax:12,mineOccupyNum:13,mineRobNum:14,escortCount:15,robCount:16,advtDispatch:17,guildCopy:18,door:19,employ:20,runeCopy:21,dailyRechargeSum:22,dailyConsumeSum:23},operateActivityType:{1:"累计充值",2:"累计消费",3:"单笔充值",4:"每日充值",5:"超值礼包",6:"兑换活动",7:"累计登陆",8:"竞技场挑战",9:"地下城挑战",10:"每日副本次数（完成才计算）",11:"世界BOSS挑战次数",12:"失落遗迹最高关卡",13:"神秘宝藏占领次数（成功才计数）",14:"神秘宝藏掠夺次数（不管胜负）",15:"护送商队次数",16:"掠夺商队次数（不管胜负）",17:"探险次数",18:"公会副本挑战次数",19:"神界之门开启次数",20:"钻石召唤次数",21:"历练完成次数（成功才计数）",22:"每日累计充值X元",23:"每日累计消费X钻石"},equipRefineTypeKey:{nomal:0,onekey:1},equipRefineType:{0:"普通精炼",1:"一键精炼"},rankTypeKey:{force:1,level:2,arenaSorce:3,guildLevel:4,god:5,runeCopyFloor:6,towerCopyFloor:7,worldBoss:8,forest:9,summon:10,match:11,godDmWorld:12,godDmLocal:13,godStarLevel:14,groupCopyFloor:15},rankType:{1:"神力",2:"等级",3:"竞技场",4:"公会",5:"神灵",6:"历练",7:"试炼塔",8:"世界boss",9:"迷雾森林",10:"限时召唤",11:"匹配赛",12:"跨服激战神域",13:"本服激战神域",14:"神灵星级",15:"组队副本关卡"},globalTypeKey:{iMergeVersion:1,iGuildWarSession:2,iGuildWarSessionTime:3,iGuildWarStartSession:4,tActivityIds:5,tShowBlockIds:6,iOpenTime:7,iLastRefreshTime:8,iGuildWarUpdateTime:9,iGuildWarSettleTime:10,tGuildWarRegGuildId:11,iSignInStartTime:12,tLuckGodTypeNum:13,tLuckEquipTypeNum:14,tLuckArtTypeNum:15,tLuckGodRecord:16,tLuckEquipRecord:17,iLuckGodId:18,iLuckEquipId:19,iLuckArtId:20,tRankEndTimes:21,tRankInfo:22,iHonourWarSession:23,iHonourWarSessionEndTime:24,iHonourWarStage:25,iHonourWarStageEndTime:26,iHonourWarMaxRound:27,iHonourWarRound:28,iHonourWarRoundEndTime:29,iHonourWarMatchEndTime:30,iHonourWarBetStartTime:31,iHonourWarBetEndTime:32,tHonourWarRegPlayerId:33,tHonourWarRankInfo:34,tHonourWarRankPlayerId:35,iHonourWarSettleTime:36,tSysLiveInfo:37,tGodDmRegEndTimes:38,iHonourWarKuafuStage:39,tLuckTreasureNum:40,iLuckTreasureId:41,tLuckTreasureRecord:42,iOpenSvrGroupBuyTime:43,iGuildLastRefreshTime:44,iFriendLastRefreshTime:45,tGroupCopyPlayerInfo:46},globalType:{1:"合服版本号",2:"公会战当前赛季ID",3:"公会战当前赛季时间",4:"公会战开始赛季ID",5:"后台活动id列表",6:"后台显示模块id列表",7:"开服时间",8:"最后刷新时间",9:"公会战更新时间",10:"公会战结算时间",11:"公会战报名公会ID",12:"每日签到本轮开始时间",13:"神灵转盘保底次数",14:"装备转盘保底次数",15:"神器转盘保底次数",16:"神灵转盘记录",17:"装备转盘记录",18:"神灵转盘ID",19:"装备转盘ID",20:"神器转盘ID",21:"排行结束时间",22:"历史排行信息",23:"荣耀之战赛季",24:"荣耀之战赛季结束时间",25:"荣耀之战阶段",26:"荣耀之战阶段结束时间",27:"荣耀之战最大轮数",28:"荣耀之战轮数",29:"荣耀之战轮数结束时间",30:"荣耀之战匹配结束时间",31:"荣耀之战押注开始时间",32:"荣耀之战押注结束时间",33:"荣耀之战报名玩家ID",34:"荣耀之战上届前三名玩家信息",35:"荣耀之战本届前16名玩家ID",36:"荣耀之战本届跨服结算时间",37:"每天系统活跃度信息",38:"激战神域队伍匹配结束时间",39:"荣耀之战跨服阶段",40:"宝物转盘保底次数",41:"宝物转盘ID",42:"宝物转盘记录",43:"开服团购人数自增时间",44:"公会最后刷新时间",45:"好友最后刷新时间",46:"全服首通信息"},expeditionOpTypeKey:{recover:1,revive:2},expeditionOpType:{1:"回复血量",2:"复活"},godRaceTypeKey:{greece:1,china:2,northEurope:3,light:4,dark:5},godRaceType:{1:"神殿",2:"玄门",3:"圣域",4:"光明",5:"黑暗"},dailyCopyTypeKey:{gold:1,exp:2,chip:3},dailyCopyType:{1:"金币试炼",2:"经验试炼",3:"碎片试炼"},platformTypeKey:{bingo:1,version:2,changyu:3,buddy:4,lezhong:5},platformType:{1:"冰菓",2:"版署",3:"畅娱",4:"小伙伴",5:"乐众"},fuseAttrTypeKey:{hp:1,atk:2,def:3},fuseAttrType:{1:"血量",2:"攻击",3:"防御"},fuseNumTypeKey:{one:1,ten:2},fuseNumType:{1:"融魂一次",2:"融魂十次"},escortRecordTypeKey:{success:0,fail:1},escortRecordType:{0:"抵御成功",1:"抵御失败"},attrTypeKey:{hpMax:1,atk:2,def:3,atkSpd:4,crit:5,critDmg:6,effectHit:7,effectResist:8,suckBlood:9,strikeBack:10,rampage:11,dizzy:12,dmgRate:13,healRate:14,addDmg:15,subDmg:16,anger:17,immuDizzy:18},attrType:{1:"生命",2:"攻击",3:"防御",4:"攻速",5:"暴击率",6:"暴击伤害",7:"效果命中",8:"效果抵抗",9:"吸血",10:"反击",11:"再次出手",12:"眩晕",13:"伤害加成",14:"治疗加成",15:"增伤",16:"减伤",17:"怒气",18:"免控率"},baptizeTypeKey:{normal:1,advanced:2},baptizeType:{1:"普通洗练",2:"高级洗练"},gemTypeKey:{hp:1,atk:2,def:3},gemType:{1:"生命",2:"攻击",3:"防御"},gemUpgradeTypeKey:{one:1,five:2},gemUpgradeType:{1:"升一级",2:"升五级"},mineRecordTypeKey:{occupySuccess:0,occupyFail:1,robSuccess:2,robFail:3,finish:4},mineRecordType:{0:"被抢占抵御成功",1:"被抢占抵御失败",2:"被掠夺抵御成功",3:"被掠夺抵御失败",4:"采集完成"},attackStateTypeKey:{free:0,being:1},attackStateType:{0:"空闲中",1:"正在被攻打中"},exitTypeKey:{sessionError:1,kick:2,accountConflict:3,heartBeatTimeout:4},exitType:{1:"会话错误",2:"被踢下线",3:"账号冲突",4:"心跳超时"},targetTypeKey:{enemyMinHp:1,enemyRandom:2,ownMinHp:3,ownRandom:4,self:5,ownDead:6,ownDeadOrSelf:7,external:8,ownRanNotSelf:9,tagOne:10,frontRow:11,backRow:12,ownAtkMax:13,ownDeadOrHpLow:14,sameMainTag:15,allTag:16,frontAndRandomBack:17},targetType:{1:"敌方血量最低目标",2:"敌方指定目标（自动战斗时则随机）",3:"己方血量最低目标",4:"己方指定目标（自动战斗时则随机）",5:"自身",6:"已死亡的队友",7:"已死亡的队友或自身",8:"外部指定的目标",9:"己方随机(除自身)",10:"默认1号位",11:"前排",12:"后排",13:"己方攻击最高的单位",14:"己方已死亡或血量最低的单位",15:"目标与主技能一致(主技能在技能表skill的顺序须在该技能之前)",16:"己方所有目标（包括死亡）",17:"优先前排，前排人数不够在后排随机"},triggerTypeKey:{useSkill:1,selfBeAtk:2,selfDead:3,ownBeAtk:4,enterScene:6,beCrit:7,crit:8,enemyDead:9,leader:10,eftAnyObj:11,critAnyEnemy:12,addAtt:13,ownDead:14,roundBefore:15,addDamage:16,inScene:17,enterSceneFirst:18,addBuff:19},triggerType:{1:"自身施法时触发",2:"自身被攻击时触发",3:"自身死亡时触发",4:"队友被攻击时触发（包括自身）",6:"进场触发",7:"被暴击时触发",8:"暴击时触发",9:"敌方死亡触发",10:"作为队长时触发",11:"效果对任一目标生效",12:"对任一敌方造成暴击",13:"被动属性加成（加到面板）",14:"队友死亡时触发",15:"大回合开始前触发",16:"受到任何伤害时触发",17:"在场时生效",18:"首次进入战斗时生效",19:"创建buff前触发"},trigSubTypeKey:{selfHpLess:1,selfAndEnemyHp:2,existBuffId:3,existBuffType:4,existBuffStatType:5,enemyHpUp:6,filterProfession:7,filterBuff:8},trigSubType:{1:"自身血量低于多少百分比触发",2:"敌方生命与自身生命高低",3:"中了某个指定的buff，条件值为buff_id",4:"中了某种类型的buff，条件值为buff类型",5:"中增益或减益buff，值为buff的状态类型",6:"敌方血量高于多少百分比触发",7:"对XX职业有效（神灵表type）",8:"新添加的buff_id与触发参数配置ID一致且身上有该buff"},buffTypeKey:{attr:1,immune:2,god:3,disablePositive:4,noDeath:5,bleed:7,dizzy:8,banRecover:9,silence:10,sneer:13,recover:16,sleep:17,shield:18,tag:20,immuDizzy:21,immuSleep:22,immuBleed:23,shareDmg:24},buffType:{1:"属性变化",2:"免疫减益效果",3:"无敌（伤害为0）",4:"无法获得增益效果",5:"不死（受到致死伤害剩1点血）",7:"流血",8:"眩晕 ",9:"无法回血",10:"沉默（只能使用第1个技能）",13:"嘲讽（所有敌人攻击自己）",16:"回复血量 ",17:"沉睡（被攻击后效果消失）",18:"护盾",20:"标记专用，无实际效果",21:"免疫眩晕控制(类型8)",22:"免疫沉睡控制(类型17)",23:"免疫流血（类型7）",24:"分摊伤害"},skillEftTypeKey:{all:0,arena:1,ground:2,tower:3},skillEftType:{0:"所有地方生效",1:"仅竞技场生效",2:"仅地下城生效",3:"仅试炼场生效"},effectTypeKey:{attr:1,addBuff:2,changeCD:3,reborn:4,clearNegative:5,buffTransfer:6,chgHp:7,dmgFixByBuff:8,balanceAttr:9,clearPositive:11,changeAtkBar:12,useSkillAgain:15,beCrit:16,beAtked:17,immuDmg:18,reboundDmg:19,clearBuff:20,casterAttr:21,casterAttrByTemp:22},effectType:{1:"属性变化",2:"添加buff",3:"改变技能CD",4:"复活",5:"清除减益buff",6:"状态转移",7:"血量变化",8:"根据增减益buff数量修正伤害",9:"均衡属性",11:"清除增益buff",12:"攻击条变化（可正可负）",15:"再次出手",16:"必定被暴击",17:"反击",18:"免疫本次伤害",19:"伤害反弹",20:"清除指定buff",21:"给施法加的属性效果",22:"给施法加的属性效果（当下满足条件的敌人生效）"},skillTypeKey:{passive:0,initiative:1,artifact:2,anger:3},skillType:{0:"被动技能",1:"主动技能",2:"神器技能",3:"怒气技能"},upgradeTypeKey:{up:1,none:2,down:3},upgradeType:{1:"晋级",2:"保级",3:"降级"},signTypeKey:{login:1,vip:2,recharge:3},signType:{1:"登录",2:"vip",3:"充值"},shareAwardTypeKey:{daily:1,total:2},shareAwardType:{1:"每日充值",2:"历史累计"},summonTypeKey:{one:1,ten:2},summonType:{1:"购买一次",2:"购买十次"},buffStatTypeKey:{positive:1,negative:2},buffStatType:{1:"增益",2:"减益"},buffStackTypeKey:{stack:1,cover:2,coexistStack:3,coexistCover:4},buffStackType:{1:"叠加",2:"覆盖",3:"共存(达到上限后叠加)",4:"共存(达到上限后覆盖)"},battleObjTypeKey:{god:1,monster:2},battleObjType:{1:"神灵",2:"怪物"},buffTrigTypeKey:{dead:2,always:3,beAtk:4,atking:5,roundEnd:6,bigRoundBefore:7,atkEqualBuffCaster:8,buffDefAndCasterTriggerSkill:9,buffAllCasterTriggerEff:10},buffTrigType:{2:"死亡",3:"必定触发",4:"被攻击时触发",5:"攻击时触发",6:"回合结束时触发",7:"大回合开始前触发",8:"攻击目标与buff施法者一致时触发",9:"非自然移除触发，且由buff施法者实现技能（被清的buff不计算）",10:"必定触发且由buff施法者实现效果"},skillPriorityTypeKey:{reborn:1,rebornAndGuard:2,recover:3,shield:4,normal:9999},skillPriorityType:{1:"复活类技能",2:"复活+守护类技能",3:"回血类技能",4:"护盾类技能",9999:"普通技能"},flyTextTypeKey:{hpChange:1,crit:2,resist:3,rampage:4,passive:5,reborn:6,strikeBack:7,banRecover:8,shield:9,god:10,immune:11,share:12,reboundDmg:13,angerDown:14},flyTextType:{1:"血量变化",2:"暴击",3:"抵抗",4:"追加回合",5:"被动技能",6:"复活",7:"反击",8:"无法回血",9:"护盾",10:"无敌",11:"免疫",12:"分摊",13:"反弹",14:"减怒"},battleOpTypeKey:{nextRound:1,objInit:2,atkBar:3,useSkill:4,hpChange:5,flyText:6,addBuff:7,rmBuff:8,buffChange:9,atftInit:10,angerChange:11,atftUseSkill:12,atkSpdChange:13,atkBarMax:14,trigPasvSkill:15,hpMaxChange:16,roleAngerChange:17},battleOpType:{1:"下一个回合",2:"对象初始化",3:"攻击条变化",4:"使用技能",5:"血量变化",6:"飘字",7:"添加buff",8:"移除buff",9:"buff变化",10:"神器初始化",11:"怒气变化",12:"神器使用技能",13:"攻速变化",14:"通知攻击条上限",15:"触发被动技能",16:"血上限变化",17:"角色怒气变化"},battleTypeKey:{common:1,guildBoss:2,worldBoss:3,arena:4,honour:5,match:6,godDomain:7,ground:8,tower:9,groupCopy:10},battleType:{1:"通用",2:"公会boss",3:"世界boss",4:"竞技场",5:"荣耀之战",6:"匹配赛",7:"激战神域",8:"地下城",9:"试练塔",10:"组队副本"},uiTypeKey:{album:1},uiType:{1:"图鉴"},groupJobTypeKey:{captain:1,member:2},groupJobType:{1:"队长",2:"成员"},groupStateTypeKey:{no:0,yes:1},groupStateType:{0:"未准备",1:"已准备"},groupJoinTypeKey:{yes:0,no:1},groupJoinType:{0:"允许加入",1:"不允许加入"},groupInviteTypeKey:{yes:0,no:1},groupInviteType:{0:"接受邀请",1:"不接受邀请"},equipUpgradeTypeKey:{one:1,five:2},equipUpgradeType:{1:"升一级",2:"升五级"},guessTypeKey:{win:1,loss:2,draw:3},guessType:{1:"赢",2:"输",3:"平"},counterLimitTypeKey:{checkOpenSvrGroupBuyAward:1,fastFrightFreeNum:2,friendPoint:3},counterLimitType:{1:"检测开服团购奖励",2:"快速战斗免费次数",3:"友情点"},addAttrTypeKey:{fixedVal:0,percentVal:1,totalPerVal:2},addAttrType:{0:"固定值",1:"基础属性百分比",2:"总属性百分比"},firstTypeKey:{godEmploy:1},firstType:{1:"首次十连抽"},warriorTypeKey:{getLiveness:1,costSoulStone:2,costGold:3,killWorldBoss:4,getGod:5,matchWin:6,robTradeWin:7,robMineWin:8,riskType:9,risk:10,expeditionBox:11,getTreasure:12,getEquip:13,getGamstone:14,costDiamond:15,honour:16},warriorType:{1:"累计获得XX点活跃度",2:"消耗XX魂石",3:"消耗XX金币",4:"累计参与击杀X个世界BOSS",5:"获得X个Y星英雄",6:"匹配赛胜利X场",7:"商队护送掠夺胜利X次",8:"神秘岛屿掠夺胜利X次",9:"探险中参与X次Y玩法",10:"探险X次",11:"失落遗迹打开XX个宝箱",12:"获得X个Y品质宝物",13:"获得X件Y品质装备",14:"获得X个Y级宝石",15:"消耗XX钻石",16:"荣耀之战晋级跨服XX名次"},applyOptTypeKey:{yes:0,no:1},applyOptType:{0:"同意申请",1:"拒绝申请"},runTypeKey:{android:1,ios:2,wxgame:3},runType:{1:"安卓",2:"IOS",3:"小程序"}};var iface,Protocol=function(){function t(){}return t.gate_gate_queryEntry={type:"null",key:"gate_gate_queryEntry",name:"gate.gateHandler.queryEntry",args:{uid:"_0"},returns:"QueryEntryData"},t.game_enter_entry={type:"null",key:"game_enter_entry",name:"game.enterHandler.entry",args:{token:"_0",sid:"_1"},returns:"EntryData"},t.game_enter_enterGame={type:"null",key:"game_enter_enterGame",name:"game.enterHandler.enterGame",returns:"EnterGameData"},t.game_common_changePlayerData={type:"null",key:"game_common_changePlayerData",name:"game.commonHandler.changePlayerData",args:{name:"_0",sex:"_1"},returns:"CommonOperateData"},t.game_common_changePlayerName={type:"null",key:"game_common_changePlayerName",name:"game.commonHandler.changePlayerName",args:{newName:"_0"},returns:"CommonOperateData"},t.game_common_getCrossDayInfo={type:"null",key:"game_common_getCrossDayInfo",name:"game.commonHandler.getCrossDayInfo",returns:"CommonOperateData"},t.game_common_ajustLineup={type:"null",key:"game_common_ajustLineup",name:"game.commonHandler.ajustLineup",args:{type:"_0",godIds:"_1"},returns:"CommonOperateData"},t.game_common_quickQuitLineup={type:"null",key:"game_common_quickQuitLineup",name:"game.commonHandler.quickQuitLineup",args:{godId:"_0"},returns:"CommonOperateData"},t.game_common_wish={type:"wish",key:"game_common_wish",name:"game.commonHandler.wish",args:{count:"_0"},returns:"CommonOperateData"},t.game_common_redPoint={type:"null",key:"game_common_redPoint",name:"game.commonHandler.redPoint",returns:"CommonOperateData"},t.game_common_buyGuildCopyBattleCnt={type:"guild",key:"game_common_buyGuildCopyBattleCnt",name:"game.commonHandler.buyGuildCopyBattleCnt",args:{count:"_0"},returns:"CommonOperateData"},t.game_common_buyDailyCopyBattleCnt={type:"dailyCopy",key:"game_common_buyDailyCopyBattleCnt",name:"game.commonHandler.buyDailyCopyBattleCnt",args:{type:"_0",count:"_1"},returns:"CommonOperateData"},t.game_common_buyWorldBossBattleCnt={type:"worldBoss",key:"game_common_buyWorldBossBattleCnt",name:"game.commonHandler.buyWorldBossBattleCnt",args:{count:"_0"},returns:"CommonOperateData"},t.game_common_buyMineRobCnt={type:"mine",key:"game_common_buyMineRobCnt",name:"game.commonHandler.buyMineRobCnt",args:{count:"_0"},returns:"CommonOperateData"},t.game_common_getSysOpenChest={type:"null",key:"game_common_getSysOpenChest",name:"game.commonHandler.getSysOpenChest",args:{sysOpenId:"_0"},returns:"CommonOperateData"},t.game_common_openUI={type:"null",key:"game_common_openUI",name:"game.commonHandler.openUI",args:{type:"_0"},returns:"CommonOperateData"},t.game_common_buyGodDomainRewardNum={type:"godDomain",key:"game_common_buyGodDomainRewardNum",name:"game.commonHandler.buyGodDomainRewardNum",args:{count:"_0"},returns:"CommonOperateData"},t.game_common_setPlayerHead={type:"null",key:"game_common_setPlayerHead",name:"game.commonHandler.setPlayerHead",args:{headId:"_0"},returns:"CommonOperateData"},t.game_common_updateCommonData={type:"null",key:"game_common_updateCommonData",name:"game.commonHandler.updateCommonData",returns:"CommonOperateData"},t.game_common_ajustLineupEquip={type:"equip",key:"game_common_ajustLineupEquip",name:"game.commonHandler.ajustLineupEquip",args:{type:"_0",srcId:"_1",dstId:"_2"},returns:"CommonOperateData"},t.game_common_setPlayerHeadFrame={type:"null",key:"game_common_setPlayerHeadFrame",name:"game.commonHandler.setPlayerHeadFrame",args:{id:"_0"},returns:"CommonOperateData"},t.game_common_setPlayerShow={type:"null",key:"game_common_setPlayerShow",name:"game.commonHandler.setPlayerShow",args:{godId:"_0",skinId:"_1"},returns:"CommonOperateData"},t.game_item_useItem={type:"bag",key:"game_item_useItem",name:"game.itemHandler.useItem",args:{itemId:"_0",count:"_1",optionId:"_2"},returns:"ItemOperateData"},t.game_item_exchange={type:"null",key:"game_item_exchange",name:"game.itemHandler.exchange",args:{exchangeId:"_0",num:"_1"},returns:"ItemOperateData"},t.game_item_useTimeItem={type:"bag",key:"game_item_useTimeItem",name:"game.itemHandler.useTimeItem",args:{timeKey:"_0"},returns:"ItemOperateData"},t.game_equip_wear={type:"equip",key:"game_equip_wear",name:"game.equipHandler.wear",args:{godId:"_0",equipKey:"_1"},returns:"EquipOperateData"},t.game_equip_quickWear={type:"equip",key:"game_equip_quickWear",name:"game.equipHandler.quickWear",args:{godId:"_0",equipKeys:"_1"},returns:"EquipOperateData"},t.game_equip_discharge={type:"equip",key:"game_equip_discharge",name:"game.equipHandler.discharge",args:{equipKey:"_0"},returns:"EquipOperateData"},t.game_equip_quickDischarge={type:"equip",key:"game_equip_quickDischarge",name:"game.equipHandler.quickDischarge",args:{godId:"_0"},returns:"EquipOperateData"},t.game_equip_strength={type:"equipStrength",key:"game_equip_strength",name:"game.equipHandler.strength",args:{equipKey:"_0",type:"_1"},returns:"EquipOperateData"},t.game_equip_quickStth={type:"equipStrength",key:"game_equip_quickStth",name:"game.equipHandler.quickStth",args:{godId:"_0",type:"_1"},returns:"EquipOperateData"},t.game_equip_refine={type:"equipRefine",key:"game_equip_refine",name:"game.equipHandler.refine",args:{equipKey:"_0",refNum:"_1"},returns:"EquipOperateData"},t.game_equip_quickRefine={type:"equipRefine",key:"game_equip_quickRefine",name:"game.equipHandler.quickRefine",args:{godId:"_0",type:"_1"},returns:"EquipOperateData"},t.game_equip_recycle={type:"equip",key:"game_equip_recycle",name:"game.equipHandler.recycle",args:{equipKeys:"_0"},returns:"EquipOperateData"},t.game_god_employ={type:"employ",key:"game_god_employ",name:"game.godHandler.employ",args:{godEmployType:"_0"},returns:"GodOperateData"},t.game_god_upgrade={type:"god",key:"game_god_upgrade",name:"game.godHandler.upgrade",args:{godId:"_0",count:"_1"},returns:"GodOperateData"},t.game_god_raiseDegree={type:"raiseDegree",key:"game_god_raiseDegree",name:"game.godHandler.raiseDegree",args:{godId:"_0"},returns:"GodOperateData"},t.game_god_awaken={type:"awaken",key:"game_god_awaken",name:"game.godHandler.awaken",args:{godId:"_0",materialArrs:"_1"},returns:"GodOperateData"},t.game_god_raiseStar={type:"raiseStar",key:"game_god_raiseStar",name:"game.godHandler.raiseStar",args:{godId:"_0",materialArrs:"_1"},returns:"GodOperateData"},t.game_god_resolve={type:"resolve",key:"game_god_resolve",name:"game.godHandler.resolve",args:{rsvIds:"_0"},returns:"GodOperateData"},t.game_god_getAlbumAward={type:"album",key:"game_god_getAlbumAward",name:"game.godHandler.getAlbumAward",args:{id:"_0"},returns:"GodOperateData"},t.game_god_publishComment={type:"god",key:"game_god_publishComment",name:"game.godHandler.publishComment",args:{templateId:"_0",isOpen:"_1",content:"_2"},returns:"GodOperateData"},t.game_god_getComment={type:"god",key:"game_god_getComment",name:"game.godHandler.getComment",args:{templateId:"_0"},returns:"GodOperateData"},t.game_god_likeComment={type:"god",key:"game_god_likeComment",name:"game.godHandler.likeComment",args:{templateId:"_0",value:"_1"},returns:"GodOperateData"},t.game_god_observeGod={type:"god",key:"game_god_observeGod",name:"game.godHandler.observeGod",args:{playerId:"_0",templateId:"_1"},returns:"GodOperateData"},t.game_god_doorEmploy={type:"door",key:"game_god_doorEmploy",name:"game.godHandler.doorEmploy",args:{race:"_0"},returns:"GodOperateData"},t.game_god_doorConvert={type:"door",key:"game_god_doorConvert",name:"game.godHandler.doorConvert",args:{godId:"_0"},returns:"GodOperateData"},t.game_god_doorConvertSave={type:"door",key:"game_god_doorConvertSave",name:"game.godHandler.doorConvertSave",args:{godId:"_0"},returns:"GodOperateData"},t.game_god_fuseSoul={type:"fuseSoul",key:"game_god_fuseSoul",name:"game.godHandler.fuseSoul",args:{godId:"_0",attrType:"_1",numType:"_2"},returns:"GodOperateData"},t.game_god_break={type:"fuseSoul",key:"game_god_break",name:"game.godHandler.break",args:{godId:"_0"},returns:"GodOperateData"},t.game_god_queryResolve={type:"resolve",key:"game_god_queryResolve",name:"game.godHandler.queryResolve",args:{rsvIds:"_0"},returns:"GodOperateData"},t.game_god_godFate={type:"god",key:"game_god_godFate",name:"game.godHandler.godFate",args:{id:"_0"},returns:"GodOperateData"},t.game_god_setGodSkinId={type:"god",key:"game_god_setGodSkinId",name:"game.godHandler.setGodSkinId",args:{godId:"_0",skinId:"_1"},returns:"GodOperateData"},t.game_god_activeGodSkin={type:"god",key:"game_god_activeGodSkin",name:"game.godHandler.activeGodSkin",args:{godId:"_0",skinId:"_1"},returns:"GodOperateData"},t.game_copy_getMainAfkAward={type:"null",key:"game_copy_getMainAfkAward",name:"game.copyHandler.getMainAfkAward",returns:"CopyOperateData"},t.game_copy_quickMainBattle={type:"quickBattle",key:"game_copy_quickMainBattle",name:"game.copyHandler.quickMainBattle",returns:"CopyOperateData"},t.game_copy_settleRuneCopy={type:"runeCopy",key:"game_copy_settleRuneCopy",name:"game.copyHandler.settleRuneCopy",args:{copyId:"_0"},returns:"CopyOperateData"},t.game_copy_settleGroundCopy={type:"background",key:"game_copy_settleGroundCopy",name:"game.copyHandler.settleGroundCopy",args:{copyId:"_0",isWin:"_1"},returns:"CopyOperateData"},t.game_copy_settleTowerCopy={type:"tower",key:"game_copy_settleTowerCopy",name:"game.copyHandler.settleTowerCopy",args:{copyId:"_0",isWin:"_1"},returns:"CopyOperateData"},t.game_copy_getTowerAward={type:"tower",key:"game_copy_getTowerAward",name:"game.copyHandler.getTowerAward",args:{copyId:"_0"},returns:"CopyOperateData"},t.game_copy_dailyCopyBattle={type:"dailyCopy",key:"game_copy_dailyCopyBattle",name:"game.copyHandler.dailyCopyBattle",args:{copyId:"_0",isWin:"_1"},returns:"CopyOperateData"},t.game_copy_dailyCopySweep={type:"dailyCopy",key:"game_copy_dailyCopySweep",name:"game.copyHandler.dailyCopySweep",args:{copyId:"_0",num:"_1"},returns:"CopyOperateData"},t.game_copy_copyUnlock={type:"null",key:"game_copy_copyUnlock",name:"game.copyHandler.copyUnlock",args:{id:"_0"},returns:"CopyOperateData"},t.game_copy_enterNextCopy={type:"null",key:"game_copy_enterNextCopy",name:"game.copyHandler.enterNextCopy",returns:"CopyOperateData"},t.game_copy_getMapBoxAward={type:"null",key:"game_copy_getMapBoxAward",name:"game.copyHandler.getMapBoxAward",args:{id:"_0"},returns:"CopyOperateData"},t.game_copy_clgCopy={type:"null",key:"game_copy_clgCopy",name:"game.copyHandler.clgCopy",args:{copyId:"_0"},returns:"CopyOperateData"},t.game_task_getTaskAward={type:"null",key:"game_task_getTaskAward",name:"game.taskHandler.getTaskAward",args:{taskId:"_0"},returns:"TaskOperateData"},t.game_task_getDailyAward={type:"null",key:"game_task_getDailyAward",name:"game.taskHandler.getDailyAward",args:{dailyId:"_0"},returns:"TaskOperateData"},t.game_task_getLivenessChest={type:"null",key:"game_task_getLivenessChest",name:"game.taskHandler.getLivenessChest",args:{chestId:"_0"},returns:"TaskOperateData"},t.game_task_getAdvanceReward={type:"null",key:"game_task_getAdvanceReward",name:"game.taskHandler.getAdvanceReward",args:{id:"_0"},returns:"TaskOperateData"},t.game_task_getWarriorWeekReward={type:"warrior",key:"game_task_getWarriorWeekReward",name:"game.taskHandler.getWarriorWeekReward",args:{id:"_0"},returns:"TaskOperateData"},t.game_task_getWarriorMonthReward={type:"warrior",key:"game_task_getWarriorMonthReward",name:"game.taskHandler.getWarriorMonthReward",args:{id:"_0"},returns:"TaskOperateData"},t.game_task_getWarriorLevelAward={type:"warrior",key:"game_task_getWarriorLevelAward",name:"game.taskHandler.getWarriorLevelAward",args:{id:"_0"},returns:"TaskOperateData"},t.game_task_getWarriorAdvanceAward={type:"warrior",key:"game_task_getWarriorAdvanceAward",name:"game.taskHandler.getWarriorAdvanceAward",args:{id:"_0"},returns:"TaskOperateData"},t.game_task_buyWarriorLevel={type:"warrior",key:"game_task_buyWarriorLevel",name:"game.taskHandler.buyWarriorLevel",args:{level:"_0"},returns:"TaskOperateData"},t.game_task_getWarriorAdvanceWeekAward={type:"warrior",key:"game_task_getWarriorAdvanceWeekAward",name:"game.taskHandler.getWarriorAdvanceWeekAward",returns:"TaskOperateData"},t.game_mail_mailList={type:"mail",key:"game_mail_mailList",name:"game.mailHandler.mailList",returns:"MailOperateData"},t.game_mail_mailUpdateState={type:"mail",key:"game_mail_mailUpdateState",name:"game.mailHandler.mailUpdateState",args:{id:"_0"},returns:"MailOperateData"},t.game_mail_mailGet={type:"mail",key:"game_mail_mailGet",name:"game.mailHandler.mailGet",args:{id:"_0"},returns:"MailOperateData"},t.game_mail_mailDelete={type:"mail",key:"game_mail_mailDelete",name:"game.mailHandler.mailDelete",args:{id:"_0"},returns:"MailOperateData"},t.game_arena_buyBattleCnt={type:"arena",key:"game_arena_buyBattleCnt",name:"game.arenaHandler.buyBattleCnt",args:{count:"_0"},returns:"ArenaOperateData"},t.game_arena_clearArenaCd={type:"arena",key:"game_arena_clearArenaCd",name:"game.arenaHandler.clearArenaCd",returns:"ArenaOperateData"},t.game_arena_battleStart={type:"arena",key:"game_arena_battleStart",name:"game.arenaHandler.battleStart",args:{targetRank:"_0",targetId:"_1",selfRank:"_2"},returns:"ArenaOperateData"},t.game_arena_turnOverCard={type:"arena",key:"game_arena_turnOverCard",name:"game.arenaHandler.turnOverCard",args:{idx:"_0"},returns:"ArenaOperateData"},t.game_arena_buyCardItems={type:"arena",key:"game_arena_buyCardItems",name:"game.arenaHandler.buyCardItems",args:{idx:"_0"},returns:"ArenaOperateData"},t.game_arena_arenaSweep={type:"arena",key:"game_arena_arenaSweep",name:"game.arenaHandler.arenaSweep",args:{targetRank:"_0",targetId:"_1",selfRank:"_2"},returns:"ArenaOperateData"},t.center_arena_refreshClgList={type:"arena",key:"center_arena_refreshClgList",name:"center.arenaHandler.refreshClgList",returns:"ArenaOperateData"},t.center_arena_observeArenaPlayer={type:"arena",key:"center_arena_observeArenaPlayer",name:"center.arenaHandler.observeArenaPlayer",args:{obPlayerId:"_0"},returns:"ArenaOperateData"},t.center_arena_getBattleRecords={type:"arena",key:"center_arena_getBattleRecords",name:"center.arenaHandler.getBattleRecords",returns:"ArenaOperateData"},t.center_arena_getBattleReport={type:"arena",key:"center_arena_getBattleReport",name:"center.arenaHandler.getBattleReport",args:{idx:"_0"},returns:"ArenaOperateData"},t.center_arena_getArenaRankList={type:"rank",key:"center_arena_getArenaRankList",name:"center.arenaHandler.getArenaRankList",returns:"ArenaOperateData"},t.friend_friend_delete={type:"friend",key:"friend_friend_delete",name:"friend.friendHandler.delete",args:{playerId:"_0"},returns:"FriendOperateData"},t.friend_friend_give={type:"friend",key:"friend_friend_give",name:"friend.friendHandler.give",args:{playerId:"_0"},returns:"PointOperateData"},t.friend_friend_recommend={type:"friend",key:"friend_friend_recommend",name:"friend.friendHandler.recommend",returns:"FriendOperateData"},t.friend_friend_find={type:"friend",key:"friend_friend_find",name:"friend.friendHandler.find",args:{name:"_0"},returns:"FriendOperateData"},t.friend_friend_apply={type:"friend",key:"friend_friend_apply",name:"friend.friendHandler.apply",args:{playerId:"_0"},returns:"FriendOperateData"},t.friend_friend_apply_opt={type:"friend",key:"friend_friend_apply_opt",name:"friend.friendHandler.apply_opt",args:{playerId:"_0",opt_type:"_1"},returns:"FriendOperateData"},t.friend_friend_list={type:"friend",key:"friend_friend_list",name:"friend.friendHandler.list",returns:"FriendOperateData"},t.friend_friend_apply_list={type:"friend",key:"friend_friend_apply_list",name:"friend.friendHandler.apply_list",returns:"FriendOperateData"},t.friend_friend_pointGet={type:"friend",key:"friend_friend_pointGet",name:"friend.friendHandler.pointGet",args:{playerId:"_0"},returns:"PointOperateData"},t.friend_friend_pullBlack={type:"friend",key:"friend_friend_pullBlack",name:"friend.friendHandler.pullBlack",args:{playerId:"_0"},returns:"FriendOperateData"},t.friend_friend_pullWhite={type:"friend",key:"friend_friend_pullWhite",name:"friend.friendHandler.pullWhite",args:{playerId:"_0"},returns:"FriendOperateData"},t.friend_friend_oneKeyApply={type:"friend",key:"friend_friend_oneKeyApply",name:"friend.friendHandler.oneKeyApply",args:{playerIds:"_0"},returns:"FriendOperateData"},t.game_market_list={type:"market",key:"game_market_list",name:"game.marketHandler.list",returns:"MarketOperateData"},t.game_market_refresh={type:"market",key:"game_market_refresh",name:"game.marketHandler.refresh",returns:"MarketOperateData"},t.game_market_buy={type:"market",key:"game_market_buy",name:"game.marketHandler.buy",args:{id:"_0"},returns:"MarketOperateData"},t.game_shop_list={type:"shop",key:"game_shop_list",name:"game.shopHandler.list",args:{type:"_0"},returns:"ShopOperateData"},t.game_shop_buy={type:"shop",key:"game_shop_buy",name:"game.shopHandler.buy",args:{id:"_0",num:"_1"},returns:"ShopOperateData"},t.game_shop_specialItemBuy={type:"shop",key:"game_shop_specialItemBuy",name:"game.shopHandler.specialItemBuy",args:{id:"_0"},returns:"ShopOperateData"},t.game_shop_goldBuy={type:"shop",key:"game_shop_goldBuy",name:"game.shopHandler.goldBuy",returns:"ShopOperateData"},t.guild_guild_create={type:"guild",key:"guild_guild_create",name:"guild.guildHandler.create",args:{name:"_0",level:"_1",auto:"_2",head:"_3"},returns:"GuildOperateData"},t.guild_guild_apply={type:"guild",key:"guild_guild_apply",name:"guild.guildHandler.apply",args:{guildId:"_0"},returns:"GuildOperateData"},t.guild_guild_apply_cancel={type:"guild",key:"guild_guild_apply_cancel",name:"guild.guildHandler.apply_cancel",args:{guildId:"_0"},returns:"GuildOperateData"},t.guild_guild_apply_opt={type:"guild",key:"guild_guild_apply_opt",name:"guild.guildHandler.apply_opt",args:{playerId:"_0",type:"_1"},returns:"GuildOperateData"},t.guild_guild_list={type:"guild",key:"guild_guild_list",name:"guild.guildHandler.list",returns:"GuildOperateData"},t.guild_guild_apply_list={type:"guild",key:"guild_guild_apply_list",name:"guild.guildHandler.apply_list",returns:"GuildOperateData"},t.guild_guild_member_list={type:"guild",key:"guild_guild_member_list",name:"guild.guildHandler.member_list",returns:"GuildOperateData"},t.guild_guild_set={type:"guild",key:"guild_guild_set",name:"guild.guildHandler.set",args:{level:"_0",auto:"_1"},returns:"GuildOperateData"},t.guild_guild_setHead={type:"guild",key:"guild_guild_setHead",name:"guild.guildHandler.setHead",args:{head:"_0"},returns:"GuildOperateData"},t.guild_guild_notice_modify={type:"guild",key:"guild_guild_notice_modify",name:"guild.guildHandler.notice_modify",args:{notice:"_0"},returns:"GuildOperateData"},t.guild_guild_donate={type:"guild",key:"guild_guild_donate",name:"guild.guildHandler.donate",args:{id:"_0"},returns:"GuildOperateData"},t.guild_guild_quit={type:"guild",key:"guild_guild_quit",name:"guild.guildHandler.quit",args:{playerId:"_0"},returns:"GuildOperateData"},t.guild_guild_dissolve={type:"guild",key:"guild_guild_dissolve",name:"guild.guildHandler.dissolve",returns:"GuildOperateData"},t.guild_guild_appoint={type:"guild",key:"guild_guild_appoint",name:"guild.guildHandler.appoint",args:{playerId:"_0",job:"_1"},returns:"GuildOperateData"},t.guild_guild_find={type:"guild",key:"guild_guild_find",name:"guild.guildHandler.find",args:{name:"_0"},returns:"GuildOperateData"},t.guild_guild_info={type:"guild",key:"guild_guild_info",name:"guild.guildHandler.info",returns:"GuildOperateData"},t.guild_guild_levelRankList={type:"rank",key:"guild_guild_levelRankList",name:"guild.guildHandler.levelRankList",returns:"GuildOperateData"},t.guild_guild_copyRankList={type:"guild",key:"guild_guild_copyRankList",name:"guild.guildHandler.copyRankList",returns:"GuildOperateData"},t.guild_guild_getRankTopList={type:"rank",key:"guild_guild_getRankTopList",name:"guild.guildHandler.getRankTopList",returns:"RankOperateData"},t.guild_guild_guildUsurp={type:"rank",key:"guild_guild_guildUsurp",name:"guild.guildHandler.guildUsurp",returns:"RankOperateData"},t.guild_guild_sendGuildRecruitNotice={type:"guild",key:"guild_guild_sendGuildRecruitNotice",name:"guild.guildHandler.sendGuildRecruitNotice",args:{level:"_0",auto:"_1"},returns:"GuildOperateData"},t.chat_chat_send={type:"chat",key:"chat_chat_send",name:"chat.chatHandler.send",args:{channel:"_0",type:"_1",content:"_2",receiveId:"_3"},returns:"ChatOperateData"},t.chat_chat_list={type:"null",key:"chat_chat_list",name:"chat.chatHandler.list",args:{channel:"_0",receiveId:"_1"},returns:"ChatOperateData"},t.game_guide_getGuideAward={type:"null",key:"game_guide_getGuideAward",name:"game.guideHandler.getGuideAward",args:{guideStep:"_0",guideWeakStep:"_1"},returns:"GuideOperateData"},t.game_guide_jumpGuide={type:"null",key:"game_guide_jumpGuide",name:"game.guideHandler.jumpGuide",args:{guideStep:"_0"},returns:"GuideOperateData"},t.game_gm_command={type:"null",key:"game_gm_command",name:"game.gmHandler.command",args:{content:"_0"},returns:"GmOperateData"},t.game_welfare_dailySignIn={type:"welfare",key:"game_welfare_dailySignIn",name:"game.welfareHandler.dailySignIn",returns:"WelfareOperateData"},t.game_welfare_dailySignInSupply={type:"welfare",key:"game_welfare_dailySignInSupply",name:"game.welfareHandler.dailySignInSupply",returns:"WelfareOperateData"},t.game_welfare_totalSignIn={type:"welfare",key:"game_welfare_totalSignIn",name:"game.welfareHandler.totalSignIn",args:{id:"_0"},returns:"WelfareOperateData"},t.game_welfare_loginGiftPack={type:"welfare",key:"game_welfare_loginGiftPack",name:"game.welfareHandler.loginGiftPack",args:{id:"_0"},returns:"WelfareOperateData"},t.game_welfare_levelGiftPack={type:"levelAward",key:"game_welfare_levelGiftPack",name:"game.welfareHandler.levelGiftPack",args:{id:"_0"},returns:"WelfareOperateData"},t.game_welfare_getLevelFundReward={type:"welfare",key:"game_welfare_getLevelFundReward",name:"game.welfareHandler.getLevelFundReward",args:{id:"_0"},returns:"WelfareOperateData"},t.game_welfare_firstRecharge={type:"welfare",key:"game_welfare_firstRecharge",name:"game.welfareHandler.firstRecharge",args:{id:"_0",day:"_1"},returns:"WelfareOperateData"},t.game_welfare_activationCode={type:"welfare",key:"game_welfare_activationCode",name:"game.welfareHandler.activationCode",args:{code:"_0"},returns:"WelfareOperateData"},t.game_welfare_privilegeGiftPack={type:"welfare",key:"game_welfare_privilegeGiftPack",name:"game.welfareHandler.privilegeGiftPack",args:{id:"_0"},returns:"WelfareOperateData"},t.game_welfare_getMonthCardAward={type:"monthCard",key:"game_welfare_getMonthCardAward",name:"game.welfareHandler.getMonthCardAward",returns:"WelfareOperateData"},t.game_welfare_getLifelongCardAward={type:"welfare",key:"game_welfare_getLifelongCardAward",name:"game.welfareHandler.getLifelongCardAward",returns:"WelfareOperateData"},t.game_welfare_everyDaySignIn={type:"welfare",key:"game_welfare_everyDaySignIn",name:"game.welfareHandler.everyDaySignIn",args:{id:"_0",type:"_1"},returns:"WelfareOperateData"},t.game_welfare_getAutonymAward={type:"realNameAuth",key:"game_welfare_getAutonymAward",name:"game.welfareHandler.getAutonymAward",returns:"WelfareOperateData"},t.game_welfare_getOnlineAward={type:"onlineAward",key:"game_welfare_getOnlineAward",name:"game.welfareHandler.getOnlineAward",args:{id:"_0"},returns:"WelfareOperateData"},t.game_welfare_setMobileNumber={type:"welfare",key:"game_welfare_setMobileNumber",name:"game.welfareHandler.setMobileNumber",args:{number:"_0"},returns:"WelfareOperateData"},t.game_welfare_getBindMobileAward={type:"welfare",key:"game_welfare_getBindMobileAward",name:"game.welfareHandler.getBindMobileAward",returns:"WelfareOperateData"},t.game_welfare_getDownloadApkAward={type:"microClient",key:"game_welfare_getDownloadApkAward",name:"game.welfareHandler.getDownloadApkAward",returns:"WelfareOperateData"},t.game_welfare_getSuperVipAward={type:"superVip",key:"game_welfare_getSuperVipAward",name:"game.welfareHandler.getSuperVipAward",returns:"WelfareOperateData"},t.game_welfare_updateRealName={type:"welfare",key:"game_welfare_updateRealName",name:"game.welfareHandler.updateRealName",args:{fcm:"_0",shiming:"_1"},returns:"WelfareOperateData"},t.game_welfare_getWeekFundAward={type:"weekFund",key:"game_welfare_getWeekFundAward",name:"game.welfareHandler.getWeekFundAward",args:{id:"_0"},returns:"WelfareOperateData"},t.game_welfare_getDailyWelfare={type:"welfare",key:"game_welfare_getDailyWelfare",name:"game.welfareHandler.getDailyWelfare",returns:"WelfareOperateData"},t.game_welfare_getRechargeRebate={type:"rechargeRebate",key:"game_welfare_getRechargeRebate",name:"game.welfareHandler.getRechargeRebate",returns:"WelfareOperateData"},t.guild_guildCopy_copyInfo={type:"guildCopy",key:"guild_guildCopy_copyInfo",name:"guild.guildCopyHandler.copyInfo",args:{id:"_0"},returns:"GuildCopyOperateData"},t.guild_guildCopy_rewardInfo={type:"guildCopy",key:"guild_guildCopy_rewardInfo",name:"guild.guildCopyHandler.rewardInfo",returns:"GuildCopyOperateData"},t.guild_guildCopy_copyBattleStart={type:"guildCopy",key:"guild_guildCopy_copyBattleStart",name:"guild.guildCopyHandler.copyBattleStart",args:{id:"_0"},returns:"GuildCopyOperateData"},t.guild_guildCopy_copyBattleEnd={type:"guildCopy",key:"guild_guildCopy_copyBattleEnd",name:"guild.guildCopyHandler.copyBattleEnd",args:{id:"_0",damageInfo:"_1"},returns:"GuildCopyOperateData"},t.game_activity_getActivityList={type:"activity",key:"game_activity_getActivityList",name:"game.activityHandler.getActivityList",returns:"ActivityOperateData"},t.game_activity_getActivityInfo={type:"activity",key:"game_activity_getActivityInfo",name:"game.activityHandler.getActivityInfo",args:{id:"_0"},returns:"ActivityOperateData"},t.game_activity_getActivityReward={type:"activity",key:"game_activity_getActivityReward",name:"game.activityHandler.getActivityReward",args:{id:"_0",num:"_1"},returns:"ActivityOperateData"},t.game_activity_updateActivityCondCount={type:"activity",key:"game_activity_updateActivityCondCount",name:"game.activityHandler.updateActivityCondCount",args:{id:"_0"},returns:"ActivityOperateData"},t.game_activity_getSevenDayReward={type:"null",key:"game_activity_getSevenDayReward",name:"game.activityHandler.getSevenDayReward",args:{id:"_0",num:"_1"},returns:"ActivityOperateData"},t.game_activity_getSevenDayExtraReward={type:"null",key:"game_activity_getSevenDayExtraReward",name:"game.activityHandler.getSevenDayExtraReward",args:{id:"_0"},returns:"ActivityOperateData"},t.game_activity_updateSevenDayCondCount={type:"null",key:"game_activity_updateSevenDayCondCount",name:"game.activityHandler.updateSevenDayCondCount",returns:"ActivityOperateData"},t.game_activity_shareSucc={type:"share",key:"game_activity_shareSucc",name:"game.activityHandler.shareSucc",returns:"ActivityOperateData"},t.game_activity_getFirstShareAward={type:"share",key:"game_activity_getFirstShareAward",name:"game.activityHandler.getFirstShareAward",returns:"ActivityOperateData"},t.game_activity_getShareAward={type:"share",key:"game_activity_getShareAward",name:"game.activityHandler.getShareAward",args:{id:"_0"},returns:"ActivityOperateData"},t.game_activity_summonBuy={type:"timeLimitBuy",key:"game_activity_summonBuy",name:"game.activityHandler.summonBuy",args:{type:"_0"},returns:"ActivityOperateData"},t.game_activity_getSummonChests={type:"timeLimitBuy",key:"game_activity_getSummonChests",name:"game.activityHandler.getSummonChests",args:{id:"_0"},returns:"ActivityOperateData"},t.game_activity_getGroupBuyInfo={type:"timeLimitBuy",key:"game_activity_getGroupBuyInfo",name:"game.activityHandler.getGroupBuyInfo",returns:"ActivityOperateData"},t.game_activity_groupBuy={type:"timeLimitBuy",key:"game_activity_groupBuy",name:"game.activityHandler.groupBuy",args:{tpltId:"_0"},returns:"ActivityOperateData"},t.game_activity_getRechargePlayerNum={type:"null",key:"game_activity_getRechargePlayerNum",name:"game.activityHandler.getRechargePlayerNum",returns:"ActivityOperateData"},t.game_activity_getOpenSvrGroupBuyAward={type:"null",key:"game_activity_getOpenSvrGroupBuyAward",name:"game.activityHandler.getOpenSvrGroupBuyAward",args:{id:"_0"},returns:"ActivityOperateData"},t.center_activity_getSummonRankList={type:"activity",key:"center_activity_getSummonRankList",name:"center.activityHandler.getSummonRankList",returns:"ActivityOperateData"},t.game_guild_getCopyReward={type:"guild",key:"game_guild_getCopyReward",name:"game.guildHandler.getCopyReward",args:{id:"_0"},returns:"GuildCopyOperateData"},t.game_guild_upgradeSkill={type:"guild",key:"game_guild_upgradeSkill",name:"game.guildHandler.upgradeSkill",args:{id:"_0"},returns:"GuildSkillOperateData"},t.game_guild_resetSkill={type:"guild",key:"game_guild_resetSkill",name:"game.guildHandler.resetSkill",returns:"GuildSkillOperateData"},t.game_guild_getGuildWarBoxReward={type:"guild",key:"game_guild_getGuildWarBoxReward",name:"game.guildHandler.getGuildWarBoxReward",args:{grade:"_0",pos:"_1"},returns:"GuildWarOperateData"},t.game_guild_addGuildHelpNum={type:"guild",key:"game_guild_addGuildHelpNum",name:"game.guildHandler.addGuildHelpNum",args:{id:"_0"},returns:"GuildHelpOperateData"},t.game_guild_sendGuildHelpNotice={type:"guild",key:"game_guild_sendGuildHelpNotice",name:"game.guildHandler.sendGuildHelpNotice",returns:"GuildHelpOperateData"},t.game_recharge_updateRecharge={type:"null",key:"game_recharge_updateRecharge",name:"game.rechargeHandler.updateRecharge",returns:"RechargeOperateData"},t.game_rank_getRankList={type:"rank",key:"game_rank_getRankList",name:"game.rankHandler.getRankList",args:{rankType:"_0"},returns:"RankOperateData"},t.game_rank_worship={type:"rank",key:"game_rank_worship",name:"game.rankHandler.worship",args:{rankType:"_0"},returns:"RankOperateData"},t.game_rank_getWorldRankList={type:"rank",key:"game_rank_getWorldRankList",name:"game.rankHandler.getWorldRankList",args:{rankType:"_0"},returns:"RankOperateData"},t.game_expedition_expeditionGodOperate={type:"expedition",key:"game_expedition_expeditionGodOperate",name:"game.expeditionHandler.expeditionGodOperate",args:{godId:"_0",opType:"_1"},returns:"ExpeditionOperateData"},t.game_expedition_getChallengerInfo={type:"expedition",key:"game_expedition_getChallengerInfo",name:"game.expeditionHandler.getChallengerInfo",returns:"ExpeditionOperateData"},t.game_expedition_expeditionBattleEnd={type:"expedition",key:"game_expedition_expeditionBattleEnd",name:"game.expeditionHandler.expeditionBattleEnd",args:{id:"_0",selfHpInfo:"_1",damageInfo:"_2"},returns:"ExpeditionOperateData"},t.game_expedition_getBoxReward={type:"expedition",key:"game_expedition_getBoxReward",name:"game.expeditionHandler.getBoxReward",args:{id:"_0"},returns:"ExpeditionOperateData"},t.chat_notice_getNoticelist={type:"null",key:"chat_notice_getNoticelist",name:"chat.noticeHandler.getNoticelist",returns:"NoticeOperateData"},t.chat_notice_getNewslist={type:"null",key:"chat_notice_getNewslist",name:"chat.noticeHandler.getNewslist",returns:"NoticeOperateData"},t.center_query_queryPlayer={type:"null",key:"center_query_queryPlayer",name:"center.queryHandler.queryPlayer",args:{playerId:"_0"},returns:"QueryOperateData"},t.center_query_queryWorldPlayer={type:"null",key:"center_query_queryWorldPlayer",name:"center.queryHandler.queryWorldPlayer",args:{playerId:"_0"},returns:"QueryOperateData"},t.center_boss_getWorldBossInfo={type:"worldBoss",key:"center_boss_getWorldBossInfo",name:"center.worldBossHandler.getWorldBossInfo",returns:"WorldBossOperateData"},t.center_boss_worldBossBattleStart={type:"worldBoss",key:"center_boss_worldBossBattleStart",name:"center.worldBossHandler.worldBossBattleStart",args:{id:"_0"},returns:"WorldBossOperateData"},t.center_boss_worldBossBattleEnd={type:"worldBoss",key:"center_boss_worldBossBattleEnd",name:"center.worldBossHandler.worldBossBattleEnd",args:{id:"_0",damage:"_1"},returns:"WorldBossOperateData"},t.center_boss_getRankList={type:"worldBoss",key:"center_boss_getRankList",name:"center.worldBossHandler.getRankList",args:{id:"_0"},returns:"WorldBossOperateData"},t.game_artifact_artifactActivate={type:"artifact",key:"game_artifact_artifactActivate",name:"game.artifactHandler.artifactActivate",args:{id:"_0"},returns:"ArtifactOperateData"},t.game_artifact_artifactStrength={type:"artifact",key:"game_artifact_artifactStrength",name:"game.artifactHandler.artifactStrength",args:{id:"_0"},returns:"ArtifactOperateData"},t.game_artifact_artifactSkillUpgrade={type:"artifact",key:"game_artifact_artifactSkillUpgrade",name:"game.artifactHandler.artifactSkillUpgrade",args:{id:"_0"},returns:"ArtifactOperateData"},t.game_artifact_ajustLineupArtifact={type:"artifact",key:"game_artifact_ajustLineupArtifact",name:"game.artifactHandler.ajustLineupArtifact",args:{type:"_0",id:"_1"},returns:"ArtifactOperateData"},t.game_artifact_baptize={type:"artifactBaptize",key:"game_artifact_baptize",name:"game.artifactHandler.baptize",args:{id:"_0",type:"_1",lockFlag:"_2"},returns:"ArtifactOperateData"},t.game_artifact_baptizeSave={type:"artifactBaptize",key:"game_artifact_baptizeSave",name:"game.artifactHandler.baptizeSave",args:{id:"_0"},returns:"ArtifactOperateData"},t.game_artifact_enchant={type:"artifactEnchant",key:"game_artifact_enchant",name:"game.artifactHandler.enchant",args:{id:"_0"},returns:"ArtifactOperateData"},t.game_escort_getRecordList={type:"escort",key:"game_escort_getRecordList",name:"game.escortHandler.getRecordList",returns:"EscortOperateData"},t.game_escort_quickEscort={type:"escort",key:"game_escort_quickEscort",name:"game.escortHandler.quickEscort",returns:"EscortOperateData"},t.game_escort_refreshQuality={type:"escort",key:"game_escort_refreshQuality",name:"game.escortHandler.refreshQuality",returns:"EscortOperateData"},t.game_escort_refreshOrange={type:"escort",key:"game_escort_refreshOrange",name:"game.escortHandler.refreshOrange",returns:"EscortOperateData"},t.game_escort_tradeEscort={type:"escort",key:"game_escort_tradeEscort",name:"game.escortHandler.tradeEscort",returns:"EscortOperateData"},t.game_escort_robTradeBattleStart={type:"escort",key:"game_escort_robTradeBattleStart",name:"game.escortHandler.robTradeBattleStart",args:{playerId:"_0"},returns:"EscortOperateData"},t.game_escort_robTradeBattleEnd={type:"escort",key:"game_escort_robTradeBattleEnd",name:"game.escortHandler.robTradeBattleEnd",args:{playerId:"_0",isWin:"_1"},returns:"EscortOperateData"},t.game_escort_receiveAwards={type:"escort",key:"game_escort_receiveAwards",name:"game.escortHandler.receiveAwards",returns:"EscortOperateData"},t.center_escort_getEscortList={type:"escort",key:"center_escort_getEscortList",name:"center.escortHandler.getEscortList",returns:"EscortOperateData"},t.center_escort_getTargetInfo={type:"escort",key:"center_escort_getTargetInfo",name:"center.escortHandler.getTargetInfo",args:{playerId:"_0"},returns:"EscortOperateData"},t.center_escort_getSelfInfo={type:"escort",key:"center_escort_getSelfInfo",name:"center.escortHandler.getSelfInfo",returns:"EscortOperateData"},t.game_mine_mineOccupy={type:"mine",key:"game_mine_mineOccupy",name:"game.mineHandler.mineOccupy",args:{mineIndex:"_0"},returns:"MineOperateData"},t.game_mine_mineOccupyStart={type:"mine",key:"game_mine_mineOccupyStart",name:"game.mineHandler.mineOccupyStart",args:{mineIndex:"_0",playerId:"_1"},returns:"MineOperateData"},t.game_mine_mineOccupyEnd={type:"mine",key:"game_mine_mineOccupyEnd",name:"game.mineHandler.mineOccupyEnd",args:{mineIndex:"_0",isWin:"_1"},returns:"MineOperateData"},t.game_mine_mineRobStart={type:"mine",key:"game_mine_mineRobStart",name:"game.mineHandler.mineRobStart",args:{mineIndex:"_0",playerId:"_1"},returns:"MineOperateData"},t.game_mine_mineRobEnd={type:"mine",key:"game_mine_mineRobEnd",name:"game.mineHandler.mineRobEnd",args:{mineIndex:"_0",isWin:"_1"},returns:"MineOperateData"},t.game_mine_mineRobList={type:"mine",key:"game_mine_mineRobList",name:"game.mineHandler.mineRobList",returns:"MineOperateData"},t.game_mine_mineRecordList={type:"mine",key:"game_mine_mineRecordList",name:"game.mineHandler.mineRecordList",returns:"MineOperateData"},t.game_mine_recordMineUpdateState={type:"mine",key:"game_mine_recordMineUpdateState",name:"game.mineHandler.recordMineUpdateState",args:{id:"_0"},returns:"MineOperateData"},t.game_mine_mineRecordGet={type:"mine",key:"game_mine_mineRecordGet",name:"game.mineHandler.mineRecordGet",args:{id:"_0"},returns:"MineOperateData"},t.center_mine_getMyMineInfo={type:"mine",key:"center_mine_getMyMineInfo",name:"center.mineHandler.getMyMineInfo",returns:"MineOperateData"},t.center_mine_getMineList={type:"mine",key:"center_mine_getMineList",name:"center.mineHandler.getMineList",args:{islandId:"_0"},returns:"MineOperateData"},t.center_mine_getTargetMineInfo={type:"mine",key:"center_mine_getTargetMineInfo",name:"center.mineHandler.getTargetMineInfo",args:{mineIndex:"_0"},returns:"MineOperateData"},t.game_adventure_refresh={type:"adventure",key:"game_adventure_refresh",name:"game.adventureHandler.refresh",returns:"AdventureOperateData"},t.game_adventure_dispatch={type:"adventure",key:"game_adventure_dispatch",name:"game.adventureHandler.dispatch",args:{idx:"_0",godIds:"_1"},returns:"AdventureOperateData"},t.game_adventure_speedUp={type:"adventure",key:"game_adventure_speedUp",name:"game.adventureHandler.speedUp",args:{advtKey:"_0"},returns:"AdventureOperateData"},t.game_adventure_getAward={type:"adventure",key:"game_adventure_getAward",name:"game.adventureHandler.getAward",args:{advtKey:"_0"},returns:"AdventureOperateData"},t.game_forest_settleForest={type:"forest",key:"game_forest_settleForest",name:"game.forestHandler.settleForest",args:{floor:"_0"},returns:"ForestOperateData"},t.game_forest_getChestAward={type:"forest",key:"game_forest_getChestAward",name:"game.forestHandler.getChestAward",args:{floor:"_0"},returns:"ForestOperateData"},t.game_forest_sweepForest={type:"forest",key:"game_forest_sweepForest",name:"game.forestHandler.sweepForest",returns:"ForestOperateData"},t.guild_guildWar_getGuildWarSession={type:"guild",key:"guild_guildWar_getGuildWarSession",name:"guild.guildWarHandler.getGuildWarSession",returns:"GuildWarOperateData"},t.guild_guildWar_guildWarReg={type:"guild",key:"guild_guildWar_guildWarReg",name:"guild.guildWarHandler.guildWarReg",returns:"GuildWarOperateData"},t.guild_guildWar_getGuildWarMatchInfo={type:"guild",key:"guild_guildWar_getGuildWarMatchInfo",name:"guild.guildWarHandler.getGuildWarMatchInfo",returns:"GuildWarOperateData"},t.guild_guildWar_guildWarBattleStart={type:"guild",key:"guild_guildWar_guildWarBattleStart",name:"guild.guildWarHandler.guildWarBattleStart",args:{playerId:"_0"},returns:"GuildWarOperateData"},t.guild_guildWar_guildWarBattleEnd={type:"guild",key:"guild_guildWar_guildWarBattleEnd",name:"guild.guildWarHandler.guildWarBattleEnd",args:{playerId:"_0",hpInfo:"_1"},returns:"GuildWarOperateData"},t.guild_guildWar_getGroupList={type:"guild",key:"guild_guildWar_getGroupList",name:"guild.guildWarHandler.getGroupList",returns:"GuildWarOperateData"},t.guild_guildWar_getGradeList={type:"guild",key:"guild_guildWar_getGradeList",name:"guild.guildWarHandler.getGradeList",returns:"GuildWarOperateData"},t.guild_guildWar_getBoxList={type:"guild",key:"guild_guildWar_getBoxList",name:"guild.guildWarHandler.getBoxList",args:{grade:"_0"},returns:"GuildWarOperateData"},t.guild_guildWar_getMemberRankList={type:"guild",key:"guild_guildWar_getMemberRankList",name:"guild.guildWarHandler.getMemberRankList",returns:"GuildWarOperateData"},t.guild_guildWar_getSessionRankList={type:"guild",key:"guild_guildWar_getSessionRankList",name:"guild.guildWarHandler.getSessionRankList",args:{session:"_0"},returns:"GuildWarOperateData"},t.game_luck_buyluckGod={type:"luckTurnTable",key:"game_luck_buyluckGod",name:"game.luckHandler.buyluckGod",args:{id:"_0",count:"_1"},returns:"LuckOperateData"},t.game_luck_buyluckEquip={type:"luckTurnTable",key:"game_luck_buyluckEquip",name:"game.luckHandler.buyluckEquip",args:{id:"_0",count:"_1"},returns:"LuckOperateData"},t.game_luck_getluckEquipAward={type:"luckTurnTable",key:"game_luck_getluckEquipAward",name:"game.luckHandler.getluckEquipAward",args:{id:"_0"},returns:"LuckOperateData"},t.game_luck_buyluckArt={type:"luckTurnTable",key:"game_luck_buyluckArt",name:"game.luckHandler.buyluckArt",args:{id:"_0",count:"_1"},returns:"LuckOperateData"},t.game_luck_buyluckTreasure={type:"luckTurnTable",key:"game_luck_buyluckTreasure",name:"game.luckHandler.buyluckTreasure",args:{id:"_0",count:"_1"},returns:"LuckOperateData"},t.game_luck_getluckTreasureAward={type:"luckTurnTable",key:"game_luck_getluckTreasureAward",name:"game.luckHandler.getluckTreasureAward",args:{id:"_0"},returns:"LuckOperateData"},t.center_luck_getLuckGodRecord={type:"activity",key:"center_luck_getLuckGodRecord",name:"center.luckHandler.getLuckGodRecord",returns:"LuckOperateData"},t.center_luck_getLuckEquipRecord={type:"activity",key:"center_luck_getLuckEquipRecord",name:"center.luckHandler.getLuckEquipRecord",returns:"LuckOperateData"},t.center_luck_getLuckTreasureRecord={type:"activity",key:"center_luck_getLuckTreasureRecord",name:"center.luckHandler.getLuckTreasureRecord",returns:"LuckOperateData"},t.center_global_getRankList={type:"rank",key:"center_global_getRankList",name:"center.globalHandler.getRankList",args:{id:"_0"},returns:"RankOperateData"},t.game_honour_reg={type:"honour",key:"game_honour_reg",name:"game.honourHandler.reg",returns:"HonourOperateData"},t.game_honour_honourWarBet={type:"honour",key:"game_honour_honourWarBet",name:"game.honourHandler.honourWarBet",args:{recordId:"_0",stage:"_1",playerId:"_2"},returns:"HonourOperateData"},t.center_honour_getHonourWarSession={type:"honour",key:"center_honour_getHonourWarSession",name:"center.honourHandler.getHonourWarSession",returns:"HonourOperateData"},t.center_honour_getHonourWarPlayback={type:"honour",key:"center_honour_getHonourWarPlayback",name:"center.honourHandler.getHonourWarPlayback",args:{recordId:"_0",stage:"_1"},returns:"HonourOperateData"},t.center_honour_getHonourWarMyList={type:"honour",key:"center_honour_getHonourWarMyList",name:"center.honourHandler.getHonourWarMyList",returns:"HonourOperateData"},t.center_honour_getSessionList={type:"honour",key:"center_honour_getSessionList",name:"center.honourHandler.getSessionList",args:{stage:"_0"},returns:"HonourOperateData"},t.center_honour_getLastSessionList={type:"honour",key:"center_honour_getLastSessionList",name:"center.honourHandler.getLastSessionList",args:{stage:"_0"},returns:"HonourOperateData"},t.center_honour_getHonourWarPlayerInfo={type:"honour",key:"center_honour_getHonourWarPlayerInfo",name:"center.honourHandler.getHonourWarPlayerInfo",args:{recordId:"_0",stage:"_1",playerId:"_2"},returns:"HonourOperateData"},t.center_honour_getSessionListInfo={type:"honour",key:"center_honour_getSessionListInfo",name:"center.honourHandler.getSessionListInfo",args:{type:"_0",stage:"_1"},returns:"HonourOperateData"},t.center_honour_getHonourWarInfo={type:"honour",key:"center_honour_getHonourWarInfo",name:"center.honourHandler.getHonourWarInfo",args:{type:"_0",stage:"_1",pos:"_2"},returns:"HonourOperateData"},t.center_honour_getHonourWarPlayerData={type:"honour",key:"center_honour_getHonourWarPlayerData",name:"center.honourHandler.getHonourWarPlayerData",args:{type:"_0",stage:"_1",pos:"_2",playerId:"_3"},returns:"HonourOperateData"},t.game_match_getMatchInfo={type:"match",key:"game_match_getMatchInfo",name:"game.matchHandler.getMatchInfo",returns:"MatchOperateData"},t.game_match_refreshClgList={type:"match",key:"game_match_refreshClgList",name:"game.matchHandler.refreshClgList",returns:"MatchOperateData"},t.game_match_buyBattleCnt={type:"match",key:"game_match_buyBattleCnt",name:"game.matchHandler.buyBattleCnt",args:{count:"_0"},returns:"MatchOperateData"},t.game_match_battleStart={type:"match",key:"game_match_battleStart",name:"game.matchHandler.battleStart",args:{targetIdx:"_0"},returns:"MatchOperateData"},t.game_match_getBattleRecords={type:"match",key:"game_match_getBattleRecords",name:"game.matchHandler.getBattleRecords",returns:"MatchOperateData"},t.game_match_getMatchChest={type:"match",key:"game_match_getMatchChest",name:"game.matchHandler.getMatchChest",args:{chestId:"_0"},returns:"MatchOperateData"},t.center_match_observePlayer={type:"match",key:"center_match_observePlayer",name:"center.matchHandler.observePlayer",args:{obPlayerId:"_0"},returns:"MatchOperateData"},t.center_match_getWorldRankList={type:"rank",key:"center_match_getWorldRankList",name:"center.matchHandler.getWorldRankList",returns:"MatchOperateData"},t.center_match_getLocalRankList={type:"rank",key:"center_match_getLocalRankList",name:"center.matchHandler.getLocalRankList",returns:"MatchOperateData"},t.center_match_getBattleReport={type:"match",key:"center_match_getBattleReport",name:"center.matchHandler.getBattleReport",args:{idx:"_0"},returns:"MatchOperateData"},t.friend_group_groupList={type:"godDomain",key:"friend_group_groupList",name:"friend.groupHandler.groupList",returns:"GroupOperateData"},t.friend_group_getGroupInfo={type:"godDomain",key:"friend_group_getGroupInfo",name:"friend.groupHandler.getGroupInfo",returns:"GroupOperateData"},t.friend_group_groupCreate={type:"godDomain",key:"friend_group_groupCreate",name:"friend.groupHandler.groupCreate",returns:"GroupOperateData"},t.friend_group_groupJoin={type:"godDomain",key:"friend_group_groupJoin",name:"friend.groupHandler.groupJoin",args:{groupId:"_0"},returns:"GroupOperateData"},t.friend_group_groupExit={type:"godDomain",key:"friend_group_groupExit",name:"friend.groupHandler.groupExit",returns:"GroupOperateData"},t.friend_group_setJoin={type:"godDomain",key:"friend_group_setJoin",name:"friend.groupHandler.setJoin",args:{autoJoin:"_0"},returns:"GroupOperateData"},t.friend_group_setPos={type:"godDomain",key:"friend_group_setPos",name:"friend.groupHandler.setPos",args:{src_pos:"_0",dst_pos:"_1"},returns:"GroupOperateData"},t.friend_group_groupAppoint={type:"godDomain",key:"friend_group_groupAppoint",name:"friend.groupHandler.groupAppoint",args:{playerId:"_0"},returns:"GroupOperateData"},t.friend_group_groupKick={type:"godDomain",key:"friend_group_groupKick",name:"friend.groupHandler.groupKick",args:{playerId:"_0"},returns:"GroupOperateData"},t.friend_group_inviteList={type:"godDomain",key:"friend_group_inviteList",name:"friend.groupHandler.inviteList",returns:"GroupOperateData"},t.friend_group_inviteFriend={type:"godDomain",key:"friend_group_inviteFriend",name:"friend.groupHandler.inviteFriend",args:{playerId:"_0"},returns:"GroupOperateData"},t.friend_group_getInviteList={type:"godDomain",key:"friend_group_getInviteList",name:"friend.groupHandler.getInviteList",returns:"GroupOperateData"},t.friend_group_acceptInvite={type:"godDomain",key:"friend_group_acceptInvite",name:"friend.groupHandler.acceptInvite",args:{playerId:"_0"},returns:"GroupOperateData"},t.friend_group_refuseInvite={type:"godDomain",key:"friend_group_refuseInvite",name:"friend.groupHandler.refuseInvite",args:{playerId:"_0"},returns:"GroupOperateData"},t.friend_group_setInvite={type:"godDomain",key:"friend_group_setInvite",name:"friend.groupHandler.setInvite",args:{playerId:"_0",state:"_1"},returns:"GroupOperateData"},t.friend_group_getRefuseInviteList={type:"godDomain",key:"friend_group_getRefuseInviteList",name:"friend.groupHandler.getRefuseInviteList",returns:"GroupOperateData"},t.friend_group_setState={type:"godDomain",key:"friend_group_setState",name:"friend.groupHandler.setState",args:{state:"_0"},returns:"GroupOperateData"},t.friend_group_oneKeyInvite={type:"godDomain",key:"friend_group_oneKeyInvite",name:"friend.groupHandler.oneKeyInvite",returns:"GroupOperateData"},t.friend_group_autoJoin={type:"godDomain",key:"friend_group_autoJoin",name:"friend.groupHandler.autoJoin",returns:"GroupOperateData"},t.friend_group_cancelJoin={type:"godDomain",key:"friend_group_cancelJoin",name:"friend.groupHandler.cancelJoin",returns:"GroupOperateData"},t.friend_group_startBattle={type:"godDomain",key:"friend_group_startBattle",name:"friend.groupHandler.startBattle",returns:"GroupOperateData"},t.friend_group_getBattleInfo={type:"godDomain",key:"friend_group_getBattleInfo",name:"friend.groupHandler.getBattleInfo",args:{regTime:"_0"},returns:"GroupOperateData"},t.friend_group_cancelReg={type:"godDomain",key:"friend_group_cancelReg",name:"friend.groupHandler.cancelReg",args:{regTime:"_0"},returns:"GroupOperateData"},t.friend_group_getRewardAddInfo={type:"godDomain",key:"friend_group_getRewardAddInfo",name:"friend.groupHandler.getRewardAddInfo",returns:"GroupOperateData"},t.center_recharge_getOrderInfo={type:"null",key:"center_recharge_getOrderInfo",name:"center.rechargeHandler.getOrderInfo",args:{goodId:"_0"},returns:"RechargeOperateData"},t.game_risk_rollDice={type:"adventure",key:"game_risk_rollDice",name:"game.riskHandler.rollDice",args:{count:"_0"},returns:"RiskOperateData"},t.game_risk_answer={type:"adventure",key:"game_risk_answer",name:"game.riskHandler.answer",args:{riskKey:"_0",id:"_1"},returns:"RiskOperateData"},t.game_risk_fingerGuess={type:"adventure",key:"game_risk_fingerGuess",name:"game.riskHandler.fingerGuess",args:{riskKey:"_0",id:"_1"},returns:"RiskOperateData"},t.game_risk_sizeGuess={type:"adventure",key:"game_risk_sizeGuess",name:"game.riskHandler.sizeGuess",args:{riskKey:"_0",id:"_1"},returns:"RiskOperateData"},t.game_risk_eyesightGuess={type:"adventure",key:"game_risk_eyesightGuess",name:"game.riskHandler.eyesightGuess",args:{riskKey:"_0",id:"_1"},returns:"RiskOperateData"},t.game_risk_deleteRisk={type:"adventure",key:"game_risk_deleteRisk",name:"game.riskHandler.deleteRisk",args:{riskKey:"_0"},returns:"RiskOperateData"},t.game_treasure_wearTreasure={type:"treasure",key:"game_treasure_wearTreasure",name:"game.treasureHandler.wearTreasure",args:{godId:"_0",treasureKey:"_1"},returns:"TreasureOperateData"},t.game_treasure_dischargeTreasure={type:"treasure",key:"game_treasure_dischargeTreasure",name:"game.treasureHandler.dischargeTreasure",args:{treasureKey:"_0"},returns:"TreasureOperateData"},t.game_treasure_strengthTreasure={type:"treasure",key:"game_treasure_strengthTreasure",name:"game.treasureHandler.strengthTreasure",args:{treasureKey:"_0",materialArrs:"_1",itemIds:"_2"},returns:"TreasureOperateData"},t.game_treasure_riseStarTreasure={type:"treasure",key:"game_treasure_riseStarTreasure",name:"game.treasureHandler.riseStarTreasure",args:{treasureKey:"_0",materialArrs:"_1"},returns:"TreasureOperateData"},t.game_treasure_recastTreasure={type:"treasure",key:"game_treasure_recastTreasure",name:"game.treasureHandler.recastTreasure",args:{treasureKey:"_0"},returns:"TreasureOperateData"},t.game_treasure_recastReturnItems={type:"treasure",key:"game_treasure_recastReturnItems",name:"game.treasureHandler.recastReturnItems",args:{treasureKey:"_0"},returns:"TreasureOperateData"},t.game_gemstone_wearGemstone={type:"gemstone",key:"game_gemstone_wearGemstone",name:"game.gemstoneHandler.wearGemstone",args:{godId:"_0",slot:"_1",gemKey:"_2"},returns:"GemstoneOperateData"},t.game_gemstone_oneKeyWearGemstone={type:"gemstone",key:"game_gemstone_oneKeyWearGemstone",name:"game.gemstoneHandler.oneKeyWearGemstone",args:{godId:"_0",gemKeys:"_1"},returns:"GemstoneOperateData"},t.game_gemstone_dischargeGemstone={type:"gemstone",key:"game_gemstone_dischargeGemstone",name:"game.gemstoneHandler.dischargeGemstone",args:{gemKey:"_0"},returns:"GemstoneOperateData"},t.game_gemstone_oneKeyDischargeGemstone={type:"gemstone",key:"game_gemstone_oneKeyDischargeGemstone",name:"game.gemstoneHandler.oneKeyDischargeGemstone",args:{godId:"_0"},returns:"GemstoneOperateData"},t.game_gemstone_gemstoneCompound={type:"gemstone",key:"game_gemstone_gemstoneCompound",name:"game.gemstoneHandler.gemstoneCompound",args:{id:"_0",num:"_1"},returns:"GemstoneOperateData"},t.game_gemstone_oneKeyGemstoneCompound={type:"gemstone",key:"game_gemstone_oneKeyGemstoneCompound",name:"game.gemstoneHandler.oneKeyGemstoneCompound",args:{level:"_0",type:"_1"},returns:"GemstoneOperateData"},t.game_guildCopy_sweepGuildCopy={type:"guildCopy",key:"game_guildCopy_sweepGuildCopy",name:"game.guildCopyHandler.sweepGuildCopy",args:{id:"_0"},returns:"GuildCopyOperateData"},t.game_api_userQuestion={type:"null",key:"game_api_userQuestion",name:"game.apiHandler.userQuestion",args:{type:"_0",content:"_1"},returns:"ApiOperateData"},t.guild_guildHelp_createGuildHelp={type:"guild",key:"guild_guildHelp_createGuildHelp",name:"guild.guildHelpHandler.createGuildHelp",args:{pos:"_0",type:"_1",notice:"_2"},returns:"GuildHelpOperateData"},t.guild_guildHelp_getMyGuildHelpList={type:"guild",key:"guild_guildHelp_getMyGuildHelpList",name:"guild.guildHelpHandler.getMyGuildHelpList",returns:"GuildHelpOperateData"},t.guild_guildHelp_getGuildHelpList={type:"guild",key:"guild_guildHelp_getGuildHelpList",name:"guild.guildHelpHandler.getGuildHelpList",returns:"GuildHelpOperateData"},t.guild_guildHelp_getGuildHelpNum={type:"guild",key:"guild_guildHelp_getGuildHelpNum",name:"guild.guildHelpHandler.getGuildHelpNum",args:{id:"_0"},returns:"GuildHelpOperateData"},t.guild_guildHelp_getGuildHelpAward={type:"guild",key:"guild_guildHelp_getGuildHelpAward",name:"guild.guildHelpHandler.getGuildHelpAward",returns:"GuildHelpOperateData"},t.friend_friendHelp_createFriendHelp={type:"friend",key:"friend_friendHelp_createFriendHelp",name:"friend.friendHelpHandler.createFriendHelp",args:{godId:"_0"},returns:"FriendHelpOperateData"},t.friend_friendHelp_getMyFriendHelpList={type:"friend",key:"friend_friendHelp_getMyFriendHelpList",name:"friend.friendHelpHandler.getMyFriendHelpList",returns:"FriendHelpOperateData"},t.friend_friendHelp_getFriendHelpList={type:"friend",key:"friend_friendHelp_getFriendHelpList",name:"friend.friendHelpHandler.getFriendHelpList",returns:"FriendHelpOperateData"},t.friend_friendHelp_hireFriendHelp={type:"friend",key:"friend_friendHelp_hireFriendHelp",name:"friend.friendHelpHandler.hireFriendHelp",args:{helpId:"_0"},returns:"FriendHelpOperateData"},t.friend_groupCopy_groupList={type:"groupCopy",key:"friend_groupCopy_groupList",name:"friend.groupCopyHandler.groupList",returns:"GroupCopyOperateData"},t.friend_groupCopy_getGroupInfo={type:"groupCopy",key:"friend_groupCopy_getGroupInfo",name:"friend.groupCopyHandler.getGroupInfo",returns:"GroupCopyOperateData"},t.friend_groupCopy_groupCreate={type:"groupCopy",key:"friend_groupCopy_groupCreate",name:"friend.groupCopyHandler.groupCreate",returns:"GroupCopyOperateData"},t.friend_groupCopy_groupJoin={type:"groupCopy",key:"friend_groupCopy_groupJoin",name:"friend.groupCopyHandler.groupJoin",args:{groupId:"_0"},returns:"GroupCopyOperateData"},t.friend_groupCopy_groupExit={type:"groupCopy",key:"friend_groupCopy_groupExit",name:"friend.groupCopyHandler.groupExit",returns:"GroupCopyOperateData"},t.friend_groupCopy_getApplyList={type:"groupCopy",key:"friend_groupCopy_getApplyList",name:"friend.groupCopyHandler.getApplyList",returns:"GroupCopyOperateData"},t.friend_groupCopy_applyListOpt={type:"groupCopy",key:"friend_groupCopy_applyListOpt",name:"friend.groupCopyHandler.applyListOpt",args:{playerId:"_0",opt_type:"_1"},returns:"GroupCopyOperateData"},t.friend_groupCopy_setPos={type:"groupCopy",key:"friend_groupCopy_setPos",name:"friend.groupCopyHandler.setPos",args:{src_pos:"_0",dst_pos:"_1"},returns:"GroupCopyOperateData"},t.friend_groupCopy_groupAppoint={type:"groupCopy",key:"friend_groupCopy_groupAppoint",name:"friend.groupCopyHandler.groupAppoint",args:{playerId:"_0"},returns:"GroupCopyOperateData"},t.friend_groupCopy_groupKick={type:"groupCopy",key:"friend_groupCopy_groupKick",name:"friend.groupCopyHandler.groupKick",args:{playerId:"_0"},returns:"GroupCopyOperateData"},t.friend_groupCopy_inviteList={type:"groupCopy",key:"friend_groupCopy_inviteList",name:"friend.groupCopyHandler.inviteList",returns:"GroupCopyOperateData"},t.friend_groupCopy_inviteFriend={type:"groupCopy",key:"friend_groupCopy_inviteFriend",name:"friend.groupCopyHandler.inviteFriend",args:{playerId:"_0"},returns:"GroupCopyOperateData"},t.friend_groupCopy_getInviteList={type:"groupCopy",key:"friend_groupCopy_getInviteList",name:"friend.groupCopyHandler.getInviteList",returns:"GroupCopyOperateData"},t.friend_groupCopy_acceptInvite={type:"groupCopy",key:"friend_groupCopy_acceptInvite",name:"friend.groupCopyHandler.acceptInvite",args:{playerId:"_0"},returns:"GroupCopyOperateData"},t.friend_groupCopy_refuseInvite={type:"groupCopy",key:"friend_groupCopy_refuseInvite",name:"friend.groupCopyHandler.refuseInvite",args:{playerId:"_0"},returns:"GroupCopyOperateData"},t.friend_groupCopy_setInvite={type:"groupCopy",key:"friend_groupCopy_setInvite",name:"friend.groupCopyHandler.setInvite",args:{playerId:"_0",state:"_1"},returns:"GroupCopyOperateData"},t.friend_groupCopy_getRefuseInviteList={type:"groupCopy",key:"friend_groupCopy_getRefuseInviteList",name:"friend.groupCopyHandler.getRefuseInviteList",returns:"GroupCopyOperateData"},t.friend_groupCopy_startBattle={type:"groupCopy",key:"friend_groupCopy_startBattle",name:"friend.groupCopyHandler.startBattle",args:{id:"_0"},returns:"GroupCopyOperateData"},t.friend_groupCopy_getChapterAward={type:"groupCopy",key:"friend_groupCopy_getChapterAward",name:"friend.groupCopyHandler.getChapterAward",args:{id:"_0"},returns:"GroupCopyOperateData"},t}();(iface||(iface={})).dsNameConsts={AdventureEntity:"AdventureEntity",ArenaEntity:"ArenaEntity",BagEntity:"BagEntity",BanIpEntity:"BanIpEntity",ClientConfigEntity:"ClientConfigEntity",CondMailEntity:"CondMailEntity",CopyEntity:"CopyEntity",CounterEntity:"CounterEntity",CurrencyEntity:"CurrencyEntity",EscortEntity:"EscortEntity",EscortRecordEntity:"EscortRecordEntity",ExtendEntity:"ExtendEntity",FriendEntity:"FriendEntity",FriendHelpEntity:"FriendHelpEntity",GlobalEntity:"GlobalEntity",GmRechargeEntity:"GmRechargeEntity",GodEntity:"GodEntity",GroupCopyEntity:"GroupCopyEntity",GroupsEntity:"GroupsEntity",GuildEntity:"GuildEntity",GuildHelpEntity:"GuildHelpEntity",GuildWarEntity:"GuildWarEntity",GuildWarRankLogEntity:"GuildWarRankLogEntity",HonourEntity:"HonourEntity",HonourMatchEntity:"HonourMatchEntity",HonourRegEntity:"HonourRegEntity",MailEntity:"MailEntity",MatchWarEntity:"MatchWarEntity",MineEntity:"MineEntity",MineRecordEntity:"MineRecordEntity",NewsEntity:"NewsEntity",NoticeEntity:"NoticeEntity",NoticesEntity:"NoticesEntity",PlayerEntity:"PlayerEntity",RechargeEntity:"RechargeEntity",RechargeOrderEntity:"RechargeOrderEntity",ServerListEntity:"ServerListEntity",ServerPlatformEntity:"ServerPlatformEntity",TaskEntity:"TaskEntity",UserEntity:"UserEntity",WelfareEntity:"WelfareEntity",WorldBossEntity:"WorldBossEntity",WorldEntity:"WorldEntity",WorldOrderEntity:"WorldOrderEntity",WorldPlayerEntity:"WorldPlayerEntity",_db_paramEntity:"_db_paramEntity",t_ban_playerEntity:"t_ban_playerEntity",t_ban_speakEntity:"t_ban_speakEntity",t_ban_user_ipEntity:"t_ban_user_ipEntity",t_config_advance_taskEntity:"t_config_advance_taskEntity",t_config_assetEntity:"t_config_assetEntity",t_config_colorEntity:"t_config_colorEntity",t_config_dupEntity:"t_config_dupEntity",t_config_guide_taskEntity:"t_config_guide_taskEntity",t_config_itemEntity:"t_config_itemEntity",t_config_livenessEntity:"t_config_livenessEntity",t_config_mapEntity:"t_config_mapEntity",t_config_player_extEntity:"t_config_player_extEntity",t_config_rankEntity:"t_config_rankEntity",t_config_sourceEntity:"t_config_sourceEntity",t_config_stepEntity:"t_config_stepEntity",t_config_taskEntity:"t_config_taskEntity",t_log_activity_joinEntity:"t_log_activity_joinEntity",t_log_advance_taskEntity:"t_log_advance_taskEntity",t_log_asset_type_1Entity:"t_log_asset_type_1Entity",t_log_asset_type_2Entity:"t_log_asset_type_2Entity",t_log_chatEntity:"t_log_chatEntity",t_log_chat_monitorEntity:"t_log_chat_monitorEntity",t_log_clientEntity:"t_log_clientEntity",t_log_dup_joinEntity:"t_log_dup_joinEntity",t_log_dup_resetEntity:"t_log_dup_resetEntity",t_log_friendEntity:"t_log_friendEntity",t_log_guide_taskEntity:"t_log_guide_taskEntity",t_log_guild_payEntity:"t_log_guild_payEntity",t_log_item_consumeEntity:"t_log_item_consumeEntity",t_log_item_getEntity:"t_log_item_getEntity",t_log_level_upEntity:"t_log_level_upEntity",t_log_loadEntity:"t_log_loadEntity",t_log_loginEntity:"t_log_loginEntity",t_log_mailEntity:"t_log_mailEntity",t_log_marryEntity:"t_log_marryEntity",t_log_merge_player_inventory_itemEntity:"t_log_merge_player_inventory_itemEntity",t_log_only_loginEntity:"t_log_only_loginEntity",t_log_open_giftEntity:"t_log_open_giftEntity",t_log_payEntity:"t_log_payEntity",t_log_player_renameEntity:"t_log_player_renameEntity",t_log_rank_guildEntity:"t_log_rank_guildEntity",t_log_rank_type_1Entity:"t_log_rank_type_1Entity",t_log_rank_type_2Entity:"t_log_rank_type_2Entity",t_log_rank_type_3Entity:"t_log_rank_type_3Entity",t_log_rank_type_4Entity:"t_log_rank_type_4Entity",t_log_rank_type_5Entity:"t_log_rank_type_5Entity",t_log_rank_type_6Entity:"t_log_rank_type_6Entity",t_log_rank_type_7Entity:"t_log_rank_type_7Entity",t_log_saleEntity:"t_log_saleEntity",t_log_shopEntity:"t_log_shopEntity",t_log_stepEntity:"t_log_stepEntity",t_log_taskEntity:"t_log_taskEntity",t_log_titleEntity:"t_log_titleEntity",t_playerEntity:"t_playerEntity",t_realtime_onlineEntity:"t_realtime_onlineEntity",t_realtime_registerEntity:"t_realtime_registerEntity",t_system_livenessEntity:"t_system_livenessEntity",t_userEntity:"t_userEntity",NullData:"NullData",QueryEntryData:"QueryEntryData",EntryData:"EntryData",OfflineEarnInfo:"OfflineEarnInfo",EnterGameData:"EnterGameData",PlayerData:"PlayerData",GodInfo:"GodInfo",TaskInfo:"TaskInfo",DailyInfo:"DailyInfo",AdvanceInfo:"AdvanceInfo",WairrorInfo:"WairrorInfo",FriendHelpData:"FriendHelpData",CommonData:"CommonData",CommonOperateData:"CommonOperateData",GodOperateData:"GodOperateData",ItemOperateData:"ItemOperateData",TimeItemInfo:"TimeItemInfo",EquipInfo:"EquipInfo",TreasureInfo:"TreasureInfo",EquipOperateData:"EquipOperateData",TreasureOperateData:"TreasureOperateData",CopyOperateData:"CopyOperateData",TaskOperateData:"TaskOperateData",FriendData:"FriendData",RecommendData:"RecommendData",ApplyPlayerData:"ApplyPlayerData",FriendOperateData:"FriendOperateData",MailData:"MailData",MailOperateData:"MailOperateData",PointOperateData:"PointOperateData",ClgListInfo:"ClgListInfo",ArenaRecordInfo:"ArenaRecordInfo",RankListInfo:"RankListInfo",ReportInfo:"ReportInfo",ReportData:"ReportData",ArenaOperateData:"ArenaOperateData",MatchClgListInfo:"MatchClgListInfo",MatchRecordInfo:"MatchRecordInfo",MatchRankListInfo:"MatchRankListInfo",MatchEndInfo:"MatchEndInfo",MatchOperateData:"MatchOperateData",MarketData:"MarketData",MarketOperateData:"MarketOperateData",ShopData:"ShopData",ShopOperateData:"ShopOperateData",GuildData:"GuildData",GuildApplyData:"GuildApplyData",GuildMemberData:"GuildMemberData",GuildInfo:"GuildInfo",GuildLevelRankInfo:"GuildLevelRankInfo",GuildCopyRankInfo:"GuildCopyRankInfo",GuildUpdateMemberInfo:"GuildUpdateMemberInfo",GuildOperateData:"GuildOperateData",ChatData:"ChatData",ChatOperateData:"ChatOperateData",GuideOperateData:"GuideOperateData",GmOperateData:"GmOperateData",SevendayInfo:"SevendayInfo",WelfareOperateData:"WelfareOperateData",GuildCopyOperateData:"GuildCopyOperateData",ActivityListData:"ActivityListData",ActivityInfoData:"ActivityInfoData",ActivityOperateData:"ActivityOperateData",RechargeOperateData:"RechargeOperateData",RankOperateData:"RankOperateData",ChallengerInfo:"ChallengerInfo",ExpeditionOperateData:"ExpeditionOperateData",NoticeOperateData:"NoticeOperateData",QueryOperateData:"QueryOperateData",WorldBossInfo:"WorldBossInfo",WorldBossRankInfo:"WorldBossRankInfo",WorldBossBattleInfo:"WorldBossBattleInfo",WorldBossRecordInfo:"WorldBossRecordInfo",WorldBossOperateData:"WorldBossOperateData",ArtifactInfo:"ArtifactInfo",ArtifactOperateData:"ArtifactOperateData",EscortListInfo:"EscortListInfo",TargetEscortInfo:"TargetEscortInfo",EscortInfo:"EscortInfo",EscortRecordInfo:"EscortRecordInfo",EscortOperateData:"EscortOperateData",GuildSkillOperateData:"GuildSkillOperateData",MineListInfo:"MineListInfo",MineInfo:"MineInfo",MineRecordInfo:"MineRecordInfo",MyMineInfo:"MyMineInfo",MineOperateData:"MineOperateData",ForestOperateData:"ForestOperateData",AdventureInfo:"AdventureInfo",AdventureOperateData:"AdventureOperateData",GuildWarMemberInfo:"GuildWarMemberInfo",GuildWarBaseInfo:"GuildWarBaseInfo",GuildWarRankInfo:"GuildWarRankInfo",GuildWarBoxInfo:"GuildWarBoxInfo",GuildWarMemberRankInfo:"GuildWarMemberRankInfo",GuildWarSessionRankInfo:"GuildWarSessionRankInfo",GuildWarOperateData:"GuildWarOperateData",LuckOperateData:"LuckOperateData",HonourWarInfo:"HonourWarInfo",HonourListInfo:"HonourListInfo",HonourPlayerInfo:"HonourPlayerInfo",HonourBaseInfo:"HonourBaseInfo",HonourOperateData:"HonourOperateData",GroupListInfo:"GroupListInfo",GroupInfo:"GroupInfo",GroupMemberInfo:"GroupMemberInfo",InviteListInfo:"InviteListInfo",InviteInfo:"InviteInfo",GroupMvpInfo:"GroupMvpInfo",GroupOperateData:"GroupOperateData",RechargeOrderData:"RechargeOrderData",RiskInfo:"RiskInfo",RiskOperateData:"RiskOperateData",GemstoneInfo:"GemstoneInfo",GemstoneOperateData:"GemstoneOperateData",ApiOperateData:"ApiOperateData",GuildHelpInfo:"GuildHelpInfo",GuildHelpOperateData:"GuildHelpOperateData",FriendHelpInfo:"FriendHelpInfo",FriendHelpOperateData:"FriendHelpOperateData",GroupCopyApplyListInfo:"GroupCopyApplyListInfo",GroupCopyMemberListInfo:"GroupCopyMemberListInfo",GroupCopyListInfo:"GroupCopyListInfo",GroupCopyInfo:"GroupCopyInfo",GroupCopyMemberInfo:"GroupCopyMemberInfo",GroupCopyInviteListInfo:"GroupCopyInviteListInfo",GroupCopyReportMemberInfo:"GroupCopyReportMemberInfo",GroupCopyOperateData:"GroupCopyOperateData"},function(t){t.dsConsts={AdventureEntity:{playerId:1,acceptableList:2,advtKey:3,advts:4},ArenaEntity:{playerId:1,rank:2,topRank:3,battleCnt:4,atkWinCnt:5,defWinCnt:6,winStreak:7,maxWinStreak:8,battleRecords:9},BagEntity:{playerId:1,items:2,equipKey:3,equips:4,timeKey:5,timeItems:6,treasureKey:7,treasures:8,gemKey:9,gemstones:10},BanIpEntity:{ip:1,endTime:2,reason:3,operator:4},ClientConfigEntity:{dev_id:1,dev_config:2},CondMailEntity:{idx:1,pf_id:2,sex:3,is_online:4,min_lv:5,max_lv:6,reg_time_start:7,reg_time_end:8,last_login_time:9,send_time:10,title:11,content:12,gold:13,bind_gold:14,goodsinfo:15},CopyEntity:{playerId:1,expeditionPlayerIds:2,expeditionSelfHpInfo:3,expeditionEnemyName:4,expeditionEnemyLevel:5,expeditionEnemySex:6,expeditionEnemyForce:7,expeditionEnemyLineupInfo:8,expeditionEnemyHpInfo:9,expeditionId:10,expeditionRewardInfo:11,honourWarRegTime:12,mapBoxAwardIds:13,copyUnlockId:14,guildCopyRankIds:15,dailyCopyIds:16,friendHelpList:17,helpGodId:18},CounterEntity:{playerId:1,escortRefreshCount:2,sysLiveInfo:3,quickBattleFreeNum:4,limitInfo:5},CurrencyEntity:{playerId:1,gold:2,diamond:3,arena:4,friend:5,godExp:6,guildDonate:7,legendChip:8,soulStone:9,godCrystal:10,darkEssence:11,convertDust:12,honour:13,godDomain:14,vipScore:15},EscortEntity:{playerId:1,tradeId:2,endTime:3,robCount:4,robbers:5,multiple:6},EscortRecordEntity:{recordId:1,playerId:2,recordTime:3,recordType:4,tradeId:5,robberId:6,multiple:7},ExtendEntity:{playerId:1,counterP3:2,counterP4:3,counterP5:4,counter4:5,counter5:6,counter5s:7,godAlbum:8,thew:9,lastThewTime:10,mainProgress:11,lastProgressTime:12,runeCopyInfo:13,lineupInfo:14,lineupArtifactInfo:15,limitInfo:16,wishNums:17,lastRefreshTime:18,arenaFailTime:19,marketList:20,shopList:21,marketRefreshReplyTime:22,groundCopyInfo:23,towerCopyInfo:24,towerAwardInfo:25,systemMailId:26,speOpeInfo:27,dailyOnlineTime:28,totalOnlineTime:29,onlineEndTime:30,indulgeOnlineTime:31,indulgeOutlineTime:32,indulgeEndTime:33,afkAward:34,lastAfkTime:35,lastGetAfkTime:36,treasureAtkEndTime:37,redPointInfo:38,treasureId:39,guildCopyDamageInfo:40,guildCopyAwardInfo:41,overplusInfo:42,worshipInfo:43,maxHistoryForce:44,initState:45,worldBossReplyTime:46,mergeVersion:47,artifactInfo:48,escortTradeId:49,guildSkillInfo:50,mineRobReplyTime:51,advtScore:52,forestCurFloor:53,forestMaxFloor:54,doneForestChests:55,guildWarSession:56,guildWarAwardCount:57,maxGodForce:58,doneSysOpenChests:59,godFateIds:60,matchClgList:61,matchClgListTime:62,clgMatchNum:63,doneMatchChests:64,lastMatchDefNum:65,maxStarLevel:66,maxStarLevelForce:67,artifactSkillLv:68,artifactStrengthLv:69,artifactBaptizeLv:70,artifactBaptizeExp:71,artifactStarLv:72,artifactStarExp:73,artifactBaptizeAttrs:74,treasureBooks:75,guildCopyMaxDmg:76,guildHelpEndTime:77,firstIds:78,godAlbumAward:79},FriendEntity:{playerId:1,friends:2,requests:3,groupId:4,isInvite:5,godDmGrade:6,godDmScore:7,godDmRank:8,inviteCd:9,inviteInfo:10,refuseInvite:11,oneKeyInviteCd:12,lastRefreshTime:13,blackLists:14,groupCopyId:15,isCopyInvite:16,groupCopyFloor:17,inviteCopyCd:18,inviteCopyInfo:19,refuseCopyInvite:20,groupCopyChapterAward:21,groupCopyServerAwardId:22},FriendHelpEntity:{helpId:1,playerId:2,godInfo:3,hireFriendId:4,createTime:5},GlobalEntity:{globalId:1,strValue:2,intValue:3},GmRechargeEntity:{pId:1,orderId:2,channelId:3,accountId:4,playerId:5,playerName:6,itemId:7,itemType:8,amount:9,gold:10,firstGold:11,plusGold:12,item:13,moneyType:14,payTime:15,state:16},GodEntity:{playerId:1,godKey:2,gods:3,skinIds:4,maxStarLvInfo:5,godAwakens:6},GroupCopyEntity:{groupId:1,dismissTime:2,memberList:3,battleReport:4,applyList:5},GroupsEntity:{groupId:1,autoJoin:2,regTime:3,memberList:4},GuildEntity:{guildId:1,name:2,head:3,level:4,exp:5,num:6,notice:7,signIn:8,oldSignIn:9,limitLevel:10,autoJoin:11,memberList:12,applyList:13,copyMosterInfo:14,copyId:15,copyAwardCount:16,pId:17,sId:18,createTime:19,guildWarRegTime:20,guildWarSession:21,guildWarGrade:22,guildWarAwardInfo:23},GuildHelpEntity:{helpId:1,helpType:2,playerId:3,guildId:4,helpNum:5,getNum:6,createTime:7,helpPos:8},GuildWarEntity:{guildId:1,guildHead:2,guildLevel:3,guildName:4,guildPid:5,guildSid:6,presidentId:7,presidentName:8,regTime:9,endTime:10,dailyScore:11,maxGuildGrade:12,totalScore:13,totalForce:14,guildGrade:15,upgradeType:16,memberInfo:17,matchGuildId:18,matchGroupId:19},GuildWarRankLogEntity:{logId:1,session:2,guildRank:3,guildId:4,guildHead:5,guildLevel:6,guildName:7,guildPid:8,guildSid:9,presidentId:10,presidentName:11,totalForce:12},HonourEntity:{recordId:1,session:2,stage:3,groupId:4,round:5,pos:6,winner:7,updateTime:8,leftId:9,rightId:10,leftInfo:11,rightInfo:12,betInfo:13,battleInfo:14},HonourMatchEntity:{recordId:1,session:2,stage:3,groupId:4,round:5,pos:6,winner:7,updateTime:8,leftId:9,rightId:10,leftInfo:11,rightInfo:12,betInfo:13,battleInfo:14},HonourRegEntity:{session:1,playerId:2,name:3,sex:4,head:5,level:6,pId:7,sId:8,forceNum:9,lineupInfo:10,guildName:11,guildPid:12,guildSid:13,headFrame:14,showGodId:15,showSkinId:16},MailEntity:{mailId:1,playerId:2,type:3,state:4,endtime:5,title:6,content:7,item:8,fromTo:9},MatchWarEntity:{playerId:1,name:2,sex:3,head:4,level:5,pId:6,sId:7,forceNum:8,lineupInfo:9,guildName:10,guildPid:11,guildSid:12,score:13,defNum:14,battleRecords:15,headFrame:16},MineEntity:{mineIndex:1,islandId:2,mineId:3,mineType:4,occupierId:5,occupyTime:6,startTime:7,robCount:8,profitInfo:9},MineRecordEntity:{recordId:1,playerId:2,recordTime:3,recordType:4,mineType:5,robberId:6,state:7,rewardInfo:8},NewsEntity:{idx:1,title:2,content:3,start_time:4},NoticeEntity:{idx:1,content:2,start_time:3,end_time:4,interval_time:5},NoticesEntity:{idx:1,title:2,content:3,start_time:4,pf_id:5},PlayerEntity:{playerId:1,userId:2,userName:3,createTime:4,sex:5,name:6,head:7,headId:8,level:9,exp:10,vipLevel:11,robot:12,guildId:13,guildName:14,guildPid:15,guildSid:16,lastLoginTime:17,lastLogoutTime:18,lastLoginIp:19,gmLevel:20,gagEndTime:21,guildApplyEndTime:22,pId:23,sId:24,channelId:25,deviceId:26,isNewPlayer:27,isIndulge:28,isCertification:29,forceNum:30,accountName:31,gmsServerId:32,lineupInfo:33,headFrame:34,showGodId:35,showSkinId:36},RechargeEntity:{pId:1,orderId:2,cpOrderId:3,uid:4,userName:5,money:6,goodsId:7,goodsName:8,serverId:9,playerId:10,payTime:11,state:12},RechargeOrderEntity:{orderId:1,cpOrderId:2,playerId:3,uid:4,userName:5,money:6,goodsId:7,goodsName:8,pId:9,sId:10,payTime:11,state:12},ServerListEntity:{serverId:1,address:2,serverState:3,population:4,openTime:5,serverIp:6,gmsServerId:7},ServerPlatformEntity:{platformId:1,idx:2,serverName:3,serverId:4,gmsServerId:5,mergeServerId:6},TaskEntity:{playerId:1,dailyTasks:2,liveness:3,doneChests:4,curTasks:5,doneTasks:6,guideStep:7,guideWeakStep:8,curMainTask:9,advanceLevel:10,advanceInfos:11,warriorLevel:12,warriorExp:13,warriorAdvance:14,warriorWeekTasks:15,warriorMonthTasks:16,warriorLevelAwards:17,warriorAdvanceAwards:18,warriorWeekAward:19},UserEntity:{id:1,account:2,userName:3,password:4,loginCount:5,createTime:6,lastLoginTime:7,banEndTime:8,pid:9,channelId:10},WelfareEntity:{playerId:1,loginCount:2,totalLoginDay:3,dailySignIn:4,todaySignIn:5,totalSignIn:6,levelGiftPack:7,loginGiftPack:8,thewSignIn:9,firstRecharge:10,lastGmRechargeId:11,gmRechargeSum:12,lastRechargeId:13,rechargeSum:14,dailyRechargeSum:15,rechargeCount:16,rechargeGoodsIds:17,privilegeGiftPack:18,monthCardEndTime:19,lifelongCard:20,monthCardAward:21,lifelongCardAward:22,goodsRechargeCount:23,activityInfo:24,activityCountInfo:25,sevendayInfo:26,sevendayExtraAward:27,buyLevelFund:28,levelFundAward:29,condMailIdx:30,signInStartTime:31,signInLoginCount:32,signInVipCount:33,signInRechargeCount:34,shareNumToday:35,shareNumTotal:36,doneShares:37,luckGodNum:38,luckGodTypeNums:39,luckEquipNum:40,luckEquipTypeNums:41,luckArtTypeNums:42,luckTreasureNum:43,luckTreasureTypeNums:44,luckTreasureId:45,luckGodId:46,luckEquipId:47,luckArtId:48,luckEquipAward:49,summonId:50,summonScore:51,doneSummonChests:52,groupBuyId:53,groupBuyInfo:54,autonymAwardNum:55,onlineTimeAward:56,doneOpenGifts:57,firstRechargeTime:58,mobileNumber:59,bindMobileAward:60,downloadApkAward:61,superVip:62,superVipAward:63,consumeSum:64,dailyConsumeSum:65,weekFund:66,weekFundAward:67,openSvrGiftAwardNums:68,dailyRechargeNums:69,dailyRechargeAwardNums:70,sevendayInit:71,riskIds:72,curRiskId:73,riskKey:74,riskInfo:75,dayRechargeLimit:76,weekRechargeLimit:77,monthRechargeLimit:78,openSvrGroupBuyAward:79,openSvrRechargeSum:80,rechargeRebate:81},WorldBossEntity:{bossId:1,bossHp:2,reviveTime:3,playerDamage:4,records:5},WorldEntity:{globalId:1,strValue:2,intValue:3},WorldOrderEntity:{orderId:1,playerId:2,pId:3,sId:4,time:5,state:6,type:7,info:8},WorldPlayerEntity:{playerId:1,serverId:2},_db_paramEntity:{paramId:1,strValue:2,intValue:3},t_ban_playerEntity:{pf_id:1,channel_id:2,srv_id:3,logsrv_id:4,dev_id:5,part_id:6,player_id:7,player_name:8,ban_time:9,reason:10,operator:11,time:12},t_ban_speakEntity:{pf_id:1,channel_id:2,srv_id:3,logsrv_id:4,dev_id:5,part_id:6,player_id:7,player_name:8,ban_time:9,reason:10,operator:11,time:12},t_ban_user_ipEntity:{pf_id:1,channel_id:2,srv_id:3,logsrv_id:4,dev_id:5,part_id:6,ip:7,ban_time:8,reason:9,operator:10,time:11},t_config_advance_taskEntity:{id:1,name:2,advance_lv:3},t_config_assetEntity:{id:1,name:2,tab:3},t_config_colorEntity:{id:1,name:2},t_config_dupEntity:{id:1,type:2,name:3},t_config_guide_taskEntity:{id:1,name:2},t_config_itemEntity:{tid:1,name:2,type:3,subtype:4,detail:5,other:6,quality:7},t_config_livenessEntity:{id:1,name:2},t_config_mapEntity:{id:1,name:2},t_config_player_extEntity:{name:1,field_desc:2},t_config_rankEntity:{id:1,name:2,base_table:3,cond_1:4,cond_2:5},t_config_sourceEntity:{id:1,name:2},t_config_stepEntity:{id:1,name:2},t_config_taskEntity:{id:1,name:2,type:3,min_lv:4},t_log_activity_joinEntity:{index:1,pf_id:2,channel_id:3,srv_id:4,logsrv_id:5,dev_id:6,part_id:7,player_id:8,player_name:9,user_name:10,id:11,name:12,type:13,join_level:14,time:15,limit:16},t_log_advance_taskEntity:{pf_id:1,srv_id:2,channel_id:3,logsrv_id:4,dev_id:5,part_id:6,player_id:7,create_time:8,task_id:9,accept_time:10,finish_time:11,task_state:12},t_log_asset_type_1Entity:{id:1,source_id:2,time:3,user_name:4,player_id:5,player_name:6,opt_type:7,change_asset:8,remain_asset:9,pf_id:10,channel_id:11,srv_id:12,logsrv_id:13,dev_id:14,part_id:15,is_inner:16,item_id:17,item_name:18,item_num:19,item_desc:20,date_time:21},t_log_asset_type_2Entity:{id:1,source_id:2,time:3,user_name:4,player_id:5,player_name:6,opt_type:7,change_asset:8,remain_asset:9,pf_id:10,channel_id:11,srv_id:12,logsrv_id:13,dev_id:14,part_id:15,is_inner:16,item_id:17,item_name:18,item_num:19,item_desc:20,date_time:21},t_log_chatEntity:{id:1,pf_id:2,channel_id:3,srv_id:4,logsrv_id:5,dev_id:6,part_id:7,chat_channel_id:8,from_id:9,from_name:10,to_name:11,content:12,time:13},t_log_chat_monitorEntity:{id:1,player_id:2,content:3,time:4},t_log_clientEntity:{id:1,content:2,version:3,devOS:4,mobile:5,pf_id:6,channel_id:7,srv_id:8,accountId:9,accountName:10,playerId:11,playerName:12,level:13,deviceTime:14,device:15,time:16},t_log_dup_joinEntity:{id:1,pf_id:2,channel_id:3,srv_id:4,logsrv_id:5,dev_id:6,part_id:7,player_id:8,dup_id:9,dup_name:10,join_level:11,dup_type:12,dup_type_name:13,time:14,limit:15},t_log_dup_resetEntity:{id:1,pf_id:2,srv_id:3,channel_id:4,logsrv_id:5,dev_id:6,part_id:7,type_id:8,type_name:9,dup_id:10,dup_name:11,player_id:12,gold:13,currency_type:14,time:15},t_log_friendEntity:{id:1,player_id:2,handle_player_id:3,opreation:4,log_time:5,pf_id:6,channel_id:7,srv_id:8,logsrv_id:9,dev_id:10,part_id:11},t_log_guide_taskEntity:{pf_id:1,srv_id:2,channel_id:3,logsrv_id:4,dev_id:5,part_id:6,player_id:7,create_time:8,task_id:9,time:10,task_state:11},t_log_guild_payEntity:{order_num:1,pf_id:2,srv_id:3,channel_id:4,logsrv_id:5,dev_id:6,part_id:7,user_id:8,user_name:9,player_id:10,player_name:11,pay_time:12,pay_gold:13,money:14,currency_type:15,guild_id:16,guild_name:17},t_log_item_consumeEntity:{id:1,source_id:2,time:3,user_name:4,player_id:5,player_name:6,item_id:7,tid:8,item_type:9,quantity:10,bind:11,pos:12,deadline:13,other:14,pf_id:15,channel_id:16,srv_id:17,logsrv_id:18,dev_id:19,part_id:20,color:21},t_log_item_getEntity:{id:1,source_id:2,time:3,user_name:4,player_id:5,player_name:6,item_id:7,tid:8,item_type:9,quantity:10,bind:11,pos:12,deadline:13,other:14,pf_id:15,channel_id:16,srv_id:17,logsrv_id:18,dev_id:19,part_id:20,color:21},t_log_level_upEntity:{id:1,player_id:2,player_name:3,user_id:4,user_name:5,level:6,time:7,pf_id:8,channel_id:9,srv_id:10,logsrv_id:11,dev_id:12,part_id:13},t_log_loadEntity:{id:1,user_id:2,user_name:3,player_id:4,player_name:5,step:6,time:7,ip:8,pf_id:9,channel_id:10,srv_id:11,logsrv_id:12,dev_id:13,part_id:14},t_log_loginEntity:{id:1,pf_id:2,channel_id:3,srv_id:4,logsrv_id:5,dev_id:6,part_id:7,player_id:8,player_name:9,user_id:10,user_name:11,login_time:12,login_level:13,logout_time:14,logout_level:15,online_time:16,day_time:17,map_id:18,xpos:19,ypos:20,ip:21,imei:22,reason:23},t_log_mailEntity:{mail_id:1,send_id:2,send_name:3,receive_id:4,receive_name:5,receive_time:6,gold_bind:7,gold:8,attach:9,title:10,content:11,state:12},t_log_marryEntity:{id:1,player_id:2,log_time:3,opt:4,ring_lv:5,ring_exp:6,marry_time:7,marry_wedding:8,mate_id:9,mate_sex:10,ct_step:11,ct_lv:12,lt_lv:13,lt_exp:14,pf_id:15,channel_id:16,srv_id:17,logsrv_id:18,dev_id:19,part_id:20},t_log_merge_player_inventory_itemEntity:{id:1,time:2,player_id:3,tid:4,quantity:5,pf_id:6,srv_id:7,dev_id:8},t_log_only_loginEntity:{id:1,pf_id:2,channel_id:3,srv_id:4,logsrv_id:5,dev_id:6,part_id:7,player_id:8,player_name:9,user_id:10,user_name:11,login_time:12,login_level:13,map_id:14,xpos:15,ypos:16,ip:17,imei:18},t_log_open_giftEntity:{id:1,pf_id:2,channel_id:3,srv_id:4,logsrv_id:5,dev_id:6,part_id:7,player_id:8,player_name:9,gift_id:10,gift_name:11,currency_type:12,consume_gold:13,count:14,time:15},t_log_payEntity:{order_num:1,user_id:2,user_name:3,player_id:4,player_name:5,pay_time:6,pay_num:7,pay_gold:8,is_succ:9,level:10,currency_type:11,money:12,pay_channel:13,type:14,last_update_time:15,pf_id:16,srv_id:17,channel_id:18,logsrv_id:19,dev_id:20,part_id:21,ip:22,tid:23,item_type:24,first_gold:25,plus_gold:26},t_log_player_renameEntity:{id:1,pf_id:2,srv_id:3,logsrv_id:4,dev_id:5,part_id:6,user_name:7,player_id:8,old_name:9,new_name:10,time:11},t_log_rank_guildEntity:{guild_id:1,guild_name:2,guild_level:3,fight:4,member_num:5,max_num:6,create_time:7,master_name:8,rank:9,record_time:10},t_log_rank_type_1Entity:{id:1,user_name:2,player_id:3,player_name:4,guild_name:5,vip_level:6,cond_1:7,cond_2:8,time:9,rank:10,create_time:11},t_log_rank_type_2Entity:{id:1,user_name:2,player_id:3,player_name:4,guild_name:5,vip_level:6,cond_1:7,cond_2:8,time:9,rank:10,create_time:11},t_log_rank_type_3Entity:{id:1,user_name:2,player_id:3,player_name:4,guild_name:5,vip_level:6,cond_1:7,cond_2:8,time:9,rank:10,create_time:11},t_log_rank_type_4Entity:{id:1,user_name:2,player_id:3,player_name:4,guild_name:5,vip_level:6,cond_1:7,cond_2:8,time:9,rank:10,create_time:11},t_log_rank_type_5Entity:{id:1,user_name:2,player_id:3,player_name:4,guild_name:5,vip_level:6,cond_1:7,cond_2:8,time:9,rank:10,create_time:11},t_log_rank_type_6Entity:{id:1,user_name:2,player_id:3,player_name:4,guild_name:5,vip_level:6,cond_1:7,cond_2:8,time:9,rank:10,create_time:11},t_log_rank_type_7Entity:{id:1,user_name:2,player_id:3,player_name:4,guild_name:5,vip_level:6,cond_1:7,cond_2:8,time:9,rank:10,create_time:11},t_log_saleEntity:{id:1,sale_id:2,sell_id:3,sell_time:4,buy_id:5,buy_time:6,quantity:7,tid:8,color:9,attr_list:10,total_price:11,valid_time:12,pf_id:13,channel_id:14,srv_id:15,logsrv_id:16},t_log_shopEntity:{id:1,player_id:2,player_name:3,user_name:4,tid:5,item_type:6,item_name:7,currency_type:8,buy_num:9,consume:10,time:11,pf_id:12,channel_id:13,srv_id:14,logsrv_id:15,dev_id:16,part_id:17,is_inner:18},t_log_stepEntity:{id:1,type:2,step:3,time:4,player_id:5,pf_id:6,channel_id:7,srv_id:8,logsrv_id:9,dev_id:10,part_id:11},t_log_taskEntity:{pf_id:1,srv_id:2,channel_id:3,logsrv_id:4,dev_id:5,part_id:6,player_id:7,task_id:8,task_name:9,task_type:10,player_level:11,user_name:12,ip:13,create_time:14,finish_time:15,task_state:16,task_cycle:17,story_type:18},t_log_titleEntity:{id:1,pf_id:2,srv_id:3,logsrv_id:4,dev_id:5,part_id:6,player_id:7,operate_type:8,title_id:9,title_name:10,expire_time:11,time:12},t_playerEntity:{pf_id:1,srv_id:2,channel_id:3,logsrv_id:4,dev_id:5,part_id:6,user_id:7,user_name:8,player_id:9,player_name:10,create_time:11,profession:12,sex:13,last_login_time:14,last_offline_time:15,last_update_time:16,is_online:17,total_online_time:18,level:19,vip_level:20,ip:21,power:22,remain_gold:23,consume_gold:24,guild_name:25,exp:26,map_id:27,xpos:28,ypos:29,ext1:30,ext2:31,ext3:32},t_realtime_onlineEntity:{pf_id:1,channel_id:2,srv_id:3,logsrv_id:4,dev_id:5,part_id:6,time:7,online_count:8},t_realtime_registerEntity:{pf_id:1,channel_id:2,srv_id:3,logsrv_id:4,dev_id:5,part_id:6,time:7,register_count:8},t_system_livenessEntity:{id:1,sys_type:2,log_day:3,time:4,open_count:5,live_count:6,total_count:7},t_userEntity:{pf_id:1,srv_id:2,channel_id:3,logsrv_id:4,dev_id:5,part_id:6,user_id:7,user_name:8,reg_time:9,reg_ip:10,source:11},NullData:{},QueryEntryData:{host:1,port:2,httpPort:3},EntryData:{base:1,isNew:2},OfflineEarnInfo:{afkAward:1,offlineTime:2},EnterGameData:{curPlayer:1,offlineEarn:2,openSvrTime:3,signInStartTime:4,guildNum:5,honourStage:6,kuafuHonourStage:7,rechargePlayerNum:8,guildHelpNum:9,guildHelpCanGetNum:10},PlayerData:{playerId:1,base:2,extend:3,bag:4,god:5,currency:6,tasks:7,welfare:8,copy:9,adventure:10,friend:11},GodInfo:{templateId:1,starLevel:2,degree:3,level:4,awakenLv:5,equipKeys:6,fuseLevel:7,fuseAttrLevels:8,skinId:9,treasureKeys:10,gemInfo:11},TaskInfo:{count:1,acceptTime:2},DailyInfo:{count:1,done:2},AdvanceInfo:{count:1,reward:2},WairrorInfo:{count:1,reward:2},FriendHelpData:{helpId:1,force:2,godInfo:3},CommonData:{addGods:1,delGods:2,addEquips:3,delEquips:4,addResource:5,costResource:6,addBagItems:7,delBagItems:8,addTimeItems:9,delTimeItems:10,addGodAlbum:11,addTreasures:12,delTreasures:13,modifyLimits:14,modifyTasks:15,modifyDailys:16,modifyOverplus:17,modifyEquips:18,modifyGodEquips:19,modifySevenDays:20,modifyLineups:21,modifyReplyTime:22,modifyMaxHistoryForce:23,modifyMineRobReplyTime:24,modifyCondInfo:25,vipLevel:26,addRechargeNum:27,modifyForce:28,useGodItems:29,modifyTreasureNum:30,modifyTreasures:31,modifyGodTreasures:32,addTreasureBook:33,modifyAdvanceCount:34,lastProgressTime:35,addGemstones:36,delGemstones:37,modifyGemstoneNum:38,modifyGemstones:39,modifyGodGemstones:40,modifyMarketRefreshTime:41,modifyMaxStarLvInfo:42,addFirstIds:43,warriorLevel:44,warriorAdvance:45,modifyWarriorWeekCount:46,modifyWarriorMonthCount:47},CommonOperateData:{commonData:1,wishId:2,lastRefreshTime:3,dailyTasks:4,liveness:5,doneChests:6,limitInfo:7,name:8,sex:9,head:10,redPointInfo:11,thewSignIn:12,monthCardAward:13,lifelongCardAward:14,shopList:15,overplusInfo:16,worshipInfo:17,expeditionRewardInfo:18,expeditionSelfHpInfo:19,expeditionId:20,indulgeOnlineTime:21,indulgeEndTime:22,loginCount:23,dailyRechargeSum:24,signInStartTime:25,signInLoginCount:26,signInVipCount:27,signInRechargeCount:28,forestCurFloor:29,doneForestChests:30,shareNumToday:31,doneShares:32,summonScore:33,doneSummonChests:34,doneSysOpenChests:35,clgMatchNum:36,doneMatchChests:37,luckTreasureId:38,luckGodId:39,luckEquipId:40,luckArtId:41,dayRechargeLimit:42,weekRechargeLimit:43,monthRechargeLimit:44,headFrame:45,showGodId:46,showSkinId:47,friendHelpList:48,helpGodId:49,warriorLevel:50,warriorExp:51,warriorAdvance:52,warriorWeekTasks:53,warriorMonthTasks:54,warriorLevelAwards:55,warriorAdvanceAwards:56,warriorWeekAward:57},GodOperateData:{commonData:1,targetGod:2,godAlbum:3,allComment:4,oneComment:5,godCounters:6,convertTpltId:7,observeGodInfo:8,resolveItem:9,addGodFateId:10,addSkinId:11,addGodAwakens:12,addAlbumAward:13},ItemOperateData:{commonData:1},TimeItemInfo:{templateId:1,limitTime:2},EquipInfo:{templateId:1,slot:2,quality:3,strengthLv:4,refineLv:5,godId:6,gemInfo:7},TreasureInfo:{templateId:1,num:2,quality:3,slot:4,strengthLv:5,starLv:6,godId:7},EquipOperateData:{commonData:1,targetEquips:2},TreasureOperateData:{commonData:1,targetTreasure:2,returnItems:3},CopyOperateData:{commonData:1,firstData:2,mainProgress:3,runeCopyInfo:4,groundCopyInfo:5,towerCopyInfo:6,towerAwardInfo:7,rankList:8,lastGetAfkTime:9,addMapBoxAwardIds:10,lastAfkTime:11,afkAward:12,copyUnlockId:13,dailyCopyId:14},TaskOperateData:{commonData:1,doneTask:2,doneDaily:3,liveness:4,doneChests:5,modifyAdvanceReward:6,advanceLevel:7,warriorLevel:8,warriorExp:9,modifyWarriorWeekReward:10,modifyWarriorMonthReward:11,modifyWarriorLevelAward:12,modifyWarriorAdvanceAward:13,modifyWarriorWeekAward:14},FriendData:{playerId:1,name:2,head:3,level:4,force:5,logoutTime:6,giveTime:7,pointNum:8,headFrame:9},RecommendData:{playerId:1,name:2,head:3,level:4,force:5,headFrame:6},ApplyPlayerData:{playerId:1,name:2,head:3,level:4,online:5,outlineTime:6,force:7,headFrame:8},FriendOperateData:{commonData:1,friendList:2,requestList:3,recommondList:4,targetData:5,addfriend:6,delfriend:7,addrequest:8,delrequest:9,addBlack:10,delBlack:11,addfriendList:12,delfriendList:13,delrequestList:14,delBlackList:15,applyList:16},MailData:{mailId:1,type:2,state:3,endtime:4,title:5,content:6,item:7,fromTo:8},MailOperateData:{commonData:1,mailList:2,addMail:3,delMail:4,updateMail:5},PointOperateData:{commonData:1,delPoint:2,giveTime:3,giveId:4},ClgListInfo:{playerId:1,name:2,head:3,level:4,rank:5,force:6,maxForceGodId:7,guildName:8,canChallenge:9,awakenLv:10,skinId:11,headFrame:12},ArenaRecordInfo:{playerId:1,name:2,head:3,level:4,battleTime:5,targetRank:6,chgRank:7,battleType:8,isWin:9,force:10,targetForce:11,headFrame:12},RankListInfo:{playerId:1,name:2,guildName:3,head:4,level:5,rank:6,force:7,headFrame:8},ReportInfo:{reportData:1},ReportData:{type:1,objId:2,round:3,objType:4,templateId:5,hp:6,hpMax:7,atkBar:8,atkSpd:9,skillId:10,targetIds:11,flyTextType:12,casterId:13,buffId:14,buffInstId:15,stackCnt:16,atkBarMax:17,camp:18,anger:19,value:20,level:21,degree:22,awakenLv:23,skinId:24,starLev:25,uuid:26,bAdd:27,showeff:28},ArenaOperateData:{commonData:1,rank:2,chgRank:3,arenaFailTime:4,clgList:5,targetDefInfo:6,battleRecords:7,rankList:8,battleReport:9,topRank:10,chgTopRank:11,topRankDiamond:12,isWin:13,cardInfos:14},MatchClgListInfo:{playerId:1,name:2,head:3,level:4,score:5,defInfo:6,forceNum:7,guildName:8,headFrame:9},MatchRecordInfo:{playerId:1,name:2,head:3,level:4,battleTime:5,chgScore:6,battleType:7,isWin:8,force:9,targetForce:10,headFrame:11},MatchRankListInfo:{playerId:1,name:2,guildName:3,head:4,level:5,score:6,headFrame:7},MatchEndInfo:{selfScore:1,selfChgScore:2,tarScore:3,tarChgScore:4},MatchOperateData:{commonData:1,rank:2,score:3,clgList:4,clgListTime:5,defInfo:6,battleRecords:7,worldRankList:8,localRankList:9,battleReport:10,battleEndInfo:11,clgMatchNum:12,doneMatchChests:13},MarketData:{id:1,type:2,price:3,count:4,itemInfo:5},MarketOperateData:{commonData:1,marketList:2,buyId:3},ShopData:{id:1,count:2},ShopOperateData:{commonData:1,shopList:2,buyId:3},GuildData:{guildId:1,name:2,head:3,level:4,num:5,limitLevel:6,autoJoin:7,isApplay:8},GuildApplyData:{playerId:1,name:2,level:3,applyTime:4,force:5},GuildMemberData:{playerId:1,name:2,level:3,head:4,online:5,logoutTime:6,job:7,headFrame:8,force:9},GuildInfo:{guildId:1,name:2,head:3,level:4,num:5,limitLevel:6,autoJoin:7,notice:8,exp:9,job:10,copyId:11},GuildLevelRankInfo:{guildId:1,head:2,name:3,level:4,playerId:5,playerLevel:6,playerName:7},GuildCopyRankInfo:{guildId:1,name:2,head:3,copyId:4,level:5,leaderName:6},GuildUpdateMemberInfo:{playerId:1,job:2},GuildOperateData:{commonData:1,guildList:2,applyList:3,memberList:4,addGuild:5,delGuild:6,addApply:7,delApply:8,cancelApply:9,addMember:10,delMember:11,updateMember:12,guildInfo:13,signInNum:14,findList:15,oldSignIn:16,signIn:17,levelRankList:18,copyRankList:19,myRank:20,rankValue:21,modifyGuildExp:22,modifyGuildLevel:23,addMemberList:24,delApplyList:25},ChatData:{type:1,senderId:2,senderName:3,senderLevel:4,senderHead:5,senderScore:6,time:7,content:8,receiveId:9,city:10,senderHeadFrame:11},ChatOperateData:{commonData:1,channelType:2,worldList:3,guildList:4,groupList:5,whisperList:6,cdTime:7,crossList:8,provinceList:9,systemList:10},GuideOperateData:{guideStep:1,guideWeakStep:2},GmOperateData:{commonData:1,roleLevel:2,content:3,battleReport:4},SevendayInfo:{condCount:1,rewardCount:2},WelfareOperateData:{commonData:1,dailySignIn:2,todaySignIn:3,totalSignIn:4,levelGiftPack:5,loginGiftPack:6,thewGiftPack:7,firstRecharge:8,activationCode:9,privilegeGiftPack:10,monthCardAward:11,lifelongCardAward:12,signInLoginCount:13,signInVipCount:14,signInRechargeCount:15,autonymAwardNum:16,onlineTimeAward:17,mobileNumber:18,bindMobileAward:19,downloadApkAward:20,superVipAward:21,weekFundAwardId:22,dailyRechargeNums:23,dailyRechargeAwardNums:24,rechargeRebate:25,levelFundAward:26},GuildCopyOperateData:{commonData:1,copyId:2,rankInfo:3,mosterInfo:4,awardCount:5,totalDamage:6,rank:7,modifyAwardCount:8,modifyCopyAwardCount:9,guildCopyMaxDmg:10},ActivityListData:{id:1,startTime:2,endTime:3,rewardTime:4},ActivityInfoData:{id:1,condCount:2,rewardCount:3,condValue:4,rewardInfo:5,otherInfo:6},ActivityOperateData:{commonData:1,activityList:2,activityAllInfo:3,activityId:4,activityInfo:5,modifyCondCount:6,modifyRewardCount:7,modifyCondInfo:8,sevendayAwardCount:9,sevendayExtraAward:10,shareNumToday:11,shareNumTotal:12,doneShares:13,summonScore:14,doneSummonChests:15,summonRankList:16,mySummonRank:17,grpBuyTodayNums:18,grpBuyTotalNums:19,doneOpenGifts:20,rechargePlayerNum:21,openSvrGroupBuyAward:22},RechargeOperateData:{commonData:1,vipLevel:2,rechargeSum:3,diamond:4,monthCardEndTime:5,lifelongCard:6,goodsRechargeCount:7,dailyRechargeNums:8,rechargeGoodsIds:9,dailyRechargeSum:10,firstRechargeTime:11,superVip:12,weekFund:13,orderInfo:14,doneOpenGifts:15,openSvrGiftAwardNums:16,dayRechargeLimit:17,weekRechargeLimit:18,monthRechargeLimit:19,openSvrRechargeSum:20,vipScore:21,buyLevelFund:22},RankOperateData:{commonData:1,myRank:2,rankList:3,modifyWorshipInfo:4,forceRankList:5,rankValue:6,godInfo:7,topRankList:8},ChallengerInfo:{name:1,level:2,sex:3,force:4,lineupInfo:5,hpInfo:6},ExpeditionOperateData:{commonData:1,modifySelfHpInfo:2,challengerInfo:3,expeditionId:4,modifyRewardInfo:5},NoticeOperateData:{list:1,newsList:2},QueryOperateData:{name:1,force:2,head:3,level:4,guildName:5,lineupInfo:6,headFrame:7},WorldBossInfo:{bossId:1,bossHp:2,bossReviveTime:3,bossRankNum:4},WorldBossRankInfo:{playerId:1,value:2,playerLevel:3,head:4,playerName:5,headFrame:6},WorldBossBattleInfo:{myRank:1,totalDamage:2},WorldBossRecordInfo:{name:1,damage:2},WorldBossOperateData:{commonData:1,WorldBossInfo:2,WorldBossRankList:3,WorldBossBattleInfo:4,myRank:5,rankValue:6,bossRecords:7,damageRankInfo:8},ArtifactInfo:{id:1},ArtifactOperateData:{commonData:1,lineupArtifactInfo:2,tmpBaptizeAttrs:3,artifactSkillLv:4,artifactStrengthLv:5,artifactBaptizeLv:6,artifactBaptizeExp:7,artifactStarLv:8,artifactStarExp:9,artifactBaptizeAttrs:10,artifactInfo:11},EscortListInfo:{playerId:1,name:2,tradeId:3,endTime:4,force:5},TargetEscortInfo:{guildName:1,robCount:2,multiple:3,lineupInfo:4,force:5,head:6,level:7,headFrame:8},EscortInfo:{tradeId:1,endTime:2,robCount:3,multiple:4},EscortRecordInfo:{recordTime:1,name:2,recordType:3,tradeId:4,multiple:5},EscortOperateData:{commonData:1,escortList:2,escortInfo:3,targetInfo:4,recordList:5,escortTradeId:6,addEscort:7,delEscort:8},GuildSkillOperateData:{commonData:1,modifyGuildSkillInfo:2,clearGuildSkillInfo:3},MineListInfo:{mineIndex:1,mineId:2,mineType:3,playerId:4,playerName:5,force:6},MineInfo:{playerId:1,playerName:2,force:3,guildName:4,lineupInfo:5,occupyTime:6,profitInfo:7,robCount:8,startTime:9,head:10,level:11,headFrame:12},MineRecordInfo:{recordId:1,recordTime:2,name:3,recordType:4,mineType:5,rewardInfo:6,state:7},MyMineInfo:{islandId:1,mineId:2,mineType:3},MineOperateData:{commonData:1,myInfo:2,mineList:3,mineInfo:4,recordList:5,grabList:6,updateRecordState:7},ForestOperateData:{commonData:1,forestMaxFloor:2,doneForestChests:3},AdventureInfo:{templateId:1,endTime:2,races:3,godIds:4},AdventureOperateData:{commonData:1,acceptableList:2,targetAdvt:3,delIdx:4,delAdvtKey:5},GuildWarMemberInfo:{head:1,level:2,name:3,score:4,force:5,atkCount:6,lifeNum:7,integral:8,lineupInfo:9,hpInfo:10,headFrame:11},GuildWarBaseInfo:{guildId:1,guildHead:2,guildLevel:3,guildName:4,dailyScore:5,totalScore:6,totalForce:7,guildGrade:8,memberInfo:9},GuildWarRankInfo:{guildId:1,guildHead:2,guildLevel:3,guildName:4,score:5,force:6},GuildWarBoxInfo:{num:1,name:2},GuildWarMemberRankInfo:{playerId:1,head:2,level:3,name:4,score:5,force:6,headFrame:7},GuildWarSessionRankInfo:{guildRank:1,guildHead:2,guildLevel:3,guildName:4,serverName:5,presidentName:6,totalForce:7},GuildWarOperateData:{commonData:1,session:2,endTime:3,regTime:4,maxGuildGrade:5,matchType:6,targetInfo:7,myInfo:8,groupList:9,guildGrade:10,upGradeType:11,myRank:12,gradeList:13,rankValue:14,modifyBoxAwardCount:15,modifyBoxList:16,boxList:17,memberRankList:18,sessionRankList:19},LuckOperateData:{commonData:1,luckGodIds:2,luckGodNum:3,luckEquipIds:4,luckEquipNum:5,luckArtIds:6,luckEquipAward:7,luckGodRecord:8,luckEquipRecord:9,luckTreasureIds:10,luckTreasureNum:11,luckTreasureRecord:12},HonourWarInfo:{session:1,endTime:2,stage:3,stageTime:4},HonourListInfo:{recordId:1,stage:2,groupId:3,round:4,pos:5,winner:6,betId:7,leftId:8,leftName:9,leftForce:10,leftHead:11,leftLevel:12,rightId:13,rightName:14,rightForce:15,rightHead:16,rightLevel:17,session:18,leftHeadFrame:19,rightHeadFrame:20},HonourPlayerInfo:{guildName:1,lineupInfo:2},HonourBaseInfo:{name:1,force:2,head:3,sex:4,level:5,stage:6,pos:7,headFrame:8},HonourOperateData:{commonData:1,honourInfo:2,rankList:3,regTime:4,matchList:5,battleInfo:6,myList:7,stageList:8,betId:9,playerInfo:10,playerPos:11,baseInfo:12,winPos:13,warInfo:14,betInfo:15},GroupListInfo:{groupId:1,name:2,head:3,level:4,guildName:5,memberNum:6,force:7,headFrame:8},GroupInfo:{groupId:1,godDmScore:2,myRank:3,rewardAdd:4,autoJoin:5,regTime:6},GroupMemberInfo:{playerId:1,pos:2,job:3,state:4,readyTime:5,name:6,force:7,guildName:8,godId:9,rewardCount:10,isRobot:11,awakenLv:12,skinId:13},InviteListInfo:{playerId:1,name:2,head:3,level:4,guildName:5,force:6,inviteTime:7,headFrame:8},InviteInfo:{playerId:1,name:2},GroupMvpInfo:{name:1,head:2,level:3,force:4,headFrame:5},GroupOperateData:{commonData:1,groupList:2,myGroup:3,memberList:4,autoJoin:5,setPos:6,appointId:7,delMemberId:8,inviteList:9,inviteId:10,acceptInviteId:11,refuseInviteId:12,setState:13,readyTime:14,oneKeyInviteCd:15,matchTime:16,inviteInfo:17,setInvite:18,refuseInviteList:19,regTime:20,battleReport:21,winCamp:22,leftInfo:23,rightInfo:24,itemData:25,waveResults:26,mvpInfo:27,rewardAddInfo:28,scoreInfo:29},RechargeOrderData:{open_id:1,total_fee:2,game_orderno:3,subject:4,notify_url:5,timestamp:6,game_area:7,game_group:8,game_level:9,game_role_id:10},RiskInfo:{riskId:1,limitTime:2,questId:3},RiskOperateData:{commonData:1,curRiskId:2,riskIds:3,diceNum:4,clearQuestIds:5,winType:6,addRiskInfo:7,delRiskKey:8},GemstoneInfo:{templateId:1,num:2,godId:3},GemstoneOperateData:{commonData:1},ApiOperateData:{commonData:1},GuildHelpInfo:{helpId:1,helpPos:2,helpType:3,playerId:4,helpNum:5,getNum:6,name:7,head:8,level:9,headFrame:10},GuildHelpOperateData:{commonData:1,addGuildHelp:2,guildHelpList:3,guildHelpInfo:4,guildHelpEndTime:5},FriendHelpInfo:{helpId:1,playerId:2,name:3,godInfo:4,isHire:5},FriendHelpOperateData:{commonData:1,addFriendHelp:2,friendHelpList:3,addFriendHelpList:4,addHelpGodId:5},GroupCopyApplyListInfo:{playerId:1,name:2,force:3,lineupInfo:4},GroupCopyMemberListInfo:{pos:1,head:2,headFrame:3,level:4},GroupCopyListInfo:{groupId:1,name:2,force:3,copyFloor:4,isApply:5,memberInfo:6},GroupCopyInfo:{groupCopyId:1,groupCopyFloor:2,captainCopyFloor:3},GroupCopyMemberInfo:{playerId:1,pos:2,job:3,name:4,force:5,lineupInfo:6,copyFloor:7,head:8,headFrame:9,level:10},GroupCopyInviteListInfo:{playerId:1,name:2,isInvite:3,force:4,lineupInfo:5,logoutTime:6},GroupCopyReportMemberInfo:{pos:1,job:2,name:3,head:4,headFrame:5,level:6,force:7,lineupInfo:8},GroupCopyOperateData:{commonData:1,groupList:2,myGroup:3,memberList:4,setPos:5,appointId:6,delMemberId:7,inviteList:8,inviteId:9,acceptInviteId:10,refuseInviteId:11,dismissTime:12,inviteInfo:13,setInvite:14,refuseInviteList:15,battleReport:16,applyList:17,delApplyList:18,winCamp:19,itemData:20,addChapterAward:21,memberInfo:22,copyFloor:23}},t.dsRule={BagEntity:{equips:"EquipInfo",timeItems:"TimeItemInfo",treasures:"TreasureInfo",gemstones:"GemstoneInfo",__valueChangeMap:{equips:!0,timeItems:!0,treasures:!0,gemstones:!0}},ExtendEntity:{artifactInfo:"ArtifactInfo",__valueChangeMap:{artifactInfo:!0}},TaskEntity:{curTasks:"TaskInfo",dailyTasks:"DailyInfo",advanceInfos:"AdvanceInfo",warriorWeekTasks:"WairrorInfo",warriorMonthTasks:"WairrorInfo",__valueChangeMap:{curTasks:!0,dailyTasks:!0,advanceInfos:!0,warriorWeekTasks:!0,warriorMonthTasks:!0}},GodEntity:{gods:"GodInfo",__valueChangeMap:{gods:!0}},WelfareEntity:{sevendayInfo:"SevendayInfo",riskInfo:"RiskInfo",__valueChangeMap:{sevendayInfo:!0,riskInfo:!0}},AdventureEntity:{acceptableList:"AdventureInfo",advts:"AdventureInfo",__valueChangeMap:{acceptableList:!0,advts:!0}},CopyEntity:{friendHelpList:"FriendHelpData",__valueChangeMap:{friendHelpList:!0}},EntryData:{player:"PlayerEntity"},PlayerData:{base:"PlayerEntity",extend:"ExtendEntity",bag:"BagEntity",god:"GodEntity",currency:"CurrencyEntity",tasks:"TaskEntity",welfare:"WelfareEntity",copy:"CopyEntity",adventure:"AdventureEntity",friend:"FriendEntity"},EnterGameData:{curPlayer:"PlayerData",offlineEarn:"OfflineEarnInfo"},CommonData:{addGods:"GodInfo",addEquips:"EquipInfo",addTimeItems:"TimeItemInfo",modifyTasks:"TaskInfo",modifyDailys:"DailyInfo",addTreasures:"TreasureInfo",delTreasures:"TreasureInfo",addGemstones:"GemstoneInfo",delGemstones:"GemstoneInfo",__valueChangeMap:{addGods:!0,addEquips:!0,addTimeItems:!0,modifyTasks:!0,modifyDailys:!0,addTreasures:!0,delTreasures:!0,addGemstones:!0,delGemstones:!0}},CommonOperateData:{commonData:"CommonData",dailyTasks:"DailyInfo",warriorWeekTasks:"WairrorInfo",warriorMonthTasks:"WairrorInfo",__valueChangeMap:{dailyTasks:!0,warriorWeekTasks:!0,warriorMonthTasks:!0}},GodOperateData:{commonData:"CommonData",targetGod:"GodInfo",__valueChangeMap:{targetGod:!0}},ItemOperateData:{commonData:"CommonData"},EquipOperateData:{commonData:"CommonData",targetEquips:"EquipInfo",__valueChangeMap:{targetEquips:!0}},TreasureOperateData:{commonData:"CommonData",targetTreasure:"TreasureInfo",__valueChangeMap:{targetTreasure:!0}},CopyOperateData:{commonData:"CommonData",firstData:"CommonData"},TaskOperateData:{commonData:"CommonData"},FriendOperateData:{commonData:"CommonData",friendList:"FriendData",requestList:"ApplyPlayerData",recommondList:"RecommendData",targetData:"RecommendData",addfriend:"FriendData",addfriendList:"FriendData"},MailOperateData:{commonData:"CommonData",mailList:"MailData",addMail:"MailData"},PointOperateData:{commonData:"CommonData"},ArenaOperateData:{commonData:"CommonData",clgList:"ClgListInfo",battleRecords:"ArenaRecordInfo",rankList:"RankListInfo",battleReport:"ReportInfo",__valueChangeMap:{clgList:!0,battleRecords:!0,rankList:!0}},ReportInfo:{reportData:"ReportData",__valueChangeMap:{reportData:!0}},MatchOperateData:{commonData:"CommonData",clgList:"MatchClgListInfo",battleRecords:"MatchRecordInfo",worldRankList:"MatchRankListInfo",localRankList:"MatchRankListInfo",battleReport:"ReportInfo",battleEndInfo:"MatchEndInfo",__valueChangeMap:{clgList:!0,battleRecords:!0,worldRankList:!0,localRankList:!0}},MarketOperateData:{commonData:"CommonData",marketList:"MarketData"},ShopOperateData:{commonData:"CommonData",shopList:"ShopData"},GuildOperateData:{commonData:"CommonData",guildList:"GuildData",applyList:"GuildApplyData",memberList:"GuildMemberData",addGuild:"GuildInfo",addMember:"GuildMemberData",updateMember:"GuildUpdateMemberInfo",addApply:"GuildApplyData",guildInfo:"GuildInfo",findList:"GuildData",levelRankList:"GuildLevelRankInfo",copyRankList:"GuildCopyRankInfo",addMemberList:"GuildMemberData"},ChatOperateData:{commonData:"CommonData",worldList:"ChatData",guildList:"ChatData",groupList:"ChatData",whisperList:"ChatData",crossList:"ChatData",provinceList:"ChatData"},GmOperateData:{commonData:"CommonData",battleReport:"ReportInfo"},WelfareOperateData:{commonData:"CommonData"},GuildCopyOperateData:{commonData:"CommonData"},ActivityOperateData:{commonData:"CommonData",activityList:"ActivityListData",activityAllInfo:"ActivityInfoData",activityInfo:"ActivityInfoData"},RankOperateData:{commonData:"CommonData"},ExpeditionOperateData:{commonData:"CommonData",challengerInfo:"ChallengerInfo"},WorldBossOperateData:{commonData:"CommonData",WorldBossInfo:"WorldBossInfo",WorldBossRankList:"WorldBossRankInfo",WorldBossBattleInfo:"WorldBossBattleInfo",bossRecords:"WorldBossRecordInfo",damageRankInfo:"WorldBossRankInfo"},ArtifactOperateData:{commonData:"CommonData",artifactInfo:"ArtifactInfo",__valueChangeMap:{artifactInfo:!0}},EscortOperateData:{commonData:"CommonData",escortList:"EscortListInfo",targetInfo:"TargetEscortInfo",escortInfo:"EscortInfo",recordList:"EscortRecordInfo",addEscort:"EscortListInfo"},GuildSkillOperateData:{commonData:"CommonData"},MineOperateData:{commonData:"CommonData",myInfo:"MyMineInfo",mineList:"MineListInfo",mineInfo:"MineInfo",recordList:"MineRecordInfo",grabList:"MineRecordInfo"},ForestOperateData:{commonData:"CommonData"},AdventureOperateData:{commonData:"CommonData"},GuildWarBaseInfo:{memberInfo:"GuildWarMemberInfo",__valueChangeMap:{memberInfo:!0}},GuildWarOperateData:{commonData:"CommonData",targetInfo:"GuildWarBaseInfo",myInfo:"GuildWarBaseInfo",groupList:"GuildWarRankInfo",gradeList:"GuildWarRankInfo",boxList:"GuildWarBoxInfo",modifyBoxList:"GuildWarBoxInfo",memberRankList:"GuildWarMemberRankInfo",sessionRankList:"GuildWarSessionRankInfo",__valueChangeMap:{modifyBoxList:!0}},LuckOperateData:{commonData:"CommonData"},HonourOperateData:{commonData:"CommonData",honourInfo:"HonourWarInfo",matchList:"HonourListInfo",myList:"HonourListInfo",stageList:"HonourListInfo",battleInfo:"ReportInfo",playerInfo:"HonourPlayerInfo",baseInfo:"HonourBaseInfo",warInfo:"HonourListInfo",__valueChangeMap:{baseInfo:!0}},GroupOperateData:{commonData:"CommonData",groupList:"GroupListInfo",myGroup:"GroupInfo",memberList:"GroupMemberInfo",inviteList:"InviteListInfo",inviteInfo:"InviteInfo",battleReport:"ReportInfo",mvpInfo:"GroupMvpInfo"},RechargeOperateData:{commonData:"CommonData",orderInfo:"RechargeOrderData"},RiskOperateData:{commonData:"CommonData",addRiskInfo:"RiskInfo",__valueChangeMap:{addRiskInfo:!0}},GemstoneOperateData:{commonData:"CommonData"},ApiOperateData:{commonData:"CommonData"},GuildHelpOperateData:{commonData:"CommonData",addGuildHelp:"GuildHelpInfo",guildHelpList:"GuildHelpInfo",guildHelpInfo:"GuildHelpInfo"},FriendHelpOperateData:{commonData:"CommonData",addFriendHelp:"FriendHelpInfo",friendHelpList:"FriendHelpInfo",addFriendHelpList:"FriendHelpData"},GroupCopyListInfo:{memberInfo:"GroupCopyMemberListInfo",__valueChangeMap:{memberInfo:!0}},GroupCopyOperateData:{commonData:"CommonData",groupList:"GroupCopyListInfo",myGroup:"GroupCopyInfo",memberList:"GroupCopyMemberInfo",inviteList:"GroupCopyInviteListInfo",inviteInfo:"InviteInfo",battleReport:"ReportInfo",applyList:"GroupCopyApplyListInfo",memberInfo:"GroupCopyReportMemberInfo"}}}(iface=iface||{});var HttpQueueMgr=function(){function n(){}return n.push=function(t){this._httpWaitList.push(t),this.update()},n.update=function(){var t=this._curHttpList.length;if(0<=t)for(var e=t-1;0<=e;e--){this._curHttpList[e].isDone()&&this._curHttpList.splice(e,1)}if((t=this._curHttpList.length)<n.MAX_HTTP_COUNT&&0<this._httpWaitList.length){var i=this._httpWaitList.shift();i&&(this._curHttpList.push(i),i.nativesend())}},n.clear=function(){this._httpWaitList.length=0,this._curHttpList.length=0},n.MAX_HTTP_COUNT=3,n._httpWaitList=[],n._curHttpList=[],n}(),GameMsgHandler=function(){function t(){}return t.init=function(){var t=PLC.getInstance();t.on("onMove",function(t){t.path;logdebug("onMove:[%j]",t.path)}),t.on("onRemoveItem",function(t){logdebug("onRemoveItem:[%j]",t)}),t.on("onPickItem",function(t){logdebug("onPickItem:[%j]",t)}),t.on("onNPCTalk",function(t){logdebug("onNPCTalk:[%j]",t)}),t.on("onAttack",function(t){logdebug("onAttack:[%j]",t)}),t.on("onRevive",function(t){logdebug("onRevive:[%j]",t)})},t}();!function(t){var e=(i.prototype.addUseNum=function(){var t=tb.TB_skill.get_TB_skillById(this.skillId);if((t?t.type:null)===iface.tb_prop.skillTypeKey.passive)return this.useNum++},i.prototype.checkUseNum=function(){return this.useNum<this.useNumMax},i.prototype.getTargetIds=function(){for(var t=[],e=0;e<this.targets.length;e++)t.push(this.targets[e].getObjId());return t},i.prototype.genSkillTargets=function(t,e,i){if(!this.checkUseNum())return logfight("checkUseNum fail %s",this.skillId),!1;var n,o=this.targets=[];if(this.targetType==iface.tb_prop.targetTypeKey.sameMainTag)return this.targets=t.getMainTargets(),this.targets&&0<this.targets.length;if(!t.isPassive()&&-1==this._selectKeys.indexOf(this.targetType)){var a=e.getStBackTarget();if(a)this.targets.push(a),n=a;else{var r=e.getSneerTarget();r&&(this.targets.push(r),n=r)}}var s=this.targetNum;switch(n&&s--,this.targetType){case iface.tb_prop.targetTypeKey.enemyMinHp:pushMinHpTarget(o,e.getEnemyObjs(),s,[n]);break;case iface.tb_prop.targetTypeKey.enemyRandom:pushRandomTarget(o,e.getEnemyObjs(),s,[n]);break;case iface.tb_prop.targetTypeKey.ownMinHp:pushMinHpTarget(o,e.getOwnObjs(),s,[n]);break;case iface.tb_prop.targetTypeKey.ownRandom:pushRandomTarget(o,e.getOwnObjs(),s,[n]);break;case iface.tb_prop.targetTypeKey.ownRanNotSelf:pushRandomTarget(o,e.getOwnObjs(),s,[n,e]);break;case iface.tb_prop.targetTypeKey.self:0<s&&-1==o.indexOf(e)&&o.push(e);break;case iface.tb_prop.targetTypeKey.ownDead:pushDeadTarget(o,e.getOwnObjs(),s,[n]);break;case iface.tb_prop.targetTypeKey.ownDeadOrSelf:pushDeadTarget(o,e.getOwnObjs(),s,[n]),o.length<=0&&o.push(e);break;case iface.tb_prop.targetTypeKey.external:i&&-1==o.indexOf(i)&&o.push(i);break;case iface.tb_prop.targetTypeKey.tagOne:pushOrderTarget(o,e.getEnemyObjs(),s,[n]);break;case iface.tb_prop.targetTypeKey.frontRow:case iface.tb_prop.targetTypeKey.backRow:var u=e.getEnemyRowObjsByAlive(this.targetType==iface.tb_prop.targetTypeKey.frontRow?1:2);isEmptyObject(u)&&(u=e.getEnemyRowObjsByAlive(this.targetType==iface.tb_prop.targetTypeKey.frontRow?2:1)),pushRandomTarget(o,u,s,[n]);break;case iface.tb_prop.targetTypeKey.ownAtkMax:pushAtkMaxTarget(o,e.getOwnObjs(),s,[n,e]);break;case iface.tb_prop.targetTypeKey.ownDeadOrHpLow:pushDeadTarget(o,e.getOwnObjs(),s,[n]),o.length<=0&&pushMinHpTarget(o,e.getOwnObjs(),s,[n]);break;case iface.tb_prop.targetTypeKey.allTag:o=convertMapValueToArr(e.getOwnObjs());break;case iface.tb_prop.targetTypeKey.frontAndRandomBack:var h=e.getEnemyRowObjs(1);pushOrderTarget(o,h,s,[n]),0<s-o.length&&pushRandomTarget(o,h=e.getEnemyRowObjs(2),s-o.length,[n])}return o.length<=0?(logfight("no target! targetType %d skillId %d",this.targetType,this.skillId),!1):(this.targets=o,!0)},i.prototype.clearTmpAmend=function(){if(this.checkUseNum())for(var t=0;t<this.targets.length;t++)this.targets[t].clearTmpAmend(this.skillId)},i.prototype.calEffectHits=function(t,e){this.effectHits={};for(var i=0;i<this.targets.length;i++){var n=this.targets[i],o=!0;if(!e&&!t.isSameCamp(n)){logfight("%d 命中率 %s ,%d 抵抗率 %s",t.getObjId(),t.getAttr(iface.tb_prop.attrTypeKey.effectHit,n.getObjId()),n.getObjId(),n.getAttr(iface.tb_prop.attrTypeKey.effectResist,t.getObjId()));var a=Math.max(Math.max((1+t.getAttr(iface.tb_prop.attrTypeKey.effectHit,n.getObjId()))/(1+n.getAttr(iface.tb_prop.attrTypeKey.effectResist,t.getObjId())),1),1);o=Math.random()<a}this.effectHits[i]=o}},i.prototype.doEffects=function(t,e,i,n,o){if(this.checkUseNum())for(var a=0;a<this.triggerTypes.length;a++){var r=this.triggerTypes[a]||0,s=this.triggerSubTypes[a]||0,u=this.triggerParams[a]||0,h=this.triggerProbs[a]||0,l=this.effects[a]||[];l.length<=0||r!==e||this.doEffectsOnTargets(t,i,r,s,u,h,l,n,o)}},i.prototype.canTriggerSkillEff=function(t){for(var e=!1,i=0;i<this.triggerTypes.length;i++)if((this.triggerTypes[i]||0)===t){e=!0;break}return e},i.prototype.doEffectsOnTargets=function(t,e,i,n,o,a,r,s,u){for(var h=0,l=0;l<this.targets.length;l++){var c=this.targets[l];if(this.checkTrigger(e,c,n,o,u)&&(logfight("效果触发实际概率：%s",h=a*this.modifyProb(e,c,r)),!(utils.random(1,100)>h))){t.eftAnyObj=!0,t.eftObj[this.subSkillId]=1;var p=this.getSpeEftId(e,c,i,o,r,l);0<p?(logfight("speEftId %s %s",p,this.skillId),doOneEffect(t,e,c,p,this.skillId,this.effectHits[l],!1,u)):doEffects(t,e,c,r,this.skillId,this.effectHits[l],!1,u)}}},i.prototype.modifyProb=function(t,e,i){if(!i||i.length<=0)return 1;var n=1,o=i[0],a=tb.TB_effect.get_TB_effectById(o);if(a&&a.type==iface.tb_prop.effectTypeKey.addBuff){var r=tb.TB_buff.get_TB_buffById(a.effect_value);if(r&&r.type==iface.tb_prop.buffTypeKey.dizzy){var s=1+(t.isArtifact()?0:t.getAttr(iface.tb_prop.attrTypeKey.dizzy,e.getObjId()))-(e.isArtifact()?0:e.getAttr(iface.tb_prop.attrTypeKey.immuDizzy,t.getObjId()));logfight("晕眩概率系数修正为：%s",n*=Math.max(s,.1))}}return n},i.prototype.checkTrigger=function(t,e,i,n,o){if(t.isArtifact())return!0;if(e.isArtifact())return!1;switch(i){case iface.tb_prop.trigSubTypeKey.selfHpLess:return t.hp/t.hpMax<n/100;case iface.tb_prop.trigSubTypeKey.selfAndEnemyHp:var a=t.hp/t.hpMax,r=e.hp/e.hpMax;return-1===n?r<a:1===n?a<r:r===a;case iface.tb_prop.trigSubTypeKey.existBuffId:return e.hasBuffById(n);case iface.tb_prop.trigSubTypeKey.existBuffType:return e.hasBuff(n);case iface.tb_prop.trigSubTypeKey.existBuffStatType:return e.hasBuffByStatType(n);case iface.tb_prop.trigSubTypeKey.enemyHpUp:return n/100<(r=e.hp/e.hpMax);case iface.tb_prop.trigSubTypeKey.filterProfession:return e.profession==n;case iface.tb_prop.trigSubTypeKey.filterBuff:return!(!o||!o.tempBuff)&&(o.tempBuff==n&&e.hasBuffById(n))}return!0},i.prototype.getSpeEftId=function(t,e,i,n,o,a){var r=0;return this.targetType===iface.tb_prop.targetTypeKey.ownDeadOrSelf&&logfight("ownDeadOrSelf %s %s",r=t.getObjId()===e.getObjId()?o[1]||0:o[0]||0,a),this.targetType===iface.tb_prop.targetTypeKey.ownDeadOrHpLow&&logfight("ownDeadOrHpLow %s %s",r=e.isAlive()?o[1]||0:o[0]||0,a),i!==iface.tb_prop.triggerTypeKey.useSkill&&i!==iface.tb_prop.triggerTypeKey.crit||999!==n||logfight("eft dispersive %s %s",r=o[a]||0,a),i===iface.tb_prop.triggerTypeKey.inScene&&(r=t.isAlive()?o[0]||0:o[1]||0,logfight("inScene 在场时触发 ,目标状态 %s ,buffid %s %s",t.isAlive(),r,a)),r},i.prototype.targetDamageOpt=function(t,e,i){if(!(this.targetExtraDmg.length<=0)){logfight("此技能只有固定伤害");for(var n=0;n<this.targets.length;n++){var o=this.targets[n],a=this.getExtDamage(t,o);0<a&&(doHitObj(t,o,{value:a},e,i,!1,!0),e.hasFixedVal=!0)}}},i.prototype.doDamage=function(t,e,i){if(this.checkUseNum()){for(var n=0;n<this.targets.length;n++)e.doPasvSkill(iface.tb_prop.triggerTypeKey.useSkill,this.targets[n],i);if(this.damage<=0&&this.damageFixed<=0)this.targetDamageOpt(e,t,i);else{var o=!1;e.onAtkObj(this.skillId,this.targets);for(var a=0;a<this.targets.length;a++){var r=this.targets[a];e.doBuffTrigger(iface.tb_prop.buffTrigTypeKey.atkEqualBuffCaster,{tag:r},this.skillId),this.doDamageOnTarget(t,e,r,this.effectHits[a]),o=this.effectHits[a]||o}if(1==this.mainSkill){var s=tb.TB_skill_set.getSkillSet().anger_effect[0];if(t.critAnyEnemy&&(logfight("暴击了"),s=tb.TB_skill_set.getSkillSet().anger_effect[1]),o||(logfight("闪避了"),s=tb.TB_skill_set.getSkillSet().anger_effect[2]),!e.scene.isBackAtk){e.setAnger(e.anger+s[0],i);for(var u=0;u<this.targets.length;u++){var h=this.targets[u];h.setAnger(h.anger+s[1],i)}}}}}},i.prototype.getExtDamage=function(t,e){var i=0;if(0<this.targetExtraDmg.length&&this.targetExtraDmg[0]&&(i=this.doExtDamage(this.targetExtraDmg[0],t,e),this.targetExtraDmg[1])){var n=this.doExtDamage(this.targetExtraDmg[1],t,e);i=Math.min(n,i)}return i},i.prototype.doExtDamage=function(t,e,i){if(!t||t.length<4)return logerror("subskill target_damage error:",this.subSkillId),0;var n=0,o=1==t[0]?e:i,a=t[1],r=t[3]/100;return 2==t[2]?n=o.getAttr(a,i.getObjId())*r:1==a&&(n=o.hpMax*r),n},i.prototype.doDamageOnTarget=function(t,e,i,n){logfight("atker %f%f target %f%f skillId %f, damage %f damageFixed %f",e.camp,e.idx,i.camp,i.idx,this.skillId,this.damage,this.damageFixed),i.onBeAtk(e,this.skillId);var o=n?1:.7,a=e.getAttr(iface.tb_prop.attrTypeKey.atk,i.getObjId()),r=e.getAttr(iface.tb_prop.attrTypeKey.crit,i.getObjId()),s=e.getAttr(iface.tb_prop.attrTypeKey.critDmg,i.getObjId()),u=i.getAttr(iface.tb_prop.attrTypeKey.def,e.getObjId()),h=i.getAttr(iface.tb_prop.attrTypeKey.dmgRate,e.getObjId()),l=i.getAttr(iface.tb_prop.attrTypeKey.subDmg,e.getObjId()),c=e.getAttr(iface.tb_prop.attrTypeKey.addDmg,i.getObjId()),p=i.isBeCrit()||n&&Math.random()<r;p&&(e.onCritObj(t,this.skillId,this.subSkillId),i.onBeCrit(e,this.skillId),t.critAnyEnemy=!0);var d=p?s:1,_=utils.random(90,110)/100,f=getRaceDmgRate(e.race,i.race),g=a*this.damage/100-u;logfight("基础伤害 = (atker.atk(%f) * this.damage(%f) / 100 - target.def(%f))",a,this.damage,u);var y=this.getExtDamage(e,i),m=Math.max(g,.1*a)*h*o*d*_*f*Math.max(1+c-l,.1);if(logfight("Math.max(dmg(%f), 0.1 * atker.atk(%f)) * target.dmgRate(%f)  * hitFactor(%f) * critFactor(%f) * floatFactor(%f) * raceFactor(%f) * Math.max(1 + atker.addDmg(%f) - target.delDmg(%f), 0.1)",g,a,h,o,d,_,f,c,l),e.scene.defType===iface.tb_prop.battleObjTypeKey.god){var v=tb.TB_game_set.get_TB_game_setById(1).pvp_para;m*=v,logfight("pvp战斗系数 %s",v)}logfight("固定值加成  dmgValue(%f) += this.damageFixed(%f) + extraDmg(%f) ",m=m+this.damageFixed+y,this.damageFixed,y),doHitObj(e,i,{value:m},t,this.skillId,p,!0,!0),this.doDmgSputter(e,i,m,t)},i.prototype.doDmgSputter=function(t,e,i,n){if(!(this.damageSputter.length<=0)){var o=this.damageSputter[0],a=i*(this.damageSputter[1]/100),r=[];pushRandomTarget(r,e.getOwnObjs(),o,[e]);for(var s=0;s<r.length;s++)doHitObj(t,r[s],{value:a},n,this.skillId)}},i.prototype.hasRebornEffect=function(){for(var t=0;t<this.effects.length;t++)for(var e=this.effects[t],i=0;i<e.length;i++){var n=tb.TB_effect.get_TB_effectById(e[i]);if(n&&n.type==iface.tb_prop.effectTypeKey.reborn)return!0}return!1},i);function i(t,e){this._selectKeys=[iface.tb_prop.targetTypeKey.ownMinHp,iface.tb_prop.targetTypeKey.ownRandom,iface.tb_prop.targetTypeKey.self,iface.tb_prop.targetTypeKey.ownDead,iface.tb_prop.targetTypeKey.ownDeadOrSelf,iface.tb_prop.targetTypeKey.ownRanNotSelf,iface.tb_prop.targetTypeKey.ownAtkMax,iface.tb_prop.targetTypeKey.ownDeadOrHpLow];var i=tb.TB_sub_skill.get_TB_sub_skillById(e);i?(this.skillId=t,this.subSkillId=e,this.tplt=i,this.mainSkill=i.main_skill,this.targetType=i.casting_target,this.targetNum=i.target_limit,this.damage=i.damage||0,this.damageFixed=i.damage_fixed||0,this.targetExtraDmg=i.target_damage||[],this.damageSputter=i.damage_sputter||[],this.triggerTypes=i.trigger_type||[],this.triggerSubTypes=i.trigger_subtype||[],this.triggerParams=i.trigger_param||[],this.triggerProbs=i.trigger_prob||[],this.effects=i.effects||[],this.useNumMax=i.trigger_count,this.useNum=0,this.targets=[],this.effectHits={}):logfight("tb_sub_skill %d is null",e)}t.SubSkillData=e}(battle=battle||{}),function(o){var t=(e.prototype.initSubSkills=function(t){if(!t||t.length<=0)return null;for(var e=0;e<t.length;e++){var i=t[e],n=new o.SubSkillData(this.skillId,i);this.subSkills[i]=n}},e.prototype.isPassive=function(){return this.type===iface.tb_prop.skillTypeKey.passive},e.prototype.isAnger=function(){return this.type===iface.tb_prop.skillTypeKey.anger},e.prototype.getMainTargetType=function(){for(var t in this.subSkills){var e=this.subSkills[t];if(e.mainSkill)return e.targetType}return 0},e.prototype.hasEnemyTarget=function(){for(var t in this.subSkills){var e=this.subSkills[t];if(e.targetType===iface.tb_prop.targetTypeKey.enemyMinHp||e.targetType===iface.tb_prop.targetTypeKey.enemyRandom)return!0}return!1},e.prototype.hasRebornInSubSkill=function(){var t;for(t in this.subSkills)if(this.subSkills[t].hasRebornEffect())return!0;return!1},e.prototype.getMainTargetIds=function(){var t,e;for(t in this.subSkills)if(1==(e=this.subSkills[t]).mainSkill)return e.getTargetIds();return[]},e.prototype.getMainTargets=function(){var t,e;for(t in this.subSkills)if(1==(e=this.subSkills[t]).mainSkill)return e.targets;return[]},e.prototype.cheakPassiveNoTrigger=function(t,e){return this.isPassive()&&!t.canTriggerSkillEff(e)},e.prototype.doSkill=function(t,e,i,n,o,a,r){var s,u,h;for(s in this.subSkills)u=this.subSkills[s],this.cheakPassiveNoTrigger(u,t)||u.genSkillTargets(this,e,i)&&(1!=u.mainSkill||h||(h=u.getTargetIds()));for(s in this.subSkills)u=this.subSkills[s],this.cheakPassiveNoTrigger(u,t)||u.calEffectHits(e,this.type==iface.tb_prop.skillTypeKey.passive);this.type==iface.tb_prop.skillTypeKey.initiative||this.type==iface.tb_prop.skillTypeKey.anger?this.doSkillLogic(t,e,i,n,o,a,h,r):this.doPavSkillLogic(t,e,i,n,o,a,h,r)},e.prototype.doPavSkillLogic=function(t,e,i,n,o,a,r,s){var u,h;for(u in this.subSkills)h=this.subSkills[u],this.cheakPassiveNoTrigger(h,t)||h.doEffects(a,t,e,o,s);for(u in this.subSkills)h=this.subSkills[u],a.eftObj?a.eftObj.hasOwnProperty(h.subSkillId)&&h.addUseNum():logerror("eftObj undefined");for(u in this.subSkills)h=this.subSkills[u],this.cheakPassiveNoTrigger(h,t)||h.targetDamageOpt(e,a,this.skillId);(a.eftAnyObj||a.hasFixedVal)&&e.recordTrigPasvSkill(this.skillId,o,r)},e.prototype.doSkillLogic=function(t,e,i,n,o,a,r,s){var u;for(u in logfight("----------------------释放技能",this.skillId,"目标集：",r,"-----------"),e.recordUseSkill(this.skillId,r,o),n&&(e.addSelfAnger(this.skillId),this.hasEnemyTarget()&&e.addEnemyAnger(this.skillId)),this.subSkills)this.subSkills[u].doEffects(a,t,e,o,s);for(u in this.subSkills)this.subSkills[u].doDamage(a,e,this.skillId);for(u in e.suckHp(a.totalDmg,this.skillId),this.subSkills)this.subSkills[u].clearTmpAmend();e.clearTmpAmend(this.skillId),a.critAnyEnemy&&e.onCritAnyEnemy(a,this.skillId,o),a.eftAnyObj&&e.onEftAnyObj(a,this.skillId,o)},e.prototype.useSkillFast=function(t,e,i){this.type==iface.tb_prop.skillTypeKey.initiative||this.type==iface.tb_prop.skillTypeKey.anger?this.doSkill(iface.tb_prop.triggerTypeKey.useSkill,t,null,!1,i,e):this.doSkill(0,t,t,!1,i,e)},e.prototype.useSkill=function(t,e,i,n){this.type!=iface.tb_prop.skillTypeKey.initiative&&this.type!=iface.tb_prop.skillTypeKey.anger||this.doSkill(iface.tb_prop.triggerTypeKey.useSkill,t,null,e,n,i)},e.prototype.doPasvSkill=function(t,e,i,n,o){this.type===iface.tb_prop.skillTypeKey.passive&&this.doSkill(t,e,i,!1,n,{totalDmg:0,robAtkBar:0,tagDmg:{},critAnyEnemy:!1,eftAnyObj:!1,eftObj:{},hasFixedVal:!1},o)},e.prototype.valueCompare=function(t,e,i){switch(i){case-1:return t<e;case 1:return e<=t}return!1},e);function e(t){var e=tb.TB_skill.get_TB_skillById(t);e?(this.skillId=t,this.type=e.type,this.subSkills={},this.initSubSkills(e.sub_skills)):logfight("tb_skill %d is null",t)}o.SkillData=t}(battle=battle||{}),function(t){var e=(i.prototype.getTargetIds=function(){for(var t=[],e=0;e<this.targets.length;e++)t.push(this.targets[e].getObjId());return t},i.prototype.genSkillTargets=function(t){var e=this.targets=[],i=this.targetNum;switch(this.targetType){case iface.tb_prop.targetTypeKey.enemyMinHp:pushMinHpTarget(e,t.getEnemyObjs(),i);break;case iface.tb_prop.targetTypeKey.enemyRandom:pushRandomTarget(e,t.getEnemyObjs(),i);break;case iface.tb_prop.targetTypeKey.ownMinHp:pushMinHpTarget(e,t.getOwnObjs(),i);break;case iface.tb_prop.targetTypeKey.ownRandom:pushRandomTarget(e,t.getOwnObjs(),i)}return!(e.length<=0&&(logfight("no target! targetType %d skillId %d",this.targetType,this.skillId),1))},i.prototype.clearTmpAmend=function(){for(var t=0;t<this.targets.length;t++)this.targets[t].clearTmpAmend(this.skillId)},i.prototype.doEffects=function(t){for(var e=0;e<this.triggerTypes.length;e++){var i=this.triggerTypes[e]||0,n=this.triggerSubTypes[e]||0,o=this.triggerParams[e]||0,a=this.triggerProbs[e]||0,r=this.effects[e]||[];r.length<=0||i!==iface.tb_prop.triggerTypeKey.useSkill||this.doEffectsOnTargets(t,n,o,a,r)}},i.prototype.doEffectsOnTargets=function(t,e,i,n,o){for(var a=0;a<this.targets.length;a++){var r=this.targets[a];!this.checkTrigger(r,e,i)||utils.random(1,100)>n||doEffects({},t,r,o,this.skillId,!0)}},i.prototype.checkTrigger=function(t,e,i){switch(e){case iface.tb_prop.trigSubTypeKey.selfHpLess:case iface.tb_prop.trigSubTypeKey.selfAndEnemyHp:return!1;case iface.tb_prop.trigSubTypeKey.existBuffId:return t.hasBuffById(i);case iface.tb_prop.trigSubTypeKey.existBuffType:return t.hasBuff(i);case iface.tb_prop.trigSubTypeKey.existBuffStatType:return t.hasBuffByStatType(i)}return!0},i.prototype.doDamage=function(t){if(!(this.damageFixed<=0))for(var e=0;e<this.targets.length;e++){var i=this.targets[e];this.doDamageOnTarget(t,i)}},i.prototype.doDamageOnTarget=function(t,e){logfight("artifact dmg target %d,%d skillId %d, damageFixed %d",e.camp,e.idx,this.skillId,this.damageFixed);var i=0;0<this.targetExtraDmg.length&&(i=this.getExtDamage(t,e)),doHitObj(t,e,{value:this.damageFixed+i},{totalDmg:0,robAtkBar:0,tagDmg:{},critAnyEnemy:!1,eftAnyObj:!1,eftObj:{},hasFixedVal:!1},this.skillId,!1,!1,!0)},i.prototype.getExtDamage=function(t,e){var i=0;if(0<this.targetExtraDmg.length&&this.targetExtraDmg[0]&&(i=this.doExtDamage(this.targetExtraDmg[0],t,e),this.targetExtraDmg[1])){var n=this.doExtDamage(this.targetExtraDmg[1],t,e);i=Math.min(n,i)}return i},i.prototype.doExtDamage=function(t,e,i){if(!t||t.length<4)return logerror("subskill target_damage error:",this.subSkillId),0;var n=0,o=i,a=t[1],r=t[3]/100;return 2==t[2]?n=o.getAttr(a,i.getObjId())*r:1==a&&(n=o.hpMax*r),n},i);function i(t,e){var i=tb.TB_sub_skill.get_TB_sub_skillById(e);i?(this.skillId=t,this.subSkillId=e,this.tplt=i,this.mainSkill=i.main_skill,this.targetType=i.casting_target,this.targetNum=i.target_limit,this.damageFixed=i.damage_fixed||0,this.targetExtraDmg=i.target_damage||[],this.triggerTypes=i.trigger_type||[],this.triggerSubTypes=i.trigger_subtype||[],this.triggerParams=i.trigger_param||[],this.triggerProbs=i.trigger_prob||[],this.effects=i.effects||[],this.targets=[]):logfight("tb_sub_skill %d is null",e)}t.AtftSubData=e}(battle=battle||{}),function(o){var t=(e.prototype.initSubSkills=function(t){if(!t||t.length<=0)return null;for(var e=0;e<t.length;e++){var i=t[e],n=new o.AtftSubData(this.skillId,i);this.subSkills[i]=n}},e.prototype.doSkillLogic=function(t){var e,i,n;for(e in this.subSkills)(i=this.subSkills[e]).genSkillTargets(t)&&(n=n||i.getTargetIds());for(e in t.recordUseSkill(this.skillId,n),this.subSkills)(i=this.subSkills[e]).doEffects(t);for(e in this.subSkills)(i=this.subSkills[e]).doDamage(t);for(e in this.subSkills)(i=this.subSkills[e]).clearTmpAmend()},e.prototype.getMainTargetIds=function(){var t,e;for(t in this.subSkills)if(1==(e=this.subSkills[t]).mainSkill)return e.getTargetIds();return[]},e.prototype.useSkill=function(t){this.type===iface.tb_prop.skillTypeKey.artifact&&this.doSkillLogic(t)},e);function e(t){var e=tb.TB_skill.get_TB_skillById(t);e?(this.skillId=t,this.type=e.type,this.subSkills={},this.initSubSkills(e.sub_skills)):logfight("tb_skill %d is null",t)}o.AtftSkillData=t}(battle=battle||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(i){var e,t=(e=i.BattleScene,__extends(n,e),n.prototype.calWinCamp=function(){if(this.type!==CopyType.glory)return i.BatteConsts.BATTLE_CAMPDEF;var t=this.getCampAllHp(i.BatteConsts.BATTLE_CAMPATK),e=this.getCampAllHp(i.BatteConsts.BATTLE_CAMPDEF);return t===e?utils.random(i.BatteConsts.BATTLE_CAMPATK,i.BatteConsts.BATTLE_CAMPDEF):e<t?i.BatteConsts.BATTLE_CAMPATK:i.BatteConsts.BATTLE_CAMPDEF},n.prototype.getCampAllHp=function(t){var e=this.campDatas[t];if(!e)return 0;var i=0,n=e.objs;for(var o in n)i+=n[o].hp;return i},n.prototype.atkBarRank=function(t,e){return t.getAtkBar()!==e.getAtkBar()?e.getAtkBar()-t.getAtkBar():t.atkSpd!==e.atkSpd?e.atkSpd-t.atkSpd:Math.random()<.5?-1:1},n);function n(t){return e.call(this,t)||this}i.BattleScenePvp=t}(battle=battle||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i=(e=t.BattleScene,__extends(n,e),n.prototype.atkBarRank=function(t,e){return t.getAtkBar()!==e.getAtkBar()?e.getAtkBar()-t.getAtkBar():t.atkSpd!==e.atkSpd?e.atkSpd-t.atkSpd:t.camp!==e.camp?t.camp-e.camp:t.idx-e.idx},n);function n(t){return e.call(this,t)||this}t.BattleScenePve=i}(battle=battle||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var r,e=(r=t.BattleObj,__extends(i,r),i.prototype.isImmuneCtrl=function(){return this._isImmuneCtrl},i.prototype.isImmunePoison=function(){return this._isImmunePoison},i);function i(t,e,i){var n=this,o=i[0],a=tb.TB_monster.get_TB_monsterById(o);if(a)return(n=r.call(this,t,e,i[3],a.attr_type,a.skill)||this).degree=999,n.awakenLv=999,n.starLev=999,n.skinId=0,n.uuid=i[7],n.type=iface.tb_prop.battleObjTypeKey.monster,n.templateId=o,n.race=a.race_type,n.level=a.level,n._isImmuneCtrl=a.is_immune,n._isImmunePoison=a.is_immune_poison,n;logfight("tb_monster %d is null",o)}t.BattleMonster=e}(battle=battle||{});var battle;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();function doEffects(t,e,i,n,o,a,r,s){void 0===r&&(r=!1);for(var u=0;u<n.length;u++){doOneEffect(t,e,i,n[u],o,a,r,s)}}function doOneEffect(t,e,i,n,o,a,r,s){void 0===r&&(r=!1),logfight("atker %d target %d skillId %d, effectId %d",e.getObjId(),i.getObjId(),o,n);var u=tb.TB_effect.get_TB_effectById(n);if(u){var h=u.type,l=u.type_param,c=l[0]||0,p=l[1]||0,d=u.effect_value,_=d/100;if(!e.isArtifact())switch(h){case iface.tb_prop.effectTypeKey.buffTransfer:1===c?e.transPositiveBuff(i,d,o):-1===c&&e.transNegativeBuff(i,d,o);break;case iface.tb_prop.effectTypeKey.balanceAttr:break;case iface.tb_prop.effectTypeKey.useSkillAgain:e.getRoundFlag=!0;break;case iface.tb_prop.effectTypeKey.immuDmg:i.isArtifact()||(i.immuneDmg=!0);break;case iface.tb_prop.effectTypeKey.reboundDmg:!i.isArtifact()&&s&&s.tagDmg&&s.tagDmg[e.getObjId()]&&(e.recordFlyText(iface.tb_prop.flyTextTypeKey.reboundDmg,!1,o),i.chgHpPer(e,-s.tagDmg[e.getObjId()]*_,r,o,!1));break;case iface.tb_prop.effectTypeKey.beAtked:e.scene.isBackAtk||!e.isAlive()||i.isArtifact()||(e.stBackTarget=i);break;case iface.tb_prop.effectTypeKey.casterAttr:e.modifyTmpAmend(c,p,_,o);break;case iface.tb_prop.effectTypeKey.casterAttrByTemp:e.modifyTagTmpAmend(i.getObjId(),c,p,_)}switch(h){case iface.tb_prop.effectTypeKey.attr:i.isArtifact()||i.modifyTmpAmend(c,p,_,o);break;case iface.tb_prop.effectTypeKey.addBuff:a&&!i.isArtifact()&&i.addBuff(d,e,o);break;case iface.tb_prop.effectTypeKey.reborn:i.isArtifact()||i.reborn(e,_,o);break;case iface.tb_prop.effectTypeKey.clearNegative:i.isArtifact()||i.rmBuffByStatType(iface.tb_prop.buffStatTypeKey.negative,d,o);break;case iface.tb_prop.effectTypeKey.chgHp:if(!i.isArtifact()){var f=i.hpMax;1==c?f=e.getAttr(iface.tb_prop.attrTypeKey.atk,i.getObjId()):2==c?f=e.hpMax:3==c&&(f=i.getAttr(iface.tb_prop.attrTypeKey.atk,i.getObjId()));var g=tb.TB_skill.get_TB_skillById(o);i.chgHpPer(e,f*_,r,o,!1,g.type!=iface.tb_prop.skillTypeKey.passive)}break;case iface.tb_prop.effectTypeKey.dmgFixByBuff:if(!i.isArtifact()){var y=1===c?iface.tb_prop.buffStatTypeKey.positive:iface.tb_prop.buffStatTypeKey.negative,m=i.getBuffNumByStatType(y);i.modifyTmpAmend(iface.tb_prop.attrTypeKey.dmgRate,iface.tb_prop.addAttrTypeKey.percentVal,_*m,o)}break;case iface.tb_prop.effectTypeKey.clearPositive:i.isArtifact()||i.rmBuffByStatType(iface.tb_prop.buffStatTypeKey.positive,d,o);break;case iface.tb_prop.effectTypeKey.changeAtkBar:i.isArtifact()||i.chgAnger(c,d,o);break;case iface.tb_prop.effectTypeKey.beCrit:i.isArtifact()||i.setBeCrit();break;case iface.tb_prop.effectTypeKey.clearBuff:i.isArtifact()||i.rmBuffById(d,o)}}else logfight("tb_effect[%s] is null",n)}function doHitObj(t,e,i,n,o,a,r,s){e.modifyDmg(i,o)&&(r?e.shareBuffTrigger(i,t,e,o,a,s):updateObjHp(t,e,-i.value,o,a,s),n.tagDmg[e.getObjId()]=i.value,n.totalDmg+=i.value)}function updateObjHp(t,e,i,n,o,a){e.updateHp(t,i,n,!1,o,a)}function pushRandomTarget(t,e,i,n){pushTarget(t,e,i,aliveFilter,godRandomSort,n)}function pushOrderTarget(t,e,i,n){pushTarget(t,e,i,aliveFilter,null,n)}function pushMinHpTarget(t,e,i,n){pushTarget(t,e,i,aliveFilter,godMinHpSort,n)}function pushAtkMaxTarget(t,e,i,n){pushTarget(t,e,i,aliveFilter,godMaxAtkSort,n)}function pushDeadTarget(t,e,i,n){pushTarget(t,e,i,deadFilter,godRandomSort,n)}function pushRecoverTarget(t,e,i,n){pushTarget(t,e,i,recoverFilter,godMinHpSort,n)}function pushDominantTarget(o,t,e){pushTarget(t,e,1,aliveFilter,function(t,e){var i=o.getRaceGrade(t),n=o.getRaceGrade(e);return i!==n?n-i:t.hp-e.hp})}function pushTarget(t,e,i,n,o,a){if(!(i<=0)){var r=convertMapValueToArr(e,n);if(0<r.length){o&&r.sort(o);for(var s=0;s<r.length&&0<i;s++)isInFilter(a,r[s])||(t.push(r[s]),i--)}}}function isInFilter(t,e){if(!t||t.length<=0||!e)return!1;for(var i=0;i<t.length;i++){var n=t[i];if(n&&n.getObjId()===e.getObjId())return!0}return!1}function aliveFilter(t){return t.isAlive()}function deadFilter(t){return!t.isAlive()}function recoverFilter(t){return!!t.isAlive()&&t.hp/t.hpMax<battle.BatteConsts.RECOVER_HP_PERCENT}function godMinHpSort(t,e){return t.hp/t.hpMax-e.hp/e.hpMax}function godMaxAtkSort(t,e){return e.getAttr(iface.tb_prop.attrTypeKey.atk)-t.getAttr(iface.tb_prop.attrTypeKey.atk)}function godRandomSort(t,e){return Math.random()<.5?-1:1}function getArtifactSkillId(t,e){return t*battle.BatteConsts.MAX_ARTIFACT_LEVEL+e}function getOppoCamp(t){return t===battle.BatteConsts.BATTLE_CAMPDEF?battle.BatteConsts.BATTLE_CAMPATK:battle.BatteConsts.BATTLE_CAMPDEF}function addPropertyMapValue(t,e,i){return(t=t||{})[e]=(t[e]?t[e]:0)+i,t}function getRaceGrade(t,e){return t<1||5<t||e<1||5<e?0:[[0,1,-1,0,0],[-1,0,1,0,0],[1,-1,0,0,0],[0,0,0,0,1],[0,0,0,1,0]][t-1][e-1]}function getRaceDmgRate(t,e){var i=getRaceGrade(t,e);return 1===i?1+tb.TB_god_set.get_TB_god_set().restrain_bonus[0]/100:-1===i?1+tb.TB_god_set.get_TB_god_set().restrain_bonus[1]/100:1}function getEvolutionIndex(t,e){return e>=tb.TB_god_set.get_TB_god_set().star_evolution?e:t}function getSkillList(t,e,i){var n=[];if(!t)return n;for(var o=getEvolutionIndex(e,i),a=tb.TB_god_evolution.get_TB_god_evolutionById(o),r=0;r<t.length;r++){var s=t[r];n.push([s[0]+a.evolution_effect[r]-1,s[1]])}return n}function modifyPasvAttr(t){for(var e,i,n,o,a,r,s,u={},h={},l=0;l<t.length;l++)if(e=t[l],i=tb.TB_skill.get_TB_skillById(e))for(var c=0;c<i.sub_skills.length;c++){var p=i.sub_skills[c];if(n=tb.TB_sub_skill.get_TB_sub_skillById(p))for(var d=0;d<n.trigger_type.length;d++)if(n.trigger_type[d]==iface.tb_prop.triggerTypeKey.addAtt)for(var _=0;_<n.effects[d].length;_++){var f=n.effects[d][_];r=(o=tb.TB_effect.get_TB_effectById(f)).type_param[0],a=o.type_param[1]||iface.tb_prop.addAttrTypeKey.fixedVal,s=o.effect_value/100,a==iface.tb_prop.addAttrTypeKey.fixedVal?(u.hasOwnProperty(r)||(u[r]=0),u[r]+=s):a==iface.tb_prop.addAttrTypeKey.percentVal&&(h.hasOwnProperty(r)||(h[r]=0),h[r]+=s)}}return[u,h]}function calAddAttr(t,e,i,n){switch(isNaN(n)&&(n=0),Number(t)){case iface.tb_prop.attrTypeKey.hpMax:case iface.tb_prop.attrTypeKey.atk:case iface.tb_prop.attrTypeKey.def:case iface.tb_prop.attrTypeKey.atkSpd:return n*Math.max(1+i,0)+e;case iface.tb_prop.attrTypeKey.crit:case iface.tb_prop.attrTypeKey.effectHit:case iface.tb_prop.attrTypeKey.effectResist:case iface.tb_prop.attrTypeKey.suckBlood:case iface.tb_prop.attrTypeKey.strikeBack:case iface.tb_prop.attrTypeKey.rampage:case iface.tb_prop.attrTypeKey.dizzy:case iface.tb_prop.attrTypeKey.immuDizzy:case iface.tb_prop.attrTypeKey.addDmg:case iface.tb_prop.attrTypeKey.subDmg:return Math.max(n+i+e,0);case iface.tb_prop.attrTypeKey.critDmg:case iface.tb_prop.attrTypeKey.dmgRate:case iface.tb_prop.attrTypeKey.healRate:return Math.max(1+n+i+e,0);default:return n}}function replaceSkill(t){for(var e=0;tb.TB_skill_replace.replaceSkill(t)&&!(5<++e););}!function(t){var p,e=(p=t.BattleObj,__extends(i,p),i.prototype.isSkillEft=function(t){return!0},i.prototype.doCaptainSkill=function(){!this.captainEffected&&this.captainSkill&&(this.captainSkill.doPasvSkill(iface.tb_prop.triggerTypeKey.leader,this,null),this.captainEffected=!0)},i);function i(t,e,i){var n=this,o=i[0],a=tb.TB_god.get_TB_godById(o);if(a){for(var r=i[4],s=i[1],u=getSkillList(a.skill,r,s),h=[],l=0;l<u.length;l++){var c=u[l];r>=c[1]&&h.push(c[0])}return(n=p.call(this,t,e,i[3],a.type,h)||this).degree=r,n.starLev=s,n.awakenLv=i[5],n.skinId=i[6]||0,n.uuid=i[7],n.type=iface.tb_prop.battleObjTypeKey.god,n.templateId=o,n.race=a.race_type,n.level=i[2],n}logfight("tb_god %d is null",o)}t.BattleGod=e}(battle=battle||{}),function(r){var t=(e.prototype.onCreate=function(t){this.scene=t},e.prototype.isArtifact=function(){return!0},e.prototype.getObjId=function(){return 100+this.camp},e.prototype.onWaveStart=function(){this.recordAtftInit()},e.prototype.isAngerFull=function(){return this.anger>=tb.TB_artifact_set.get_TB_artifact_setById().anger[0]},e.prototype.addAngerOnAtk=function(t){this.anger+=tb.TB_artifact_set.get_TB_artifact_setById().anger[1],this.recordAngerChange(t)},e.prototype.addAngerOnBeAtk=function(t){this.anger+=tb.TB_artifact_set.get_TB_artifact_setById().anger[2],this.recordAngerChange(t)},e.prototype.getOwnObjs=function(){return this.scene.getCampObjs(this.camp)},e.prototype.getEnemyObjs=function(){var t=getOppoCamp(this.camp);return this.scene.getCampObjs(t)},e.prototype.startRound=function(){this.useSkill(),this.recordAngerChange()},e.prototype.useSkill=function(){this.skillData.useSkill(this);var t=this.skillData.getMainTargetIds();if(0<t.length){if(this.camp==this.scene.getCampByObjid(t[0]))return;this.onBeAtkEnd(t,this.skillData.skillId)}this.scene.deadOpt(),this.anger=0},e.prototype.onBeAtkEnd=function(t,e){for(var i=this.camp,n=0;n<t.length;n++){var o=this.scene.getObjById(t[n]);i=o.camp,o.doPasvSkill(iface.tb_prop.triggerTypeKey.selfBeAtk,this,e),o.doBuffTrigger(iface.tb_prop.buffTrigTypeKey.beAtk,null,e),n==t.length-1&&this.scene.doCampPasvSkill(i,iface.tb_prop.triggerTypeKey.ownBeAtk,o,e)}},e.prototype.onDeadEnd=function(t,e){this.settlementOpt(!1,t,e),this.settlementOpt(!0,t,e)},e.prototype.settlementOpt=function(t,e,i){for(var n=0;n<e.length;n++){var o=this.scene.getObjById(e[n]);o.isAlive()||(o.doPasvSkillEnd(t,i),o.doBuffTriggerEnd(t,i))}},e.prototype.recordAtftInit=function(){var t={type:iface.tb_prop.battleOpTypeKey.atftInit,camp:this.camp,templateId:this.templateId,anger:this.anger,skillId:this.skillData.skillId};this.scene.recordOperate(0,t)},e.prototype.recordAngerChange=function(t){var e={type:iface.tb_prop.battleOpTypeKey.angerChange,camp:this.camp,anger:this.anger};this.scene.recordOperate(t,e)},e.prototype.recordUseSkill=function(t,e){if(e){var i={type:iface.tb_prop.battleOpTypeKey.atftUseSkill,skillId:t,camp:this.camp,targetIds:e};this.scene.recordOperate(0,i)}},e);function e(t,e){this.scene=null;var i=e[0],n=e[1],o=getArtifactSkillId(i,n),a=tb.TB_artifact_skill.get_TB_artifact_skillById(o);a?(this.templateId=i,this.camp=t,this.skillLv=n,this.skillData=new r.AtftSkillData(a.skill),this.anger=0):logfight("tb_artifact_skill %d is null",o)}r.BattleArtifact=t}(battle=battle||{}),function(t){var e=(i.RECOVER_HP_PERCENT=.7,i.MAX_ARTIFACT_LEVEL=1e3,i.BATTLE_CAMPATK=1,i.BATTLE_CAMPDEF=2,i.MAX_BATTLE_TARGET=5,i.GUARD_HP_PERCENT=.3,i);function i(){}t.BatteConsts=e}(battle=battle||{}),function(t){var e=(i.prototype.getType=function(){return this.tplt.type},i.prototype.getTpltId=function(){return this.tplt.ID},i.prototype.getStatType=function(){return this.tplt.status_type},i.prototype.getStackType=function(){return this.tplt.stack_type},i.prototype.getStackMax=function(){return this.tplt.stack_max||1},i.prototype.isDeadExist=function(){return this.tplt.dead_exist},i.prototype.isShow=function(){return this.tplt.is_show},i.prototype.onInit=function(){this.doAttrEffect(!0,this.stackCnt);var t=this.getType(),e=this.tplt.type_param,i=this.tplt.effect_percent/100;switch(t){case iface.tb_prop.buffTypeKey.shield:0===e?this.shield=Math.max(this.obj.hpMax*i,0):1===e?this.caster.isArtifact()||(this.shield=Math.max(this.caster.getAttr(iface.tb_prop.attrTypeKey.atk)*i,0)):2===e&&(this.obj.isArtifact()||(this.shield=Math.max(this.obj.getAttr(iface.tb_prop.attrTypeKey.atk)*i,0)))}this.getStackType()===iface.tb_prop.buffStackTypeKey.stack&&1<this.getStackMax()&&this.obj.recordFlyText(iface.tb_prop.flyTextTypeKey.passive,!1,this.skillId,this.stackCnt),this.buffCreateAfter(this.skillId)},i.prototype.doAttrEffect=function(t,e,i){if(0!==e&&this.getType()===iface.tb_prop.buffTypeKey.attr){logfight("doAttrEffect %s %s obj %d",this.getTpltId(),t,this.obj.getObjId());var n=this.tplt.type_param,o=(t?1:-1)*this.tplt.effect_percent/100*e,a=t?this.skillId:0;this.obj.modifyBuffAmend(n,o,a,i)}},i.prototype.onRemove=function(t){this.doAttrEffect(!1,this.stackCnt,t)},i.prototype.modifyDmg=function(t,e){var i=this.getType(),n=(this.tplt.effect_percent,!1);switch(i){case iface.tb_prop.buffTypeKey.god:t.value=0,this.obj.recordFlyText(iface.tb_prop.flyTextTypeKey.god,!1,e);break;case iface.tb_prop.buffTypeKey.shield:this.shield>=t.value?(this.shield-=t.value,t.value=0):(t.value-=this.shield,n=!(this.shield=0)),this.obj.recordFlyText(iface.tb_prop.flyTextTypeKey.shield,!1,e)}return n},i.prototype.decRound=function(t){9999!==this.round&&(this.round--,0<this.round?this.onBuffChange(t?0:-1):iface.tb_prop.buffTrigTypeKey.roundEnd==this.tplt.trigger_type&&(logfight("自然移除的时候触发",this),this.trigger(!0),this.checkAlive()||this.obj.rmBuff(this)))},i.prototype.onStack=function(t,e){var i=this.stackCnt||1,n=e||1;this.stackCnt=Math.min(this.stackCnt+n,this.getStackMax()),this.createRound=this.obj.scene.round,this.onBuffChange(t,!0,!0),this.getStackType()===iface.tb_prop.buffStackTypeKey.stack&&1<this.getStackMax()&&this.obj.recordFlyText(iface.tb_prop.flyTextTypeKey.passive,!1,t,this.stackCnt),this.doAttrEffect(!0,this.stackCnt-i),this.buffCreateAfter(t)},i.prototype.onCover=function(t,e,i,n){var o=this.stackCnt||1;this.stackCnt=n||1,this.round=i||this.tplt.round,this.caster=t,this.createRound=this.obj.scene.round,this.isNew=!0,this.onBuffChange(e,!0,this.isNew),this.doAttrEffect(!0,this.stackCnt-o),this.buffCreateAfter(e)},i.prototype.buffCreateAfter=function(t){this.tplt.trigger_type===iface.tb_prop.buffTrigTypeKey.buffAllCasterTriggerEff&&this.trigger(!1,t)},i.prototype.onBuffChange=function(t,e,i){void 0===e&&(e=!1),this.obj.recordBuffChange(this,t,e,i)},i.prototype.checkAlive=function(){return 0<this.round&&(this.tplt.trigger_count<=0||this.triggerCnt<this.tplt.trigger_count)},i.prototype.isSelfCaster=function(){return this.obj.getObjId()===this.caster.getObjId()},i.prototype.canDoEffect=function(t){switch(this.getType()){case iface.tb_prop.buffTypeKey.silence:case iface.tb_prop.buffTypeKey.sneer:return!t&&(!this.isNew||(this.isNew=!1));case iface.tb_prop.buffTypeKey.attr:case iface.tb_prop.buffTypeKey.immune:case iface.tb_prop.buffTypeKey.god:case iface.tb_prop.buffTypeKey.banRecover:case iface.tb_prop.buffTypeKey.shield:case iface.tb_prop.buffTypeKey.tag:case iface.tb_prop.buffTypeKey.immuDizzy:case iface.tb_prop.buffTypeKey.immuSleep:case iface.tb_prop.buffTypeKey.immuBleed:case iface.tb_prop.buffTypeKey.shareDmg:return!t&&(!this.isNew||!this.isSelfCaster()||(this.isNew=!1));case iface.tb_prop.buffTypeKey.bleed:case iface.tb_prop.buffTypeKey.dizzy:case iface.tb_prop.buffTypeKey.recover:case iface.tb_prop.buffTypeKey.sleep:return!!t}return!1},i.prototype.doEffect=function(t){var e=this.getType(),i=this.tplt.effect_percent/100,n=0;switch(e){case iface.tb_prop.buffTypeKey.bleed:case iface.tb_prop.buffTypeKey.recover:var o=this.tplt.type_param;iface.tb_prop.buffTypeKey.bleed==e&&(o=Math.floor(this.tplt.type_param/10)),0==o?n=this.obj.hpMax*i:1==o?n=this.caster.getAttr(iface.tb_prop.attrTypeKey.atk)*i:2==o&&(n=this.obj.getAttr(iface.tb_prop.attrTypeKey.atk)*i),iface.tb_prop.buffTypeKey.bleed==e&&(n=-n),this.obj.chgHpPer(this.caster,n,!1,void 0,!1,iface.tb_prop.buffTypeKey.recover==e);break;case iface.tb_prop.buffTypeKey.dizzy:case iface.tb_prop.buffTypeKey.sleep:this.obj.skipRound=!0}this.decRound(t)},i.prototype.canTrigger=function(t,e){return this.tplt.trigger_type===t&&(t==iface.tb_prop.buffTrigTypeKey.atkEqualBuffCaster?!!(e&&e.tag&&this.caster)&&e.tag.getObjId()==this.caster.getObjId():this.tplt.trigger_count<=0||this.triggerCnt<this.tplt.trigger_count)},i.prototype.hasRebornEffect=function(){for(var t=0;t<this.tplt.effects.length;t++){var e=tb.TB_effect.get_TB_effectById(this.tplt.effects[t]);if(e&&e.type==iface.tb_prop.effectTypeKey.reborn)return!0}return!1},i.prototype.trigger=function(t,e){var i=this.tplt.effects,n=this.tplt.trigger_skill,o={};i&&0<i.length&&(this.tplt.trigger_type==iface.tb_prop.buffTrigTypeKey.buffAllCasterTriggerEff?doEffects(o,this.caster,this.caster,i,e,!0,t):doEffects(o,this.caster,this.obj,i,e,!0,t)),n&&0<n&&(this.tplt.trigger_type==iface.tb_prop.buffTrigTypeKey.buffDefAndCasterTriggerSkill?this.caster.useSkillFast(n,e):this.obj.useSkillFast(n,e)),this.triggerCnt++},i.prototype.checkRemove=function(t){switch(this.getType()){case iface.tb_prop.buffTypeKey.sleep:if(this.createRound===t)return!1}return!0},i);function i(t,e,i,n,o,a,r){this.obj=t,this.caster=e,this.tplt=i,this.buffInstId=n,this.skillId=o,this.round=a||i.round,this.stackCnt=r||1,this.triggerCnt=0,this.isNew=!0,this.shield=0,this.createRound=this.obj.scene.round,this.onInit()}t.BuffObj=e}(battle=battle||{});__awaiter=this&&this.__awaiter||function(t,r,s,u){return new(s=s||Promise)(function(i,e){function n(t){try{a(u.next(t))}catch(t){e(t)}}function o(t){try{a(u.throw(t))}catch(t){e(t)}}function a(t){var e;t.done?i(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(n,o)}a((u=u.apply(t,r||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,a,r,t,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(r=2&e[0]?a.return:e[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,e[1])).done)return r;switch(a=0,r&&(e=[2&e[0],r.value]),e[0]){case 0:case 1:r=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,a=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!r||e[1]>r[0]&&e[1]<r[3])){s.label=e[1];break}if(6===e[0]&&s.label<r[1]){s.label=r[1],r=e;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(e);break}r[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(i,s)}catch(t){e=[6,t],a=0}finally{o=r=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};var DebugPlatform=function(){function t(){this.pid="1",this.token="",this.sex=1,this.head="",this.shiming=1,this.fcm=0,this.login_code="",this.time=0,this.gameId="1",this.fromUid="",this.vconsle=0,this.redirect=1}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.sendOpenData=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getShareInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.setUserCloudStorage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.shareAppMessage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.checkviserion=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.updateShareMenu=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getLaunchOptionsSync=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.wxGC=function(){},t.prototype.playerBgMusic=function(t){},t.prototype.playerSound=function(t){},t.prototype.pauseBgMusic=function(){},t.prototype.resumeBgMusic=function(){},t.prototype.name=function(){return"window"},t.prototype.reportInfo=function(){var t=window.platform.serverInfo.serverId,e=hex_md5("gameid="+BingoSDK.gameId+"&member_id=4&roleid="+App.hero.playerId+"&rolename="+App.hero.accountName+"&serverid="+t+"&servername="+t+"&key="+BingoSDK.loginKey);BingoSDK.report(App.hero.puid,BingoSDK.gameId,t,t,App.hero.playerId,App.hero.vip,App.hero.level,App.hero.guildName,e)},t}();window.platform||(window.platform=new DebugPlatform);var UI_DEPATH,UI_DEPATH_VALUE,Sprite=Laya.Sprite;!function(t){t[t.BOTTOM=0]="BOTTOM",t[t.MIDDLE=1]="MIDDLE",t[t.TOP=2]="TOP",t[t.GUIDE=3]="GUIDE",t[t.LOADING=4]="LOADING",t[t.WAITING=5]="WAITING",t[t.ALERT=6]="ALERT"}(UI_DEPATH=UI_DEPATH||{}),function(t){t[t.BOTTOM=-20]="BOTTOM",t[t.MIDDLE=-10]="MIDDLE",t[t.TOP=0]="TOP",t[t.GUIDE=20]="GUIDE",t[t.LOADING=30]="LOADING",t[t.WAITING=40]="WAITING",t[t.ALERT=41]="ALERT"}(UI_DEPATH_VALUE=UI_DEPATH_VALUE||{});var tl3d,UIMgr=function(){function o(){this._uiregist={},this._loadingResUi=[],this._uicache={},UIConfig.closeDialogOnSide=!0,UIConfig.popupBgAlpha=.7,DialogExt.manager=new DialogExtMgr,DialogExt.manager.width=Laya.stage.width,DialogExt.manager.height=Laya.stage.height,DialogExt.manager.zOrder=0,this.registerUI(game.MainView,UIConst.Main3DView,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.ChatView,UIConst.ChatView,["chat/face.atlas","chat.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.PrivateChatView,UIConst.Chat_SiliaoView,["chat/face.atlas","chat.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(common.CheatView,UIConst.CheatView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.PlayerDetailsView,UIConst.PlayerDetailsView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.HudChangeNameView,UIConst.Hud_ChangeNameView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.HeroicModelView,UIConst.HeroicModelView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.HudView,UIConst.HudView,null,null,UI_DEPATH.MIDDLE,!1,!1,!1,null,!1,!0),this.registerUI(common.CommonRuleView,UIConst.CommonRuleView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ExchangeGoldView,UIConst.ExchangeGoldView,["jinbiduihuan.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(common.PlayerInfoView,UIConst.PlayerInfoView,null,null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(common.PlayerLineupInfoView,UIConst.PlayerLineupInfoView,null,null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(common.XianshiBaoxiangView,UIConst.XianshiBaoxiangView,null,["xianshibaoxiang.atlas"],UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.EntranceListView,UIConst.EntranceList,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.EntranceListView,UIConst.EntranceList_lilian,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.EntranceListView,UIConst.EntranceList_jingji,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.EntranceListView,UIConst.EntranceList_kaufu,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.SysTopView,UIConst.SysTopView,null,null,UI_DEPATH.MIDDLE,!1,!1,!1,null,!1,!0),this.registerUI(common.showSkill,UIConst.ShowSkill,null,null,UI_DEPATH.TOP,!1,!1),this.registerUI(game.CreateRoleView,UIConst.CreateRoleView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.UserNoticeView,UIConst.UserNoticeView,null,null,UI_DEPATH.TOP,!1,!0,!1),this.registerUI(game.SelectServerView,UIConst.SelectListView,null,null,UI_DEPATH.BOTTOM,!1,!1,!0,null,!1,!0),this.registerUI(game.LoginView,UIConst.LoginView,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.GuideTalkView,UIConst.GuideTalkView,null,null,UI_DEPATH.GUIDE,!1,!0,!1,null,!1,!0),this.registerUI(game.GuideMask,UIConst.GuideMask,null,null,UI_DEPATH.GUIDE,!1,!1,!1,null,!1,!0),this.registerUI(common.CommonRewardView,UIConst.CommonRewardView,null,null,UI_DEPATH.TOP,!0,!0,!1,null,!0),this.registerUI(common.ShowRewardView,UIConst.ShowRewardItem,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(common.ShowRole,UIConst.ShowRole,["effects/godstarup.atlas"],null,UI_DEPATH.TOP,!1,!0),this.registerUI(game.FightView,UIConst.FightViews,["fight.atlas"],null,UI_DEPATH.TOP,!1,!1,!0,null,!1,!0),this.registerUI(game.ShouYiXiangQingView,UIConst.ShouYiXiangQingView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GodDmFightStart,UIConst.GodDomain_FightStart,["jizhanshengyu.atlas"],["jizhanshengyu/difang_bj1.png","jizhanshengyu/difang_bj.png","jizhanshengyu/wofang_bj.png","jizhanshengyu/wofang_bj1.png"],UI_DEPATH.ALERT,!1,!0),this.registerUI(game.FightStart,UIConst.General_FightStart,null,null,UI_DEPATH.ALERT,!1,!0),this.registerUI(game.FirstGuideView,UIConst.FirstGuide,null,null,UI_DEPATH.TOP,!1,!0,!0),this.registerUI(game.GuildCopyResultView,UIConst.FightGuildCopyResultView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.Failure,UIConst.FightFailure,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,null,!0),this.registerUI(game.VictoryView,UIConst.FightVictory,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,null,!0),this.registerUI(game.guajiVictory,UIConst.GuajiVictory,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,null,!0),this.registerUI(game.guajiDefeated,UIConst.GuajiDefeated,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,null,!0),this.registerUI(game.VictoryQieCuoView,UIConst.FightVictoryQc,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.FightTishiView,UIConst.FightTishiView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GloryFightResultView,UIConst.GloryFightResultView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuaiwuxinxiView,UIConst.GuaiwuxinxiView,null,null,UI_DEPATH.LOADING,!0,!0),this.registerUI(game.WorldMapView,UIConst.WordMap,["guaji/worldmap.atlas"],null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.GuaJiRewardView,UIConst.Lilian_RewardView,null,null,UI_DEPATH.TOP,!1,!0),this.registerUI(game.GuanQiaNewView,UIConst.GuanQiaNewView,null,null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.GuanQiaInfoView,UIConst.GuanQiaInfoView,null,null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.CurMainView,UIConst.GodDoorView,["shenjiezhimen.atlas"],null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.GodDoorJiangliView,UIConst.GodDoor_JiangliView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ArenaView,UIConst.ArenaView,["jingjichang.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.ArenaTopRankView,UIConst.ArenaTopRankView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ArenaResultView,UIConst.ArenaResultView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ArenaRecordView,UIConst.ArenaRecordView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ArenaFailView,UIConst.ArenaFailView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ArenaSuccView,UIConst.ArenaSuccView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ArenaRankView,UIConst.ArenaRankView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.MatchView,UIConst.ArenaMatchView,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.MatchRewardView,UIConst.MatchRewardView,null,null,UI_DEPATH.TOP,!0,!0,!1,UIConst.ArenaMatchView),this.registerUI(game.MatchRankView,UIConst.MatchRankView,null,null,UI_DEPATH.TOP,!0,!0,!1,UIConst.ArenaMatchView),this.registerUI(game.MatchResultView,UIConst.MatchResultView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ZhaohuanResultView,UIConst.ZH_ResultView,null,["tujian.atlas"],UI_DEPATH.TOP,!1,!0),this.registerUI(game.ZhaohuanView,UIConst.ZH_MainView,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.FenjieView,UIConst.FenjieView,null,["shenlingfenjie/ditu.jpg"],UI_DEPATH.TOP,!0,!0),this.registerUI(game.GodMainView,UIConst.God_MainView,["shenling.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.BuzhenView,UIConst.BuzhenView,null,null,UI_DEPATH.TOP,!1,!0),this.registerUI(game.kezhiView,UIConst.God_kezhiView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.DgUpView,UIConst.God_DgUpView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.DgUpSuccView,UIConst.God_DgUp_SUCCView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GodAttrView,UIConst.God_AttrView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ChooseGodView,UIConst.God_ChooseGodView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ReplaceGodView,UIConst.God_ReplaceGodView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GodSkinView,UIConst.GodSkinView,["shizhuang.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GodCultureView,UIConst.God_GodCultureView,["shenling.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,null,!1,!0),this.registerUI(game.GodLiHuiView,UIConst.GodLiHuiView,null,null,UI_DEPATH.TOP,!0,!0,!1,null,!1,!0),this.registerUI(game.ChooseTreasureView,UIConst.ChooseTreasureView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TreasureStrengthView,UIConst.TreasureStrengthView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TreasureStarupView,UIConst.TreasureStarupView,["baowu.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ChooseTreasureMaterialView,UIConst.ChooseTreasureMaterialView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TreasureStarAttrPreview,UIConst.TreasureStarAttrPreview,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TreasureTujianView,UIConst.TreasureTujianView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TreasureRebirthView,UIConst.TreasureRebirthView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.fuseView,UIConst.God_fuseView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TupoView,UIConst.God_TupoView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(common.EffectList,UIConst.EffectList,null,null,UI_DEPATH.TOP),this.registerUI(common.SkillTip,UIConst.SkillTip,null,null,UI_DEPATH.LOADING,!1,!1),this.registerUI(common.ItemTip,UIConst.ItemTip,null,null,UI_DEPATH.ALERT,!0,!0),this.registerUI(common.ManyItemsTip,UIConst.ManyItemsTip,null,null,UI_DEPATH.LOADING,!0,!0),this.registerUI(game.GameNoticeView,UIConst.GameNoticeView,null,null,UI_DEPATH.LOADING,!0,!0),this.registerUI(game.TujianView,UIConst.TujianView,["tujian.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,UIConst.Main3DView),this.registerUI(game.TujianHeroView,UIConst.TujianHeroView,null,["tujian/beijin.jpg"],UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.AttrView,UIConst.Tujian_AttrView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.PingjiaView,UIConst.Tujian_PingjiaView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.PingjiaShuruView,UIConst.Tujian_PingjiaShuruView,null,null,UI_DEPATH.TOP,!1,!0),this.registerUI(game.TaskView,UIConst.TaskView,["task.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ChallengeDetailView,UIConst.ChallengeDetailView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.WarriorBuyLevelView,UIConst.WarriorBuyLevelView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.WarriorJinjieView,UIConst.WarriorJinjieView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.MailView,UIConst.MailView,["mail.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.MailReadView,UIConst.MailReadView,null,["mail/mail_di.png"],UI_DEPATH.TOP,!0,!0),this.registerUI(game.ShopView,UIConst.ShopView,["shop.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.RefreshView,UIConst.Shop_RefreshView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.BuyView,UIConst.Shop_BuyView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.DafuwengView,UIConst.DafuwengView,["tanxian.atlas"],null,UI_DEPATH.TOP,!1,!1,!0,null,!1,!0),this.registerUI(game.QiyuView,UIConst.DFW_QiyuView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.QiyuResultView,UIConst.DFW_QiyuResultView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuajiView,UIConst.GuajiView,["guaji.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.FastFightView,UIConst.Guaji_FastView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ShouyiUpView,UIConst.Guaji_ShouyiUpView,null,null,UI_DEPATH.TOP,!0,!1,!1,null,!0),this.registerUI(game.ShouyiView,UIConst.Guaji_ShouyiView,null,null,UI_DEPATH.TOP,!0,!0,!1,null,!0),this.registerUI(game.OpenChapterView,UIConst.OpenChapterView,["guaji.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,null,!0),this.registerUI(game.FriendMain,UIConst.Friend_MainView,["friend.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,UIConst.Main3DView),this.registerUI(game.BagView,UIConst.BagView,["bag.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.UseView,UIConst.Bag_UseView,null,null,UI_DEPATH.LOADING,!0,!0),this.registerUI(game.RecycleView,UIConst.Bag_RecycleView,["bag.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.RewardSelectView,UIConst.RewardSelectView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TowerView,UIConst.ShiliantaView,["shilianta.atlas","tanxian/yun11.png","tanxian/yun22.png"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.TowerJiangliView,UIConst.SLT_JiangliView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TowerGuanqiaView,UIConst.SLT_GuanqiaView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TowerRankView,UIConst.SLT_RankView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.CreateGuildView,UIConst.CreateGuildView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildApplyListView,UIConst.GuildApplyListView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildInfoView,UIConst.GuildInfoView,["gonghui.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildinitView,UIConst.GuildinitView,["gonghui.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,UIConst.Main3DView),this.registerUI(game.GuildNoticeView,UIConst.GuildNoticeView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildSetUpView,UIConst.GuildSetUpView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildMainView,UIConst.GuildMainView,["gonghui.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.GuildDonationView,UIConst.GuildDonationView,["gonghui/donation.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,UIConst.GuildMainView),this.registerUI(game.GuildCopyView,UIConst.GuildCopyView,null,["gonghui/gonghuifuben_di.jpg"],UI_DEPATH.TOP,!0,!0,!1,UIConst.GuildMainView),this.registerUI(game.DamageRankView,UIConst.DamageRankView,null,null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.AtkEndRankView,UIConst.AtkEndRankView,null,null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.JishaJiangliView,UIConst.JishaJiangliView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TongguanJiangliView,UIConst.TongguanJiangliView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.IconChangeView,UIConst.IconChangeView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildSkillView,UIConst.GuildSkillView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildCopySweepResultView,UIConst.GuildCopySweepResultView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildHelpView,UIConst.GuildHelpView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildAskHelpView,UIConst.GuildAskHelpView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GuildMemberSetView,UIConst.GuildMemberSetView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.FightMainView,UIConst.FightMainView,["gonghui/fight.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.FightWaitView,UIConst.FightWaitView,["gonghui/fight.atlas"],["gonghui/fight/icon_wangzhe.png"],UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.GroupRankView,UIConst.GroupRankView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.PersonRankView,UIConst.PersonRankView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.SeasonAwardView,UIConst.SeasonAwardView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.HonorHallView,UIConst.HonorHallView,null,["gonghui/fight/icon_wangzhe.png"],UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.GradeChestView,UIConst.GradeChestView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GloryWaitView,UIConst.GloryWaitView,["rongyaozhizhan.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.GloryFightView,UIConst.GloryFightView,["rongyaozhizhan.atlas","gonghui/fight/pic_qizhi1.png"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.GloryLastReview,UIConst.GloryLastReview,["rongyaozhizhan.atlas","gonghui/fight/pic_qizhi1.png"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.GloryRecordView,UIConst.GloryRecordView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GloryRewardView,UIConst.GloryRewardView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GloryGroupView,UIConst.GloryGroupView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GodDomainView,UIConst.GodDomainView,["jizhanshengyu.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.GodDmTeamView,UIConst.GodDm_TeamView,["jizhanshengyu.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.AutoMatchView,UIConst.GodDm_AutoMatchView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TeamListView,UIConst.GodDm_TeamListView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GodDmInviteView,UIConst.GodDm_InviteView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TeamMatchView,UIConst.GodDm_TeamMatchView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.BattleSettlementView,UIConst.GodDm_BattleResultView,["jizhanshengyu.atlas","zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.BattleSettlement,UIConst.GodDm_BattleSettlementView,["jizhanshengyu.atlas","zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.InviteJoinView,UIConst.GodDm_InviteJoinView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GodDmRankView,UIConst.GodDm_RankView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(common.LevelUpView,UIConst.LevelUpView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.LOADING,!0,!0,!1,null,!0),this.registerUI(game.ShouchongView,UIConst.TupUp_FirstView,["shouchong.atlas"],null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.TurnRewardView,UIConst.TurnRewardView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.LuckyRecordView,UIConst.LuckRecordView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.RealNameView,UIConst.RealNameView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.LuckyTurnView,UIConst.LuckyTurnView,["huodong/luckturn.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.WelfareView,UIConst.WelfareView,["fuli.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.payActivityView,UIConst.PayActivityView,["fuli.atlas"],null,UI_DEPATH.BOTTOM,!0,!0,!0,null,!1,!0),this.registerUI(game.LoginGiftView,UIConst.LoginGiftView,["huodong/logingift.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TestRebateView,UIConst.TestRebateView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.TimeLimitView,UIConst.TimeLimitView,null,null,UI_DEPATH.BOTTOM,!0,!0,!0),this.registerUI(game.WeekFundView,UIConst.WeekFundView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ExchangeItemView,UIConst.ExchangeItemView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.WeiDuanXiaZaiView,UIConst.WeiDuanXiaZaiView,["yunyingxuqiu.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ChongzhiView,UIConst.ChongzhiView,["chongzhitequan.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.WorldBossView,UIConst.WorldBoss_BossView,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.BossRankView,UIConst.WorldBoss_RankView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.BossRewardView,UIConst.WorldBoss_RewardView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.CopyTeamMainView,UIConst.Copy_TeamMainView,["zudui.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.CopyTeamBattleInfo,UIConst.CopyTeamBattleInfo,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.CopyTeamBuild,UIConst.CopyTeamBuild,null,null,UI_DEPATH.TOP,!0,!0,!1,UIConst.Copy_TeamMainView),this.registerUI(game.CopyTeamInfo,UIConst.CopyTeamInfo,["zudui.atlas"],null,UI_DEPATH.TOP,!0,!0,!1,UIConst.Copy_TeamMainView),this.registerUI(game.CopyTeamApply,UIConst.CopyTeamApply,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.CopyTeamRewardView,UIConst.CopyTeamRewardView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.CopyTeamInvite,UIConst.CopyTeamInvite,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.CopyTeamInviteJoinView,UIConst.CopyTeamInviteJoinView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.CopyTeamTransferLeader,UIConst.CopyTeamTransfer,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.CopyTeamFightStart,UIConst.CopyTeamFightStart,["jizhanshengyu.atlas"],["jizhanshengyu/difang_bj1.png","jizhanshengyu/wofang_bj1.png"],UI_DEPATH.ALERT,!1,!0),this.registerUI(game.CopyTeamRank,UIConst.CopyTeamRank,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.DailyCopyMainView,UIConst.Copy_DailyMainView,["meirufuben.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.DailyCopyView,UIConst.Copy_DailyView,null,null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.DailyCopyBuyView,UIConst.Copy_DailyBuyView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.YuanzhengView,UIConst.YuanzhengView,null,null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.YZChallengeView,UIConst.Yuanzheng_ChallengeView,null,null,UI_DEPATH.TOP,!0,!0,!1,UIConst.YuanzhengView),this.registerUI(game.YZJiangliView,UIConst.Yuanzheng_RewardView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.YZHuifuView,UIConst.Yuanzheng_RecoveryView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.YZHelpView,UIConst.Yuanzheng_HelpView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.EscortMainView,UIConst.EscortMainView,["husong.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.EscortView,UIConst.EscortView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.CaravanInfoView,UIConst.CaravanInfoView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.RobbedRecordView,UIConst.RobbedRecordView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.RewardView,UIConst.EscortRewardView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.FogForestView,UIConst.FogForestView,["miwusenlin.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.ForestRewardView,UIConst.FogForestRewardView,null,null,UI_DEPATH.TOP,!0,!0,!1),this.registerUI(game.IslandView,UIConst.IslandView,["shenmidaoyu.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.OreMapView,UIConst.OreMapView,["shenmidaoyu.atlas"],["shenmidaoyu/lilianbeijing.jpg"],UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.EmptyOreView,UIConst.EmptyOreView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.PlayerOreView,UIConst.PlayerOreView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.OreExplainView,UIConst.OreExplainView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.OreSettlementView,UIConst.OreSettlementView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.SelfOreView,UIConst.SelfOreView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.EquipView,UIConst.EquipView,["zhaungbei.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.EquipChangeView,UIConst.EquipChangeView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.JumpView,UIConst.Equip_JumpView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.RefineView,UIConst.Equip_Refine,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.StrengthView,UIConst.Equip_StrengthView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.EquipRecycleView,UIConst.Equip_Recycle,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.MasterView,UIConst.Equip_MasterView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.EquipTipsView,UIConst.EquipTip,null,null,UI_DEPATH.LOADING,!0,!0),this.registerUI(game.EquipSuitsView,UIConst.Equip_SuitView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.EquipLvupView,UIConst.EquipLvupView,null,null,UI_DEPATH.TOP,!1,!1),this.registerUI(game.EquipSuitLvupView,UIConst.EquipSuitLvupView,null,null,UI_DEPATH.TOP,!1,!1),this.registerUI(game.GemstoneReplaceView,UIConst.GemstoneReplaceView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GemstoneTipsView,UIConst.GemstoneTipsView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.GemstoneCompoundView,UIConst.GemstoneCompoundView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.SingleCompoundView,UIConst.SingleCompoundView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.RankModuleView,UIConst.RankView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.RankTabView,UIConst.RankTabView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.LoginNoticeView,UIConst.LoginNoticeView,null,null,UI_DEPATH.ALERT,!0,!0),this.registerUI(game.SevendaysView,UIConst.SevendaysView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.UnLockView,UIConst.Artifact_UnLockView,null,null,UI_DEPATH.TOP,!1,!1,!1,null,!1,!0),this.registerUI(game.BaptizeTip,UIConst.Artifact_BaptizeTip,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.EnchantTip,UIConst.Artifact_EnchantTip,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ObtainTip,UIConst.Artifact_ObtainTip,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ArtifactListView,UIConst.ArtifactListView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ArtifactView,UIConst.ArtifactView,["shenqi.atlas"],null,UI_DEPATH.BOTTOM,!1,!1,!1,null,!1,!0),this.registerUI(game.RechargeSuccView,UIConst.Topup_SuccView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.ALERT,!0,!0),this.registerUI(game.RechargeGiftSuccView,UIConst.Topup_GiftSuccView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.ALERT,!0,!0),this.registerUI(game.BuySuccView,UIConst.Topup_ScoreView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ChatNoticeEffect,UIConst.ChatNoticeEffect,null,null,UI_DEPATH.ALERT),this.registerUI(common.UpPower,UIConst.UpPower,null,null,UI_DEPATH.LOADING),this.registerUI(common.VipLvUpView,UIConst.VipLvUpView,["zhandoubiaoxian.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.MainPage,UIConst.PowerRank,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.PowerRank,UIConst.Pow_List,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.OsMainPage,UIConst.OpenReward,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.OpenServerGiftView,UIConst.OpenServerGift,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.OnlineMainPage,UIConst.OnLineReward,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.BindPhoneView,UIConst.BindPhone,["yunyingxuqiu.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.FirstPage,UIConst.FirstShare,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.ShareMainPage,UIConst.MainShare,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.LimiteBuyView,UIConst.LimiteBuyView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.JiangLiView,UIConst.Lim_JiangLiView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.SuperVipView,UIConst.SuperVipView,["yunyingxuqiu.atlas"],null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.BianQiangView,UIConst.BianQiangView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(common.BuyBattleCountView,UIConst.BuyBattleCount,null,null,UI_DEPATH.GUIDE,!0,!0),this.registerUI(game.UpRoadView,UIConst.UpRoadView,null,null,UI_DEPATH.TOP,!0,!0),this.registerUI(game.UpRoadSuccessView,UIConst.UpRoadSuccessView,null,null,UI_DEPATH.TOP,!0,!0)}return o.getInstance=function(){return o._instance||(o._instance=new o),o._instance},o.prototype.registerUI=function(t,e,i,n,o,a,r,s,u,h,l){if(void 0===a&&(a=!1),void 0===r&&(r=!1),void 0===s&&(s=!1),void 0===u&&(u=null),void 0===h&&(h=!1),void 0===l&&(l=!1),!this._uiregist[e]){var c={uiname:e,cls:t,atlases:i,depth:o,popEffect:a,isModal:r,closeOther:s,parentUI:u,destroyAtlases:n,isQueue:h,adaptStage:l};this._uiregist[e]=c}},o.prototype.showLoading=function(t){logyhj("显示load"),this._loadui||(this._loadui=new common.LoadingView,this._loadui.zOrder=UI_DEPATH_VALUE.LOADING),t&&(this._loadui.dataSource=t),this._loadui.show(!1,!1)},Object.defineProperty(o.prototype,"loadui",{get:function(){return this._loadui},enumerable:!0,configurable:!0}),o.prototype.loadingProcess=function(t,e){this._loadui&&(e&&(this._loadui.dataSource=e),this._loadui.setProgress(t))},o.prototype.hideLoading=function(){logyhj("隐藏load"),this._loadui&&this._loadui.close(null,!1,!1)},o.prototype.showWaiting=function(t){this._waitui||(this._waitui=new common.WaitView,this._waitui.zOrder=UI_DEPATH_VALUE.WAITING),t&&(this._waitui.dataSource=t),this._waitui.show(!1)},o.prototype.waitingProgress=function(t){this._waitui&&this._waitui.setProgress(t)},o.prototype.hideWaiting=function(){this._waitui&&this._waitui.close(null,!1,!1)},o.prototype.getUIInfo=function(t){return this._uiregist[t]},o.prototype.showUI=function(i,t,e,n){var o=this;void 0===e&&(e=!0),void 0===n&&(n=!1);var a=this._uiregist[i];if(a){if(a.isQueue){if(DialogQueueMgr.getInstance().hasDialog())return void DialogQueueMgr.getInstance().push(i,t);DialogQueueMgr.getInstance().setCurDialog(i)}logdebug("showUI:",i);var r=this._uicache[i];if(r)this.catchCom(r,a,t,n);else if(a.atlases||a.destroyAtlases){var s=GameUtil.concatArray(a.atlases,a.destroyAtlases);-1==this._loadingResUi.indexOf(i)&&(this._loadingResUi.push(i),this.showWaiting(),Laya.loader.load(s,Handler.create(null,function(t,e){if(!1===e)return o.delLoadingUi(i),void DialogQueueMgr.getInstance().showFail(i);o.hideWaiting(),o.delLoadingUi(i),r=new a.cls,a.adaptStage&&r.setSize(Laya.stage.width,Laya.stage.height),r.name=a.uiname,r.dialogInfo=a,o.catchCom(r,a,t,n)},[t])))}else r=new a.cls,a.adaptStage&&r.setSize(Laya.stage.width,Laya.stage.height),r.name=a.uiname,r.dialogInfo=a,this.catchCom(r,a,t,n)}else logdebug("can not find ui name:",i)},o.prototype.delLoadingUi=function(t){var e=this._loadingResUi.indexOf(t);-1!=e&&this._loadingResUi.splice(e,1)},o.prototype.catchCom=function(t,e,i,n){if(void 0===n&&(n=!1),!t)return logerror("uierror"),void DialogQueueMgr.getInstance().showFail(e.uiname);if(!t.parent&&(this._uicache.hasOwnProperty(e.uiname)||(this._uicache[e.uiname]=t),t.dataSource=i,t.isModal=e.isModal,!n)){switch(t.group&&(DialogExt.manager.closeByGroup(t.group),t.group==UIConst.hud_group&&DialogExt.manager.closeByGroup(UIConst.two_group)),e.parentUI&&this.showUI(e.parentUI),e.depth){case UI_DEPATH.BOTTOM:t.zOrder=UI_DEPATH_VALUE.BOTTOM;break;case UI_DEPATH.MIDDLE:t.zOrder=UI_DEPATH_VALUE.MIDDLE;break;case UI_DEPATH.TOP:t.zOrder=UI_DEPATH_VALUE.TOP;break;case UI_DEPATH.GUIDE:t.zOrder=UI_DEPATH_VALUE.GUIDE;break;case UI_DEPATH.LOADING:t.zOrder=UI_DEPATH_VALUE.LOADING;break;case UI_DEPATH.WAITING:t.zOrder=UI_DEPATH_VALUE.WAITING;break;case UI_DEPATH.ALERT:t.zOrder=UI_DEPATH_VALUE.ALERT}e.isModal?t.popup(e.closeOther,e.popEffect):t.show(e.closeOther,e.popEffect),e.depth==UI_DEPATH.BOTTOM&&this.hideUIByName(UIConst.ChatView)}},o.prototype.hideUIByName=function(t,e){var i=this._uicache[t];i&&this.hasStage(t)&&(logdebug("hideUIByName:"+t),i.close("hideUIByName",e,!1))},o.prototype.hideUIByDepth=function(t,e){void 0===e&&(e=[]);for(var i=0,n=t;i<n.length;i++)for(var o=n[i],a=DialogExt.manager.numChildren-1;0<=a;a--){var r=DialogExt.manager.getChildAt(a);r&&r.zOrder==o&&-1==e.indexOf(r.name)&&GameUtil.isFunction(r.close)&&r.close("hideUIByDepth",!1,!1)}},o.prototype.getUIByName=function(t){return this._uicache[t]},o.prototype.hasStage=function(t){var e=this._uicache[t];return!(!e||!e.parent)},o.prototype.hasStageByGroup=function(t){var e=DialogExt.manager.getDialogsByGroup(t);return e&&0<e.length},o.prototype.clearUICache=function(){this._uicache={}},o.showUI=function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1),o.getInstance().showUI(t,e,i,n)},o.hideUIByName=function(t,e){o.getInstance().hideUIByName(t,e)},o.getUIByName=function(t){return o.getInstance().getUIByName(t)},o.hasStage=function(t){return o.getInstance().hasStage(t)},o}(),App=function(){function a(){}return a.init=function(){a.hero=new common.Hero,TimeUtil.init(),UIMgr.getInstance(),ResUseMgr.startTick()},a.offline=function(){this.hero.offline(),clearTimeout(this._tickId),this._nextDayFlag=!0},Object.defineProperty(a,"serverTimeSecond",{get:function(){return a.serverTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a,"serverTime",{get:function(){var t=(new Date).getTime();return a._serverTime+t-a._clientTime},set:function(t){new Date(t).getDate();a._serverTime=t,a._clientTime=(new Date).getTime()},enumerable:!0,configurable:!0}),a.updateCrossDayInfo=function(){logdebug("-----开始请求更新跨天数据------"),dispatchEvt(new game.HudEvent(game.HudEvent.UPDATE_MAINVIEW_BUTTON)),clearTimeout(a._tickId),PLC.request(Protocol.game_common_getCrossDayInfo,null,function(t){t?(logdebug("-----请求数据成功，开始更新跨天数据------",t),a._nextDayFlag=!0,a.hero.updateCrossDayInfo(t)):(logdebug("-----请求数据失败，2秒后重新请求跨天数据------"),a._tickId=setTimeout(a.updateCrossDayInfo,2e3))},!1)},a.getServerTime=function(){return Math.round(this.serverTime/1e3)},a.getOpenServerTime=function(){var t=new Date(1e3*a.hero.openSvrTime);return t.setHours(0,0,0,0),Math.floor(t.getTime()/1e3)},a.isOpenSvrDay=function(t){return a.getServerTime()-a.getOpenServerTime()>t*TimeConst.ONE_DAY_SEC},a.getOpenValue=function(t){var e=tb.TB_sys_open.get_TB_sys_openById(t);return e?e.open_parameter:0},a.getOpenType=function(t){return tb.TB_sys_open.get_TB_sys_openById(t).open_type},a.IsSysOpen=function(t){var e=tb.TB_sys_open.get_TB_sys_openById(t);if(!e)return!0;var i=e?e.open_parameter:0;switch(e.open_type){case SysConditionType.default:return!0;case SysConditionType.level:return i<=a.hero.level;case SysConditionType.copy:return game.GuajiModel.getInstance().isPassCopy(i);default:return!0}},a.isEnough=function(t,e){switch(Number(t)){case iface.tb_prop.resTypeKey.gold:return a.hero.gold>=Number(e);case iface.tb_prop.resTypeKey.diamond:return a.hero.diamond>=Number(e);case iface.tb_prop.resTypeKey.godExp:return a.hero.godExp>=Number(e);case iface.tb_prop.resTypeKey.friend:return a.hero.friend>=Number(e);case iface.tb_prop.resTypeKey.arena:return a.hero.arena>=Number(e);case iface.tb_prop.resTypeKey.arenaNum:return a.hero.arenaNum>=Number(e);case iface.tb_prop.resTypeKey.guildDonate:return a.hero.guildDonate>=Number(e);case iface.tb_prop.resTypeKey.legendChip:return a.hero.legendChip>=Number(e);case iface.tb_prop.resTypeKey.soulStone:return a.hero.soulStone>=Number(e);case iface.tb_prop.resTypeKey.godCrystal:return a.hero.godCrystal>=Number(e);case iface.tb_prop.resTypeKey.darkEssence:return a.hero.darkEssence>=Number(e);case iface.tb_prop.resTypeKey.honour:return a.hero.honour>=Number(e);case iface.tb_prop.resTypeKey.godDomain:return a.hero.godDomain>=Number(e);case iface.tb_prop.resTypeKey.vipScore:return a.hero.vipScore>=Number(e);case CostTypeKey.jinhuahuizhang:default:return a.hero.getBagItemNum(t)>=Number(e)}},a.getResNum=function(t){switch(Number(t)){case iface.tb_prop.resTypeKey.gold:return a.hero.gold;case iface.tb_prop.resTypeKey.diamond:return a.hero.diamond;case iface.tb_prop.resTypeKey.godExp:return a.hero.godExp;case iface.tb_prop.resTypeKey.friend:return a.hero.friend;case iface.tb_prop.resTypeKey.arena:return a.hero.arena;case iface.tb_prop.resTypeKey.arenaNum:return a.hero.arenaNum;case iface.tb_prop.resTypeKey.guildDonate:return a.hero.guildDonate;case iface.tb_prop.resTypeKey.legendChip:return a.hero.legendChip;case iface.tb_prop.resTypeKey.soulStone:return a.hero.soulStone;case iface.tb_prop.resTypeKey.godCrystal:return a.hero.godCrystal;case iface.tb_prop.resTypeKey.darkEssence:return a.hero.darkEssence;case iface.tb_prop.resTypeKey.honour:return a.hero.honour;case iface.tb_prop.resTypeKey.godDomain:return a.hero.godDomain;case CostTypeKey.jinhuahuizhang:default:return a.hero.getBagItemNum(t)}},a.isEnoughByAry=function(t){for(var e=!0,i=0,n=t;i<n.length;i++){var o=n[i];if(!a.isEnough(Number(o[0]),Number(o[1]))){e=!1;break}}return e},a.isNotEnoughType=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];if(!a.isEnough(Number(n[0]),Number(n[1])))return n[0]}return-1},a.getMaxVipLv=function(){if(0==a._maxVipLv){var t=TableData.getInstance().getTableByName(TableData.tb_vip).data;for(var e in t){var i=t[e];i.ID>=a._maxVipLv&&(a._maxVipLv=i.ID)}}return a._maxVipLv},a.getCostItemVo=function(t,e){return{getQulity:function(){return""},getIconUrl:function(){return SkinUtil.getCostSkin(t)},getNum:function(){return e},getShow:function(){return!1},getConstNum:function(){return 0},isStartAction:function(){return!1},isChip:function(){return!1},showRace:function(){return 0},getStar:function(){return 0},isMoreThanSix:function(){return!1},getExtParm:function(){}}},a.LOGIN_NOTICE_VERSION="LOGIN_NOTICE_VERSION",a.LOGIN_NOTICE_CHECKBOX="LOGIN_NOTICE_CHECKBOX",a.enterGame=!1,a._nextDayFlag=!0,a._curday=0,a._maxVipLv=0,a}();!function(s){var t=(e.init=function(){window.wx&&(this.adpter_Pan3d_LoadManager(),this.adpter_Pan3d_Init())},e.adpter_Pan3d_Init=function(){s.UIAtlas.prototype.upDataPicToTexture=function(t,i){var n=this,o=new Image;o.onload=function(t){var e=n.getRec(i);n.ctx=s.UIManager.getInstance().getContext2D(e.pixelWitdh,e.pixelHeight,!1),n.ctx.drawImage(o,0,0,e.pixelWitdh,e.pixelHeight),s.TextureManager.getInstance().updateTexture(n.texture,e.pixelX,e.pixelY,n.ctx)},o.src=s.Scene_data.fileRoot+t},s.DynamicTexItem.prototype.creatTextureByCurve=function(){var t=0,e=this.curve.valueVec.length-1,i=new Array;for(t=0;t<this.life;t++)if(t<this.curve.begintFrame)i.push(255*this.curve.valueVec[0][0],255*this.curve.valueVec[0][1],255*this.curve.valueVec[0][2],255*this.curve.valueVec[0][3]);else if(t>this.curve.maxFrame)0==this.curve.maxFrame&&this.curve.begintFrame<0?i.push(255,255,255,255):i.push(255*this.curve.valueVec[e][0],255*this.curve.valueVec[e][1],255*this.curve.valueVec[e][2],255*this.curve.valueVec[e][3]);else if(this.curve.begintFrame<0)i.push(255,255,255,255);else{var n=t-this.curve.begintFrame;i.push(255*this.curve.valueVec[n][0],255*this.curve.valueVec[n][1],255*this.curve.valueVec[n][2],255*this.curve.valueVec[n][3])}var o,a=s.UIManager.getInstance().getContext2D(64,2,!1);for(t=0;t<64;t++)o=4*Math.floor(t/64*this.life),a.fillStyle="rgba("+i[0+o]+","+i[1+o]+","+i[2+o]+","+i[3+o]/255+")",a.fillRect(t,0,1,2);this._textureDynamic=s.TextureManager.getInstance().getCanvasTexture(a).texture}},e.adpter_Pan3d_Accele=function(){var t=window.wx;t&&(t.onCompassChange(function(t){e.compassChangeFun&&e.compassChangeFun(t.direction)}),t.startCompass(),t.onAccelerometerChange(function(t){e.compassChangeFun&&e.onAccelerometerChange(t)}),t.startAccelerometer({interval:"game"}))},e.adpter_Pan3d_LoadManager=function(){function a(t,e){if(t){if(this._loadInfo.info)if(this._loadInfo.type==s.LoadManager.IMG_TYPE){var i=new Image,n=this._loadInfo;i.onload=function(t){n.fun(i,n.info)},i.src="data:image/png;base64,"+s.Base64.encode(e)}else this._loadInfo.fun(e,this._loadInfo.info);else this._loadInfo.fun(e);this.idle=!0,this._loadInfo=null,s.LoadManager.getInstance().loadWaitList()}else this.loadError.call(this)}var r=s.LoaderThread.prototype.load;s.LoaderThread.prototype.load=function(t){var e=window.wx;if(e&&-1==t.url.indexOf("http://")&&-1==t.url.indexOf("https://")){this._loadInfo=t,this.idle=!1,this._url=t.url;var i=this,n=e.getFileSystemManager();e.getFileSystemManager();var o="utf8";t.type==s.LoadManager.BYTE_TYPE?o="":t.type==s.LoadManager.XML_TYPE?o="utf8":t.type==s.LoadManager.IMG_TYPE&&(o=""),n.readFile({filePath:t.url,encoding:o,success:function(t){a.call(i,!0,t.data)},fail:function(t){t&&a.call(i,!1,t.data)}})}else r.call(this,t)}},e);function e(){}s.MiniTL3dAdpter=t}(tl3d=tl3d||{});var Browser=Laya.Browser,Loader=Laya.Loader,LEvent=Laya.Event,Stage=Laya.Stage,Handler=Laya.Handler;Laya.MiniAdpter.init(),tl3d.MiniTL3dAdpter.init();var Launch=function(){function e(){this._offlinetime=0,this._lastime=0,e._init||(e._init||(e._init=!0),this.init(),App.main=this)}return e.prototype.init=function(){tl3d.Engine.canvas=Laya.init(e.SCENE_WIDTH,e.SCENE_HEIGHT,Laya.WebGL),logdebug("初始化引擎"),Browser.onPC?Laya.stage.scaleMode=Stage.SCALE_SHOWALL:Laya.stage.scaleMode=Stage.SCALE_FIXED_AUTO,Laya.stage.alignH=Stage.ALIGN_CENTER,Laya.stage.mouseThrough=!0,Laya.stage.bgColor="#000",Laya.SoundManager.autoStopMusic=!0,Laya.SoundManager.useAudioMusic=!0,Laya.loader.maxLoader=1,Laya.stage.setScreenSize(Browser.clientWidth*Browser.pixelRatio,Browser.clientHeight*Browser.pixelRatio),App.init(),Browser.onPC||Browser.onMiniGame?(console.log("wx minigame"),this.loadConfig()):(console.log("nativeLoadConfig"),this.nativeLoadConfig()),Laya.stage.on("resize",this,this._onResize)},e.prototype.nativeLoadConfig=function(){Laya.ResourceVersion.type=Laya.ResourceVersion.FILENAME_VERSION,Laya.URL.customFormat=function(t){return-1!=t.indexOf("gui/")?console.log("originURL:",t):-1!=t.indexOf("icon/")||-1!=t.indexOf("sound/")||"lang.lang"!=t&&"ui.json"!=t&&(t="gui/"+t),t},this.loadUIConfig(),Laya.stage.on(Laya.Event.VISIBILITY_CHANGE,this,this.VISIBILITY_CHANGE)},e.prototype.loadConfig=function(){var t=this;Laya.URL.basePath=Scene_data.fileRoot=ExtConfig.res_path,Laya.ResourceVersion.type=Laya.ResourceVersion.FILENAME_VERSION,Laya.ResourceVersion.addVersionPrefix=function(t){var e=Laya.ResourceVersion.manifest;return e?(-1!=t.indexOf("icon/")||-1!=t.indexOf("sound/")||"lang.lang"!=t&&"ui.json"!=t&&(t="gui/"+t),e[t]||t):t},Laya.ResourceVersion.enable("version.json?v="+BingoSDK.resVersion,Handler.create(this,this.loadUIConfig)),Laya.stage.on(Laya.Event.VISIBILITY_CHANGE,this,this.VISIBILITY_CHANGE),window.addEventListener("online",function(){logyhj("网络已连接！"),e.online=!0,common.AlertBox.close(),t.onBeat(t._offlinetime,30),t._offlinetime=0}),window.addEventListener("offline",function(){logyhj("网络已断开！"),e.online=!1,t._offlinetime=(new Date).getTime()/1e3,common.AlertBox.showWarn({text:LanMgr.getLan("",10538)})})},e.prototype.VISIBILITY_CHANGE=function(){Laya.stage.isVisibility?this.onBeat(this._lastime,60):logdebug("lose focus"),this._lastime=(new Date).getTime()/1e3},e.prototype.onBeat=function(t,e){logdebug("on focus");var i=(new Date).getTime()/1e3;0==t&&(t=i),e<=i-t&&(PLC.needFresh=!0),PLC.getInstance().sendHearBeat()},e.prototype.loadUIConfig=function(){this.needLang()?(UIMgr.getInstance().showLoading(LanMgr.getLan("",10543)),UIMgr.getInstance().loadingProcess(.01),Laya.loader.load("lang.lang",Handler.create(this,this.loadUIJson),Handler.create(this,this.onUIProgress))):this.loadUIJson()},e.prototype.loadUIJson=function(){if(this.needLang()){var t=Laya.loader.getRes("lang.lang");Laya.Text.langPacks=JSON.parse(t)}UIMgr.getInstance().showLoading(LanMgr.getLan("",10544)),UIMgr.getInstance().loadingProcess(.01),Laya.loader.load("ui.json",Handler.create(this,this.onUIConfig),Handler.create(this,this.onUIProgress))},e.prototype.onUIProgress=function(t){logyhj("加载进度：",t),UIMgr.getInstance().loadingProcess(.01+t/10)},e.prototype.onUIConfig=function(t){View.uiMap=t,tl3d.LoadManager.getInstance()._versions=Laya.ResourceVersion.manifest||{},TableData.getInstance().loadGameData("data/tb.txt",function(){var t=Laya.ResourceVersion.manifest||{},e="ui/textlist/flytext.png",i="ui/public/publics.png",n=t[i]||i,o=[{xmlurl:"ui/textlist/flytext.txt",picurl:t[e]||e,name:tl3d.UIData.flytext},{xmlurl:"ui/public/publics.txt",picurl:n,name:tl3d.UIData.publicsUi}];tl3d.UIData.init(o,function(){Module.registerModule(new game.LoginModule)},function(t){UIMgr.getInstance().loadingProcess(.4+.1*t)})},function(t){UIMgr.getInstance().loadingProcess(.2+.2*t)})},e.prototype.needLang=function(){return"zh_CN"!=e.LANGUAGE},e.prototype._onResize=function(){e._offsetX=Laya.stage.width-e.SCENE_WIDTH>>1,e._offsetY=Laya.stage.height-e.SCENE_HEIGHT>>1,dispatchEvt(new game.HudEvent(game.HudEvent.SCREEN_SIZE_CHNAGE))},Object.defineProperty(e,"offsetX",{get:function(){return isNaN(e._offsetX)&&(e._offsetX=Laya.stage.width-e.SCENE_WIDTH>>1),e._offsetX},enumerable:!0,configurable:!0}),Object.defineProperty(e,"offsetY",{get:function(){return isNaN(e._offsetY)&&(e._offsetY=Laya.stage.height-e.SCENE_HEIGHT>>1),e._offsetY},enumerable:!0,configurable:!0}),e.LANGUAGE="zh_CN",e.MAX_SCENE_WIDTH=900,e.SCENE_WIDTH=720,e.SCENE_HEIGHT=1280,e.online=!0,e.unline=!0,e}();new(window.Launch=Launch);